import{C as n,g as y,a as u,b as j,h as I}from"./compositor.75e39e5c.js";const L=[{name:"ImageIframeOverlayContainer",id:"fg-image-iframe",layout:"Free"},{name:"BannerContainer",id:"fg-banners",layout:"Column",layoutProps:{cover:!0}},{name:"VideoOverlayContainer",id:"fg-video",layout:"Free"},{name:"LogoContainer",layout:"Free",id:"logo"}],w=async(o,a,e)=>{const{backgroundImage:c,layout:i,layoutProps:r={}}=e,t=await n.compositor.createProject({props:{name:"Root",type:"sceneless-project",sourceType:"Element",layout:"Layered",size:a,isRoot:!0,tagName:"div",version:"beta",fields:{style:{background:"black"}}}},o),s=t.getRoot(),l=await Promise.all([t.insert({name:"Background",id:"bg",layout:"Layered"},s.id),t.insert({id:"content",name:"Content",layout:i,layoutProps:r},s.id),t.insert({id:"foreground",name:"Overlays",layout:"Layered"},s.id)]);await t.reorder(s.id,l);const d=s.children.find(p=>p.props.id==="foreground"),m=L.map(p=>t.insert(p,d.id)),g=await Promise.all(m);return await t.reorder(d.id,g),t},C=async o=>{const a=y().id,e=o.type||"sceneless",c=o.size||{x:1280,y:720},i=o.settings||{};let r=await n.clients.LiveApi().project.createProject({collectionId:a,rendering:{video:{width:c.x,height:c.y,framerate:30}},composition:{studioSdk:{version:n.rendererVersion}},metadata:{},webrtc:{hosted:{}}});const t=await f({projectId:r.project.projectId,collectionId:r.project.collectionId,settings:i,size:c,type:e}),{displayName:s}=u(),l={type:e,layoutId:t.id,hostDisplayName:s,props:o.props||{}};let d=await n.clients.LiveApi().project.updateProject({collectionId:a,projectId:r.project.projectId,updateMask:["metadata"],metadata:l});return r.project=d.project,r.project.metadata=l,r},b=async o=>{const{projectId:a}=o,e=j(a),c=y().id;await Promise.all([n.clients.LiveApi().project.deleteProject({collectionId:c,projectId:a}),n.clients.LayoutApi().layout.deleteLayout({layoutId:e.layoutApi.layoutId})])},A=async o=>{var t;const a=await P();let e;const{displayName:c,serviceUserId:i}=u();a.length===0?e=(await n.clients.LiveApi().collection.createCollection({metadata:{serviceUserId:i,displayName:c,props:{}}})).collection:e=a[0],await n.clients.LiveApi().subscribeToCollection(e.collectionId);const r=await Promise.all(e.projects.filter(s=>{var l;return Boolean((l=s.metadata)==null?void 0:l.layoutId)}).map(s=>I(s,"ROLE_HOST",o)));return{user:{id:e.collectionId,metadata:e.metadata,props:((t=e.metadata)==null?void 0:t.props)||{},name:c},projects:r,sources:e.sources}},P=async()=>(await n.clients.LiveApi().collection.getCollections({})).collections,f=async o=>{const{settings:a,size:e,type:c,projectId:i,collectionId:r}=o,t=await n.clients.LayoutApi().layout.createLayout({layout:{projectId:i,collectionId:r}});return c==="sceneless"?await w(t.id,e,a):await n.compositor.createProject({props:{name:"Root",layout:"Free",...a,isRoot:!0,size:e}},t.id),t};export{f as createLayout,C as createProject,b as deleteProject,P as loadCollections,A as loadUser};
//# sourceMappingURL=requests.8e08e68c.js.map
