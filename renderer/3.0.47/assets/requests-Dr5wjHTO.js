import{C as c,g as y,a as u,b as j,h as g}from"./compositor-BtZ6S-uN.js";const L=[{name:"ImageIframeOverlayContainer",id:"fg-image-iframe",layout:"Layered",layoutProps:{type:"image-iframe-overlay"}},{name:"BannerContainer",id:"fg-banners",layout:"Column",layoutProps:{cover:!0}},{name:"VideoOverlayContainer",id:"fg-video",layout:"Free"},{name:"AlertContainer",id:"alert",layout:"Layered",layoutProps:{type:"alert",preset:"center"}},{name:"LogoContainer",layout:"Free",id:"logo"}],I=async(r,a,s)=>{const{layout:t,layoutProps:n={}}=s,e=await c.compositor.createProject({props:{name:"Root",type:"sceneless-project",sourceType:"Element",layout:"Layered",size:a,isRoot:!0,tagName:"div",version:"beta",fields:{style:{background:"black"}}}},r),o=e.getRoot(),l=await Promise.all([e.insert({id:"audio",name:"AudioContainer",layout:"Free",size:{x:0,y:0},position:{x:0,y:0},opacity:0},o.id),e.insert({name:"Background",id:"bg",layout:"Layered"},o.id),e.insert({id:"content",name:"Content",layout:t,layoutProps:n},o.id),e.insert({id:"foreground",name:"Overlays",layout:"Layered"},o.id)]);await e.reorder(o.id,l);const i=o.children.find(p=>p.props.id==="foreground"),d=L.map(p=>e.insert(p,i.id)),m=await Promise.all(d);return await e.reorder(i.id,m),e},v=async r=>{const a=y().id,s=r.type||"sceneless",t=r.size||{x:1280,y:720},n=r.settings||{};let e=await c.clients.LiveApi().project.createProject({collectionId:a,rendering:{video:{width:t.x,height:t.y,framerate:30}},composition:{studioSdk:{version:c.rendererVersion}},metadata:{},webrtc:{hosted:{}}});const o=await P({projectId:e.project.projectId,collectionId:e.project.collectionId,settings:n,size:t,type:s}),{displayName:l}=u(),i={type:s,layoutId:o.id,hostDisplayName:l,props:r.props||{}};let d=await c.clients.LiveApi().project.updateProject({collectionId:a,projectId:e.project.projectId,updateMask:["metadata"],metadata:i});return e.project=d.project,e.project.metadata=i,{project:e.project,layout:o}},C=async r=>{const{projectId:a}=r,s=j(a),t=y().id;await Promise.all([c.clients.LiveApi().project.deleteProject({collectionId:t,projectId:a}),c.clients.LayoutApi().layout.deleteLayout({layoutId:s.layoutApi.layoutId})])},A=async(r,a)=>{var l;const s=await w();let t;const{displayName:n,serviceUserId:e}=u();s.length===0?t=(await c.clients.LiveApi().collection.createCollection({metadata:{serviceUserId:e,displayName:n,props:{}}})).collection:t=s[0],await c.clients.LiveApi().subscribeToCollection(t.collectionId);const o=await Promise.all(t.projects.filter(i=>{var d;return!!((d=i.metadata)!=null&&d.layoutId)}).map(i=>g(i,"ROLE_HOST",r,a==null?void 0:a.updateLayoutOnly)));return{user:{id:t.collectionId,metadata:t.metadata,props:((l=t.metadata)==null?void 0:l.props)||{},name:n},projects:o,sources:t.sources}},w=async()=>(await c.clients.LiveApi().collection.getCollections({})).collections,P=async r=>{const{settings:a,size:s,type:t,projectId:n,collectionId:e}=r,o=await c.clients.LayoutApi().layout.createLayout({layout:{projectId:n,collectionId:e}});return t==="sceneless"?await I(o.id,s,a):await c.compositor.createProject({props:{name:"Root",layout:"Free",...a,isRoot:!0,size:s}},o.id),o};export{P as createLayout,v as createProject,C as deleteProject,w as loadCollections,A as loadUser};
//# sourceMappingURL=requests-Dr5wjHTO.js.map
