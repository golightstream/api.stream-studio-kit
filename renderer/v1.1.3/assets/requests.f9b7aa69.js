import{C as s,g as y,a as m,b as w,h as I}from"./compositor.f535da5e.js";const P=async(o,t,c)=>{const{backgroundImage:r,layout:n,layoutProps:a={}}=c,e=await s.compositor.createProject({props:{name:"Root",type:"sceneless-project",sourceType:"Element",layout:"Layered",size:t,isRoot:!0,tagName:"div",fields:{style:{background:"black"}}}},o),i=e.getRoot(),d=await Promise.all([e.insert({name:"Background",id:"bg",layout:"Free"},i.id),e.insert({id:"content",name:"Content",layout:n,layoutProps:a},i.id),e.insert({id:"foreground",name:"Overlays",layout:"Free"},i.id)]);await e.reorder(i.id,d);const l=i.children.find(p=>p.props.id==="foreground"),g=await Promise.all([e.insert({name:"ImageOverlay",id:"fg-image",layout:"Free"},l.id),e.insert({name:"BannerContainer",id:"fg-banners",layout:"Column",layoutProps:{cover:!0}},l.id),e.insert({name:"VideoOverlay",id:"fg-video",layout:"Free"},l.id)]);await e.reorder(l.id,g);const u=i.children.find(p=>p.props.id==="bg"),j=await Promise.all([e.insert({name:"ImageBackground",id:"bg-image",tagName:"img",sourceType:"Element",attributes:{src:r}},u.id)]);return await e.reorder(u.id,j),e},v=async o=>{const t=y().id,c=o.type||"sceneless",r=o.size||{x:1280,y:720},n=o.settings||{};let a=await s.clients.LiveApi().project.createProject({collectionId:t,rendering:{video:{width:r.x,height:r.y,framerate:30}},composition:{studioSdk:{}},metadata:{},webrtc:{hosted:{}}});const e=await s.clients.LayoutApi().layout.createLayout({layout:{projectId:a.project.projectId,collectionId:a.project.collectionId}}),{displayName:i}=m(),d={type:c,layoutId:e.id,hostDisplayName:i,props:o.props||{}};let l=await s.clients.LiveApi().project.updateProject({collectionId:t,projectId:a.project.projectId,updateMask:["metadata"],metadata:d});return a.project=l.project,a.project.metadata=d,c==="sceneless"?await P(e.id,r,n):await s.compositor.createProject({props:{name:"Root",layout:"Free",...n,isRoot:!0,size:r}},e.id),a},f=async o=>{const{projectId:t}=o,c=w(t),r=y().id;await Promise.all([s.clients.LiveApi().project.deleteProject({collectionId:r,projectId:t}),s.clients.LayoutApi().layout.deleteLayout({layoutId:c.layoutApi.layoutId})])},C=async()=>{var a;const o=await b();let t;const{displayName:c,serviceUserId:r}=m();o.length===0?t=(await s.clients.LiveApi().collection.createCollection({metadata:{serviceUserId:r,displayName:c,props:{}}})).collection:t=o[0],await s.clients.LiveApi().subscribeToCollection(t.collectionId);const n=await Promise.all(t.projects.map(e=>I(e,"ROLE_HOST")));return{user:{id:t.collectionId,metadata:t.metadata,props:((a=t.metadata)==null?void 0:a.props)||{},name:c},projects:n,sources:t.sources}},b=async()=>(await s.clients.LiveApi().collection.getCollections({})).collections;export{v as createProject,f as deleteProject,b as loadCollections,C as loadUser};
//# sourceMappingURL=requests.f9b7aa69.js.map
