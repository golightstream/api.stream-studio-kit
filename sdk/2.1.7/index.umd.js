(function(a,s){typeof exports=="object"&&typeof module!="undefined"?s(exports,require("react-dom"),require("react")):typeof define=="function"&&define.amd?define(["exports","react-dom","react"],s):(a=typeof globalThis!="undefined"?globalThis:a||self,s((a["@api"]=a["@api"]||{},a["@api"]["stream/studio-kit"]={}),a.ReactDOM,a.React))})(this,function(exports,ReactDOM,React){"use strict";function _interopDefaultLegacy(a){return a&&typeof a=="object"&&"default"in a?a:{default:a}}var ReactDOM__default=_interopDefaultLegacy(ReactDOM),React__default=_interopDefaultLegacy(React);let currentSubId=0;const subscribers=new Map,subscribersInternal=new Map;function createSubscribe(a={}){return function(s){if(typeof s!="function")return;const d=a.internal?subscribersInternal:subscribers,c=++currentSubId;return d.set(c,s),()=>{d.delete(c)}}}function createOn(a={}){return function(s,d){return(a.internal?subscribeInternal:subscribe)((l,p)=>{if(s===l)return d(p)})}}function createTrigger(a={}){const s=a.internal?subscribersInternal:subscribers;return async function(d,...c){let l={type:d,payload:c[0]};const p=Boolean(a.internal)?"Internal":"External";log$1.info(`${p} Event:`,l),await Promise.all(Array.from(s.values()).map(h=>h(l.type,l.payload)))}}const trigger$1=createTrigger(),subscribe=createSubscribe(),on=createOn(),triggerInternal$1=createTrigger({internal:!0}),subscribeInternal=createSubscribe({internal:!0}),onInternal=createOn({internal:!0});var events$1=Object.freeze(Object.defineProperty({__proto__:null,trigger:trigger$1,subscribe,on,triggerInternal:triggerInternal$1,subscribeInternal,onInternal},Symbol.toStringTag,{value:"Module"})),commonjsGlobal$1=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function getAugmentedNamespace(a){if(a.__esModule)return a;var s=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(a).forEach(function(d){var c=Object.getOwnPropertyDescriptor(a,d);Object.defineProperty(s,d,c.get?c:{enumerable:!0,get:function(){return a[d]}})}),s}var loglevel$1={exports:{}};(function(a){(function(s,d){a.exports?a.exports=d():s.log=d()})(commonjsGlobal$1,function(){var s=function(){},d="undefined",c=typeof window!==d&&typeof window.navigator!==d&&/Trident\/|MSIE /.test(window.navigator.userAgent),l=["trace","debug","info","warn","error"];function p(P,$){var U=P[$];if(typeof U.bind=="function")return U.bind(P);try{return Function.prototype.bind.call(U,P)}catch{return function(){return Function.prototype.apply.apply(U,[P,arguments])}}}function h(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function v(P){return P==="debug"&&(P="log"),typeof console===d?!1:P==="trace"&&c?h:console[P]!==void 0?p(console,P):console.log!==void 0?p(console,"log"):s}function S(P,$){for(var U=0;U<l.length;U++){var E=l[U];this[E]=U<P?s:this.methodFactory(E,P,$)}this.log=this.debug}function b(P,$,U){return function(){typeof console!==d&&(S.call(this,$,U),this[P].apply(this,arguments))}}function _(P,$,U){return v(P)||b.apply(this,arguments)}function I(P,$,U){var E=this,D;$=$==null?"WARN":$;var F="loglevel";typeof P=="string"?F+=":"+P:typeof P=="symbol"&&(F=void 0);function J(N){var z=(l[N]||"silent").toUpperCase();if(!(typeof window===d||!F)){try{window.localStorage[F]=z;return}catch{}try{window.document.cookie=encodeURIComponent(F)+"="+z+";"}catch{}}}function G(){var N;if(!(typeof window===d||!F)){try{N=window.localStorage[F]}catch{}if(typeof N===d)try{var z=window.document.cookie,Z=z.indexOf(encodeURIComponent(F)+"=");Z!==-1&&(N=/^([^;]+)/.exec(z.slice(Z))[1])}catch{}return E.levels[N]===void 0&&(N=void 0),N}}function x(){if(!(typeof window===d||!F)){try{window.localStorage.removeItem(F);return}catch{}try{window.document.cookie=encodeURIComponent(F)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}E.name=P,E.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},E.methodFactory=U||_,E.getLevel=function(){return D},E.setLevel=function(N,z){if(typeof N=="string"&&E.levels[N.toUpperCase()]!==void 0&&(N=E.levels[N.toUpperCase()]),typeof N=="number"&&N>=0&&N<=E.levels.SILENT){if(D=N,z!==!1&&J(N),S.call(E,N,P),typeof console===d&&N<E.levels.SILENT)return"No console available for logging"}else throw"log.setLevel() called with invalid level: "+N},E.setDefaultLevel=function(N){$=N,G()||E.setLevel(N,!1)},E.resetLevel=function(){E.setLevel($,!1),x()},E.enableAll=function(N){E.setLevel(E.levels.TRACE,N)},E.disableAll=function(N){E.setLevel(E.levels.SILENT,N)};var Y=G();Y==null&&(Y=$),E.setLevel(Y,!1)}var T=new I,k={};T.getLogger=function($){if(typeof $!="symbol"&&typeof $!="string"||$==="")throw new TypeError("You must supply a name when creating a logger.");var U=k[$];return U||(U=k[$]=new I($,T.getLevel(),T.methodFactory)),U};var w=typeof window!==d?window.log:void 0;return T.noConflict=function(){return typeof window!==d&&window.log===T&&(window.log=w),T},T.getLoggers=function(){return k},T.default=T,T})})(loglevel$1);var log$1=loglevel$1.exports;const connectionId$1=(Math.random()*1e20).toString(36),version$5="2.1.7",CoreContext={config:null,clients:null,Request:{},Command:{},on,subscribe,onInternal,subscribeInternal,trigger:trigger$1,triggerInternal:triggerInternal$1,state:{},compositor:{},connectionId:connectionId$1,version:version$5,rendererVersion:version$5,log:log$1,logLevel:null},setAppState=a=>{Object.keys(a).forEach(s=>{CoreContext.state[s]=a[s]})};var context=Object.freeze(Object.defineProperty({__proto__:null,CoreContext,log:log$1,setAppState,default:CoreContext},Symbol.toStringTag,{value:"Module"})),freeGlobal=typeof global=="object"&&global&&global.Object===Object&&global,freeGlobal$1=freeGlobal,freeSelf=typeof self=="object"&&self&&self.Object===Object&&self,root=freeGlobal$1||freeSelf||Function("return this")(),root$1=root,Symbol$1=root$1.Symbol,Symbol$2=Symbol$1,objectProto$f=Object.prototype,hasOwnProperty$d=objectProto$f.hasOwnProperty,nativeObjectToString$1=objectProto$f.toString,symToStringTag$1=Symbol$2?Symbol$2.toStringTag:void 0;function getRawTag(a){var s=hasOwnProperty$d.call(a,symToStringTag$1),d=a[symToStringTag$1];try{a[symToStringTag$1]=void 0;var c=!0}catch{}var l=nativeObjectToString$1.call(a);return c&&(s?a[symToStringTag$1]=d:delete a[symToStringTag$1]),l}var objectProto$e=Object.prototype,nativeObjectToString=objectProto$e.toString;function objectToString(a){return nativeObjectToString.call(a)}var nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag=Symbol$2?Symbol$2.toStringTag:void 0;function baseGetTag(a){return a==null?a===void 0?undefinedTag:nullTag:symToStringTag&&symToStringTag in Object(a)?getRawTag(a):objectToString(a)}function isObjectLike(a){return a!=null&&typeof a=="object"}var symbolTag$3="[object Symbol]";function isSymbol(a){return typeof a=="symbol"||isObjectLike(a)&&baseGetTag(a)==symbolTag$3}function arrayMap(a,s){for(var d=-1,c=a==null?0:a.length,l=Array(c);++d<c;)l[d]=s(a[d],d,a);return l}var isArray$3=Array.isArray,isArray$4=isArray$3,INFINITY$1=1/0,symbolProto$2=Symbol$2?Symbol$2.prototype:void 0,symbolToString=symbolProto$2?symbolProto$2.toString:void 0;function baseToString(a){if(typeof a=="string")return a;if(isArray$4(a))return arrayMap(a,baseToString)+"";if(isSymbol(a))return symbolToString?symbolToString.call(a):"";var s=a+"";return s=="0"&&1/a==-INFINITY$1?"-0":s}var reWhitespace=/\s/;function trimmedEndIndex(a){for(var s=a.length;s--&&reWhitespace.test(a.charAt(s)););return s}var reTrimStart=/^\s+/;function baseTrim(a){return a&&a.slice(0,trimmedEndIndex(a)+1).replace(reTrimStart,"")}function isObject$5(a){var s=typeof a;return a!=null&&(s=="object"||s=="function")}var NAN=0/0,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;function toNumber(a){if(typeof a=="number")return a;if(isSymbol(a))return NAN;if(isObject$5(a)){var s=typeof a.valueOf=="function"?a.valueOf():a;a=isObject$5(s)?s+"":s}if(typeof a!="string")return a===0?a:+a;a=baseTrim(a);var d=reIsBinary.test(a);return d||reIsOctal.test(a)?freeParseInt(a.slice(2),d?2:8):reIsBadHex.test(a)?NAN:+a}function identity$1(a){return a}var asyncTag="[object AsyncFunction]",funcTag$2="[object Function]",genTag$1="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction$3(a){if(!isObject$5(a))return!1;var s=baseGetTag(a);return s==funcTag$2||s==genTag$1||s==asyncTag||s==proxyTag}var coreJsData=root$1["__core-js_shared__"],coreJsData$1=coreJsData,maskSrcKey=function(){var a=/[^.]+$/.exec(coreJsData$1&&coreJsData$1.keys&&coreJsData$1.keys.IE_PROTO||"");return a?"Symbol(src)_1."+a:""}();function isMasked(a){return!!maskSrcKey&&maskSrcKey in a}var funcProto$2=Function.prototype,funcToString$2=funcProto$2.toString;function toSource(a){if(a!=null){try{return funcToString$2.call(a)}catch{}try{return a+""}catch{}}return""}var reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto$1=Function.prototype,objectProto$d=Object.prototype,funcToString$1=funcProto$1.toString,hasOwnProperty$c=objectProto$d.hasOwnProperty,reIsNative=RegExp("^"+funcToString$1.call(hasOwnProperty$c).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(a){if(!isObject$5(a)||isMasked(a))return!1;var s=isFunction$3(a)?reIsNative:reIsHostCtor;return s.test(toSource(a))}function getValue(a,s){return a==null?void 0:a[s]}function getNative(a,s){var d=getValue(a,s);return baseIsNative(d)?d:void 0}var WeakMap$2=getNative(root$1,"WeakMap"),WeakMap$3=WeakMap$2,objectCreate$1=Object.create,baseCreate=function(){function a(){}return function(s){if(!isObject$5(s))return{};if(objectCreate$1)return objectCreate$1(s);a.prototype=s;var d=new a;return a.prototype=void 0,d}}(),baseCreate$1=baseCreate;function apply(a,s,d){switch(d.length){case 0:return a.call(s);case 1:return a.call(s,d[0]);case 2:return a.call(s,d[0],d[1]);case 3:return a.call(s,d[0],d[1],d[2])}return a.apply(s,d)}function copyArray(a,s){var d=-1,c=a.length;for(s||(s=Array(c));++d<c;)s[d]=a[d];return s}var HOT_COUNT=800,HOT_SPAN=16,nativeNow=Date.now;function shortOut(a){var s=0,d=0;return function(){var c=nativeNow(),l=HOT_SPAN-(c-d);if(d=c,l>0){if(++s>=HOT_COUNT)return arguments[0]}else s=0;return a.apply(void 0,arguments)}}function constant(a){return function(){return a}}var defineProperty$1=function(){try{var a=getNative(Object,"defineProperty");return a({},"",{}),a}catch{}}(),defineProperty$2=defineProperty$1,baseSetToString=defineProperty$2?function(a,s){return defineProperty$2(a,"toString",{configurable:!0,enumerable:!1,value:constant(s),writable:!0})}:identity$1,baseSetToString$1=baseSetToString,setToString=shortOut(baseSetToString$1),setToString$1=setToString;function arrayEach(a,s){for(var d=-1,c=a==null?0:a.length;++d<c&&s(a[d],d,a)!==!1;);return a}function baseFindIndex(a,s,d,c){for(var l=a.length,p=d+(c?1:-1);c?p--:++p<l;)if(s(a[p],p,a))return p;return-1}function baseIsNaN(a){return a!==a}function strictIndexOf(a,s,d){for(var c=d-1,l=a.length;++c<l;)if(a[c]===s)return c;return-1}function baseIndexOf(a,s,d){return s===s?strictIndexOf(a,s,d):baseFindIndex(a,baseIsNaN,d)}var MAX_SAFE_INTEGER$1=9007199254740991,reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex(a,s){var d=typeof a;return s=s==null?MAX_SAFE_INTEGER$1:s,!!s&&(d=="number"||d!="symbol"&&reIsUint.test(a))&&a>-1&&a%1==0&&a<s}function baseAssignValue(a,s,d){s=="__proto__"&&defineProperty$2?defineProperty$2(a,s,{configurable:!0,enumerable:!0,value:d,writable:!0}):a[s]=d}function eq(a,s){return a===s||a!==a&&s!==s}var objectProto$c=Object.prototype,hasOwnProperty$b=objectProto$c.hasOwnProperty;function assignValue(a,s,d){var c=a[s];(!(hasOwnProperty$b.call(a,s)&&eq(c,d))||d===void 0&&!(s in a))&&baseAssignValue(a,s,d)}function copyObject(a,s,d,c){var l=!d;d||(d={});for(var p=-1,h=s.length;++p<h;){var v=s[p],S=c?c(d[v],a[v],v,d,a):void 0;S===void 0&&(S=a[v]),l?baseAssignValue(d,v,S):assignValue(d,v,S)}return d}var nativeMax$1=Math.max;function overRest(a,s,d){return s=nativeMax$1(s===void 0?a.length-1:s,0),function(){for(var c=arguments,l=-1,p=nativeMax$1(c.length-s,0),h=Array(p);++l<p;)h[l]=c[s+l];l=-1;for(var v=Array(s+1);++l<s;)v[l]=c[l];return v[s]=d(h),apply(a,this,v)}}function baseRest(a,s){return setToString$1(overRest(a,s,identity$1),a+"")}var MAX_SAFE_INTEGER=9007199254740991;function isLength(a){return typeof a=="number"&&a>-1&&a%1==0&&a<=MAX_SAFE_INTEGER}function isArrayLike$1(a){return a!=null&&isLength(a.length)&&!isFunction$3(a)}function isIterateeCall(a,s,d){if(!isObject$5(d))return!1;var c=typeof s;return(c=="number"?isArrayLike$1(d)&&isIndex(s,d.length):c=="string"&&s in d)?eq(d[s],a):!1}var objectProto$b=Object.prototype;function isPrototype(a){var s=a&&a.constructor,d=typeof s=="function"&&s.prototype||objectProto$b;return a===d}function baseTimes(a,s){for(var d=-1,c=Array(a);++d<a;)c[d]=s(d);return c}var argsTag$3="[object Arguments]";function baseIsArguments(a){return isObjectLike(a)&&baseGetTag(a)==argsTag$3}var objectProto$a=Object.prototype,hasOwnProperty$a=objectProto$a.hasOwnProperty,propertyIsEnumerable$1=objectProto$a.propertyIsEnumerable,isArguments=baseIsArguments(function(){return arguments}())?baseIsArguments:function(a){return isObjectLike(a)&&hasOwnProperty$a.call(a,"callee")&&!propertyIsEnumerable$1.call(a,"callee")},isArguments$1=isArguments;function stubFalse(){return!1}var freeExports$2=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule$2=freeExports$2&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports$2=freeModule$2&&freeModule$2.exports===freeExports$2,Buffer$2=moduleExports$2?root$1.Buffer:void 0,nativeIsBuffer=Buffer$2?Buffer$2.isBuffer:void 0,isBuffer$1=nativeIsBuffer||stubFalse,isBuffer$2=isBuffer$1,argsTag$2="[object Arguments]",arrayTag$2="[object Array]",boolTag$3="[object Boolean]",dateTag$3="[object Date]",errorTag$2="[object Error]",funcTag$1="[object Function]",mapTag$5="[object Map]",numberTag$3="[object Number]",objectTag$4="[object Object]",regexpTag$3="[object RegExp]",setTag$5="[object Set]",stringTag$3="[object String]",weakMapTag$2="[object WeakMap]",arrayBufferTag$3="[object ArrayBuffer]",dataViewTag$4="[object DataView]",float32Tag$2="[object Float32Array]",float64Tag$2="[object Float64Array]",int8Tag$2="[object Int8Array]",int16Tag$2="[object Int16Array]",int32Tag$2="[object Int32Array]",uint8Tag$2="[object Uint8Array]",uint8ClampedTag$2="[object Uint8ClampedArray]",uint16Tag$2="[object Uint16Array]",uint32Tag$2="[object Uint32Array]",typedArrayTags={};typedArrayTags[float32Tag$2]=typedArrayTags[float64Tag$2]=typedArrayTags[int8Tag$2]=typedArrayTags[int16Tag$2]=typedArrayTags[int32Tag$2]=typedArrayTags[uint8Tag$2]=typedArrayTags[uint8ClampedTag$2]=typedArrayTags[uint16Tag$2]=typedArrayTags[uint32Tag$2]=!0,typedArrayTags[argsTag$2]=typedArrayTags[arrayTag$2]=typedArrayTags[arrayBufferTag$3]=typedArrayTags[boolTag$3]=typedArrayTags[dataViewTag$4]=typedArrayTags[dateTag$3]=typedArrayTags[errorTag$2]=typedArrayTags[funcTag$1]=typedArrayTags[mapTag$5]=typedArrayTags[numberTag$3]=typedArrayTags[objectTag$4]=typedArrayTags[regexpTag$3]=typedArrayTags[setTag$5]=typedArrayTags[stringTag$3]=typedArrayTags[weakMapTag$2]=!1;function baseIsTypedArray(a){return isObjectLike(a)&&isLength(a.length)&&!!typedArrayTags[baseGetTag(a)]}function baseUnary(a){return function(s){return a(s)}}var freeExports$1=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule$1=freeExports$1&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports$1=freeModule$1&&freeModule$1.exports===freeExports$1,freeProcess=moduleExports$1&&freeGlobal$1.process,nodeUtil=function(){try{var a=freeModule$1&&freeModule$1.require&&freeModule$1.require("util").types;return a||freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch{}}(),nodeUtil$1=nodeUtil,nodeIsTypedArray=nodeUtil$1&&nodeUtil$1.isTypedArray,isTypedArray=nodeIsTypedArray?baseUnary(nodeIsTypedArray):baseIsTypedArray,isTypedArray$1=isTypedArray,objectProto$9=Object.prototype,hasOwnProperty$9=objectProto$9.hasOwnProperty;function arrayLikeKeys(a,s){var d=isArray$4(a),c=!d&&isArguments$1(a),l=!d&&!c&&isBuffer$2(a),p=!d&&!c&&!l&&isTypedArray$1(a),h=d||c||l||p,v=h?baseTimes(a.length,String):[],S=v.length;for(var b in a)(s||hasOwnProperty$9.call(a,b))&&!(h&&(b=="length"||l&&(b=="offset"||b=="parent")||p&&(b=="buffer"||b=="byteLength"||b=="byteOffset")||isIndex(b,S)))&&v.push(b);return v}function overArg(a,s){return function(d){return a(s(d))}}var nativeKeys=overArg(Object.keys,Object),nativeKeys$1=nativeKeys,objectProto$8=Object.prototype,hasOwnProperty$8=objectProto$8.hasOwnProperty;function baseKeys(a){if(!isPrototype(a))return nativeKeys$1(a);var s=[];for(var d in Object(a))hasOwnProperty$8.call(a,d)&&d!="constructor"&&s.push(d);return s}function keys$1(a){return isArrayLike$1(a)?arrayLikeKeys(a):baseKeys(a)}function nativeKeysIn(a){var s=[];if(a!=null)for(var d in Object(a))s.push(d);return s}var objectProto$7=Object.prototype,hasOwnProperty$7=objectProto$7.hasOwnProperty;function baseKeysIn(a){if(!isObject$5(a))return nativeKeysIn(a);var s=isPrototype(a),d=[];for(var c in a)c=="constructor"&&(s||!hasOwnProperty$7.call(a,c))||d.push(c);return d}function keysIn(a){return isArrayLike$1(a)?arrayLikeKeys(a,!0):baseKeysIn(a)}var reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;function isKey(a,s){if(isArray$4(a))return!1;var d=typeof a;return d=="number"||d=="symbol"||d=="boolean"||a==null||isSymbol(a)?!0:reIsPlainProp.test(a)||!reIsDeepProp.test(a)||s!=null&&a in Object(s)}var nativeCreate=getNative(Object,"create"),nativeCreate$1=nativeCreate;function hashClear(){this.__data__=nativeCreate$1?nativeCreate$1(null):{},this.size=0}function hashDelete(a){var s=this.has(a)&&delete this.__data__[a];return this.size-=s?1:0,s}var HASH_UNDEFINED$2="__lodash_hash_undefined__",objectProto$6=Object.prototype,hasOwnProperty$6=objectProto$6.hasOwnProperty;function hashGet(a){var s=this.__data__;if(nativeCreate$1){var d=s[a];return d===HASH_UNDEFINED$2?void 0:d}return hasOwnProperty$6.call(s,a)?s[a]:void 0}var objectProto$5=Object.prototype,hasOwnProperty$5=objectProto$5.hasOwnProperty;function hashHas(a){var s=this.__data__;return nativeCreate$1?s[a]!==void 0:hasOwnProperty$5.call(s,a)}var HASH_UNDEFINED$1="__lodash_hash_undefined__";function hashSet(a,s){var d=this.__data__;return this.size+=this.has(a)?0:1,d[a]=nativeCreate$1&&s===void 0?HASH_UNDEFINED$1:s,this}function Hash(a){var s=-1,d=a==null?0:a.length;for(this.clear();++s<d;){var c=a[s];this.set(c[0],c[1])}}Hash.prototype.clear=hashClear,Hash.prototype.delete=hashDelete,Hash.prototype.get=hashGet,Hash.prototype.has=hashHas,Hash.prototype.set=hashSet;function listCacheClear(){this.__data__=[],this.size=0}function assocIndexOf(a,s){for(var d=a.length;d--;)if(eq(a[d][0],s))return d;return-1}var arrayProto$1=Array.prototype,splice$1=arrayProto$1.splice;function listCacheDelete(a){var s=this.__data__,d=assocIndexOf(s,a);if(d<0)return!1;var c=s.length-1;return d==c?s.pop():splice$1.call(s,d,1),--this.size,!0}function listCacheGet(a){var s=this.__data__,d=assocIndexOf(s,a);return d<0?void 0:s[d][1]}function listCacheHas(a){return assocIndexOf(this.__data__,a)>-1}function listCacheSet(a,s){var d=this.__data__,c=assocIndexOf(d,a);return c<0?(++this.size,d.push([a,s])):d[c][1]=s,this}function ListCache(a){var s=-1,d=a==null?0:a.length;for(this.clear();++s<d;){var c=a[s];this.set(c[0],c[1])}}ListCache.prototype.clear=listCacheClear,ListCache.prototype.delete=listCacheDelete,ListCache.prototype.get=listCacheGet,ListCache.prototype.has=listCacheHas,ListCache.prototype.set=listCacheSet;var Map$1=getNative(root$1,"Map"),Map$2=Map$1;function mapCacheClear(){this.size=0,this.__data__={hash:new Hash,map:new(Map$2||ListCache),string:new Hash}}function isKeyable(a){var s=typeof a;return s=="string"||s=="number"||s=="symbol"||s=="boolean"?a!=="__proto__":a===null}function getMapData(a,s){var d=a.__data__;return isKeyable(s)?d[typeof s=="string"?"string":"hash"]:d.map}function mapCacheDelete(a){var s=getMapData(this,a).delete(a);return this.size-=s?1:0,s}function mapCacheGet(a){return getMapData(this,a).get(a)}function mapCacheHas(a){return getMapData(this,a).has(a)}function mapCacheSet(a,s){var d=getMapData(this,a),c=d.size;return d.set(a,s),this.size+=d.size==c?0:1,this}function MapCache(a){var s=-1,d=a==null?0:a.length;for(this.clear();++s<d;){var c=a[s];this.set(c[0],c[1])}}MapCache.prototype.clear=mapCacheClear,MapCache.prototype.delete=mapCacheDelete,MapCache.prototype.get=mapCacheGet,MapCache.prototype.has=mapCacheHas,MapCache.prototype.set=mapCacheSet;var FUNC_ERROR_TEXT$1="Expected a function";function memoize(a,s){if(typeof a!="function"||s!=null&&typeof s!="function")throw new TypeError(FUNC_ERROR_TEXT$1);var d=function(){var c=arguments,l=s?s.apply(this,c):c[0],p=d.cache;if(p.has(l))return p.get(l);var h=a.apply(this,c);return d.cache=p.set(l,h)||p,h};return d.cache=new(memoize.Cache||MapCache),d}memoize.Cache=MapCache;var MAX_MEMOIZE_SIZE=500;function memoizeCapped(a){var s=memoize(a,function(c){return d.size===MAX_MEMOIZE_SIZE&&d.clear(),c}),d=s.cache;return s}var rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=memoizeCapped(function(a){var s=[];return a.charCodeAt(0)===46&&s.push(""),a.replace(rePropName,function(d,c,l,p){s.push(l?p.replace(reEscapeChar,"$1"):c||d)}),s}),stringToPath$1=stringToPath;function toString$1(a){return a==null?"":baseToString(a)}function castPath(a,s){return isArray$4(a)?a:isKey(a,s)?[a]:stringToPath$1(toString$1(a))}var INFINITY=1/0;function toKey(a){if(typeof a=="string"||isSymbol(a))return a;var s=a+"";return s=="0"&&1/a==-INFINITY?"-0":s}function baseGet(a,s){s=castPath(s,a);for(var d=0,c=s.length;a!=null&&d<c;)a=a[toKey(s[d++])];return d&&d==c?a:void 0}function get(a,s,d){var c=a==null?void 0:baseGet(a,s);return c===void 0?d:c}function arrayPush(a,s){for(var d=-1,c=s.length,l=a.length;++d<c;)a[l+d]=s[d];return a}var spreadableSymbol=Symbol$2?Symbol$2.isConcatSpreadable:void 0;function isFlattenable(a){return isArray$4(a)||isArguments$1(a)||!!(spreadableSymbol&&a&&a[spreadableSymbol])}function baseFlatten(a,s,d,c,l){var p=-1,h=a.length;for(d||(d=isFlattenable),l||(l=[]);++p<h;){var v=a[p];s>0&&d(v)?s>1?baseFlatten(v,s-1,d,c,l):arrayPush(l,v):c||(l[l.length]=v)}return l}function flatten(a){var s=a==null?0:a.length;return s?baseFlatten(a,1):[]}function flatRest(a){return setToString$1(overRest(a,void 0,flatten),a+"")}var getPrototype=overArg(Object.getPrototypeOf,Object),getPrototype$1=getPrototype,objectTag$3="[object Object]",funcProto=Function.prototype,objectProto$4=Object.prototype,funcToString=funcProto.toString,hasOwnProperty$4=objectProto$4.hasOwnProperty,objectCtorString=funcToString.call(Object);function isPlainObject$1(a){if(!isObjectLike(a)||baseGetTag(a)!=objectTag$3)return!1;var s=getPrototype$1(a);if(s===null)return!0;var d=hasOwnProperty$4.call(s,"constructor")&&s.constructor;return typeof d=="function"&&d instanceof d&&funcToString.call(d)==objectCtorString}function baseSlice(a,s,d){var c=-1,l=a.length;s<0&&(s=-s>l?0:l+s),d=d>l?l:d,d<0&&(d+=l),l=s>d?0:d-s>>>0,s>>>=0;for(var p=Array(l);++c<l;)p[c]=a[c+s];return p}function castSlice(a,s,d){var c=a.length;return d=d===void 0?c:d,!s&&d>=c?a:baseSlice(a,s,d)}var rsAstralRange$2="\\ud800-\\udfff",rsComboMarksRange$3="\\u0300-\\u036f",reComboHalfMarksRange$3="\\ufe20-\\ufe2f",rsComboSymbolsRange$3="\\u20d0-\\u20ff",rsComboRange$3=rsComboMarksRange$3+reComboHalfMarksRange$3+rsComboSymbolsRange$3,rsVarRange$2="\\ufe0e\\ufe0f",rsZWJ$2="\\u200d",reHasUnicode=RegExp("["+rsZWJ$2+rsAstralRange$2+rsComboRange$3+rsVarRange$2+"]");function hasUnicode(a){return reHasUnicode.test(a)}function asciiToArray(a){return a.split("")}var rsAstralRange$1="\\ud800-\\udfff",rsComboMarksRange$2="\\u0300-\\u036f",reComboHalfMarksRange$2="\\ufe20-\\ufe2f",rsComboSymbolsRange$2="\\u20d0-\\u20ff",rsComboRange$2=rsComboMarksRange$2+reComboHalfMarksRange$2+rsComboSymbolsRange$2,rsVarRange$1="\\ufe0e\\ufe0f",rsAstral="["+rsAstralRange$1+"]",rsCombo$2="["+rsComboRange$2+"]",rsFitz$1="\\ud83c[\\udffb-\\udfff]",rsModifier$1="(?:"+rsCombo$2+"|"+rsFitz$1+")",rsNonAstral$1="[^"+rsAstralRange$1+"]",rsRegional$1="(?:\\ud83c[\\udde6-\\uddff]){2}",rsSurrPair$1="[\\ud800-\\udbff][\\udc00-\\udfff]",rsZWJ$1="\\u200d",reOptMod$1=rsModifier$1+"?",rsOptVar$1="["+rsVarRange$1+"]?",rsOptJoin$1="(?:"+rsZWJ$1+"(?:"+[rsNonAstral$1,rsRegional$1,rsSurrPair$1].join("|")+")"+rsOptVar$1+reOptMod$1+")*",rsSeq$1=rsOptVar$1+reOptMod$1+rsOptJoin$1,rsSymbol="(?:"+[rsNonAstral$1+rsCombo$2+"?",rsCombo$2,rsRegional$1,rsSurrPair$1,rsAstral].join("|")+")",reUnicode=RegExp(rsFitz$1+"(?="+rsFitz$1+")|"+rsSymbol+rsSeq$1,"g");function unicodeToArray(a){return a.match(reUnicode)||[]}function stringToArray(a){return hasUnicode(a)?unicodeToArray(a):asciiToArray(a)}function createCaseFirst(a){return function(s){s=toString$1(s);var d=hasUnicode(s)?stringToArray(s):void 0,c=d?d[0]:s.charAt(0),l=d?castSlice(d,1).join(""):s.slice(1);return c[a]()+l}}var upperFirst=createCaseFirst("toUpperCase"),upperFirst$1=upperFirst;function capitalize(a){return upperFirst$1(toString$1(a).toLowerCase())}function arrayReduce(a,s,d,c){var l=-1,p=a==null?0:a.length;for(c&&p&&(d=a[++l]);++l<p;)d=s(d,a[l],l,a);return d}function basePropertyOf(a){return function(s){return a==null?void 0:a[s]}}var deburredLetters={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},deburrLetter=basePropertyOf(deburredLetters),deburrLetter$1=deburrLetter,reLatin=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,rsComboMarksRange$1="\\u0300-\\u036f",reComboHalfMarksRange$1="\\ufe20-\\ufe2f",rsComboSymbolsRange$1="\\u20d0-\\u20ff",rsComboRange$1=rsComboMarksRange$1+reComboHalfMarksRange$1+rsComboSymbolsRange$1,rsCombo$1="["+rsComboRange$1+"]",reComboMark=RegExp(rsCombo$1,"g");function deburr(a){return a=toString$1(a),a&&a.replace(reLatin,deburrLetter$1).replace(reComboMark,"")}var reAsciiWord=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function asciiWords(a){return a.match(reAsciiWord)||[]}var reHasUnicodeWord=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function hasUnicodeWord(a){return reHasUnicodeWord.test(a)}var rsAstralRange="\\ud800-\\udfff",rsComboMarksRange="\\u0300-\\u036f",reComboHalfMarksRange="\\ufe20-\\ufe2f",rsComboSymbolsRange="\\u20d0-\\u20ff",rsComboRange=rsComboMarksRange+reComboHalfMarksRange+rsComboSymbolsRange,rsDingbatRange="\\u2700-\\u27bf",rsLowerRange="a-z\\xdf-\\xf6\\xf8-\\xff",rsMathOpRange="\\xac\\xb1\\xd7\\xf7",rsNonCharRange="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",rsPunctuationRange="\\u2000-\\u206f",rsSpaceRange=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",rsUpperRange="A-Z\\xc0-\\xd6\\xd8-\\xde",rsVarRange="\\ufe0e\\ufe0f",rsBreakRange=rsMathOpRange+rsNonCharRange+rsPunctuationRange+rsSpaceRange,rsApos$1="['\u2019]",rsBreak="["+rsBreakRange+"]",rsCombo="["+rsComboRange+"]",rsDigits="\\d+",rsDingbat="["+rsDingbatRange+"]",rsLower="["+rsLowerRange+"]",rsMisc="[^"+rsAstralRange+rsBreakRange+rsDigits+rsDingbatRange+rsLowerRange+rsUpperRange+"]",rsFitz="\\ud83c[\\udffb-\\udfff]",rsModifier="(?:"+rsCombo+"|"+rsFitz+")",rsNonAstral="[^"+rsAstralRange+"]",rsRegional="(?:\\ud83c[\\udde6-\\uddff]){2}",rsSurrPair="[\\ud800-\\udbff][\\udc00-\\udfff]",rsUpper="["+rsUpperRange+"]",rsZWJ="\\u200d",rsMiscLower="(?:"+rsLower+"|"+rsMisc+")",rsMiscUpper="(?:"+rsUpper+"|"+rsMisc+")",rsOptContrLower="(?:"+rsApos$1+"(?:d|ll|m|re|s|t|ve))?",rsOptContrUpper="(?:"+rsApos$1+"(?:D|LL|M|RE|S|T|VE))?",reOptMod=rsModifier+"?",rsOptVar="["+rsVarRange+"]?",rsOptJoin="(?:"+rsZWJ+"(?:"+[rsNonAstral,rsRegional,rsSurrPair].join("|")+")"+rsOptVar+reOptMod+")*",rsOrdLower="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",rsOrdUpper="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",rsSeq=rsOptVar+reOptMod+rsOptJoin,rsEmoji="(?:"+[rsDingbat,rsRegional,rsSurrPair].join("|")+")"+rsSeq,reUnicodeWord=RegExp([rsUpper+"?"+rsLower+"+"+rsOptContrLower+"(?="+[rsBreak,rsUpper,"$"].join("|")+")",rsMiscUpper+"+"+rsOptContrUpper+"(?="+[rsBreak,rsUpper+rsMiscLower,"$"].join("|")+")",rsUpper+"?"+rsMiscLower+"+"+rsOptContrLower,rsUpper+"+"+rsOptContrUpper,rsOrdUpper,rsOrdLower,rsDigits,rsEmoji].join("|"),"g");function unicodeWords(a){return a.match(reUnicodeWord)||[]}function words(a,s,d){return a=toString$1(a),s=d?void 0:s,s===void 0?hasUnicodeWord(a)?unicodeWords(a):asciiWords(a):a.match(s)||[]}var rsApos="['\u2019]",reApos=RegExp(rsApos,"g");function createCompounder(a){return function(s){return arrayReduce(words(deburr(s).replace(reApos,"")),a,"")}}var camelCase$2=createCompounder(function(a,s,d){return s=s.toLowerCase(),a+(d?capitalize(s):s)}),camelCase$3=camelCase$2;function stackClear(){this.__data__=new ListCache,this.size=0}function stackDelete(a){var s=this.__data__,d=s.delete(a);return this.size=s.size,d}function stackGet(a){return this.__data__.get(a)}function stackHas(a){return this.__data__.has(a)}var LARGE_ARRAY_SIZE=200;function stackSet(a,s){var d=this.__data__;if(d instanceof ListCache){var c=d.__data__;if(!Map$2||c.length<LARGE_ARRAY_SIZE-1)return c.push([a,s]),this.size=++d.size,this;d=this.__data__=new MapCache(c)}return d.set(a,s),this.size=d.size,this}function Stack(a){var s=this.__data__=new ListCache(a);this.size=s.size}Stack.prototype.clear=stackClear,Stack.prototype.delete=stackDelete,Stack.prototype.get=stackGet,Stack.prototype.has=stackHas,Stack.prototype.set=stackSet;function baseAssign(a,s){return a&&copyObject(s,keys$1(s),a)}function baseAssignIn(a,s){return a&&copyObject(s,keysIn(s),a)}var freeExports=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports=freeModule&&freeModule.exports===freeExports,Buffer$1=moduleExports?root$1.Buffer:void 0,allocUnsafe=Buffer$1?Buffer$1.allocUnsafe:void 0;function cloneBuffer(a,s){if(s)return a.slice();var d=a.length,c=allocUnsafe?allocUnsafe(d):new a.constructor(d);return a.copy(c),c}function arrayFilter(a,s){for(var d=-1,c=a==null?0:a.length,l=0,p=[];++d<c;){var h=a[d];s(h,d,a)&&(p[l++]=h)}return p}function stubArray(){return[]}var objectProto$3=Object.prototype,propertyIsEnumerable=objectProto$3.propertyIsEnumerable,nativeGetSymbols$1=Object.getOwnPropertySymbols,getSymbols=nativeGetSymbols$1?function(a){return a==null?[]:(a=Object(a),arrayFilter(nativeGetSymbols$1(a),function(s){return propertyIsEnumerable.call(a,s)}))}:stubArray,getSymbols$1=getSymbols;function copySymbols(a,s){return copyObject(a,getSymbols$1(a),s)}var nativeGetSymbols=Object.getOwnPropertySymbols,getSymbolsIn=nativeGetSymbols?function(a){for(var s=[];a;)arrayPush(s,getSymbols$1(a)),a=getPrototype$1(a);return s}:stubArray,getSymbolsIn$1=getSymbolsIn;function copySymbolsIn(a,s){return copyObject(a,getSymbolsIn$1(a),s)}function baseGetAllKeys(a,s,d){var c=s(a);return isArray$4(a)?c:arrayPush(c,d(a))}function getAllKeys(a){return baseGetAllKeys(a,keys$1,getSymbols$1)}function getAllKeysIn(a){return baseGetAllKeys(a,keysIn,getSymbolsIn$1)}var DataView$1=getNative(root$1,"DataView"),DataView$2=DataView$1,Promise$1=getNative(root$1,"Promise"),Promise$2=Promise$1,Set$1=getNative(root$1,"Set"),Set$2=Set$1,mapTag$4="[object Map]",objectTag$2="[object Object]",promiseTag="[object Promise]",setTag$4="[object Set]",weakMapTag$1="[object WeakMap]",dataViewTag$3="[object DataView]",dataViewCtorString=toSource(DataView$2),mapCtorString=toSource(Map$2),promiseCtorString=toSource(Promise$2),setCtorString=toSource(Set$2),weakMapCtorString=toSource(WeakMap$3),getTag=baseGetTag;(DataView$2&&getTag(new DataView$2(new ArrayBuffer(1)))!=dataViewTag$3||Map$2&&getTag(new Map$2)!=mapTag$4||Promise$2&&getTag(Promise$2.resolve())!=promiseTag||Set$2&&getTag(new Set$2)!=setTag$4||WeakMap$3&&getTag(new WeakMap$3)!=weakMapTag$1)&&(getTag=function(a){var s=baseGetTag(a),d=s==objectTag$2?a.constructor:void 0,c=d?toSource(d):"";if(c)switch(c){case dataViewCtorString:return dataViewTag$3;case mapCtorString:return mapTag$4;case promiseCtorString:return promiseTag;case setCtorString:return setTag$4;case weakMapCtorString:return weakMapTag$1}return s});var getTag$1=getTag,objectProto$2=Object.prototype,hasOwnProperty$3=objectProto$2.hasOwnProperty;function initCloneArray(a){var s=a.length,d=new a.constructor(s);return s&&typeof a[0]=="string"&&hasOwnProperty$3.call(a,"index")&&(d.index=a.index,d.input=a.input),d}var Uint8Array$1=root$1.Uint8Array,Uint8Array$2=Uint8Array$1;function cloneArrayBuffer(a){var s=new a.constructor(a.byteLength);return new Uint8Array$2(s).set(new Uint8Array$2(a)),s}function cloneDataView(a,s){var d=s?cloneArrayBuffer(a.buffer):a.buffer;return new a.constructor(d,a.byteOffset,a.byteLength)}var reFlags=/\w*$/;function cloneRegExp(a){var s=new a.constructor(a.source,reFlags.exec(a));return s.lastIndex=a.lastIndex,s}var symbolProto$1=Symbol$2?Symbol$2.prototype:void 0,symbolValueOf$1=symbolProto$1?symbolProto$1.valueOf:void 0;function cloneSymbol(a){return symbolValueOf$1?Object(symbolValueOf$1.call(a)):{}}function cloneTypedArray(a,s){var d=s?cloneArrayBuffer(a.buffer):a.buffer;return new a.constructor(d,a.byteOffset,a.length)}var boolTag$2="[object Boolean]",dateTag$2="[object Date]",mapTag$3="[object Map]",numberTag$2="[object Number]",regexpTag$2="[object RegExp]",setTag$3="[object Set]",stringTag$2="[object String]",symbolTag$2="[object Symbol]",arrayBufferTag$2="[object ArrayBuffer]",dataViewTag$2="[object DataView]",float32Tag$1="[object Float32Array]",float64Tag$1="[object Float64Array]",int8Tag$1="[object Int8Array]",int16Tag$1="[object Int16Array]",int32Tag$1="[object Int32Array]",uint8Tag$1="[object Uint8Array]",uint8ClampedTag$1="[object Uint8ClampedArray]",uint16Tag$1="[object Uint16Array]",uint32Tag$1="[object Uint32Array]";function initCloneByTag(a,s,d){var c=a.constructor;switch(s){case arrayBufferTag$2:return cloneArrayBuffer(a);case boolTag$2:case dateTag$2:return new c(+a);case dataViewTag$2:return cloneDataView(a,d);case float32Tag$1:case float64Tag$1:case int8Tag$1:case int16Tag$1:case int32Tag$1:case uint8Tag$1:case uint8ClampedTag$1:case uint16Tag$1:case uint32Tag$1:return cloneTypedArray(a,d);case mapTag$3:return new c;case numberTag$2:case stringTag$2:return new c(a);case regexpTag$2:return cloneRegExp(a);case setTag$3:return new c;case symbolTag$2:return cloneSymbol(a)}}function initCloneObject(a){return typeof a.constructor=="function"&&!isPrototype(a)?baseCreate$1(getPrototype$1(a)):{}}var mapTag$2="[object Map]";function baseIsMap(a){return isObjectLike(a)&&getTag$1(a)==mapTag$2}var nodeIsMap=nodeUtil$1&&nodeUtil$1.isMap,isMap=nodeIsMap?baseUnary(nodeIsMap):baseIsMap,isMap$1=isMap,setTag$2="[object Set]";function baseIsSet(a){return isObjectLike(a)&&getTag$1(a)==setTag$2}var nodeIsSet=nodeUtil$1&&nodeUtil$1.isSet,isSet$3=nodeIsSet?baseUnary(nodeIsSet):baseIsSet,isSet$4=isSet$3,CLONE_DEEP_FLAG$3=1,CLONE_FLAT_FLAG$1=2,CLONE_SYMBOLS_FLAG$2=4,argsTag$1="[object Arguments]",arrayTag$1="[object Array]",boolTag$1="[object Boolean]",dateTag$1="[object Date]",errorTag$1="[object Error]",funcTag="[object Function]",genTag="[object GeneratorFunction]",mapTag$1="[object Map]",numberTag$1="[object Number]",objectTag$1="[object Object]",regexpTag$1="[object RegExp]",setTag$1="[object Set]",stringTag$1="[object String]",symbolTag$1="[object Symbol]",weakMapTag="[object WeakMap]",arrayBufferTag$1="[object ArrayBuffer]",dataViewTag$1="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",cloneableTags={};cloneableTags[argsTag$1]=cloneableTags[arrayTag$1]=cloneableTags[arrayBufferTag$1]=cloneableTags[dataViewTag$1]=cloneableTags[boolTag$1]=cloneableTags[dateTag$1]=cloneableTags[float32Tag]=cloneableTags[float64Tag]=cloneableTags[int8Tag]=cloneableTags[int16Tag]=cloneableTags[int32Tag]=cloneableTags[mapTag$1]=cloneableTags[numberTag$1]=cloneableTags[objectTag$1]=cloneableTags[regexpTag$1]=cloneableTags[setTag$1]=cloneableTags[stringTag$1]=cloneableTags[symbolTag$1]=cloneableTags[uint8Tag]=cloneableTags[uint8ClampedTag]=cloneableTags[uint16Tag]=cloneableTags[uint32Tag]=!0,cloneableTags[errorTag$1]=cloneableTags[funcTag]=cloneableTags[weakMapTag]=!1;function baseClone(a,s,d,c,l,p){var h,v=s&CLONE_DEEP_FLAG$3,S=s&CLONE_FLAT_FLAG$1,b=s&CLONE_SYMBOLS_FLAG$2;if(d&&(h=l?d(a,c,l,p):d(a)),h!==void 0)return h;if(!isObject$5(a))return a;var _=isArray$4(a);if(_){if(h=initCloneArray(a),!v)return copyArray(a,h)}else{var I=getTag$1(a),T=I==funcTag||I==genTag;if(isBuffer$2(a))return cloneBuffer(a,v);if(I==objectTag$1||I==argsTag$1||T&&!l){if(h=S||T?{}:initCloneObject(a),!v)return S?copySymbolsIn(a,baseAssignIn(h,a)):copySymbols(a,baseAssign(h,a))}else{if(!cloneableTags[I])return l?a:{};h=initCloneByTag(a,I,v)}}p||(p=new Stack);var k=p.get(a);if(k)return k;p.set(a,h),isSet$4(a)?a.forEach(function($){h.add(baseClone($,s,d,$,a,p))}):isMap$1(a)&&a.forEach(function($,U){h.set(U,baseClone($,s,d,U,a,p))});var w=b?S?getAllKeysIn:getAllKeys:S?keysIn:keys$1,P=_?void 0:w(a);return arrayEach(P||a,function($,U){P&&(U=$,$=a[U]),assignValue(h,U,baseClone($,s,d,U,a,p))}),h}var CLONE_DEEP_FLAG$2=1,CLONE_SYMBOLS_FLAG$1=4;function cloneDeep(a){return baseClone(a,CLONE_DEEP_FLAG$2|CLONE_SYMBOLS_FLAG$1)}var HASH_UNDEFINED="__lodash_hash_undefined__";function setCacheAdd(a){return this.__data__.set(a,HASH_UNDEFINED),this}function setCacheHas(a){return this.__data__.has(a)}function SetCache(a){var s=-1,d=a==null?0:a.length;for(this.__data__=new MapCache;++s<d;)this.add(a[s])}SetCache.prototype.add=SetCache.prototype.push=setCacheAdd,SetCache.prototype.has=setCacheHas;function arraySome(a,s){for(var d=-1,c=a==null?0:a.length;++d<c;)if(s(a[d],d,a))return!0;return!1}function cacheHas(a,s){return a.has(s)}var COMPARE_PARTIAL_FLAG$5=1,COMPARE_UNORDERED_FLAG$3=2;function equalArrays(a,s,d,c,l,p){var h=d&COMPARE_PARTIAL_FLAG$5,v=a.length,S=s.length;if(v!=S&&!(h&&S>v))return!1;var b=p.get(a),_=p.get(s);if(b&&_)return b==s&&_==a;var I=-1,T=!0,k=d&COMPARE_UNORDERED_FLAG$3?new SetCache:void 0;for(p.set(a,s),p.set(s,a);++I<v;){var w=a[I],P=s[I];if(c)var $=h?c(P,w,I,s,a,p):c(w,P,I,a,s,p);if($!==void 0){if($)continue;T=!1;break}if(k){if(!arraySome(s,function(U,E){if(!cacheHas(k,E)&&(w===U||l(w,U,d,c,p)))return k.push(E)})){T=!1;break}}else if(!(w===P||l(w,P,d,c,p))){T=!1;break}}return p.delete(a),p.delete(s),T}function mapToArray(a){var s=-1,d=Array(a.size);return a.forEach(function(c,l){d[++s]=[l,c]}),d}function setToArray(a){var s=-1,d=Array(a.size);return a.forEach(function(c){d[++s]=c}),d}var COMPARE_PARTIAL_FLAG$4=1,COMPARE_UNORDERED_FLAG$2=2,boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",mapTag="[object Map]",numberTag="[object Number]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",symbolTag="[object Symbol]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",symbolProto=Symbol$2?Symbol$2.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0;function equalByTag(a,s,d,c,l,p,h){switch(d){case dataViewTag:if(a.byteLength!=s.byteLength||a.byteOffset!=s.byteOffset)return!1;a=a.buffer,s=s.buffer;case arrayBufferTag:return!(a.byteLength!=s.byteLength||!p(new Uint8Array$2(a),new Uint8Array$2(s)));case boolTag:case dateTag:case numberTag:return eq(+a,+s);case errorTag:return a.name==s.name&&a.message==s.message;case regexpTag:case stringTag:return a==s+"";case mapTag:var v=mapToArray;case setTag:var S=c&COMPARE_PARTIAL_FLAG$4;if(v||(v=setToArray),a.size!=s.size&&!S)return!1;var b=h.get(a);if(b)return b==s;c|=COMPARE_UNORDERED_FLAG$2,h.set(a,s);var _=equalArrays(v(a),v(s),c,l,p,h);return h.delete(a),_;case symbolTag:if(symbolValueOf)return symbolValueOf.call(a)==symbolValueOf.call(s)}return!1}var COMPARE_PARTIAL_FLAG$3=1,objectProto$1=Object.prototype,hasOwnProperty$2=objectProto$1.hasOwnProperty;function equalObjects(a,s,d,c,l,p){var h=d&COMPARE_PARTIAL_FLAG$3,v=getAllKeys(a),S=v.length,b=getAllKeys(s),_=b.length;if(S!=_&&!h)return!1;for(var I=S;I--;){var T=v[I];if(!(h?T in s:hasOwnProperty$2.call(s,T)))return!1}var k=p.get(a),w=p.get(s);if(k&&w)return k==s&&w==a;var P=!0;p.set(a,s),p.set(s,a);for(var $=h;++I<S;){T=v[I];var U=a[T],E=s[T];if(c)var D=h?c(E,U,T,s,a,p):c(U,E,T,a,s,p);if(!(D===void 0?U===E||l(U,E,d,c,p):D)){P=!1;break}$||($=T=="constructor")}if(P&&!$){var F=a.constructor,J=s.constructor;F!=J&&"constructor"in a&&"constructor"in s&&!(typeof F=="function"&&F instanceof F&&typeof J=="function"&&J instanceof J)&&(P=!1)}return p.delete(a),p.delete(s),P}var COMPARE_PARTIAL_FLAG$2=1,argsTag="[object Arguments]",arrayTag="[object Array]",objectTag="[object Object]",objectProto=Object.prototype,hasOwnProperty$1=objectProto.hasOwnProperty;function baseIsEqualDeep(a,s,d,c,l,p){var h=isArray$4(a),v=isArray$4(s),S=h?arrayTag:getTag$1(a),b=v?arrayTag:getTag$1(s);S=S==argsTag?objectTag:S,b=b==argsTag?objectTag:b;var _=S==objectTag,I=b==objectTag,T=S==b;if(T&&isBuffer$2(a)){if(!isBuffer$2(s))return!1;h=!0,_=!1}if(T&&!_)return p||(p=new Stack),h||isTypedArray$1(a)?equalArrays(a,s,d,c,l,p):equalByTag(a,s,S,d,c,l,p);if(!(d&COMPARE_PARTIAL_FLAG$2)){var k=_&&hasOwnProperty$1.call(a,"__wrapped__"),w=I&&hasOwnProperty$1.call(s,"__wrapped__");if(k||w){var P=k?a.value():a,$=w?s.value():s;return p||(p=new Stack),l(P,$,d,c,p)}}return T?(p||(p=new Stack),equalObjects(a,s,d,c,l,p)):!1}function baseIsEqual(a,s,d,c,l){return a===s?!0:a==null||s==null||!isObjectLike(a)&&!isObjectLike(s)?a!==a&&s!==s:baseIsEqualDeep(a,s,d,c,baseIsEqual,l)}var COMPARE_PARTIAL_FLAG$1=1,COMPARE_UNORDERED_FLAG$1=2;function baseIsMatch(a,s,d,c){var l=d.length,p=l,h=!c;if(a==null)return!p;for(a=Object(a);l--;){var v=d[l];if(h&&v[2]?v[1]!==a[v[0]]:!(v[0]in a))return!1}for(;++l<p;){v=d[l];var S=v[0],b=a[S],_=v[1];if(h&&v[2]){if(b===void 0&&!(S in a))return!1}else{var I=new Stack;if(c)var T=c(b,_,S,a,s,I);if(!(T===void 0?baseIsEqual(_,b,COMPARE_PARTIAL_FLAG$1|COMPARE_UNORDERED_FLAG$1,c,I):T))return!1}}return!0}function isStrictComparable(a){return a===a&&!isObject$5(a)}function getMatchData(a){for(var s=keys$1(a),d=s.length;d--;){var c=s[d],l=a[c];s[d]=[c,l,isStrictComparable(l)]}return s}function matchesStrictComparable(a,s){return function(d){return d==null?!1:d[a]===s&&(s!==void 0||a in Object(d))}}function baseMatches(a){var s=getMatchData(a);return s.length==1&&s[0][2]?matchesStrictComparable(s[0][0],s[0][1]):function(d){return d===a||baseIsMatch(d,a,s)}}function baseHasIn(a,s){return a!=null&&s in Object(a)}function hasPath(a,s,d){s=castPath(s,a);for(var c=-1,l=s.length,p=!1;++c<l;){var h=toKey(s[c]);if(!(p=a!=null&&d(a,h)))break;a=a[h]}return p||++c!=l?p:(l=a==null?0:a.length,!!l&&isLength(l)&&isIndex(h,l)&&(isArray$4(a)||isArguments$1(a)))}function hasIn(a,s){return a!=null&&hasPath(a,s,baseHasIn)}var COMPARE_PARTIAL_FLAG=1,COMPARE_UNORDERED_FLAG=2;function baseMatchesProperty(a,s){return isKey(a)&&isStrictComparable(s)?matchesStrictComparable(toKey(a),s):function(d){var c=get(d,a);return c===void 0&&c===s?hasIn(d,a):baseIsEqual(s,c,COMPARE_PARTIAL_FLAG|COMPARE_UNORDERED_FLAG)}}function baseProperty(a){return function(s){return s==null?void 0:s[a]}}function basePropertyDeep(a){return function(s){return baseGet(s,a)}}function property(a){return isKey(a)?baseProperty(toKey(a)):basePropertyDeep(a)}function baseIteratee(a){return typeof a=="function"?a:a==null?identity$1:typeof a=="object"?isArray$4(a)?baseMatchesProperty(a[0],a[1]):baseMatches(a):property(a)}function createBaseFor(a){return function(s,d,c){for(var l=-1,p=Object(s),h=c(s),v=h.length;v--;){var S=h[a?v:++l];if(d(p[S],S,p)===!1)break}return s}}var baseFor=createBaseFor(),baseFor$1=baseFor;function baseForOwn(a,s){return a&&baseFor$1(a,s,keys$1)}function createBaseEach(a,s){return function(d,c){if(d==null)return d;if(!isArrayLike$1(d))return a(d,c);for(var l=d.length,p=s?l:-1,h=Object(d);(s?p--:++p<l)&&c(h[p],p,h)!==!1;);return d}}var baseEach=createBaseEach(baseForOwn),baseEach$1=baseEach,now=function(){return root$1.Date.now()},now$1=now,FUNC_ERROR_TEXT="Expected a function",nativeMax=Math.max,nativeMin=Math.min;function debounce$1(a,s,d){var c,l,p,h,v,S,b=0,_=!1,I=!1,T=!0;if(typeof a!="function")throw new TypeError(FUNC_ERROR_TEXT);s=toNumber(s)||0,isObject$5(d)&&(_=!!d.leading,I="maxWait"in d,p=I?nativeMax(toNumber(d.maxWait)||0,s):p,T="trailing"in d?!!d.trailing:T);function k(G){var x=c,Y=l;return c=l=void 0,b=G,h=a.apply(Y,x),h}function w(G){return b=G,v=setTimeout(U,s),_?k(G):h}function P(G){var x=G-S,Y=G-b,N=s-x;return I?nativeMin(N,p-Y):N}function $(G){var x=G-S,Y=G-b;return S===void 0||x>=s||x<0||I&&Y>=p}function U(){var G=now$1();if($(G))return E(G);v=setTimeout(U,P(G))}function E(G){return v=void 0,T&&c?k(G):(c=l=void 0,h)}function D(){v!==void 0&&clearTimeout(v),b=0,c=S=l=v=void 0}function F(){return v===void 0?h:E(now$1())}function J(){var G=now$1(),x=$(G);if(c=arguments,l=this,S=G,x){if(v===void 0)return w(S);if(I)return clearTimeout(v),v=setTimeout(U,s),k(S)}return v===void 0&&(v=setTimeout(U,s)),h}return J.cancel=D,J.flush=F,J}function last$1(a){var s=a==null?0:a.length;return s?a[s-1]:void 0}function arrayEvery(a,s){for(var d=-1,c=a==null?0:a.length;++d<c;)if(!s(a[d],d,a))return!1;return!0}function baseEvery(a,s){var d=!0;return baseEach$1(a,function(c,l,p){return d=!!s(c,l,p),d}),d}function every$1(a,s,d){var c=isArray$4(a)?arrayEvery:baseEvery;return d&&isIterateeCall(a,s,d)&&(s=void 0),c(a,baseIteratee(s))}function baseMap(a,s){var d=-1,c=isArrayLike$1(a)?Array(a.length):[];return baseEach$1(a,function(l,p,h){c[++d]=s(l,p,h)}),c}function parent(a,s){return s.length<2?a:baseGet(a,baseSlice(s,0,-1))}function isEqual(a,s){return baseIsEqual(a,s)}function isMatch(a,s){return a===s||baseIsMatch(a,s,getMatchData(s))}var CLONE_DEEP_FLAG$1=1;function iteratee(a){return baseIteratee(typeof a=="function"?a:baseClone(a,CLONE_DEEP_FLAG$1))}var kebabCase=createCompounder(function(a,s,d){return a+(d?"-":"")+s.toLowerCase()}),kebabCase$1=kebabCase;function baseUnset(a,s){return s=castPath(s,a),a=parent(a,s),a==null||delete a[toKey(last$1(s))]}function customOmitClone(a){return isPlainObject$1(a)?void 0:a}var CLONE_DEEP_FLAG=1,CLONE_FLAT_FLAG=2,CLONE_SYMBOLS_FLAG=4,omit=flatRest(function(a,s){var d={};if(a==null)return d;var c=!1;s=arrayMap(s,function(p){return p=castPath(p,a),c||(c=p.length>1),p}),copyObject(a,getAllKeysIn(a),d),c&&(d=baseClone(d,CLONE_DEEP_FLAG|CLONE_FLAT_FLAG|CLONE_SYMBOLS_FLAG,customOmitClone));for(var l=s.length;l--;)baseUnset(d,s[l]);return d}),omit$1=omit;function baseSet(a,s,d,c){if(!isObject$5(a))return a;s=castPath(s,a);for(var l=-1,p=s.length,h=p-1,v=a;v!=null&&++l<p;){var S=toKey(s[l]),b=d;if(S==="__proto__"||S==="constructor"||S==="prototype")return a;if(l!=h){var _=v[S];b=c?c(_,S,v):void 0,b===void 0&&(b=isObject$5(_)?_:isIndex(s[l+1])?[]:{})}assignValue(v,S,b),v=v[S]}return a}function basePickBy(a,s,d){for(var c=-1,l=s.length,p={};++c<l;){var h=s[c],v=baseGet(a,h);d(v,h)&&baseSet(p,castPath(h,a),v)}return p}function baseSortBy(a,s){var d=a.length;for(a.sort(s);d--;)a[d]=a[d].value;return a}function compareAscending(a,s){if(a!==s){var d=a!==void 0,c=a===null,l=a===a,p=isSymbol(a),h=s!==void 0,v=s===null,S=s===s,b=isSymbol(s);if(!v&&!b&&!p&&a>s||p&&h&&S&&!v&&!b||c&&h&&S||!d&&S||!l)return 1;if(!c&&!p&&!b&&a<s||b&&d&&l&&!c&&!p||v&&d&&l||!h&&l||!S)return-1}return 0}function compareMultiple(a,s,d){for(var c=-1,l=a.criteria,p=s.criteria,h=l.length,v=d.length;++c<h;){var S=compareAscending(l[c],p[c]);if(S){if(c>=v)return S;var b=d[c];return S*(b=="desc"?-1:1)}}return a.index-s.index}function baseOrderBy(a,s,d){s.length?s=arrayMap(s,function(p){return isArray$4(p)?function(h){return baseGet(h,p.length===1?p[0]:p)}:p}):s=[identity$1];var c=-1;s=arrayMap(s,baseUnary(baseIteratee));var l=baseMap(a,function(p,h,v){var S=arrayMap(s,function(b){return b(p)});return{criteria:S,index:++c,value:p}});return baseSortBy(l,function(p,h){return compareMultiple(p,h,d)})}function basePick(a,s){return basePickBy(a,s,function(d,c){return hasIn(a,c)})}var pick=flatRest(function(a,s){return a==null?{}:basePick(a,s)}),pick$1=pick;function baseIndexOfWith(a,s,d,c){for(var l=d-1,p=a.length;++l<p;)if(c(a[l],s))return l;return-1}var arrayProto=Array.prototype,splice=arrayProto.splice;function basePullAll(a,s,d,c){var l=c?baseIndexOfWith:baseIndexOf,p=-1,h=s.length,v=a;for(a===s&&(s=copyArray(s)),d&&(v=arrayMap(a,baseUnary(d)));++p<h;)for(var S=0,b=s[p],_=d?d(b):b;(S=l(v,_,S,c))>-1;)v!==a&&splice.call(v,S,1),splice.call(a,S,1);return a}function pullAll(a,s){return a&&a.length&&s&&s.length?basePullAll(a,s):a}var pull$1=baseRest(pullAll),pull$2=pull$1,sortBy=baseRest(function(a,s){if(a==null)return[];var d=s.length;return d>1&&isIterateeCall(a,s[0],s[1])?s=[]:d>2&&isIterateeCall(s[0],s[1],s[2])&&(s=[s[0]]),baseOrderBy(a,baseFlatten(s,1),[])}),sortBy$1=sortBy;const convert=function(a){if(a==null)return ok;if(typeof a=="string")return typeFactory(a);if(typeof a=="object")return Array.isArray(a)?anyFactory(a):propsFactory(a);if(typeof a=="function")return castFactory(a);throw new Error("Expected function, string, or object as test")};function anyFactory(a){const s=[];let d=-1;for(;++d<a.length;)s[d]=convert(a[d]);return castFactory(c);function c(...l){let p=-1;for(;++p<s.length;)if(s[p].call(this,...l))return!0;return!1}}function propsFactory(a){return castFactory(s);function s(d){let c;for(c in a)if(d[c]!==a[c])return!1;return!0}}function typeFactory(a){return castFactory(s);function s(d){return d&&d.type===a}}function castFactory(a){return s;function s(d,...c){return Boolean(d&&typeof d=="object"&&"type"in d&&Boolean(a.call(this,d,...c)))}}function ok(){return!0}function color$1(a){return a}const CONTINUE=!0,EXIT=!1,SKIP="skip",visitParents=function(a,s,d,c){typeof s=="function"&&typeof d!="function"&&(c=d,d=s,s=null);const l=convert(s),p=c?-1:1;h(a,void 0,[])();function h(v,S,b){const _=v&&typeof v=="object"?v:{};if(typeof _.type=="string"){const T=typeof _.tagName=="string"?_.tagName:typeof _.name=="string"?_.name:void 0;Object.defineProperty(I,"name",{value:"node ("+(v.type+(T?"<"+T+">":""))+")"})}return I;function I(){let T=[],k,w,P;if((!s||l(v,S,b[b.length-1]||null))&&(T=toResult(d(v,b)),T[0]===EXIT))return T;if(v.children&&T[0]!==SKIP)for(w=(c?v.children.length:-1)+p,P=b.concat(v);w>-1&&w<v.children.length;){if(k=h(v.children[w],w,P)(),k[0]===EXIT)return k;w=typeof k[1]=="number"?k[1]:w+p}return T}}};function toResult(a){return Array.isArray(a)?a:typeof a=="number"?[CONTINUE,a]:[a]}const visit=function(a,s,d,c){typeof s=="function"&&typeof d!="function"&&(c=d,d=s,s=null),visitParents(a,s,l,c);function l(p,h){const v=h[h.length-1];return d(p,v?v.children.indexOf(p):null,v)}};var fastDeepEqual=function a(s,d){if(s===d)return!0;if(s&&d&&typeof s=="object"&&typeof d=="object"){if(s.constructor!==d.constructor)return!1;var c,l,p;if(Array.isArray(s)){if(c=s.length,c!=d.length)return!1;for(l=c;l--!==0;)if(!a(s[l],d[l]))return!1;return!0}if(s.constructor===RegExp)return s.source===d.source&&s.flags===d.flags;if(s.valueOf!==Object.prototype.valueOf)return s.valueOf()===d.valueOf();if(s.toString!==Object.prototype.toString)return s.toString()===d.toString();if(p=Object.keys(s),c=p.length,c!==Object.keys(d).length)return!1;for(l=c;l--!==0;)if(!Object.prototype.hasOwnProperty.call(d,p[l]))return!1;for(l=c;l--!==0;){var h=p[l];if(!a(s[h],d[h]))return!1}return!0}return s!==s&&d!==d};const generateId=()=>(Math.random()*1e20).toString(36),insertAt$1=(a=0,s,d,c=!1)=>[...d.slice(0,a),...[s].flat(),...d.slice(c?a+1:a)],replaceItem$1=(a,s,d)=>{a=typeof a=="function"?a:l=>l===a;const c=d.findIndex(a);return c<0?d:insertAt$1(c,s,d,!0)},swapIndex=(a,s,d)=>{if(!d[a]||!d[s])return d;d=[...d];const c=d[a];return d[a]=d[s],d[s]=c,d},swapItems=(a,s,d)=>{const c=d.findIndex(p=>p===a),l=d.findIndex(p=>p===s);return c<0||l<0?d:swapIndex(c,l,d)},toDataNode$1=a=>a?{id:a.id,props:a.props,childIds:(a.children||[]).map(s=>s.id)}:null,toSceneNode=a=>({id:a.id,props:a.props,children:[]}),toSceneTree=(a,s)=>{const d=a.find(l=>l.id===s);if(!d)return null;const c=d.childIds;return{id:d.id,props:d.props,children:c.map(l=>toSceneTree(a,l)).filter(Boolean)}},forEachDown$1=(a,s)=>{s(a),(a.children||[]).forEach(c=>forEachDown$1(c,(l,p)=>{s(l,p||a)}))},mapDown=(a,s)=>{const d=s(a);return{...d,children:((d==null?void 0:d.children)||(a==null?void 0:a.children)||[]).map(c=>mapDown(c,s))}},mapDownAsync=async(a,s)=>{var c;const d=(c=a==null?void 0:a.children)!=null?c:[];return{...await s(a),children:await Promise.all(d.map(l=>mapDownAsync(l,s)))}},getElementAttributes=a=>Object.values(a.attributes).reduce((s,d)=>({...s,[d.name]:d.value}),{}),asArray=a=>isArray$4(a)?a:[a],sizeToNum=(a,s)=>typeof a=="number"?a:typeof a=="string"?a.indexOf("%")>-1?parseFloat(a)/100*s:parseFloat(a):0,asSize=a=>typeof a=="number"?a+"px":typeof a=="string"?a.indexOf("%")>-1?parseFloat(a)+"%":a:"0px",asDuration=a=>typeof a=="string"?a:typeof a=="number"?a+"ms":"0ms",find$2=(a,s)=>{if(!a)throw new Error("requires a tree to search");if(!s)throw new Error("requires a condition");const d=iteratee(s);let c;return visit(a,function(l){if(d(l))return c=l,!1}),c},findAll=(a,s)=>{if(!a)throw new Error("requires a tree to search");if(!s)throw new Error("requires a condition");const d=iteratee(s);let c=[];return visit(a,function(l){d(l)&&c.push(l)}),c},values=a=>Array.from(a.values());var Logic=Object.freeze(Object.defineProperty({__proto__:null,deepEqual:fastDeepEqual,generateId,insertAt:insertAt$1,replaceItem:replaceItem$1,swapIndex,swapItems,toDataNode:toDataNode$1,toSceneNode,toSceneTree,forEachDown:forEachDown$1,mapDown,mapDownAsync,getElementAttributes,asArray,sizeToNum,asSize,asDuration,find:find$2,findAll,values,pick:pick$1,pull:pull$2,omit:omit$1,isEqual,cloneDeep,sortBy:sortBy$1,debounce:debounce$1,camelCase:camelCase$3,kebabCase:kebabCase$1,isArray:isArray$4,every:every$1},Symbol.toStringTag,{value:"Module"})),lib$2={};function e(a){this.message=a}e.prototype=new Error,e.prototype.name="InvalidCharacterError";var r$1=typeof window!="undefined"&&window.atob&&window.atob.bind(window)||function(a){var s=String(a).replace(/=+$/,"");if(s.length%4==1)throw new e("'atob' failed: The string to be decoded is not correctly encoded.");for(var d,c,l=0,p=0,h="";c=s.charAt(p++);~c&&(d=l%4?64*d+c:c,l++%4)?h+=String.fromCharCode(255&d>>(-2*l&6)):0)c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c);return h};function t(a){var s=a.replace(/-/g,"+").replace(/_/g,"/");switch(s.length%4){case 0:break;case 2:s+="==";break;case 3:s+="=";break;default:throw"Illegal base64url string!"}try{return function(d){return decodeURIComponent(r$1(d).replace(/(.)/g,function(c,l){var p=l.charCodeAt(0).toString(16).toUpperCase();return p.length<2&&(p="0"+p),"%"+p}))}(s)}catch{return r$1(s)}}function n(a){this.message=a}function o(a,s){if(typeof a!="string")throw new n("Invalid token specified");var d=(s=s||{}).header===!0?0:1;try{return JSON.parse(t(a.split(".")[d]))}catch(c){throw new n("Invalid token specified: "+c.message)}}n.prototype=new Error,n.prototype.name="InvalidTokenError";var jwtDecode_esm=Object.freeze(Object.defineProperty({__proto__:null,default:o,InvalidTokenError:n},Symbol.toStringTag,{value:"Module"})),require$$0$1=getAugmentedNamespace(jwtDecode_esm),getRandomValues,rnds8=new Uint8Array(16);function rng(){if(!getRandomValues&&(getRandomValues=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!getRandomValues))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return getRandomValues(rnds8)}var REGEX=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function validate$1(a){return typeof a=="string"&&REGEX.test(a)}for(var byteToHex=[],i=0;i<256;++i)byteToHex.push((i+256).toString(16).substr(1));function stringify(a){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,d=(byteToHex[a[s+0]]+byteToHex[a[s+1]]+byteToHex[a[s+2]]+byteToHex[a[s+3]]+"-"+byteToHex[a[s+4]]+byteToHex[a[s+5]]+"-"+byteToHex[a[s+6]]+byteToHex[a[s+7]]+"-"+byteToHex[a[s+8]]+byteToHex[a[s+9]]+"-"+byteToHex[a[s+10]]+byteToHex[a[s+11]]+byteToHex[a[s+12]]+byteToHex[a[s+13]]+byteToHex[a[s+14]]+byteToHex[a[s+15]]).toLowerCase();if(!validate$1(d))throw TypeError("Stringified UUID is invalid");return d}var _nodeId,_clockseq,_lastMSecs=0,_lastNSecs=0;function v1(a,s,d){var c=s&&d||0,l=s||new Array(16);a=a||{};var p=a.node||_nodeId,h=a.clockseq!==void 0?a.clockseq:_clockseq;if(p==null||h==null){var v=a.random||(a.rng||rng)();p==null&&(p=_nodeId=[v[0]|1,v[1],v[2],v[3],v[4],v[5]]),h==null&&(h=_clockseq=(v[6]<<8|v[7])&16383)}var S=a.msecs!==void 0?a.msecs:Date.now(),b=a.nsecs!==void 0?a.nsecs:_lastNSecs+1,_=S-_lastMSecs+(b-_lastNSecs)/1e4;if(_<0&&a.clockseq===void 0&&(h=h+1&16383),(_<0||S>_lastMSecs)&&a.nsecs===void 0&&(b=0),b>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");_lastMSecs=S,_lastNSecs=b,_clockseq=h,S+=122192928e5;var I=((S&268435455)*1e4+b)%4294967296;l[c++]=I>>>24&255,l[c++]=I>>>16&255,l[c++]=I>>>8&255,l[c++]=I&255;var T=S/4294967296*1e4&268435455;l[c++]=T>>>8&255,l[c++]=T&255,l[c++]=T>>>24&15|16,l[c++]=T>>>16&255,l[c++]=h>>>8|128,l[c++]=h&255;for(var k=0;k<6;++k)l[c+k]=p[k];return s||stringify(l)}function parse$2(a){if(!validate$1(a))throw TypeError("Invalid UUID");var s,d=new Uint8Array(16);return d[0]=(s=parseInt(a.slice(0,8),16))>>>24,d[1]=s>>>16&255,d[2]=s>>>8&255,d[3]=s&255,d[4]=(s=parseInt(a.slice(9,13),16))>>>8,d[5]=s&255,d[6]=(s=parseInt(a.slice(14,18),16))>>>8,d[7]=s&255,d[8]=(s=parseInt(a.slice(19,23),16))>>>8,d[9]=s&255,d[10]=(s=parseInt(a.slice(24,36),16))/1099511627776&255,d[11]=s/4294967296&255,d[12]=s>>>24&255,d[13]=s>>>16&255,d[14]=s>>>8&255,d[15]=s&255,d}function stringToBytes(a){a=unescape(encodeURIComponent(a));for(var s=[],d=0;d<a.length;++d)s.push(a.charCodeAt(d));return s}var DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",URL$1="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function v35(a,s,d){function c(l,p,h,v){if(typeof l=="string"&&(l=stringToBytes(l)),typeof p=="string"&&(p=parse$2(p)),p.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var S=new Uint8Array(16+l.length);if(S.set(p),S.set(l,p.length),S=d(S),S[6]=S[6]&15|s,S[8]=S[8]&63|128,h){v=v||0;for(var b=0;b<16;++b)h[v+b]=S[b];return h}return stringify(S)}try{c.name=a}catch{}return c.DNS=DNS,c.URL=URL$1,c}function md5(a){if(typeof a=="string"){var s=unescape(encodeURIComponent(a));a=new Uint8Array(s.length);for(var d=0;d<s.length;++d)a[d]=s.charCodeAt(d)}return md5ToHexEncodedArray(wordsToMd5(bytesToWords(a),a.length*8))}function md5ToHexEncodedArray(a){for(var s=[],d=a.length*32,c="0123456789abcdef",l=0;l<d;l+=8){var p=a[l>>5]>>>l%32&255,h=parseInt(c.charAt(p>>>4&15)+c.charAt(p&15),16);s.push(h)}return s}function getOutputLength(a){return(a+64>>>9<<4)+14+1}function wordsToMd5(a,s){a[s>>5]|=128<<s%32,a[getOutputLength(s)-1]=s;for(var d=1732584193,c=-271733879,l=-1732584194,p=271733878,h=0;h<a.length;h+=16){var v=d,S=c,b=l,_=p;d=md5ff(d,c,l,p,a[h],7,-680876936),p=md5ff(p,d,c,l,a[h+1],12,-389564586),l=md5ff(l,p,d,c,a[h+2],17,606105819),c=md5ff(c,l,p,d,a[h+3],22,-1044525330),d=md5ff(d,c,l,p,a[h+4],7,-176418897),p=md5ff(p,d,c,l,a[h+5],12,1200080426),l=md5ff(l,p,d,c,a[h+6],17,-1473231341),c=md5ff(c,l,p,d,a[h+7],22,-45705983),d=md5ff(d,c,l,p,a[h+8],7,1770035416),p=md5ff(p,d,c,l,a[h+9],12,-1958414417),l=md5ff(l,p,d,c,a[h+10],17,-42063),c=md5ff(c,l,p,d,a[h+11],22,-1990404162),d=md5ff(d,c,l,p,a[h+12],7,1804603682),p=md5ff(p,d,c,l,a[h+13],12,-40341101),l=md5ff(l,p,d,c,a[h+14],17,-1502002290),c=md5ff(c,l,p,d,a[h+15],22,1236535329),d=md5gg(d,c,l,p,a[h+1],5,-165796510),p=md5gg(p,d,c,l,a[h+6],9,-1069501632),l=md5gg(l,p,d,c,a[h+11],14,643717713),c=md5gg(c,l,p,d,a[h],20,-373897302),d=md5gg(d,c,l,p,a[h+5],5,-701558691),p=md5gg(p,d,c,l,a[h+10],9,38016083),l=md5gg(l,p,d,c,a[h+15],14,-660478335),c=md5gg(c,l,p,d,a[h+4],20,-405537848),d=md5gg(d,c,l,p,a[h+9],5,568446438),p=md5gg(p,d,c,l,a[h+14],9,-1019803690),l=md5gg(l,p,d,c,a[h+3],14,-187363961),c=md5gg(c,l,p,d,a[h+8],20,1163531501),d=md5gg(d,c,l,p,a[h+13],5,-1444681467),p=md5gg(p,d,c,l,a[h+2],9,-51403784),l=md5gg(l,p,d,c,a[h+7],14,1735328473),c=md5gg(c,l,p,d,a[h+12],20,-1926607734),d=md5hh(d,c,l,p,a[h+5],4,-378558),p=md5hh(p,d,c,l,a[h+8],11,-2022574463),l=md5hh(l,p,d,c,a[h+11],16,1839030562),c=md5hh(c,l,p,d,a[h+14],23,-35309556),d=md5hh(d,c,l,p,a[h+1],4,-1530992060),p=md5hh(p,d,c,l,a[h+4],11,1272893353),l=md5hh(l,p,d,c,a[h+7],16,-155497632),c=md5hh(c,l,p,d,a[h+10],23,-1094730640),d=md5hh(d,c,l,p,a[h+13],4,681279174),p=md5hh(p,d,c,l,a[h],11,-358537222),l=md5hh(l,p,d,c,a[h+3],16,-722521979),c=md5hh(c,l,p,d,a[h+6],23,76029189),d=md5hh(d,c,l,p,a[h+9],4,-640364487),p=md5hh(p,d,c,l,a[h+12],11,-421815835),l=md5hh(l,p,d,c,a[h+15],16,530742520),c=md5hh(c,l,p,d,a[h+2],23,-995338651),d=md5ii(d,c,l,p,a[h],6,-198630844),p=md5ii(p,d,c,l,a[h+7],10,1126891415),l=md5ii(l,p,d,c,a[h+14],15,-1416354905),c=md5ii(c,l,p,d,a[h+5],21,-57434055),d=md5ii(d,c,l,p,a[h+12],6,1700485571),p=md5ii(p,d,c,l,a[h+3],10,-1894986606),l=md5ii(l,p,d,c,a[h+10],15,-1051523),c=md5ii(c,l,p,d,a[h+1],21,-2054922799),d=md5ii(d,c,l,p,a[h+8],6,1873313359),p=md5ii(p,d,c,l,a[h+15],10,-30611744),l=md5ii(l,p,d,c,a[h+6],15,-1560198380),c=md5ii(c,l,p,d,a[h+13],21,1309151649),d=md5ii(d,c,l,p,a[h+4],6,-145523070),p=md5ii(p,d,c,l,a[h+11],10,-1120210379),l=md5ii(l,p,d,c,a[h+2],15,718787259),c=md5ii(c,l,p,d,a[h+9],21,-343485551),d=safeAdd(d,v),c=safeAdd(c,S),l=safeAdd(l,b),p=safeAdd(p,_)}return[d,c,l,p]}function bytesToWords(a){if(a.length===0)return[];for(var s=a.length*8,d=new Uint32Array(getOutputLength(s)),c=0;c<s;c+=8)d[c>>5]|=(a[c/8]&255)<<c%32;return d}function safeAdd(a,s){var d=(a&65535)+(s&65535),c=(a>>16)+(s>>16)+(d>>16);return c<<16|d&65535}function bitRotateLeft(a,s){return a<<s|a>>>32-s}function md5cmn(a,s,d,c,l,p){return safeAdd(bitRotateLeft(safeAdd(safeAdd(s,a),safeAdd(c,p)),l),d)}function md5ff(a,s,d,c,l,p,h){return md5cmn(s&d|~s&c,a,s,l,p,h)}function md5gg(a,s,d,c,l,p,h){return md5cmn(s&c|d&~c,a,s,l,p,h)}function md5hh(a,s,d,c,l,p,h){return md5cmn(s^d^c,a,s,l,p,h)}function md5ii(a,s,d,c,l,p,h){return md5cmn(d^(s|~c),a,s,l,p,h)}var v3=v35("v3",48,md5),v3$1=v3;function v4(a,s,d){a=a||{};var c=a.random||(a.rng||rng)();if(c[6]=c[6]&15|64,c[8]=c[8]&63|128,s){d=d||0;for(var l=0;l<16;++l)s[d+l]=c[l];return s}return stringify(c)}function f(a,s,d,c){switch(a){case 0:return s&d^~s&c;case 1:return s^d^c;case 2:return s&d^s&c^d&c;case 3:return s^d^c}}function ROTL(a,s){return a<<s|a>>>32-s}function sha1(a){var s=[1518500249,1859775393,2400959708,3395469782],d=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof a=="string"){var c=unescape(encodeURIComponent(a));a=[];for(var l=0;l<c.length;++l)a.push(c.charCodeAt(l))}else Array.isArray(a)||(a=Array.prototype.slice.call(a));a.push(128);for(var p=a.length/4+2,h=Math.ceil(p/16),v=new Array(h),S=0;S<h;++S){for(var b=new Uint32Array(16),_=0;_<16;++_)b[_]=a[S*64+_*4]<<24|a[S*64+_*4+1]<<16|a[S*64+_*4+2]<<8|a[S*64+_*4+3];v[S]=b}v[h-1][14]=(a.length-1)*8/Math.pow(2,32),v[h-1][14]=Math.floor(v[h-1][14]),v[h-1][15]=(a.length-1)*8&4294967295;for(var I=0;I<h;++I){for(var T=new Uint32Array(80),k=0;k<16;++k)T[k]=v[I][k];for(var w=16;w<80;++w)T[w]=ROTL(T[w-3]^T[w-8]^T[w-14]^T[w-16],1);for(var P=d[0],$=d[1],U=d[2],E=d[3],D=d[4],F=0;F<80;++F){var J=Math.floor(F/20),G=ROTL(P,5)+f(J,$,U,E)+D+s[J]+T[F]>>>0;D=E,E=U,U=ROTL($,30)>>>0,$=P,P=G}d[0]=d[0]+P>>>0,d[1]=d[1]+$>>>0,d[2]=d[2]+U>>>0,d[3]=d[3]+E>>>0,d[4]=d[4]+D>>>0}return[d[0]>>24&255,d[0]>>16&255,d[0]>>8&255,d[0]&255,d[1]>>24&255,d[1]>>16&255,d[1]>>8&255,d[1]&255,d[2]>>24&255,d[2]>>16&255,d[2]>>8&255,d[2]&255,d[3]>>24&255,d[3]>>16&255,d[3]>>8&255,d[3]&255,d[4]>>24&255,d[4]>>16&255,d[4]>>8&255,d[4]&255]}var v5=v35("v5",80,sha1),v5$1=v5,nil="00000000-0000-0000-0000-000000000000";function version$4(a){if(!validate$1(a))throw TypeError("Invalid UUID");return parseInt(a.substr(14,1),16)}var esmBrowser=Object.freeze(Object.defineProperty({__proto__:null,v1,v3:v3$1,v4,v5:v5$1,NIL:nil,version:version$4,validate:validate$1,stringify,parse:parse$2},Symbol.toStringTag,{value:"Module"})),require$$1$2=getAugmentedNamespace(esmBrowser);class EnhancedMap$1 extends Map{computeIfAbsent(s,d){if(this.has(s))return this.get(s);const c=d(s);return this.set(s,c),c}computeIfPresent(s,d){const c=this.get(s);if(c===void 0)return;const l=d(s,c);return l!==void 0?this.set(s,l):this.delete(s),l}compute(s,d){const c=this.get(s),l=d(s,c);return l?this.set(s,l):this.delete(s),l}}var InternalLogLevel$1;(function(a){a[a.Trace=0]="Trace",a[a.Debug=1]="Debug",a[a.Info=2]="Info",a[a.Warn=3]="Warn",a[a.Error=4]="Error"})(InternalLogLevel$1||(InternalLogLevel$1={}));function getInternalLogger$1(a){return provider$1.getLogger(a)}const INTERNAL_LOGGING_SETTINGS$1={setInternalLogLevel:a=>provider$1.changeLogLevel(a),setOutput:a=>provider$1.changeOutput(a),reset:()=>provider$1.reset()};class InternalLoggerImpl$1{constructor(s,d,c){this._name=s,this._level=d,this._fnOutput=c}trace(s){this.log(InternalLogLevel$1.Trace,s)}debug(s){this.log(InternalLogLevel$1.Debug,s)}error(s,d){this.log(InternalLogLevel$1.Error,s,d)}info(s){this.log(InternalLogLevel$1.Info,s)}warn(s,d){this.log(InternalLogLevel$1.Warn,s,d)}setLevel(s){this._level=s}setOutput(s){this._fnOutput=s}log(s,d,c){this._level>s||this._fnOutput(`${InternalLogLevel$1[this._level].toString()} <INTERNAL LOGGER> ${this._name} ${d()}${c?`
`+c.stack:""}`)}}class InternalProviderImpl$1{constructor(){this._loggers=new EnhancedMap$1,this._logLevel=InternalLogLevel$1.Error,this._fnOutput=InternalProviderImpl$1.logConsole}getLogger(s){return this._loggers.computeIfAbsent(s,d=>new InternalLoggerImpl$1(d,this._logLevel,this._fnOutput))}changeLogLevel(s){this._logLevel=s,this._loggers.forEach(d=>d.setLevel(s))}changeOutput(s){this._fnOutput=s,this._loggers.forEach(d=>d.setOutput(this._fnOutput))}reset(){this.changeLogLevel(InternalLogLevel$1.Error),this._fnOutput=InternalProviderImpl$1.logConsole,this._loggers.forEach(s=>s.setOutput(this._fnOutput))}static logConsole(s){console&&console.log&&console.log(s)}}const provider$1=new InternalProviderImpl$1;var InternalLogger$1=Object.freeze({__proto__:null,get InternalLogLevel(){return InternalLogLevel$1},getInternalLogger:getInternalLogger$1,INTERNAL_LOGGING_SETTINGS:INTERNAL_LOGGING_SETTINGS$1}),LogLevel$2;(function(a){a[a.Trace=0]="Trace",a[a.Debug=1]="Debug",a[a.Info=2]="Info",a[a.Warn=3]="Warn",a[a.Error=4]="Error",a[a.Fatal=5]="Fatal"})(LogLevel$2||(LogLevel$2={})),function(a){function s(d){switch(d.toLowerCase()){case"trace":return a.Trace;case"debug":return a.Debug;case"info":return a.Info;case"warn":return a.Warn;case"error":return a.Error;case"fatal":return a.Fatal;default:return}}a.toLogLevel=s}(LogLevel$2||(LogLevel$2={}));class CoreLoggerImpl$1{constructor(s){this._runtime=s}get id(){return this._runtime.id}get logLevel(){return this._runtime.level}get runtimeSettings(){return Object.assign({},this._runtime)}set runtimeSettings(s){this._runtime=s}trace(s,...d){this.logMessage(LogLevel$2.Trace,s,d)}debug(s,...d){this.logMessage(LogLevel$2.Debug,s,d)}info(s,...d){this.logMessage(LogLevel$2.Info,s,d)}warn(s,...d){this.logMessage(LogLevel$2.Warn,s,d)}error(s,...d){this.logMessage(LogLevel$2.Error,s,d)}fatal(s,...d){this.logMessage(LogLevel$2.Fatal,s,d)}logMessage(s,d,c){if(this._runtime.level>s)return;const l=Date.now(),p=typeof d=="string"?d:d(),h=CoreLoggerImpl$1.getErrorAndArgs(c);switch(this._runtime.channel.type){case"RawLogChannel":this._runtime.channel.write({message:p,exception:h.error,args:h.args,timeInMillis:l,level:s,logNames:this._runtime.name},this._runtime.argumentFormatter);return;case"LogChannel":this._runtime.channel.write(this.createLogMessage(p,s,h,l));break}}formatArgValue(s){try{return this._runtime.argumentFormatter(s)}catch{return`>>ARG CONVERT FAILED: '${s!==void 0?s.toString():"undefined"}'<<`}}createLogMessage(s,d,c,l){let p;const h=c.error,v=c.args;h&&(p=`${h.name}: ${h.message}`,h.stack&&(p+=`@
${h.stack}`));const S=this._runtime.dateFormatter(l);let b=LogLevel$2[d].toUpperCase();b.length<5&&(b+=" ");const _=typeof this._runtime.name=="string"?this._runtime.name:this._runtime.name.join(", "),I=typeof v!="undefined"&&v.length>0?" ["+v.map(k=>this.formatArgValue(k)).join(", ")+"]":"";return{message:S+" "+b+" ["+_+"] "+s+I,error:p}}static getErrorAndArgs(s){if(s.length===0)return{};let d,c;const l=s[0];if(l instanceof Error)return d=l,c=s.length>1?s.slice(1):void 0,{error:d,args:c};if(typeof l=="function"){const p=l();return p instanceof Error?(d=p,c=s.length>1?s.slice(1):void 0,{error:d,args:c}):s.length===1?Array.isArray(p)?{args:p.length>0?p:void 0}:{args:p}:Array.isArray(p)?{args:[...p,...s.slice(1)]}:{args:[p,...s.slice(1)]}}return{args:s}}}function padStart$1(a,s,d=" "){return padInternal$1(a,s,"start",d)}function padEnd$1(a,s,d=" "){return padInternal$1(a,s,"end",d)}function maxLengthStringValueInArray$1(a){return a.map(s=>s.length).reduce((s,d)=>d>s?d:s,0)}function padInternal$1(a,s,d,c=" "){if(s<=a.length)return a;if(c.length>1)throw new Error(`Fill char must be one char exactly, it is: ${c.length}`);const l=s-a.length;let p="";for(let h=0;h<l;h++)p+=c;return d==="start"?p+a:a+p}function formatArgument$1(a){return a===void 0?"undefined":JSON.stringify(a)}function formatDate$1(a){const s=new Date(a),d=s.getFullYear(),c=padStart$1((s.getMonth()+1).toString(),2,"0"),l=padStart$1(s.getDate().toString(),2,"0"),p=padStart$1(s.getHours().toString(),2,"0"),h=padStart$1(s.getMinutes().toString(),2,"0"),v=padStart$1(s.getSeconds().toString(),2,"0"),S=padStart$1(s.getMilliseconds().toString(),2,"0");return`${d}-${c}-${l} ${p}:${h}:${v},${S}`}class ConsoleLogChannel$1{constructor(){this.type="LogChannel"}write(s){console&&console.log&&console.log(s.message+(s.error?`
${s.error}`:""))}}var DefaultChannels$1;(function(a){function s(){return new ConsoleLogChannel$1}a.createConsoleChannel=s})(DefaultChannels$1||(DefaultChannels$1={}));class LogProviderImpl$1{constructor(s,d){this._log=getInternalLogger$1("core.impl.LogProviderImpl"),this._name=s,this._settings=d,this._loggers=new EnhancedMap$1,this._idToKeyMap=new EnhancedMap$1,this._globalRuntimeSettings={level:d.level,channel:d.channel},this._nextLoggerId=1,this._log.trace(()=>`Created LogProviderImpl with settings: ${JSON.stringify(this._settings)}`)}get runtimeSettings(){return Object.assign(Object.assign({},this._settings),{level:this._globalRuntimeSettings.level,channel:this._globalRuntimeSettings.channel})}getLogger(s){return this.getOrCreateLogger(s)}updateLoggerRuntime(s,d){this._log.debug(()=>`Updating logger ${s.id} runtime settings using: '${JSON.stringify(d)}'`);const c=this._idToKeyMap.get(s.id);return c===void 0?(this._log.warn(()=>`Cannot update logger with id: ${s.id}, it was not found.`),!1):(this._loggers.computeIfPresent(c,(l,p)=>(p.runtimeSettings=LogProviderImpl$1.mergeRuntimeSettingsIntoLogRuntime(p.runtimeSettings,d),p)),!0)}updateRuntimeSettings(s){this._log.debug(()=>`Updating global runtime settings and updating existing loggers runtime settings using: '${JSON.stringify(s)}'`),this._globalRuntimeSettings={level:s.level!==void 0?s.level:this._globalRuntimeSettings.level,channel:s.channel!==void 0?s.channel:this._globalRuntimeSettings.channel},this._loggers.forEach(d=>d.runtimeSettings=LogProviderImpl$1.mergeRuntimeSettingsIntoLogRuntime(d.runtimeSettings,s))}clear(){this._loggers.clear(),this._idToKeyMap.clear(),this._globalRuntimeSettings=Object.assign({},this._settings),this._nextLoggerId=1}getOrCreateLogger(s){const d=LogProviderImpl$1.createKey(s),c=this._loggers.computeIfAbsent(d,()=>{const l={level:this._globalRuntimeSettings.level,channel:this._globalRuntimeSettings.channel,id:this.nextLoggerId(),name:s,argumentFormatter:this._settings.argumentFormatter,dateFormatter:this._settings.dateFormatter};return new CoreLoggerImpl$1(l)});return this._idToKeyMap.computeIfAbsent(c.id,()=>d),c}nextLoggerId(){const s=this._name+"_"+this._nextLoggerId;return this._nextLoggerId++,s}static mergeRuntimeSettingsIntoLogRuntime(s,d){return Object.assign(Object.assign({},s),{level:d.level!==void 0?d.level:s.level,channel:d.channel!==void 0?d.channel:s.channel})}static createKey(s){return typeof s=="string"?s:s.join(",")}}function createLogProvider$1(a,s){return new LogProviderImpl$1(a,s)}var index$4=Object.freeze({__proto__:null,EnhancedMap:EnhancedMap$1,padStart:padStart$1,padEnd:padEnd$1,maxLengthStringValueInArray:maxLengthStringValueInArray$1});class ArrayLogChannel{constructor(){this._buffer=[],this.type="LogChannel"}write(s){this._buffer.push(s)}get logMessages(){return this._buffer}get messages(){return this._buffer.map(s=>s.message)}}class ArrayRawLogChannel{constructor(){this._buffer=[],this.type="RawLogChannel"}write(s,d){this._buffer.push(s)}get messages(){return this._buffer.map(s=>s.message)}get errors(){return this._buffer.map(s=>s.exception)}get size(){return this._buffer.length}get rawMessages(){return this._buffer}clear(){this._buffer=[]}}class TestControlMessage{constructor(){this._messages=[],this.write=this.write.bind(this)}get messages(){return this._messages}write(s){this._messages.push(s)}clear(){this._messages=[]}}var TestClasses=Object.freeze({__proto__:null,ArrayLogChannel,ArrayRawLogChannel,TestControlMessage}),typescriptLogging_esm=Object.freeze(Object.defineProperty({__proto__:null,$internal:InternalLogger$1,$test:TestClasses,get DefaultChannels(){return DefaultChannels$1},get LogLevel(){return LogLevel$2},createLogProvider:createLogProvider$1,formatArgument:formatArgument$1,formatDate:formatDate$1,util:index$4},Symbol.toStringTag,{value:"Module"})),require$$2$1=getAugmentedNamespace(typescriptLogging_esm),layoutapi={},lib$1={},lib={},Metadata={};Object.defineProperty(Metadata,"__esModule",{value:!0}),Metadata.Metadata=void 0,Metadata.Metadata=function(s){const d=new Map,c={set(l,p){if(l=normalizeKey(l),Array.isArray(p))if(p.length===0)d.delete(l);else{for(const h of p)validate(l,h);d.set(l,l.endsWith("-bin")?p:[p.join(", ")])}else validate(l,p),d.set(l,[p]);return c},append(l,p){l=normalizeKey(l),validate(l,p);let h=d.get(l);return h==null&&(h=[],d.set(l,h)),h.push(p),l.endsWith("-bin")||d.set(l,[h.join(", ")]),c},delete(l){l=normalizeKey(l),d.delete(l)},get(l){var p;return l=normalizeKey(l),(p=d.get(l))===null||p===void 0?void 0:p[0]},getAll(l){var p;return l=normalizeKey(l),(p=d.get(l))!==null&&p!==void 0?p:[]},has(l){return l=normalizeKey(l),d.has(l)},[Symbol.iterator](){return d[Symbol.iterator]()}};if(s!=null){const l=isIterable$1(s)?s:Object.entries(s);for(const[p,h]of l)c.set(p,h)}return c};function normalizeKey(a){return a.toLowerCase()}function validate(a,s){if(!/^[0-9a-z_.-]+$/.test(a))throw new Error(`Metadata key '${a}' contains illegal characters`);if(a.endsWith("-bin")){if(!(s instanceof Uint8Array))throw new Error(`Metadata key '${a}' ends with '-bin', thus it must have binary value`)}else{if(typeof s!="string")throw new Error(`Metadata key '${a}' doesn't end with '-bin', thus it must have string value`);if(!/^[ -~]*$/.test(s))throw new Error(`Metadata value '${s}' of key '${a}' contains illegal characters`)}}function isIterable$1(a){return Symbol.iterator in a}var Status={};(function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.Status=void 0,function(s){s[s.OK=0]="OK",s[s.CANCELLED=1]="CANCELLED",s[s.UNKNOWN=2]="UNKNOWN",s[s.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",s[s.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",s[s.NOT_FOUND=5]="NOT_FOUND",s[s.ALREADY_EXISTS=6]="ALREADY_EXISTS",s[s.PERMISSION_DENIED=7]="PERMISSION_DENIED",s[s.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",s[s.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",s[s.ABORTED=10]="ABORTED",s[s.OUT_OF_RANGE=11]="OUT_OF_RANGE",s[s.UNIMPLEMENTED=12]="UNIMPLEMENTED",s[s.INTERNAL=13]="INTERNAL",s[s.UNAVAILABLE=14]="UNAVAILABLE",s[s.DATA_LOSS=15]="DATA_LOSS",s[s.UNAUTHENTICATED=16]="UNAUTHENTICATED"}(a.Status||(a.Status={}))})(Status);var MethodDescriptor={};Object.defineProperty(MethodDescriptor,"__esModule",{value:!0});var CallOptions={};Object.defineProperty(CallOptions,"__esModule",{value:!0});var ClientMiddleware={};Object.defineProperty(ClientMiddleware,"__esModule",{value:!0});var composeClientMiddleware$1={};Object.defineProperty(composeClientMiddleware$1,"__esModule",{value:!0}),composeClientMiddleware$1.composeClientMiddleware=void 0;function composeClientMiddleware(a,s){return(d,c)=>s({...d,next:(l,p)=>a({...d,request:l},p)},c)}composeClientMiddleware$1.composeClientMiddleware=composeClientMiddleware;var ClientError$1={},cjs={},helpers={};helpers.__esModule=void 0,helpers.__esModule=!0;var objectSetPrototypeOfIsDefined=typeof Object.setPrototypeOf=="function",objectGetPrototypeOfIsDefined=typeof Object.getPrototypeOf=="function",objectDefinePropertyIsDefined=typeof Object.defineProperty=="function",objectCreateIsDefined=typeof Object.create=="function",objectHasOwnPropertyIsDefined=typeof Object.prototype.hasOwnProperty=="function",setPrototypeOf=function(s,d){objectSetPrototypeOfIsDefined?Object.setPrototypeOf(s,d):s.__proto__=d};helpers.setPrototypeOf=setPrototypeOf;var getPrototypeOf=function(s){return objectGetPrototypeOfIsDefined?Object.getPrototypeOf(s):s.__proto__||s.prototype};helpers.getPrototypeOf=getPrototypeOf;var ie8ObjectDefinePropertyBug=!1,defineProperty=function a(s,d,c){if(objectDefinePropertyIsDefined&&!ie8ObjectDefinePropertyBug)try{Object.defineProperty(s,d,c)}catch{ie8ObjectDefinePropertyBug=!0,a(s,d,c)}else s[d]=c.value};helpers.defineProperty=defineProperty;var hasOwnProperty=function(s,d){return objectHasOwnPropertyIsDefined?s.hasOwnProperty(s,d):s[d]===void 0};helpers.hasOwnProperty=hasOwnProperty;var objectCreate=function(s,d){if(objectCreateIsDefined)return Object.create(s,d);var c=function(){};c.prototype=s;var l=new c;if(typeof d=="undefined")return l;if(typeof d=="null")throw new Error("PropertyDescriptors must not be null.");if(typeof d=="object")for(var p in d)hasOwnProperty(d,p)&&(l[p]=d[p].value);return l};helpers.objectCreate=objectCreate,function(a){a.__esModule=void 0,a.__esModule=!0;var s=helpers,d=s.setPrototypeOf,c=s.getPrototypeOf,l=s.defineProperty,p=s.objectCreate,h=new Error().toString()==="[object Error]",v="";function S(b){var _=this.constructor,I=_.name||function(){var $=_.toString().match(/^function\s*([^\s(]+)/);return $===null?v||"Error":$[1]}(),T=I==="Error",k=T?v:I,w=Error.apply(this,arguments);if(d(w,c(this)),!(w instanceof _)||!(w instanceof S)){var w=this;Error.apply(this,arguments),l(w,"message",{configurable:!0,enumerable:!1,value:b,writable:!0})}if(l(w,"name",{configurable:!0,enumerable:!1,value:k,writable:!0}),Error.captureStackTrace&&Error.captureStackTrace(w,T?S:_),w.stack===void 0){var P=new Error(b);P.name=w.name,w.stack=P.stack}return h&&l(w,"toString",{configurable:!0,enumerable:!1,value:function(){return(this.name||"Error")+(typeof this.message=="undefined"?"":": "+this.message)},writable:!0}),w}v=S.name||"ExtendableError",S.prototype=p(Error.prototype,{constructor:{value:Error,enumerable:!1,writable:!0,configurable:!0}}),a.ExtendableError=S,a.default=a.ExtendableError}(cjs),Object.defineProperty(ClientError$1,"__esModule",{value:!0}),ClientError$1.ClientError=void 0;const ts_error_1$1=cjs,Status_1$1=Status;class ClientError extends ts_error_1$1.ExtendableError{constructor(s,d,c){super(`${s} ${Status_1$1.Status[d]}: ${c}`),this.path=s,this.code=d,this.details=c,this.name="ClientError",Object.defineProperty(this,"@@nice-grpc",{value:!0}),Object.defineProperty(this,"@@nice-grpc:ClientError",{value:!0})}static[Symbol.hasInstance](s){return this!==ClientError?this.prototype.isPrototypeOf(s):typeof s=="object"&&s!==null&&(s.constructor===ClientError||s["@@nice-grpc:ClientError"]===!0||s.name==="ClientError"&&s["@@nice-grpc"]===!0)}}ClientError$1.ClientError=ClientError;var CallContext={};Object.defineProperty(CallContext,"__esModule",{value:!0});var ServerMiddleware={};Object.defineProperty(ServerMiddleware,"__esModule",{value:!0});var composeServerMiddleware$1={};Object.defineProperty(composeServerMiddleware$1,"__esModule",{value:!0}),composeServerMiddleware$1.composeServerMiddleware=void 0;function composeServerMiddleware(a,s){return(d,c)=>a({...d,next:(l,p)=>s({...d,request:l},p)},c)}composeServerMiddleware$1.composeServerMiddleware=composeServerMiddleware;var ServerError$1={};Object.defineProperty(ServerError$1,"__esModule",{value:!0}),ServerError$1.ServerError=void 0;const ts_error_1=cjs,Status_1=Status;class ServerError extends ts_error_1.ExtendableError{constructor(s,d){super(`${Status_1.Status[s]}: ${d}`),this.code=s,this.details=d,this.name="ServerError",Object.defineProperty(this,"@@nice-grpc",{value:!0}),Object.defineProperty(this,"@@nice-grpc:ServerError",{value:!0})}static[Symbol.hasInstance](s){return this!==ServerError?this.prototype.isPrototypeOf(s):typeof s=="object"&&s!==null&&(s.constructor===ServerError||s["@@nice-grpc:ServerError"]===!0||s.name==="ServerError"&&s["@@nice-grpc"]===!0)}}ServerError$1.ServerError=ServerError,function(a){var s=commonjsGlobal$1&&commonjsGlobal$1.__createBinding||(Object.create?function(c,l,p,h){h===void 0&&(h=p);var v=Object.getOwnPropertyDescriptor(l,p);(!v||("get"in v?!l.__esModule:v.writable||v.configurable))&&(v={enumerable:!0,get:function(){return l[p]}}),Object.defineProperty(c,h,v)}:function(c,l,p,h){h===void 0&&(h=p),c[h]=l[p]}),d=commonjsGlobal$1&&commonjsGlobal$1.__exportStar||function(c,l){for(var p in c)p!=="default"&&!Object.prototype.hasOwnProperty.call(l,p)&&s(l,c,p)};Object.defineProperty(a,"__esModule",{value:!0}),d(Metadata,a),d(Status,a),d(MethodDescriptor,a),d(CallOptions,a),d(ClientMiddleware,a),d(composeClientMiddleware$1,a),d(ClientError$1,a),d(CallContext,a),d(ServerMiddleware,a),d(composeServerMiddleware$1,a),d(ServerError$1,a)}(lib);var serviceDefinitions={},grpcWeb={};Object.defineProperty(grpcWeb,"__esModule",{value:!0}),grpcWeb.isGrpcWebServiceDefinition=grpcWeb.fromGrpcWebServiceDefinition=void 0;function fromGrpcWebServiceDefinition(a){const s={};for(const[d,c]of Object.entries(a)){if(d==="serviceName")continue;const l=c;s[uncapitalize(d)]={path:`/${a.serviceName}/${d}`,requestStream:l.requestStream,responseStream:l.responseStream,requestDeserialize:l.requestType.deserializeBinary,requestSerialize:p=>p.serializeBinary(),responseDeserialize:l.responseType.deserializeBinary,responseSerialize:p=>p.serializeBinary(),options:{}}}return s}grpcWeb.fromGrpcWebServiceDefinition=fromGrpcWebServiceDefinition;function isGrpcWebServiceDefinition(a){return"prototype"in a}grpcWeb.isGrpcWebServiceDefinition=isGrpcWebServiceDefinition;function uncapitalize(a){return a.length===0?a:a[0].toLowerCase()+a.slice(1)}var tsProto={};Object.defineProperty(tsProto,"__esModule",{value:!0}),tsProto.isTsProtoServiceDefinition=tsProto.fromTsProtoServiceDefinition=void 0;function fromTsProtoServiceDefinition(a){const s={};for(const[d,c]of Object.entries(a.methods)){const l=c.requestType.encode,p=c.requestType.fromPartial,h=c.responseType.encode,v=c.responseType.fromPartial;s[d]={path:`/${a.fullName}/${c.name}`,requestStream:c.requestStream,responseStream:c.responseStream,requestDeserialize:c.requestType.decode,requestSerialize:p!=null?S=>l(p(S)).finish():S=>l(S).finish(),responseDeserialize:c.responseType.decode,responseSerialize:v!=null?S=>h(v(S)).finish():S=>h(S).finish(),options:c.options}}return s}tsProto.fromTsProtoServiceDefinition=fromTsProtoServiceDefinition;function isTsProtoServiceDefinition(a){return"name"in a&&"fullName"in a&&"methods"in a}tsProto.isTsProtoServiceDefinition=isTsProtoServiceDefinition,Object.defineProperty(serviceDefinitions,"__esModule",{value:!0}),serviceDefinitions.toGrpcWebMethodDefinition=serviceDefinitions.normalizeServiceDefinition=void 0;const grpc_web_1$5=grpcWeb,ts_proto_1=tsProto;function normalizeServiceDefinition(a){return(0,grpc_web_1$5.isGrpcWebServiceDefinition)(a)?(0,grpc_web_1$5.fromGrpcWebServiceDefinition)(a):(0,ts_proto_1.isTsProtoServiceDefinition)(a)?(0,ts_proto_1.fromTsProtoServiceDefinition)(a):a}serviceDefinitions.normalizeServiceDefinition=normalizeServiceDefinition;function toGrpcWebMethodDefinition(a){const[,s,d]=a.path.split("/");return{service:{serviceName:s},methodName:d,requestStream:a.requestStream,responseStream:a.responseStream,requestType:class{constructor(){throw new Error("Unexpected instantiation")}static deserializeBinary(c){return a.requestDeserialize(c)}},responseType:class{constructor(){throw new Error("Unexpected instantiation")}static deserializeBinary(c){return a.responseDeserialize(c)}}}}serviceDefinitions.toGrpcWebMethodDefinition=toGrpcWebMethodDefinition;var channel={};Object.defineProperty(channel,"__esModule",{value:!0}),channel.createChannel=void 0;function createChannel(a,s){return{address:a,transport:s}}channel.createChannel=createChannel;var ClientFactory={},createBidiStreamingMethod$1={},grpcWebClient_umd={exports:{}};(function(a,s){(function(d,c){a.exports=c()})(commonjsGlobal$1,function(){return d={418:function(l,p){(function(h,v){for(var S in v)h[S]=v[S]})(p,function(h){var v={};function S(b){if(v[b])return v[b].exports;var _=v[b]={i:b,l:!1,exports:{}};return h[b].call(_.exports,_,_.exports,S),_.l=!0,_.exports}return S.m=h,S.c=v,S.i=function(b){return b},S.d=function(b,_,I){S.o(b,_)||Object.defineProperty(b,_,{configurable:!1,enumerable:!0,get:I})},S.n=function(b){var _=b&&b.__esModule?function(){return b.default}:function(){return b};return S.d(_,"a",_),_},S.o=function(b,_){return Object.prototype.hasOwnProperty.call(b,_)},S.p="",S(S.s=1)}([function(h,v,S){Object.defineProperty(v,"__esModule",{value:!0});var b=S(3),_=function(){function I(T,k){T===void 0&&(T={}),k===void 0&&(k={splitValues:!1});var w,P=this;this.headersMap={},T&&(typeof Headers!="undefined"&&T instanceof Headers?b.getHeaderKeys(T).forEach(function($){b.getHeaderValues(T,$).forEach(function(U){k.splitValues?P.append($,b.splitHeaderValue(U)):P.append($,U)})}):typeof(w=T)=="object"&&typeof w.headersMap=="object"&&typeof w.forEach=="function"?T.forEach(function($,U){P.append($,U)}):typeof Map!="undefined"&&T instanceof Map?T.forEach(function($,U){P.append(U,$)}):typeof T=="string"?this.appendFromString(T):typeof T=="object"&&Object.getOwnPropertyNames(T).forEach(function($){var U=T[$];Array.isArray(U)?U.forEach(function(E){P.append($,E)}):P.append($,U)}))}return I.prototype.appendFromString=function(T){for(var k=T.split(`\r
`),w=0;w<k.length;w++){var P=k[w],$=P.indexOf(":");if($>0){var U=P.substring(0,$).trim(),E=P.substring($+1).trim();this.append(U,E)}}},I.prototype.delete=function(T,k){var w=b.normalizeName(T);if(k===void 0)delete this.headersMap[w];else{var P=this.headersMap[w];if(P){var $=P.indexOf(k);$>=0&&P.splice($,1),P.length===0&&delete this.headersMap[w]}}},I.prototype.append=function(T,k){var w=this,P=b.normalizeName(T);Array.isArray(this.headersMap[P])||(this.headersMap[P]=[]),Array.isArray(k)?k.forEach(function($){w.headersMap[P].push(b.normalizeValue($))}):this.headersMap[P].push(b.normalizeValue(k))},I.prototype.set=function(T,k){var w=b.normalizeName(T);if(Array.isArray(k)){var P=[];k.forEach(function($){P.push(b.normalizeValue($))}),this.headersMap[w]=P}else this.headersMap[w]=[b.normalizeValue(k)]},I.prototype.has=function(T,k){var w=this.headersMap[b.normalizeName(T)];if(!Array.isArray(w))return!1;if(k!==void 0){var P=b.normalizeValue(k);return w.indexOf(P)>=0}return!0},I.prototype.get=function(T){var k=this.headersMap[b.normalizeName(T)];return k!==void 0?k.concat():[]},I.prototype.forEach=function(T){var k=this;Object.getOwnPropertyNames(this.headersMap).forEach(function(w){T(w,k.headersMap[w])},this)},I.prototype.toHeaders=function(){if(typeof Headers!="undefined"){var T=new Headers;return this.forEach(function(k,w){w.forEach(function(P){T.append(k,P)})}),T}throw new Error("Headers class is not defined")},I}();v.BrowserHeaders=_},function(h,v,S){Object.defineProperty(v,"__esModule",{value:!0});var b=S(0);v.BrowserHeaders=b.BrowserHeaders},function(h,v,S){Object.defineProperty(v,"__esModule",{value:!0}),v.iterateHeaders=function(b,_){for(var I=b[Symbol.iterator](),T=I.next();!T.done;)_(T.value[0]),T=I.next()},v.iterateHeadersKeys=function(b,_){for(var I=b.keys(),T=I.next();!T.done;)_(T.value),T=I.next()}},function(h,v,S){Object.defineProperty(v,"__esModule",{value:!0});var b=S(2);v.normalizeName=function(_){if(typeof _!="string"&&(_=String(_)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(_))throw new TypeError("Invalid character in header field name");return _.toLowerCase()},v.normalizeValue=function(_){return typeof _!="string"&&(_=String(_)),_},v.getHeaderValues=function(_,I){var T=_;if(T instanceof Headers&&T.getAll)return T.getAll(I);var k=T.get(I);return k&&typeof k=="string"?[k]:k},v.getHeaderKeys=function(_){var I=_,T={},k=[];return I.keys?b.iterateHeadersKeys(I,function(w){T[w]||(T[w]=!0,k.push(w))}):I.forEach?I.forEach(function(w,P){T[P]||(T[P]=!0,k.push(P))}):b.iterateHeaders(I,function(w){var P=w[0];T[P]||(T[P]=!0,k.push(P))}),k},v.splitHeaderValue=function(_){var I=[];return _.split(", ").forEach(function(T){T.split(",").forEach(function(k){I.push(k)})}),I}}]))},617:function(l,p,h){Object.defineProperty(p,"__esModule",{value:!0}),p.ChunkParser=p.ChunkType=p.encodeASCII=p.decodeASCII=void 0;var v,S=h(65);function b($){return(U=$)===9||U===10||U===13||$>=32&&$<=126;var U}function _($){for(var U=0;U!==$.length;++U)if(!b($[U]))throw new Error("Metadata is not valid (printable) ASCII");return String.fromCharCode.apply(String,Array.prototype.slice.call($))}function I($){return(128&$.getUint8(0))==128}function T($){return $.getUint32(1,!1)}function k($,U,E){return $.byteLength-U>=E}function w($,U,E){if($.slice)return $.slice(U,E);var D=$.length;E!==void 0&&(D=E);for(var F=new Uint8Array(D-U),J=0,G=U;G<D;G++)F[J++]=$[G];return F}p.decodeASCII=_,p.encodeASCII=function($){for(var U=new Uint8Array($.length),E=0;E!==$.length;++E){var D=$.charCodeAt(E);if(!b(D))throw new Error("Metadata contains invalid ASCII");U[E]=D}return U},function($){$[$.MESSAGE=1]="MESSAGE",$[$.TRAILERS=2]="TRAILERS"}(v=p.ChunkType||(p.ChunkType={}));var P=function(){function $(){this.buffer=null,this.position=0}return $.prototype.parse=function(U,E){if(U.length===0&&E)return[];var D,F=[];if(this.buffer==null)this.buffer=U,this.position=0;else if(this.position===this.buffer.byteLength)this.buffer=U,this.position=0;else{var J=this.buffer.byteLength-this.position,G=new Uint8Array(J+U.byteLength),x=w(this.buffer,this.position);G.set(x,0);var Y=new Uint8Array(U);G.set(Y,J),this.buffer=G,this.position=0}for(;;){if(!k(this.buffer,this.position,5))return F;var N=w(this.buffer,this.position,this.position+5),z=new DataView(N.buffer,N.byteOffset,N.byteLength),Z=T(z);if(!k(this.buffer,this.position,5+Z))return F;var L=w(this.buffer,this.position+5,this.position+5+Z);if(this.position+=5+Z,I(z))return F.push({chunkType:v.TRAILERS,trailers:(D=L,new S.Metadata(_(D)))}),F;F.push({chunkType:v.MESSAGE,data:L})}},$}();p.ChunkParser=P},8:function(l,p){var h;Object.defineProperty(p,"__esModule",{value:!0}),p.httpStatusToCode=p.Code=void 0,function(v){v[v.OK=0]="OK",v[v.Canceled=1]="Canceled",v[v.Unknown=2]="Unknown",v[v.InvalidArgument=3]="InvalidArgument",v[v.DeadlineExceeded=4]="DeadlineExceeded",v[v.NotFound=5]="NotFound",v[v.AlreadyExists=6]="AlreadyExists",v[v.PermissionDenied=7]="PermissionDenied",v[v.ResourceExhausted=8]="ResourceExhausted",v[v.FailedPrecondition=9]="FailedPrecondition",v[v.Aborted=10]="Aborted",v[v.OutOfRange=11]="OutOfRange",v[v.Unimplemented=12]="Unimplemented",v[v.Internal=13]="Internal",v[v.Unavailable=14]="Unavailable",v[v.DataLoss=15]="DataLoss",v[v.Unauthenticated=16]="Unauthenticated"}(h=p.Code||(p.Code={})),p.httpStatusToCode=function(v){switch(v){case 0:return h.Internal;case 200:return h.OK;case 400:return h.InvalidArgument;case 401:return h.Unauthenticated;case 403:return h.PermissionDenied;case 404:return h.NotFound;case 409:return h.Aborted;case 412:return h.FailedPrecondition;case 429:return h.ResourceExhausted;case 499:return h.Canceled;case 500:return h.Unknown;case 501:return h.Unimplemented;case 503:return h.Unavailable;case 504:return h.DeadlineExceeded;default:return h.Unknown}}},934:function(l,p,h){Object.defineProperty(p,"__esModule",{value:!0}),p.client=void 0;var v=h(65),S=h(617),b=h(8),_=h(346),I=h(57),T=h(882);p.client=function(P,$){return new k(P,$)};var k=function(){function P($,U){this.started=!1,this.sentFirstMessage=!1,this.completed=!1,this.closed=!1,this.finishedSending=!1,this.onHeadersCallbacks=[],this.onMessageCallbacks=[],this.onEndCallbacks=[],this.parser=new S.ChunkParser,this.methodDefinition=$,this.props=U,this.createTransport()}return P.prototype.createTransport=function(){var $=this.props.host+"/"+this.methodDefinition.service.serviceName+"/"+this.methodDefinition.methodName,U={methodDefinition:this.methodDefinition,debug:this.props.debug||!1,url:$,onHeaders:this.onTransportHeaders.bind(this),onChunk:this.onTransportChunk.bind(this),onEnd:this.onTransportEnd.bind(this)};this.props.transport?this.transport=this.props.transport(U):this.transport=I.makeDefaultTransport(U)},P.prototype.onTransportHeaders=function($,U){if(this.props.debug&&_.debug("onHeaders",$,U),this.closed)this.props.debug&&_.debug("grpc.onHeaders received after request was closed - ignoring");else if(U!==0){this.responseHeaders=$,this.props.debug&&_.debug("onHeaders.responseHeaders",JSON.stringify(this.responseHeaders,null,2));var E=w($);this.props.debug&&_.debug("onHeaders.gRPCStatus",E);var D=E&&E>=0?E:b.httpStatusToCode(U);this.props.debug&&_.debug("onHeaders.code",D);var F=$.get("grpc-message")||[];if(this.props.debug&&_.debug("onHeaders.gRPCMessage",F),this.rawOnHeaders($),D!==b.Code.OK){var J=this.decodeGRPCStatus(F[0]);this.rawOnError(D,J,$)}}},P.prototype.onTransportChunk=function($){var U=this;if(this.closed)this.props.debug&&_.debug("grpc.onChunk received after request was closed - ignoring");else{var E=[];try{E=this.parser.parse($)}catch(D){return this.props.debug&&_.debug("onChunk.parsing error",D,D.message),void this.rawOnError(b.Code.Internal,"parsing error: "+D.message)}E.forEach(function(D){if(D.chunkType===S.ChunkType.MESSAGE){var F=U.methodDefinition.responseType.deserializeBinary(D.data);U.rawOnMessage(F)}else D.chunkType===S.ChunkType.TRAILERS&&(U.responseHeaders?(U.responseTrailers=new v.Metadata(D.trailers),U.props.debug&&_.debug("onChunk.trailers",U.responseTrailers)):(U.responseHeaders=new v.Metadata(D.trailers),U.rawOnHeaders(U.responseHeaders)))})}},P.prototype.onTransportEnd=function(){if(this.props.debug&&_.debug("grpc.onEnd"),this.closed)this.props.debug&&_.debug("grpc.onEnd received after request was closed - ignoring");else if(this.responseTrailers!==void 0){var $=w(this.responseTrailers);if($!==null){var U=this.responseTrailers.get("grpc-message"),E=this.decodeGRPCStatus(U[0]);this.rawOnEnd($,E,this.responseTrailers)}else this.rawOnError(b.Code.Internal,"Response closed without grpc-status (Trailers provided)")}else{if(this.responseHeaders===void 0)return void this.rawOnError(b.Code.Unknown,"Response closed without headers");var D=w(this.responseHeaders),F=this.responseHeaders.get("grpc-message");if(this.props.debug&&_.debug("grpc.headers only response ",D,F),D===null)return void this.rawOnEnd(b.Code.Unknown,"Response closed without grpc-status (Headers only)",this.responseHeaders);var J=this.decodeGRPCStatus(F[0]);this.rawOnEnd(D,J,this.responseHeaders)}},P.prototype.decodeGRPCStatus=function($){if(!$)return"";try{return decodeURIComponent($)}catch{return $}},P.prototype.rawOnEnd=function($,U,E){var D=this;this.props.debug&&_.debug("rawOnEnd",$,U,E),this.completed||(this.completed=!0,this.onEndCallbacks.forEach(function(F){if(!D.closed)try{F($,U,E)}catch(J){setTimeout(function(){throw J},0)}}))},P.prototype.rawOnHeaders=function($){this.props.debug&&_.debug("rawOnHeaders",$),this.completed||this.onHeadersCallbacks.forEach(function(U){try{U($)}catch(E){setTimeout(function(){throw E},0)}})},P.prototype.rawOnError=function($,U,E){var D=this;E===void 0&&(E=new v.Metadata),this.props.debug&&_.debug("rawOnError",$,U),this.completed||(this.completed=!0,this.onEndCallbacks.forEach(function(F){if(!D.closed)try{F($,U,E)}catch(J){setTimeout(function(){throw J},0)}}))},P.prototype.rawOnMessage=function($){var U=this;this.props.debug&&_.debug("rawOnMessage",$.toObject()),this.completed||this.closed||this.onMessageCallbacks.forEach(function(E){if(!U.closed)try{E($)}catch(D){setTimeout(function(){throw D},0)}})},P.prototype.onHeaders=function($){this.onHeadersCallbacks.push($)},P.prototype.onMessage=function($){this.onMessageCallbacks.push($)},P.prototype.onEnd=function($){this.onEndCallbacks.push($)},P.prototype.start=function($){if(this.started)throw new Error("Client already started - cannot .start()");this.started=!0;var U=new v.Metadata($||{});U.set("content-type","application/grpc-web+proto"),U.set("x-grpc-web","1"),this.transport.start(U)},P.prototype.send=function($){if(!this.started)throw new Error("Client not started - .start() must be called before .send()");if(this.closed)throw new Error("Client already closed - cannot .send()");if(this.finishedSending)throw new Error("Client already finished sending - cannot .send()");if(!this.methodDefinition.requestStream&&this.sentFirstMessage)throw new Error("Message already sent for non-client-streaming method - cannot .send()");this.sentFirstMessage=!0;var U=T.frameRequest($);this.transport.sendMessage(U)},P.prototype.finishSend=function(){if(!this.started)throw new Error("Client not started - .finishSend() must be called before .close()");if(this.closed)throw new Error("Client already closed - cannot .send()");if(this.finishedSending)throw new Error("Client already finished sending - cannot .finishSend()");this.finishedSending=!0,this.transport.finishSend()},P.prototype.close=function(){if(!this.started)throw new Error("Client not started - .start() must be called before .close()");if(this.closed)throw new Error("Client already closed - cannot .close()");this.closed=!0,this.props.debug&&_.debug("request.abort aborting request"),this.transport.cancel()},P}();function w(P){var $=P.get("grpc-status")||[];if($.length>0)try{var U=$[0];return parseInt(U,10)}catch{return null}return null}},346:function(l,p){Object.defineProperty(p,"__esModule",{value:!0}),p.debug=void 0,p.debug=function(){for(var h=[],v=0;v<arguments.length;v++)h[v]=arguments[v];console.debug?console.debug.apply(null,h):console.log.apply(null,h)}},607:function(l,p,h){Object.defineProperty(p,"__esModule",{value:!0}),p.grpc=void 0;var v,S=h(418),b=h(57),_=h(229),I=h(540),T=h(210),k=h(859),w=h(8),P=h(938),$=h(35),U=h(934);(v=p.grpc||(p.grpc={})).setDefaultTransport=b.setDefaultTransportFactory,v.CrossBrowserHttpTransport=k.CrossBrowserHttpTransport,v.FetchReadableStreamTransport=_.FetchReadableStreamTransport,v.XhrTransport=T.XhrTransport,v.WebsocketTransport=I.WebsocketTransport,v.Code=w.Code,v.Metadata=S.BrowserHeaders,v.client=function(E,D){return U.client(E,D)},v.invoke=P.invoke,v.unary=$.unary},938:function(l,p,h){Object.defineProperty(p,"__esModule",{value:!0}),p.invoke=void 0;var v=h(934);p.invoke=function(S,b){if(S.requestStream)throw new Error(".invoke cannot be used with client-streaming methods. Use .client instead.");var _=v.client(S,{host:b.host,transport:b.transport,debug:b.debug});return b.onHeaders&&_.onHeaders(b.onHeaders),b.onMessage&&_.onMessage(b.onMessage),b.onEnd&&_.onEnd(b.onEnd),_.start(b.metadata),_.send(b.request),_.finishSend(),{close:function(){_.close()}}}},65:function(l,p,h){Object.defineProperty(p,"__esModule",{value:!0}),p.Metadata=void 0;var v=h(418);Object.defineProperty(p,"Metadata",{enumerable:!0,get:function(){return v.BrowserHeaders}})},57:function(l,p,h){Object.defineProperty(p,"__esModule",{value:!0}),p.makeDefaultTransport=p.setDefaultTransportFactory=void 0;var v=h(859),S=function(b){return v.CrossBrowserHttpTransport({withCredentials:!1})(b)};p.setDefaultTransportFactory=function(b){S=b},p.makeDefaultTransport=function(b){return S(b)}},229:function(l,p,h){var v=this&&this.__assign||function(){return(v=Object.assign||function(I){for(var T,k=1,w=arguments.length;k<w;k++)for(var P in T=arguments[k])Object.prototype.hasOwnProperty.call(T,P)&&(I[P]=T[P]);return I}).apply(this,arguments)};Object.defineProperty(p,"__esModule",{value:!0}),p.detectFetchSupport=p.FetchReadableStreamTransport=void 0;var S=h(65),b=h(346);p.FetchReadableStreamTransport=function(I){return function(T){return function(k,w){return k.debug&&b.debug("fetchRequest",k),new _(k,w)}(T,I)}};var _=function(){function I(T,k){this.cancelled=!1,this.controller=self.AbortController&&new AbortController,this.options=T,this.init=k}return I.prototype.pump=function(T,k){var w=this;if(this.reader=T,this.cancelled)return this.options.debug&&b.debug("Fetch.pump.cancel at first pump"),void this.reader.cancel().catch(function(P){w.options.debug&&b.debug("Fetch.pump.reader.cancel exception",P)});this.reader.read().then(function(P){if(P.done)return w.options.onEnd(),k;w.options.onChunk(P.value),w.pump(w.reader,k)}).catch(function(P){w.cancelled?w.options.debug&&b.debug("Fetch.catch - request cancelled"):(w.cancelled=!0,w.options.debug&&b.debug("Fetch.catch",P.message),w.options.onEnd(P))})},I.prototype.send=function(T){var k=this;fetch(this.options.url,v(v({},this.init),{headers:this.metadata.toHeaders(),method:"POST",body:T,signal:this.controller&&this.controller.signal})).then(function(w){if(k.options.debug&&b.debug("Fetch.response",w),k.options.onHeaders(new S.Metadata(w.headers),w.status),!w.body)return w;k.pump(w.body.getReader(),w)}).catch(function(w){k.cancelled?k.options.debug&&b.debug("Fetch.catch - request cancelled"):(k.cancelled=!0,k.options.debug&&b.debug("Fetch.catch",w.message),k.options.onEnd(w))})},I.prototype.sendMessage=function(T){this.send(T)},I.prototype.finishSend=function(){},I.prototype.start=function(T){this.metadata=T},I.prototype.cancel=function(){var T=this;this.cancelled?this.options.debug&&b.debug("Fetch.cancel already cancelled"):(this.cancelled=!0,this.controller?(this.options.debug&&b.debug("Fetch.cancel.controller.abort"),this.controller.abort()):this.options.debug&&b.debug("Fetch.cancel.missing abort controller"),this.reader?(this.options.debug&&b.debug("Fetch.cancel.reader.cancel"),this.reader.cancel().catch(function(k){T.options.debug&&b.debug("Fetch.cancel.reader.cancel exception",k)})):this.options.debug&&b.debug("Fetch.cancel before reader"))},I}();p.detectFetchSupport=function(){return typeof Response!="undefined"&&Response.prototype.hasOwnProperty("body")&&typeof Headers=="function"}},859:function(l,p,h){Object.defineProperty(p,"__esModule",{value:!0}),p.CrossBrowserHttpTransport=void 0;var v=h(229),S=h(210);p.CrossBrowserHttpTransport=function(b){if(v.detectFetchSupport()){var _={credentials:b.withCredentials?"include":"same-origin"};return v.FetchReadableStreamTransport(_)}return S.XhrTransport({withCredentials:b.withCredentials})}},210:function(l,p,h){var v,S=this&&this.__extends||(v=function($,U){return(v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(E,D){E.__proto__=D}||function(E,D){for(var F in D)Object.prototype.hasOwnProperty.call(D,F)&&(E[F]=D[F])})($,U)},function($,U){function E(){this.constructor=$}v($,U),$.prototype=U===null?Object.create(U):(E.prototype=U.prototype,new E)});Object.defineProperty(p,"__esModule",{value:!0}),p.stringToArrayBuffer=p.MozChunkedArrayBufferXHR=p.XHR=p.XhrTransport=void 0;var b=h(65),_=h(346),I=h(849);p.XhrTransport=function($){return function(U){if(I.detectMozXHRSupport())return new k(U,$);if(I.detectXHROverrideMimeTypeSupport())return new T(U,$);throw new Error("This environment's XHR implementation cannot support binary transfer.")}};var T=function(){function $(U,E){this.options=U,this.init=E}return $.prototype.onProgressEvent=function(){this.options.debug&&_.debug("XHR.onProgressEvent.length: ",this.xhr.response.length);var U=this.xhr.response.substr(this.index);this.index=this.xhr.response.length;var E=P(U);this.options.onChunk(E)},$.prototype.onLoadEvent=function(){this.options.debug&&_.debug("XHR.onLoadEvent"),this.options.onEnd()},$.prototype.onStateChange=function(){this.options.debug&&_.debug("XHR.onStateChange",this.xhr.readyState),this.xhr.readyState===XMLHttpRequest.HEADERS_RECEIVED&&this.options.onHeaders(new b.Metadata(this.xhr.getAllResponseHeaders()),this.xhr.status)},$.prototype.sendMessage=function(U){this.xhr.send(U)},$.prototype.finishSend=function(){},$.prototype.start=function(U){var E=this;this.metadata=U;var D=new XMLHttpRequest;this.xhr=D,D.open("POST",this.options.url),this.configureXhr(),this.metadata.forEach(function(F,J){D.setRequestHeader(F,J.join(", "))}),D.withCredentials=Boolean(this.init.withCredentials),D.addEventListener("readystatechange",this.onStateChange.bind(this)),D.addEventListener("progress",this.onProgressEvent.bind(this)),D.addEventListener("loadend",this.onLoadEvent.bind(this)),D.addEventListener("error",function(F){E.options.debug&&_.debug("XHR.error",F),E.options.onEnd(F.error)})},$.prototype.configureXhr=function(){this.xhr.responseType="text",this.xhr.overrideMimeType("text/plain; charset=x-user-defined")},$.prototype.cancel=function(){this.options.debug&&_.debug("XHR.abort"),this.xhr.abort()},$}();p.XHR=T;var k=function($){function U(){return $!==null&&$.apply(this,arguments)||this}return S(U,$),U.prototype.configureXhr=function(){this.options.debug&&_.debug("MozXHR.configureXhr: setting responseType to 'moz-chunked-arraybuffer'"),this.xhr.responseType="moz-chunked-arraybuffer"},U.prototype.onProgressEvent=function(){var E=this.xhr.response;this.options.debug&&_.debug("MozXHR.onProgressEvent: ",new Uint8Array(E)),this.options.onChunk(new Uint8Array(E))},U}(T);function w($,U){var E=$.charCodeAt(U);if(E>=55296&&E<=56319){var D=$.charCodeAt(U+1);D>=56320&&D<=57343&&(E=65536+(E-55296<<10)+(D-56320))}return E}function P($){for(var U=new Uint8Array($.length),E=0,D=0;D<$.length;D++){var F=String.prototype.codePointAt?$.codePointAt(D):w($,D);U[E++]=255&F}return U}p.MozChunkedArrayBufferXHR=k,p.stringToArrayBuffer=P},849:function(l,p){var h;function v(){if(h!==void 0)return h;if(XMLHttpRequest){h=new XMLHttpRequest;try{h.open("GET","https://localhost")}catch{}}return h}function S(b){var _=v();if(!_)return!1;try{return _.responseType=b,_.responseType===b}catch{}return!1}Object.defineProperty(p,"__esModule",{value:!0}),p.detectXHROverrideMimeTypeSupport=p.detectMozXHRSupport=p.xhrSupportsResponseType=void 0,p.xhrSupportsResponseType=S,p.detectMozXHRSupport=function(){return typeof XMLHttpRequest!="undefined"&&S("moz-chunked-arraybuffer")},p.detectXHROverrideMimeTypeSupport=function(){return typeof XMLHttpRequest!="undefined"&&XMLHttpRequest.prototype.hasOwnProperty("overrideMimeType")}},540:function(l,p,h){Object.defineProperty(p,"__esModule",{value:!0}),p.WebsocketTransport=void 0;var v,S=h(346),b=h(617);(function(I){I[I.FINISH_SEND=1]="FINISH_SEND"})(v||(v={}));var _=new Uint8Array([1]);p.WebsocketTransport=function(){return function(I){return function(T){T.debug&&S.debug("websocketRequest",T);var k,w=function(U){if(U.substr(0,8)==="https://")return"wss://"+U.substr(8);if(U.substr(0,7)==="http://")return"ws://"+U.substr(7);throw new Error("Websocket transport constructed with non-https:// or http:// host.")}(T.url),P=[];function $(U){if(U===v.FINISH_SEND)k.send(_);else{var E=U,D=new Int8Array(E.byteLength+1);D.set(new Uint8Array([0])),D.set(E,1),k.send(D)}}return{sendMessage:function(U){k&&k.readyState!==k.CONNECTING?$(U):P.push(U)},finishSend:function(){k&&k.readyState!==k.CONNECTING?$(v.FINISH_SEND):P.push(v.FINISH_SEND)},start:function(U){(k=new WebSocket(w,["grpc-websockets"])).binaryType="arraybuffer",k.onopen=function(){var E;T.debug&&S.debug("websocketRequest.onopen"),k.send((E="",U.forEach(function(D,F){E+=D+": "+F.join(", ")+`\r
`}),b.encodeASCII(E))),P.forEach(function(D){$(D)})},k.onclose=function(E){T.debug&&S.debug("websocketRequest.onclose",E),T.onEnd()},k.onerror=function(E){T.debug&&S.debug("websocketRequest.onerror",E)},k.onmessage=function(E){T.onChunk(new Uint8Array(E.data))}},cancel:function(){T.debug&&S.debug("websocket.abort"),k.close()}}}(I)}}},35:function(l,p,h){Object.defineProperty(p,"__esModule",{value:!0}),p.unary=void 0;var v=h(65),S=h(934);p.unary=function(b,_){if(b.responseStream)throw new Error(".unary cannot be used with server-streaming methods. Use .invoke or .client instead.");if(b.requestStream)throw new Error(".unary cannot be used with client-streaming methods. Use .client instead.");var I=null,T=null,k=S.client(b,{host:_.host,transport:_.transport,debug:_.debug});return k.onHeaders(function(w){I=w}),k.onMessage(function(w){T=w}),k.onEnd(function(w,P,$){_.onEnd({status:w,statusMessage:P,headers:I||new v.Metadata,message:T,trailers:$})}),k.start(_.metadata),k.send(_.request),k.finishSend(),{close:function(){k.close()}}}},882:function(l,p){Object.defineProperty(p,"__esModule",{value:!0}),p.frameRequest=void 0,p.frameRequest=function(h){var v=h.serializeBinary(),S=new ArrayBuffer(v.byteLength+5);return new DataView(S,1,4).setUint32(0,v.length,!1),new Uint8Array(S,5).set(v),new Uint8Array(S)}}},c={},function l(p){if(c[p])return c[p].exports;var h=c[p]={exports:{}};return d[p].call(h.exports,h,h.exports,l),h.exports}(607);var d,c})})(grpcWebClient_umd);class AbortError extends Error{constructor(){super("The operation has been aborted"),this.message="The operation has been aborted",this.name="AbortError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,this.constructor)}}function isAbortError(a){return typeof a=="object"&&a!==null&&a.name==="AbortError"}function throwIfAborted(a){if(a.aborted)throw new AbortError}function rethrowAbortError(a){if(isAbortError(a))throw a}function catchAbortError(a){if(!isAbortError(a))throw a}function execute(a,s){return new Promise((d,c)=>{if(a.aborted){c(new AbortError);return}let l,p=!1;function h(){p||(p=!0,l!=null&&l())}const v=s(S=>{d(S),h()},S=>{c(S),h()});if(!p){const S=()=>{const b=v();b==null?c(new AbortError):b.then(()=>{c(new AbortError)},_=>{c(_)}),h()};a.addEventListener("abort",S),l=()=>{a.removeEventListener("abort",S)}}})}function abortable(a,s){if(a.aborted){const d=()=>{};s.then(d,d)}return execute(a,(d,c)=>(s.then(d,c),()=>{}))}function delay$1(a,s){return execute(a,d=>{const c=typeof s=="number"?s:s.getTime()-Date.now(),l=setTimeout(d,c);return()=>{clearTimeout(l)}})}function forever(a){return execute(a,()=>()=>{})}function waitForEvent(a,s,d,c){return execute(a,l=>{let p,h=!1;return p=listen(s,d,(...S)=>{l(S.length>1?S:S[0]),h=!0,p!=null&&p()},c),h&&p(),()=>{h=!0,p!=null&&p()}})}function listen(a,s,d,c){if(isEventTarget(a))return a.addEventListener(s,d,c),()=>a.removeEventListener(s,d,c);if(isJQueryStyleEventEmitter(a))return a.on(s,d),()=>a.off(s,d);if(isNodeStyleEventEmitter(a))return a.addListener(s,d),()=>a.removeListener(s,d);throw new Error("Invalid event target")}function isNodeStyleEventEmitter(a){return isFunction$2(a.addListener)&&isFunction$2(a.removeListener)}function isJQueryStyleEventEmitter(a){return isFunction$2(a.on)&&isFunction$2(a.off)}function isEventTarget(a){return isFunction$2(a.addEventListener)&&isFunction$2(a.removeEventListener)}const isFunction$2=a=>typeof a=="function";var browser$3={exports:{}};const _global=typeof self!="undefined"?self:typeof window!="undefined"?window:void 0;if(!_global)throw new Error("Unable to find global scope. Are you sure this is running in the browser?");if(!_global.AbortController)throw new Error('Could not find "AbortController" in the global scope. You need to polyfill it first');browser$3.exports=_global.AbortController,browser$3.exports.default=_global.AbortController;var AbortController$1=browser$3.exports;function all(a,s){return new Promise((d,c)=>{if(a.aborted){c(new AbortError);return}const l=new AbortController$1,p=s(l.signal);if(p.length===0){d([]);return}const h=()=>{l.abort()};a.addEventListener("abort",h);let v;const S=new Array(p.length);let b=0;function _(){b+=1,b===p.length&&(a.removeEventListener("abort",h),v!=null?c(v.reason):d(S))}for(const[I,T]of p.entries())T.then(k=>{S[I]=k,_()},k=>{l.abort(),(v==null||!isAbortError(k)&&isAbortError(v.reason))&&(v={reason:k}),_()})})}function race$2(a,s){return new Promise((d,c)=>{if(a.aborted){c(new AbortError);return}const l=new AbortController$1,p=s(l.signal),h=()=>{l.abort()};a.addEventListener("abort",h);let v=0;function S(_){l.abort(),v+=1,v===p.length&&(a.removeEventListener("abort",h),_.status==="fulfilled"?d(_.value):c(_.reason))}let b;for(const _ of p)_.then(I=>{b==null&&(b={status:"fulfilled",value:I}),S(b)},I=>{(b==null||!isAbortError(I)&&(b.status==="fulfilled"||isAbortError(b.reason)))&&(b={status:"rejected",reason:I}),S(b)})})}async function retry$1(a,s,d={}){const{baseMs:c=1e3,maxDelayMs:l=15e3,onError:p,maxAttempts:h=1/0}=d;let v=0;const S=()=>{v=-1};for(;;)try{return await s(a,v,S)}catch(b){if(rethrowAbortError(b),v>=h)throw b;let _;if(v===-1)_=0;else{const I=Math.min(l,Math.pow(2,v)*c);_=Math.round(I*(1+Math.random())/2)}p&&p(b,v,_),_!==0&&await delay$1(a,_),v+=1}}function spawn(a,s){if(a.aborted)return Promise.reject(new AbortError);const d=[],c=new AbortController$1,l=c.signal,p=()=>{c.abort()};a.addEventListener("abort",p);const h=()=>{a.removeEventListener("abort",p)},v=new Set,S=()=>{for(const I of v)I.abort()};l.addEventListener("abort",S);const b=()=>{l.removeEventListener("abort",S)};let _=new Promise((I,T)=>{let k,w;P($=>s($,{defer(U){d.push(U)},fork:P})).join().then($=>{c.abort(),k={value:$}},$=>{c.abort(),(!isAbortError($)||w==null)&&(w={error:$})});function P($){if(l.aborted)return{abort(){},async join(){throw new AbortError}};const U=new AbortController$1,E=U.signal,D=$(E),F={abort(){U.abort()},join:()=>D};return v.add(F),D.catch(catchAbortError).catch(J=>{w={error:J},c.abort()}).finally(()=>{v.delete(F),v.size===0&&(w!=null?T(w.error):I(k.value))}),F}});return _=_.finally(()=>{h(),b();let I=Promise.resolve();for(let T=d.length-1;T>=0;T--)I=I.finally(d[T]);return I}),_}function run(a){const s=new AbortController$1,d=a(s.signal).catch(catchAbortError);return()=>(s.abort(),d)}var es=Object.freeze(Object.defineProperty({__proto__:null,abortable,AbortError,isAbortError,throwIfAborted,rethrowAbortError,catchAbortError,delay:delay$1,execute,forever,waitForEvent,all,race:race$2,retry:retry$1,spawn,run},Symbol.toStringTag,{value:"Module"})),require$$1$1=getAugmentedNamespace(es),AsyncSink$1={};Object.defineProperty(AsyncSink$1,"__esModule",{value:!0}),AsyncSink$1.AsyncSink=void 0;const ARRAY_VALUE="value",ARRAY_ERROR="error";class AsyncSink{constructor(){this._ended=!1,this._values=[],this._resolvers=[]}[Symbol.asyncIterator](){return this}write(s){this._push({type:ARRAY_VALUE,value:s})}error(s){this._push({type:ARRAY_ERROR,error:s})}_push(s){if(this._ended)throw new Error("AsyncSink already ended");if(this._resolvers.length>0){const{resolve:d,reject:c}=this._resolvers.shift();s.type===ARRAY_ERROR?c(s.error):d({done:!1,value:s.value})}else this._values.push(s)}next(){if(this._values.length>0){const{type:s,value:d,error:c}=this._values.shift();return s===ARRAY_ERROR?Promise.reject(c):Promise.resolve({done:!1,value:d})}return this._ended?Promise.resolve({done:!0}):new Promise((s,d)=>{this._resolvers.push({resolve:s,reject:d})})}end(){for(;this._resolvers.length>0;)this._resolvers.shift().resolve({done:!0});this._ended=!0}}AsyncSink$1.AsyncSink=AsyncSink;var isAsyncIterable$1={};Object.defineProperty(isAsyncIterable$1,"__esModule",{value:!0}),isAsyncIterable$1.isAsyncIterable=void 0;function isAsyncIterable(a){return a!=null&&Symbol.asyncIterator in a}isAsyncIterable$1.isAsyncIterable=isAsyncIterable;var convertMetadata={},base64$4={exports:{}};(function(a,s){(function(d,c){a.exports=c()})(typeof self!="undefined"?self:typeof window!="undefined"?window:commonjsGlobal$1,function(){var d="3.7.2",c=d,l=typeof atob=="function",p=typeof btoa=="function",h=typeof Buffer=="function",v=typeof TextDecoder=="function"?new TextDecoder:void 0,S=typeof TextEncoder=="function"?new TextEncoder:void 0,b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_=Array.prototype.slice.call(b),I=function(te){var se={};return te.forEach(function(le,ue){return se[le]=ue}),se}(_),T=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,k=String.fromCharCode.bind(String),w=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):function(te,se){return se===void 0&&(se=function(le){return le}),new Uint8Array(Array.prototype.slice.call(te,0).map(se))},P=function(te){return te.replace(/=/g,"").replace(/[+\/]/g,function(se){return se=="+"?"-":"_"})},$=function(te){return te.replace(/[^A-Za-z0-9\+\/]/g,"")},U=function(te){for(var se,le,ue,De,Oe="",qe=te.length%3,ke=0;ke<te.length;){if((le=te.charCodeAt(ke++))>255||(ue=te.charCodeAt(ke++))>255||(De=te.charCodeAt(ke++))>255)throw new TypeError("invalid character found");se=le<<16|ue<<8|De,Oe+=_[se>>18&63]+_[se>>12&63]+_[se>>6&63]+_[se&63]}return qe?Oe.slice(0,qe-3)+"===".substring(qe):Oe},E=p?function(te){return btoa(te)}:h?function(te){return Buffer.from(te,"binary").toString("base64")}:U,D=h?function(te){return Buffer.from(te).toString("base64")}:function(te){for(var se=4096,le=[],ue=0,De=te.length;ue<De;ue+=se)le.push(k.apply(null,te.subarray(ue,ue+se)));return E(le.join(""))},F=function(te,se){return se===void 0&&(se=!1),se?P(D(te)):D(te)},J=function(te){if(te.length<2){var se=te.charCodeAt(0);return se<128?te:se<2048?k(192|se>>>6)+k(128|se&63):k(224|se>>>12&15)+k(128|se>>>6&63)+k(128|se&63)}else{var se=65536+(te.charCodeAt(0)-55296)*1024+(te.charCodeAt(1)-56320);return k(240|se>>>18&7)+k(128|se>>>12&63)+k(128|se>>>6&63)+k(128|se&63)}},G=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,x=function(te){return te.replace(G,J)},Y=h?function(te){return Buffer.from(te,"utf8").toString("base64")}:S?function(te){return D(S.encode(te))}:function(te){return E(x(te))},N=function(te,se){return se===void 0&&(se=!1),se?P(Y(te)):Y(te)},z=function(te){return N(te,!0)},Z=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,L=function(te){switch(te.length){case 4:var se=(7&te.charCodeAt(0))<<18|(63&te.charCodeAt(1))<<12|(63&te.charCodeAt(2))<<6|63&te.charCodeAt(3),le=se-65536;return k((le>>>10)+55296)+k((le&1023)+56320);case 3:return k((15&te.charCodeAt(0))<<12|(63&te.charCodeAt(1))<<6|63&te.charCodeAt(2));default:return k((31&te.charCodeAt(0))<<6|63&te.charCodeAt(1))}},V=function(te){return te.replace(Z,L)},H=function(te){if(te=te.replace(/\s+/g,""),!T.test(te))throw new TypeError("malformed base64.");te+="==".slice(2-(te.length&3));for(var se,le="",ue,De,Oe=0;Oe<te.length;)se=I[te.charAt(Oe++)]<<18|I[te.charAt(Oe++)]<<12|(ue=I[te.charAt(Oe++)])<<6|(De=I[te.charAt(Oe++)]),le+=ue===64?k(se>>16&255):De===64?k(se>>16&255,se>>8&255):k(se>>16&255,se>>8&255,se&255);return le},de=l?function(te){return atob($(te))}:h?function(te){return Buffer.from(te,"base64").toString("binary")}:H,X=h?function(te){return w(Buffer.from(te,"base64"))}:function(te){return w(de(te),function(se){return se.charCodeAt(0)})},K=function(te){return X(pe(te))},oe=h?function(te){return Buffer.from(te,"base64").toString("utf8")}:v?function(te){return v.decode(X(te))}:function(te){return V(de(te))},pe=function(te){return $(te.replace(/[-_]/g,function(se){return se=="-"?"+":"/"}))},me=function(te){return oe(pe(te))},ve=function(te){if(typeof te!="string")return!1;var se=te.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(se)||!/[^\s0-9a-zA-Z\-_]/.test(se)},A=function(te){return{value:te,enumerable:!1,writable:!0,configurable:!0}},W=function(){var te=function(se,le){return Object.defineProperty(String.prototype,se,A(le))};te("fromBase64",function(){return me(this)}),te("toBase64",function(se){return N(this,se)}),te("toBase64URI",function(){return N(this,!0)}),te("toBase64URL",function(){return N(this,!0)}),te("toUint8Array",function(){return K(this)})},ee=function(){var te=function(se,le){return Object.defineProperty(Uint8Array.prototype,se,A(le))};te("toBase64",function(se){return F(this,se)}),te("toBase64URI",function(){return F(this,!0)}),te("toBase64URL",function(){return F(this,!0)})},ce=function(){W(),ee()},re={version:d,VERSION:c,atob:de,atobPolyfill:H,btoa:E,btoaPolyfill:U,fromBase64:me,toBase64:N,encode:N,encodeURI:z,encodeURL:z,utob:x,btou:V,decode:me,isValid:ve,fromUint8Array:F,toUint8Array:K,extendString:W,extendUint8Array:ee,extendBuiltins:ce};return re.Base64={},Object.keys(re).forEach(function(te){return re.Base64[te]=re[te]}),re})})(base64$4),Object.defineProperty(convertMetadata,"__esModule",{value:!0}),convertMetadata.convertMetadataFromGrpcWeb=convertMetadata.convertMetadataToGrpcWeb=void 0;const grpc_web_1$4=grpcWebClient_umd.exports,nice_grpc_common_1$5=lib,js_base64_1=base64$4.exports;function convertMetadataToGrpcWeb(a){const s=new grpc_web_1$4.grpc.Metadata;for(const[d,c]of a)for(const l of c)s.append(d,typeof l=="string"?l:js_base64_1.Base64.fromUint8Array(l));return s}convertMetadata.convertMetadataToGrpcWeb=convertMetadataToGrpcWeb;function convertMetadataFromGrpcWeb(a){const s=(0,nice_grpc_common_1$5.Metadata)();for(const[d,c]of Object.entries(a.headersMap))s.set(d,d.endsWith("-bin")?c.map(l=>js_base64_1.Base64.toUint8Array(l)):c);return s}convertMetadata.convertMetadataFromGrpcWeb=convertMetadataFromGrpcWeb;var __importDefault$9=commonjsGlobal$1&&commonjsGlobal$1.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(createBidiStreamingMethod$1,"__esModule",{value:!0}),createBidiStreamingMethod$1.createBidiStreamingMethod=void 0;const nice_grpc_common_1$4=lib,grpc_web_1$3=grpcWebClient_umd.exports,abort_controller_x_1$4=require$$1$1,node_abort_controller_1$3=__importDefault$9(browser$3.exports),AsyncSink_1$1=AsyncSink$1,service_definitions_1$4=serviceDefinitions,isAsyncIterable_1$3=isAsyncIterable$1,convertMetadata_1$3=convertMetadata;function createBidiStreamingMethod(a,s,d,c){const l=(0,service_definitions_1$4.toGrpcWebMethodDefinition)(a),p={path:a.path,requestStream:a.requestStream,responseStream:a.responseStream,options:a.options};async function*h(S,b){if(!(0,isAsyncIterable_1$3.isAsyncIterable)(S))throw new Error("A middleware passed invalid request to next(): expected a single message for bidirectional streaming method");const{metadata:_=(0,nice_grpc_common_1$4.Metadata)(),signal:I=new node_abort_controller_1$3.default().signal,onHeader:T,onTrailer:k}=b,w=new node_abort_controller_1$3.default,P=new AsyncSink_1$1.AsyncSink,$=grpc_web_1$3.grpc.client(l,{host:s.address,transport:s.transport});$.onHeaders(D=>{T==null||T((0,convertMetadata_1$3.convertMetadataFromGrpcWeb)(D))}),$.onMessage(D=>{P.write(D)}),$.onEnd((D,F,J)=>{k==null||k((0,convertMetadata_1$3.convertMetadataFromGrpcWeb)(J)),D===grpc_web_1$3.grpc.Code.OK?P.end():P.error(new nice_grpc_common_1$4.ClientError(a.path,+D,F))}),$.start((0,convertMetadata_1$3.convertMetadataToGrpcWeb)(_));let U;pipeRequest$1(w.signal,S,$,a).then(()=>{$.finishSend()},D=>{(0,abort_controller_x_1$4.isAbortError)(D)||(U=D,$.close(),P.end())});const E=()=>{P.error(new abort_controller_x_1$4.AbortError),w.abort(),$.close()};I.addEventListener("abort",E);try{yield*P}finally{if(w.abort(),I.removeEventListener("abort",E),(0,abort_controller_x_1$4.throwIfAborted)(I),U)throw U}}const v=d==null?h:(S,b)=>d({method:p,requestStream:!0,request:S,responseStream:!0,next:h},b);return(S,b)=>{const I=v(S,{...c,...b})[Symbol.asyncIterator]();return{[Symbol.asyncIterator](){return{async next(){const T=await I.next();return T.done&&T.value!=null?await I.throw(new Error("A middleware returned a message, but expected to return void for bidirectional streaming method")):T},return(){return I.return()},throw(T){return I.throw(T)}}}}}}createBidiStreamingMethod$1.createBidiStreamingMethod=createBidiStreamingMethod;async function pipeRequest$1(a,s,d,c){for await(const l of s)(0,abort_controller_x_1$4.throwIfAborted)(a),d.send({serializeBinary:()=>c.requestSerialize(l)})}var createClientStreamingMethod$1={},__importDefault$8=commonjsGlobal$1&&commonjsGlobal$1.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(createClientStreamingMethod$1,"__esModule",{value:!0}),createClientStreamingMethod$1.createClientStreamingMethod=void 0;const nice_grpc_common_1$3=lib,grpc_web_1$2=grpcWebClient_umd.exports,abort_controller_x_1$3=require$$1$1,node_abort_controller_1$2=__importDefault$8(browser$3.exports),service_definitions_1$3=serviceDefinitions,isAsyncIterable_1$2=isAsyncIterable$1,convertMetadata_1$2=convertMetadata;function createClientStreamingMethod(a,s,d,c){const l=(0,service_definitions_1$3.toGrpcWebMethodDefinition)(a),p={path:a.path,requestStream:a.requestStream,responseStream:a.responseStream,options:a.options};async function*h(S,b){if(!(0,isAsyncIterable_1$2.isAsyncIterable)(S))throw new Error("A middleware passed invalid request to next(): expected a single message for client streaming method");const{metadata:_=(0,nice_grpc_common_1$3.Metadata)(),signal:I=new node_abort_controller_1$2.default().signal,onHeader:T,onTrailer:k}=b;return await(0,abort_controller_x_1$3.execute)(I,(w,P)=>{const $=new node_abort_controller_1$2.default;let U;const E=grpc_web_1$2.grpc.client(l,{host:s.address,transport:s.transport});return E.onHeaders(D=>{T==null||T((0,convertMetadata_1$2.convertMetadataFromGrpcWeb)(D))}),E.onMessage(D=>{U=D}),E.onEnd((D,F,J)=>{k==null||k((0,convertMetadata_1$2.convertMetadataFromGrpcWeb)(J)),$.abort(),D===grpc_web_1$2.grpc.Code.OK?w(U):P(new nice_grpc_common_1$3.ClientError(a.path,+D,F))}),E.start((0,convertMetadata_1$2.convertMetadataToGrpcWeb)(_)),pipeRequest($.signal,S,E,a).then(()=>{E.finishSend()},D=>{(0,abort_controller_x_1$3.isAbortError)(D)||(P(D),E.close())}),()=>{$.abort(),E.close()}})}const v=d==null?h:(S,b)=>d({method:p,requestStream:!0,request:S,responseStream:!1,next:h},b);return async(S,b)=>{const I=v(S,{...c,...b})[Symbol.asyncIterator]();let T=await I.next();for(;;){if(!T.done){T=await I.throw(new Error("A middleware yielded a message, but expected to only return a message for client streaming method"));continue}if(T.value==null){T=await I.throw(new Error("A middleware returned void, but expected to return a message for client streaming method"));continue}return T.value}}}createClientStreamingMethod$1.createClientStreamingMethod=createClientStreamingMethod;async function pipeRequest(a,s,d,c){for await(const l of s)(0,abort_controller_x_1$3.throwIfAborted)(a),d.send({serializeBinary:()=>c.requestSerialize(l)})}var createServerStreamingMethod$1={},__importDefault$7=commonjsGlobal$1&&commonjsGlobal$1.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(createServerStreamingMethod$1,"__esModule",{value:!0}),createServerStreamingMethod$1.createServerStreamingMethod=void 0;const grpc_web_1$1=grpcWebClient_umd.exports,abort_controller_x_1$2=require$$1$1,AsyncSink_1=AsyncSink$1,nice_grpc_common_1$2=lib,node_abort_controller_1$1=__importDefault$7(browser$3.exports),service_definitions_1$2=serviceDefinitions,convertMetadata_1$1=convertMetadata,isAsyncIterable_1$1=isAsyncIterable$1;function createServerStreamingMethod(a,s,d,c){const l=(0,service_definitions_1$2.toGrpcWebMethodDefinition)(a),p={path:a.path,requestStream:a.requestStream,responseStream:a.responseStream,options:a.options};async function*h(S,b){if((0,isAsyncIterable_1$1.isAsyncIterable)(S))throw new Error("A middleware passed invalid request to next(): expected a single message for server streaming method");const{metadata:_=(0,nice_grpc_common_1$2.Metadata)(),signal:I=new node_abort_controller_1$1.default().signal,onHeader:T,onTrailer:k}=b,w=new AsyncSink_1.AsyncSink,P=grpc_web_1$1.grpc.client(l,{host:s.address,transport:s.transport});P.onHeaders(U=>{T==null||T((0,convertMetadata_1$1.convertMetadataFromGrpcWeb)(U))}),P.onMessage(U=>{w.write(U)}),P.onEnd((U,E,D)=>{k==null||k((0,convertMetadata_1$1.convertMetadataFromGrpcWeb)(D)),U===grpc_web_1$1.grpc.Code.OK?w.end():w.error(new nice_grpc_common_1$2.ClientError(a.path,+U,E))}),P.start((0,convertMetadata_1$1.convertMetadataToGrpcWeb)(_)),P.send({serializeBinary:()=>a.requestSerialize(S)}),P.finishSend();const $=()=>{w.error(new abort_controller_x_1$2.AbortError),P.close()};I.addEventListener("abort",$);try{yield*w}finally{I.removeEventListener("abort",$),(0,abort_controller_x_1$2.throwIfAborted)(I)}}const v=d==null?h:(S,b)=>d({method:p,requestStream:!1,request:S,responseStream:!0,next:h},b);return(S,b)=>{const I=v(S,{...c,...b})[Symbol.asyncIterator]();return{[Symbol.asyncIterator](){return{async next(){const T=await I.next();return T.done&&T.value!=null?await I.throw(new Error("A middleware returned a message, but expected to return void for server streaming method")):T},return(){return I.return()},throw(T){return I.throw(T)}}}}}}createServerStreamingMethod$1.createServerStreamingMethod=createServerStreamingMethod;var createUnaryMethod$1={},__importDefault$6=commonjsGlobal$1&&commonjsGlobal$1.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(createUnaryMethod$1,"__esModule",{value:!0}),createUnaryMethod$1.createUnaryMethod=void 0;const nice_grpc_common_1$1=lib,grpc_web_1=grpcWebClient_umd.exports,abort_controller_x_1$1=require$$1$1,node_abort_controller_1=__importDefault$6(browser$3.exports),service_definitions_1$1=serviceDefinitions,isAsyncIterable_1=isAsyncIterable$1,convertMetadata_1=convertMetadata;function createUnaryMethod(a,s,d,c){const l=(0,service_definitions_1$1.toGrpcWebMethodDefinition)(a),p={path:a.path,requestStream:a.requestStream,responseStream:a.responseStream,options:a.options};async function*h(S,b){if((0,isAsyncIterable_1.isAsyncIterable)(S))throw new Error("A middleware passed invalid request to next(): expected a single message for unary method");const{metadata:_=(0,nice_grpc_common_1$1.Metadata)(),signal:I=new node_abort_controller_1.default().signal,onHeader:T,onTrailer:k}=b;return await(0,abort_controller_x_1$1.execute)(I,(w,P)=>{let $;const U=grpc_web_1.grpc.client(l,{host:s.address,transport:s.transport});return U.onHeaders(E=>{T==null||T((0,convertMetadata_1.convertMetadataFromGrpcWeb)(E))}),U.onMessage(E=>{$=E}),U.onEnd((E,D,F)=>{k==null||k((0,convertMetadata_1.convertMetadataFromGrpcWeb)(F)),E===grpc_web_1.grpc.Code.OK?w($):P(new nice_grpc_common_1$1.ClientError(a.path,+E,D))}),U.start((0,convertMetadata_1.convertMetadataToGrpcWeb)(_)),U.send({serializeBinary:()=>a.requestSerialize(S)}),U.finishSend(),()=>{U.close()}})}const v=d==null?h:(S,b)=>d({method:p,requestStream:!1,request:S,responseStream:!1,next:h},b);return async(S,b)=>{const I=v(S,{...c,...b})[Symbol.asyncIterator]();let T=await I.next();for(;;){if(!T.done){T=await I.throw(new Error("A middleware yielded a message, but expected to only return a message for unary method"));continue}if(T.value==null){T=await I.throw(new Error("A middleware returned void, but expected to return a message for unary method"));continue}return T.value}}}createUnaryMethod$1.createUnaryMethod=createUnaryMethod,Object.defineProperty(ClientFactory,"__esModule",{value:!0}),ClientFactory.createClient=ClientFactory.createClientFactory=void 0;const nice_grpc_common_1=lib,service_definitions_1=serviceDefinitions,createBidiStreamingMethod_1=createBidiStreamingMethod$1,createClientStreamingMethod_1=createClientStreamingMethod$1,createServerStreamingMethod_1=createServerStreamingMethod$1,createUnaryMethod_1=createUnaryMethod$1;function createClientFactory(){return createClientFactoryWithMiddleware()}ClientFactory.createClientFactory=createClientFactory;function createClient(a,s,d){return createClientFactory().create(a,s,d)}ClientFactory.createClient=createClient;function createClientFactoryWithMiddleware(a){return{use(s){return createClientFactoryWithMiddleware(a==null?s:(0,nice_grpc_common_1.composeClientMiddleware)(a,s))},create(s,d,c={}){const l={},p=Object.entries((0,service_definitions_1.normalizeServiceDefinition)(s));for(const[h,v]of p){const S={...c["*"],...c[h]};v.requestStream?v.responseStream?l[h]=(0,createBidiStreamingMethod_1.createBidiStreamingMethod)(v,d,a,S):l[h]=(0,createClientStreamingMethod_1.createClientStreamingMethod)(v,d,a,S):v.responseStream?l[h]=(0,createServerStreamingMethod_1.createServerStreamingMethod)(v,d,a,S):l[h]=(0,createUnaryMethod_1.createUnaryMethod)(v,d,a,S)}return l}}}var Client={};Object.defineProperty(Client,"__esModule",{value:!0}),function(a){var s=commonjsGlobal$1&&commonjsGlobal$1.__createBinding||(Object.create?function(l,p,h,v){v===void 0&&(v=h);var S=Object.getOwnPropertyDescriptor(p,h);(!S||("get"in S?!p.__esModule:S.writable||S.configurable))&&(S={enumerable:!0,get:function(){return p[h]}}),Object.defineProperty(l,v,S)}:function(l,p,h,v){v===void 0&&(v=h),l[v]=p[h]}),d=commonjsGlobal$1&&commonjsGlobal$1.__exportStar||function(l,p){for(var h in l)h!=="default"&&!Object.prototype.hasOwnProperty.call(p,h)&&s(p,l,h)};Object.defineProperty(a,"__esModule",{value:!0}),a.Status=a.Metadata=a.composeClientMiddleware=a.ClientError=void 0;var c=lib;Object.defineProperty(a,"ClientError",{enumerable:!0,get:function(){return c.ClientError}}),Object.defineProperty(a,"composeClientMiddleware",{enumerable:!0,get:function(){return c.composeClientMiddleware}}),Object.defineProperty(a,"Metadata",{enumerable:!0,get:function(){return c.Metadata}}),Object.defineProperty(a,"Status",{enumerable:!0,get:function(){return c.Status}}),d(serviceDefinitions,a),d(channel,a),d(ClientFactory,a),d(Client,a)}(lib$1);var dist$2={},api$3={},umd={exports:{}};(function(a,s){var d=function(c){Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;/**
 * @license
 * Copyright 2009 The Closure Library Authors
 * Copyright 2020 Daniel Wirtz / The long.js Authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * SPDX-License-Identifier: Apache-2.0
 */var l=null;try{l=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function p(X,K,oe){this.low=X|0,this.high=K|0,this.unsigned=!!oe}p.prototype.__isLong__,Object.defineProperty(p.prototype,"__isLong__",{value:!0});function h(X){return(X&&X.__isLong__)===!0}function v(X){var K=Math.clz32(X&-X);return X?31-K:K}p.isLong=h;var S={},b={};function _(X,K){var oe,pe,me;return K?(X>>>=0,(me=0<=X&&X<256)&&(pe=b[X],pe)?pe:(oe=T(X,0,!0),me&&(b[X]=oe),oe)):(X|=0,(me=-128<=X&&X<128)&&(pe=S[X],pe)?pe:(oe=T(X,X<0?-1:0,!1),me&&(S[X]=oe),oe))}p.fromInt=_;function I(X,K){if(isNaN(X))return K?x:G;if(K){if(X<0)return x;if(X>=D)return L}else{if(X<=-F)return V;if(X+1>=F)return Z}return X<0?I(-X,K).neg():T(X%E|0,X/E|0,K)}p.fromNumber=I;function T(X,K,oe){return new p(X,K,oe)}p.fromBits=T;var k=Math.pow;function w(X,K,oe){if(X.length===0)throw Error("empty string");if(typeof K=="number"?(oe=K,K=!1):K=!!K,X==="NaN"||X==="Infinity"||X==="+Infinity"||X==="-Infinity")return K?x:G;if(oe=oe||10,oe<2||36<oe)throw RangeError("radix");var pe;if((pe=X.indexOf("-"))>0)throw Error("interior hyphen");if(pe===0)return w(X.substring(1),K,oe).neg();for(var me=I(k(oe,8)),ve=G,A=0;A<X.length;A+=8){var W=Math.min(8,X.length-A),ee=parseInt(X.substring(A,A+W),oe);if(W<8){var ce=I(k(oe,W));ve=ve.mul(ce).add(I(ee))}else ve=ve.mul(me),ve=ve.add(I(ee))}return ve.unsigned=K,ve}p.fromString=w;function P(X,K){return typeof X=="number"?I(X,K):typeof X=="string"?w(X,K):T(X.low,X.high,typeof K=="boolean"?K:X.unsigned)}p.fromValue=P;var $=1<<16,U=1<<24,E=$*$,D=E*E,F=D/2,J=_(U),G=_(0);p.ZERO=G;var x=_(0,!0);p.UZERO=x;var Y=_(1);p.ONE=Y;var N=_(1,!0);p.UONE=N;var z=_(-1);p.NEG_ONE=z;var Z=T(-1,2147483647,!1);p.MAX_VALUE=Z;var L=T(-1,-1,!0);p.MAX_UNSIGNED_VALUE=L;var V=T(0,-2147483648,!1);p.MIN_VALUE=V;var H=p.prototype;H.toInt=function(){return this.unsigned?this.low>>>0:this.low},H.toNumber=function(){return this.unsigned?(this.high>>>0)*E+(this.low>>>0):this.high*E+(this.low>>>0)},H.toString=function(K){if(K=K||10,K<2||36<K)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(V)){var oe=I(K),pe=this.div(oe),me=pe.mul(oe).sub(this);return pe.toString(K)+me.toInt().toString(K)}else return"-"+this.neg().toString(K);for(var ve=I(k(K,6),this.unsigned),A=this,W="";;){var ee=A.div(ve),ce=A.sub(ee.mul(ve)).toInt()>>>0,re=ce.toString(K);if(A=ee,A.isZero())return re+W;for(;re.length<6;)re="0"+re;W=""+re+W}},H.getHighBits=function(){return this.high},H.getHighBitsUnsigned=function(){return this.high>>>0},H.getLowBits=function(){return this.low},H.getLowBitsUnsigned=function(){return this.low>>>0},H.getNumBitsAbs=function(){if(this.isNegative())return this.eq(V)?64:this.neg().getNumBitsAbs();for(var K=this.high!=0?this.high:this.low,oe=31;oe>0&&(K&1<<oe)==0;oe--);return this.high!=0?oe+33:oe+1},H.isZero=function(){return this.high===0&&this.low===0},H.eqz=H.isZero,H.isNegative=function(){return!this.unsigned&&this.high<0},H.isPositive=function(){return this.unsigned||this.high>=0},H.isOdd=function(){return(this.low&1)===1},H.isEven=function(){return(this.low&1)===0},H.equals=function(K){return h(K)||(K=P(K)),this.unsigned!==K.unsigned&&this.high>>>31===1&&K.high>>>31===1?!1:this.high===K.high&&this.low===K.low},H.eq=H.equals,H.notEquals=function(K){return!this.eq(K)},H.neq=H.notEquals,H.ne=H.notEquals,H.lessThan=function(K){return this.comp(K)<0},H.lt=H.lessThan,H.lessThanOrEqual=function(K){return this.comp(K)<=0},H.lte=H.lessThanOrEqual,H.le=H.lessThanOrEqual,H.greaterThan=function(K){return this.comp(K)>0},H.gt=H.greaterThan,H.greaterThanOrEqual=function(K){return this.comp(K)>=0},H.gte=H.greaterThanOrEqual,H.ge=H.greaterThanOrEqual,H.compare=function(K){if(h(K)||(K=P(K)),this.eq(K))return 0;var oe=this.isNegative(),pe=K.isNegative();return oe&&!pe?-1:!oe&&pe?1:this.unsigned?K.high>>>0>this.high>>>0||K.high===this.high&&K.low>>>0>this.low>>>0?-1:1:this.sub(K).isNegative()?-1:1},H.comp=H.compare,H.negate=function(){return!this.unsigned&&this.eq(V)?V:this.not().add(Y)},H.neg=H.negate,H.add=function(K){h(K)||(K=P(K));var oe=this.high>>>16,pe=this.high&65535,me=this.low>>>16,ve=this.low&65535,A=K.high>>>16,W=K.high&65535,ee=K.low>>>16,ce=K.low&65535,re=0,te=0,se=0,le=0;return le+=ve+ce,se+=le>>>16,le&=65535,se+=me+ee,te+=se>>>16,se&=65535,te+=pe+W,re+=te>>>16,te&=65535,re+=oe+A,re&=65535,T(se<<16|le,re<<16|te,this.unsigned)},H.subtract=function(K){return h(K)||(K=P(K)),this.add(K.neg())},H.sub=H.subtract,H.multiply=function(K){if(this.isZero())return this;if(h(K)||(K=P(K)),l){var oe=l.mul(this.low,this.high,K.low,K.high);return T(oe,l.get_high(),this.unsigned)}if(K.isZero())return this.unsigned?x:G;if(this.eq(V))return K.isOdd()?V:G;if(K.eq(V))return this.isOdd()?V:G;if(this.isNegative())return K.isNegative()?this.neg().mul(K.neg()):this.neg().mul(K).neg();if(K.isNegative())return this.mul(K.neg()).neg();if(this.lt(J)&&K.lt(J))return I(this.toNumber()*K.toNumber(),this.unsigned);var pe=this.high>>>16,me=this.high&65535,ve=this.low>>>16,A=this.low&65535,W=K.high>>>16,ee=K.high&65535,ce=K.low>>>16,re=K.low&65535,te=0,se=0,le=0,ue=0;return ue+=A*re,le+=ue>>>16,ue&=65535,le+=ve*re,se+=le>>>16,le&=65535,le+=A*ce,se+=le>>>16,le&=65535,se+=me*re,te+=se>>>16,se&=65535,se+=ve*ce,te+=se>>>16,se&=65535,se+=A*ee,te+=se>>>16,se&=65535,te+=pe*re+me*ce+ve*ee+A*W,te&=65535,T(le<<16|ue,te<<16|se,this.unsigned)},H.mul=H.multiply,H.divide=function(K){if(h(K)||(K=P(K)),K.isZero())throw Error("division by zero");if(l){if(!this.unsigned&&this.high===-2147483648&&K.low===-1&&K.high===-1)return this;var oe=(this.unsigned?l.div_u:l.div_s)(this.low,this.high,K.low,K.high);return T(oe,l.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?x:G;var pe,me,ve;if(this.unsigned){if(K.unsigned||(K=K.toUnsigned()),K.gt(this))return x;if(K.gt(this.shru(1)))return N;ve=x}else{if(this.eq(V)){if(K.eq(Y)||K.eq(z))return V;if(K.eq(V))return Y;var A=this.shr(1);return pe=A.div(K).shl(1),pe.eq(G)?K.isNegative()?Y:z:(me=this.sub(K.mul(pe)),ve=pe.add(me.div(K)),ve)}else if(K.eq(V))return this.unsigned?x:G;if(this.isNegative())return K.isNegative()?this.neg().div(K.neg()):this.neg().div(K).neg();if(K.isNegative())return this.div(K.neg()).neg();ve=G}for(me=this;me.gte(K);){pe=Math.max(1,Math.floor(me.toNumber()/K.toNumber()));for(var W=Math.ceil(Math.log(pe)/Math.LN2),ee=W<=48?1:k(2,W-48),ce=I(pe),re=ce.mul(K);re.isNegative()||re.gt(me);)pe-=ee,ce=I(pe,this.unsigned),re=ce.mul(K);ce.isZero()&&(ce=Y),ve=ve.add(ce),me=me.sub(re)}return ve},H.div=H.divide,H.modulo=function(K){if(h(K)||(K=P(K)),l){var oe=(this.unsigned?l.rem_u:l.rem_s)(this.low,this.high,K.low,K.high);return T(oe,l.get_high(),this.unsigned)}return this.sub(this.div(K).mul(K))},H.mod=H.modulo,H.rem=H.modulo,H.not=function(){return T(~this.low,~this.high,this.unsigned)},H.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},H.clz=H.countLeadingZeros,H.countTrailingZeros=function(){return this.low?v(this.low):v(this.high)+32},H.ctz=H.countTrailingZeros,H.and=function(K){return h(K)||(K=P(K)),T(this.low&K.low,this.high&K.high,this.unsigned)},H.or=function(K){return h(K)||(K=P(K)),T(this.low|K.low,this.high|K.high,this.unsigned)},H.xor=function(K){return h(K)||(K=P(K)),T(this.low^K.low,this.high^K.high,this.unsigned)},H.shiftLeft=function(K){return h(K)&&(K=K.toInt()),(K&=63)===0?this:K<32?T(this.low<<K,this.high<<K|this.low>>>32-K,this.unsigned):T(0,this.low<<K-32,this.unsigned)},H.shl=H.shiftLeft,H.shiftRight=function(K){return h(K)&&(K=K.toInt()),(K&=63)===0?this:K<32?T(this.low>>>K|this.high<<32-K,this.high>>K,this.unsigned):T(this.high>>K-32,this.high>=0?0:-1,this.unsigned)},H.shr=H.shiftRight,H.shiftRightUnsigned=function(K){return h(K)&&(K=K.toInt()),(K&=63)===0?this:K<32?T(this.low>>>K|this.high<<32-K,this.high>>>K,this.unsigned):K===32?T(this.high,0,this.unsigned):T(this.high>>>K-32,0,this.unsigned)},H.shru=H.shiftRightUnsigned,H.shr_u=H.shiftRightUnsigned,H.rotateLeft=function(K){var oe;return h(K)&&(K=K.toInt()),(K&=63)===0?this:K===32?T(this.high,this.low,this.unsigned):K<32?(oe=32-K,T(this.low<<K|this.high>>>oe,this.high<<K|this.low>>>oe,this.unsigned)):(K-=32,oe=32-K,T(this.high<<K|this.low>>>oe,this.low<<K|this.high>>>oe,this.unsigned))},H.rotl=H.rotateLeft,H.rotateRight=function(K){var oe;return h(K)&&(K=K.toInt()),(K&=63)===0?this:K===32?T(this.high,this.low,this.unsigned):K<32?(oe=32-K,T(this.high<<oe|this.low>>>K,this.low<<oe|this.high>>>K,this.unsigned)):(K-=32,oe=32-K,T(this.low<<oe|this.high>>>K,this.high<<oe|this.low>>>K,this.unsigned))},H.rotr=H.rotateRight,H.toSigned=function(){return this.unsigned?T(this.low,this.high,!1):this},H.toUnsigned=function(){return this.unsigned?this:T(this.low,this.high,!0)},H.toBytes=function(K){return K?this.toBytesLE():this.toBytesBE()},H.toBytesLE=function(){var K=this.high,oe=this.low;return[oe&255,oe>>>8&255,oe>>>16&255,oe>>>24,K&255,K>>>8&255,K>>>16&255,K>>>24]},H.toBytesBE=function(){var K=this.high,oe=this.low;return[K>>>24,K>>>16&255,K>>>8&255,K&255,oe>>>24,oe>>>16&255,oe>>>8&255,oe&255]},p.fromBytes=function(K,oe,pe){return pe?p.fromBytesLE(K,oe):p.fromBytesBE(K,oe)},p.fromBytesLE=function(K,oe){return new p(K[0]|K[1]<<8|K[2]<<16|K[3]<<24,K[4]|K[5]<<8|K[6]<<16|K[7]<<24,oe)},p.fromBytesBE=function(K,oe){return new p(K[4]<<24|K[5]<<16|K[6]<<8|K[7],K[0]<<24|K[1]<<16|K[2]<<8|K[3],oe)};var de=p;return c.default=de,"default"in c?c.default:c}({});a.exports=d})(umd);var indexMinimal$1={},minimal$3={},aspromise$1=asPromise;function asPromise(a,s){for(var d=new Array(arguments.length-1),c=0,l=2,p=!0;l<arguments.length;)d[c++]=arguments[l++];return new Promise(function(v,S){d[c]=function(_){if(p)if(p=!1,_)S(_);else{for(var I=new Array(arguments.length-1),T=0;T<I.length;)I[T++]=arguments[T];v.apply(null,I)}};try{a.apply(s||null,d)}catch(b){p&&(p=!1,S(b))}})}var base64$3={};(function(a){var s=a;s.length=function(v){var S=v.length;if(!S)return 0;for(var b=0;--S%4>1&&v.charAt(S)==="=";)++b;return Math.ceil(v.length*3)/4-b};for(var d=new Array(64),c=new Array(123),l=0;l<64;)c[d[l]=l<26?l+65:l<52?l+71:l<62?l-4:l-59|43]=l++;s.encode=function(v,S,b){for(var _=null,I=[],T=0,k=0,w;S<b;){var P=v[S++];switch(k){case 0:I[T++]=d[P>>2],w=(P&3)<<4,k=1;break;case 1:I[T++]=d[w|P>>4],w=(P&15)<<2,k=2;break;case 2:I[T++]=d[w|P>>6],I[T++]=d[P&63],k=0;break}T>8191&&((_||(_=[])).push(String.fromCharCode.apply(String,I)),T=0)}return k&&(I[T++]=d[w],I[T++]=61,k===1&&(I[T++]=61)),_?(T&&_.push(String.fromCharCode.apply(String,I.slice(0,T))),_.join("")):String.fromCharCode.apply(String,I.slice(0,T))};var p="invalid encoding";s.decode=function(v,S,b){for(var _=b,I=0,T,k=0;k<v.length;){var w=v.charCodeAt(k++);if(w===61&&I>1)break;if((w=c[w])===void 0)throw Error(p);switch(I){case 0:T=w,I=1;break;case 1:S[b++]=T<<2|(w&48)>>4,T=w,I=2;break;case 2:S[b++]=(T&15)<<4|(w&60)>>2,T=w,I=3;break;case 3:S[b++]=(T&3)<<6|w,I=0;break}}if(I===1)throw Error(p);return b-_},s.test=function(v){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(v)}})(base64$3);var eventemitter$1=EventEmitter$1;function EventEmitter$1(){this._listeners={}}EventEmitter$1.prototype.on=function(s,d,c){return(this._listeners[s]||(this._listeners[s]=[])).push({fn:d,ctx:c||this}),this},EventEmitter$1.prototype.off=function(s,d){if(s===void 0)this._listeners={};else if(d===void 0)this._listeners[s]=[];else for(var c=this._listeners[s],l=0;l<c.length;)c[l].fn===d?c.splice(l,1):++l;return this},EventEmitter$1.prototype.emit=function(s){var d=this._listeners[s];if(d){for(var c=[],l=1;l<arguments.length;)c.push(arguments[l++]);for(l=0;l<d.length;)d[l].fn.apply(d[l++].ctx,c)}return this};var float$1=factory(factory);function factory(a){return typeof Float32Array!="undefined"?function(){var s=new Float32Array([-0]),d=new Uint8Array(s.buffer),c=d[3]===128;function l(S,b,_){s[0]=S,b[_]=d[0],b[_+1]=d[1],b[_+2]=d[2],b[_+3]=d[3]}function p(S,b,_){s[0]=S,b[_]=d[3],b[_+1]=d[2],b[_+2]=d[1],b[_+3]=d[0]}a.writeFloatLE=c?l:p,a.writeFloatBE=c?p:l;function h(S,b){return d[0]=S[b],d[1]=S[b+1],d[2]=S[b+2],d[3]=S[b+3],s[0]}function v(S,b){return d[3]=S[b],d[2]=S[b+1],d[1]=S[b+2],d[0]=S[b+3],s[0]}a.readFloatLE=c?h:v,a.readFloatBE=c?v:h}():function(){function s(c,l,p,h){var v=l<0?1:0;if(v&&(l=-l),l===0)c(1/l>0?0:2147483648,p,h);else if(isNaN(l))c(2143289344,p,h);else if(l>34028234663852886e22)c((v<<31|2139095040)>>>0,p,h);else if(l<11754943508222875e-54)c((v<<31|Math.round(l/1401298464324817e-60))>>>0,p,h);else{var S=Math.floor(Math.log(l)/Math.LN2),b=Math.round(l*Math.pow(2,-S)*8388608)&8388607;c((v<<31|S+127<<23|b)>>>0,p,h)}}a.writeFloatLE=s.bind(null,writeUintLE),a.writeFloatBE=s.bind(null,writeUintBE);function d(c,l,p){var h=c(l,p),v=(h>>31)*2+1,S=h>>>23&255,b=h&8388607;return S===255?b?NaN:v*(1/0):S===0?v*1401298464324817e-60*b:v*Math.pow(2,S-150)*(b+8388608)}a.readFloatLE=d.bind(null,readUintLE),a.readFloatBE=d.bind(null,readUintBE)}(),typeof Float64Array!="undefined"?function(){var s=new Float64Array([-0]),d=new Uint8Array(s.buffer),c=d[7]===128;function l(S,b,_){s[0]=S,b[_]=d[0],b[_+1]=d[1],b[_+2]=d[2],b[_+3]=d[3],b[_+4]=d[4],b[_+5]=d[5],b[_+6]=d[6],b[_+7]=d[7]}function p(S,b,_){s[0]=S,b[_]=d[7],b[_+1]=d[6],b[_+2]=d[5],b[_+3]=d[4],b[_+4]=d[3],b[_+5]=d[2],b[_+6]=d[1],b[_+7]=d[0]}a.writeDoubleLE=c?l:p,a.writeDoubleBE=c?p:l;function h(S,b){return d[0]=S[b],d[1]=S[b+1],d[2]=S[b+2],d[3]=S[b+3],d[4]=S[b+4],d[5]=S[b+5],d[6]=S[b+6],d[7]=S[b+7],s[0]}function v(S,b){return d[7]=S[b],d[6]=S[b+1],d[5]=S[b+2],d[4]=S[b+3],d[3]=S[b+4],d[2]=S[b+5],d[1]=S[b+6],d[0]=S[b+7],s[0]}a.readDoubleLE=c?h:v,a.readDoubleBE=c?v:h}():function(){function s(c,l,p,h,v,S){var b=h<0?1:0;if(b&&(h=-h),h===0)c(0,v,S+l),c(1/h>0?0:2147483648,v,S+p);else if(isNaN(h))c(0,v,S+l),c(2146959360,v,S+p);else if(h>17976931348623157e292)c(0,v,S+l),c((b<<31|2146435072)>>>0,v,S+p);else{var _;if(h<22250738585072014e-324)_=h/5e-324,c(_>>>0,v,S+l),c((b<<31|_/4294967296)>>>0,v,S+p);else{var I=Math.floor(Math.log(h)/Math.LN2);I===1024&&(I=1023),_=h*Math.pow(2,-I),c(_*4503599627370496>>>0,v,S+l),c((b<<31|I+1023<<20|_*1048576&1048575)>>>0,v,S+p)}}}a.writeDoubleLE=s.bind(null,writeUintLE,0,4),a.writeDoubleBE=s.bind(null,writeUintBE,4,0);function d(c,l,p,h,v){var S=c(h,v+l),b=c(h,v+p),_=(b>>31)*2+1,I=b>>>20&2047,T=4294967296*(b&1048575)+S;return I===2047?T?NaN:_*(1/0):I===0?_*5e-324*T:_*Math.pow(2,I-1075)*(T+4503599627370496)}a.readDoubleLE=d.bind(null,readUintLE,0,4),a.readDoubleBE=d.bind(null,readUintBE,4,0)}(),a}function writeUintLE(a,s,d){s[d]=a&255,s[d+1]=a>>>8&255,s[d+2]=a>>>16&255,s[d+3]=a>>>24}function writeUintBE(a,s,d){s[d]=a>>>24,s[d+1]=a>>>16&255,s[d+2]=a>>>8&255,s[d+3]=a&255}function readUintLE(a,s){return(a[s]|a[s+1]<<8|a[s+2]<<16|a[s+3]<<24)>>>0}function readUintBE(a,s){return(a[s]<<24|a[s+1]<<16|a[s+2]<<8|a[s+3])>>>0}var inquire_1$1=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(a){}return null}var utf8$5={};(function(a){var s=a;s.length=function(c){for(var l=0,p=0,h=0;h<c.length;++h)p=c.charCodeAt(h),p<128?l+=1:p<2048?l+=2:(p&64512)===55296&&(c.charCodeAt(h+1)&64512)===56320?(++h,l+=4):l+=3;return l},s.read=function(c,l,p){var h=p-l;if(h<1)return"";for(var v=null,S=[],b=0,_;l<p;)_=c[l++],_<128?S[b++]=_:_>191&&_<224?S[b++]=(_&31)<<6|c[l++]&63:_>239&&_<365?(_=((_&7)<<18|(c[l++]&63)<<12|(c[l++]&63)<<6|c[l++]&63)-65536,S[b++]=55296+(_>>10),S[b++]=56320+(_&1023)):S[b++]=(_&15)<<12|(c[l++]&63)<<6|c[l++]&63,b>8191&&((v||(v=[])).push(String.fromCharCode.apply(String,S)),b=0);return v?(b&&v.push(String.fromCharCode.apply(String,S.slice(0,b))),v.join("")):String.fromCharCode.apply(String,S.slice(0,b))},s.write=function(c,l,p){for(var h=p,v,S,b=0;b<c.length;++b)v=c.charCodeAt(b),v<128?l[p++]=v:v<2048?(l[p++]=v>>6|192,l[p++]=v&63|128):(v&64512)===55296&&((S=c.charCodeAt(b+1))&64512)===56320?(v=65536+((v&1023)<<10)+(S&1023),++b,l[p++]=v>>18|240,l[p++]=v>>12&63|128,l[p++]=v>>6&63|128,l[p++]=v&63|128):(l[p++]=v>>12|224,l[p++]=v>>6&63|128,l[p++]=v&63|128);return p-h}})(utf8$5);var pool_1$1=pool;function pool(a,s,d){var c=d||8192,l=c>>>1,p=null,h=c;return function(S){if(S<1||S>l)return a(S);h+S>c&&(p=a(c),h=0);var b=s.call(p,h,h+=S);return h&7&&(h=(h|7)+1),b}}var longbits$1=LongBits$4,util$a=minimal$3;function LongBits$4(a,s){this.lo=a>>>0,this.hi=s>>>0}var zero=LongBits$4.zero=new LongBits$4(0,0);zero.toNumber=function(){return 0},zero.zzEncode=zero.zzDecode=function(){return this},zero.length=function(){return 1};var zeroHash=LongBits$4.zeroHash="\0\0\0\0\0\0\0\0";LongBits$4.fromNumber=function a(s){if(s===0)return zero;var d=s<0;d&&(s=-s);var c=s>>>0,l=(s-c)/4294967296>>>0;return d&&(l=~l>>>0,c=~c>>>0,++c>4294967295&&(c=0,++l>4294967295&&(l=0))),new LongBits$4(c,l)},LongBits$4.from=function a(s){if(typeof s=="number")return LongBits$4.fromNumber(s);if(util$a.isString(s))if(util$a.Long)s=util$a.Long.fromString(s);else return LongBits$4.fromNumber(parseInt(s,10));return s.low||s.high?new LongBits$4(s.low>>>0,s.high>>>0):zero},LongBits$4.prototype.toNumber=function a(s){if(!s&&this.hi>>>31){var d=~this.lo+1>>>0,c=~this.hi>>>0;return d||(c=c+1>>>0),-(d+c*4294967296)}return this.lo+this.hi*4294967296},LongBits$4.prototype.toLong=function a(s){return util$a.Long?new util$a.Long(this.lo|0,this.hi|0,Boolean(s)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(s)}};var charCodeAt=String.prototype.charCodeAt;LongBits$4.fromHash=function a(s){return s===zeroHash?zero:new LongBits$4((charCodeAt.call(s,0)|charCodeAt.call(s,1)<<8|charCodeAt.call(s,2)<<16|charCodeAt.call(s,3)<<24)>>>0,(charCodeAt.call(s,4)|charCodeAt.call(s,5)<<8|charCodeAt.call(s,6)<<16|charCodeAt.call(s,7)<<24)>>>0)},LongBits$4.prototype.toHash=function a(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},LongBits$4.prototype.zzEncode=function a(){var s=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^s)>>>0,this.lo=(this.lo<<1^s)>>>0,this},LongBits$4.prototype.zzDecode=function a(){var s=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^s)>>>0,this.hi=(this.hi>>>1^s)>>>0,this},LongBits$4.prototype.length=function a(){var s=this.lo,d=(this.lo>>>28|this.hi<<4)>>>0,c=this.hi>>>24;return c===0?d===0?s<16384?s<128?1:2:s<2097152?3:4:d<16384?d<128?5:6:d<2097152?7:8:c<128?9:10},function(a){var s=a;s.asPromise=aspromise$1,s.base64=base64$3,s.EventEmitter=eventemitter$1,s.float=float$1,s.inquire=inquire_1$1,s.utf8=utf8$5,s.pool=pool_1$1,s.LongBits=longbits$1,s.isNode=Boolean(typeof commonjsGlobal$1!="undefined"&&commonjsGlobal$1&&commonjsGlobal$1.process&&commonjsGlobal$1.process.versions&&commonjsGlobal$1.process.versions.node),s.global=s.isNode&&commonjsGlobal$1||typeof window!="undefined"&&window||typeof self!="undefined"&&self||commonjsGlobal$1,s.emptyArray=Object.freeze?Object.freeze([]):[],s.emptyObject=Object.freeze?Object.freeze({}):{},s.isInteger=Number.isInteger||function(p){return typeof p=="number"&&isFinite(p)&&Math.floor(p)===p},s.isString=function(p){return typeof p=="string"||p instanceof String},s.isObject=function(p){return p&&typeof p=="object"},s.isset=s.isSet=function(p,h){var v=p[h];return v!=null&&p.hasOwnProperty(h)?typeof v!="object"||(Array.isArray(v)?v.length:Object.keys(v).length)>0:!1},s.Buffer=function(){try{var l=s.inquire("buffer").Buffer;return l.prototype.utf8Write?l:null}catch{return null}}(),s._Buffer_from=null,s._Buffer_allocUnsafe=null,s.newBuffer=function(p){return typeof p=="number"?s.Buffer?s._Buffer_allocUnsafe(p):new s.Array(p):s.Buffer?s._Buffer_from(p):typeof Uint8Array=="undefined"?p:new Uint8Array(p)},s.Array=typeof Uint8Array!="undefined"?Uint8Array:Array,s.Long=s.global.dcodeIO&&s.global.dcodeIO.Long||s.global.Long||s.inquire("long"),s.key2Re=/^true|false|0|1$/,s.key32Re=/^-?(?:0|[1-9][0-9]*)$/,s.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,s.longToHash=function(p){return p?s.LongBits.from(p).toHash():s.LongBits.zeroHash},s.longFromHash=function(p,h){var v=s.LongBits.fromHash(p);return s.Long?s.Long.fromBits(v.lo,v.hi,h):v.toNumber(Boolean(h))};function d(l,p,h){for(var v=Object.keys(p),S=0;S<v.length;++S)(l[v[S]]===void 0||!h)&&(l[v[S]]=p[v[S]]);return l}s.merge=d,s.lcFirst=function(p){return p.charAt(0).toLowerCase()+p.substring(1)};function c(l){function p(h,v){if(!(this instanceof p))return new p(h,v);Object.defineProperty(this,"message",{get:function(){return h}}),Error.captureStackTrace?Error.captureStackTrace(this,p):Object.defineProperty(this,"stack",{value:new Error().stack||""}),v&&d(this,v)}return(p.prototype=Object.create(Error.prototype)).constructor=p,Object.defineProperty(p.prototype,"name",{get:function(){return l}}),p.prototype.toString=function(){return this.name+": "+this.message},p}s.newError=c,s.ProtocolError=c("ProtocolError"),s.oneOfGetter=function(p){for(var h={},v=0;v<p.length;++v)h[p[v]]=1;return function(){for(var S=Object.keys(this),b=S.length-1;b>-1;--b)if(h[S[b]]===1&&this[S[b]]!==void 0&&this[S[b]]!==null)return S[b]}},s.oneOfSetter=function(p){return function(h){for(var v=0;v<p.length;++v)p[v]!==h&&delete this[p[v]]}},s.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},s._configure=function(){var l=s.Buffer;if(!l){s._Buffer_from=s._Buffer_allocUnsafe=null;return}s._Buffer_from=l.from!==Uint8Array.from&&l.from||function(h,v){return new l(h,v)},s._Buffer_allocUnsafe=l.allocUnsafe||function(h){return new l(h)}}}(minimal$3);var writer$3=Writer$3,util$9=minimal$3,BufferWriter$3,LongBits$3=util$9.LongBits,base64$2=util$9.base64,utf8$4=util$9.utf8;function Op$1(a,s,d){this.fn=a,this.len=s,this.next=void 0,this.val=d}function noop$3(){}function State$1(a){this.head=a.head,this.tail=a.tail,this.len=a.len,this.next=a.states}function Writer$3(){this.len=0,this.head=new Op$1(noop$3,0,0),this.tail=this.head,this.states=null}var create$4=function a(){return util$9.Buffer?function(){return(Writer$3.create=function(){return new BufferWriter$3})()}:function(){return new Writer$3}};Writer$3.create=create$4(),Writer$3.alloc=function a(s){return new util$9.Array(s)},util$9.Array!==Array&&(Writer$3.alloc=util$9.pool(Writer$3.alloc,util$9.Array.prototype.subarray)),Writer$3.prototype._push=function a(s,d,c){return this.tail=this.tail.next=new Op$1(s,d,c),this.len+=d,this};function writeByte$1(a,s,d){s[d]=a&255}function writeVarint32$1(a,s,d){for(;a>127;)s[d++]=a&127|128,a>>>=7;s[d]=a}function VarintOp$1(a,s){this.len=a,this.next=void 0,this.val=s}VarintOp$1.prototype=Object.create(Op$1.prototype),VarintOp$1.prototype.fn=writeVarint32$1,Writer$3.prototype.uint32=function a(s){return this.len+=(this.tail=this.tail.next=new VarintOp$1((s=s>>>0)<128?1:s<16384?2:s<2097152?3:s<268435456?4:5,s)).len,this},Writer$3.prototype.int32=function a(s){return s<0?this._push(writeVarint64$1,10,LongBits$3.fromNumber(s)):this.uint32(s)},Writer$3.prototype.sint32=function a(s){return this.uint32((s<<1^s>>31)>>>0)};function writeVarint64$1(a,s,d){for(;a.hi;)s[d++]=a.lo&127|128,a.lo=(a.lo>>>7|a.hi<<25)>>>0,a.hi>>>=7;for(;a.lo>127;)s[d++]=a.lo&127|128,a.lo=a.lo>>>7;s[d++]=a.lo}Writer$3.prototype.uint64=function a(s){var d=LongBits$3.from(s);return this._push(writeVarint64$1,d.length(),d)},Writer$3.prototype.int64=Writer$3.prototype.uint64,Writer$3.prototype.sint64=function a(s){var d=LongBits$3.from(s).zzEncode();return this._push(writeVarint64$1,d.length(),d)},Writer$3.prototype.bool=function a(s){return this._push(writeByte$1,1,s?1:0)};function writeFixed32$1(a,s,d){s[d]=a&255,s[d+1]=a>>>8&255,s[d+2]=a>>>16&255,s[d+3]=a>>>24}Writer$3.prototype.fixed32=function a(s){return this._push(writeFixed32$1,4,s>>>0)},Writer$3.prototype.sfixed32=Writer$3.prototype.fixed32,Writer$3.prototype.fixed64=function a(s){var d=LongBits$3.from(s);return this._push(writeFixed32$1,4,d.lo)._push(writeFixed32$1,4,d.hi)},Writer$3.prototype.sfixed64=Writer$3.prototype.fixed64,Writer$3.prototype.float=function a(s){return this._push(util$9.float.writeFloatLE,4,s)},Writer$3.prototype.double=function a(s){return this._push(util$9.float.writeDoubleLE,8,s)};var writeBytes$1=util$9.Array.prototype.set?function a(s,d,c){d.set(s,c)}:function a(s,d,c){for(var l=0;l<s.length;++l)d[c+l]=s[l]};Writer$3.prototype.bytes=function a(s){var d=s.length>>>0;if(!d)return this._push(writeByte$1,1,0);if(util$9.isString(s)){var c=Writer$3.alloc(d=base64$2.length(s));base64$2.decode(s,c,0),s=c}return this.uint32(d)._push(writeBytes$1,d,s)},Writer$3.prototype.string=function a(s){var d=utf8$4.length(s);return d?this.uint32(d)._push(utf8$4.write,d,s):this._push(writeByte$1,1,0)},Writer$3.prototype.fork=function a(){return this.states=new State$1(this),this.head=this.tail=new Op$1(noop$3,0,0),this.len=0,this},Writer$3.prototype.reset=function a(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Op$1(noop$3,0,0),this.len=0),this},Writer$3.prototype.ldelim=function a(){var s=this.head,d=this.tail,c=this.len;return this.reset().uint32(c),c&&(this.tail.next=s.next,this.tail=d,this.len+=c),this},Writer$3.prototype.finish=function a(){for(var s=this.head.next,d=this.constructor.alloc(this.len),c=0;s;)s.fn(s.val,d,c),c+=s.len,s=s.next;return d},Writer$3._configure=function(a){BufferWriter$3=a,Writer$3.create=create$4(),BufferWriter$3._configure()};var writer_buffer$1=BufferWriter$2,Writer$2=writer$3;(BufferWriter$2.prototype=Object.create(Writer$2.prototype)).constructor=BufferWriter$2;var util$8=minimal$3;function BufferWriter$2(){Writer$2.call(this)}BufferWriter$2._configure=function(){BufferWriter$2.alloc=util$8._Buffer_allocUnsafe,BufferWriter$2.writeBytesBuffer=util$8.Buffer&&util$8.Buffer.prototype instanceof Uint8Array&&util$8.Buffer.prototype.set.name==="set"?function(s,d,c){d.set(s,c)}:function(s,d,c){if(s.copy)s.copy(d,c,0,s.length);else for(var l=0;l<s.length;)d[c++]=s[l++]}},BufferWriter$2.prototype.bytes=function a(s){util$8.isString(s)&&(s=util$8._Buffer_from(s,"base64"));var d=s.length>>>0;return this.uint32(d),d&&this._push(BufferWriter$2.writeBytesBuffer,d,s),this};function writeStringBuffer$1(a,s,d){a.length<40?util$8.utf8.write(a,s,d):s.utf8Write?s.utf8Write(a,d):s.write(a,d)}BufferWriter$2.prototype.string=function a(s){var d=util$8.Buffer.byteLength(s);return this.uint32(d),d&&this._push(writeStringBuffer$1,d,s),this},BufferWriter$2._configure();var reader$1=Reader$3,util$7=minimal$3,BufferReader$3,LongBits$2=util$7.LongBits,utf8$3=util$7.utf8;function indexOutOfRange$1(a,s){return RangeError("index out of range: "+a.pos+" + "+(s||1)+" > "+a.len)}function Reader$3(a){this.buf=a,this.pos=0,this.len=a.length}var create_array$1=typeof Uint8Array!="undefined"?function a(s){if(s instanceof Uint8Array||Array.isArray(s))return new Reader$3(s);throw Error("illegal buffer")}:function a(s){if(Array.isArray(s))return new Reader$3(s);throw Error("illegal buffer")},create$3=function a(){return util$7.Buffer?function(d){return(Reader$3.create=function(l){return util$7.Buffer.isBuffer(l)?new BufferReader$3(l):create_array$1(l)})(d)}:create_array$1};Reader$3.create=create$3(),Reader$3.prototype._slice=util$7.Array.prototype.subarray||util$7.Array.prototype.slice,Reader$3.prototype.uint32=function a(){var s=4294967295;return function(){if(s=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(s=(s|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(s=(s|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(s=(s|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(s=(s|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return s;if((this.pos+=5)>this.len)throw this.pos=this.len,indexOutOfRange$1(this,10);return s}}(),Reader$3.prototype.int32=function a(){return this.uint32()|0},Reader$3.prototype.sint32=function a(){var s=this.uint32();return s>>>1^-(s&1)|0};function readLongVarint$1(){var a=new LongBits$2(0,0),s=0;if(this.len-this.pos>4){for(;s<4;++s)if(a.lo=(a.lo|(this.buf[this.pos]&127)<<s*7)>>>0,this.buf[this.pos++]<128)return a;if(a.lo=(a.lo|(this.buf[this.pos]&127)<<28)>>>0,a.hi=(a.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return a;s=0}else{for(;s<3;++s){if(this.pos>=this.len)throw indexOutOfRange$1(this);if(a.lo=(a.lo|(this.buf[this.pos]&127)<<s*7)>>>0,this.buf[this.pos++]<128)return a}return a.lo=(a.lo|(this.buf[this.pos++]&127)<<s*7)>>>0,a}if(this.len-this.pos>4){for(;s<5;++s)if(a.hi=(a.hi|(this.buf[this.pos]&127)<<s*7+3)>>>0,this.buf[this.pos++]<128)return a}else for(;s<5;++s){if(this.pos>=this.len)throw indexOutOfRange$1(this);if(a.hi=(a.hi|(this.buf[this.pos]&127)<<s*7+3)>>>0,this.buf[this.pos++]<128)return a}throw Error("invalid varint encoding")}Reader$3.prototype.bool=function a(){return this.uint32()!==0};function readFixed32_end$1(a,s){return(a[s-4]|a[s-3]<<8|a[s-2]<<16|a[s-1]<<24)>>>0}Reader$3.prototype.fixed32=function a(){if(this.pos+4>this.len)throw indexOutOfRange$1(this,4);return readFixed32_end$1(this.buf,this.pos+=4)},Reader$3.prototype.sfixed32=function a(){if(this.pos+4>this.len)throw indexOutOfRange$1(this,4);return readFixed32_end$1(this.buf,this.pos+=4)|0};function readFixed64$1(){if(this.pos+8>this.len)throw indexOutOfRange$1(this,8);return new LongBits$2(readFixed32_end$1(this.buf,this.pos+=4),readFixed32_end$1(this.buf,this.pos+=4))}Reader$3.prototype.float=function a(){if(this.pos+4>this.len)throw indexOutOfRange$1(this,4);var s=util$7.float.readFloatLE(this.buf,this.pos);return this.pos+=4,s},Reader$3.prototype.double=function a(){if(this.pos+8>this.len)throw indexOutOfRange$1(this,4);var s=util$7.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,s},Reader$3.prototype.bytes=function a(){var s=this.uint32(),d=this.pos,c=this.pos+s;if(c>this.len)throw indexOutOfRange$1(this,s);return this.pos+=s,Array.isArray(this.buf)?this.buf.slice(d,c):d===c?new this.buf.constructor(0):this._slice.call(this.buf,d,c)},Reader$3.prototype.string=function a(){var s=this.bytes();return utf8$3.read(s,0,s.length)},Reader$3.prototype.skip=function a(s){if(typeof s=="number"){if(this.pos+s>this.len)throw indexOutOfRange$1(this,s);this.pos+=s}else do if(this.pos>=this.len)throw indexOutOfRange$1(this);while(this.buf[this.pos++]&128);return this},Reader$3.prototype.skipType=function(a){switch(a){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(a=this.uint32()&7)!==4;)this.skipType(a);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+a+" at offset "+this.pos)}return this},Reader$3._configure=function(a){BufferReader$3=a,Reader$3.create=create$3(),BufferReader$3._configure();var s=util$7.Long?"toLong":"toNumber";util$7.merge(Reader$3.prototype,{int64:function(){return readLongVarint$1.call(this)[s](!1)},uint64:function(){return readLongVarint$1.call(this)[s](!0)},sint64:function(){return readLongVarint$1.call(this).zzDecode()[s](!1)},fixed64:function(){return readFixed64$1.call(this)[s](!0)},sfixed64:function(){return readFixed64$1.call(this)[s](!1)}})};var reader_buffer$1=BufferReader$2,Reader$2=reader$1;(BufferReader$2.prototype=Object.create(Reader$2.prototype)).constructor=BufferReader$2;var util$6=minimal$3;function BufferReader$2(a){Reader$2.call(this,a)}BufferReader$2._configure=function(){util$6.Buffer&&(BufferReader$2.prototype._slice=util$6.Buffer.prototype.slice)},BufferReader$2.prototype.string=function a(){var s=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+s,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+s,this.len))},BufferReader$2._configure();var rpc$1={},service$1=Service$1,util$5=minimal$3;(Service$1.prototype=Object.create(util$5.EventEmitter.prototype)).constructor=Service$1;function Service$1(a,s,d){if(typeof a!="function")throw TypeError("rpcImpl must be a function");util$5.EventEmitter.call(this),this.rpcImpl=a,this.requestDelimited=Boolean(s),this.responseDelimited=Boolean(d)}Service$1.prototype.rpcCall=function a(s,d,c,l,p){if(!l)throw TypeError("request must be specified");var h=this;if(!p)return util$5.asPromise(a,h,s,d,c,l);if(!h.rpcImpl){setTimeout(function(){p(Error("already ended"))},0);return}try{return h.rpcImpl(s,d[h.requestDelimited?"encodeDelimited":"encode"](l).finish(),function(S,b){if(S)return h.emit("error",S,s),p(S);if(b===null){h.end(!0);return}if(!(b instanceof c))try{b=c[h.responseDelimited?"decodeDelimited":"decode"](b)}catch(_){return h.emit("error",_,s),p(_)}return h.emit("data",b,s),p(null,b)})}catch(v){h.emit("error",v,s),setTimeout(function(){p(v)},0);return}},Service$1.prototype.end=function a(s){return this.rpcImpl&&(s||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this},function(a){var s=a;s.Service=service$1}(rpc$1);var roots$1={};(function(a){var s=a;s.build="minimal",s.Writer=writer$3,s.BufferWriter=writer_buffer$1,s.Reader=reader$1,s.BufferReader=reader_buffer$1,s.util=minimal$3,s.rpc=rpc$1,s.roots=roots$1,s.configure=d;function d(){s.util._configure(),s.Writer._configure(s.BufferWriter),s.Reader._configure(s.BufferReader)}d()})(indexMinimal$1);var minimal$2=indexMinimal$1,struct$2={};(function(a){var s=commonjsGlobal$1&&commonjsGlobal$1.__createBinding||(Object.create?function(E,D,F,J){J===void 0&&(J=F),Object.defineProperty(E,J,{enumerable:!0,get:function(){return D[F]}})}:function(E,D,F,J){J===void 0&&(J=F),E[J]=D[F]}),d=commonjsGlobal$1&&commonjsGlobal$1.__setModuleDefault||(Object.create?function(E,D){Object.defineProperty(E,"default",{enumerable:!0,value:D})}:function(E,D){E.default=D}),c=commonjsGlobal$1&&commonjsGlobal$1.__importStar||function(E){if(E&&E.__esModule)return E;var D={};if(E!=null)for(var F in E)F!=="default"&&Object.hasOwnProperty.call(E,F)&&s(D,E,F);return d(D,E),D},l=commonjsGlobal$1&&commonjsGlobal$1.__importDefault||function(E){return E&&E.__esModule?E:{default:E}};Object.defineProperty(a,"__esModule",{value:!0}),a.ListValue=a.Value=a.Struct_FieldsEntry=a.Struct=a.nullValueToNumber=a.nullValueToJSON=a.nullValueFromJSON=a.NullValue=a.protobufPackage=void 0;const p=l(umd.exports),h=c(minimal$2);a.protobufPackage="google.protobuf";var v;(function(E){E.NULL_VALUE="NULL_VALUE"})(v=a.NullValue||(a.NullValue={}));function S(E){switch(E){case 0:case"NULL_VALUE":return v.NULL_VALUE;default:throw new P.Error("Unrecognized enum value "+E+" for enum NullValue")}}a.nullValueFromJSON=S;function b(E){switch(E){case v.NULL_VALUE:return"NULL_VALUE";default:return"UNKNOWN"}}a.nullValueToJSON=b;function _(E){switch(E){case v.NULL_VALUE:return 0;default:return 0}}a.nullValueToNumber=_;function I(){return{fields:{}}}a.Struct={encode(E,D=h.Writer.create()){return Object.entries(E.fields).forEach(([F,J])=>{J!==void 0&&a.Struct_FieldsEntry.encode({key:F,value:J},D.uint32(10).fork()).ldelim()}),D},decode(E,D){const F=E instanceof h.Reader?E:new h.Reader(E);let J=D===void 0?F.len:F.pos+D;const G=I();for(;F.pos<J;){const x=F.uint32();switch(x>>>3){case 1:const Y=a.Struct_FieldsEntry.decode(F,F.uint32());Y.value!==void 0&&(G.fields[Y.key]=Y.value);break;default:F.skipType(x&7);break}}return G},fromJSON(E){return{fields:$(E.fields)?Object.entries(E.fields).reduce((D,[F,J])=>(D[F]=J,D),{}):{}}},toJSON(E){const D={};return D.fields={},E.fields&&Object.entries(E.fields).forEach(([F,J])=>{D.fields[F]=J}),D},fromPartial(E){var D;const F=I();return F.fields=Object.entries((D=E.fields)!==null&&D!==void 0?D:{}).reduce((J,[G,x])=>(x!==void 0&&(J[G]=x),J),{}),F},wrap(E){const D=I();return E!==void 0&&Object.keys(E).forEach(F=>{D.fields[F]=E[F]}),D},unwrap(E){const D={};return Object.keys(E.fields).forEach(F=>{D[F]=E.fields[F]}),D}};function T(){return{key:"",value:void 0}}a.Struct_FieldsEntry={encode(E,D=h.Writer.create()){return E.key!==""&&D.uint32(10).string(E.key),E.value!==void 0&&a.Value.encode(a.Value.wrap(E.value),D.uint32(18).fork()).ldelim(),D},decode(E,D){const F=E instanceof h.Reader?E:new h.Reader(E);let J=D===void 0?F.len:F.pos+D;const G=T();for(;F.pos<J;){const x=F.uint32();switch(x>>>3){case 1:G.key=F.string();break;case 2:G.value=a.Value.unwrap(a.Value.decode(F,F.uint32()));break;default:F.skipType(x&7);break}}return G},fromJSON(E){return{key:U(E.key)?String(E.key):"",value:U(E==null?void 0:E.value)?E.value:void 0}},toJSON(E){const D={};return E.key!==void 0&&(D.key=E.key),E.value!==void 0&&(D.value=E.value),D},fromPartial(E){var D,F;const J=T();return J.key=(D=E.key)!==null&&D!==void 0?D:"",J.value=(F=E.value)!==null&&F!==void 0?F:void 0,J}};function k(){return{nullValue:void 0,numberValue:void 0,stringValue:void 0,boolValue:void 0,structValue:void 0,listValue:void 0}}a.Value={encode(E,D=h.Writer.create()){return E.nullValue!==void 0&&D.uint32(8).int32(_(E.nullValue)),E.numberValue!==void 0&&D.uint32(17).double(E.numberValue),E.stringValue!==void 0&&D.uint32(26).string(E.stringValue),E.boolValue!==void 0&&D.uint32(32).bool(E.boolValue),E.structValue!==void 0&&a.Struct.encode(a.Struct.wrap(E.structValue),D.uint32(42).fork()).ldelim(),E.listValue!==void 0&&a.ListValue.encode(a.ListValue.wrap(E.listValue),D.uint32(50).fork()).ldelim(),D},decode(E,D){const F=E instanceof h.Reader?E:new h.Reader(E);let J=D===void 0?F.len:F.pos+D;const G=k();for(;F.pos<J;){const x=F.uint32();switch(x>>>3){case 1:G.nullValue=S(F.int32());break;case 2:G.numberValue=F.double();break;case 3:G.stringValue=F.string();break;case 4:G.boolValue=F.bool();break;case 5:G.structValue=a.Struct.unwrap(a.Struct.decode(F,F.uint32()));break;case 6:G.listValue=a.ListValue.unwrap(a.ListValue.decode(F,F.uint32()));break;default:F.skipType(x&7);break}}return G},fromJSON(E){return{nullValue:U(E.nullValue)?S(E.nullValue):void 0,numberValue:U(E.numberValue)?Number(E.numberValue):void 0,stringValue:U(E.stringValue)?String(E.stringValue):void 0,boolValue:U(E.boolValue)?Boolean(E.boolValue):void 0,structValue:$(E.structValue)?E.structValue:void 0,listValue:Array.isArray(E.listValue)?[...E.listValue]:void 0}},toJSON(E){const D={};return E.nullValue!==void 0&&(D.nullValue=E.nullValue!==void 0?b(E.nullValue):void 0),E.numberValue!==void 0&&(D.numberValue=E.numberValue),E.stringValue!==void 0&&(D.stringValue=E.stringValue),E.boolValue!==void 0&&(D.boolValue=E.boolValue),E.structValue!==void 0&&(D.structValue=E.structValue),E.listValue!==void 0&&(D.listValue=E.listValue),D},fromPartial(E){var D,F,J,G,x,Y;const N=k();return N.nullValue=(D=E.nullValue)!==null&&D!==void 0?D:void 0,N.numberValue=(F=E.numberValue)!==null&&F!==void 0?F:void 0,N.stringValue=(J=E.stringValue)!==null&&J!==void 0?J:void 0,N.boolValue=(G=E.boolValue)!==null&&G!==void 0?G:void 0,N.structValue=(x=E.structValue)!==null&&x!==void 0?x:void 0,N.listValue=(Y=E.listValue)!==null&&Y!==void 0?Y:void 0,N},wrap(E){const D=k();if(E===null)D.nullValue=v.NULL_VALUE;else if(typeof E=="boolean")D.boolValue=E;else if(typeof E=="number")D.numberValue=E;else if(typeof E=="string")D.stringValue=E;else if(Array.isArray(E))D.listValue=E;else if(typeof E=="object")D.structValue=E;else if(typeof E!="undefined")throw new Error("Unsupported any value type: "+typeof E);return D},unwrap(E){if((E==null?void 0:E.stringValue)!==void 0)return E.stringValue;if((E==null?void 0:E.numberValue)!==void 0)return E.numberValue;if((E==null?void 0:E.boolValue)!==void 0)return E.boolValue;if((E==null?void 0:E.structValue)!==void 0)return E.structValue;if((E==null?void 0:E.listValue)!==void 0)return E.listValue;if((E==null?void 0:E.nullValue)!==void 0)return null}};function w(){return{values:[]}}a.ListValue={encode(E,D=h.Writer.create()){for(const F of E.values)a.Value.encode(a.Value.wrap(F),D.uint32(10).fork()).ldelim();return D},decode(E,D){const F=E instanceof h.Reader?E:new h.Reader(E);let J=D===void 0?F.len:F.pos+D;const G=w();for(;F.pos<J;){const x=F.uint32();switch(x>>>3){case 1:G.values.push(a.Value.unwrap(a.Value.decode(F,F.uint32())));break;default:F.skipType(x&7);break}}return G},fromJSON(E){return{values:Array.isArray(E==null?void 0:E.values)?[...E.values]:[]}},toJSON(E){const D={};return E.values?D.values=E.values.map(F=>F):D.values=[],D},fromPartial(E){var D;const F=w();return F.values=((D=E.values)===null||D===void 0?void 0:D.map(J=>J))||[],F},wrap(E){const D=w();return D.values=E!=null?E:[],D},unwrap(E){return E.values}};var P=(()=>{if(typeof P!="undefined")return P;if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof commonjsGlobal$1!="undefined")return commonjsGlobal$1;throw"Unable to locate global object"})();h.util.Long!==p.default&&(h.util.Long=p.default,h.configure());function $(E){return typeof E=="object"&&E!==null}function U(E){return E!=null}})(struct$2),function(a){var s=commonjsGlobal$1&&commonjsGlobal$1.__createBinding||(Object.create?function(y,O,M,ne){ne===void 0&&(ne=M),Object.defineProperty(y,ne,{enumerable:!0,get:function(){return O[M]}})}:function(y,O,M,ne){ne===void 0&&(ne=M),y[ne]=O[M]}),d=commonjsGlobal$1&&commonjsGlobal$1.__setModuleDefault||(Object.create?function(y,O){Object.defineProperty(y,"default",{enumerable:!0,value:O})}:function(y,O){y.default=O}),c=commonjsGlobal$1&&commonjsGlobal$1.__importStar||function(y){if(y&&y.__esModule)return y;var O={};if(y!=null)for(var M in y)M!=="default"&&Object.hasOwnProperty.call(y,M)&&s(O,y,M);return d(O,y),O},l=commonjsGlobal$1&&commonjsGlobal$1.__importDefault||function(y){return y&&y.__esModule?y:{default:y}};Object.defineProperty(a,"__esModule",{value:!0}),a.LayoutServiceDefinition=a.LayoutServiceClientImpl=a.LayerServiceDefinition=a.LayerServiceClientImpl=a.Event=a.LayerEvent=a.LayoutEvent=a.BatchLayerRequest_BatchItem=a.BatchLayerRequest=a.BatchDeleteLayerRequest=a.DeleteLayerPayload=a.UpdateLayerRequest=a.GetLayerRequest=a.CreateLayerRequest=a.ListLayersResponse=a.ListLayersRequest=a.PartialLayerWithID=a.PartialLayer=a.LayerAnimation=a.DeleteLayoutResponse=a.DeleteLayoutRequest=a.DeleteLayoutPayload=a.UpdateLayoutRequest=a.GetLayoutRequest=a.CreateLayoutRequest=a.ListLayoutsResponse=a.ListLayoutsRequest=a.PartialLayout=a.BatchLayerResponse_BatchLayerItem=a.BatchLayerResponse=a.DeleteLayerResponse=a.DeleteLayerRequest=a.Layer=a.Layout=a.Transition_TransitionStinger=a.Transition_TransitionStingerCut=a.Transition_TransitionSwipe=a.Transition_TransitionCrossfade=a.Transition_TransitionFadeToColor=a.Transition_TransitionCut=a.Transition_TransitionMediaType=a.Transition=a.transition_TransitionSwipeTypeToNumber=a.transition_TransitionSwipeTypeToJSON=a.transition_TransitionSwipeTypeFromJSON=a.Transition_TransitionSwipeType=a.transition_TransitionDirectionToNumber=a.transition_TransitionDirectionToJSON=a.transition_TransitionDirectionFromJSON=a.Transition_TransitionDirection=a.eventTypeToNumber=a.eventTypeToJSON=a.eventTypeFromJSON=a.EventType=a.eventSubTypeToNumber=a.eventSubTypeToJSON=a.eventSubTypeFromJSON=a.EventSubType=a.requestAnimationModeToNumber=a.requestAnimationModeToJSON=a.requestAnimationModeFromJSON=a.RequestAnimationMode=a.layoutTypeToNumber=a.layoutTypeToJSON=a.layoutTypeFromJSON=a.LayoutType=a.protobufPackage=void 0;const p=l(umd.exports),h=c(minimal$2),v=struct$2;a.protobufPackage="apis.layout.v2";var S;(function(y){y.LAYOUT_TYPE_UNSPECIFIED="LAYOUT_TYPE_UNSPECIFIED",y.LAYOUT_TYPE_SCENELESS="LAYOUT_TYPE_SCENELESS",y.LAYOUT_TYPE_SCENE="LAYOUT_TYPE_SCENE"})(S=a.LayoutType||(a.LayoutType={}));function b(y){switch(y){case 0:case"LAYOUT_TYPE_UNSPECIFIED":return S.LAYOUT_TYPE_UNSPECIFIED;case 1:case"LAYOUT_TYPE_SCENELESS":return S.LAYOUT_TYPE_SCENELESS;case 2:case"LAYOUT_TYPE_SCENE":return S.LAYOUT_TYPE_SCENE;default:throw new tt.Error("Unrecognized enum value "+y+" for enum LayoutType")}}a.layoutTypeFromJSON=b;function _(y){switch(y){case S.LAYOUT_TYPE_UNSPECIFIED:return"LAYOUT_TYPE_UNSPECIFIED";case S.LAYOUT_TYPE_SCENELESS:return"LAYOUT_TYPE_SCENELESS";case S.LAYOUT_TYPE_SCENE:return"LAYOUT_TYPE_SCENE";default:return"UNKNOWN"}}a.layoutTypeToJSON=_;function I(y){switch(y){case S.LAYOUT_TYPE_UNSPECIFIED:return 0;case S.LAYOUT_TYPE_SCENELESS:return 1;case S.LAYOUT_TYPE_SCENE:return 2;default:return 0}}a.layoutTypeToNumber=I;var T;(function(y){y.REQUEST_ANIMATION_MODE_UNSPECIFIED="REQUEST_ANIMATION_MODE_UNSPECIFIED",y.REQUEST_ANIMATION_MODE_PARALLEL="REQUEST_ANIMATION_MODE_PARALLEL",y.REQUEST_ANIMATION_MODE_SERIES="REQUEST_ANIMATION_MODE_SERIES"})(T=a.RequestAnimationMode||(a.RequestAnimationMode={}));function k(y){switch(y){case 0:case"REQUEST_ANIMATION_MODE_UNSPECIFIED":return T.REQUEST_ANIMATION_MODE_UNSPECIFIED;case 1:case"REQUEST_ANIMATION_MODE_PARALLEL":return T.REQUEST_ANIMATION_MODE_PARALLEL;case 2:case"REQUEST_ANIMATION_MODE_SERIES":return T.REQUEST_ANIMATION_MODE_SERIES;default:throw new tt.Error("Unrecognized enum value "+y+" for enum RequestAnimationMode")}}a.requestAnimationModeFromJSON=k;function w(y){switch(y){case T.REQUEST_ANIMATION_MODE_UNSPECIFIED:return"REQUEST_ANIMATION_MODE_UNSPECIFIED";case T.REQUEST_ANIMATION_MODE_PARALLEL:return"REQUEST_ANIMATION_MODE_PARALLEL";case T.REQUEST_ANIMATION_MODE_SERIES:return"REQUEST_ANIMATION_MODE_SERIES";default:return"UNKNOWN"}}a.requestAnimationModeToJSON=w;function P(y){switch(y){case T.REQUEST_ANIMATION_MODE_UNSPECIFIED:return 0;case T.REQUEST_ANIMATION_MODE_PARALLEL:return 1;case T.REQUEST_ANIMATION_MODE_SERIES:return 2;default:return 0}}a.requestAnimationModeToNumber=P;var $;(function(y){y.EVENT_SUB_TYPE_UNSPECIFIED="EVENT_SUB_TYPE_UNSPECIFIED",y.EVENT_SUB_TYPE_CREATE="EVENT_SUB_TYPE_CREATE",y.EVENT_SUB_TYPE_UPDATE="EVENT_SUB_TYPE_UPDATE",y.EVENT_SUB_TYPE_DELETE="EVENT_SUB_TYPE_DELETE",y.EVENT_SUB_TYPE_BATCH="EVENT_SUB_TYPE_BATCH"})($=a.EventSubType||(a.EventSubType={}));function U(y){switch(y){case 0:case"EVENT_SUB_TYPE_UNSPECIFIED":return $.EVENT_SUB_TYPE_UNSPECIFIED;case 1:case"EVENT_SUB_TYPE_CREATE":return $.EVENT_SUB_TYPE_CREATE;case 2:case"EVENT_SUB_TYPE_UPDATE":return $.EVENT_SUB_TYPE_UPDATE;case 3:case"EVENT_SUB_TYPE_DELETE":return $.EVENT_SUB_TYPE_DELETE;case 4:case"EVENT_SUB_TYPE_BATCH":return $.EVENT_SUB_TYPE_BATCH;default:throw new tt.Error("Unrecognized enum value "+y+" for enum EventSubType")}}a.eventSubTypeFromJSON=U;function E(y){switch(y){case $.EVENT_SUB_TYPE_UNSPECIFIED:return"EVENT_SUB_TYPE_UNSPECIFIED";case $.EVENT_SUB_TYPE_CREATE:return"EVENT_SUB_TYPE_CREATE";case $.EVENT_SUB_TYPE_UPDATE:return"EVENT_SUB_TYPE_UPDATE";case $.EVENT_SUB_TYPE_DELETE:return"EVENT_SUB_TYPE_DELETE";case $.EVENT_SUB_TYPE_BATCH:return"EVENT_SUB_TYPE_BATCH";default:return"UNKNOWN"}}a.eventSubTypeToJSON=E;function D(y){switch(y){case $.EVENT_SUB_TYPE_UNSPECIFIED:return 0;case $.EVENT_SUB_TYPE_CREATE:return 1;case $.EVENT_SUB_TYPE_UPDATE:return 2;case $.EVENT_SUB_TYPE_DELETE:return 3;case $.EVENT_SUB_TYPE_BATCH:return 4;default:return 0}}a.eventSubTypeToNumber=D;var F;(function(y){y.EVENT_TYPE_UNSPECIFIED="EVENT_TYPE_UNSPECIFIED",y.EVENT_TYPE_LAYOUT="EVENT_TYPE_LAYOUT",y.EVENT_TYPE_LAYER="EVENT_TYPE_LAYER"})(F=a.EventType||(a.EventType={}));function J(y){switch(y){case 0:case"EVENT_TYPE_UNSPECIFIED":return F.EVENT_TYPE_UNSPECIFIED;case 1:case"EVENT_TYPE_LAYOUT":return F.EVENT_TYPE_LAYOUT;case 2:case"EVENT_TYPE_LAYER":return F.EVENT_TYPE_LAYER;default:throw new tt.Error("Unrecognized enum value "+y+" for enum EventType")}}a.eventTypeFromJSON=J;function G(y){switch(y){case F.EVENT_TYPE_UNSPECIFIED:return"EVENT_TYPE_UNSPECIFIED";case F.EVENT_TYPE_LAYOUT:return"EVENT_TYPE_LAYOUT";case F.EVENT_TYPE_LAYER:return"EVENT_TYPE_LAYER";default:return"UNKNOWN"}}a.eventTypeToJSON=G;function x(y){switch(y){case F.EVENT_TYPE_UNSPECIFIED:return 0;case F.EVENT_TYPE_LAYOUT:return 1;case F.EVENT_TYPE_LAYER:return 2;default:return 0}}a.eventTypeToNumber=x;var Y;(function(y){y.TRANSITION_DIRECTION_UNSPECIFIED="TRANSITION_DIRECTION_UNSPECIFIED",y.TRANSITION_DIRECTION_LEFT="TRANSITION_DIRECTION_LEFT",y.TRANSITION_DIRECTION_RIGHT="TRANSITION_DIRECTION_RIGHT",y.TRANSITION_DIRECTION_UP="TRANSITION_DIRECTION_UP",y.TRANSITION_DIRECTION_DOWN="TRANSITION_DIRECTION_DOWN"})(Y=a.Transition_TransitionDirection||(a.Transition_TransitionDirection={}));function N(y){switch(y){case 0:case"TRANSITION_DIRECTION_UNSPECIFIED":return Y.TRANSITION_DIRECTION_UNSPECIFIED;case 1:case"TRANSITION_DIRECTION_LEFT":return Y.TRANSITION_DIRECTION_LEFT;case 2:case"TRANSITION_DIRECTION_RIGHT":return Y.TRANSITION_DIRECTION_RIGHT;case 3:case"TRANSITION_DIRECTION_UP":return Y.TRANSITION_DIRECTION_UP;case 4:case"TRANSITION_DIRECTION_DOWN":return Y.TRANSITION_DIRECTION_DOWN;default:throw new tt.Error("Unrecognized enum value "+y+" for enum Transition_TransitionDirection")}}a.transition_TransitionDirectionFromJSON=N;function z(y){switch(y){case Y.TRANSITION_DIRECTION_UNSPECIFIED:return"TRANSITION_DIRECTION_UNSPECIFIED";case Y.TRANSITION_DIRECTION_LEFT:return"TRANSITION_DIRECTION_LEFT";case Y.TRANSITION_DIRECTION_RIGHT:return"TRANSITION_DIRECTION_RIGHT";case Y.TRANSITION_DIRECTION_UP:return"TRANSITION_DIRECTION_UP";case Y.TRANSITION_DIRECTION_DOWN:return"TRANSITION_DIRECTION_DOWN";default:return"UNKNOWN"}}a.transition_TransitionDirectionToJSON=z;function Z(y){switch(y){case Y.TRANSITION_DIRECTION_UNSPECIFIED:return 0;case Y.TRANSITION_DIRECTION_LEFT:return 1;case Y.TRANSITION_DIRECTION_RIGHT:return 2;case Y.TRANSITION_DIRECTION_UP:return 3;case Y.TRANSITION_DIRECTION_DOWN:return 4;default:return 0}}a.transition_TransitionDirectionToNumber=Z;var L;(function(y){y.TRANSITION_SWIPE_TYPE_UNSPECIFIED="TRANSITION_SWIPE_TYPE_UNSPECIFIED",y.TRANSITION_SWIPE_TYPE_COMBINED="TRANSITION_SWIPE_TYPE_COMBINED",y.TRANSITION_SWIPE_TYPE_SOURCE="TRANSITION_SWIPE_TYPE_SOURCE",y.TRANSITION_SWIPE_TYPE_DESTINATION="TRANSITION_SWIPE_TYPE_DESTINATION"})(L=a.Transition_TransitionSwipeType||(a.Transition_TransitionSwipeType={}));function V(y){switch(y){case 0:case"TRANSITION_SWIPE_TYPE_UNSPECIFIED":return L.TRANSITION_SWIPE_TYPE_UNSPECIFIED;case 1:case"TRANSITION_SWIPE_TYPE_COMBINED":return L.TRANSITION_SWIPE_TYPE_COMBINED;case 2:case"TRANSITION_SWIPE_TYPE_SOURCE":return L.TRANSITION_SWIPE_TYPE_SOURCE;case 3:case"TRANSITION_SWIPE_TYPE_DESTINATION":return L.TRANSITION_SWIPE_TYPE_DESTINATION;default:throw new tt.Error("Unrecognized enum value "+y+" for enum Transition_TransitionSwipeType")}}a.transition_TransitionSwipeTypeFromJSON=V;function H(y){switch(y){case L.TRANSITION_SWIPE_TYPE_UNSPECIFIED:return"TRANSITION_SWIPE_TYPE_UNSPECIFIED";case L.TRANSITION_SWIPE_TYPE_COMBINED:return"TRANSITION_SWIPE_TYPE_COMBINED";case L.TRANSITION_SWIPE_TYPE_SOURCE:return"TRANSITION_SWIPE_TYPE_SOURCE";case L.TRANSITION_SWIPE_TYPE_DESTINATION:return"TRANSITION_SWIPE_TYPE_DESTINATION";default:return"UNKNOWN"}}a.transition_TransitionSwipeTypeToJSON=H;function de(y){switch(y){case L.TRANSITION_SWIPE_TYPE_UNSPECIFIED:return 0;case L.TRANSITION_SWIPE_TYPE_COMBINED:return 1;case L.TRANSITION_SWIPE_TYPE_SOURCE:return 2;case L.TRANSITION_SWIPE_TYPE_DESTINATION:return 3;default:return 0}}a.transition_TransitionSwipeTypeToNumber=de;function X(){return{fromLayoutIds:[],cut:void 0,crossfade:void 0,fadeToColor:void 0,swipe:void 0,stinger:void 0}}a.Transition={encode(y,O=h.Writer.create()){for(const M of y.fromLayoutIds)O.uint32(10).string(M);return y.cut!==void 0&&a.Transition_TransitionCut.encode(y.cut,O.uint32(82).fork()).ldelim(),y.crossfade!==void 0&&a.Transition_TransitionCrossfade.encode(y.crossfade,O.uint32(90).fork()).ldelim(),y.fadeToColor!==void 0&&a.Transition_TransitionFadeToColor.encode(y.fadeToColor,O.uint32(98).fork()).ldelim(),y.swipe!==void 0&&a.Transition_TransitionSwipe.encode(y.swipe,O.uint32(106).fork()).ldelim(),y.stinger!==void 0&&a.Transition_TransitionStinger.encode(y.stinger,O.uint32(114).fork()).ldelim(),O},decode(y,O){const M=y instanceof h.Reader?y:new h.Reader(y);let ne=O===void 0?M.len:M.pos+O;const j=X();for(;M.pos<ne;){const ie=M.uint32();switch(ie>>>3){case 1:j.fromLayoutIds.push(M.string());break;case 10:j.cut=a.Transition_TransitionCut.decode(M,M.uint32());break;case 11:j.crossfade=a.Transition_TransitionCrossfade.decode(M,M.uint32());break;case 12:j.fadeToColor=a.Transition_TransitionFadeToColor.decode(M,M.uint32());break;case 13:j.swipe=a.Transition_TransitionSwipe.decode(M,M.uint32());break;case 14:j.stinger=a.Transition_TransitionStinger.decode(M,M.uint32());break;default:M.skipType(ie&7);break}}return j},fromJSON(y){return{fromLayoutIds:Array.isArray(y==null?void 0:y.fromLayoutIds)?y.fromLayoutIds.map(O=>String(O)):[],cut:ae(y.cut)?a.Transition_TransitionCut.fromJSON(y.cut):void 0,crossfade:ae(y.crossfade)?a.Transition_TransitionCrossfade.fromJSON(y.crossfade):void 0,fadeToColor:ae(y.fadeToColor)?a.Transition_TransitionFadeToColor.fromJSON(y.fadeToColor):void 0,swipe:ae(y.swipe)?a.Transition_TransitionSwipe.fromJSON(y.swipe):void 0,stinger:ae(y.stinger)?a.Transition_TransitionStinger.fromJSON(y.stinger):void 0}},toJSON(y){const O={};return y.fromLayoutIds?O.fromLayoutIds=y.fromLayoutIds.map(M=>M):O.fromLayoutIds=[],y.cut!==void 0&&(O.cut=y.cut?a.Transition_TransitionCut.toJSON(y.cut):void 0),y.crossfade!==void 0&&(O.crossfade=y.crossfade?a.Transition_TransitionCrossfade.toJSON(y.crossfade):void 0),y.fadeToColor!==void 0&&(O.fadeToColor=y.fadeToColor?a.Transition_TransitionFadeToColor.toJSON(y.fadeToColor):void 0),y.swipe!==void 0&&(O.swipe=y.swipe?a.Transition_TransitionSwipe.toJSON(y.swipe):void 0),y.stinger!==void 0&&(O.stinger=y.stinger?a.Transition_TransitionStinger.toJSON(y.stinger):void 0),O},fromPartial(y){var O;const M=X();return M.fromLayoutIds=((O=y.fromLayoutIds)===null||O===void 0?void 0:O.map(ne=>ne))||[],M.cut=y.cut!==void 0&&y.cut!==null?a.Transition_TransitionCut.fromPartial(y.cut):void 0,M.crossfade=y.crossfade!==void 0&&y.crossfade!==null?a.Transition_TransitionCrossfade.fromPartial(y.crossfade):void 0,M.fadeToColor=y.fadeToColor!==void 0&&y.fadeToColor!==null?a.Transition_TransitionFadeToColor.fromPartial(y.fadeToColor):void 0,M.swipe=y.swipe!==void 0&&y.swipe!==null?a.Transition_TransitionSwipe.fromPartial(y.swipe):void 0,M.stinger=y.stinger!==void 0&&y.stinger!==null?a.Transition_TransitionStinger.fromPartial(y.stinger):void 0,M}};function K(){return{url:"",volume:0}}a.Transition_TransitionMediaType={encode(y,O=h.Writer.create()){return y.url!==""&&O.uint32(10).string(y.url),y.volume!==0&&O.uint32(17).double(y.volume),O},decode(y,O){const M=y instanceof h.Reader?y:new h.Reader(y);let ne=O===void 0?M.len:M.pos+O;const j=K();for(;M.pos<ne;){const ie=M.uint32();switch(ie>>>3){case 1:j.url=M.string();break;case 2:j.volume=M.double();break;default:M.skipType(ie&7);break}}return j},fromJSON(y){return{url:ae(y.url)?String(y.url):"",volume:ae(y.volume)?Number(y.volume):0}},toJSON(y){const O={};return y.url!==void 0&&(O.url=y.url),y.volume!==void 0&&(O.volume=y.volume),O},fromPartial(y){var O,M;const ne=K();return ne.url=(O=y.url)!==null&&O!==void 0?O:"",ne.volume=(M=y.volume)!==null&&M!==void 0?M:0,ne}};function oe(){return{}}a.Transition_TransitionCut={encode(y,O=h.Writer.create()){return O},decode(y,O){const M=y instanceof h.Reader?y:new h.Reader(y);let ne=O===void 0?M.len:M.pos+O;const j=oe();for(;M.pos<ne;){const ie=M.uint32();switch(ie>>>3){default:M.skipType(ie&7);break}}return j},fromJSON(y){return{}},toJSON(y){return{}},fromPartial(y){return oe()}};function pe(){return{durationMs:0,backgroundColor:""}}a.Transition_TransitionFadeToColor={encode(y,O=h.Writer.create()){return y.durationMs!==0&&O.uint32(8).int32(y.durationMs),y.backgroundColor!==""&&O.uint32(18).string(y.backgroundColor),O},decode(y,O){const M=y instanceof h.Reader?y:new h.Reader(y);let ne=O===void 0?M.len:M.pos+O;const j=pe();for(;M.pos<ne;){const ie=M.uint32();switch(ie>>>3){case 1:j.durationMs=M.int32();break;case 2:j.backgroundColor=M.string();break;default:M.skipType(ie&7);break}}return j},fromJSON(y){return{durationMs:ae(y.durationMs)?Number(y.durationMs):0,backgroundColor:ae(y.backgroundColor)?String(y.backgroundColor):""}},toJSON(y){const O={};return y.durationMs!==void 0&&(O.durationMs=Math.round(y.durationMs)),y.backgroundColor!==void 0&&(O.backgroundColor=y.backgroundColor),O},fromPartial(y){var O,M;const ne=pe();return ne.durationMs=(O=y.durationMs)!==null&&O!==void 0?O:0,ne.backgroundColor=(M=y.backgroundColor)!==null&&M!==void 0?M:"",ne}};function me(){return{durationMs:0}}a.Transition_TransitionCrossfade={encode(y,O=h.Writer.create()){return y.durationMs!==0&&O.uint32(8).int32(y.durationMs),O},decode(y,O){const M=y instanceof h.Reader?y:new h.Reader(y);let ne=O===void 0?M.len:M.pos+O;const j=me();for(;M.pos<ne;){const ie=M.uint32();switch(ie>>>3){case 1:j.durationMs=M.int32();break;default:M.skipType(ie&7);break}}return j},fromJSON(y){return{durationMs:ae(y.durationMs)?Number(y.durationMs):0}},toJSON(y){const O={};return y.durationMs!==void 0&&(O.durationMs=Math.round(y.durationMs)),O},fromPartial(y){var O;const M=me();return M.durationMs=(O=y.durationMs)!==null&&O!==void 0?O:0,M}};function ve(){return{durationMs:0,direction:Y.TRANSITION_DIRECTION_UNSPECIFIED,combinedAnimation:L.TRANSITION_SWIPE_TYPE_UNSPECIFIED}}a.Transition_TransitionSwipe={encode(y,O=h.Writer.create()){return y.durationMs!==0&&O.uint32(8).int32(y.durationMs),y.direction!==Y.TRANSITION_DIRECTION_UNSPECIFIED&&O.uint32(16).int32(Z(y.direction)),y.combinedAnimation!==L.TRANSITION_SWIPE_TYPE_UNSPECIFIED&&O.uint32(24).int32(de(y.combinedAnimation)),O},decode(y,O){const M=y instanceof h.Reader?y:new h.Reader(y);let ne=O===void 0?M.len:M.pos+O;const j=ve();for(;M.pos<ne;){const ie=M.uint32();switch(ie>>>3){case 1:j.durationMs=M.int32();break;case 2:j.direction=N(M.int32());break;case 3:j.combinedAnimation=V(M.int32());break;default:M.skipType(ie&7);break}}return j},fromJSON(y){return{durationMs:ae(y.durationMs)?Number(y.durationMs):0,direction:ae(y.direction)?N(y.direction):Y.TRANSITION_DIRECTION_UNSPECIFIED,combinedAnimation:ae(y.combinedAnimation)?V(y.combinedAnimation):L.TRANSITION_SWIPE_TYPE_UNSPECIFIED}},toJSON(y){const O={};return y.durationMs!==void 0&&(O.durationMs=Math.round(y.durationMs)),y.direction!==void 0&&(O.direction=z(y.direction)),y.combinedAnimation!==void 0&&(O.combinedAnimation=H(y.combinedAnimation)),O},fromPartial(y){var O,M,ne;const j=ve();return j.durationMs=(O=y.durationMs)!==null&&O!==void 0?O:0,j.direction=(M=y.direction)!==null&&M!==void 0?M:Y.TRANSITION_DIRECTION_UNSPECIFIED,j.combinedAnimation=(ne=y.combinedAnimation)!==null&&ne!==void 0?ne:L.TRANSITION_SWIPE_TYPE_UNSPECIFIED,j}};function A(){return{cutPointMs:0,media:void 0}}a.Transition_TransitionStingerCut={encode(y,O=h.Writer.create()){return y.cutPointMs!==0&&O.uint32(8).int32(y.cutPointMs),y.media!==void 0&&a.Transition_TransitionMediaType.encode(y.media,O.uint32(18).fork()).ldelim(),O},decode(y,O){const M=y instanceof h.Reader?y:new h.Reader(y);let ne=O===void 0?M.len:M.pos+O;const j=A();for(;M.pos<ne;){const ie=M.uint32();switch(ie>>>3){case 1:j.cutPointMs=M.int32();break;case 2:j.media=a.Transition_TransitionMediaType.decode(M,M.uint32());break;default:M.skipType(ie&7);break}}return j},fromJSON(y){return{cutPointMs:ae(y.cutPointMs)?Number(y.cutPointMs):0,media:ae(y.media)?a.Transition_TransitionMediaType.fromJSON(y.media):void 0}},toJSON(y){const O={};return y.cutPointMs!==void 0&&(O.cutPointMs=Math.round(y.cutPointMs)),y.media!==void 0&&(O.media=y.media?a.Transition_TransitionMediaType.toJSON(y.media):void 0),O},fromPartial(y){var O;const M=A();return M.cutPointMs=(O=y.cutPointMs)!==null&&O!==void 0?O:0,M.media=y.media!==void 0&&y.media!==null?a.Transition_TransitionMediaType.fromPartial(y.media):void 0,M}};function W(){return{cut:void 0}}a.Transition_TransitionStinger={encode(y,O=h.Writer.create()){return y.cut!==void 0&&a.Transition_TransitionStingerCut.encode(y.cut,O.uint32(10).fork()).ldelim(),O},decode(y,O){const M=y instanceof h.Reader?y:new h.Reader(y);let ne=O===void 0?M.len:M.pos+O;const j=W();for(;M.pos<ne;){const ie=M.uint32();switch(ie>>>3){case 1:j.cut=a.Transition_TransitionStingerCut.decode(M,M.uint32());break;default:M.skipType(ie&7);break}}return j},fromJSON(y){return{cut:ae(y.cut)?a.Transition_TransitionStingerCut.fromJSON(y.cut):void 0}},toJSON(y){const O={};return y.cut!==void 0&&(O.cut=y.cut?a.Transition_TransitionStingerCut.toJSON(y.cut):void 0),O},fromPartial(y){const O=W();return O.cut=y.cut!==void 0&&y.cut!==null?a.Transition_TransitionStingerCut.fromPartial(y.cut):void 0,O}};function ee(){return{id:"",width:0,height:0,metadata:void 0,projectId:void 0,collectionId:void 0,type:void 0,transitions:[],requestMetadata:void 0}}a.Layout={encode(y,O=h.Writer.create()){y.id!==""&&O.uint32(10).string(y.id),y.width!==0&&O.uint32(16).int32(y.width),y.height!==0&&O.uint32(24).int32(y.height),y.metadata!==void 0&&v.Value.encode(v.Value.wrap(y.metadata),O.uint32(50).fork()).ldelim(),y.projectId!==void 0&&O.uint32(58).string(y.projectId),y.collectionId!==void 0&&O.uint32(66).string(y.collectionId),y.type!==void 0&&O.uint32(72).int32(I(y.type));for(const M of y.transitions)a.Transition.encode(M,O.uint32(82).fork()).ldelim();return y.requestMetadata!==void 0&&v.Value.encode(v.Value.wrap(y.requestMetadata),O.uint32(810).fork()).ldelim(),O},decode(y,O){const M=y instanceof h.Reader?y:new h.Reader(y);let ne=O===void 0?M.len:M.pos+O;const j=ee();for(;M.pos<ne;){const ie=M.uint32();switch(ie>>>3){case 1:j.id=M.string();break;case 2:j.width=M.int32();break;case 3:j.height=M.int32();break;case 6:j.metadata=v.Value.unwrap(v.Value.decode(M,M.uint32()));break;case 7:j.projectId=M.string();break;case 8:j.collectionId=M.string();break;case 9:j.type=b(M.int32());break;case 10:j.transitions.push(a.Transition.decode(M,M.uint32()));break;case 101:j.requestMetadata=v.Value.unwrap(v.Value.decode(M,M.uint32()));break;default:M.skipType(ie&7);break}}return j},fromJSON(y){return{id:ae(y.id)?String(y.id):"",width:ae(y.width)?Number(y.width):0,height:ae(y.height)?Number(y.height):0,metadata:ae(y==null?void 0:y.metadata)?y.metadata:void 0,projectId:ae(y.projectId)?String(y.projectId):void 0,collectionId:ae(y.collectionId)?String(y.collectionId):void 0,type:ae(y.type)?b(y.type):void 0,transitions:Array.isArray(y==null?void 0:y.transitions)?y.transitions.map(O=>a.Transition.fromJSON(O)):[],requestMetadata:ae(y==null?void 0:y.requestMetadata)?y.requestMetadata:void 0}},toJSON(y){const O={};return y.id!==void 0&&(O.id=y.id),y.width!==void 0&&(O.width=Math.round(y.width)),y.height!==void 0&&(O.height=Math.round(y.height)),y.metadata!==void 0&&(O.metadata=y.metadata),y.projectId!==void 0&&(O.projectId=y.projectId),y.collectionId!==void 0&&(O.collectionId=y.collectionId),y.type!==void 0&&(O.type=y.type!==void 0?_(y.type):void 0),y.transitions?O.transitions=y.transitions.map(M=>M?a.Transition.toJSON(M):void 0):O.transitions=[],y.requestMetadata!==void 0&&(O.requestMetadata=y.requestMetadata),O},fromPartial(y){var O,M,ne,j,ie,we,Be,Ve,Ne;const Ae=ee();return Ae.id=(O=y.id)!==null&&O!==void 0?O:"",Ae.width=(M=y.width)!==null&&M!==void 0?M:0,Ae.height=(ne=y.height)!==null&&ne!==void 0?ne:0,Ae.metadata=(j=y.metadata)!==null&&j!==void 0?j:void 0,Ae.projectId=(ie=y.projectId)!==null&&ie!==void 0?ie:void 0,Ae.collectionId=(we=y.collectionId)!==null&&we!==void 0?we:void 0,Ae.type=(Be=y.type)!==null&&Be!==void 0?Be:void 0,Ae.transitions=((Ve=y.transitions)===null||Ve===void 0?void 0:Ve.map(Ke=>a.Transition.fromPartial(Ke)))||[],Ae.requestMetadata=(Ne=y.requestMetadata)!==null&&Ne!==void 0?Ne:void 0,Ae}};function ce(){return{type:"",data:void 0,x:void 0,y:void 0,width:void 0,height:void 0,rotation:0,opacity:0,scale:0,hidden:!1,children:void 0,metadata:void 0,id:"",layoutId:"",requestMetadata:void 0,requestAnimation:[]}}a.Layer={encode(y,O=h.Writer.create()){y.type!==""&&O.uint32(10).string(y.type),y.data!==void 0&&v.Struct.encode(v.Struct.wrap(y.data),O.uint32(18).fork()).ldelim(),y.x!==void 0&&v.Value.encode(v.Value.wrap(y.x),O.uint32(26).fork()).ldelim(),y.y!==void 0&&v.Value.encode(v.Value.wrap(y.y),O.uint32(34).fork()).ldelim(),y.width!==void 0&&v.Value.encode(v.Value.wrap(y.width),O.uint32(42).fork()).ldelim(),y.height!==void 0&&v.Value.encode(v.Value.wrap(y.height),O.uint32(50).fork()).ldelim(),y.rotation!==0&&O.uint32(57).double(y.rotation),y.opacity!==0&&O.uint32(65).double(y.opacity),y.scale!==0&&O.uint32(73).double(y.scale),y.hidden===!0&&O.uint32(80).bool(y.hidden),y.children!==void 0&&v.ListValue.encode(v.ListValue.wrap(y.children),O.uint32(98).fork()).ldelim(),y.metadata!==void 0&&v.Value.encode(v.Value.wrap(y.metadata),O.uint32(114).fork()).ldelim(),y.id!==""&&O.uint32(802).string(y.id),y.layoutId!==""&&O.uint32(818).string(y.layoutId),y.requestMetadata!==void 0&&v.Value.encode(v.Value.wrap(y.requestMetadata),O.uint32(810).fork()).ldelim();for(const M of y.requestAnimation)a.LayerAnimation.encode(M,O.uint32(826).fork()).ldelim();return O},decode(y,O){const M=y instanceof h.Reader?y:new h.Reader(y);let ne=O===void 0?M.len:M.pos+O;const j=ce();for(;M.pos<ne;){const ie=M.uint32();switch(ie>>>3){case 1:j.type=M.string();break;case 2:j.data=v.Struct.unwrap(v.Struct.decode(M,M.uint32()));break;case 3:j.x=v.Value.unwrap(v.Value.decode(M,M.uint32()));break;case 4:j.y=v.Value.unwrap(v.Value.decode(M,M.uint32()));break;case 5:j.width=v.Value.unwrap(v.Value.decode(M,M.uint32()));break;case 6:j.height=v.Value.unwrap(v.Value.decode(M,M.uint32()));break;case 7:j.rotation=M.double();break;case 8:j.opacity=M.double();break;case 9:j.scale=M.double();break;case 10:j.hidden=M.bool();break;case 12:j.children=v.ListValue.unwrap(v.ListValue.decode(M,M.uint32()));break;case 14:j.metadata=v.Value.unwrap(v.Value.decode(M,M.uint32()));break;case 100:j.id=M.string();break;case 102:j.layoutId=M.string();break;case 101:j.requestMetadata=v.Value.unwrap(v.Value.decode(M,M.uint32()));break;case 103:j.requestAnimation.push(a.LayerAnimation.decode(M,M.uint32()));break;default:M.skipType(ie&7);break}}return j},fromJSON(y){return{type:ae(y.type)?String(y.type):"",data:at(y.data)?y.data:void 0,x:ae(y==null?void 0:y.x)?y.x:void 0,y:ae(y==null?void 0:y.y)?y.y:void 0,width:ae(y==null?void 0:y.width)?y.width:void 0,height:ae(y==null?void 0:y.height)?y.height:void 0,rotation:ae(y.rotation)?Number(y.rotation):0,opacity:ae(y.opacity)?Number(y.opacity):0,scale:ae(y.scale)?Number(y.scale):0,hidden:ae(y.hidden)?Boolean(y.hidden):!1,children:Array.isArray(y.children)?[...y.children]:void 0,metadata:ae(y==null?void 0:y.metadata)?y.metadata:void 0,id:ae(y.id)?String(y.id):"",layoutId:ae(y.layoutId)?String(y.layoutId):"",requestMetadata:ae(y==null?void 0:y.requestMetadata)?y.requestMetadata:void 0,requestAnimation:Array.isArray(y==null?void 0:y.requestAnimation)?y.requestAnimation.map(O=>a.LayerAnimation.fromJSON(O)):[]}},toJSON(y){const O={};return y.type!==void 0&&(O.type=y.type),y.data!==void 0&&(O.data=y.data),y.x!==void 0&&(O.x=y.x),y.y!==void 0&&(O.y=y.y),y.width!==void 0&&(O.width=y.width),y.height!==void 0&&(O.height=y.height),y.rotation!==void 0&&(O.rotation=y.rotation),y.opacity!==void 0&&(O.opacity=y.opacity),y.scale!==void 0&&(O.scale=y.scale),y.hidden!==void 0&&(O.hidden=y.hidden),y.children!==void 0&&(O.children=y.children),y.metadata!==void 0&&(O.metadata=y.metadata),y.id!==void 0&&(O.id=y.id),y.layoutId!==void 0&&(O.layoutId=y.layoutId),y.requestMetadata!==void 0&&(O.requestMetadata=y.requestMetadata),y.requestAnimation?O.requestAnimation=y.requestAnimation.map(M=>M?a.LayerAnimation.toJSON(M):void 0):O.requestAnimation=[],O},fromPartial(y){var O,M,ne,j,ie,we,Be,Ve,Ne,Ae,Ke,Qe,Ze,je,Xe,Le;const Ee=ce();return Ee.type=(O=y.type)!==null&&O!==void 0?O:"",Ee.data=(M=y.data)!==null&&M!==void 0?M:void 0,Ee.x=(ne=y.x)!==null&&ne!==void 0?ne:void 0,Ee.y=(j=y.y)!==null&&j!==void 0?j:void 0,Ee.width=(ie=y.width)!==null&&ie!==void 0?ie:void 0,Ee.height=(we=y.height)!==null&&we!==void 0?we:void 0,Ee.rotation=(Be=y.rotation)!==null&&Be!==void 0?Be:0,Ee.opacity=(Ve=y.opacity)!==null&&Ve!==void 0?Ve:0,Ee.scale=(Ne=y.scale)!==null&&Ne!==void 0?Ne:0,Ee.hidden=(Ae=y.hidden)!==null&&Ae!==void 0?Ae:!1,Ee.children=(Ke=y.children)!==null&&Ke!==void 0?Ke:void 0,Ee.metadata=(Qe=y.metadata)!==null&&Qe!==void 0?Qe:void 0,Ee.id=(Ze=y.id)!==null&&Ze!==void 0?Ze:"",Ee.layoutId=(je=y.layoutId)!==null&&je!==void 0?je:"",Ee.requestMetadata=(Xe=y.requestMetadata)!==null&&Xe!==void 0?Xe:void 0,Ee.requestAnimation=((Le=y.requestAnimation)===null||Le===void 0?void 0:Le.map(it=>a.LayerAnimation.fromPartial(it)))||[],Ee}};function re(){return{layoutId:"",layerId:"",payload:void 0}}a.DeleteLayerRequest={encode(y,O=h.Writer.create()){return y.layoutId!==""&&O.uint32(10).string(y.layoutId),y.layerId!==""&&O.uint32(18).string(y.layerId),y.payload!==void 0&&a.DeleteLayerPayload.encode(y.payload,O.uint32(26).fork()).ldelim(),O},decode(y,O){const M=y instanceof h.Reader?y:new h.Reader(y);let ne=O===void 0?M.len:M.pos+O;const j=re();for(;M.pos<ne;){const ie=M.uint32();switch(ie>>>3){case 1:j.layoutId=M.string();break;case 2:j.layerId=M.string();break;case 3:j.payload=a.DeleteLayerPayload.decode(M,M.uint32());break;default:M.skipType(ie&7);break}}return j},fromJSON(y){return{layoutId:ae(y.layoutId)?String(y.layoutId):"",layerId:ae(y.layerId)?String(y.layerId):"",payload:ae(y.payload)?a.DeleteLayerPayload.fromJSON(y.payload):void 0}},toJSON(y){const O={};return y.layoutId!==void 0&&(O.layoutId=y.layoutId),y.layerId!==void 0&&(O.layerId=y.layerId),y.payload!==void 0&&(O.payload=y.payload?a.DeleteLayerPayload.toJSON(y.payload):void 0),O},fromPartial(y){var O,M;const ne=re();return ne.layoutId=(O=y.layoutId)!==null&&O!==void 0?O:"",ne.layerId=(M=y.layerId)!==null&&M!==void 0?M:"",ne.payload=y.payload!==void 0&&y.payload!==null?a.DeleteLayerPayload.fromPartial(y.payload):void 0,ne}};function te(){return{id:"",layoutId:"",requestMetadata:void 0}}a.DeleteLayerResponse={encode(y,O=h.Writer.create()){return y.id!==""&&O.uint32(10).string(y.id),y.layoutId!==""&&O.uint32(18).string(y.layoutId),y.requestMetadata!==void 0&&v.Value.encode(v.Value.wrap(y.requestMetadata),O.uint32(802).fork()).ldelim(),O},decode(y,O){const M=y instanceof h.Reader?y:new h.Reader(y);let ne=O===void 0?M.len:M.pos+O;const j=te();for(;M.pos<ne;){const ie=M.uint32();switch(ie>>>3){case 1:j.id=M.string();break;case 2:j.layoutId=M.string();break;case 100:j.requestMetadata=v.Value.unwrap(v.Value.decode(M,M.uint32()));break;default:M.skipType(ie&7);break}}return j},fromJSON(y){return{id:ae(y.id)?String(y.id):"",layoutId:ae(y.layoutId)?String(y.layoutId):"",requestMetadata:ae(y==null?void 0:y.requestMetadata)?y.requestMetadata:void 0}},toJSON(y){const O={};return y.id!==void 0&&(O.id=y.id),y.layoutId!==void 0&&(O.layoutId=y.layoutId),y.requestMetadata!==void 0&&(O.requestMetadata=y.requestMetadata),O},fromPartial(y){var O,M,ne;const j=te();return j.id=(O=y.id)!==null&&O!==void 0?O:"",j.layoutId=(M=y.layoutId)!==null&&M!==void 0?M:"",j.requestMetadata=(ne=y.requestMetadata)!==null&&ne!==void 0?ne:void 0,j}};function se(){return{layers:[],layoutId:"",requestMetadata:void 0,requestAnimationMode:T.REQUEST_ANIMATION_MODE_UNSPECIFIED}}a.BatchLayerResponse={encode(y,O=h.Writer.create()){for(const M of y.layers)a.BatchLayerResponse_BatchLayerItem.encode(M,O.uint32(18).fork()).ldelim();return y.layoutId!==""&&O.uint32(26).string(y.layoutId),y.requestMetadata!==void 0&&v.Value.encode(v.Value.wrap(y.requestMetadata),O.uint32(802).fork()).ldelim(),y.requestAnimationMode!==T.REQUEST_ANIMATION_MODE_UNSPECIFIED&&O.uint32(808).int32(P(y.requestAnimationMode)),O},decode(y,O){const M=y instanceof h.Reader?y:new h.Reader(y);let ne=O===void 0?M.len:M.pos+O;const j=se();for(;M.pos<ne;){const ie=M.uint32();switch(ie>>>3){case 2:j.layers.push(a.BatchLayerResponse_BatchLayerItem.decode(M,M.uint32()));break;case 3:j.layoutId=M.string();break;case 100:j.requestMetadata=v.Value.unwrap(v.Value.decode(M,M.uint32()));break;case 101:j.requestAnimationMode=k(M.int32());break;default:M.skipType(ie&7);break}}return j},fromJSON(y){return{layers:Array.isArray(y==null?void 0:y.layers)?y.layers.map(O=>a.BatchLayerResponse_BatchLayerItem.fromJSON(O)):[],layoutId:ae(y.layoutId)?String(y.layoutId):"",requestMetadata:ae(y==null?void 0:y.requestMetadata)?y.requestMetadata:void 0,requestAnimationMode:ae(y.requestAnimationMode)?k(y.requestAnimationMode):T.REQUEST_ANIMATION_MODE_UNSPECIFIED}},toJSON(y){const O={};return y.layers?O.layers=y.layers.map(M=>M?a.BatchLayerResponse_BatchLayerItem.toJSON(M):void 0):O.layers=[],y.layoutId!==void 0&&(O.layoutId=y.layoutId),y.requestMetadata!==void 0&&(O.requestMetadata=y.requestMetadata),y.requestAnimationMode!==void 0&&(O.requestAnimationMode=w(y.requestAnimationMode)),O},fromPartial(y){var O,M,ne,j;const ie=se();return ie.layers=((O=y.layers)===null||O===void 0?void 0:O.map(we=>a.BatchLayerResponse_BatchLayerItem.fromPartial(we)))||[],ie.layoutId=(M=y.layoutId)!==null&&M!==void 0?M:"",ie.requestMetadata=(ne=y.requestMetadata)!==null&&ne!==void 0?ne:void 0,ie.requestAnimationMode=(j=y.requestAnimationMode)!==null&&j!==void 0?j:T.REQUEST_ANIMATION_MODE_UNSPECIFIED,ie}};function le(){return{create:void 0,update:void 0,delete:void 0}}a.BatchLayerResponse_BatchLayerItem={encode(y,O=h.Writer.create()){return y.create!==void 0&&a.Layer.encode(y.create,O.uint32(10).fork()).ldelim(),y.update!==void 0&&a.Layer.encode(y.update,O.uint32(18).fork()).ldelim(),y.delete!==void 0&&a.DeleteLayerResponse.encode(y.delete,O.uint32(26).fork()).ldelim(),O},decode(y,O){const M=y instanceof h.Reader?y:new h.Reader(y);let ne=O===void 0?M.len:M.pos+O;const j=le();for(;M.pos<ne;){const ie=M.uint32();switch(ie>>>3){case 1:j.create=a.Layer.decode(M,M.uint32());break;case 2:j.update=a.Layer.decode(M,M.uint32());break;case 3:j.delete=a.DeleteLayerResponse.decode(M,M.uint32());break;default:M.skipType(ie&7);break}}return j},fromJSON(y){return{create:ae(y.create)?a.Layer.fromJSON(y.create):void 0,update:ae(y.update)?a.Layer.fromJSON(y.update):void 0,delete:ae(y.delete)?a.DeleteLayerResponse.fromJSON(y.delete):void 0}},toJSON(y){const O={};return y.create!==void 0&&(O.create=y.create?a.Layer.toJSON(y.create):void 0),y.update!==void 0&&(O.update=y.update?a.Layer.toJSON(y.update):void 0),y.delete!==void 0&&(O.delete=y.delete?a.DeleteLayerResponse.toJSON(y.delete):void 0),O},fromPartial(y){const O=le();return O.create=y.create!==void 0&&y.create!==null?a.Layer.fromPartial(y.create):void 0,O.update=y.update!==void 0&&y.update!==null?a.Layer.fromPartial(y.update):void 0,O.delete=y.delete!==void 0&&y.delete!==null?a.DeleteLayerResponse.fromPartial(y.delete):void 0,O}};function ue(){return{width:void 0,height:void 0,metadata:void 0,projectId:void 0,collectionId:void 0,type:void 0,transitions:[],requestMetadata:void 0}}a.PartialLayout={encode(y,O=h.Writer.create()){y.width!==void 0&&O.uint32(16).int32(y.width),y.height!==void 0&&O.uint32(24).int32(y.height),y.metadata!==void 0&&v.Value.encode(v.Value.wrap(y.metadata),O.uint32(50).fork()).ldelim(),y.projectId!==void 0&&O.uint32(58).string(y.projectId),y.collectionId!==void 0&&O.uint32(66).string(y.collectionId),y.type!==void 0&&O.uint32(72).int32(I(y.type));for(const M of y.transitions)a.Transition.encode(M,O.uint32(82).fork()).ldelim();return y.requestMetadata!==void 0&&v.Value.encode(v.Value.wrap(y.requestMetadata),O.uint32(810).fork()).ldelim(),O},decode(y,O){const M=y instanceof h.Reader?y:new h.Reader(y);let ne=O===void 0?M.len:M.pos+O;const j=ue();for(;M.pos<ne;){const ie=M.uint32();switch(ie>>>3){case 2:j.width=M.int32();break;case 3:j.height=M.int32();break;case 6:j.metadata=v.Value.unwrap(v.Value.decode(M,M.uint32()));break;case 7:j.projectId=M.string();break;case 8:j.collectionId=M.string();break;case 9:j.type=b(M.int32());break;case 10:j.transitions.push(a.Transition.decode(M,M.uint32()));break;case 101:j.requestMetadata=v.Value.unwrap(v.Value.decode(M,M.uint32()));break;default:M.skipType(ie&7);break}}return j},fromJSON(y){return{width:ae(y.width)?Number(y.width):void 0,height:ae(y.height)?Number(y.height):void 0,metadata:ae(y==null?void 0:y.metadata)?y.metadata:void 0,projectId:ae(y.projectId)?String(y.projectId):void 0,collectionId:ae(y.collectionId)?String(y.collectionId):void 0,type:ae(y.type)?b(y.type):void 0,transitions:Array.isArray(y==null?void 0:y.transitions)?y.transitions.map(O=>a.Transition.fromJSON(O)):[],requestMetadata:ae(y==null?void 0:y.requestMetadata)?y.requestMetadata:void 0}},toJSON(y){const O={};return y.width!==void 0&&(O.width=Math.round(y.width)),y.height!==void 0&&(O.height=Math.round(y.height)),y.metadata!==void 0&&(O.metadata=y.metadata),y.projectId!==void 0&&(O.projectId=y.projectId),y.collectionId!==void 0&&(O.collectionId=y.collectionId),y.type!==void 0&&(O.type=y.type!==void 0?_(y.type):void 0),y.transitions?O.transitions=y.transitions.map(M=>M?a.Transition.toJSON(M):void 0):O.transitions=[],y.requestMetadata!==void 0&&(O.requestMetadata=y.requestMetadata),O},fromPartial(y){var O,M,ne,j,ie,we,Be,Ve;const Ne=ue();return Ne.width=(O=y.width)!==null&&O!==void 0?O:void 0,Ne.height=(M=y.height)!==null&&M!==void 0?M:void 0,Ne.metadata=(ne=y.metadata)!==null&&ne!==void 0?ne:void 0,Ne.projectId=(j=y.projectId)!==null&&j!==void 0?j:void 0,Ne.collectionId=(ie=y.collectionId)!==null&&ie!==void 0?ie:void 0,Ne.type=(we=y.type)!==null&&we!==void 0?we:void 0,Ne.transitions=((Be=y.transitions)===null||Be===void 0?void 0:Be.map(Ae=>a.Transition.fromPartial(Ae)))||[],Ne.requestMetadata=(Ve=y.requestMetadata)!==null&&Ve!==void 0?Ve:void 0,Ne}};function De(){return{projectId:void 0,collectionId:void 0,type:void 0}}a.ListLayoutsRequest={encode(y,O=h.Writer.create()){return y.projectId!==void 0&&O.uint32(10).string(y.projectId),y.collectionId!==void 0&&O.uint32(18).string(y.collectionId),y.type!==void 0&&O.uint32(24).int32(I(y.type)),O},decode(y,O){const M=y instanceof h.Reader?y:new h.Reader(y);let ne=O===void 0?M.len:M.pos+O;const j=De();for(;M.pos<ne;){const ie=M.uint32();switch(ie>>>3){case 1:j.projectId=M.string();break;case 2:j.collectionId=M.string();break;case 3:j.type=b(M.int32());break;default:M.skipType(ie&7);break}}return j},fromJSON(y){return{projectId:ae(y.projectId)?String(y.projectId):void 0,collectionId:ae(y.collectionId)?String(y.collectionId):void 0,type:ae(y.type)?b(y.type):void 0}},toJSON(y){const O={};return y.projectId!==void 0&&(O.projectId=y.projectId),y.collectionId!==void 0&&(O.collectionId=y.collectionId),y.type!==void 0&&(O.type=y.type!==void 0?_(y.type):void 0),O},fromPartial(y){var O,M,ne;const j=De();return j.projectId=(O=y.projectId)!==null&&O!==void 0?O:void 0,j.collectionId=(M=y.collectionId)!==null&&M!==void 0?M:void 0,j.type=(ne=y.type)!==null&&ne!==void 0?ne:void 0,j}};function Oe(){return{layouts:[]}}a.ListLayoutsResponse={encode(y,O=h.Writer.create()){for(const M of y.layouts)a.Layout.encode(M,O.uint32(10).fork()).ldelim();return O},decode(y,O){const M=y instanceof h.Reader?y:new h.Reader(y);let ne=O===void 0?M.len:M.pos+O;const j=Oe();for(;M.pos<ne;){const ie=M.uint32();switch(ie>>>3){case 1:j.layouts.push(a.Layout.decode(M,M.uint32()));break;default:M.skipType(ie&7);break}}return j},fromJSON(y){return{layouts:Array.isArray(y==null?void 0:y.layouts)?y.layouts.map(O=>a.Layout.fromJSON(O)):[]}},toJSON(y){const O={};return y.layouts?O.layouts=y.layouts.map(M=>M?a.Layout.toJSON(M):void 0):O.layouts=[],O},fromPartial(y){var O;const M=Oe();return M.layouts=((O=y.layouts)===null||O===void 0?void 0:O.map(ne=>a.Layout.fromPartial(ne)))||[],M}};function qe(){return{layout:void 0}}a.CreateLayoutRequest={encode(y,O=h.Writer.create()){return y.layout!==void 0&&a.PartialLayout.encode(y.layout,O.uint32(18).fork()).ldelim(),O},decode(y,O){const M=y instanceof h.Reader?y:new h.Reader(y);let ne=O===void 0?M.len:M.pos+O;const j=qe();for(;M.pos<ne;){const ie=M.uint32();switch(ie>>>3){case 2:j.layout=a.PartialLayout.decode(M,M.uint32());break;default:M.skipType(ie&7);break}}return j},fromJSON(y){return{layout:ae(y.layout)?a.PartialLayout.fromJSON(y.layout):void 0}},toJSON(y){const O={};return y.layout!==void 0&&(O.layout=y.layout?a.PartialLayout.toJSON(y.layout):void 0),O},fromPartial(y){const O=qe();return O.layout=y.layout!==void 0&&y.layout!==null?a.PartialLayout.fromPartial(y.layout):void 0,O}};function ke(){return{layoutId:""}}a.GetLayoutRequest={encode(y,O=h.Writer.create()){return y.layoutId!==""&&O.uint32(10).string(y.layoutId),O},decode(y,O){const M=y instanceof h.Reader?y:new h.Reader(y);let ne=O===void 0?M.len:M.pos+O;const j=ke();for(;M.pos<ne;){const ie=M.uint32();switch(ie>>>3){case 1:j.layoutId=M.string();break;default:M.skipType(ie&7);break}}return j},fromJSON(y){return{layoutId:ae(y.layoutId)?String(y.layoutId):""}},toJSON(y){const O={};return y.layoutId!==void 0&&(O.layoutId=y.layoutId),O},fromPartial(y){var O;const M=ke();return M.layoutId=(O=y.layoutId)!==null&&O!==void 0?O:"",M}};function $e(){return{layoutId:"",layout:void 0}}a.UpdateLayoutRequest={encode(y,O=h.Writer.create()){return y.layoutId!==""&&O.uint32(10).string(y.layoutId),y.layout!==void 0&&a.PartialLayout.encode(y.layout,O.uint32(26).fork()).ldelim(),O},decode(y,O){const M=y instanceof h.Reader?y:new h.Reader(y);let ne=O===void 0?M.len:M.pos+O;const j=$e();for(;M.pos<ne;){const ie=M.uint32();switch(ie>>>3){case 1:j.layoutId=M.string();break;case 3:j.layout=a.PartialLayout.decode(M,M.uint32());break;default:M.skipType(ie&7);break}}return j},fromJSON(y){return{layoutId:ae(y.layoutId)?String(y.layoutId):"",layout:ae(y.layout)?a.PartialLayout.fromJSON(y.layout):void 0}},toJSON(y){const O={};return y.layoutId!==void 0&&(O.layoutId=y.layoutId),y.layout!==void 0&&(O.layout=y.layout?a.PartialLayout.toJSON(y.layout):void 0),O},fromPartial(y){var O;const M=$e();return M.layoutId=(O=y.layoutId)!==null&&O!==void 0?O:"",M.layout=y.layout!==void 0&&y.layout!==null?a.PartialLayout.fromPartial(y.layout):void 0,M}};function Ge(){return{requestMetadata:void 0}}a.DeleteLayoutPayload={encode(y,O=h.Writer.create()){return y.requestMetadata!==void 0&&v.Value.encode(v.Value.wrap(y.requestMetadata),O.uint32(802).fork()).ldelim(),O},decode(y,O){const M=y instanceof h.Reader?y:new h.Reader(y);let ne=O===void 0?M.len:M.pos+O;const j=Ge();for(;M.pos<ne;){const ie=M.uint32();switch(ie>>>3){case 100:j.requestMetadata=v.Value.unwrap(v.Value.decode(M,M.uint32()));break;default:M.skipType(ie&7);break}}return j},fromJSON(y){return{requestMetadata:ae(y==null?void 0:y.requestMetadata)?y.requestMetadata:void 0}},toJSON(y){const O={};return y.requestMetadata!==void 0&&(O.requestMetadata=y.requestMetadata),O},fromPartial(y){var O;const M=Ge();return M.requestMetadata=(O=y.requestMetadata)!==null&&O!==void 0?O:void 0,M}};function He(){return{layoutId:"",payload:void 0}}a.DeleteLayoutRequest={encode(y,O=h.Writer.create()){return y.layoutId!==""&&O.uint32(10).string(y.layoutId),y.payload!==void 0&&a.DeleteLayoutPayload.encode(y.payload,O.uint32(18).fork()).ldelim(),O},decode(y,O){const M=y instanceof h.Reader?y:new h.Reader(y);let ne=O===void 0?M.len:M.pos+O;const j=He();for(;M.pos<ne;){const ie=M.uint32();switch(ie>>>3){case 1:j.layoutId=M.string();break;case 2:j.payload=a.DeleteLayoutPayload.decode(M,M.uint32());break;default:M.skipType(ie&7);break}}return j},fromJSON(y){return{layoutId:ae(y.layoutId)?String(y.layoutId):"",payload:ae(y.payload)?a.DeleteLayoutPayload.fromJSON(y.payload):void 0}},toJSON(y){const O={};return y.layoutId!==void 0&&(O.layoutId=y.layoutId),y.payload!==void 0&&(O.payload=y.payload?a.DeleteLayoutPayload.toJSON(y.payload):void 0),O},fromPartial(y){var O;const M=He();return M.layoutId=(O=y.layoutId)!==null&&O!==void 0?O:"",M.payload=y.payload!==void 0&&y.payload!==null?a.DeleteLayoutPayload.fromPartial(y.payload):void 0,M}};function ge(){return{id:"",requestMetadata:void 0}}a.DeleteLayoutResponse={encode(y,O=h.Writer.create()){return y.id!==""&&O.uint32(18).string(y.id),y.requestMetadata!==void 0&&v.Value.encode(v.Value.wrap(y.requestMetadata),O.uint32(802).fork()).ldelim(),O},decode(y,O){const M=y instanceof h.Reader?y:new h.Reader(y);let ne=O===void 0?M.len:M.pos+O;const j=ge();for(;M.pos<ne;){const ie=M.uint32();switch(ie>>>3){case 2:j.id=M.string();break;case 100:j.requestMetadata=v.Value.unwrap(v.Value.decode(M,M.uint32()));break;default:M.skipType(ie&7);break}}return j},fromJSON(y){return{id:ae(y.id)?String(y.id):"",requestMetadata:ae(y==null?void 0:y.requestMetadata)?y.requestMetadata:void 0}},toJSON(y){const O={};return y.id!==void 0&&(O.id=y.id),y.requestMetadata!==void 0&&(O.requestMetadata=y.requestMetadata),O},fromPartial(y){var O,M;const ne=ge();return ne.id=(O=y.id)!==null&&O!==void 0?O:"",ne.requestMetadata=(M=y.requestMetadata)!==null&&M!==void 0?M:void 0,ne}};function ze(){return{properties:[],durationMs:0,delayMs:void 0,easingMode:void 0}}a.LayerAnimation={encode(y,O=h.Writer.create()){for(const M of y.properties)O.uint32(10).string(M);return y.durationMs!==0&&O.uint32(16).int32(y.durationMs),y.delayMs!==void 0&&O.uint32(32).int32(y.delayMs),y.easingMode!==void 0&&O.uint32(42).string(y.easingMode),O},decode(y,O){const M=y instanceof h.Reader?y:new h.Reader(y);let ne=O===void 0?M.len:M.pos+O;const j=ze();for(;M.pos<ne;){const ie=M.uint32();switch(ie>>>3){case 1:j.properties.push(M.string());break;case 2:j.durationMs=M.int32();break;case 4:j.delayMs=M.int32();break;case 5:j.easingMode=M.string();break;default:M.skipType(ie&7);break}}return j},fromJSON(y){return{properties:Array.isArray(y==null?void 0:y.properties)?y.properties.map(O=>String(O)):[],durationMs:ae(y.durationMs)?Number(y.durationMs):0,delayMs:ae(y.delayMs)?Number(y.delayMs):void 0,easingMode:ae(y.easingMode)?String(y.easingMode):void 0}},toJSON(y){const O={};return y.properties?O.properties=y.properties.map(M=>M):O.properties=[],y.durationMs!==void 0&&(O.durationMs=Math.round(y.durationMs)),y.delayMs!==void 0&&(O.delayMs=Math.round(y.delayMs)),y.easingMode!==void 0&&(O.easingMode=y.easingMode),O},fromPartial(y){var O,M,ne,j;const ie=ze();return ie.properties=((O=y.properties)===null||O===void 0?void 0:O.map(we=>we))||[],ie.durationMs=(M=y.durationMs)!==null&&M!==void 0?M:0,ie.delayMs=(ne=y.delayMs)!==null&&ne!==void 0?ne:void 0,ie.easingMode=(j=y.easingMode)!==null&&j!==void 0?j:void 0,ie}};function ye(){return{type:void 0,data:void 0,x:void 0,y:void 0,width:void 0,height:void 0,rotation:void 0,opacity:void 0,scale:void 0,hidden:void 0,children:void 0,parentId:void 0,metadata:void 0,requestMetadata:void 0,requestAnimation:[]}}a.PartialLayer={encode(y,O=h.Writer.create()){y.type!==void 0&&O.uint32(10).string(y.type),y.data!==void 0&&v.Struct.encode(v.Struct.wrap(y.data),O.uint32(18).fork()).ldelim(),y.x!==void 0&&v.Value.encode(v.Value.wrap(y.x),O.uint32(26).fork()).ldelim(),y.y!==void 0&&v.Value.encode(v.Value.wrap(y.y),O.uint32(34).fork()).ldelim(),y.width!==void 0&&v.Value.encode(v.Value.wrap(y.width),O.uint32(42).fork()).ldelim(),y.height!==void 0&&v.Value.encode(v.Value.wrap(y.height),O.uint32(50).fork()).ldelim(),y.rotation!==void 0&&O.uint32(57).double(y.rotation),y.opacity!==void 0&&O.uint32(65).double(y.opacity),y.scale!==void 0&&O.uint32(73).double(y.scale),y.hidden!==void 0&&O.uint32(80).bool(y.hidden),y.children!==void 0&&v.ListValue.encode(v.ListValue.wrap(y.children),O.uint32(98).fork()).ldelim(),y.parentId!==void 0&&O.uint32(106).string(y.parentId),y.metadata!==void 0&&v.Value.encode(v.Value.wrap(y.metadata),O.uint32(114).fork()).ldelim(),y.requestMetadata!==void 0&&v.Value.encode(v.Value.wrap(y.requestMetadata),O.uint32(802).fork()).ldelim();for(const M of y.requestAnimation)a.LayerAnimation.encode(M,O.uint32(826).fork()).ldelim();return O},decode(y,O){const M=y instanceof h.Reader?y:new h.Reader(y);let ne=O===void 0?M.len:M.pos+O;const j=ye();for(;M.pos<ne;){const ie=M.uint32();switch(ie>>>3){case 1:j.type=M.string();break;case 2:j.data=v.Struct.unwrap(v.Struct.decode(M,M.uint32()));break;case 3:j.x=v.Value.unwrap(v.Value.decode(M,M.uint32()));break;case 4:j.y=v.Value.unwrap(v.Value.decode(M,M.uint32()));break;case 5:j.width=v.Value.unwrap(v.Value.decode(M,M.uint32()));break;case 6:j.height=v.Value.unwrap(v.Value.decode(M,M.uint32()));break;case 7:j.rotation=M.double();break;case 8:j.opacity=M.double();break;case 9:j.scale=M.double();break;case 10:j.hidden=M.bool();break;case 12:j.children=v.ListValue.unwrap(v.ListValue.decode(M,M.uint32()));break;case 13:j.parentId=M.string();break;case 14:j.metadata=v.Value.unwrap(v.Value.decode(M,M.uint32()));break;case 100:j.requestMetadata=v.Value.unwrap(v.Value.decode(M,M.uint32()));break;case 103:j.requestAnimation.push(a.LayerAnimation.decode(M,M.uint32()));break;default:M.skipType(ie&7);break}}return j},fromJSON(y){return{type:ae(y.type)?String(y.type):void 0,data:at(y.data)?y.data:void 0,x:ae(y==null?void 0:y.x)?y.x:void 0,y:ae(y==null?void 0:y.y)?y.y:void 0,width:ae(y==null?void 0:y.width)?y.width:void 0,height:ae(y==null?void 0:y.height)?y.height:void 0,rotation:ae(y.rotation)?Number(y.rotation):void 0,opacity:ae(y.opacity)?Number(y.opacity):void 0,scale:ae(y.scale)?Number(y.scale):void 0,hidden:ae(y.hidden)?Boolean(y.hidden):void 0,children:Array.isArray(y.children)?[...y.children]:void 0,parentId:ae(y.parentId)?String(y.parentId):void 0,metadata:ae(y==null?void 0:y.metadata)?y.metadata:void 0,requestMetadata:ae(y==null?void 0:y.requestMetadata)?y.requestMetadata:void 0,requestAnimation:Array.isArray(y==null?void 0:y.requestAnimation)?y.requestAnimation.map(O=>a.LayerAnimation.fromJSON(O)):[]}},toJSON(y){const O={};return y.type!==void 0&&(O.type=y.type),y.data!==void 0&&(O.data=y.data),y.x!==void 0&&(O.x=y.x),y.y!==void 0&&(O.y=y.y),y.width!==void 0&&(O.width=y.width),y.height!==void 0&&(O.height=y.height),y.rotation!==void 0&&(O.rotation=y.rotation),y.opacity!==void 0&&(O.opacity=y.opacity),y.scale!==void 0&&(O.scale=y.scale),y.hidden!==void 0&&(O.hidden=y.hidden),y.children!==void 0&&(O.children=y.children),y.parentId!==void 0&&(O.parentId=y.parentId),y.metadata!==void 0&&(O.metadata=y.metadata),y.requestMetadata!==void 0&&(O.requestMetadata=y.requestMetadata),y.requestAnimation?O.requestAnimation=y.requestAnimation.map(M=>M?a.LayerAnimation.toJSON(M):void 0):O.requestAnimation=[],O},fromPartial(y){var O,M,ne,j,ie,we,Be,Ve,Ne,Ae,Ke,Qe,Ze,je,Xe;const Le=ye();return Le.type=(O=y.type)!==null&&O!==void 0?O:void 0,Le.data=(M=y.data)!==null&&M!==void 0?M:void 0,Le.x=(ne=y.x)!==null&&ne!==void 0?ne:void 0,Le.y=(j=y.y)!==null&&j!==void 0?j:void 0,Le.width=(ie=y.width)!==null&&ie!==void 0?ie:void 0,Le.height=(we=y.height)!==null&&we!==void 0?we:void 0,Le.rotation=(Be=y.rotation)!==null&&Be!==void 0?Be:void 0,Le.opacity=(Ve=y.opacity)!==null&&Ve!==void 0?Ve:void 0,Le.scale=(Ne=y.scale)!==null&&Ne!==void 0?Ne:void 0,Le.hidden=(Ae=y.hidden)!==null&&Ae!==void 0?Ae:void 0,Le.children=(Ke=y.children)!==null&&Ke!==void 0?Ke:void 0,Le.parentId=(Qe=y.parentId)!==null&&Qe!==void 0?Qe:void 0,Le.metadata=(Ze=y.metadata)!==null&&Ze!==void 0?Ze:void 0,Le.requestMetadata=(je=y.requestMetadata)!==null&&je!==void 0?je:void 0,Le.requestAnimation=((Xe=y.requestAnimation)===null||Xe===void 0?void 0:Xe.map(Ee=>a.LayerAnimation.fromPartial(Ee)))||[],Le}};function Ye(){return{id:"",type:void 0,data:void 0,x:void 0,y:void 0,width:void 0,height:void 0,rotation:void 0,opacity:void 0,scale:void 0,hidden:void 0,children:void 0,parentId:void 0,metadata:void 0,requestMetadata:void 0,requestAnimation:[]}}a.PartialLayerWithID={encode(y,O=h.Writer.create()){y.id!==""&&O.uint32(8002).string(y.id),y.type!==void 0&&O.uint32(10).string(y.type),y.data!==void 0&&v.Struct.encode(v.Struct.wrap(y.data),O.uint32(18).fork()).ldelim(),y.x!==void 0&&v.Value.encode(v.Value.wrap(y.x),O.uint32(26).fork()).ldelim(),y.y!==void 0&&v.Value.encode(v.Value.wrap(y.y),O.uint32(34).fork()).ldelim(),y.width!==void 0&&v.Value.encode(v.Value.wrap(y.width),O.uint32(42).fork()).ldelim(),y.height!==void 0&&v.Value.encode(v.Value.wrap(y.height),O.uint32(50).fork()).ldelim(),y.rotation!==void 0&&O.uint32(57).double(y.rotation),y.opacity!==void 0&&O.uint32(65).double(y.opacity),y.scale!==void 0&&O.uint32(73).double(y.scale),y.hidden!==void 0&&O.uint32(80).bool(y.hidden),y.children!==void 0&&v.ListValue.encode(v.ListValue.wrap(y.children),O.uint32(98).fork()).ldelim(),y.parentId!==void 0&&O.uint32(106).string(y.parentId),y.metadata!==void 0&&v.Value.encode(v.Value.wrap(y.metadata),O.uint32(114).fork()).ldelim(),y.requestMetadata!==void 0&&v.Value.encode(v.Value.wrap(y.requestMetadata),O.uint32(802).fork()).ldelim();for(const M of y.requestAnimation)a.LayerAnimation.encode(M,O.uint32(826).fork()).ldelim();return O},decode(y,O){const M=y instanceof h.Reader?y:new h.Reader(y);let ne=O===void 0?M.len:M.pos+O;const j=Ye();for(;M.pos<ne;){const ie=M.uint32();switch(ie>>>3){case 1e3:j.id=M.string();break;case 1:j.type=M.string();break;case 2:j.data=v.Struct.unwrap(v.Struct.decode(M,M.uint32()));break;case 3:j.x=v.Value.unwrap(v.Value.decode(M,M.uint32()));break;case 4:j.y=v.Value.unwrap(v.Value.decode(M,M.uint32()));break;case 5:j.width=v.Value.unwrap(v.Value.decode(M,M.uint32()));break;case 6:j.height=v.Value.unwrap(v.Value.decode(M,M.uint32()));break;case 7:j.rotation=M.double();break;case 8:j.opacity=M.double();break;case 9:j.scale=M.double();break;case 10:j.hidden=M.bool();break;case 12:j.children=v.ListValue.unwrap(v.ListValue.decode(M,M.uint32()));break;case 13:j.parentId=M.string();break;case 14:j.metadata=v.Value.unwrap(v.Value.decode(M,M.uint32()));break;case 100:j.requestMetadata=v.Value.unwrap(v.Value.decode(M,M.uint32()));break;case 103:j.requestAnimation.push(a.LayerAnimation.decode(M,M.uint32()));break;default:M.skipType(ie&7);break}}return j},fromJSON(y){return{id:ae(y.id)?String(y.id):"",type:ae(y.type)?String(y.type):void 0,data:at(y.data)?y.data:void 0,x:ae(y==null?void 0:y.x)?y.x:void 0,y:ae(y==null?void 0:y.y)?y.y:void 0,width:ae(y==null?void 0:y.width)?y.width:void 0,height:ae(y==null?void 0:y.height)?y.height:void 0,rotation:ae(y.rotation)?Number(y.rotation):void 0,opacity:ae(y.opacity)?Number(y.opacity):void 0,scale:ae(y.scale)?Number(y.scale):void 0,hidden:ae(y.hidden)?Boolean(y.hidden):void 0,children:Array.isArray(y.children)?[...y.children]:void 0,parentId:ae(y.parentId)?String(y.parentId):void 0,metadata:ae(y==null?void 0:y.metadata)?y.metadata:void 0,requestMetadata:ae(y==null?void 0:y.requestMetadata)?y.requestMetadata:void 0,requestAnimation:Array.isArray(y==null?void 0:y.requestAnimation)?y.requestAnimation.map(O=>a.LayerAnimation.fromJSON(O)):[]}},toJSON(y){const O={};return y.id!==void 0&&(O.id=y.id),y.type!==void 0&&(O.type=y.type),y.data!==void 0&&(O.data=y.data),y.x!==void 0&&(O.x=y.x),y.y!==void 0&&(O.y=y.y),y.width!==void 0&&(O.width=y.width),y.height!==void 0&&(O.height=y.height),y.rotation!==void 0&&(O.rotation=y.rotation),y.opacity!==void 0&&(O.opacity=y.opacity),y.scale!==void 0&&(O.scale=y.scale),y.hidden!==void 0&&(O.hidden=y.hidden),y.children!==void 0&&(O.children=y.children),y.parentId!==void 0&&(O.parentId=y.parentId),y.metadata!==void 0&&(O.metadata=y.metadata),y.requestMetadata!==void 0&&(O.requestMetadata=y.requestMetadata),y.requestAnimation?O.requestAnimation=y.requestAnimation.map(M=>M?a.LayerAnimation.toJSON(M):void 0):O.requestAnimation=[],O},fromPartial(y){var O,M,ne,j,ie,we,Be,Ve,Ne,Ae,Ke,Qe,Ze,je,Xe,Le;const Ee=Ye();return Ee.id=(O=y.id)!==null&&O!==void 0?O:"",Ee.type=(M=y.type)!==null&&M!==void 0?M:void 0,Ee.data=(ne=y.data)!==null&&ne!==void 0?ne:void 0,Ee.x=(j=y.x)!==null&&j!==void 0?j:void 0,Ee.y=(ie=y.y)!==null&&ie!==void 0?ie:void 0,Ee.width=(we=y.width)!==null&&we!==void 0?we:void 0,Ee.height=(Be=y.height)!==null&&Be!==void 0?Be:void 0,Ee.rotation=(Ve=y.rotation)!==null&&Ve!==void 0?Ve:void 0,Ee.opacity=(Ne=y.opacity)!==null&&Ne!==void 0?Ne:void 0,Ee.scale=(Ae=y.scale)!==null&&Ae!==void 0?Ae:void 0,Ee.hidden=(Ke=y.hidden)!==null&&Ke!==void 0?Ke:void 0,Ee.children=(Qe=y.children)!==null&&Qe!==void 0?Qe:void 0,Ee.parentId=(Ze=y.parentId)!==null&&Ze!==void 0?Ze:void 0,Ee.metadata=(je=y.metadata)!==null&&je!==void 0?je:void 0,Ee.requestMetadata=(Xe=y.requestMetadata)!==null&&Xe!==void 0?Xe:void 0,Ee.requestAnimation=((Le=y.requestAnimation)===null||Le===void 0?void 0:Le.map(it=>a.LayerAnimation.fromPartial(it)))||[],Ee}};function he(){return{layoutId:""}}a.ListLayersRequest={encode(y,O=h.Writer.create()){return y.layoutId!==""&&O.uint32(10).string(y.layoutId),O},decode(y,O){const M=y instanceof h.Reader?y:new h.Reader(y);let ne=O===void 0?M.len:M.pos+O;const j=he();for(;M.pos<ne;){const ie=M.uint32();switch(ie>>>3){case 1:j.layoutId=M.string();break;default:M.skipType(ie&7);break}}return j},fromJSON(y){return{layoutId:ae(y.layoutId)?String(y.layoutId):""}},toJSON(y){const O={};return y.layoutId!==void 0&&(O.layoutId=y.layoutId),O},fromPartial(y){var O;const M=he();return M.layoutId=(O=y.layoutId)!==null&&O!==void 0?O:"",M}};function Se(){return{layers:[]}}a.ListLayersResponse={encode(y,O=h.Writer.create()){for(const M of y.layers)a.Layer.encode(M,O.uint32(10).fork()).ldelim();return O},decode(y,O){const M=y instanceof h.Reader?y:new h.Reader(y);let ne=O===void 0?M.len:M.pos+O;const j=Se();for(;M.pos<ne;){const ie=M.uint32();switch(ie>>>3){case 1:j.layers.push(a.Layer.decode(M,M.uint32()));break;default:M.skipType(ie&7);break}}return j},fromJSON(y){return{layers:Array.isArray(y==null?void 0:y.layers)?y.layers.map(O=>a.Layer.fromJSON(O)):[]}},toJSON(y){const O={};return y.layers?O.layers=y.layers.map(M=>M?a.Layer.toJSON(M):void 0):O.layers=[],O},fromPartial(y){var O;const M=Se();return M.layers=((O=y.layers)===null||O===void 0?void 0:O.map(ne=>a.Layer.fromPartial(ne)))||[],M}};function Te(){return{layoutId:"",layer:void 0}}a.CreateLayerRequest={encode(y,O=h.Writer.create()){return y.layoutId!==""&&O.uint32(10).string(y.layoutId),y.layer!==void 0&&a.PartialLayer.encode(y.layer,O.uint32(18).fork()).ldelim(),O},decode(y,O){const M=y instanceof h.Reader?y:new h.Reader(y);let ne=O===void 0?M.len:M.pos+O;const j=Te();for(;M.pos<ne;){const ie=M.uint32();switch(ie>>>3){case 1:j.layoutId=M.string();break;case 2:j.layer=a.PartialLayer.decode(M,M.uint32());break;default:M.skipType(ie&7);break}}return j},fromJSON(y){return{layoutId:ae(y.layoutId)?String(y.layoutId):"",layer:ae(y.layer)?a.PartialLayer.fromJSON(y.layer):void 0}},toJSON(y){const O={};return y.layoutId!==void 0&&(O.layoutId=y.layoutId),y.layer!==void 0&&(O.layer=y.layer?a.PartialLayer.toJSON(y.layer):void 0),O},fromPartial(y){var O;const M=Te();return M.layoutId=(O=y.layoutId)!==null&&O!==void 0?O:"",M.layer=y.layer!==void 0&&y.layer!==null?a.PartialLayer.fromPartial(y.layer):void 0,M}};function be(){return{layoutId:"",layerId:""}}a.GetLayerRequest={encode(y,O=h.Writer.create()){return y.layoutId!==""&&O.uint32(10).string(y.layoutId),y.layerId!==""&&O.uint32(18).string(y.layerId),O},decode(y,O){const M=y instanceof h.Reader?y:new h.Reader(y);let ne=O===void 0?M.len:M.pos+O;const j=be();for(;M.pos<ne;){const ie=M.uint32();switch(ie>>>3){case 1:j.layoutId=M.string();break;case 2:j.layerId=M.string();break;default:M.skipType(ie&7);break}}return j},fromJSON(y){return{layoutId:ae(y.layoutId)?String(y.layoutId):"",layerId:ae(y.layerId)?String(y.layerId):""}},toJSON(y){const O={};return y.layoutId!==void 0&&(O.layoutId=y.layoutId),y.layerId!==void 0&&(O.layerId=y.layerId),O},fromPartial(y){var O,M;const ne=be();return ne.layoutId=(O=y.layoutId)!==null&&O!==void 0?O:"",ne.layerId=(M=y.layerId)!==null&&M!==void 0?M:"",ne}};function Ie(){return{layoutId:"",layerId:"",layer:void 0}}a.UpdateLayerRequest={encode(y,O=h.Writer.create()){return y.layoutId!==""&&O.uint32(10).string(y.layoutId),y.layerId!==""&&O.uint32(18).string(y.layerId),y.layer!==void 0&&a.PartialLayer.encode(y.layer,O.uint32(26).fork()).ldelim(),O},decode(y,O){const M=y instanceof h.Reader?y:new h.Reader(y);let ne=O===void 0?M.len:M.pos+O;const j=Ie();for(;M.pos<ne;){const ie=M.uint32();switch(ie>>>3){case 1:j.layoutId=M.string();break;case 2:j.layerId=M.string();break;case 3:j.layer=a.PartialLayer.decode(M,M.uint32());break;default:M.skipType(ie&7);break}}return j},fromJSON(y){return{layoutId:ae(y.layoutId)?String(y.layoutId):"",layerId:ae(y.layerId)?String(y.layerId):"",layer:ae(y.layer)?a.PartialLayer.fromJSON(y.layer):void 0}},toJSON(y){const O={};return y.layoutId!==void 0&&(O.layoutId=y.layoutId),y.layerId!==void 0&&(O.layerId=y.layerId),y.layer!==void 0&&(O.layer=y.layer?a.PartialLayer.toJSON(y.layer):void 0),O},fromPartial(y){var O,M;const ne=Ie();return ne.layoutId=(O=y.layoutId)!==null&&O!==void 0?O:"",ne.layerId=(M=y.layerId)!==null&&M!==void 0?M:"",ne.layer=y.layer!==void 0&&y.layer!==null?a.PartialLayer.fromPartial(y.layer):void 0,ne}};function _e(){return{requestMetadata:void 0}}a.DeleteLayerPayload={encode(y,O=h.Writer.create()){return y.requestMetadata!==void 0&&v.Value.encode(v.Value.wrap(y.requestMetadata),O.uint32(802).fork()).ldelim(),O},decode(y,O){const M=y instanceof h.Reader?y:new h.Reader(y);let ne=O===void 0?M.len:M.pos+O;const j=_e();for(;M.pos<ne;){const ie=M.uint32();switch(ie>>>3){case 100:j.requestMetadata=v.Value.unwrap(v.Value.decode(M,M.uint32()));break;default:M.skipType(ie&7);break}}return j},fromJSON(y){return{requestMetadata:ae(y==null?void 0:y.requestMetadata)?y.requestMetadata:void 0}},toJSON(y){const O={};return y.requestMetadata!==void 0&&(O.requestMetadata=y.requestMetadata),O},fromPartial(y){var O;const M=_e();return M.requestMetadata=(O=y.requestMetadata)!==null&&O!==void 0?O:void 0,M}};function et(){return{id:"",requestMetadata:void 0}}a.BatchDeleteLayerRequest={encode(y,O=h.Writer.create()){return y.id!==""&&O.uint32(10).string(y.id),y.requestMetadata!==void 0&&v.Value.encode(v.Value.wrap(y.requestMetadata),O.uint32(802).fork()).ldelim(),O},decode(y,O){const M=y instanceof h.Reader?y:new h.Reader(y);let ne=O===void 0?M.len:M.pos+O;const j=et();for(;M.pos<ne;){const ie=M.uint32();switch(ie>>>3){case 1:j.id=M.string();break;case 100:j.requestMetadata=v.Value.unwrap(v.Value.decode(M,M.uint32()));break;default:M.skipType(ie&7);break}}return j},fromJSON(y){return{id:ae(y.id)?String(y.id):"",requestMetadata:ae(y==null?void 0:y.requestMetadata)?y.requestMetadata:void 0}},toJSON(y){const O={};return y.id!==void 0&&(O.id=y.id),y.requestMetadata!==void 0&&(O.requestMetadata=y.requestMetadata),O},fromPartial(y){var O,M;const ne=et();return ne.id=(O=y.id)!==null&&O!==void 0?O:"",ne.requestMetadata=(M=y.requestMetadata)!==null&&M!==void 0?M:void 0,ne}};function Re(){return{layoutId:"",layers:[],requestMetadata:void 0,requestAnimationMode:void 0}}a.BatchLayerRequest={encode(y,O=h.Writer.create()){y.layoutId!==""&&O.uint32(10).string(y.layoutId);for(const M of y.layers)a.BatchLayerRequest_BatchItem.encode(M,O.uint32(18).fork()).ldelim();return y.requestMetadata!==void 0&&v.Value.encode(v.Value.wrap(y.requestMetadata),O.uint32(802).fork()).ldelim(),y.requestAnimationMode!==void 0&&O.uint32(808).int32(P(y.requestAnimationMode)),O},decode(y,O){const M=y instanceof h.Reader?y:new h.Reader(y);let ne=O===void 0?M.len:M.pos+O;const j=Re();for(;M.pos<ne;){const ie=M.uint32();switch(ie>>>3){case 1:j.layoutId=M.string();break;case 2:j.layers.push(a.BatchLayerRequest_BatchItem.decode(M,M.uint32()));break;case 100:j.requestMetadata=v.Value.unwrap(v.Value.decode(M,M.uint32()));break;case 101:j.requestAnimationMode=k(M.int32());break;default:M.skipType(ie&7);break}}return j},fromJSON(y){return{layoutId:ae(y.layoutId)?String(y.layoutId):"",layers:Array.isArray(y==null?void 0:y.layers)?y.layers.map(O=>a.BatchLayerRequest_BatchItem.fromJSON(O)):[],requestMetadata:ae(y==null?void 0:y.requestMetadata)?y.requestMetadata:void 0,requestAnimationMode:ae(y.requestAnimationMode)?k(y.requestAnimationMode):void 0}},toJSON(y){const O={};return y.layoutId!==void 0&&(O.layoutId=y.layoutId),y.layers?O.layers=y.layers.map(M=>M?a.BatchLayerRequest_BatchItem.toJSON(M):void 0):O.layers=[],y.requestMetadata!==void 0&&(O.requestMetadata=y.requestMetadata),y.requestAnimationMode!==void 0&&(O.requestAnimationMode=y.requestAnimationMode!==void 0?w(y.requestAnimationMode):void 0),O},fromPartial(y){var O,M,ne,j;const ie=Re();return ie.layoutId=(O=y.layoutId)!==null&&O!==void 0?O:"",ie.layers=((M=y.layers)===null||M===void 0?void 0:M.map(we=>a.BatchLayerRequest_BatchItem.fromPartial(we)))||[],ie.requestMetadata=(ne=y.requestMetadata)!==null&&ne!==void 0?ne:void 0,ie.requestAnimationMode=(j=y.requestAnimationMode)!==null&&j!==void 0?j:void 0,ie}};function We(){return{create:void 0,update:void 0,delete:void 0}}a.BatchLayerRequest_BatchItem={encode(y,O=h.Writer.create()){return y.create!==void 0&&a.PartialLayer.encode(y.create,O.uint32(10).fork()).ldelim(),y.update!==void 0&&a.PartialLayerWithID.encode(y.update,O.uint32(18).fork()).ldelim(),y.delete!==void 0&&a.BatchDeleteLayerRequest.encode(y.delete,O.uint32(26).fork()).ldelim(),O},decode(y,O){const M=y instanceof h.Reader?y:new h.Reader(y);let ne=O===void 0?M.len:M.pos+O;const j=We();for(;M.pos<ne;){const ie=M.uint32();switch(ie>>>3){case 1:j.create=a.PartialLayer.decode(M,M.uint32());break;case 2:j.update=a.PartialLayerWithID.decode(M,M.uint32());break;case 3:j.delete=a.BatchDeleteLayerRequest.decode(M,M.uint32());break;default:M.skipType(ie&7);break}}return j},fromJSON(y){return{create:ae(y.create)?a.PartialLayer.fromJSON(y.create):void 0,update:ae(y.update)?a.PartialLayerWithID.fromJSON(y.update):void 0,delete:ae(y.delete)?a.BatchDeleteLayerRequest.fromJSON(y.delete):void 0}},toJSON(y){const O={};return y.create!==void 0&&(O.create=y.create?a.PartialLayer.toJSON(y.create):void 0),y.update!==void 0&&(O.update=y.update?a.PartialLayerWithID.toJSON(y.update):void 0),y.delete!==void 0&&(O.delete=y.delete?a.BatchDeleteLayerRequest.toJSON(y.delete):void 0),O},fromPartial(y){const O=We();return O.create=y.create!==void 0&&y.create!==null?a.PartialLayer.fromPartial(y.create):void 0,O.update=y.update!==void 0&&y.update!==null?a.PartialLayerWithID.fromPartial(y.update):void 0,O.delete=y.delete!==void 0&&y.delete!==null?a.BatchDeleteLayerRequest.fromPartial(y.delete):void 0,O}};function xe(){return{create:void 0,update:void 0,delete:void 0}}a.LayoutEvent={encode(y,O=h.Writer.create()){return y.create!==void 0&&a.Layout.encode(y.create,O.uint32(10).fork()).ldelim(),y.update!==void 0&&a.Layout.encode(y.update,O.uint32(18).fork()).ldelim(),y.delete!==void 0&&a.DeleteLayoutResponse.encode(y.delete,O.uint32(26).fork()).ldelim(),O},decode(y,O){const M=y instanceof h.Reader?y:new h.Reader(y);let ne=O===void 0?M.len:M.pos+O;const j=xe();for(;M.pos<ne;){const ie=M.uint32();switch(ie>>>3){case 1:j.create=a.Layout.decode(M,M.uint32());break;case 2:j.update=a.Layout.decode(M,M.uint32());break;case 3:j.delete=a.DeleteLayoutResponse.decode(M,M.uint32());break;default:M.skipType(ie&7);break}}return j},fromJSON(y){return{create:ae(y.create)?a.Layout.fromJSON(y.create):void 0,update:ae(y.update)?a.Layout.fromJSON(y.update):void 0,delete:ae(y.delete)?a.DeleteLayoutResponse.fromJSON(y.delete):void 0}},toJSON(y){const O={};return y.create!==void 0&&(O.create=y.create?a.Layout.toJSON(y.create):void 0),y.update!==void 0&&(O.update=y.update?a.Layout.toJSON(y.update):void 0),y.delete!==void 0&&(O.delete=y.delete?a.DeleteLayoutResponse.toJSON(y.delete):void 0),O},fromPartial(y){const O=xe();return O.create=y.create!==void 0&&y.create!==null?a.Layout.fromPartial(y.create):void 0,O.update=y.update!==void 0&&y.update!==null?a.Layout.fromPartial(y.update):void 0,O.delete=y.delete!==void 0&&y.delete!==null?a.DeleteLayoutResponse.fromPartial(y.delete):void 0,O}};function nt(){return{create:void 0,update:void 0,delete:void 0,batch:void 0}}a.LayerEvent={encode(y,O=h.Writer.create()){return y.create!==void 0&&a.Layer.encode(y.create,O.uint32(10).fork()).ldelim(),y.update!==void 0&&a.Layer.encode(y.update,O.uint32(18).fork()).ldelim(),y.delete!==void 0&&a.DeleteLayerResponse.encode(y.delete,O.uint32(26).fork()).ldelim(),y.batch!==void 0&&a.BatchLayerResponse.encode(y.batch,O.uint32(34).fork()).ldelim(),O},decode(y,O){const M=y instanceof h.Reader?y:new h.Reader(y);let ne=O===void 0?M.len:M.pos+O;const j=nt();for(;M.pos<ne;){const ie=M.uint32();switch(ie>>>3){case 1:j.create=a.Layer.decode(M,M.uint32());break;case 2:j.update=a.Layer.decode(M,M.uint32());break;case 3:j.delete=a.DeleteLayerResponse.decode(M,M.uint32());break;case 4:j.batch=a.BatchLayerResponse.decode(M,M.uint32());break;default:M.skipType(ie&7);break}}return j},fromJSON(y){return{create:ae(y.create)?a.Layer.fromJSON(y.create):void 0,update:ae(y.update)?a.Layer.fromJSON(y.update):void 0,delete:ae(y.delete)?a.DeleteLayerResponse.fromJSON(y.delete):void 0,batch:ae(y.batch)?a.BatchLayerResponse.fromJSON(y.batch):void 0}},toJSON(y){const O={};return y.create!==void 0&&(O.create=y.create?a.Layer.toJSON(y.create):void 0),y.update!==void 0&&(O.update=y.update?a.Layer.toJSON(y.update):void 0),y.delete!==void 0&&(O.delete=y.delete?a.DeleteLayerResponse.toJSON(y.delete):void 0),y.batch!==void 0&&(O.batch=y.batch?a.BatchLayerResponse.toJSON(y.batch):void 0),O},fromPartial(y){const O=nt();return O.create=y.create!==void 0&&y.create!==null?a.Layer.fromPartial(y.create):void 0,O.update=y.update!==void 0&&y.update!==null?a.Layer.fromPartial(y.update):void 0,O.delete=y.delete!==void 0&&y.delete!==null?a.DeleteLayerResponse.fromPartial(y.delete):void 0,O.batch=y.batch!==void 0&&y.batch!==null?a.BatchLayerResponse.fromPartial(y.batch):void 0,O}};function rt(){return{layout:void 0,layer:void 0}}a.Event={encode(y,O=h.Writer.create()){return y.layout!==void 0&&a.LayoutEvent.encode(y.layout,O.uint32(10).fork()).ldelim(),y.layer!==void 0&&a.LayerEvent.encode(y.layer,O.uint32(18).fork()).ldelim(),O},decode(y,O){const M=y instanceof h.Reader?y:new h.Reader(y);let ne=O===void 0?M.len:M.pos+O;const j=rt();for(;M.pos<ne;){const ie=M.uint32();switch(ie>>>3){case 1:j.layout=a.LayoutEvent.decode(M,M.uint32());break;case 2:j.layer=a.LayerEvent.decode(M,M.uint32());break;default:M.skipType(ie&7);break}}return j},fromJSON(y){return{layout:ae(y.layout)?a.LayoutEvent.fromJSON(y.layout):void 0,layer:ae(y.layer)?a.LayerEvent.fromJSON(y.layer):void 0}},toJSON(y){const O={};return y.layout!==void 0&&(O.layout=y.layout?a.LayoutEvent.toJSON(y.layout):void 0),y.layer!==void 0&&(O.layer=y.layer?a.LayerEvent.toJSON(y.layer):void 0),O},fromPartial(y){const O=rt();return O.layout=y.layout!==void 0&&y.layout!==null?a.LayoutEvent.fromPartial(y.layout):void 0,O.layer=y.layer!==void 0&&y.layer!==null?a.LayerEvent.fromPartial(y.layer):void 0,O}};class Me{constructor(O){this.rpc=O,this.ListLayers=this.ListLayers.bind(this),this.CreateLayer=this.CreateLayer.bind(this),this.GetLayer=this.GetLayer.bind(this),this.UpdateLayer=this.UpdateLayer.bind(this),this.DeleteLayer=this.DeleteLayer.bind(this),this.Batch=this.Batch.bind(this)}ListLayers(O){const M=a.ListLayersRequest.encode(O).finish();return this.rpc.request("apis.layout.v2.LayerService","ListLayers",M).then(j=>a.ListLayersResponse.decode(new h.Reader(j)))}CreateLayer(O){const M=a.CreateLayerRequest.encode(O).finish();return this.rpc.request("apis.layout.v2.LayerService","CreateLayer",M).then(j=>a.Layer.decode(new h.Reader(j)))}GetLayer(O){const M=a.GetLayerRequest.encode(O).finish();return this.rpc.request("apis.layout.v2.LayerService","GetLayer",M).then(j=>a.Layer.decode(new h.Reader(j)))}UpdateLayer(O){const M=a.UpdateLayerRequest.encode(O).finish();return this.rpc.request("apis.layout.v2.LayerService","UpdateLayer",M).then(j=>a.Layer.decode(new h.Reader(j)))}DeleteLayer(O){const M=a.DeleteLayerRequest.encode(O).finish();return this.rpc.request("apis.layout.v2.LayerService","DeleteLayer",M).then(j=>a.DeleteLayerResponse.decode(new h.Reader(j)))}Batch(O){const M=a.BatchLayerRequest.encode(O).finish();return this.rpc.request("apis.layout.v2.LayerService","Batch",M).then(j=>a.BatchLayerResponse.decode(new h.Reader(j)))}}a.LayerServiceClientImpl=Me,a.LayerServiceDefinition={name:"LayerService",fullName:"apis.layout.v2.LayerService",methods:{listLayers:{name:"ListLayers",requestType:a.ListLayersRequest,requestStream:!1,responseType:a.ListLayersResponse,responseStream:!1,options:{}},createLayer:{name:"CreateLayer",requestType:a.CreateLayerRequest,requestStream:!1,responseType:a.Layer,responseStream:!1,options:{}},getLayer:{name:"GetLayer",requestType:a.GetLayerRequest,requestStream:!1,responseType:a.Layer,responseStream:!1,options:{}},updateLayer:{name:"UpdateLayer",requestType:a.UpdateLayerRequest,requestStream:!1,responseType:a.Layer,responseStream:!1,options:{}},deleteLayer:{name:"DeleteLayer",requestType:a.DeleteLayerRequest,requestStream:!1,responseType:a.DeleteLayerResponse,responseStream:!1,options:{}},batch:{name:"Batch",requestType:a.BatchLayerRequest,requestStream:!1,responseType:a.BatchLayerResponse,responseStream:!1,options:{}}}};class ot{constructor(O){this.rpc=O,this.ListLayouts=this.ListLayouts.bind(this),this.CreateLayout=this.CreateLayout.bind(this),this.GetLayout=this.GetLayout.bind(this),this.UpdateLayout=this.UpdateLayout.bind(this),this.DeleteLayout=this.DeleteLayout.bind(this)}ListLayouts(O){const M=a.ListLayoutsRequest.encode(O).finish();return this.rpc.request("apis.layout.v2.LayoutService","ListLayouts",M).then(j=>a.ListLayoutsResponse.decode(new h.Reader(j)))}CreateLayout(O){const M=a.CreateLayoutRequest.encode(O).finish();return this.rpc.request("apis.layout.v2.LayoutService","CreateLayout",M).then(j=>a.Layout.decode(new h.Reader(j)))}GetLayout(O){const M=a.GetLayoutRequest.encode(O).finish();return this.rpc.request("apis.layout.v2.LayoutService","GetLayout",M).then(j=>a.Layout.decode(new h.Reader(j)))}UpdateLayout(O){const M=a.UpdateLayoutRequest.encode(O).finish();return this.rpc.request("apis.layout.v2.LayoutService","UpdateLayout",M).then(j=>a.Layout.decode(new h.Reader(j)))}DeleteLayout(O){const M=a.DeleteLayoutRequest.encode(O).finish();return this.rpc.request("apis.layout.v2.LayoutService","DeleteLayout",M).then(j=>a.DeleteLayoutResponse.decode(new h.Reader(j)))}}a.LayoutServiceClientImpl=ot,a.LayoutServiceDefinition={name:"LayoutService",fullName:"apis.layout.v2.LayoutService",methods:{listLayouts:{name:"ListLayouts",requestType:a.ListLayoutsRequest,requestStream:!1,responseType:a.ListLayoutsResponse,responseStream:!1,options:{}},createLayout:{name:"CreateLayout",requestType:a.CreateLayoutRequest,requestStream:!1,responseType:a.Layout,responseStream:!1,options:{}},getLayout:{name:"GetLayout",requestType:a.GetLayoutRequest,requestStream:!1,responseType:a.Layout,responseStream:!1,options:{}},updateLayout:{name:"UpdateLayout",requestType:a.UpdateLayoutRequest,requestStream:!1,responseType:a.Layout,responseStream:!1,options:{}},deleteLayout:{name:"DeleteLayout",requestType:a.DeleteLayoutRequest,requestStream:!1,responseType:a.DeleteLayoutResponse,responseStream:!1,options:{}}}};var tt=(()=>{if(typeof tt!="undefined")return tt;if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof commonjsGlobal$1!="undefined")return commonjsGlobal$1;throw"Unable to locate global object"})();h.util.Long!==p.default&&(h.util.Long=p.default,h.configure());function at(y){return typeof y=="object"&&y!==null}function ae(y){return y!=null}}(api$3),function(a){var s=commonjsGlobal$1&&commonjsGlobal$1.__createBinding||(Object.create?function(l,p,h,v){v===void 0&&(v=h),Object.defineProperty(l,v,{enumerable:!0,get:function(){return p[h]}})}:function(l,p,h,v){v===void 0&&(v=h),l[v]=p[h]}),d=commonjsGlobal$1&&commonjsGlobal$1.__exportStar||function(l,p){for(var h in l)h!=="default"&&!p.hasOwnProperty(h)&&s(p,l,h)};Object.defineProperty(a,"__esModule",{value:!0}),a.layoutApiEventMap=void 0;const c=api$3;d(api$3,a),a.layoutApiEventMap={[c.EventType.EVENT_TYPE_LAYOUT]:"layout",[c.EventType.EVENT_TYPE_LAYER]:"layer",[c.EventType.EVENT_TYPE_UNSPECIFIED]:"unspecified"}}(dist$2);var api$2={},browser$2=!1,__viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$3=getAugmentedNamespace(__viteBrowserExternal$1),logger={};class EnhancedMap extends Map{computeIfAbsent(s,d){if(this.has(s))return this.get(s);const c=d(s);return this.set(s,c),c}computeIfPresent(s,d){const c=this.get(s);if(c===void 0)return;const l=d(s,c);return l!==void 0?this.set(s,l):this.delete(s),l}compute(s,d){const c=this.get(s),l=d(s,c);return l?this.set(s,l):this.delete(s),l}}var InternalLogLevel;(function(a){a[a.Trace=0]="Trace",a[a.Debug=1]="Debug",a[a.Info=2]="Info",a[a.Warn=3]="Warn",a[a.Error=4]="Error"})(InternalLogLevel||(InternalLogLevel={}));function getInternalLogger(a){return provider.getLogger(a)}const INTERNAL_LOGGING_SETTINGS={setInternalLogLevel:a=>provider.changeLogLevel(a),setOutput:a=>provider.changeOutput(a),reset:()=>provider.reset()};class InternalLoggerImpl{constructor(s,d,c){this._name=s,this._level=d,this._fnOutput=c}trace(s){this.log(InternalLogLevel.Trace,s)}debug(s){this.log(InternalLogLevel.Debug,s)}error(s,d){this.log(InternalLogLevel.Error,s,d)}info(s){this.log(InternalLogLevel.Info,s)}warn(s,d){this.log(InternalLogLevel.Warn,s,d)}setLevel(s){this._level=s}setOutput(s){this._fnOutput=s}log(s,d,c){this._level>s||this._fnOutput(`${InternalLogLevel[this._level].toString()} <INTERNAL LOGGER> ${this._name} ${d()}${c?`
`+c.stack:""}`)}}class InternalProviderImpl{constructor(){this._loggers=new EnhancedMap,this._logLevel=InternalLogLevel.Error,this._fnOutput=InternalProviderImpl.logConsole}getLogger(s){return this._loggers.computeIfAbsent(s,d=>new InternalLoggerImpl(d,this._logLevel,this._fnOutput))}changeLogLevel(s){this._logLevel=s,this._loggers.forEach(d=>d.setLevel(s))}changeOutput(s){this._fnOutput=s,this._loggers.forEach(d=>d.setOutput(this._fnOutput))}reset(){this.changeLogLevel(InternalLogLevel.Error),this._fnOutput=InternalProviderImpl.logConsole,this._loggers.forEach(s=>s.setOutput(this._fnOutput))}static logConsole(s){console&&console.log&&console.log(s)}}const provider=new InternalProviderImpl;var InternalLogger=Object.freeze({__proto__:null,get InternalLogLevel(){return InternalLogLevel},getInternalLogger,INTERNAL_LOGGING_SETTINGS}),LogLevel$1;(function(a){a[a.Trace=0]="Trace",a[a.Debug=1]="Debug",a[a.Info=2]="Info",a[a.Warn=3]="Warn",a[a.Error=4]="Error",a[a.Fatal=5]="Fatal"})(LogLevel$1||(LogLevel$1={})),function(a){function s(d){switch(d.toLowerCase()){case"trace":return a.Trace;case"debug":return a.Debug;case"info":return a.Info;case"warn":return a.Warn;case"error":return a.Error;case"fatal":return a.Fatal;default:return}}a.toLogLevel=s}(LogLevel$1||(LogLevel$1={}));class CoreLoggerImpl{constructor(s){this._runtime=s}get id(){return this._runtime.id}get logLevel(){return this._runtime.level}get runtimeSettings(){return Object.assign({},this._runtime)}set runtimeSettings(s){this._runtime=s}trace(s,...d){this.logMessage(LogLevel$1.Trace,s,d)}debug(s,...d){this.logMessage(LogLevel$1.Debug,s,d)}info(s,...d){this.logMessage(LogLevel$1.Info,s,d)}warn(s,...d){this.logMessage(LogLevel$1.Warn,s,d)}error(s,...d){this.logMessage(LogLevel$1.Error,s,d)}fatal(s,...d){this.logMessage(LogLevel$1.Fatal,s,d)}logMessage(s,d,c){if(this._runtime.level>s)return;const l=Date.now(),p=typeof d=="string"?d:d(),h=CoreLoggerImpl.getErrorAndArgs(c);switch(this._runtime.channel.type){case"RawLogChannel":this._runtime.channel.write({message:p,exception:h.error,args:h.args,timeInMillis:l,level:s,logNames:this._runtime.name},this._runtime.argumentFormatter);return;case"LogChannel":this._runtime.channel.write(this.createLogMessage(p,s,h,l));break}}formatArgValue(s){try{return this._runtime.argumentFormatter(s)}catch{return`>>ARG CONVERT FAILED: '${s!==void 0?s.toString():"undefined"}'<<`}}createLogMessage(s,d,c,l){let p;const h=c.error,v=c.args;h&&(p=`${h.name}: ${h.message}`,h.stack&&(p+=`@
${h.stack}`));const S=this._runtime.dateFormatter(l);let b=LogLevel$1[d].toUpperCase();b.length<5&&(b+=" ");const _=typeof this._runtime.name=="string"?this._runtime.name:this._runtime.name.join(", "),I=typeof v!="undefined"&&v.length>0?" ["+v.map(k=>this.formatArgValue(k)).join(", ")+"]":"";return{message:S+" "+b+" ["+_+"] "+s+I,error:p}}static getErrorAndArgs(s){if(s.length===0)return{};let d,c;const l=s[0];if(l instanceof Error)return d=l,c=s.length>1?s.slice(1):void 0,{error:d,args:c};if(typeof l=="function"){const p=l();return p instanceof Error?(d=p,c=s.length>1?s.slice(1):void 0,{error:d,args:c}):s.length===1?Array.isArray(p)?{args:p.length>0?p:void 0}:{args:p}:Array.isArray(p)?{args:[...p,...s.slice(1)]}:{args:[p,...s.slice(1)]}}return{args:s}}}function padStart(a,s,d=" "){return padInternal(a,s,"start",d)}function padEnd(a,s,d=" "){return padInternal(a,s,"end",d)}function maxLengthStringValueInArray(a){return a.map(s=>s.length).reduce((s,d)=>d>s?d:s,0)}function padInternal(a,s,d,c=" "){if(s<=a.length)return a;if(c.length>1)throw new Error(`Fill char must be one char exactly, it is: ${c.length}`);const l=s-a.length;let p="";for(let h=0;h<l;h++)p+=c;return d==="start"?p+a:a+p}function formatArgument(a){return a===void 0?"undefined":JSON.stringify(a)}function formatDate(a){const s=new Date(a),d=s.getFullYear(),c=padStart((s.getMonth()+1).toString(),2,"0"),l=padStart(s.getDate().toString(),2,"0"),p=padStart(s.getHours().toString(),2,"0"),h=padStart(s.getMinutes().toString(),2,"0"),v=padStart(s.getSeconds().toString(),2,"0"),S=padStart(s.getMilliseconds().toString(),2,"0");return`${d}-${c}-${l} ${p}:${h}:${v},${S}`}class ConsoleLogChannel{constructor(){this.type="LogChannel"}write(s){console&&console.log&&console.log(s.message+(s.error?`
${s.error}`:""))}}var DefaultChannels;(function(a){function s(){return new ConsoleLogChannel}a.createConsoleChannel=s})(DefaultChannels||(DefaultChannels={}));class LogProviderImpl{constructor(s,d){this._log=getInternalLogger("core.impl.LogProviderImpl"),this._name=s,this._settings=d,this._loggers=new EnhancedMap,this._idToKeyMap=new EnhancedMap,this._globalRuntimeSettings={level:d.level,channel:d.channel},this._nextLoggerId=1,this._log.trace(()=>`Created LogProviderImpl with settings: ${JSON.stringify(this._settings)}`)}get runtimeSettings(){return Object.assign(Object.assign({},this._settings),{level:this._globalRuntimeSettings.level,channel:this._globalRuntimeSettings.channel})}getLogger(s){return this.getOrCreateLogger(s)}updateLoggerRuntime(s,d){this._log.debug(()=>`Updating logger ${s.id} runtime settings using: '${JSON.stringify(d)}'`);const c=this._idToKeyMap.get(s.id);return c===void 0?(this._log.warn(()=>`Cannot update logger with id: ${s.id}, it was not found.`),!1):(this._loggers.computeIfPresent(c,(l,p)=>(p.runtimeSettings=LogProviderImpl.mergeRuntimeSettingsIntoLogRuntime(p.runtimeSettings,d),p)),!0)}updateRuntimeSettings(s){this._log.debug(()=>`Updating global runtime settings and updating existing loggers runtime settings using: '${JSON.stringify(s)}'`),this._globalRuntimeSettings={level:s.level!==void 0?s.level:this._globalRuntimeSettings.level,channel:s.channel!==void 0?s.channel:this._globalRuntimeSettings.channel},this._loggers.forEach(d=>d.runtimeSettings=LogProviderImpl.mergeRuntimeSettingsIntoLogRuntime(d.runtimeSettings,s))}clear(){this._loggers.clear(),this._idToKeyMap.clear(),this._globalRuntimeSettings=Object.assign({},this._settings),this._nextLoggerId=1}getOrCreateLogger(s){const d=LogProviderImpl.createKey(s),c=this._loggers.computeIfAbsent(d,()=>{const l={level:this._globalRuntimeSettings.level,channel:this._globalRuntimeSettings.channel,id:this.nextLoggerId(),name:s,argumentFormatter:this._settings.argumentFormatter,dateFormatter:this._settings.dateFormatter};return new CoreLoggerImpl(l)});return this._idToKeyMap.computeIfAbsent(c.id,()=>d),c}nextLoggerId(){const s=this._name+"_"+this._nextLoggerId;return this._nextLoggerId++,s}static mergeRuntimeSettingsIntoLogRuntime(s,d){return Object.assign(Object.assign({},s),{level:d.level!==void 0?d.level:s.level,channel:d.channel!==void 0?d.channel:s.channel})}static createKey(s){return typeof s=="string"?s:s.join(",")}}function createLogProvider(a,s){return new LogProviderImpl(a,s)}var index$3=Object.freeze({__proto__:null,EnhancedMap,padStart,padEnd,maxLengthStringValueInArray});class CategoryImpl{constructor(s,d,c,l){this._children=[],this._logger=s,this._name=d,this._parent=c,this._fnGetOrCreateChildCategory=l}get name(){return this._name}get parent(){return this._parent}get path(){const s=[];let d=this;for(;d!==void 0;)s.push(d.name),d=d.parent;return s.reverse()}get children(){return[...this._children]}addChild(s){if(s.parent!==this)throw new Error(`Cannot add child '${s.name}', expected parent '${this._name} but got ${s.parent?s.parent.name:"undefined"}'`);this._children.push(s)}getChildCategory(s){const d=this._children.find(c=>c.name===s);return d!==void 0?d:this._fnGetOrCreateChildCategory(s,this)}get id(){return this._logger.id}get logLevel(){return this._logger.logLevel}get runtimeSettings(){return this._logger.runtimeSettings}get logger(){return this._logger}trace(s,...d){this._logger.trace(s,...d)}debug(s,...d){this._logger.debug(s,...d)}info(s,...d){this._logger.info(s,...d)}warn(s,...d){this._logger.warn(s,...d)}error(s,...d){this._logger.error(s,...d)}fatal(s,...d){this._logger.fatal(s,...d)}}const CATEGORY_PATH_SEPARATOR="#";class CategoryProviderImpl{constructor(s,d){this._name=s,this._initialConfig=d,this._categoryStorage=new CategoryStorage(s,d)}get name(){return this._name}get config(){return this._initialConfig}get runtimeConfig(){return this._categoryStorage.getCurrentRuntimeConfig()}getCategory(s,d){return this._categoryStorage.getOrCreateCategory(s,d)}updateRuntimeSettingsCategory(s,d){this._categoryStorage.updateRuntimeSettingsCategory(s,d)}updateRuntimeSettings(s){this._categoryStorage.updateRuntimeSettings(s)}getRegisteredCategories(){return this._categoryStorage.getRegisteredCategories()}getCategoryByPath(s){return this._categoryStorage.getCategoryByPath(s)}}class CategoryStorage{constructor(s,d){this._categoriesById=new Map,this._categoriesByPath=new Map,this._categoryProviderName=s,this._allowSameCategoryName=d.allowSameCategoryName,this._logProvider=createLogProvider(s,Object.assign({},d)),this.getOrCreateCategory=this.getOrCreateCategory.bind(this)}getOrCreateCategory(s,d){if(s.indexOf(CATEGORY_PATH_SEPARATOR)!==-1)throw new Error(`Cannot create category '${s}', name cannot contain a '${CATEGORY_PATH_SEPARATOR}'.`);const c=d!==void 0?this.getParentCategory(d):void 0;return c===void 0?this.getOrCreateRootCategory(s):this.getOrCreateChildCategory(s,c)}updateRuntimeSettingsCategory(s,d){if(!s.id.startsWith(this._categoryProviderName))throw new Error(`Category '${s.name}' with LogId '${s.id}' is from a different CategoryProvider, cannot mix categories between providers.`);const c=this._categoriesById.get(s.id);c!==void 0&&(this._logProvider.updateLoggerRuntime(c.logger,{level:d.level}),!(d.disableRecursion!==void 0&&d.disableRecursion)&&c.children.forEach(l=>this.updateRuntimeSettingsCategory(l,d)))}updateRuntimeSettings(s){this._logProvider.updateRuntimeSettings(s)}getCurrentRuntimeConfig(){return Object.assign(Object.assign({},this._logProvider.runtimeSettings),{allowSameCategoryName:this._allowSameCategoryName})}getRegisteredCategories(){return[...this._categoriesById.values()]}getCategoryByPath(s){return this._categoriesByPath.get(s)}getParentCategory(s){let d;if(CategoryStorage.isLogId(s)){if(d=this._categoriesById.get(s),d===void 0)throw new Error(`Parent category was not found by LogId '${s}'. Are you sure you passed in the correct argument?`)}else if(d=this._categoriesById.get(s.id),d===void 0)throw new Error(`Parent category '${s.name}' was not found by it's LogId '${s.id}'. Are you sure you passed in the correct parent category?`);return d}getOrCreateRootCategory(s){const d=this._categoriesByPath.get(s);if(d){if(!this._allowSameCategoryName)throw new Error(`Category '${s} already exists, config flag allowSameCategoryName=false - therefore matching version 1 behavior (hence this Error)`);return d}const c=this._logProvider.getLogger(s),l=new CategoryImpl(c,s,void 0,this.getOrCreateCategory);return this._categoriesById.set(l.id,l),this._categoriesByPath.set(s,l),l}getOrCreateChildCategory(s,d){if(!d.id.startsWith(this._categoryProviderName))throw new Error(`Parent category '${d.name}' with LogId '${d.id}' is from a different CategoryProvider, cannot mix categories between providers.`);const c=[...d.path,s].join(CATEGORY_PATH_SEPARATOR),l=this._categoriesByPath.get(c);if(l){if(!this._allowSameCategoryName)throw new Error(`Child category '${s} already exists for parent category ${d.name}, config flag allowSameCategoryName=false - therefore matching version 1 behavior (hence this Error)`);return l}const p=this._logProvider.getLogger(c);this._logProvider.updateLoggerRuntime(p,{level:d.logger.runtimeSettings.level,channel:d.logger.runtimeSettings.channel});const h=new CategoryImpl(p,s,d,this.getOrCreateCategory);return this._categoriesById.set(h.id,h),this._categoriesByPath.set(h.path.join(CATEGORY_PATH_SEPARATOR),h),d.addChild(h),h}static isLogId(s){return typeof s=="string"}}class CategoryControlProviderImpl{constructor(s,d){this._provider=s,this._messageChannel=d,this._originalLogLevels=CategoryControlProviderImpl.loadCurrentGroupLogLevels(s)}get name(){return this._provider.name}showSettings(){let s=`Available categories (CategoryProvider '${this._provider.name}'):
`;const d=this.createCategoryInfoHierarchy(),c=d.size.toString().length,l=index$3.maxLengthStringValueInArray([...d.values()].map(h=>h.category.name+" ".repeat(h.depth))),p=[...d.values()].map((h,v)=>CategoryControlProviderImpl.createSettingLineCategory(h,v,c,l));s+=p.join(`
`)+(p.length>0?`
`:""),this._messageChannel(s)}help(){const s=`You can use the following commands (CategoryProvider ${this._provider.name}):
  showSettings()
    Shows the current configuration settings.
  update(level: CategoryControlProviderLogLevel, categoryId?: number | string, noRecurse?: boolean)
    Change the log level for a category (by default recursively).
      @param level      The log level to set - must be one of 'trace', 'debug', 'info', 'warn', 'error' or 'fatal'
      @param categoryId The category id or path of a category (e.g. root#child1) to update. Use showSettings() for id and/or name.
                        When omitted, it applies the level to all categories recursively.
  reset()
    Resets the log levels of the config groups back to when this control provider was created.
  save()
    Saves the current log levels for all categories of this provider. Use restore() to load last saved state.
  restore()
    Restore stored saved state, if any. Log levels will be set according to the saved state.
  help()
    Shows this help.
`;this._messageChannel(s)}reset(){const s=new Map(this._provider.getRegisteredCategories().map(d=>[d.id,d]));this._originalLogLevels.forEach((d,c)=>{const l=s.get(c);l!==void 0&&this._provider.updateRuntimeSettingsCategory(l,{level:d,disableRecursion:!0}),s.delete(c)}),s.forEach(d=>{d.parent!==void 0&&this._provider.updateRuntimeSettingsCategory(d,{level:d.parent.logLevel,disableRecursion:!0})}),this._originalLogLevels=CategoryControlProviderImpl.loadCurrentGroupLogLevels(this._provider),this._messageChannel("Successfully reset log levels back to original state (from when this CategoryControlProvider was created).")}save(){if(!localStorage){this._messageChannel("Cannot save state, localStorage is not available.");return}const s=this._provider.getRegisteredCategories().filter(c=>c.parent===void 0).map(c=>CategoryControlProviderImpl.createCategorySaveData(c)),d={name:this._provider.name,rootCategories:s};localStorage.setItem(this.createKey(),JSON.stringify(d)),this._messageChannel(`Successfully saved state for CategoryControlProvider '${this._provider.name}'.`)}restore(s){const d=s!==void 0?s:!0;if(!localStorage){d&&this._messageChannel(`Will not attempt to restore state for CategoryControlProvider '${this._provider.name}', localStorage is not available.`);return}const c=this.createKey(),l=localStorage.getItem(c);if(l===null){d&&this._messageChannel(`Cannot restore state for CategoryControlProvider '${this._provider.name}', no data available.`);return}try{const p=JSON.parse(l);if(this._provider.name!==p.name){d&&this._messageChannel(`Cannot restore state for CategoryControlProvider '${this._provider.name}', data is not for provider - found name '${p.name}'.`);return}this.restoreBySaveData(p,d),this._messageChannel(`Successfully restored state for CategoryControlProvider '${this._provider.name}'`),this._originalLogLevels=CategoryControlProviderImpl.loadCurrentGroupLogLevels(this._provider)}catch{localStorage.removeItem(c),this._messageChannel(`Cannot restore state for CategoryControlProvider '${this._provider.name}', data is not valid. Invalid data removed from localStorage.`)}}update(s,d,c){typeof d=="undefined"?this.updateAll(s):typeof d=="number"?this.updateByIndex(s,d,c!==void 0?c:!1):this.updateByPath(s,d,c!==void 0?c:!1)}updateAll(s){const d=LogLevel$1.toLogLevel(s);this._provider.getRegisteredCategories().filter(c=>c.parent===void 0).forEach(c=>this._provider.updateRuntimeSettingsCategory(c,{level:d})),this._messageChannel(`Updated all categories to use log level '${s.toLowerCase()}'`)}updateByPath(s,d,c){const l=this._provider.getCategoryByPath(d);if(l===void 0){this._messageChannel(`Failed to find a provider by path '${d}', please make sure to separate the parts by a ${CATEGORY_PATH_SEPARATOR}.`);return}this._provider.updateRuntimeSettingsCategory(l,{level:LogLevel$1.toLogLevel(s),disableRecursion:c}),this._messageChannel(`Successfully updated category '${l.name}' with path '${d}' to log level '${s.toLowerCase()}'${c?"":" and recursively applied to children (if any)"}.`)}updateByIndex(s,d,c){if(d<0){this._messageChannel(`Cannot update category by index '${d}', it is negative.`);return}const l=this.createCategoryInfoHierarchy();if(d>=l.size){this._messageChannel(`Cannot update category by index '${d}', it is outside of the range of available categories, use showSettings() to see the indices.`);return}const p=[...l.values()][d].category;this._provider.updateRuntimeSettingsCategory(p,{level:LogLevel$1.toLogLevel(s),disableRecursion:c}),this._messageChannel(`Successfully updated category '${p.name}' by index '${d}' to log level '${s.toLowerCase()}'${c?"":" and recursively applied to children (if any)"}.`)}restoreBySaveData(s,d){const c=(l,p)=>{const h=p.length>0?p+CATEGORY_PATH_SEPARATOR+l.name:l.name,v=this._provider.getCategoryByPath(h);if(v!==void 0){const S=LogLevel$1.toLogLevel(l.level);S!==void 0?this._provider.updateRuntimeSettingsCategory(v,{level:S,disableRecursion:!0}):d&&this._messageChannel(`CategoryControlProvider '${this._provider.name}' - cannot restore log level for category path '${h}', log level is invalid.`);for(const b of l.children)c(b,h)}else d&&this._messageChannel(`CategoryControlProvider '${this._provider.name}' - failed to find a Category by path '${h}', will not restore category (and children)`)};for(const l of s.rootCategories)c(l,"")}createKey(){return`CategoryProvider-${this._provider.name}`}createCategoryInfoHierarchy(){const s=new Map;return this._provider.getRegisteredCategories().filter(c=>c.parent===void 0).forEach(c=>CategoryControlProviderImpl.addCategoryInfoHierarchy(c,0,s)),s}static createCategorySaveData(s){return{name:s.name,level:LogLevel$1[s.logLevel],children:s.children.map(d=>this.createCategorySaveData(d))}}static loadCurrentGroupLogLevels(s){return new Map(s.getRegisteredCategories().map(d=>[d.id,d.logLevel]))}static createSettingLineCategory(s,d,c,l){const h=" ".repeat(s.depth)+s.category.name;return`  [${index$3.padStart(d.toString(),c)}, ${index$3.padEnd(h,l)} (level=${index$3.padEnd(s.logLevel,5)})]`}static addCategoryInfoHierarchy(s,d,c){c.set(s.id,{category:s,logLevel:LogLevel$1[s.logLevel],depth:d}),s.children.forEach(l=>this.addCategoryInfoHierarchy(l,d+1,c))}}function categoryConfigDebug(a){return`CategoryConfig=level: ${LogLevel$1[a.level].toString()}, allowSameCategoryName=${a.allowSameCategoryName}`}class CategoryProviderService{constructor(){this._log=InternalLogger.getInternalLogger("category.impl.CategoryProviderService"),this._providers=new index$3.EnhancedMap}createLogProvider(s,d){const c=this._providers.compute(s,(l,p)=>{if(p)throw new Error(`CategoryProvider with name '${s}' already exists, cannot create another.`);const h=mergeWithDefaults(d);return this._log.debug(()=>`Creating new CategoryProvider with name '${s}', using config settings '${categoryConfigDebug(h)}'.`),new CategoryProviderImpl(s,h)});if(c)return c;throw new Error("No CategoryProvider? This is a bug.")}getCategoryControl(s){const d=s||(c=>{if(console&&console.log)console.log(c);else throw new Error("Cannot use console (it is not present), please specify a custom function to write to.")});return{help:()=>d(CategoryProviderService.help()),showSettings:()=>d(this.showSettings()),getProvider:c=>this.getCategoryControlProviderByIdOrName(c,d)}}clear(){this._providers.clear()}showSettings(){let s=`Available CategoryProviders:
`;const d=this._providers.size.toString().length,c=index$3.maxLengthStringValueInArray([...this._providers.keys()]),l=[...this._providers.entries()].map((p,h)=>{const v=p[0];return`  [${index$3.padStart(h.toString(),d)}, ${index$3.padEnd(v,c)}]`});return s+=l.join(`
`)+(l.length>0?`
`:""),s}getCategoryControlProviderByIdOrName(s,d){if(typeof s=="string"){const l=this._providers.get(s);if(l===void 0)throw new Error(`Provider with name '${s}' does not exist.`);return new CategoryControlProviderImpl(l,d)}const c=[...this._providers.values()];if(s<0||s>=c.length)throw new Error(`Provider with index '${s}' does not exist (outside of range).`);return new CategoryControlProviderImpl(c[s],d)}static help(){return`You can use the following commands:
  showSettings()
    Shows the current configuration settings.
  getProvider: (id: number | string): CategoryControlProvider
    Get access to a CategoryControlProvider to change log levels.
      @param id The id (use showSettings to see) or name of the provider
  help()
    Shows this help.
`}}const CATEGORY_PROVIDER_SERVICE=new CategoryProviderService,CATEGORY_LOG_CONTROL=a=>CATEGORY_PROVIDER_SERVICE.getCategoryControl(a);function mergeWithDefaults(a){const s={channel:DefaultChannels.createConsoleChannel(),allowSameCategoryName:!0,level:LogLevel$1.Error,dateFormatter:formatDate,argumentFormatter:formatArgument};return a?{channel:a.channel?a.channel:s.channel,allowSameCategoryName:a.allowSameCategoryName!==void 0?a.allowSameCategoryName:s.allowSameCategoryName,level:a.level?a.level:s.level,dateFormatter:a.dateFormatter?a.dateFormatter:s.dateFormatter,argumentFormatter:a.argumentFormatter?a.argumentFormatter:s.argumentFormatter}:s}var CategoryProvider;(function(a){function s(c,l){return CATEGORY_PROVIDER_SERVICE.createLogProvider(c,l)}a.createProvider=s;function d(){CATEGORY_PROVIDER_SERVICE.clear()}a.clear=d})(CategoryProvider||(CategoryProvider={}));var typescriptLoggingCategory_esm=Object.freeze(Object.defineProperty({__proto__:null,CATEGORY_LOG_CONTROL,get CategoryProvider(){return CategoryProvider}},Symbol.toStringTag,{value:"Module"})),require$$1=getAugmentedNamespace(typescriptLoggingCategory_esm);Object.defineProperty(logger,"__esModule",{value:!0}),logger.logger=void 0;const typescript_logging_1=require$$2$1,typescript_logging_category_style_1=require$$1;logger.logger=typescript_logging_category_style_1.CategoryProvider.createProvider("ApiStream",{allowSameCategoryName:!0,level:typescript_logging_1.LogLevel.Warn});var version$3="1.0.23",__createBinding$4=commonjsGlobal$1&&commonjsGlobal$1.__createBinding||(Object.create?function(a,s,d,c){c===void 0&&(c=d);var l=Object.getOwnPropertyDescriptor(s,d);(!l||("get"in l?!s.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return s[d]}}),Object.defineProperty(a,c,l)}:function(a,s,d,c){c===void 0&&(c=d),a[c]=s[d]}),__setModuleDefault$4=commonjsGlobal$1&&commonjsGlobal$1.__setModuleDefault||(Object.create?function(a,s){Object.defineProperty(a,"default",{enumerable:!0,value:s})}:function(a,s){a.default=s}),__importStar$4=commonjsGlobal$1&&commonjsGlobal$1.__importStar||function(a){if(a&&a.__esModule)return a;var s={};if(a!=null)for(var d in a)d!=="default"&&Object.prototype.hasOwnProperty.call(a,d)&&__createBinding$4(s,a,d);return __setModuleDefault$4(s,a),s},__importDefault$5=commonjsGlobal$1&&commonjsGlobal$1.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(api$2,"__esModule",{value:!0}),api$2.ApiClient=void 0;const NiceGrpc$1=__importStar$4(lib$1),abort_controller_x_1=require$$1$1,detect_node_1=__importDefault$5(browser$2),NodeTransport=__importStar$4(require$$3),logger_1=logger,clientVersion$1=version$3;class ApiClient{constructor(s,d,c,l,p,h){this.sessionId=s,this.sdkVersion=c,this.version=clientVersion$1,this.apiLogCallback=p,this.eventLogCallback=h,this.log=logger_1.logger.getCategory(l),this.channel=NiceGrpc$1.createChannel(d,detect_node_1.default?NodeTransport.NodeHttpTransport():void 0),this.clientFactory=NiceGrpc$1.createClientFactory().use(this.logMiddleware.bind(this))}async*logMiddleware(s,d){const{path:c}=s.method;try{const l=yield*s.next(s.request,d);if(this.log.debug(`-> ${c}: ok`),this.log.trace(`${JSON.stringify(s.request)} -> ${c}: ${JSON.stringify(l)}`),this.apiLogCallback){let p=c.split("/"),h=p[1].split("."),v=h[h.length-1],S=h[h.length-2],b=h[h.length-3],_=p[2];this.apiLogCallback(b,v,_,s.request,l)}return l}catch(l){throw this.log.trace(`${JSON.stringify(s.request)} -> ${c}`),l instanceof NiceGrpc$1.ClientError?this.log.warn(`-> ${c}: error: ${NiceGrpc$1.Status[l.code]}: ${l.details}`):(0,abort_controller_x_1.isAbortError)(l)?this.log.warn(`-> ${c}: cancel`):this.log.warn(`-> ${c}: error: ${l==null?void 0:l.stack}`),l}}setAccessToken(s){(this.accessToken==null||this.accessToken!=s)&&(this.log.debug("access token refreshed"),this.accessToken=s,this.setup())}makeGrpcMetadata(){let s=NiceGrpc$1.Metadata({Authorization:`Bearer ${this.accessToken}`,Version:this.version,SessionId:this.sessionId});return this.sdkVersion!=null&&s.set("SdkVersion",this.sdkVersion),s}setup(){let s={metadata:this.makeGrpcMetadata()};this._setup(s)}_setup(s){}}api$2.ApiClient=ApiClient;var decorator={};Object.defineProperty(decorator,"__esModule",{value:!0}),decorator.RequiresSdkAuthentication=void 0;function RequiresSdkAuthentication(){return function(a,s){const d=Symbol(s);Object.defineProperty(a,s,{get:function(){if(!this[d])throw new Error("Please authenticate ApiStream by calling apiStream.load( accessToken )");return this[d]},set:function(c){this[d]=c}})}}decorator.RequiresSdkAuthentication=RequiresSdkAuthentication;var __createBinding$3=commonjsGlobal$1&&commonjsGlobal$1.__createBinding||(Object.create?function(a,s,d,c){c===void 0&&(c=d);var l=Object.getOwnPropertyDescriptor(s,d);(!l||("get"in l?!s.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return s[d]}}),Object.defineProperty(a,c,l)}:function(a,s,d,c){c===void 0&&(c=d),a[c]=s[d]}),__setModuleDefault$3=commonjsGlobal$1&&commonjsGlobal$1.__setModuleDefault||(Object.create?function(a,s){Object.defineProperty(a,"default",{enumerable:!0,value:s})}:function(a,s){a.default=s}),__decorate=commonjsGlobal$1&&commonjsGlobal$1.__decorate||function(a,s,d,c){var l=arguments.length,p=l<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,d):c,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(a,s,d,c);else for(var v=a.length-1;v>=0;v--)(h=a[v])&&(p=(l<3?h(p):l>3?h(s,d,p):h(s,d))||p);return l>3&&p&&Object.defineProperty(s,d,p),p},__importStar$3=commonjsGlobal$1&&commonjsGlobal$1.__importStar||function(a){if(a&&a.__esModule)return a;var s={};if(a!=null)for(var d in a)d!=="default"&&Object.prototype.hasOwnProperty.call(a,d)&&__createBinding$3(s,a,d);return __setModuleDefault$3(s,a),s},__metadata=commonjsGlobal$1&&commonjsGlobal$1.__metadata||function(a,s){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(a,s)};Object.defineProperty(layoutapi,"__esModule",{value:!0}),layoutapi.LayoutApi=void 0,__importStar$3(lib$1);const LayoutApiModel=__importStar$3(dist$2),api_1$1=api$2,decorator_1=decorator,LOG_CATEGORY$1="LayoutApi";class LayoutApi extends api_1$1.ApiClient{constructor(s,d,c,l,p){super(s,c,l,LOG_CATEGORY$1,p),this.handlers={},this.eventApi=d,this.eventApi.on("event",{name:`${LayoutApi.LAYOUTAPI_EVENT_PREFIX}:*`,ignoreSessionEvents:!0},h=>{var v;const[,S]=h.name.split(`${LayoutApi.LAYOUTAPI_EVENT_PREFIX}:`),[b,_]=S.split(":"),I=h.payload;for(const T of(v=this.handlers[b])!==null&&v!==void 0?v:[])T(Object.values(I).find(k=>!!k),_)})}_setup(s){this.layer=this.clientFactory.create(LayoutApiModel.LayerServiceDefinition,this.channel,{"*":s}),this.layout=this.clientFactory.create(LayoutApiModel.LayoutServiceDefinition,this.channel,{"*":s})}async subscribeToLayout(s){await Promise.all([this.eventApi.subscribe(`${LayoutApi.LAYOUTAPI_EVENT_PREFIX}:${LayoutApiModel.EventType.EVENT_TYPE_LAYER}:*`,{target:{layoutId:s}}),this.eventApi.subscribe(`${LayoutApi.LAYOUTAPI_EVENT_PREFIX}:${LayoutApiModel.EventType.EVENT_TYPE_LAYOUT}:*`,{target:{layoutId:s}})])}async unsubscribeFromLayout(s){await Promise.all([this.eventApi.unsubscribe(`${LayoutApi.LAYOUTAPI_EVENT_PREFIX}:${LayoutApiModel.EventType.EVENT_TYPE_LAYER}:*`,{target:{layoutId:s}}),this.eventApi.unsubscribe(`${LayoutApi.LAYOUTAPI_EVENT_PREFIX}:${LayoutApiModel.EventType.EVENT_TYPE_LAYOUT}:*`,{target:{layoutId:s}})])}async subscribeToLayoutsInProject(s,d){await Promise.all([this.eventApi.subscribe(`${LayoutApi.LAYOUTAPI_EVENT_PREFIX}:${LayoutApiModel.EventType.EVENT_TYPE_LAYER}:*`,{target:{collectionId:s,projectId:d}}),this.eventApi.subscribe(`${LayoutApi.LAYOUTAPI_EVENT_PREFIX}:${LayoutApiModel.EventType.EVENT_TYPE_LAYOUT}:*`,{target:{collectionId:s,projectId:d}})])}async unsubscribeFromLayoutsInProject(s,d){await Promise.all([this.eventApi.unsubscribe(`${LayoutApi.LAYOUTAPI_EVENT_PREFIX}:${LayoutApiModel.EventType.EVENT_TYPE_LAYER}:*`,{target:{collectionId:s,projectId:d}}),this.eventApi.unsubscribe(`${LayoutApi.LAYOUTAPI_EVENT_PREFIX}:${LayoutApiModel.EventType.EVENT_TYPE_LAYOUT}:*`,{target:{collectionId:s,projectId:d}})])}on(s,d){var c;this.handlers[s]=(c=this.handlers[s])!==null&&c!==void 0?c:[],this.handlers[s].push(d)}off(s,d){this.handlers[s]=this.handlers[s].filter(c=>c!==d)}}LayoutApi.LAYOUTAPI_EVENT_PREFIX="apistream:layout",__decorate([(0,decorator_1.RequiresSdkAuthentication)(),__metadata("design:type",Object)],LayoutApi.prototype,"layout",void 0),__decorate([(0,decorator_1.RequiresSdkAuthentication)(),__metadata("design:type",Object)],LayoutApi.prototype,"layer",void 0),layoutapi.LayoutApi=LayoutApi;var liveapi={},api$1={},timestamp$1={},__createBinding$2=commonjsGlobal$1&&commonjsGlobal$1.__createBinding||(Object.create?function(a,s,d,c){c===void 0&&(c=d);var l=Object.getOwnPropertyDescriptor(s,d);(!l||("get"in l?!s.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return s[d]}}),Object.defineProperty(a,c,l)}:function(a,s,d,c){c===void 0&&(c=d),a[c]=s[d]}),__setModuleDefault$2=commonjsGlobal$1&&commonjsGlobal$1.__setModuleDefault||(Object.create?function(a,s){Object.defineProperty(a,"default",{enumerable:!0,value:s})}:function(a,s){a.default=s}),__importStar$2=commonjsGlobal$1&&commonjsGlobal$1.__importStar||function(a){if(a&&a.__esModule)return a;var s={};if(a!=null)for(var d in a)d!=="default"&&Object.prototype.hasOwnProperty.call(a,d)&&__createBinding$2(s,a,d);return __setModuleDefault$2(s,a),s},__importDefault$4=commonjsGlobal$1&&commonjsGlobal$1.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(timestamp$1,"__esModule",{value:!0}),timestamp$1.Timestamp=timestamp$1.protobufPackage=void 0;const long_1$1=__importDefault$4(umd.exports),_m0$2=__importStar$2(minimal$2);timestamp$1.protobufPackage="google.protobuf";function createBaseTimestamp(){return{seconds:0,nanos:0}}timestamp$1.Timestamp={encode(a,s=_m0$2.Writer.create()){return a.seconds!==0&&s.uint32(8).int64(a.seconds),a.nanos!==0&&s.uint32(16).int32(a.nanos),s},decode(a,s){const d=a instanceof _m0$2.Reader?a:new _m0$2.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseTimestamp();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.seconds=longToNumber$2(d.int64());break;case 2:l.nanos=d.int32();break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{seconds:isSet$2(a.seconds)?Number(a.seconds):0,nanos:isSet$2(a.nanos)?Number(a.nanos):0}},toJSON(a){const s={};return a.seconds!==void 0&&(s.seconds=Math.round(a.seconds)),a.nanos!==void 0&&(s.nanos=Math.round(a.nanos)),s},fromPartial(a){var s,d;const c=createBaseTimestamp();return c.seconds=(s=a.seconds)!==null&&s!==void 0?s:0,c.nanos=(d=a.nanos)!==null&&d!==void 0?d:0,c}};var globalThis$1=(()=>{if(typeof globalThis$1!="undefined")return globalThis$1;if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof commonjsGlobal$1!="undefined")return commonjsGlobal$1;throw"Unable to locate global object"})();function longToNumber$2(a){if(a.gt(Number.MAX_SAFE_INTEGER))throw new globalThis$1.Error("Value is larger than Number.MAX_SAFE_INTEGER");return a.toNumber()}_m0$2.util.Long!==long_1$1.default&&(_m0$2.util.Long=long_1$1.default,_m0$2.configure());function isSet$2(a){return a!=null}var struct$1={};(function(a){var s=commonjsGlobal$1&&commonjsGlobal$1.__createBinding||(Object.create?function(E,D,F,J){J===void 0&&(J=F);var G=Object.getOwnPropertyDescriptor(D,F);(!G||("get"in G?!D.__esModule:G.writable||G.configurable))&&(G={enumerable:!0,get:function(){return D[F]}}),Object.defineProperty(E,J,G)}:function(E,D,F,J){J===void 0&&(J=F),E[J]=D[F]}),d=commonjsGlobal$1&&commonjsGlobal$1.__setModuleDefault||(Object.create?function(E,D){Object.defineProperty(E,"default",{enumerable:!0,value:D})}:function(E,D){E.default=D}),c=commonjsGlobal$1&&commonjsGlobal$1.__importStar||function(E){if(E&&E.__esModule)return E;var D={};if(E!=null)for(var F in E)F!=="default"&&Object.prototype.hasOwnProperty.call(E,F)&&s(D,E,F);return d(D,E),D},l=commonjsGlobal$1&&commonjsGlobal$1.__importDefault||function(E){return E&&E.__esModule?E:{default:E}};Object.defineProperty(a,"__esModule",{value:!0}),a.ListValue=a.Value=a.Struct_FieldsEntry=a.Struct=a.nullValueToNumber=a.nullValueToJSON=a.nullValueFromJSON=a.NullValue=a.protobufPackage=void 0;const p=l(umd.exports),h=c(minimal$2);a.protobufPackage="google.protobuf";var v;(function(E){E.NULL_VALUE="NULL_VALUE"})(v=a.NullValue||(a.NullValue={}));function S(E){switch(E){case 0:case"NULL_VALUE":return v.NULL_VALUE;default:throw new P.Error("Unrecognized enum value "+E+" for enum NullValue")}}a.nullValueFromJSON=S;function b(E){switch(E){case v.NULL_VALUE:return"NULL_VALUE";default:return"UNKNOWN"}}a.nullValueToJSON=b;function _(E){switch(E){case v.NULL_VALUE:return 0;default:return 0}}a.nullValueToNumber=_;function I(){return{fields:{}}}a.Struct={encode(E,D=h.Writer.create()){return Object.entries(E.fields).forEach(([F,J])=>{J!==void 0&&a.Struct_FieldsEntry.encode({key:F,value:J},D.uint32(10).fork()).ldelim()}),D},decode(E,D){const F=E instanceof h.Reader?E:new h.Reader(E);let J=D===void 0?F.len:F.pos+D;const G=I();for(;F.pos<J;){const x=F.uint32();switch(x>>>3){case 1:const Y=a.Struct_FieldsEntry.decode(F,F.uint32());Y.value!==void 0&&(G.fields[Y.key]=Y.value);break;default:F.skipType(x&7);break}}return G},fromJSON(E){return{fields:$(E.fields)?Object.entries(E.fields).reduce((D,[F,J])=>(D[F]=J,D),{}):{}}},toJSON(E){const D={};return D.fields={},E.fields&&Object.entries(E.fields).forEach(([F,J])=>{D.fields[F]=J}),D},fromPartial(E){var D;const F=I();return F.fields=Object.entries((D=E.fields)!==null&&D!==void 0?D:{}).reduce((J,[G,x])=>(x!==void 0&&(J[G]=x),J),{}),F},wrap(E){const D=I();return E!==void 0&&Object.keys(E).forEach(F=>{D.fields[F]=E[F]}),D},unwrap(E){const D={};return Object.keys(E.fields).forEach(F=>{D[F]=E.fields[F]}),D}};function T(){return{key:"",value:void 0}}a.Struct_FieldsEntry={encode(E,D=h.Writer.create()){return E.key!==""&&D.uint32(10).string(E.key),E.value!==void 0&&a.Value.encode(a.Value.wrap(E.value),D.uint32(18).fork()).ldelim(),D},decode(E,D){const F=E instanceof h.Reader?E:new h.Reader(E);let J=D===void 0?F.len:F.pos+D;const G=T();for(;F.pos<J;){const x=F.uint32();switch(x>>>3){case 1:G.key=F.string();break;case 2:G.value=a.Value.unwrap(a.Value.decode(F,F.uint32()));break;default:F.skipType(x&7);break}}return G},fromJSON(E){return{key:U(E.key)?String(E.key):"",value:U(E==null?void 0:E.value)?E.value:void 0}},toJSON(E){const D={};return E.key!==void 0&&(D.key=E.key),E.value!==void 0&&(D.value=E.value),D},fromPartial(E){var D,F;const J=T();return J.key=(D=E.key)!==null&&D!==void 0?D:"",J.value=(F=E.value)!==null&&F!==void 0?F:void 0,J}};function k(){return{nullValue:void 0,numberValue:void 0,stringValue:void 0,boolValue:void 0,structValue:void 0,listValue:void 0}}a.Value={encode(E,D=h.Writer.create()){return E.nullValue!==void 0&&D.uint32(8).int32(_(E.nullValue)),E.numberValue!==void 0&&D.uint32(17).double(E.numberValue),E.stringValue!==void 0&&D.uint32(26).string(E.stringValue),E.boolValue!==void 0&&D.uint32(32).bool(E.boolValue),E.structValue!==void 0&&a.Struct.encode(a.Struct.wrap(E.structValue),D.uint32(42).fork()).ldelim(),E.listValue!==void 0&&a.ListValue.encode(a.ListValue.wrap(E.listValue),D.uint32(50).fork()).ldelim(),D},decode(E,D){const F=E instanceof h.Reader?E:new h.Reader(E);let J=D===void 0?F.len:F.pos+D;const G=k();for(;F.pos<J;){const x=F.uint32();switch(x>>>3){case 1:G.nullValue=S(F.int32());break;case 2:G.numberValue=F.double();break;case 3:G.stringValue=F.string();break;case 4:G.boolValue=F.bool();break;case 5:G.structValue=a.Struct.unwrap(a.Struct.decode(F,F.uint32()));break;case 6:G.listValue=a.ListValue.unwrap(a.ListValue.decode(F,F.uint32()));break;default:F.skipType(x&7);break}}return G},fromJSON(E){return{nullValue:U(E.nullValue)?S(E.nullValue):void 0,numberValue:U(E.numberValue)?Number(E.numberValue):void 0,stringValue:U(E.stringValue)?String(E.stringValue):void 0,boolValue:U(E.boolValue)?Boolean(E.boolValue):void 0,structValue:$(E.structValue)?E.structValue:void 0,listValue:Array.isArray(E.listValue)?[...E.listValue]:void 0}},toJSON(E){const D={};return E.nullValue!==void 0&&(D.nullValue=E.nullValue!==void 0?b(E.nullValue):void 0),E.numberValue!==void 0&&(D.numberValue=E.numberValue),E.stringValue!==void 0&&(D.stringValue=E.stringValue),E.boolValue!==void 0&&(D.boolValue=E.boolValue),E.structValue!==void 0&&(D.structValue=E.structValue),E.listValue!==void 0&&(D.listValue=E.listValue),D},fromPartial(E){var D,F,J,G,x,Y;const N=k();return N.nullValue=(D=E.nullValue)!==null&&D!==void 0?D:void 0,N.numberValue=(F=E.numberValue)!==null&&F!==void 0?F:void 0,N.stringValue=(J=E.stringValue)!==null&&J!==void 0?J:void 0,N.boolValue=(G=E.boolValue)!==null&&G!==void 0?G:void 0,N.structValue=(x=E.structValue)!==null&&x!==void 0?x:void 0,N.listValue=(Y=E.listValue)!==null&&Y!==void 0?Y:void 0,N},wrap(E){const D=k();if(E===null)D.nullValue=v.NULL_VALUE;else if(typeof E=="boolean")D.boolValue=E;else if(typeof E=="number")D.numberValue=E;else if(typeof E=="string")D.stringValue=E;else if(Array.isArray(E))D.listValue=E;else if(typeof E=="object")D.structValue=E;else if(typeof E!="undefined")throw new Error("Unsupported any value type: "+typeof E);return D},unwrap(E){if((E==null?void 0:E.stringValue)!==void 0)return E.stringValue;if((E==null?void 0:E.numberValue)!==void 0)return E.numberValue;if((E==null?void 0:E.boolValue)!==void 0)return E.boolValue;if((E==null?void 0:E.structValue)!==void 0)return E.structValue;if((E==null?void 0:E.listValue)!==void 0)return E.listValue;if((E==null?void 0:E.nullValue)!==void 0)return null}};function w(){return{values:[]}}a.ListValue={encode(E,D=h.Writer.create()){for(const F of E.values)a.Value.encode(a.Value.wrap(F),D.uint32(10).fork()).ldelim();return D},decode(E,D){const F=E instanceof h.Reader?E:new h.Reader(E);let J=D===void 0?F.len:F.pos+D;const G=w();for(;F.pos<J;){const x=F.uint32();switch(x>>>3){case 1:G.values.push(a.Value.unwrap(a.Value.decode(F,F.uint32())));break;default:F.skipType(x&7);break}}return G},fromJSON(E){return{values:Array.isArray(E==null?void 0:E.values)?[...E.values]:[]}},toJSON(E){const D={};return E.values?D.values=E.values.map(F=>F):D.values=[],D},fromPartial(E){var D;const F=w();return F.values=((D=E.values)===null||D===void 0?void 0:D.map(J=>J))||[],F},wrap(E){const D=w();return D.values=E!=null?E:[],D},unwrap(E){return E.values}};var P=(()=>{if(typeof P!="undefined")return P;if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof commonjsGlobal$1!="undefined")return commonjsGlobal$1;throw"Unable to locate global object"})();h.util.Long!==p.default&&(h.util.Long=p.default,h.configure());function $(E){return typeof E=="object"&&E!==null}function U(E){return E!=null}})(struct$1);var field_mask={},__createBinding$1=commonjsGlobal$1&&commonjsGlobal$1.__createBinding||(Object.create?function(a,s,d,c){c===void 0&&(c=d);var l=Object.getOwnPropertyDescriptor(s,d);(!l||("get"in l?!s.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return s[d]}}),Object.defineProperty(a,c,l)}:function(a,s,d,c){c===void 0&&(c=d),a[c]=s[d]}),__setModuleDefault$1=commonjsGlobal$1&&commonjsGlobal$1.__setModuleDefault||(Object.create?function(a,s){Object.defineProperty(a,"default",{enumerable:!0,value:s})}:function(a,s){a.default=s}),__importStar$1=commonjsGlobal$1&&commonjsGlobal$1.__importStar||function(a){if(a&&a.__esModule)return a;var s={};if(a!=null)for(var d in a)d!=="default"&&Object.prototype.hasOwnProperty.call(a,d)&&__createBinding$1(s,a,d);return __setModuleDefault$1(s,a),s},__importDefault$3=commonjsGlobal$1&&commonjsGlobal$1.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(field_mask,"__esModule",{value:!0}),field_mask.FieldMask=field_mask.protobufPackage=void 0;const long_1=__importDefault$3(umd.exports),_m0$1=__importStar$1(minimal$2);field_mask.protobufPackage="google.protobuf";function createBaseFieldMask(){return{paths:[]}}field_mask.FieldMask={encode(a,s=_m0$1.Writer.create()){for(const d of a.paths)s.uint32(10).string(d);return s},decode(a,s){const d=a instanceof _m0$1.Reader?a:new _m0$1.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseFieldMask();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.paths.push(d.string());break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{paths:typeof a=="string"?a.split(",").filter(Boolean):Array.isArray(a==null?void 0:a.paths)?a.paths.map(String):[]}},toJSON(a){return a.paths.join(",")},fromPartial(a){var s;const d=createBaseFieldMask();return d.paths=((s=a.paths)===null||s===void 0?void 0:s.map(c=>c))||[],d},wrap(a){return{paths:a}},unwrap(a){return a.paths}},_m0$1.util.Long!==long_1.default&&(_m0$1.util.Long=long_1.default,_m0$1.configure()),function(a){var s=commonjsGlobal$1&&commonjsGlobal$1.__createBinding||(Object.create?function(u,m,g,B){B===void 0&&(B=g);var C=Object.getOwnPropertyDescriptor(m,g);(!C||("get"in C?!m.__esModule:C.writable||C.configurable))&&(C={enumerable:!0,get:function(){return m[g]}}),Object.defineProperty(u,B,C)}:function(u,m,g,B){B===void 0&&(B=g),u[B]=m[g]}),d=commonjsGlobal$1&&commonjsGlobal$1.__setModuleDefault||(Object.create?function(u,m){Object.defineProperty(u,"default",{enumerable:!0,value:m})}:function(u,m){u.default=m}),c=commonjsGlobal$1&&commonjsGlobal$1.__importStar||function(u){if(u&&u.__esModule)return u;var m={};if(u!=null)for(var g in u)g!=="default"&&Object.prototype.hasOwnProperty.call(u,g)&&s(m,u,g);return d(m,u),m},l=commonjsGlobal$1&&commonjsGlobal$1.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(a,"__esModule",{value:!0}),a.Role=a.regionToNumber=a.regionToJSON=a.regionFromJSON=a.Region=a.sourceTriggerActionToNumber=a.sourceTriggerActionToJSON=a.sourceTriggerActionFromJSON=a.SourceTriggerAction=a.s3ACLToNumber=a.s3ACLToJSON=a.s3ACLFromJSON=a.S3ACL=a.projectBroadcastPhaseToNumber=a.projectBroadcastPhaseToJSON=a.projectBroadcastPhaseFromJSON=a.ProjectBroadcastPhase=a.videoCodecRateControlModeToNumber=a.videoCodecRateControlModeToJSON=a.videoCodecRateControlModeFromJSON=a.VideoCodecRateControlMode=a.audioCodecToNumber=a.audioCodecToJSON=a.audioCodecFromJSON=a.AudioCodec=a.videoCodecProfileToNumber=a.videoCodecProfileToJSON=a.videoCodecProfileFromJSON=a.VideoCodecProfile=a.videoCodecToNumber=a.videoCodecToJSON=a.videoCodecFromJSON=a.VideoCodec=a.renderingQualityToNumber=a.renderingQualityToJSON=a.renderingQualityFromJSON=a.RenderingQuality=a.audioChannelLayoutToNumber=a.audioChannelLayoutToJSON=a.audioChannelLayoutFromJSON=a.AudioChannelLayout=a.videoColorSpaceToNumber=a.videoColorSpaceToJSON=a.videoColorSpaceFromJSON=a.VideoColorSpace=a.imageFormatToNumber=a.imageFormatToJSON=a.imageFormatFromJSON=a.ImageFormat=a.protobufPackage=void 0,a.HostedWebRtc=a.Composition=a.ExternalComposition=a.SceneComposition=a.StudioSdkComposition=a.PreviewAddress=a.PreviewWebRtcAddress=a.PreviewHlsPullAddress=a.ProjectTrigger=a.WebRtcTrigger=a.SourceTrigger=a.DestinationAddress=a.S3StorageAddress=a.ObjectStoragePackaging=a.HlsPackaging=a.HlsLifecycle=a.HlsLifecycleVod=a.HlsLifecycleLive=a.DestinationAgoraPushAddress=a.DestinationRtmpPushAddress=a.SourceAddress=a.RtmpPullAddress=a.SrtPushAddress=a.SourceRtmpPushAddress=a.Encoding=a.AudioEncoding=a.VideoEncoding=a.VideoCodecRateControl=a.Rendering=a.AudioRendering=a.VideoRendering=a.eventTypeToNumber=a.eventTypeToJSON=a.eventTypeFromJSON=a.EventType=a.eventSubTypeToNumber=a.eventSubTypeToJSON=a.eventSubTypeFromJSON=a.EventSubType=a.connectStateToNumber=a.connectStateToJSON=a.connectStateFromJSON=a.ConnectState=a.projectBroadcastErrorToNumber=a.projectBroadcastErrorToJSON=a.projectBroadcastErrorFromJSON=a.ProjectBroadcastError=a.roleToNumber=a.roleToJSON=a.roleFromJSON=void 0,a.DeleteSourceResponse=a.DeleteSourceRequest=a.CreateSourceResponse=a.CreateSourceRequest=a.UpdateDestinationResponse=a.UpdateDestinationRequest=a.DeleteDestinationResponse=a.DeleteDestinationRequest=a.GetDestinationResponse=a.GetDestinationRequest=a.CreateDestinationResponse=a.CreateDestinationRequest=a.StopProjectWebRtcResponse=a.StopProjectWebRtcRequest=a.StartProjectWebRtcResponse=a.StartProjectWebRtcRequest=a.GetProjectBroadcastStatusResponse=a.GetProjectBroadcastStatusRequest=a.GetProjectBroadcastSnapshotResponse=a.GetProjectBroadcastSnapshotRequest=a.GetProjectResponse=a.GetProjectRequest=a.StopProjectBroadcastResponse=a.StopProjectBroadcastRequest=a.StartProjectBroadcastResponse=a.StartProjectBroadcastRequest=a.DeleteProjectResponse=a.DeleteProjectRequest=a.UpdateProjectResponse=a.UpdateProjectRequest=a.CreateProjectResponse=a.CreateProjectRequest=a.GetCollectionsResponse=a.GetCollectionsRequest=a.DeleteCollectionResponse=a.DeleteCollectionRequest=a.UpdateCollectionResponse=a.UpdateCollectionRequest=a.GetCollectionResponse=a.GetCollectionRequest=a.CreateCollectionResponse=a.CreateCollectionRequest=a.Collection=a.Project=a.Destination=a.Source=a.ProjectBroadcastStatus=a.LatLong=a.WebRtcAccess=a.WebRtc=void 0,a.DestinationEvent=a.CollectionEvent=a.SourceStateEvent=a.SourceRemoveEvent=a.SourceAddEvent=a.SourceUpdateEvent=a.SourceDeleteEvent=a.SourceCreateEvent=a.CollectionUpdateEvent=a.CollectionDeleteEvent=a.CollectionCreateEvent=a.ProjectBroadcastStateEvent=a.ProjectUpdateEvent=a.ProjectDeleteEvent=a.ProjectCreateEvent=a.DestinationStateEvent=a.DestinationUpdateEvent=a.DestinationDeleteEvent=a.DestinationCreateEvent=a.GetTestTokenResponse=a.GetTestTokenRequest=a.GetJsonWebKeySetResponse=a.GetJsonWebKeySetRequest=a.JsonWebKey=a.GuestCodeRedirectResponse=a.GuestCodeRedirectRequest=a.GuestCode=a.RefreshAccessTokenResponse=a.RefreshAccessTokenRequest=a.CreateWebRtcAccessTokenResponse=a.CreateWebRtcAccessTokenRequest=a.CreateGuestAccessTokenResponse=a.CreateGuestAccessTokenRequest=a.GuestAccessToken=a.GuestAccessTokenExchange=a.GuestAccessTokenDirect=a.CreateAccessTokenResponse=a.CreateAccessTokenRequest=a.RemoveSourceFromProjectResponse=a.RemoveSourceFromProjectRequest=a.UpdateSourceResponse=a.UpdateSourceRequest=a.GetSourcesResponse=a.GetSourcesRequest=a.GetSourceResponse=a.GetSourceRequest=a.UpdateSourceInProjectResponse=a.UpdateSourceInProjectRequest=a.AddSourceToProjectResponse=a.AddSourceToProjectRequest=void 0,a.PublicAuthenticationServiceDefinition=a.PublicAuthenticationServiceClientImpl=a.AuthenticationServiceDefinition=a.AuthenticationServiceClientImpl=a.BackendAuthenticationServiceDefinition=a.BackendAuthenticationServiceClientImpl=a.SourceServiceDefinition=a.SourceServiceClientImpl=a.DestinationServiceDefinition=a.DestinationServiceClientImpl=a.ProjectServiceDefinition=a.ProjectServiceClientImpl=a.CollectionServiceDefinition=a.CollectionServiceClientImpl=a.LiveEvent=a.SourceEvent=a.ProjectEvent=void 0;const p=l(umd.exports),h=c(minimal$2),v=timestamp$1,S=struct$1,b=field_mask;a.protobufPackage="live.v21";var _;(function(u){u.IMAGE_FORMAT_UNSPECIFIED="IMAGE_FORMAT_UNSPECIFIED",u.IMAGE_FORMAT_JPEG="IMAGE_FORMAT_JPEG"})(_=a.ImageFormat||(a.ImageFormat={}));function I(u){switch(u){case 0:case"IMAGE_FORMAT_UNSPECIFIED":return _.IMAGE_FORMAT_UNSPECIFIED;case 1:case"IMAGE_FORMAT_JPEG":return _.IMAGE_FORMAT_JPEG;default:throw new Ue.Error("Unrecognized enum value "+u+" for enum ImageFormat")}}a.imageFormatFromJSON=I;function T(u){switch(u){case _.IMAGE_FORMAT_UNSPECIFIED:return"IMAGE_FORMAT_UNSPECIFIED";case _.IMAGE_FORMAT_JPEG:return"IMAGE_FORMAT_JPEG";default:return"UNKNOWN"}}a.imageFormatToJSON=T;function k(u){switch(u){case _.IMAGE_FORMAT_UNSPECIFIED:return 0;case _.IMAGE_FORMAT_JPEG:return 1;default:return 0}}a.imageFormatToNumber=k;var w;(function(u){u.VIDEO_COLOR_SPACE_UNSPECIFIED="VIDEO_COLOR_SPACE_UNSPECIFIED",u.VIDEO_COLOR_SPACE_YUV420="VIDEO_COLOR_SPACE_YUV420"})(w=a.VideoColorSpace||(a.VideoColorSpace={}));function P(u){switch(u){case 0:case"VIDEO_COLOR_SPACE_UNSPECIFIED":return w.VIDEO_COLOR_SPACE_UNSPECIFIED;case 1:case"VIDEO_COLOR_SPACE_YUV420":return w.VIDEO_COLOR_SPACE_YUV420;default:throw new Ue.Error("Unrecognized enum value "+u+" for enum VideoColorSpace")}}a.videoColorSpaceFromJSON=P;function $(u){switch(u){case w.VIDEO_COLOR_SPACE_UNSPECIFIED:return"VIDEO_COLOR_SPACE_UNSPECIFIED";case w.VIDEO_COLOR_SPACE_YUV420:return"VIDEO_COLOR_SPACE_YUV420";default:return"UNKNOWN"}}a.videoColorSpaceToJSON=$;function U(u){switch(u){case w.VIDEO_COLOR_SPACE_UNSPECIFIED:return 0;case w.VIDEO_COLOR_SPACE_YUV420:return 1;default:return 0}}a.videoColorSpaceToNumber=U;var E;(function(u){u.AUDIO_CHANNEL_LAYOUT_UNSPECIFIED="AUDIO_CHANNEL_LAYOUT_UNSPECIFIED",u.AUDIO_CHANNEL_LAYOUT_STEREO="AUDIO_CHANNEL_LAYOUT_STEREO"})(E=a.AudioChannelLayout||(a.AudioChannelLayout={}));function D(u){switch(u){case 0:case"AUDIO_CHANNEL_LAYOUT_UNSPECIFIED":return E.AUDIO_CHANNEL_LAYOUT_UNSPECIFIED;case 1:case"AUDIO_CHANNEL_LAYOUT_STEREO":return E.AUDIO_CHANNEL_LAYOUT_STEREO;default:throw new Ue.Error("Unrecognized enum value "+u+" for enum AudioChannelLayout")}}a.audioChannelLayoutFromJSON=D;function F(u){switch(u){case E.AUDIO_CHANNEL_LAYOUT_UNSPECIFIED:return"AUDIO_CHANNEL_LAYOUT_UNSPECIFIED";case E.AUDIO_CHANNEL_LAYOUT_STEREO:return"AUDIO_CHANNEL_LAYOUT_STEREO";default:return"UNKNOWN"}}a.audioChannelLayoutToJSON=F;function J(u){switch(u){case E.AUDIO_CHANNEL_LAYOUT_UNSPECIFIED:return 0;case E.AUDIO_CHANNEL_LAYOUT_STEREO:return 1;default:return 0}}a.audioChannelLayoutToNumber=J;var G;(function(u){u.RENDERING_QUALITY_UNSPECIFIED="RENDERING_QUALITY_UNSPECIFIED",u.RENDERING_QUALITY_STANDARD="RENDERING_QUALITY_STANDARD",u.RENDERING_QUALITY_HIGH="RENDERING_QUALITY_HIGH"})(G=a.RenderingQuality||(a.RenderingQuality={}));function x(u){switch(u){case 0:case"RENDERING_QUALITY_UNSPECIFIED":return G.RENDERING_QUALITY_UNSPECIFIED;case 1:case"RENDERING_QUALITY_STANDARD":return G.RENDERING_QUALITY_STANDARD;case 2:case"RENDERING_QUALITY_HIGH":return G.RENDERING_QUALITY_HIGH;default:throw new Ue.Error("Unrecognized enum value "+u+" for enum RenderingQuality")}}a.renderingQualityFromJSON=x;function Y(u){switch(u){case G.RENDERING_QUALITY_UNSPECIFIED:return"RENDERING_QUALITY_UNSPECIFIED";case G.RENDERING_QUALITY_STANDARD:return"RENDERING_QUALITY_STANDARD";case G.RENDERING_QUALITY_HIGH:return"RENDERING_QUALITY_HIGH";default:return"UNKNOWN"}}a.renderingQualityToJSON=Y;function N(u){switch(u){case G.RENDERING_QUALITY_UNSPECIFIED:return 0;case G.RENDERING_QUALITY_STANDARD:return 1;case G.RENDERING_QUALITY_HIGH:return 2;default:return 0}}a.renderingQualityToNumber=N;var z;(function(u){u.VIDEO_CODEC_UNSPECIFIED="VIDEO_CODEC_UNSPECIFIED",u.VIDEO_CODEC_H264="VIDEO_CODEC_H264"})(z=a.VideoCodec||(a.VideoCodec={}));function Z(u){switch(u){case 0:case"VIDEO_CODEC_UNSPECIFIED":return z.VIDEO_CODEC_UNSPECIFIED;case 1:case"VIDEO_CODEC_H264":return z.VIDEO_CODEC_H264;default:throw new Ue.Error("Unrecognized enum value "+u+" for enum VideoCodec")}}a.videoCodecFromJSON=Z;function L(u){switch(u){case z.VIDEO_CODEC_UNSPECIFIED:return"VIDEO_CODEC_UNSPECIFIED";case z.VIDEO_CODEC_H264:return"VIDEO_CODEC_H264";default:return"UNKNOWN"}}a.videoCodecToJSON=L;function V(u){switch(u){case z.VIDEO_CODEC_UNSPECIFIED:return 0;case z.VIDEO_CODEC_H264:return 1;default:return 0}}a.videoCodecToNumber=V;var H;(function(u){u.VIDEO_CODEC_PROFILE_UNSPECIFIED="VIDEO_CODEC_PROFILE_UNSPECIFIED",u.VIDEO_CODEC_PROFILE_BASELINE="VIDEO_CODEC_PROFILE_BASELINE",u.VIDEO_CODEC_PROFILE_MAIN="VIDEO_CODEC_PROFILE_MAIN",u.VIDEO_CODEC_PROFILE_HIGH="VIDEO_CODEC_PROFILE_HIGH"})(H=a.VideoCodecProfile||(a.VideoCodecProfile={}));function de(u){switch(u){case 0:case"VIDEO_CODEC_PROFILE_UNSPECIFIED":return H.VIDEO_CODEC_PROFILE_UNSPECIFIED;case 2:case"VIDEO_CODEC_PROFILE_BASELINE":return H.VIDEO_CODEC_PROFILE_BASELINE;case 3:case"VIDEO_CODEC_PROFILE_MAIN":return H.VIDEO_CODEC_PROFILE_MAIN;case 4:case"VIDEO_CODEC_PROFILE_HIGH":return H.VIDEO_CODEC_PROFILE_HIGH;default:throw new Ue.Error("Unrecognized enum value "+u+" for enum VideoCodecProfile")}}a.videoCodecProfileFromJSON=de;function X(u){switch(u){case H.VIDEO_CODEC_PROFILE_UNSPECIFIED:return"VIDEO_CODEC_PROFILE_UNSPECIFIED";case H.VIDEO_CODEC_PROFILE_BASELINE:return"VIDEO_CODEC_PROFILE_BASELINE";case H.VIDEO_CODEC_PROFILE_MAIN:return"VIDEO_CODEC_PROFILE_MAIN";case H.VIDEO_CODEC_PROFILE_HIGH:return"VIDEO_CODEC_PROFILE_HIGH";default:return"UNKNOWN"}}a.videoCodecProfileToJSON=X;function K(u){switch(u){case H.VIDEO_CODEC_PROFILE_UNSPECIFIED:return 0;case H.VIDEO_CODEC_PROFILE_BASELINE:return 2;case H.VIDEO_CODEC_PROFILE_MAIN:return 3;case H.VIDEO_CODEC_PROFILE_HIGH:return 4;default:return 0}}a.videoCodecProfileToNumber=K;var oe;(function(u){u.AUDIO_CODEC_UNSPECIFIED="AUDIO_CODEC_UNSPECIFIED",u.AUDIO_CODEC_AAC="AUDIO_CODEC_AAC"})(oe=a.AudioCodec||(a.AudioCodec={}));function pe(u){switch(u){case 0:case"AUDIO_CODEC_UNSPECIFIED":return oe.AUDIO_CODEC_UNSPECIFIED;case 1:case"AUDIO_CODEC_AAC":return oe.AUDIO_CODEC_AAC;default:throw new Ue.Error("Unrecognized enum value "+u+" for enum AudioCodec")}}a.audioCodecFromJSON=pe;function me(u){switch(u){case oe.AUDIO_CODEC_UNSPECIFIED:return"AUDIO_CODEC_UNSPECIFIED";case oe.AUDIO_CODEC_AAC:return"AUDIO_CODEC_AAC";default:return"UNKNOWN"}}a.audioCodecToJSON=me;function ve(u){switch(u){case oe.AUDIO_CODEC_UNSPECIFIED:return 0;case oe.AUDIO_CODEC_AAC:return 1;default:return 0}}a.audioCodecToNumber=ve;var A;(function(u){u.VIDEO_CODEC_RATE_CONTROL_MODE_UNSPECIFIED="VIDEO_CODEC_RATE_CONTROL_MODE_UNSPECIFIED",u.VIDEO_CODEC_RATE_CONTROL_MODE_CBR="VIDEO_CODEC_RATE_CONTROL_MODE_CBR"})(A=a.VideoCodecRateControlMode||(a.VideoCodecRateControlMode={}));function W(u){switch(u){case 0:case"VIDEO_CODEC_RATE_CONTROL_MODE_UNSPECIFIED":return A.VIDEO_CODEC_RATE_CONTROL_MODE_UNSPECIFIED;case 1:case"VIDEO_CODEC_RATE_CONTROL_MODE_CBR":return A.VIDEO_CODEC_RATE_CONTROL_MODE_CBR;default:throw new Ue.Error("Unrecognized enum value "+u+" for enum VideoCodecRateControlMode")}}a.videoCodecRateControlModeFromJSON=W;function ee(u){switch(u){case A.VIDEO_CODEC_RATE_CONTROL_MODE_UNSPECIFIED:return"VIDEO_CODEC_RATE_CONTROL_MODE_UNSPECIFIED";case A.VIDEO_CODEC_RATE_CONTROL_MODE_CBR:return"VIDEO_CODEC_RATE_CONTROL_MODE_CBR";default:return"UNKNOWN"}}a.videoCodecRateControlModeToJSON=ee;function ce(u){switch(u){case A.VIDEO_CODEC_RATE_CONTROL_MODE_UNSPECIFIED:return 0;case A.VIDEO_CODEC_RATE_CONTROL_MODE_CBR:return 1;default:return 0}}a.videoCodecRateControlModeToNumber=ce;var re;(function(u){u.PROJECT_BROADCAST_PHASE_UNSPECIFIED="PROJECT_BROADCAST_PHASE_UNSPECIFIED",u.PROJECT_BROADCAST_PHASE_NOT_RUNNING="PROJECT_BROADCAST_PHASE_NOT_RUNNING",u.PROJECT_BROADCAST_PHASE_WAITING="PROJECT_BROADCAST_PHASE_WAITING",u.PROJECT_BROADCAST_PHASE_STARTING="PROJECT_BROADCAST_PHASE_STARTING",u.PROJECT_BROADCAST_PHASE_RUNNING="PROJECT_BROADCAST_PHASE_RUNNING",u.PROJECT_BROADCAST_PHASE_STOPPING="PROJECT_BROADCAST_PHASE_STOPPING",u.PROJECT_BROADCAST_PHASE_STOPPED="PROJECT_BROADCAST_PHASE_STOPPED",u.PROJECT_BROADCAST_PHASE_ARCHIVED="PROJECT_BROADCAST_PHASE_ARCHIVED"})(re=a.ProjectBroadcastPhase||(a.ProjectBroadcastPhase={}));function te(u){switch(u){case 0:case"PROJECT_BROADCAST_PHASE_UNSPECIFIED":return re.PROJECT_BROADCAST_PHASE_UNSPECIFIED;case 1:case"PROJECT_BROADCAST_PHASE_NOT_RUNNING":return re.PROJECT_BROADCAST_PHASE_NOT_RUNNING;case 2:case"PROJECT_BROADCAST_PHASE_WAITING":return re.PROJECT_BROADCAST_PHASE_WAITING;case 3:case"PROJECT_BROADCAST_PHASE_STARTING":return re.PROJECT_BROADCAST_PHASE_STARTING;case 4:case"PROJECT_BROADCAST_PHASE_RUNNING":return re.PROJECT_BROADCAST_PHASE_RUNNING;case 5:case"PROJECT_BROADCAST_PHASE_STOPPING":return re.PROJECT_BROADCAST_PHASE_STOPPING;case 6:case"PROJECT_BROADCAST_PHASE_STOPPED":return re.PROJECT_BROADCAST_PHASE_STOPPED;case 7:case"PROJECT_BROADCAST_PHASE_ARCHIVED":return re.PROJECT_BROADCAST_PHASE_ARCHIVED;default:throw new Ue.Error("Unrecognized enum value "+u+" for enum ProjectBroadcastPhase")}}a.projectBroadcastPhaseFromJSON=te;function se(u){switch(u){case re.PROJECT_BROADCAST_PHASE_UNSPECIFIED:return"PROJECT_BROADCAST_PHASE_UNSPECIFIED";case re.PROJECT_BROADCAST_PHASE_NOT_RUNNING:return"PROJECT_BROADCAST_PHASE_NOT_RUNNING";case re.PROJECT_BROADCAST_PHASE_WAITING:return"PROJECT_BROADCAST_PHASE_WAITING";case re.PROJECT_BROADCAST_PHASE_STARTING:return"PROJECT_BROADCAST_PHASE_STARTING";case re.PROJECT_BROADCAST_PHASE_RUNNING:return"PROJECT_BROADCAST_PHASE_RUNNING";case re.PROJECT_BROADCAST_PHASE_STOPPING:return"PROJECT_BROADCAST_PHASE_STOPPING";case re.PROJECT_BROADCAST_PHASE_STOPPED:return"PROJECT_BROADCAST_PHASE_STOPPED";case re.PROJECT_BROADCAST_PHASE_ARCHIVED:return"PROJECT_BROADCAST_PHASE_ARCHIVED";default:return"UNKNOWN"}}a.projectBroadcastPhaseToJSON=se;function le(u){switch(u){case re.PROJECT_BROADCAST_PHASE_UNSPECIFIED:return 0;case re.PROJECT_BROADCAST_PHASE_NOT_RUNNING:return 1;case re.PROJECT_BROADCAST_PHASE_WAITING:return 2;case re.PROJECT_BROADCAST_PHASE_STARTING:return 3;case re.PROJECT_BROADCAST_PHASE_RUNNING:return 4;case re.PROJECT_BROADCAST_PHASE_STOPPING:return 5;case re.PROJECT_BROADCAST_PHASE_STOPPED:return 6;case re.PROJECT_BROADCAST_PHASE_ARCHIVED:return 7;default:return 0}}a.projectBroadcastPhaseToNumber=le;var ue;(function(u){u.S3ACL_UNSPECIFIED="S3ACL_UNSPECIFIED",u.S3ACL_PRIVATE="S3ACL_PRIVATE",u.S3ACL_PUBLIC_READ="S3ACL_PUBLIC_READ",u.S3ACL_PUBLIC_READ_WRITE="S3ACL_PUBLIC_READ_WRITE",u.S3ACL_AUTHENTICATED_READ="S3ACL_AUTHENTICATED_READ",u.S3ACL_BUCKET_OWNER_READ="S3ACL_BUCKET_OWNER_READ",u.S3ACL_BUCKET_OWNER_FULL_CONTROL="S3ACL_BUCKET_OWNER_FULL_CONTROL"})(ue=a.S3ACL||(a.S3ACL={}));function De(u){switch(u){case 0:case"S3ACL_UNSPECIFIED":return ue.S3ACL_UNSPECIFIED;case 1:case"S3ACL_PRIVATE":return ue.S3ACL_PRIVATE;case 2:case"S3ACL_PUBLIC_READ":return ue.S3ACL_PUBLIC_READ;case 3:case"S3ACL_PUBLIC_READ_WRITE":return ue.S3ACL_PUBLIC_READ_WRITE;case 4:case"S3ACL_AUTHENTICATED_READ":return ue.S3ACL_AUTHENTICATED_READ;case 5:case"S3ACL_BUCKET_OWNER_READ":return ue.S3ACL_BUCKET_OWNER_READ;case 6:case"S3ACL_BUCKET_OWNER_FULL_CONTROL":return ue.S3ACL_BUCKET_OWNER_FULL_CONTROL;default:throw new Ue.Error("Unrecognized enum value "+u+" for enum S3ACL")}}a.s3ACLFromJSON=De;function Oe(u){switch(u){case ue.S3ACL_UNSPECIFIED:return"S3ACL_UNSPECIFIED";case ue.S3ACL_PRIVATE:return"S3ACL_PRIVATE";case ue.S3ACL_PUBLIC_READ:return"S3ACL_PUBLIC_READ";case ue.S3ACL_PUBLIC_READ_WRITE:return"S3ACL_PUBLIC_READ_WRITE";case ue.S3ACL_AUTHENTICATED_READ:return"S3ACL_AUTHENTICATED_READ";case ue.S3ACL_BUCKET_OWNER_READ:return"S3ACL_BUCKET_OWNER_READ";case ue.S3ACL_BUCKET_OWNER_FULL_CONTROL:return"S3ACL_BUCKET_OWNER_FULL_CONTROL";default:return"UNKNOWN"}}a.s3ACLToJSON=Oe;function qe(u){switch(u){case ue.S3ACL_UNSPECIFIED:return 0;case ue.S3ACL_PRIVATE:return 1;case ue.S3ACL_PUBLIC_READ:return 2;case ue.S3ACL_PUBLIC_READ_WRITE:return 3;case ue.S3ACL_AUTHENTICATED_READ:return 4;case ue.S3ACL_BUCKET_OWNER_READ:return 5;case ue.S3ACL_BUCKET_OWNER_FULL_CONTROL:return 6;default:return 0}}a.s3ACLToNumber=qe;var ke;(function(u){u.SOURCE_TRIGGER_ACTION_UNSPECIFIED="SOURCE_TRIGGER_ACTION_UNSPECIFIED",u.SOURCE_TRIGGER_ACTION_IGNORE="SOURCE_TRIGGER_ACTION_IGNORE",u.SOURCE_TRIGGER_ACTION_OR="SOURCE_TRIGGER_ACTION_OR"})(ke=a.SourceTriggerAction||(a.SourceTriggerAction={}));function $e(u){switch(u){case 0:case"SOURCE_TRIGGER_ACTION_UNSPECIFIED":return ke.SOURCE_TRIGGER_ACTION_UNSPECIFIED;case 1:case"SOURCE_TRIGGER_ACTION_IGNORE":return ke.SOURCE_TRIGGER_ACTION_IGNORE;case 3:case"SOURCE_TRIGGER_ACTION_OR":return ke.SOURCE_TRIGGER_ACTION_OR;default:throw new Ue.Error("Unrecognized enum value "+u+" for enum SourceTriggerAction")}}a.sourceTriggerActionFromJSON=$e;function Ge(u){switch(u){case ke.SOURCE_TRIGGER_ACTION_UNSPECIFIED:return"SOURCE_TRIGGER_ACTION_UNSPECIFIED";case ke.SOURCE_TRIGGER_ACTION_IGNORE:return"SOURCE_TRIGGER_ACTION_IGNORE";case ke.SOURCE_TRIGGER_ACTION_OR:return"SOURCE_TRIGGER_ACTION_OR";default:return"UNKNOWN"}}a.sourceTriggerActionToJSON=Ge;function He(u){switch(u){case ke.SOURCE_TRIGGER_ACTION_UNSPECIFIED:return 0;case ke.SOURCE_TRIGGER_ACTION_IGNORE:return 1;case ke.SOURCE_TRIGGER_ACTION_OR:return 3;default:return 0}}a.sourceTriggerActionToNumber=He;var ge;(function(u){u.REGION_UNSPECIFIED="REGION_UNSPECIFIED",u.REGION_US_EAST_1="REGION_US_EAST_1",u.REGION_US_EAST_2="REGION_US_EAST_2",u.REGION_US_WEST_1="REGION_US_WEST_1",u.REGION_US_WEST_2="REGION_US_WEST_2",u.REGION_US_CENTRAL_1="REGION_US_CENTRAL_1",u.REGION_AP_SOUTHEAST_1="REGION_AP_SOUTHEAST_1",u.REGION_CA_EAST_1="REGION_CA_EAST_1",u.REGION_EU_CENTRAL_1="REGION_EU_CENTRAL_1",u.REGION_EU_WEST_1="REGION_EU_WEST_1"})(ge=a.Region||(a.Region={}));function ze(u){switch(u){case 0:case"REGION_UNSPECIFIED":return ge.REGION_UNSPECIFIED;case 1:case"REGION_US_EAST_1":return ge.REGION_US_EAST_1;case 2:case"REGION_US_EAST_2":return ge.REGION_US_EAST_2;case 3:case"REGION_US_WEST_1":return ge.REGION_US_WEST_1;case 4:case"REGION_US_WEST_2":return ge.REGION_US_WEST_2;case 5:case"REGION_US_CENTRAL_1":return ge.REGION_US_CENTRAL_1;case 10:case"REGION_AP_SOUTHEAST_1":return ge.REGION_AP_SOUTHEAST_1;case 20:case"REGION_CA_EAST_1":return ge.REGION_CA_EAST_1;case 30:case"REGION_EU_CENTRAL_1":return ge.REGION_EU_CENTRAL_1;case 31:case"REGION_EU_WEST_1":return ge.REGION_EU_WEST_1;default:throw new Ue.Error("Unrecognized enum value "+u+" for enum Region")}}a.regionFromJSON=ze;function ye(u){switch(u){case ge.REGION_UNSPECIFIED:return"REGION_UNSPECIFIED";case ge.REGION_US_EAST_1:return"REGION_US_EAST_1";case ge.REGION_US_EAST_2:return"REGION_US_EAST_2";case ge.REGION_US_WEST_1:return"REGION_US_WEST_1";case ge.REGION_US_WEST_2:return"REGION_US_WEST_2";case ge.REGION_US_CENTRAL_1:return"REGION_US_CENTRAL_1";case ge.REGION_AP_SOUTHEAST_1:return"REGION_AP_SOUTHEAST_1";case ge.REGION_CA_EAST_1:return"REGION_CA_EAST_1";case ge.REGION_EU_CENTRAL_1:return"REGION_EU_CENTRAL_1";case ge.REGION_EU_WEST_1:return"REGION_EU_WEST_1";default:return"UNKNOWN"}}a.regionToJSON=ye;function Ye(u){switch(u){case ge.REGION_UNSPECIFIED:return 0;case ge.REGION_US_EAST_1:return 1;case ge.REGION_US_EAST_2:return 2;case ge.REGION_US_WEST_1:return 3;case ge.REGION_US_WEST_2:return 4;case ge.REGION_US_CENTRAL_1:return 5;case ge.REGION_AP_SOUTHEAST_1:return 10;case ge.REGION_CA_EAST_1:return 20;case ge.REGION_EU_CENTRAL_1:return 30;case ge.REGION_EU_WEST_1:return 31;default:return 0}}a.regionToNumber=Ye;var he;(function(u){u.ROLE_UNSPECIFIED="ROLE_UNSPECIFIED",u.ROLE_HOST="ROLE_HOST",u.ROLE_COHOST="ROLE_COHOST",u.ROLE_CONTRIBUTOR="ROLE_CONTRIBUTOR",u.ROLE_GUEST="ROLE_GUEST",u.ROLE_VIEWER="ROLE_VIEWER",u.ROLE_RENDERER="ROLE_RENDERER",u.ROLE_PLATFORM="ROLE_PLATFORM",u.ROLE_IMPERSONATE="ROLE_IMPERSONATE"})(he=a.Role||(a.Role={}));function Se(u){switch(u){case 0:case"ROLE_UNSPECIFIED":return he.ROLE_UNSPECIFIED;case 1:case"ROLE_HOST":return he.ROLE_HOST;case 2:case"ROLE_COHOST":return he.ROLE_COHOST;case 3:case"ROLE_CONTRIBUTOR":return he.ROLE_CONTRIBUTOR;case 4:case"ROLE_GUEST":return he.ROLE_GUEST;case 5:case"ROLE_VIEWER":return he.ROLE_VIEWER;case 6:case"ROLE_RENDERER":return he.ROLE_RENDERER;case 7:case"ROLE_PLATFORM":return he.ROLE_PLATFORM;case 8:case"ROLE_IMPERSONATE":return he.ROLE_IMPERSONATE;default:throw new Ue.Error("Unrecognized enum value "+u+" for enum Role")}}a.roleFromJSON=Se;function Te(u){switch(u){case he.ROLE_UNSPECIFIED:return"ROLE_UNSPECIFIED";case he.ROLE_HOST:return"ROLE_HOST";case he.ROLE_COHOST:return"ROLE_COHOST";case he.ROLE_CONTRIBUTOR:return"ROLE_CONTRIBUTOR";case he.ROLE_GUEST:return"ROLE_GUEST";case he.ROLE_VIEWER:return"ROLE_VIEWER";case he.ROLE_RENDERER:return"ROLE_RENDERER";case he.ROLE_PLATFORM:return"ROLE_PLATFORM";case he.ROLE_IMPERSONATE:return"ROLE_IMPERSONATE";default:return"UNKNOWN"}}a.roleToJSON=Te;function be(u){switch(u){case he.ROLE_UNSPECIFIED:return 0;case he.ROLE_HOST:return 1;case he.ROLE_COHOST:return 2;case he.ROLE_CONTRIBUTOR:return 3;case he.ROLE_GUEST:return 4;case he.ROLE_VIEWER:return 5;case he.ROLE_RENDERER:return 6;case he.ROLE_PLATFORM:return 7;case he.ROLE_IMPERSONATE:return 8;default:return 0}}a.roleToNumber=be;var Ie;(function(u){u.PROJECT_BROADCAST_ERROR_UNSPECIFIED="PROJECT_BROADCAST_ERROR_UNSPECIFIED",u.PROJECT_BROADCAST_ERROR_INTERNAL="PROJECT_BROADCAST_ERROR_INTERNAL",u.PROJECT_BROADCAST_ERROR_DURATION_EXCEEDED="PROJECT_BROADCAST_ERROR_DURATION_EXCEEDED"})(Ie=a.ProjectBroadcastError||(a.ProjectBroadcastError={}));function _e(u){switch(u){case 0:case"PROJECT_BROADCAST_ERROR_UNSPECIFIED":return Ie.PROJECT_BROADCAST_ERROR_UNSPECIFIED;case 1:case"PROJECT_BROADCAST_ERROR_INTERNAL":return Ie.PROJECT_BROADCAST_ERROR_INTERNAL;case 2:case"PROJECT_BROADCAST_ERROR_DURATION_EXCEEDED":return Ie.PROJECT_BROADCAST_ERROR_DURATION_EXCEEDED;default:throw new Ue.Error("Unrecognized enum value "+u+" for enum ProjectBroadcastError")}}a.projectBroadcastErrorFromJSON=_e;function et(u){switch(u){case Ie.PROJECT_BROADCAST_ERROR_UNSPECIFIED:return"PROJECT_BROADCAST_ERROR_UNSPECIFIED";case Ie.PROJECT_BROADCAST_ERROR_INTERNAL:return"PROJECT_BROADCAST_ERROR_INTERNAL";case Ie.PROJECT_BROADCAST_ERROR_DURATION_EXCEEDED:return"PROJECT_BROADCAST_ERROR_DURATION_EXCEEDED";default:return"UNKNOWN"}}a.projectBroadcastErrorToJSON=et;function Re(u){switch(u){case Ie.PROJECT_BROADCAST_ERROR_UNSPECIFIED:return 0;case Ie.PROJECT_BROADCAST_ERROR_INTERNAL:return 1;case Ie.PROJECT_BROADCAST_ERROR_DURATION_EXCEEDED:return 2;default:return 0}}a.projectBroadcastErrorToNumber=Re;var We;(function(u){u.CONNECT_STATE_UNSPECIFIED="CONNECT_STATE_UNSPECIFIED",u.CONNECT_STATE_CONNECTED="CONNECT_STATE_CONNECTED",u.CONNECT_STATE_DISCONNECTED="CONNECT_STATE_DISCONNECTED"})(We=a.ConnectState||(a.ConnectState={}));function xe(u){switch(u){case 0:case"CONNECT_STATE_UNSPECIFIED":return We.CONNECT_STATE_UNSPECIFIED;case 1:case"CONNECT_STATE_CONNECTED":return We.CONNECT_STATE_CONNECTED;case 2:case"CONNECT_STATE_DISCONNECTED":return We.CONNECT_STATE_DISCONNECTED;default:throw new Ue.Error("Unrecognized enum value "+u+" for enum ConnectState")}}a.connectStateFromJSON=xe;function nt(u){switch(u){case We.CONNECT_STATE_UNSPECIFIED:return"CONNECT_STATE_UNSPECIFIED";case We.CONNECT_STATE_CONNECTED:return"CONNECT_STATE_CONNECTED";case We.CONNECT_STATE_DISCONNECTED:return"CONNECT_STATE_DISCONNECTED";default:return"UNKNOWN"}}a.connectStateToJSON=nt;function rt(u){switch(u){case We.CONNECT_STATE_UNSPECIFIED:return 0;case We.CONNECT_STATE_CONNECTED:return 1;case We.CONNECT_STATE_DISCONNECTED:return 2;default:return 0}}a.connectStateToNumber=rt;var Me;(function(u){u.EVENT_SUB_TYPE_UNSPECIFIED="EVENT_SUB_TYPE_UNSPECIFIED",u.EVENT_SUB_TYPE_CREATE="EVENT_SUB_TYPE_CREATE",u.EVENT_SUB_TYPE_UPDATE="EVENT_SUB_TYPE_UPDATE",u.EVENT_SUB_TYPE_DELETE="EVENT_SUB_TYPE_DELETE",u.EVENT_SUB_TYPE_ADD="EVENT_SUB_TYPE_ADD",u.EVENT_SUB_TYPE_REMOVE="EVENT_SUB_TYPE_REMOVE",u.EVENT_SUB_TYPE_STATE="EVENT_SUB_TYPE_STATE"})(Me=a.EventSubType||(a.EventSubType={}));function ot(u){switch(u){case 0:case"EVENT_SUB_TYPE_UNSPECIFIED":return Me.EVENT_SUB_TYPE_UNSPECIFIED;case 1:case"EVENT_SUB_TYPE_CREATE":return Me.EVENT_SUB_TYPE_CREATE;case 2:case"EVENT_SUB_TYPE_UPDATE":return Me.EVENT_SUB_TYPE_UPDATE;case 3:case"EVENT_SUB_TYPE_DELETE":return Me.EVENT_SUB_TYPE_DELETE;case 4:case"EVENT_SUB_TYPE_ADD":return Me.EVENT_SUB_TYPE_ADD;case 5:case"EVENT_SUB_TYPE_REMOVE":return Me.EVENT_SUB_TYPE_REMOVE;case 6:case"EVENT_SUB_TYPE_STATE":return Me.EVENT_SUB_TYPE_STATE;default:throw new Ue.Error("Unrecognized enum value "+u+" for enum EventSubType")}}a.eventSubTypeFromJSON=ot;function tt(u){switch(u){case Me.EVENT_SUB_TYPE_UNSPECIFIED:return"EVENT_SUB_TYPE_UNSPECIFIED";case Me.EVENT_SUB_TYPE_CREATE:return"EVENT_SUB_TYPE_CREATE";case Me.EVENT_SUB_TYPE_UPDATE:return"EVENT_SUB_TYPE_UPDATE";case Me.EVENT_SUB_TYPE_DELETE:return"EVENT_SUB_TYPE_DELETE";case Me.EVENT_SUB_TYPE_ADD:return"EVENT_SUB_TYPE_ADD";case Me.EVENT_SUB_TYPE_REMOVE:return"EVENT_SUB_TYPE_REMOVE";case Me.EVENT_SUB_TYPE_STATE:return"EVENT_SUB_TYPE_STATE";default:return"UNKNOWN"}}a.eventSubTypeToJSON=tt;function at(u){switch(u){case Me.EVENT_SUB_TYPE_UNSPECIFIED:return 0;case Me.EVENT_SUB_TYPE_CREATE:return 1;case Me.EVENT_SUB_TYPE_UPDATE:return 2;case Me.EVENT_SUB_TYPE_DELETE:return 3;case Me.EVENT_SUB_TYPE_ADD:return 4;case Me.EVENT_SUB_TYPE_REMOVE:return 5;case Me.EVENT_SUB_TYPE_STATE:return 6;default:return 0}}a.eventSubTypeToNumber=at;var ae;(function(u){u.EVENT_TYPE_UNSPECIFIED="EVENT_TYPE_UNSPECIFIED",u.EVENT_TYPE_COLLECTION="EVENT_TYPE_COLLECTION",u.EVENT_TYPE_PROJECT="EVENT_TYPE_PROJECT",u.EVENT_TYPE_SOURCE="EVENT_TYPE_SOURCE",u.EVENT_TYPE_DESTINATION="EVENT_TYPE_DESTINATION"})(ae=a.EventType||(a.EventType={}));function y(u){switch(u){case 0:case"EVENT_TYPE_UNSPECIFIED":return ae.EVENT_TYPE_UNSPECIFIED;case 1:case"EVENT_TYPE_COLLECTION":return ae.EVENT_TYPE_COLLECTION;case 2:case"EVENT_TYPE_PROJECT":return ae.EVENT_TYPE_PROJECT;case 4:case"EVENT_TYPE_SOURCE":return ae.EVENT_TYPE_SOURCE;case 5:case"EVENT_TYPE_DESTINATION":return ae.EVENT_TYPE_DESTINATION;default:throw new Ue.Error("Unrecognized enum value "+u+" for enum EventType")}}a.eventTypeFromJSON=y;function O(u){switch(u){case ae.EVENT_TYPE_UNSPECIFIED:return"EVENT_TYPE_UNSPECIFIED";case ae.EVENT_TYPE_COLLECTION:return"EVENT_TYPE_COLLECTION";case ae.EVENT_TYPE_PROJECT:return"EVENT_TYPE_PROJECT";case ae.EVENT_TYPE_SOURCE:return"EVENT_TYPE_SOURCE";case ae.EVENT_TYPE_DESTINATION:return"EVENT_TYPE_DESTINATION";default:return"UNKNOWN"}}a.eventTypeToJSON=O;function M(u){switch(u){case ae.EVENT_TYPE_UNSPECIFIED:return 0;case ae.EVENT_TYPE_COLLECTION:return 1;case ae.EVENT_TYPE_PROJECT:return 2;case ae.EVENT_TYPE_SOURCE:return 4;case ae.EVENT_TYPE_DESTINATION:return 5;default:return 0}}a.eventTypeToNumber=M;function ne(){return{height:void 0,width:void 0,framerate:void 0,colorSpace:void 0}}a.VideoRendering={encode(u,m=h.Writer.create()){return u.height!==void 0&&m.uint32(8).uint32(u.height),u.width!==void 0&&m.uint32(16).uint32(u.width),u.framerate!==void 0&&m.uint32(29).float(u.framerate),u.colorSpace!==void 0&&m.uint32(32).int32(U(u.colorSpace)),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=ne();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.height=g.uint32();break;case 2:C.width=g.uint32();break;case 3:C.framerate=g.float();break;case 4:C.colorSpace=P(g.int32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{height:Q(u.height)?Number(u.height):void 0,width:Q(u.width)?Number(u.width):void 0,framerate:Q(u.framerate)?Number(u.framerate):void 0,colorSpace:Q(u.colorSpace)?P(u.colorSpace):void 0}},toJSON(u){const m={};return u.height!==void 0&&(m.height=Math.round(u.height)),u.width!==void 0&&(m.width=Math.round(u.width)),u.framerate!==void 0&&(m.framerate=u.framerate),u.colorSpace!==void 0&&(m.colorSpace=u.colorSpace!==void 0?$(u.colorSpace):void 0),m},fromPartial(u){var m,g,B,C;const q=ne();return q.height=(m=u.height)!==null&&m!==void 0?m:void 0,q.width=(g=u.width)!==null&&g!==void 0?g:void 0,q.framerate=(B=u.framerate)!==null&&B!==void 0?B:void 0,q.colorSpace=(C=u.colorSpace)!==null&&C!==void 0?C:void 0,q}};function j(){return{channelLayout:void 0}}a.AudioRendering={encode(u,m=h.Writer.create()){return u.channelLayout!==void 0&&m.uint32(8).int32(J(u.channelLayout)),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=j();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.channelLayout=D(g.int32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{channelLayout:Q(u.channelLayout)?D(u.channelLayout):void 0}},toJSON(u){const m={};return u.channelLayout!==void 0&&(m.channelLayout=u.channelLayout!==void 0?F(u.channelLayout):void 0),m},fromPartial(u){var m;const g=j();return g.channelLayout=(m=u.channelLayout)!==null&&m!==void 0?m:void 0,g}};function ie(){return{video:void 0,audio:void 0,quality:void 0,targetLatency:void 0,complexity:void 0}}a.Rendering={encode(u,m=h.Writer.create()){return u.video!==void 0&&a.VideoRendering.encode(u.video,m.uint32(10).fork()).ldelim(),u.audio!==void 0&&a.AudioRendering.encode(u.audio,m.uint32(18).fork()).ldelim(),u.quality!==void 0&&m.uint32(24).int32(N(u.quality)),u.targetLatency!==void 0&&m.uint32(32).uint32(u.targetLatency),u.complexity!==void 0&&m.uint32(40).int32(u.complexity),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=ie();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.video=a.VideoRendering.decode(g,g.uint32());break;case 2:C.audio=a.AudioRendering.decode(g,g.uint32());break;case 3:C.quality=x(g.int32());break;case 4:C.targetLatency=g.uint32();break;case 5:C.complexity=g.int32();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{video:Q(u.video)?a.VideoRendering.fromJSON(u.video):void 0,audio:Q(u.audio)?a.AudioRendering.fromJSON(u.audio):void 0,quality:Q(u.quality)?x(u.quality):void 0,targetLatency:Q(u.targetLatency)?Number(u.targetLatency):void 0,complexity:Q(u.complexity)?Number(u.complexity):void 0}},toJSON(u){const m={};return u.video!==void 0&&(m.video=u.video?a.VideoRendering.toJSON(u.video):void 0),u.audio!==void 0&&(m.audio=u.audio?a.AudioRendering.toJSON(u.audio):void 0),u.quality!==void 0&&(m.quality=u.quality!==void 0?Y(u.quality):void 0),u.targetLatency!==void 0&&(m.targetLatency=Math.round(u.targetLatency)),u.complexity!==void 0&&(m.complexity=Math.round(u.complexity)),m},fromPartial(u){var m,g,B;const C=ie();return C.video=u.video!==void 0&&u.video!==null?a.VideoRendering.fromPartial(u.video):void 0,C.audio=u.audio!==void 0&&u.audio!==null?a.AudioRendering.fromPartial(u.audio):void 0,C.quality=(m=u.quality)!==null&&m!==void 0?m:void 0,C.targetLatency=(g=u.targetLatency)!==null&&g!==void 0?g:void 0,C.complexity=(B=u.complexity)!==null&&B!==void 0?B:void 0,C}};function we(){return{mode:void 0,targetBitrate:void 0,maxKeyFrameInterval:void 0}}a.VideoCodecRateControl={encode(u,m=h.Writer.create()){return u.mode!==void 0&&m.uint32(8).int32(ce(u.mode)),u.targetBitrate!==void 0&&m.uint32(16).uint32(u.targetBitrate),u.maxKeyFrameInterval!==void 0&&m.uint32(24).uint32(u.maxKeyFrameInterval),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=we();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.mode=W(g.int32());break;case 2:C.targetBitrate=g.uint32();break;case 3:C.maxKeyFrameInterval=g.uint32();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{mode:Q(u.mode)?W(u.mode):void 0,targetBitrate:Q(u.targetBitrate)?Number(u.targetBitrate):void 0,maxKeyFrameInterval:Q(u.maxKeyFrameInterval)?Number(u.maxKeyFrameInterval):void 0}},toJSON(u){const m={};return u.mode!==void 0&&(m.mode=u.mode!==void 0?ee(u.mode):void 0),u.targetBitrate!==void 0&&(m.targetBitrate=Math.round(u.targetBitrate)),u.maxKeyFrameInterval!==void 0&&(m.maxKeyFrameInterval=Math.round(u.maxKeyFrameInterval)),m},fromPartial(u){var m,g,B;const C=we();return C.mode=(m=u.mode)!==null&&m!==void 0?m:void 0,C.targetBitrate=(g=u.targetBitrate)!==null&&g!==void 0?g:void 0,C.maxKeyFrameInterval=(B=u.maxKeyFrameInterval)!==null&&B!==void 0?B:void 0,C}};function Be(){return{codec:void 0,rateControl:void 0,profile:void 0}}a.VideoEncoding={encode(u,m=h.Writer.create()){return u.codec!==void 0&&m.uint32(8).int32(V(u.codec)),u.rateControl!==void 0&&a.VideoCodecRateControl.encode(u.rateControl,m.uint32(18).fork()).ldelim(),u.profile!==void 0&&m.uint32(32).int32(K(u.profile)),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Be();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.codec=Z(g.int32());break;case 2:C.rateControl=a.VideoCodecRateControl.decode(g,g.uint32());break;case 4:C.profile=de(g.int32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{codec:Q(u.codec)?Z(u.codec):void 0,rateControl:Q(u.rateControl)?a.VideoCodecRateControl.fromJSON(u.rateControl):void 0,profile:Q(u.profile)?de(u.profile):void 0}},toJSON(u){const m={};return u.codec!==void 0&&(m.codec=u.codec!==void 0?L(u.codec):void 0),u.rateControl!==void 0&&(m.rateControl=u.rateControl?a.VideoCodecRateControl.toJSON(u.rateControl):void 0),u.profile!==void 0&&(m.profile=u.profile!==void 0?X(u.profile):void 0),m},fromPartial(u){var m,g;const B=Be();return B.codec=(m=u.codec)!==null&&m!==void 0?m:void 0,B.rateControl=u.rateControl!==void 0&&u.rateControl!==null?a.VideoCodecRateControl.fromPartial(u.rateControl):void 0,B.profile=(g=u.profile)!==null&&g!==void 0?g:void 0,B}};function Ve(){return{codec:void 0}}a.AudioEncoding={encode(u,m=h.Writer.create()){return u.codec!==void 0&&m.uint32(8).int32(ve(u.codec)),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Ve();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.codec=pe(g.int32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{codec:Q(u.codec)?pe(u.codec):void 0}},toJSON(u){const m={};return u.codec!==void 0&&(m.codec=u.codec!==void 0?me(u.codec):void 0),m},fromPartial(u){var m;const g=Ve();return g.codec=(m=u.codec)!==null&&m!==void 0?m:void 0,g}};function Ne(){return{video:void 0,audio:void 0}}a.Encoding={encode(u,m=h.Writer.create()){return u.video!==void 0&&a.VideoEncoding.encode(u.video,m.uint32(10).fork()).ldelim(),u.audio!==void 0&&a.AudioEncoding.encode(u.audio,m.uint32(18).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Ne();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.video=a.VideoEncoding.decode(g,g.uint32());break;case 2:C.audio=a.AudioEncoding.decode(g,g.uint32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{video:Q(u.video)?a.VideoEncoding.fromJSON(u.video):void 0,audio:Q(u.audio)?a.AudioEncoding.fromJSON(u.audio):void 0}},toJSON(u){const m={};return u.video!==void 0&&(m.video=u.video?a.VideoEncoding.toJSON(u.video):void 0),u.audio!==void 0&&(m.audio=u.audio?a.AudioEncoding.toJSON(u.audio):void 0),m},fromPartial(u){const m=Ne();return m.video=u.video!==void 0&&u.video!==null?a.VideoEncoding.fromPartial(u.video):void 0,m.audio=u.audio!==void 0&&u.audio!==null?a.AudioEncoding.fromPartial(u.audio):void 0,m}};function Ae(){return{enabled:void 0,key:void 0,url:void 0,baseUrl:void 0}}a.SourceRtmpPushAddress={encode(u,m=h.Writer.create()){return u.enabled!==void 0&&m.uint32(8).bool(u.enabled),u.key!==void 0&&m.uint32(18).string(u.key),u.url!==void 0&&m.uint32(26).string(u.url),u.baseUrl!==void 0&&m.uint32(34).string(u.baseUrl),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Ae();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.enabled=g.bool();break;case 2:C.key=g.string();break;case 3:C.url=g.string();break;case 4:C.baseUrl=g.string();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{enabled:Q(u.enabled)?Boolean(u.enabled):void 0,key:Q(u.key)?String(u.key):void 0,url:Q(u.url)?String(u.url):void 0,baseUrl:Q(u.baseUrl)?String(u.baseUrl):void 0}},toJSON(u){const m={};return u.enabled!==void 0&&(m.enabled=u.enabled),u.key!==void 0&&(m.key=u.key),u.url!==void 0&&(m.url=u.url),u.baseUrl!==void 0&&(m.baseUrl=u.baseUrl),m},fromPartial(u){var m,g,B,C;const q=Ae();return q.enabled=(m=u.enabled)!==null&&m!==void 0?m:void 0,q.key=(g=u.key)!==null&&g!==void 0?g:void 0,q.url=(B=u.url)!==null&&B!==void 0?B:void 0,q.baseUrl=(C=u.baseUrl)!==null&&C!==void 0?C:void 0,q}};function Ke(){return{enabled:void 0,streamId:void 0,url:void 0,baseUrl:void 0}}a.SrtPushAddress={encode(u,m=h.Writer.create()){return u.enabled!==void 0&&m.uint32(8).bool(u.enabled),u.streamId!==void 0&&m.uint32(18).string(u.streamId),u.url!==void 0&&m.uint32(26).string(u.url),u.baseUrl!==void 0&&m.uint32(34).string(u.baseUrl),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Ke();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.enabled=g.bool();break;case 2:C.streamId=g.string();break;case 3:C.url=g.string();break;case 4:C.baseUrl=g.string();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{enabled:Q(u.enabled)?Boolean(u.enabled):void 0,streamId:Q(u.streamId)?String(u.streamId):void 0,url:Q(u.url)?String(u.url):void 0,baseUrl:Q(u.baseUrl)?String(u.baseUrl):void 0}},toJSON(u){const m={};return u.enabled!==void 0&&(m.enabled=u.enabled),u.streamId!==void 0&&(m.streamId=u.streamId),u.url!==void 0&&(m.url=u.url),u.baseUrl!==void 0&&(m.baseUrl=u.baseUrl),m},fromPartial(u){var m,g,B,C;const q=Ke();return q.enabled=(m=u.enabled)!==null&&m!==void 0?m:void 0,q.streamId=(g=u.streamId)!==null&&g!==void 0?g:void 0,q.url=(B=u.url)!==null&&B!==void 0?B:void 0,q.baseUrl=(C=u.baseUrl)!==null&&C!==void 0?C:void 0,q}};function Qe(){return{url:""}}a.RtmpPullAddress={encode(u,m=h.Writer.create()){return u.url!==""&&m.uint32(10).string(u.url),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Qe();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.url=g.string();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{url:Q(u.url)?String(u.url):""}},toJSON(u){const m={};return u.url!==void 0&&(m.url=u.url),m},fromPartial(u){var m;const g=Qe();return g.url=(m=u.url)!==null&&m!==void 0?m:"",g}};function Ze(){return{rtmpPush:void 0,srtPush:void 0,rtmpPull:void 0}}a.SourceAddress={encode(u,m=h.Writer.create()){return u.rtmpPush!==void 0&&a.SourceRtmpPushAddress.encode(u.rtmpPush,m.uint32(10).fork()).ldelim(),u.srtPush!==void 0&&a.SrtPushAddress.encode(u.srtPush,m.uint32(18).fork()).ldelim(),u.rtmpPull!==void 0&&a.RtmpPullAddress.encode(u.rtmpPull,m.uint32(26).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Ze();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.rtmpPush=a.SourceRtmpPushAddress.decode(g,g.uint32());break;case 2:C.srtPush=a.SrtPushAddress.decode(g,g.uint32());break;case 3:C.rtmpPull=a.RtmpPullAddress.decode(g,g.uint32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{rtmpPush:Q(u.rtmpPush)?a.SourceRtmpPushAddress.fromJSON(u.rtmpPush):void 0,srtPush:Q(u.srtPush)?a.SrtPushAddress.fromJSON(u.srtPush):void 0,rtmpPull:Q(u.rtmpPull)?a.RtmpPullAddress.fromJSON(u.rtmpPull):void 0}},toJSON(u){const m={};return u.rtmpPush!==void 0&&(m.rtmpPush=u.rtmpPush?a.SourceRtmpPushAddress.toJSON(u.rtmpPush):void 0),u.srtPush!==void 0&&(m.srtPush=u.srtPush?a.SrtPushAddress.toJSON(u.srtPush):void 0),u.rtmpPull!==void 0&&(m.rtmpPull=u.rtmpPull?a.RtmpPullAddress.toJSON(u.rtmpPull):void 0),m},fromPartial(u){const m=Ze();return m.rtmpPush=u.rtmpPush!==void 0&&u.rtmpPush!==null?a.SourceRtmpPushAddress.fromPartial(u.rtmpPush):void 0,m.srtPush=u.srtPush!==void 0&&u.srtPush!==null?a.SrtPushAddress.fromPartial(u.srtPush):void 0,m.rtmpPull=u.rtmpPull!==void 0&&u.rtmpPull!==null?a.RtmpPullAddress.fromPartial(u.rtmpPull):void 0,m}};function je(){return{key:void 0,url:""}}a.DestinationRtmpPushAddress={encode(u,m=h.Writer.create()){return u.key!==void 0&&m.uint32(10).string(u.key),u.url!==""&&m.uint32(18).string(u.url),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=je();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.key=g.string();break;case 2:C.url=g.string();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{key:Q(u.key)?String(u.key):void 0,url:Q(u.url)?String(u.url):""}},toJSON(u){const m={};return u.key!==void 0&&(m.key=u.key),u.url!==void 0&&(m.url=u.url),m},fromPartial(u){var m,g;const B=je();return B.key=(m=u.key)!==null&&m!==void 0?m:void 0,B.url=(g=u.url)!==null&&g!==void 0?g:"",B}};function Xe(){return{appId:"",channelId:"",userId:""}}a.DestinationAgoraPushAddress={encode(u,m=h.Writer.create()){return u.appId!==""&&m.uint32(10).string(u.appId),u.channelId!==""&&m.uint32(18).string(u.channelId),u.userId!==""&&m.uint32(26).string(u.userId),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Xe();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.appId=g.string();break;case 2:C.channelId=g.string();break;case 3:C.userId=g.string();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{appId:Q(u.appId)?String(u.appId):"",channelId:Q(u.channelId)?String(u.channelId):"",userId:Q(u.userId)?String(u.userId):""}},toJSON(u){const m={};return u.appId!==void 0&&(m.appId=u.appId),u.channelId!==void 0&&(m.channelId=u.channelId),u.userId!==void 0&&(m.userId=u.userId),m},fromPartial(u){var m,g,B;const C=Xe();return C.appId=(m=u.appId)!==null&&m!==void 0?m:"",C.channelId=(g=u.channelId)!==null&&g!==void 0?g:"",C.userId=(B=u.userId)!==null&&B!==void 0?B:"",C}};function Le(){return{playlistCount:void 0,fileCount:void 0}}a.HlsLifecycleLive={encode(u,m=h.Writer.create()){return u.playlistCount!==void 0&&m.uint32(8).int32(u.playlistCount),u.fileCount!==void 0&&m.uint32(16).int32(u.fileCount),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Le();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.playlistCount=g.int32();break;case 2:C.fileCount=g.int32();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{playlistCount:Q(u.playlistCount)?Number(u.playlistCount):void 0,fileCount:Q(u.fileCount)?Number(u.fileCount):void 0}},toJSON(u){const m={};return u.playlistCount!==void 0&&(m.playlistCount=Math.round(u.playlistCount)),u.fileCount!==void 0&&(m.fileCount=Math.round(u.fileCount)),m},fromPartial(u){var m,g;const B=Le();return B.playlistCount=(m=u.playlistCount)!==null&&m!==void 0?m:void 0,B.fileCount=(g=u.fileCount)!==null&&g!==void 0?g:void 0,B}};function Ee(){return{maxDuration:void 0}}a.HlsLifecycleVod={encode(u,m=h.Writer.create()){return u.maxDuration!==void 0&&m.uint32(8).int32(u.maxDuration),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Ee();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.maxDuration=g.int32();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{maxDuration:Q(u.maxDuration)?Number(u.maxDuration):void 0}},toJSON(u){const m={};return u.maxDuration!==void 0&&(m.maxDuration=Math.round(u.maxDuration)),m},fromPartial(u){var m;const g=Ee();return g.maxDuration=(m=u.maxDuration)!==null&&m!==void 0?m:void 0,g}};function it(){return{vod:void 0,live:void 0}}a.HlsLifecycle={encode(u,m=h.Writer.create()){return u.vod!==void 0&&a.HlsLifecycleVod.encode(u.vod,m.uint32(10).fork()).ldelim(),u.live!==void 0&&a.HlsLifecycleLive.encode(u.live,m.uint32(18).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=it();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.vod=a.HlsLifecycleVod.decode(g,g.uint32());break;case 2:C.live=a.HlsLifecycleLive.decode(g,g.uint32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{vod:Q(u.vod)?a.HlsLifecycleVod.fromJSON(u.vod):void 0,live:Q(u.live)?a.HlsLifecycleLive.fromJSON(u.live):void 0}},toJSON(u){const m={};return u.vod!==void 0&&(m.vod=u.vod?a.HlsLifecycleVod.toJSON(u.vod):void 0),u.live!==void 0&&(m.live=u.live?a.HlsLifecycleLive.toJSON(u.live):void 0),m},fromPartial(u){const m=it();return m.vod=u.vod!==void 0&&u.vod!==null?a.HlsLifecycleVod.fromPartial(u.vod):void 0,m.live=u.live!==void 0&&u.live!==null?a.HlsLifecycleLive.fromPartial(u.live):void 0,m}};function ct(){return{lifecycle:void 0,segmentDuration:void 0}}a.HlsPackaging={encode(u,m=h.Writer.create()){return u.lifecycle!==void 0&&a.HlsLifecycle.encode(u.lifecycle,m.uint32(10).fork()).ldelim(),u.segmentDuration!==void 0&&m.uint32(16).int32(u.segmentDuration),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=ct();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.lifecycle=a.HlsLifecycle.decode(g,g.uint32());break;case 2:C.segmentDuration=g.int32();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{lifecycle:Q(u.lifecycle)?a.HlsLifecycle.fromJSON(u.lifecycle):void 0,segmentDuration:Q(u.segmentDuration)?Number(u.segmentDuration):void 0}},toJSON(u){const m={};return u.lifecycle!==void 0&&(m.lifecycle=u.lifecycle?a.HlsLifecycle.toJSON(u.lifecycle):void 0),u.segmentDuration!==void 0&&(m.segmentDuration=Math.round(u.segmentDuration)),m},fromPartial(u){var m;const g=ct();return g.lifecycle=u.lifecycle!==void 0&&u.lifecycle!==null?a.HlsLifecycle.fromPartial(u.lifecycle):void 0,g.segmentDuration=(m=u.segmentDuration)!==null&&m!==void 0?m:void 0,g}};function ut(){return{hls:void 0}}a.ObjectStoragePackaging={encode(u,m=h.Writer.create()){return u.hls!==void 0&&a.HlsPackaging.encode(u.hls,m.uint32(10).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=ut();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.hls=a.HlsPackaging.decode(g,g.uint32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{hls:Q(u.hls)?a.HlsPackaging.fromJSON(u.hls):void 0}},toJSON(u){const m={};return u.hls!==void 0&&(m.hls=u.hls?a.HlsPackaging.toJSON(u.hls):void 0),m},fromPartial(u){const m=ut();return m.hls=u.hls!==void 0&&u.hls!==null?a.HlsPackaging.fromPartial(u.hls):void 0,m}};function lt(){return{region:"",bucket:"",prefix:void 0,accessKey:"",secretKey:"",token:void 0,tokenDuration:void 0,acl:void 0,endpoint:void 0,packaging:void 0}}a.S3StorageAddress={encode(u,m=h.Writer.create()){return u.region!==""&&m.uint32(10).string(u.region),u.bucket!==""&&m.uint32(18).string(u.bucket),u.prefix!==void 0&&m.uint32(26).string(u.prefix),u.accessKey!==""&&m.uint32(34).string(u.accessKey),u.secretKey!==""&&m.uint32(42).string(u.secretKey),u.token!==void 0&&m.uint32(50).string(u.token),u.tokenDuration!==void 0&&m.uint32(56).int32(u.tokenDuration),u.acl!==void 0&&m.uint32(64).int32(qe(u.acl)),u.endpoint!==void 0&&m.uint32(74).string(u.endpoint),u.packaging!==void 0&&a.ObjectStoragePackaging.encode(u.packaging,m.uint32(82).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=lt();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.region=g.string();break;case 2:C.bucket=g.string();break;case 3:C.prefix=g.string();break;case 4:C.accessKey=g.string();break;case 5:C.secretKey=g.string();break;case 6:C.token=g.string();break;case 7:C.tokenDuration=g.int32();break;case 8:C.acl=De(g.int32());break;case 9:C.endpoint=g.string();break;case 10:C.packaging=a.ObjectStoragePackaging.decode(g,g.uint32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{region:Q(u.region)?String(u.region):"",bucket:Q(u.bucket)?String(u.bucket):"",prefix:Q(u.prefix)?String(u.prefix):void 0,accessKey:Q(u.accessKey)?String(u.accessKey):"",secretKey:Q(u.secretKey)?String(u.secretKey):"",token:Q(u.token)?String(u.token):void 0,tokenDuration:Q(u.tokenDuration)?Number(u.tokenDuration):void 0,acl:Q(u.acl)?De(u.acl):void 0,endpoint:Q(u.endpoint)?String(u.endpoint):void 0,packaging:Q(u.packaging)?a.ObjectStoragePackaging.fromJSON(u.packaging):void 0}},toJSON(u){const m={};return u.region!==void 0&&(m.region=u.region),u.bucket!==void 0&&(m.bucket=u.bucket),u.prefix!==void 0&&(m.prefix=u.prefix),u.accessKey!==void 0&&(m.accessKey=u.accessKey),u.secretKey!==void 0&&(m.secretKey=u.secretKey),u.token!==void 0&&(m.token=u.token),u.tokenDuration!==void 0&&(m.tokenDuration=Math.round(u.tokenDuration)),u.acl!==void 0&&(m.acl=u.acl!==void 0?Oe(u.acl):void 0),u.endpoint!==void 0&&(m.endpoint=u.endpoint),u.packaging!==void 0&&(m.packaging=u.packaging?a.ObjectStoragePackaging.toJSON(u.packaging):void 0),m},fromPartial(u){var m,g,B,C,q,fe,Ce,Je,Fe;const Pe=lt();return Pe.region=(m=u.region)!==null&&m!==void 0?m:"",Pe.bucket=(g=u.bucket)!==null&&g!==void 0?g:"",Pe.prefix=(B=u.prefix)!==null&&B!==void 0?B:void 0,Pe.accessKey=(C=u.accessKey)!==null&&C!==void 0?C:"",Pe.secretKey=(q=u.secretKey)!==null&&q!==void 0?q:"",Pe.token=(fe=u.token)!==null&&fe!==void 0?fe:void 0,Pe.tokenDuration=(Ce=u.tokenDuration)!==null&&Ce!==void 0?Ce:void 0,Pe.acl=(Je=u.acl)!==null&&Je!==void 0?Je:void 0,Pe.endpoint=(Fe=u.endpoint)!==null&&Fe!==void 0?Fe:void 0,Pe.packaging=u.packaging!==void 0&&u.packaging!==null?a.ObjectStoragePackaging.fromPartial(u.packaging):void 0,Pe}};function ft(){return{rtmpPush:void 0,agora:void 0,s3Storage:void 0}}a.DestinationAddress={encode(u,m=h.Writer.create()){return u.rtmpPush!==void 0&&a.DestinationRtmpPushAddress.encode(u.rtmpPush,m.uint32(10).fork()).ldelim(),u.agora!==void 0&&a.DestinationAgoraPushAddress.encode(u.agora,m.uint32(18).fork()).ldelim(),u.s3Storage!==void 0&&a.S3StorageAddress.encode(u.s3Storage,m.uint32(26).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=ft();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.rtmpPush=a.DestinationRtmpPushAddress.decode(g,g.uint32());break;case 2:C.agora=a.DestinationAgoraPushAddress.decode(g,g.uint32());break;case 3:C.s3Storage=a.S3StorageAddress.decode(g,g.uint32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{rtmpPush:Q(u.rtmpPush)?a.DestinationRtmpPushAddress.fromJSON(u.rtmpPush):void 0,agora:Q(u.agora)?a.DestinationAgoraPushAddress.fromJSON(u.agora):void 0,s3Storage:Q(u.s3Storage)?a.S3StorageAddress.fromJSON(u.s3Storage):void 0}},toJSON(u){const m={};return u.rtmpPush!==void 0&&(m.rtmpPush=u.rtmpPush?a.DestinationRtmpPushAddress.toJSON(u.rtmpPush):void 0),u.agora!==void 0&&(m.agora=u.agora?a.DestinationAgoraPushAddress.toJSON(u.agora):void 0),u.s3Storage!==void 0&&(m.s3Storage=u.s3Storage?a.S3StorageAddress.toJSON(u.s3Storage):void 0),m},fromPartial(u){const m=ft();return m.rtmpPush=u.rtmpPush!==void 0&&u.rtmpPush!==null?a.DestinationRtmpPushAddress.fromPartial(u.rtmpPush):void 0,m.agora=u.agora!==void 0&&u.agora!==null?a.DestinationAgoraPushAddress.fromPartial(u.agora):void 0,m.s3Storage=u.s3Storage!==void 0&&u.s3Storage!==null?a.S3StorageAddress.fromPartial(u.s3Storage):void 0,m}};function pt(){return{sourceId:"",start:void 0,stop:void 0}}a.SourceTrigger={encode(u,m=h.Writer.create()){return u.sourceId!==""&&m.uint32(10).string(u.sourceId),u.start!==void 0&&m.uint32(16).int32(He(u.start)),u.stop!==void 0&&m.uint32(24).int32(He(u.stop)),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=pt();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.sourceId=g.string();break;case 2:C.start=$e(g.int32());break;case 3:C.stop=$e(g.int32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{sourceId:Q(u.sourceId)?String(u.sourceId):"",start:Q(u.start)?$e(u.start):void 0,stop:Q(u.stop)?$e(u.stop):void 0}},toJSON(u){const m={};return u.sourceId!==void 0&&(m.sourceId=u.sourceId),u.start!==void 0&&(m.start=u.start!==void 0?Ge(u.start):void 0),u.stop!==void 0&&(m.stop=u.stop!==void 0?Ge(u.stop):void 0),m},fromPartial(u){var m,g,B;const C=pt();return C.sourceId=(m=u.sourceId)!==null&&m!==void 0?m:"",C.start=(g=u.start)!==null&&g!==void 0?g:void 0,C.stop=(B=u.stop)!==null&&B!==void 0?B:void 0,C}};function ht(){return{stop:void 0}}a.WebRtcTrigger={encode(u,m=h.Writer.create()){return u.stop!==void 0&&m.uint32(24).int32(He(u.stop)),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=ht();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 3:C.stop=$e(g.int32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{stop:Q(u.stop)?$e(u.stop):void 0}},toJSON(u){const m={};return u.stop!==void 0&&(m.stop=u.stop!==void 0?Ge(u.stop):void 0),m},fromPartial(u){var m;const g=ht();return g.stop=(m=u.stop)!==null&&m!==void 0?m:void 0,g}};function mt(){return{source:void 0}}a.ProjectTrigger={encode(u,m=h.Writer.create()){return u.source!==void 0&&a.SourceTrigger.encode(u.source,m.uint32(10).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=mt();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.source=a.SourceTrigger.decode(g,g.uint32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{source:Q(u.source)?a.SourceTrigger.fromJSON(u.source):void 0}},toJSON(u){const m={};return u.source!==void 0&&(m.source=u.source?a.SourceTrigger.toJSON(u.source):void 0),m},fromPartial(u){const m=mt();return m.source=u.source!==void 0&&u.source!==null?a.SourceTrigger.fromPartial(u.source):void 0,m}};function vt(){return{enabled:void 0,url:void 0}}a.PreviewHlsPullAddress={encode(u,m=h.Writer.create()){return u.enabled!==void 0&&m.uint32(8).bool(u.enabled),u.url!==void 0&&m.uint32(18).string(u.url),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=vt();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.enabled=g.bool();break;case 2:C.url=g.string();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{enabled:Q(u.enabled)?Boolean(u.enabled):void 0,url:Q(u.url)?String(u.url):void 0}},toJSON(u){const m={};return u.enabled!==void 0&&(m.enabled=u.enabled),u.url!==void 0&&(m.url=u.url),m},fromPartial(u){var m,g;const B=vt();return B.enabled=(m=u.enabled)!==null&&m!==void 0?m:void 0,B.url=(g=u.url)!==null&&g!==void 0?g:void 0,B}};function gt(){return{enabled:void 0,displayName:void 0,participantId:void 0}}a.PreviewWebRtcAddress={encode(u,m=h.Writer.create()){return u.enabled!==void 0&&m.uint32(8).bool(u.enabled),u.displayName!==void 0&&m.uint32(18).string(u.displayName),u.participantId!==void 0&&m.uint32(26).string(u.participantId),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=gt();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.enabled=g.bool();break;case 2:C.displayName=g.string();break;case 3:C.participantId=g.string();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{enabled:Q(u.enabled)?Boolean(u.enabled):void 0,displayName:Q(u.displayName)?String(u.displayName):void 0,participantId:Q(u.participantId)?String(u.participantId):void 0}},toJSON(u){const m={};return u.enabled!==void 0&&(m.enabled=u.enabled),u.displayName!==void 0&&(m.displayName=u.displayName),u.participantId!==void 0&&(m.participantId=u.participantId),m},fromPartial(u){var m,g,B;const C=gt();return C.enabled=(m=u.enabled)!==null&&m!==void 0?m:void 0,C.displayName=(g=u.displayName)!==null&&g!==void 0?g:void 0,C.participantId=(B=u.participantId)!==null&&B!==void 0?B:void 0,C}};function St(){return{webrtc:void 0}}a.PreviewAddress={encode(u,m=h.Writer.create()){return u.webrtc!==void 0&&a.PreviewWebRtcAddress.encode(u.webrtc,m.uint32(18).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=St();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 2:C.webrtc=a.PreviewWebRtcAddress.decode(g,g.uint32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{webrtc:Q(u.webrtc)?a.PreviewWebRtcAddress.fromJSON(u.webrtc):void 0}},toJSON(u){const m={};return u.webrtc!==void 0&&(m.webrtc=u.webrtc?a.PreviewWebRtcAddress.toJSON(u.webrtc):void 0),m},fromPartial(u){const m=St();return m.webrtc=u.webrtc!==void 0&&u.webrtc!==null?a.PreviewWebRtcAddress.fromPartial(u.webrtc):void 0,m}};function yt(){return{rendererUrl:void 0,version:void 0}}a.StudioSdkComposition={encode(u,m=h.Writer.create()){return u.rendererUrl!==void 0&&m.uint32(10).string(u.rendererUrl),u.version!==void 0&&m.uint32(18).string(u.version),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=yt();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.rendererUrl=g.string();break;case 2:C.version=g.string();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{rendererUrl:Q(u.rendererUrl)?String(u.rendererUrl):void 0,version:Q(u.version)?String(u.version):void 0}},toJSON(u){const m={};return u.rendererUrl!==void 0&&(m.rendererUrl=u.rendererUrl),u.version!==void 0&&(m.version=u.version),m},fromPartial(u){var m,g;const B=yt();return B.rendererUrl=(m=u.rendererUrl)!==null&&m!==void 0?m:void 0,B.version=(g=u.version)!==null&&g!==void 0?g:void 0,B}};function bt(){return{rendererUrl:void 0,selectedLayoutId:void 0,debug:void 0}}a.SceneComposition={encode(u,m=h.Writer.create()){return u.rendererUrl!==void 0&&m.uint32(10).string(u.rendererUrl),u.selectedLayoutId!==void 0&&m.uint32(18).string(u.selectedLayoutId),u.debug!==void 0&&m.uint32(24).bool(u.debug),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=bt();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.rendererUrl=g.string();break;case 2:C.selectedLayoutId=g.string();break;case 3:C.debug=g.bool();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{rendererUrl:Q(u.rendererUrl)?String(u.rendererUrl):void 0,selectedLayoutId:Q(u.selectedLayoutId)?String(u.selectedLayoutId):void 0,debug:Q(u.debug)?Boolean(u.debug):void 0}},toJSON(u){const m={};return u.rendererUrl!==void 0&&(m.rendererUrl=u.rendererUrl),u.selectedLayoutId!==void 0&&(m.selectedLayoutId=u.selectedLayoutId),u.debug!==void 0&&(m.debug=u.debug),m},fromPartial(u){var m,g,B;const C=bt();return C.rendererUrl=(m=u.rendererUrl)!==null&&m!==void 0?m:void 0,C.selectedLayoutId=(g=u.selectedLayoutId)!==null&&g!==void 0?g:void 0,C.debug=(B=u.debug)!==null&&B!==void 0?B:void 0,C}};function _t(){return{url:""}}a.ExternalComposition={encode(u,m=h.Writer.create()){return u.url!==""&&m.uint32(10).string(u.url),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=_t();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.url=g.string();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{url:Q(u.url)?String(u.url):""}},toJSON(u){const m={};return u.url!==void 0&&(m.url=u.url),m},fromPartial(u){var m;const g=_t();return g.url=(m=u.url)!==null&&m!==void 0?m:"",g}};function Et(){return{external:void 0,studioSdk:void 0,scene:void 0}}a.Composition={encode(u,m=h.Writer.create()){return u.external!==void 0&&a.ExternalComposition.encode(u.external,m.uint32(10).fork()).ldelim(),u.studioSdk!==void 0&&a.StudioSdkComposition.encode(u.studioSdk,m.uint32(18).fork()).ldelim(),u.scene!==void 0&&a.SceneComposition.encode(u.scene,m.uint32(34).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Et();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.external=a.ExternalComposition.decode(g,g.uint32());break;case 2:C.studioSdk=a.StudioSdkComposition.decode(g,g.uint32());break;case 4:C.scene=a.SceneComposition.decode(g,g.uint32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{external:Q(u.external)?a.ExternalComposition.fromJSON(u.external):void 0,studioSdk:Q(u.studioSdk)?a.StudioSdkComposition.fromJSON(u.studioSdk):void 0,scene:Q(u.scene)?a.SceneComposition.fromJSON(u.scene):void 0}},toJSON(u){const m={};return u.external!==void 0&&(m.external=u.external?a.ExternalComposition.toJSON(u.external):void 0),u.studioSdk!==void 0&&(m.studioSdk=u.studioSdk?a.StudioSdkComposition.toJSON(u.studioSdk):void 0),u.scene!==void 0&&(m.scene=u.scene?a.SceneComposition.toJSON(u.scene):void 0),m},fromPartial(u){const m=Et();return m.external=u.external!==void 0&&u.external!==null?a.ExternalComposition.fromPartial(u.external):void 0,m.studioSdk=u.studioSdk!==void 0&&u.studioSdk!==null?a.StudioSdkComposition.fromPartial(u.studioSdk):void 0,m.scene=u.scene!==void 0&&u.scene!==null?a.SceneComposition.fromPartial(u.scene):void 0,m}};function Tt(){return{enabled:void 0}}a.HostedWebRtc={encode(u,m=h.Writer.create()){return u.enabled!==void 0&&m.uint32(8).bool(u.enabled),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Tt();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.enabled=g.bool();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{enabled:Q(u.enabled)?Boolean(u.enabled):void 0}},toJSON(u){const m={};return u.enabled!==void 0&&(m.enabled=u.enabled),m},fromPartial(u){var m;const g=Tt();return g.enabled=(m=u.enabled)!==null&&m!==void 0?m:void 0,g}};function It(){return{hosted:void 0}}a.WebRtc={encode(u,m=h.Writer.create()){return u.hosted!==void 0&&a.HostedWebRtc.encode(u.hosted,m.uint32(10).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=It();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.hosted=a.HostedWebRtc.decode(g,g.uint32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{hosted:Q(u.hosted)?a.HostedWebRtc.fromJSON(u.hosted):void 0}},toJSON(u){const m={};return u.hosted!==void 0&&(m.hosted=u.hosted?a.HostedWebRtc.toJSON(u.hosted):void 0),m},fromPartial(u){const m=It();return m.hosted=u.hosted!==void 0&&u.hosted!==null?a.HostedWebRtc.fromPartial(u.hosted):void 0,m}};function Ct(){return{accessToken:"",participantId:void 0}}a.WebRtcAccess={encode(u,m=h.Writer.create()){return u.accessToken!==""&&m.uint32(10).string(u.accessToken),u.participantId!==void 0&&m.uint32(26).string(u.participantId),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Ct();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.accessToken=g.string();break;case 3:C.participantId=g.string();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{accessToken:Q(u.accessToken)?String(u.accessToken):"",participantId:Q(u.participantId)?String(u.participantId):void 0}},toJSON(u){const m={};return u.accessToken!==void 0&&(m.accessToken=u.accessToken),u.participantId!==void 0&&(m.participantId=u.participantId),m},fromPartial(u){var m,g;const B=Ct();return B.accessToken=(m=u.accessToken)!==null&&m!==void 0?m:"",B.participantId=(g=u.participantId)!==null&&g!==void 0?g:void 0,B}};function Rt(){return{latitude:0,longitude:0}}a.LatLong={encode(u,m=h.Writer.create()){return u.latitude!==0&&m.uint32(9).double(u.latitude),u.longitude!==0&&m.uint32(17).double(u.longitude),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Rt();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.latitude=g.double();break;case 2:C.longitude=g.double();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{latitude:Q(u.latitude)?Number(u.latitude):0,longitude:Q(u.longitude)?Number(u.longitude):0}},toJSON(u){const m={};return u.latitude!==void 0&&(m.latitude=u.latitude),u.longitude!==void 0&&(m.longitude=u.longitude),m},fromPartial(u){var m,g;const B=Rt();return B.latitude=(m=u.latitude)!==null&&m!==void 0?m:0,B.longitude=(g=u.longitude)!==null&&g!==void 0?g:0,B}};function kt(){return{collectionId:"",projectId:"",broadcastId:void 0,duration:void 0,start:void 0,stop:void 0,phase:re.PROJECT_BROADCAST_PHASE_UNSPECIFIED,region:void 0,datacenter:void 0}}a.ProjectBroadcastStatus={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.broadcastId!==void 0&&m.uint32(26).string(u.broadcastId),u.duration!==void 0&&m.uint32(32).uint32(u.duration),u.start!==void 0&&v.Timestamp.encode(st(u.start),m.uint32(42).fork()).ldelim(),u.stop!==void 0&&v.Timestamp.encode(st(u.stop),m.uint32(50).fork()).ldelim(),u.phase!==re.PROJECT_BROADCAST_PHASE_UNSPECIFIED&&m.uint32(56).int32(le(u.phase)),u.region!==void 0&&m.uint32(64).int32(Ye(u.region)),u.datacenter!==void 0&&m.uint32(74).string(u.datacenter),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=kt();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.projectId=g.string();break;case 3:C.broadcastId=g.string();break;case 4:C.duration=g.uint32();break;case 5:C.start=dt(v.Timestamp.decode(g,g.uint32()));break;case 6:C.stop=dt(v.Timestamp.decode(g,g.uint32()));break;case 7:C.phase=te(g.int32());break;case 8:C.region=ze(g.int32());break;case 9:C.datacenter=g.string();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",broadcastId:Q(u.broadcastId)?String(u.broadcastId):void 0,duration:Q(u.duration)?Number(u.duration):void 0,start:Q(u.start)?String(u.start):void 0,stop:Q(u.stop)?String(u.stop):void 0,phase:Q(u.phase)?te(u.phase):re.PROJECT_BROADCAST_PHASE_UNSPECIFIED,region:Q(u.region)?ze(u.region):void 0,datacenter:Q(u.datacenter)?String(u.datacenter):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.broadcastId!==void 0&&(m.broadcastId=u.broadcastId),u.duration!==void 0&&(m.duration=Math.round(u.duration)),u.start!==void 0&&(m.start=u.start),u.stop!==void 0&&(m.stop=u.stop),u.phase!==void 0&&(m.phase=se(u.phase)),u.region!==void 0&&(m.region=u.region!==void 0?ye(u.region):void 0),u.datacenter!==void 0&&(m.datacenter=u.datacenter),m},fromPartial(u){var m,g,B,C,q,fe,Ce,Je,Fe;const Pe=kt();return Pe.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",Pe.projectId=(g=u.projectId)!==null&&g!==void 0?g:"",Pe.broadcastId=(B=u.broadcastId)!==null&&B!==void 0?B:void 0,Pe.duration=(C=u.duration)!==null&&C!==void 0?C:void 0,Pe.start=(q=u.start)!==null&&q!==void 0?q:void 0,Pe.stop=(fe=u.stop)!==null&&fe!==void 0?fe:void 0,Pe.phase=(Ce=u.phase)!==null&&Ce!==void 0?Ce:re.PROJECT_BROADCAST_PHASE_UNSPECIFIED,Pe.region=(Je=u.region)!==null&&Je!==void 0?Je:void 0,Pe.datacenter=(Fe=u.datacenter)!==null&&Fe!==void 0?Fe:void 0,Pe}};function Pt(){return{collectionId:"",sourceId:"",metadata:void 0,preview:void 0,address:void 0}}a.Source={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.sourceId!==""&&m.uint32(18).string(u.sourceId),u.metadata!==void 0&&S.Value.encode(S.Value.wrap(u.metadata),m.uint32(26).fork()).ldelim(),u.preview!==void 0&&a.PreviewAddress.encode(u.preview,m.uint32(34).fork()).ldelim(),u.address!==void 0&&a.SourceAddress.encode(u.address,m.uint32(50).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Pt();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.sourceId=g.string();break;case 3:C.metadata=S.Value.unwrap(S.Value.decode(g,g.uint32()));break;case 4:C.preview=a.PreviewAddress.decode(g,g.uint32());break;case 6:C.address=a.SourceAddress.decode(g,g.uint32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",sourceId:Q(u.sourceId)?String(u.sourceId):"",metadata:Q(u==null?void 0:u.metadata)?u.metadata:void 0,preview:Q(u.preview)?a.PreviewAddress.fromJSON(u.preview):void 0,address:Q(u.address)?a.SourceAddress.fromJSON(u.address):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.sourceId!==void 0&&(m.sourceId=u.sourceId),u.metadata!==void 0&&(m.metadata=u.metadata),u.preview!==void 0&&(m.preview=u.preview?a.PreviewAddress.toJSON(u.preview):void 0),u.address!==void 0&&(m.address=u.address?a.SourceAddress.toJSON(u.address):void 0),m},fromPartial(u){var m,g,B;const C=Pt();return C.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",C.sourceId=(g=u.sourceId)!==null&&g!==void 0?g:"",C.metadata=(B=u.metadata)!==null&&B!==void 0?B:void 0,C.preview=u.preview!==void 0&&u.preview!==null?a.PreviewAddress.fromPartial(u.preview):void 0,C.address=u.address!==void 0&&u.address!==null?a.SourceAddress.fromPartial(u.address):void 0,C}};function Ot(){return{collectionId:"",projectId:"",destinationId:"",metadata:void 0,enabled:void 0,address:void 0,timeout:void 0}}a.Destination={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.destinationId!==""&&m.uint32(26).string(u.destinationId),u.metadata!==void 0&&S.Value.encode(S.Value.wrap(u.metadata),m.uint32(34).fork()).ldelim(),u.enabled!==void 0&&m.uint32(40).bool(u.enabled),u.address!==void 0&&a.DestinationAddress.encode(u.address,m.uint32(50).fork()).ldelim(),u.timeout!==void 0&&m.uint32(56).uint32(u.timeout),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Ot();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.projectId=g.string();break;case 3:C.destinationId=g.string();break;case 4:C.metadata=S.Value.unwrap(S.Value.decode(g,g.uint32()));break;case 5:C.enabled=g.bool();break;case 6:C.address=a.DestinationAddress.decode(g,g.uint32());break;case 7:C.timeout=g.uint32();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",destinationId:Q(u.destinationId)?String(u.destinationId):"",metadata:Q(u==null?void 0:u.metadata)?u.metadata:void 0,enabled:Q(u.enabled)?Boolean(u.enabled):void 0,address:Q(u.address)?a.DestinationAddress.fromJSON(u.address):void 0,timeout:Q(u.timeout)?Number(u.timeout):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.destinationId!==void 0&&(m.destinationId=u.destinationId),u.metadata!==void 0&&(m.metadata=u.metadata),u.enabled!==void 0&&(m.enabled=u.enabled),u.address!==void 0&&(m.address=u.address?a.DestinationAddress.toJSON(u.address):void 0),u.timeout!==void 0&&(m.timeout=Math.round(u.timeout)),m},fromPartial(u){var m,g,B,C,q,fe;const Ce=Ot();return Ce.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",Ce.projectId=(g=u.projectId)!==null&&g!==void 0?g:"",Ce.destinationId=(B=u.destinationId)!==null&&B!==void 0?B:"",Ce.metadata=(C=u.metadata)!==null&&C!==void 0?C:void 0,Ce.enabled=(q=u.enabled)!==null&&q!==void 0?q:void 0,Ce.address=u.address!==void 0&&u.address!==null?a.DestinationAddress.fromPartial(u.address):void 0,Ce.timeout=(fe=u.timeout)!==null&&fe!==void 0?fe:void 0,Ce}};function wt(){return{collectionId:"",projectId:"",metadata:void 0,rendering:void 0,encoding:void 0,sources:[],destinations:[],composition:void 0,maxDuration:void 0,webrtc:void 0,triggers:[],location:void 0,guestCodes:[]}}a.Project={encode(u,m=h.Writer.create()){u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.metadata!==void 0&&S.Value.encode(S.Value.wrap(u.metadata),m.uint32(26).fork()).ldelim(),u.rendering!==void 0&&a.Rendering.encode(u.rendering,m.uint32(34).fork()).ldelim(),u.encoding!==void 0&&a.Encoding.encode(u.encoding,m.uint32(42).fork()).ldelim();for(const g of u.sources)a.Source.encode(g,m.uint32(50).fork()).ldelim();for(const g of u.destinations)a.Destination.encode(g,m.uint32(58).fork()).ldelim();u.composition!==void 0&&a.Composition.encode(u.composition,m.uint32(66).fork()).ldelim(),u.maxDuration!==void 0&&m.uint32(72).uint32(u.maxDuration),u.webrtc!==void 0&&a.WebRtc.encode(u.webrtc,m.uint32(82).fork()).ldelim();for(const g of u.triggers)a.ProjectTrigger.encode(g,m.uint32(90).fork()).ldelim();u.location!==void 0&&a.LatLong.encode(u.location,m.uint32(98).fork()).ldelim();for(const g of u.guestCodes)a.GuestCode.encode(g,m.uint32(106).fork()).ldelim();return m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=wt();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.projectId=g.string();break;case 3:C.metadata=S.Value.unwrap(S.Value.decode(g,g.uint32()));break;case 4:C.rendering=a.Rendering.decode(g,g.uint32());break;case 5:C.encoding=a.Encoding.decode(g,g.uint32());break;case 6:C.sources.push(a.Source.decode(g,g.uint32()));break;case 7:C.destinations.push(a.Destination.decode(g,g.uint32()));break;case 8:C.composition=a.Composition.decode(g,g.uint32());break;case 9:C.maxDuration=g.uint32();break;case 10:C.webrtc=a.WebRtc.decode(g,g.uint32());break;case 11:C.triggers.push(a.ProjectTrigger.decode(g,g.uint32()));break;case 12:C.location=a.LatLong.decode(g,g.uint32());break;case 13:C.guestCodes.push(a.GuestCode.decode(g,g.uint32()));break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",metadata:Q(u==null?void 0:u.metadata)?u.metadata:void 0,rendering:Q(u.rendering)?a.Rendering.fromJSON(u.rendering):void 0,encoding:Q(u.encoding)?a.Encoding.fromJSON(u.encoding):void 0,sources:Array.isArray(u==null?void 0:u.sources)?u.sources.map(m=>a.Source.fromJSON(m)):[],destinations:Array.isArray(u==null?void 0:u.destinations)?u.destinations.map(m=>a.Destination.fromJSON(m)):[],composition:Q(u.composition)?a.Composition.fromJSON(u.composition):void 0,maxDuration:Q(u.maxDuration)?Number(u.maxDuration):void 0,webrtc:Q(u.webrtc)?a.WebRtc.fromJSON(u.webrtc):void 0,triggers:Array.isArray(u==null?void 0:u.triggers)?u.triggers.map(m=>a.ProjectTrigger.fromJSON(m)):[],location:Q(u.location)?a.LatLong.fromJSON(u.location):void 0,guestCodes:Array.isArray(u==null?void 0:u.guestCodes)?u.guestCodes.map(m=>a.GuestCode.fromJSON(m)):[]}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.metadata!==void 0&&(m.metadata=u.metadata),u.rendering!==void 0&&(m.rendering=u.rendering?a.Rendering.toJSON(u.rendering):void 0),u.encoding!==void 0&&(m.encoding=u.encoding?a.Encoding.toJSON(u.encoding):void 0),u.sources?m.sources=u.sources.map(g=>g?a.Source.toJSON(g):void 0):m.sources=[],u.destinations?m.destinations=u.destinations.map(g=>g?a.Destination.toJSON(g):void 0):m.destinations=[],u.composition!==void 0&&(m.composition=u.composition?a.Composition.toJSON(u.composition):void 0),u.maxDuration!==void 0&&(m.maxDuration=Math.round(u.maxDuration)),u.webrtc!==void 0&&(m.webrtc=u.webrtc?a.WebRtc.toJSON(u.webrtc):void 0),u.triggers?m.triggers=u.triggers.map(g=>g?a.ProjectTrigger.toJSON(g):void 0):m.triggers=[],u.location!==void 0&&(m.location=u.location?a.LatLong.toJSON(u.location):void 0),u.guestCodes?m.guestCodes=u.guestCodes.map(g=>g?a.GuestCode.toJSON(g):void 0):m.guestCodes=[],m},fromPartial(u){var m,g,B,C,q,fe,Ce,Je;const Fe=wt();return Fe.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",Fe.projectId=(g=u.projectId)!==null&&g!==void 0?g:"",Fe.metadata=(B=u.metadata)!==null&&B!==void 0?B:void 0,Fe.rendering=u.rendering!==void 0&&u.rendering!==null?a.Rendering.fromPartial(u.rendering):void 0,Fe.encoding=u.encoding!==void 0&&u.encoding!==null?a.Encoding.fromPartial(u.encoding):void 0,Fe.sources=((C=u.sources)===null||C===void 0?void 0:C.map(Pe=>a.Source.fromPartial(Pe)))||[],Fe.destinations=((q=u.destinations)===null||q===void 0?void 0:q.map(Pe=>a.Destination.fromPartial(Pe)))||[],Fe.composition=u.composition!==void 0&&u.composition!==null?a.Composition.fromPartial(u.composition):void 0,Fe.maxDuration=(fe=u.maxDuration)!==null&&fe!==void 0?fe:void 0,Fe.webrtc=u.webrtc!==void 0&&u.webrtc!==null?a.WebRtc.fromPartial(u.webrtc):void 0,Fe.triggers=((Ce=u.triggers)===null||Ce===void 0?void 0:Ce.map(Pe=>a.ProjectTrigger.fromPartial(Pe)))||[],Fe.location=u.location!==void 0&&u.location!==null?a.LatLong.fromPartial(u.location):void 0,Fe.guestCodes=((Je=u.guestCodes)===null||Je===void 0?void 0:Je.map(Pe=>a.GuestCode.fromPartial(Pe)))||[],Fe}};function Nt(){return{collectionId:"",metadata:void 0,projects:[],sources:[]}}a.Collection={encode(u,m=h.Writer.create()){u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.metadata!==void 0&&S.Value.encode(S.Value.wrap(u.metadata),m.uint32(18).fork()).ldelim();for(const g of u.projects)a.Project.encode(g,m.uint32(26).fork()).ldelim();for(const g of u.sources)a.Source.encode(g,m.uint32(34).fork()).ldelim();return m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Nt();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.metadata=S.Value.unwrap(S.Value.decode(g,g.uint32()));break;case 3:C.projects.push(a.Project.decode(g,g.uint32()));break;case 4:C.sources.push(a.Source.decode(g,g.uint32()));break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",metadata:Q(u==null?void 0:u.metadata)?u.metadata:void 0,projects:Array.isArray(u==null?void 0:u.projects)?u.projects.map(m=>a.Project.fromJSON(m)):[],sources:Array.isArray(u==null?void 0:u.sources)?u.sources.map(m=>a.Source.fromJSON(m)):[]}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.metadata!==void 0&&(m.metadata=u.metadata),u.projects?m.projects=u.projects.map(g=>g?a.Project.toJSON(g):void 0):m.projects=[],u.sources?m.sources=u.sources.map(g=>g?a.Source.toJSON(g):void 0):m.sources=[],m},fromPartial(u){var m,g,B,C;const q=Nt();return q.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",q.metadata=(g=u.metadata)!==null&&g!==void 0?g:void 0,q.projects=((B=u.projects)===null||B===void 0?void 0:B.map(fe=>a.Project.fromPartial(fe)))||[],q.sources=((C=u.sources)===null||C===void 0?void 0:C.map(fe=>a.Source.fromPartial(fe)))||[],q}};function At(){return{metadata:void 0}}a.CreateCollectionRequest={encode(u,m=h.Writer.create()){return u.metadata!==void 0&&S.Value.encode(S.Value.wrap(u.metadata),m.uint32(10).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=At();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.metadata=S.Value.unwrap(S.Value.decode(g,g.uint32()));break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{metadata:Q(u==null?void 0:u.metadata)?u.metadata:void 0}},toJSON(u){const m={};return u.metadata!==void 0&&(m.metadata=u.metadata),m},fromPartial(u){var m;const g=At();return g.metadata=(m=u.metadata)!==null&&m!==void 0?m:void 0,g}};function Lt(){return{collection:void 0}}a.CreateCollectionResponse={encode(u,m=h.Writer.create()){return u.collection!==void 0&&a.Collection.encode(u.collection,m.uint32(10).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Lt();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collection=a.Collection.decode(g,g.uint32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collection:Q(u.collection)?a.Collection.fromJSON(u.collection):void 0}},toJSON(u){const m={};return u.collection!==void 0&&(m.collection=u.collection?a.Collection.toJSON(u.collection):void 0),m},fromPartial(u){const m=Lt();return m.collection=u.collection!==void 0&&u.collection!==null?a.Collection.fromPartial(u.collection):void 0,m}};function Dt(){return{collectionId:"",populateProjects:void 0,populateSources:void 0}}a.GetCollectionRequest={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.populateProjects!==void 0&&m.uint32(16).bool(u.populateProjects),u.populateSources!==void 0&&m.uint32(24).bool(u.populateSources),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Dt();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.populateProjects=g.bool();break;case 3:C.populateSources=g.bool();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",populateProjects:Q(u.populateProjects)?Boolean(u.populateProjects):void 0,populateSources:Q(u.populateSources)?Boolean(u.populateSources):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.populateProjects!==void 0&&(m.populateProjects=u.populateProjects),u.populateSources!==void 0&&(m.populateSources=u.populateSources),m},fromPartial(u){var m,g,B;const C=Dt();return C.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",C.populateProjects=(g=u.populateProjects)!==null&&g!==void 0?g:void 0,C.populateSources=(B=u.populateSources)!==null&&B!==void 0?B:void 0,C}};function $t(){return{collection:void 0}}a.GetCollectionResponse={encode(u,m=h.Writer.create()){return u.collection!==void 0&&a.Collection.encode(u.collection,m.uint32(10).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=$t();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collection=a.Collection.decode(g,g.uint32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collection:Q(u.collection)?a.Collection.fromJSON(u.collection):void 0}},toJSON(u){const m={};return u.collection!==void 0&&(m.collection=u.collection?a.Collection.toJSON(u.collection):void 0),m},fromPartial(u){const m=$t();return m.collection=u.collection!==void 0&&u.collection!==null?a.Collection.fromPartial(u.collection):void 0,m}};function Mt(){return{collectionId:"",updateMask:void 0,metadata:void 0}}a.UpdateCollectionRequest={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.updateMask!==void 0&&b.FieldMask.encode(b.FieldMask.wrap(u.updateMask),m.uint32(18).fork()).ldelim(),u.metadata!==void 0&&S.Value.encode(S.Value.wrap(u.metadata),m.uint32(26).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Mt();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.updateMask=b.FieldMask.unwrap(b.FieldMask.decode(g,g.uint32()));break;case 3:C.metadata=S.Value.unwrap(S.Value.decode(g,g.uint32()));break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",updateMask:Q(u.updateMask)?b.FieldMask.unwrap(b.FieldMask.fromJSON(u.updateMask)):void 0,metadata:Q(u==null?void 0:u.metadata)?u.metadata:void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.updateMask!==void 0&&(m.updateMask=b.FieldMask.toJSON(b.FieldMask.wrap(u.updateMask))),u.metadata!==void 0&&(m.metadata=u.metadata),m},fromPartial(u){var m,g,B;const C=Mt();return C.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",C.updateMask=(g=u.updateMask)!==null&&g!==void 0?g:void 0,C.metadata=(B=u.metadata)!==null&&B!==void 0?B:void 0,C}};function Ut(){return{collection:void 0}}a.UpdateCollectionResponse={encode(u,m=h.Writer.create()){return u.collection!==void 0&&a.Collection.encode(u.collection,m.uint32(10).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Ut();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collection=a.Collection.decode(g,g.uint32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collection:Q(u.collection)?a.Collection.fromJSON(u.collection):void 0}},toJSON(u){const m={};return u.collection!==void 0&&(m.collection=u.collection?a.Collection.toJSON(u.collection):void 0),m},fromPartial(u){const m=Ut();return m.collection=u.collection!==void 0&&u.collection!==null?a.Collection.fromPartial(u.collection):void 0,m}};function Bt(){return{collectionId:"",force:void 0}}a.DeleteCollectionRequest={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.force!==void 0&&m.uint32(16).bool(u.force),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Bt();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.force=g.bool();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",force:Q(u.force)?Boolean(u.force):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.force!==void 0&&(m.force=u.force),m},fromPartial(u){var m,g;const B=Bt();return B.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",B.force=(g=u.force)!==null&&g!==void 0?g:void 0,B}};function Vt(){return{sourcesDeleted:0,projectsDeleted:0,projectIdsStopped:[]}}a.DeleteCollectionResponse={encode(u,m=h.Writer.create()){u.sourcesDeleted!==0&&m.uint32(8).uint32(u.sourcesDeleted),u.projectsDeleted!==0&&m.uint32(16).uint32(u.projectsDeleted);for(const g of u.projectIdsStopped)m.uint32(26).string(g);return m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Vt();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.sourcesDeleted=g.uint32();break;case 2:C.projectsDeleted=g.uint32();break;case 3:C.projectIdsStopped.push(g.string());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{sourcesDeleted:Q(u.sourcesDeleted)?Number(u.sourcesDeleted):0,projectsDeleted:Q(u.projectsDeleted)?Number(u.projectsDeleted):0,projectIdsStopped:Array.isArray(u==null?void 0:u.projectIdsStopped)?u.projectIdsStopped.map(m=>String(m)):[]}},toJSON(u){const m={};return u.sourcesDeleted!==void 0&&(m.sourcesDeleted=Math.round(u.sourcesDeleted)),u.projectsDeleted!==void 0&&(m.projectsDeleted=Math.round(u.projectsDeleted)),u.projectIdsStopped?m.projectIdsStopped=u.projectIdsStopped.map(g=>g):m.projectIdsStopped=[],m},fromPartial(u){var m,g,B;const C=Vt();return C.sourcesDeleted=(m=u.sourcesDeleted)!==null&&m!==void 0?m:0,C.projectsDeleted=(g=u.projectsDeleted)!==null&&g!==void 0?g:0,C.projectIdsStopped=((B=u.projectIdsStopped)===null||B===void 0?void 0:B.map(q=>q))||[],C}};function Ft(){return{}}a.GetCollectionsRequest={encode(u,m=h.Writer.create()){return m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Ft();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){default:g.skipType(q&7);break}}return C},fromJSON(u){return{}},toJSON(u){return{}},fromPartial(u){return Ft()}};function Jt(){return{collections:[]}}a.GetCollectionsResponse={encode(u,m=h.Writer.create()){for(const g of u.collections)a.Collection.encode(g,m.uint32(10).fork()).ldelim();return m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Jt();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collections.push(a.Collection.decode(g,g.uint32()));break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collections:Array.isArray(u==null?void 0:u.collections)?u.collections.map(m=>a.Collection.fromJSON(m)):[]}},toJSON(u){const m={};return u.collections?m.collections=u.collections.map(g=>g?a.Collection.toJSON(g):void 0):m.collections=[],m},fromPartial(u){var m;const g=Jt();return g.collections=((m=u.collections)===null||m===void 0?void 0:m.map(B=>a.Collection.fromPartial(B)))||[],g}};function qt(){return{collectionId:"",metadata:void 0,rendering:void 0,encoding:void 0,composition:void 0,maxDuration:void 0,webrtc:void 0,location:void 0}}a.CreateProjectRequest={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.metadata!==void 0&&S.Value.encode(S.Value.wrap(u.metadata),m.uint32(18).fork()).ldelim(),u.rendering!==void 0&&a.Rendering.encode(u.rendering,m.uint32(26).fork()).ldelim(),u.encoding!==void 0&&a.Encoding.encode(u.encoding,m.uint32(34).fork()).ldelim(),u.composition!==void 0&&a.Composition.encode(u.composition,m.uint32(42).fork()).ldelim(),u.maxDuration!==void 0&&m.uint32(48).uint32(u.maxDuration),u.webrtc!==void 0&&a.WebRtc.encode(u.webrtc,m.uint32(58).fork()).ldelim(),u.location!==void 0&&a.LatLong.encode(u.location,m.uint32(74).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=qt();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.metadata=S.Value.unwrap(S.Value.decode(g,g.uint32()));break;case 3:C.rendering=a.Rendering.decode(g,g.uint32());break;case 4:C.encoding=a.Encoding.decode(g,g.uint32());break;case 5:C.composition=a.Composition.decode(g,g.uint32());break;case 6:C.maxDuration=g.uint32();break;case 7:C.webrtc=a.WebRtc.decode(g,g.uint32());break;case 9:C.location=a.LatLong.decode(g,g.uint32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",metadata:Q(u==null?void 0:u.metadata)?u.metadata:void 0,rendering:Q(u.rendering)?a.Rendering.fromJSON(u.rendering):void 0,encoding:Q(u.encoding)?a.Encoding.fromJSON(u.encoding):void 0,composition:Q(u.composition)?a.Composition.fromJSON(u.composition):void 0,maxDuration:Q(u.maxDuration)?Number(u.maxDuration):void 0,webrtc:Q(u.webrtc)?a.WebRtc.fromJSON(u.webrtc):void 0,location:Q(u.location)?a.LatLong.fromJSON(u.location):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.metadata!==void 0&&(m.metadata=u.metadata),u.rendering!==void 0&&(m.rendering=u.rendering?a.Rendering.toJSON(u.rendering):void 0),u.encoding!==void 0&&(m.encoding=u.encoding?a.Encoding.toJSON(u.encoding):void 0),u.composition!==void 0&&(m.composition=u.composition?a.Composition.toJSON(u.composition):void 0),u.maxDuration!==void 0&&(m.maxDuration=Math.round(u.maxDuration)),u.webrtc!==void 0&&(m.webrtc=u.webrtc?a.WebRtc.toJSON(u.webrtc):void 0),u.location!==void 0&&(m.location=u.location?a.LatLong.toJSON(u.location):void 0),m},fromPartial(u){var m,g,B;const C=qt();return C.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",C.metadata=(g=u.metadata)!==null&&g!==void 0?g:void 0,C.rendering=u.rendering!==void 0&&u.rendering!==null?a.Rendering.fromPartial(u.rendering):void 0,C.encoding=u.encoding!==void 0&&u.encoding!==null?a.Encoding.fromPartial(u.encoding):void 0,C.composition=u.composition!==void 0&&u.composition!==null?a.Composition.fromPartial(u.composition):void 0,C.maxDuration=(B=u.maxDuration)!==null&&B!==void 0?B:void 0,C.webrtc=u.webrtc!==void 0&&u.webrtc!==null?a.WebRtc.fromPartial(u.webrtc):void 0,C.location=u.location!==void 0&&u.location!==null?a.LatLong.fromPartial(u.location):void 0,C}};function Gt(){return{project:void 0}}a.CreateProjectResponse={encode(u,m=h.Writer.create()){return u.project!==void 0&&a.Project.encode(u.project,m.uint32(10).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Gt();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.project=a.Project.decode(g,g.uint32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{project:Q(u.project)?a.Project.fromJSON(u.project):void 0}},toJSON(u){const m={};return u.project!==void 0&&(m.project=u.project?a.Project.toJSON(u.project):void 0),m},fromPartial(u){const m=Gt();return m.project=u.project!==void 0&&u.project!==null?a.Project.fromPartial(u.project):void 0,m}};function Wt(){return{collectionId:"",projectId:"",updateMask:void 0,metadata:void 0,rendering:void 0,encoding:void 0,composition:void 0,maxDuration:void 0,webrtc:void 0,location:void 0}}a.UpdateProjectRequest={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.updateMask!==void 0&&b.FieldMask.encode(b.FieldMask.wrap(u.updateMask),m.uint32(26).fork()).ldelim(),u.metadata!==void 0&&S.Value.encode(S.Value.wrap(u.metadata),m.uint32(34).fork()).ldelim(),u.rendering!==void 0&&a.Rendering.encode(u.rendering,m.uint32(42).fork()).ldelim(),u.encoding!==void 0&&a.Encoding.encode(u.encoding,m.uint32(50).fork()).ldelim(),u.composition!==void 0&&a.Composition.encode(u.composition,m.uint32(58).fork()).ldelim(),u.maxDuration!==void 0&&m.uint32(64).uint32(u.maxDuration),u.webrtc!==void 0&&a.WebRtc.encode(u.webrtc,m.uint32(74).fork()).ldelim(),u.location!==void 0&&a.LatLong.encode(u.location,m.uint32(82).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Wt();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.projectId=g.string();break;case 3:C.updateMask=b.FieldMask.unwrap(b.FieldMask.decode(g,g.uint32()));break;case 4:C.metadata=S.Value.unwrap(S.Value.decode(g,g.uint32()));break;case 5:C.rendering=a.Rendering.decode(g,g.uint32());break;case 6:C.encoding=a.Encoding.decode(g,g.uint32());break;case 7:C.composition=a.Composition.decode(g,g.uint32());break;case 8:C.maxDuration=g.uint32();break;case 9:C.webrtc=a.WebRtc.decode(g,g.uint32());break;case 10:C.location=a.LatLong.decode(g,g.uint32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",updateMask:Q(u.updateMask)?b.FieldMask.unwrap(b.FieldMask.fromJSON(u.updateMask)):void 0,metadata:Q(u==null?void 0:u.metadata)?u.metadata:void 0,rendering:Q(u.rendering)?a.Rendering.fromJSON(u.rendering):void 0,encoding:Q(u.encoding)?a.Encoding.fromJSON(u.encoding):void 0,composition:Q(u.composition)?a.Composition.fromJSON(u.composition):void 0,maxDuration:Q(u.maxDuration)?Number(u.maxDuration):void 0,webrtc:Q(u.webrtc)?a.WebRtc.fromJSON(u.webrtc):void 0,location:Q(u.location)?a.LatLong.fromJSON(u.location):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.updateMask!==void 0&&(m.updateMask=b.FieldMask.toJSON(b.FieldMask.wrap(u.updateMask))),u.metadata!==void 0&&(m.metadata=u.metadata),u.rendering!==void 0&&(m.rendering=u.rendering?a.Rendering.toJSON(u.rendering):void 0),u.encoding!==void 0&&(m.encoding=u.encoding?a.Encoding.toJSON(u.encoding):void 0),u.composition!==void 0&&(m.composition=u.composition?a.Composition.toJSON(u.composition):void 0),u.maxDuration!==void 0&&(m.maxDuration=Math.round(u.maxDuration)),u.webrtc!==void 0&&(m.webrtc=u.webrtc?a.WebRtc.toJSON(u.webrtc):void 0),u.location!==void 0&&(m.location=u.location?a.LatLong.toJSON(u.location):void 0),m},fromPartial(u){var m,g,B,C,q;const fe=Wt();return fe.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",fe.projectId=(g=u.projectId)!==null&&g!==void 0?g:"",fe.updateMask=(B=u.updateMask)!==null&&B!==void 0?B:void 0,fe.metadata=(C=u.metadata)!==null&&C!==void 0?C:void 0,fe.rendering=u.rendering!==void 0&&u.rendering!==null?a.Rendering.fromPartial(u.rendering):void 0,fe.encoding=u.encoding!==void 0&&u.encoding!==null?a.Encoding.fromPartial(u.encoding):void 0,fe.composition=u.composition!==void 0&&u.composition!==null?a.Composition.fromPartial(u.composition):void 0,fe.maxDuration=(q=u.maxDuration)!==null&&q!==void 0?q:void 0,fe.webrtc=u.webrtc!==void 0&&u.webrtc!==null?a.WebRtc.fromPartial(u.webrtc):void 0,fe.location=u.location!==void 0&&u.location!==null?a.LatLong.fromPartial(u.location):void 0,fe}};function xt(){return{project:void 0,broadcastUpdated:!1}}a.UpdateProjectResponse={encode(u,m=h.Writer.create()){return u.project!==void 0&&a.Project.encode(u.project,m.uint32(10).fork()).ldelim(),u.broadcastUpdated===!0&&m.uint32(16).bool(u.broadcastUpdated),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=xt();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.project=a.Project.decode(g,g.uint32());break;case 2:C.broadcastUpdated=g.bool();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{project:Q(u.project)?a.Project.fromJSON(u.project):void 0,broadcastUpdated:Q(u.broadcastUpdated)?Boolean(u.broadcastUpdated):!1}},toJSON(u){const m={};return u.project!==void 0&&(m.project=u.project?a.Project.toJSON(u.project):void 0),u.broadcastUpdated!==void 0&&(m.broadcastUpdated=u.broadcastUpdated),m},fromPartial(u){var m;const g=xt();return g.project=u.project!==void 0&&u.project!==null?a.Project.fromPartial(u.project):void 0,g.broadcastUpdated=(m=u.broadcastUpdated)!==null&&m!==void 0?m:!1,g}};function Ht(){return{collectionId:"",projectId:"",force:void 0}}a.DeleteProjectRequest={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.force!==void 0&&m.uint32(24).bool(u.force),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Ht();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.projectId=g.string();break;case 3:C.force=g.bool();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",force:Q(u.force)?Boolean(u.force):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.force!==void 0&&(m.force=u.force),m},fromPartial(u){var m,g,B;const C=Ht();return C.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",C.projectId=(g=u.projectId)!==null&&g!==void 0?g:"",C.force=(B=u.force)!==null&&B!==void 0?B:void 0,C}};function zt(){return{broadcastStopped:!1,layoutsDeleted:0}}a.DeleteProjectResponse={encode(u,m=h.Writer.create()){return u.broadcastStopped===!0&&m.uint32(8).bool(u.broadcastStopped),u.layoutsDeleted!==0&&m.uint32(16).uint32(u.layoutsDeleted),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=zt();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.broadcastStopped=g.bool();break;case 2:C.layoutsDeleted=g.uint32();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{broadcastStopped:Q(u.broadcastStopped)?Boolean(u.broadcastStopped):!1,layoutsDeleted:Q(u.layoutsDeleted)?Number(u.layoutsDeleted):0}},toJSON(u){const m={};return u.broadcastStopped!==void 0&&(m.broadcastStopped=u.broadcastStopped),u.layoutsDeleted!==void 0&&(m.layoutsDeleted=Math.round(u.layoutsDeleted)),m},fromPartial(u){var m,g;const B=zt();return B.broadcastStopped=(m=u.broadcastStopped)!==null&&m!==void 0?m:!1,B.layoutsDeleted=(g=u.layoutsDeleted)!==null&&g!==void 0?g:0,B}};function Yt(){return{collectionId:"",projectId:"",webrtcStart:void 0}}a.StartProjectBroadcastRequest={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.webrtcStart!==void 0&&m.uint32(24).bool(u.webrtcStart),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Yt();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.projectId=g.string();break;case 3:C.webrtcStart=g.bool();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",webrtcStart:Q(u.webrtcStart)?Boolean(u.webrtcStart):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.webrtcStart!==void 0&&(m.webrtcStart=u.webrtcStart),m},fromPartial(u){var m,g,B;const C=Yt();return C.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",C.projectId=(g=u.projectId)!==null&&g!==void 0?g:"",C.webrtcStart=(B=u.webrtcStart)!==null&&B!==void 0?B:void 0,C}};function Kt(){return{broadcastId:""}}a.StartProjectBroadcastResponse={encode(u,m=h.Writer.create()){return u.broadcastId!==""&&m.uint32(10).string(u.broadcastId),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Kt();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.broadcastId=g.string();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{broadcastId:Q(u.broadcastId)?String(u.broadcastId):""}},toJSON(u){const m={};return u.broadcastId!==void 0&&(m.broadcastId=u.broadcastId),m},fromPartial(u){var m;const g=Kt();return g.broadcastId=(m=u.broadcastId)!==null&&m!==void 0?m:"",g}};function Qt(){return{collectionId:"",projectId:"",webrtcStop:void 0}}a.StopProjectBroadcastRequest={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.webrtcStop!==void 0&&m.uint32(24).bool(u.webrtcStop),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Qt();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.projectId=g.string();break;case 3:C.webrtcStop=g.bool();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",webrtcStop:Q(u.webrtcStop)?Boolean(u.webrtcStop):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.webrtcStop!==void 0&&(m.webrtcStop=u.webrtcStop),m},fromPartial(u){var m,g,B;const C=Qt();return C.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",C.projectId=(g=u.projectId)!==null&&g!==void 0?g:"",C.webrtcStop=(B=u.webrtcStop)!==null&&B!==void 0?B:void 0,C}};function Zt(){return{}}a.StopProjectBroadcastResponse={encode(u,m=h.Writer.create()){return m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Zt();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){default:g.skipType(q&7);break}}return C},fromJSON(u){return{}},toJSON(u){return{}},fromPartial(u){return Zt()}};function jt(){return{collectionId:"",projectId:"",status:void 0}}a.GetProjectRequest={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.status!==void 0&&m.uint32(24).bool(u.status),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=jt();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.projectId=g.string();break;case 3:C.status=g.bool();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",status:Q(u.status)?Boolean(u.status):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.status!==void 0&&(m.status=u.status),m},fromPartial(u){var m,g,B;const C=jt();return C.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",C.projectId=(g=u.projectId)!==null&&g!==void 0?g:"",C.status=(B=u.status)!==null&&B!==void 0?B:void 0,C}};function Xt(){return{project:void 0,status:void 0}}a.GetProjectResponse={encode(u,m=h.Writer.create()){return u.project!==void 0&&a.Project.encode(u.project,m.uint32(10).fork()).ldelim(),u.status!==void 0&&a.ProjectBroadcastStatus.encode(u.status,m.uint32(18).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Xt();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.project=a.Project.decode(g,g.uint32());break;case 2:C.status=a.ProjectBroadcastStatus.decode(g,g.uint32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{project:Q(u.project)?a.Project.fromJSON(u.project):void 0,status:Q(u.status)?a.ProjectBroadcastStatus.fromJSON(u.status):void 0}},toJSON(u){const m={};return u.project!==void 0&&(m.project=u.project?a.Project.toJSON(u.project):void 0),u.status!==void 0&&(m.status=u.status?a.ProjectBroadcastStatus.toJSON(u.status):void 0),m},fromPartial(u){const m=Xt();return m.project=u.project!==void 0&&u.project!==null?a.Project.fromPartial(u.project):void 0,m.status=u.status!==void 0&&u.status!==null?a.ProjectBroadcastStatus.fromPartial(u.status):void 0,m}};function en(){return{collectionId:"",projectId:"",format:void 0}}a.GetProjectBroadcastSnapshotRequest={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.format!==void 0&&m.uint32(24).int32(k(u.format)),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=en();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.projectId=g.string();break;case 3:C.format=I(g.int32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",format:Q(u.format)?I(u.format):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.format!==void 0&&(m.format=u.format!==void 0?T(u.format):void 0),m},fromPartial(u){var m,g,B;const C=en();return C.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",C.projectId=(g=u.projectId)!==null&&g!==void 0?g:"",C.format=(B=u.format)!==null&&B!==void 0?B:void 0,C}};function tn(){return{format:_.IMAGE_FORMAT_UNSPECIFIED,image:new Uint8Array}}a.GetProjectBroadcastSnapshotResponse={encode(u,m=h.Writer.create()){return u.format!==_.IMAGE_FORMAT_UNSPECIFIED&&m.uint32(8).int32(k(u.format)),u.image.length!==0&&m.uint32(18).bytes(u.image),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=tn();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.format=I(g.int32());break;case 2:C.image=g.bytes();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{format:Q(u.format)?I(u.format):_.IMAGE_FORMAT_UNSPECIFIED,image:Q(u.image)?Or(u.image):new Uint8Array}},toJSON(u){const m={};return u.format!==void 0&&(m.format=T(u.format)),u.image!==void 0&&(m.image=Nr(u.image!==void 0?u.image:new Uint8Array)),m},fromPartial(u){var m,g;const B=tn();return B.format=(m=u.format)!==null&&m!==void 0?m:_.IMAGE_FORMAT_UNSPECIFIED,B.image=(g=u.image)!==null&&g!==void 0?g:new Uint8Array,B}};function nn(){return{collectionId:"",projectId:""}}a.GetProjectBroadcastStatusRequest={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=nn();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.projectId=g.string();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):""}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),m},fromPartial(u){var m,g;const B=nn();return B.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",B.projectId=(g=u.projectId)!==null&&g!==void 0?g:"",B}};function rn(){return{status:void 0}}a.GetProjectBroadcastStatusResponse={encode(u,m=h.Writer.create()){return u.status!==void 0&&a.ProjectBroadcastStatus.encode(u.status,m.uint32(10).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=rn();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.status=a.ProjectBroadcastStatus.decode(g,g.uint32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{status:Q(u.status)?a.ProjectBroadcastStatus.fromJSON(u.status):void 0}},toJSON(u){const m={};return u.status!==void 0&&(m.status=u.status?a.ProjectBroadcastStatus.toJSON(u.status):void 0),m},fromPartial(u){const m=rn();return m.status=u.status!==void 0&&u.status!==null?a.ProjectBroadcastStatus.fromPartial(u.status):void 0,m}};function an(){return{collectionId:"",projectId:""}}a.StartProjectWebRtcRequest={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=an();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.projectId=g.string();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):""}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),m},fromPartial(u){var m,g;const B=an();return B.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",B.projectId=(g=u.projectId)!==null&&g!==void 0?g:"",B}};function sn(){return{}}a.StartProjectWebRtcResponse={encode(u,m=h.Writer.create()){return m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=sn();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){default:g.skipType(q&7);break}}return C},fromJSON(u){return{}},toJSON(u){return{}},fromPartial(u){return sn()}};function dn(){return{collectionId:"",projectId:""}}a.StopProjectWebRtcRequest={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=dn();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.projectId=g.string();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):""}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),m},fromPartial(u){var m,g;const B=dn();return B.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",B.projectId=(g=u.projectId)!==null&&g!==void 0?g:"",B}};function cn(){return{}}a.StopProjectWebRtcResponse={encode(u,m=h.Writer.create()){return m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=cn();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){default:g.skipType(q&7);break}}return C},fromJSON(u){return{}},toJSON(u){return{}},fromPartial(u){return cn()}};function un(){return{collectionId:"",projectId:"",metadata:void 0,address:void 0,enabled:void 0,timeout:void 0}}a.CreateDestinationRequest={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.metadata!==void 0&&S.Value.encode(S.Value.wrap(u.metadata),m.uint32(26).fork()).ldelim(),u.address!==void 0&&a.DestinationAddress.encode(u.address,m.uint32(42).fork()).ldelim(),u.enabled!==void 0&&m.uint32(48).bool(u.enabled),u.timeout!==void 0&&m.uint32(56).uint32(u.timeout),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=un();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.projectId=g.string();break;case 3:C.metadata=S.Value.unwrap(S.Value.decode(g,g.uint32()));break;case 5:C.address=a.DestinationAddress.decode(g,g.uint32());break;case 6:C.enabled=g.bool();break;case 7:C.timeout=g.uint32();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",metadata:Q(u==null?void 0:u.metadata)?u.metadata:void 0,address:Q(u.address)?a.DestinationAddress.fromJSON(u.address):void 0,enabled:Q(u.enabled)?Boolean(u.enabled):void 0,timeout:Q(u.timeout)?Number(u.timeout):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.metadata!==void 0&&(m.metadata=u.metadata),u.address!==void 0&&(m.address=u.address?a.DestinationAddress.toJSON(u.address):void 0),u.enabled!==void 0&&(m.enabled=u.enabled),u.timeout!==void 0&&(m.timeout=Math.round(u.timeout)),m},fromPartial(u){var m,g,B,C,q;const fe=un();return fe.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",fe.projectId=(g=u.projectId)!==null&&g!==void 0?g:"",fe.metadata=(B=u.metadata)!==null&&B!==void 0?B:void 0,fe.address=u.address!==void 0&&u.address!==null?a.DestinationAddress.fromPartial(u.address):void 0,fe.enabled=(C=u.enabled)!==null&&C!==void 0?C:void 0,fe.timeout=(q=u.timeout)!==null&&q!==void 0?q:void 0,fe}};function ln(){return{destination:void 0}}a.CreateDestinationResponse={encode(u,m=h.Writer.create()){return u.destination!==void 0&&a.Destination.encode(u.destination,m.uint32(10).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=ln();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.destination=a.Destination.decode(g,g.uint32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{destination:Q(u.destination)?a.Destination.fromJSON(u.destination):void 0}},toJSON(u){const m={};return u.destination!==void 0&&(m.destination=u.destination?a.Destination.toJSON(u.destination):void 0),m},fromPartial(u){const m=ln();return m.destination=u.destination!==void 0&&u.destination!==null?a.Destination.fromPartial(u.destination):void 0,m}};function fn(){return{collectionId:"",projectId:"",destinationId:""}}a.GetDestinationRequest={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.destinationId!==""&&m.uint32(26).string(u.destinationId),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=fn();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.projectId=g.string();break;case 3:C.destinationId=g.string();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",destinationId:Q(u.destinationId)?String(u.destinationId):""}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.destinationId!==void 0&&(m.destinationId=u.destinationId),m},fromPartial(u){var m,g,B;const C=fn();return C.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",C.projectId=(g=u.projectId)!==null&&g!==void 0?g:"",C.destinationId=(B=u.destinationId)!==null&&B!==void 0?B:"",C}};function pn(){return{destination:void 0}}a.GetDestinationResponse={encode(u,m=h.Writer.create()){return u.destination!==void 0&&a.Destination.encode(u.destination,m.uint32(10).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=pn();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.destination=a.Destination.decode(g,g.uint32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{destination:Q(u.destination)?a.Destination.fromJSON(u.destination):void 0}},toJSON(u){const m={};return u.destination!==void 0&&(m.destination=u.destination?a.Destination.toJSON(u.destination):void 0),m},fromPartial(u){const m=pn();return m.destination=u.destination!==void 0&&u.destination!==null?a.Destination.fromPartial(u.destination):void 0,m}};function hn(){return{collectionId:"",projectId:"",destinationId:"",force:void 0}}a.DeleteDestinationRequest={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.destinationId!==""&&m.uint32(26).string(u.destinationId),u.force!==void 0&&m.uint32(32).bool(u.force),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=hn();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.projectId=g.string();break;case 3:C.destinationId=g.string();break;case 4:C.force=g.bool();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",destinationId:Q(u.destinationId)?String(u.destinationId):"",force:Q(u.force)?Boolean(u.force):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.destinationId!==void 0&&(m.destinationId=u.destinationId),u.force!==void 0&&(m.force=u.force),m},fromPartial(u){var m,g,B,C;const q=hn();return q.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",q.projectId=(g=u.projectId)!==null&&g!==void 0?g:"",q.destinationId=(B=u.destinationId)!==null&&B!==void 0?B:"",q.force=(C=u.force)!==null&&C!==void 0?C:void 0,q}};function mn(){return{broadcastUpdated:!1}}a.DeleteDestinationResponse={encode(u,m=h.Writer.create()){return u.broadcastUpdated===!0&&m.uint32(8).bool(u.broadcastUpdated),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=mn();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.broadcastUpdated=g.bool();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{broadcastUpdated:Q(u.broadcastUpdated)?Boolean(u.broadcastUpdated):!1}},toJSON(u){const m={};return u.broadcastUpdated!==void 0&&(m.broadcastUpdated=u.broadcastUpdated),m},fromPartial(u){var m;const g=mn();return g.broadcastUpdated=(m=u.broadcastUpdated)!==null&&m!==void 0?m:!1,g}};function vn(){return{collectionId:"",projectId:"",destinationId:"",updateMask:void 0,metadata:void 0,address:void 0,enabled:void 0,timeout:void 0}}a.UpdateDestinationRequest={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.destinationId!==""&&m.uint32(26).string(u.destinationId),u.updateMask!==void 0&&b.FieldMask.encode(b.FieldMask.wrap(u.updateMask),m.uint32(34).fork()).ldelim(),u.metadata!==void 0&&S.Value.encode(S.Value.wrap(u.metadata),m.uint32(42).fork()).ldelim(),u.address!==void 0&&a.DestinationAddress.encode(u.address,m.uint32(50).fork()).ldelim(),u.enabled!==void 0&&m.uint32(56).bool(u.enabled),u.timeout!==void 0&&m.uint32(64).uint32(u.timeout),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=vn();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.projectId=g.string();break;case 3:C.destinationId=g.string();break;case 4:C.updateMask=b.FieldMask.unwrap(b.FieldMask.decode(g,g.uint32()));break;case 5:C.metadata=S.Value.unwrap(S.Value.decode(g,g.uint32()));break;case 6:C.address=a.DestinationAddress.decode(g,g.uint32());break;case 7:C.enabled=g.bool();break;case 8:C.timeout=g.uint32();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",destinationId:Q(u.destinationId)?String(u.destinationId):"",updateMask:Q(u.updateMask)?b.FieldMask.unwrap(b.FieldMask.fromJSON(u.updateMask)):void 0,metadata:Q(u==null?void 0:u.metadata)?u.metadata:void 0,address:Q(u.address)?a.DestinationAddress.fromJSON(u.address):void 0,enabled:Q(u.enabled)?Boolean(u.enabled):void 0,timeout:Q(u.timeout)?Number(u.timeout):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.destinationId!==void 0&&(m.destinationId=u.destinationId),u.updateMask!==void 0&&(m.updateMask=b.FieldMask.toJSON(b.FieldMask.wrap(u.updateMask))),u.metadata!==void 0&&(m.metadata=u.metadata),u.address!==void 0&&(m.address=u.address?a.DestinationAddress.toJSON(u.address):void 0),u.enabled!==void 0&&(m.enabled=u.enabled),u.timeout!==void 0&&(m.timeout=Math.round(u.timeout)),m},fromPartial(u){var m,g,B,C,q,fe,Ce;const Je=vn();return Je.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",Je.projectId=(g=u.projectId)!==null&&g!==void 0?g:"",Je.destinationId=(B=u.destinationId)!==null&&B!==void 0?B:"",Je.updateMask=(C=u.updateMask)!==null&&C!==void 0?C:void 0,Je.metadata=(q=u.metadata)!==null&&q!==void 0?q:void 0,Je.address=u.address!==void 0&&u.address!==null?a.DestinationAddress.fromPartial(u.address):void 0,Je.enabled=(fe=u.enabled)!==null&&fe!==void 0?fe:void 0,Je.timeout=(Ce=u.timeout)!==null&&Ce!==void 0?Ce:void 0,Je}};function gn(){return{destination:void 0,broadcastUpdated:!1}}a.UpdateDestinationResponse={encode(u,m=h.Writer.create()){return u.destination!==void 0&&a.Destination.encode(u.destination,m.uint32(10).fork()).ldelim(),u.broadcastUpdated===!0&&m.uint32(16).bool(u.broadcastUpdated),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=gn();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.destination=a.Destination.decode(g,g.uint32());break;case 2:C.broadcastUpdated=g.bool();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{destination:Q(u.destination)?a.Destination.fromJSON(u.destination):void 0,broadcastUpdated:Q(u.broadcastUpdated)?Boolean(u.broadcastUpdated):!1}},toJSON(u){const m={};return u.destination!==void 0&&(m.destination=u.destination?a.Destination.toJSON(u.destination):void 0),u.broadcastUpdated!==void 0&&(m.broadcastUpdated=u.broadcastUpdated),m},fromPartial(u){var m;const g=gn();return g.destination=u.destination!==void 0&&u.destination!==null?a.Destination.fromPartial(u.destination):void 0,g.broadcastUpdated=(m=u.broadcastUpdated)!==null&&m!==void 0?m:!1,g}};function Sn(){return{collectionId:"",metadata:void 0,address:void 0,preview:void 0}}a.CreateSourceRequest={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.metadata!==void 0&&S.Value.encode(S.Value.wrap(u.metadata),m.uint32(18).fork()).ldelim(),u.address!==void 0&&a.SourceAddress.encode(u.address,m.uint32(26).fork()).ldelim(),u.preview!==void 0&&a.PreviewAddress.encode(u.preview,m.uint32(34).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Sn();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.metadata=S.Value.unwrap(S.Value.decode(g,g.uint32()));break;case 3:C.address=a.SourceAddress.decode(g,g.uint32());break;case 4:C.preview=a.PreviewAddress.decode(g,g.uint32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",metadata:Q(u==null?void 0:u.metadata)?u.metadata:void 0,address:Q(u.address)?a.SourceAddress.fromJSON(u.address):void 0,preview:Q(u.preview)?a.PreviewAddress.fromJSON(u.preview):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.metadata!==void 0&&(m.metadata=u.metadata),u.address!==void 0&&(m.address=u.address?a.SourceAddress.toJSON(u.address):void 0),u.preview!==void 0&&(m.preview=u.preview?a.PreviewAddress.toJSON(u.preview):void 0),m},fromPartial(u){var m,g;const B=Sn();return B.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",B.metadata=(g=u.metadata)!==null&&g!==void 0?g:void 0,B.address=u.address!==void 0&&u.address!==null?a.SourceAddress.fromPartial(u.address):void 0,B.preview=u.preview!==void 0&&u.preview!==null?a.PreviewAddress.fromPartial(u.preview):void 0,B}};function yn(){return{source:void 0}}a.CreateSourceResponse={encode(u,m=h.Writer.create()){return u.source!==void 0&&a.Source.encode(u.source,m.uint32(10).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=yn();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.source=a.Source.decode(g,g.uint32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{source:Q(u.source)?a.Source.fromJSON(u.source):void 0}},toJSON(u){const m={};return u.source!==void 0&&(m.source=u.source?a.Source.toJSON(u.source):void 0),m},fromPartial(u){const m=yn();return m.source=u.source!==void 0&&u.source!==null?a.Source.fromPartial(u.source):void 0,m}};function bn(){return{collectionId:"",sourceId:"",force:void 0}}a.DeleteSourceRequest={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.sourceId!==""&&m.uint32(18).string(u.sourceId),u.force!==void 0&&m.uint32(24).bool(u.force),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=bn();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.sourceId=g.string();break;case 3:C.force=g.bool();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",sourceId:Q(u.sourceId)?String(u.sourceId):"",force:Q(u.force)?Boolean(u.force):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.sourceId!==void 0&&(m.sourceId=u.sourceId),u.force!==void 0&&(m.force=u.force),m},fromPartial(u){var m,g,B;const C=bn();return C.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",C.sourceId=(g=u.sourceId)!==null&&g!==void 0?g:"",C.force=(B=u.force)!==null&&B!==void 0?B:void 0,C}};function _n(){return{projectIdsUpdated:[]}}a.DeleteSourceResponse={encode(u,m=h.Writer.create()){for(const g of u.projectIdsUpdated)m.uint32(26).string(g);return m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=_n();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 3:C.projectIdsUpdated.push(g.string());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{projectIdsUpdated:Array.isArray(u==null?void 0:u.projectIdsUpdated)?u.projectIdsUpdated.map(m=>String(m)):[]}},toJSON(u){const m={};return u.projectIdsUpdated?m.projectIdsUpdated=u.projectIdsUpdated.map(g=>g):m.projectIdsUpdated=[],m},fromPartial(u){var m;const g=_n();return g.projectIdsUpdated=((m=u.projectIdsUpdated)===null||m===void 0?void 0:m.map(B=>B))||[],g}};function En(){return{collectionId:"",projectId:"",sourceId:"",trigger:void 0}}a.AddSourceToProjectRequest={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.sourceId!==""&&m.uint32(26).string(u.sourceId),u.trigger!==void 0&&a.SourceTrigger.encode(u.trigger,m.uint32(34).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=En();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.projectId=g.string();break;case 3:C.sourceId=g.string();break;case 4:C.trigger=a.SourceTrigger.decode(g,g.uint32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",sourceId:Q(u.sourceId)?String(u.sourceId):"",trigger:Q(u.trigger)?a.SourceTrigger.fromJSON(u.trigger):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.sourceId!==void 0&&(m.sourceId=u.sourceId),u.trigger!==void 0&&(m.trigger=u.trigger?a.SourceTrigger.toJSON(u.trigger):void 0),m},fromPartial(u){var m,g,B;const C=En();return C.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",C.projectId=(g=u.projectId)!==null&&g!==void 0?g:"",C.sourceId=(B=u.sourceId)!==null&&B!==void 0?B:"",C.trigger=u.trigger!==void 0&&u.trigger!==null?a.SourceTrigger.fromPartial(u.trigger):void 0,C}};function Tn(){return{project:void 0,broadcastUpdated:!1}}a.AddSourceToProjectResponse={encode(u,m=h.Writer.create()){return u.project!==void 0&&a.Project.encode(u.project,m.uint32(10).fork()).ldelim(),u.broadcastUpdated===!0&&m.uint32(16).bool(u.broadcastUpdated),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Tn();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.project=a.Project.decode(g,g.uint32());break;case 2:C.broadcastUpdated=g.bool();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{project:Q(u.project)?a.Project.fromJSON(u.project):void 0,broadcastUpdated:Q(u.broadcastUpdated)?Boolean(u.broadcastUpdated):!1}},toJSON(u){const m={};return u.project!==void 0&&(m.project=u.project?a.Project.toJSON(u.project):void 0),u.broadcastUpdated!==void 0&&(m.broadcastUpdated=u.broadcastUpdated),m},fromPartial(u){var m;const g=Tn();return g.project=u.project!==void 0&&u.project!==null?a.Project.fromPartial(u.project):void 0,g.broadcastUpdated=(m=u.broadcastUpdated)!==null&&m!==void 0?m:!1,g}};function In(){return{collectionId:"",projectId:"",sourceId:"",updateMask:void 0,trigger:void 0}}a.UpdateSourceInProjectRequest={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.sourceId!==""&&m.uint32(26).string(u.sourceId),u.updateMask!==void 0&&b.FieldMask.encode(b.FieldMask.wrap(u.updateMask),m.uint32(34).fork()).ldelim(),u.trigger!==void 0&&a.SourceTrigger.encode(u.trigger,m.uint32(42).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=In();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.projectId=g.string();break;case 3:C.sourceId=g.string();break;case 4:C.updateMask=b.FieldMask.unwrap(b.FieldMask.decode(g,g.uint32()));break;case 5:C.trigger=a.SourceTrigger.decode(g,g.uint32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",sourceId:Q(u.sourceId)?String(u.sourceId):"",updateMask:Q(u.updateMask)?b.FieldMask.unwrap(b.FieldMask.fromJSON(u.updateMask)):void 0,trigger:Q(u.trigger)?a.SourceTrigger.fromJSON(u.trigger):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.sourceId!==void 0&&(m.sourceId=u.sourceId),u.updateMask!==void 0&&(m.updateMask=b.FieldMask.toJSON(b.FieldMask.wrap(u.updateMask))),u.trigger!==void 0&&(m.trigger=u.trigger?a.SourceTrigger.toJSON(u.trigger):void 0),m},fromPartial(u){var m,g,B,C;const q=In();return q.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",q.projectId=(g=u.projectId)!==null&&g!==void 0?g:"",q.sourceId=(B=u.sourceId)!==null&&B!==void 0?B:"",q.updateMask=(C=u.updateMask)!==null&&C!==void 0?C:void 0,q.trigger=u.trigger!==void 0&&u.trigger!==null?a.SourceTrigger.fromPartial(u.trigger):void 0,q}};function Cn(){return{project:void 0}}a.UpdateSourceInProjectResponse={encode(u,m=h.Writer.create()){return u.project!==void 0&&a.Project.encode(u.project,m.uint32(10).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Cn();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.project=a.Project.decode(g,g.uint32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{project:Q(u.project)?a.Project.fromJSON(u.project):void 0}},toJSON(u){const m={};return u.project!==void 0&&(m.project=u.project?a.Project.toJSON(u.project):void 0),m},fromPartial(u){const m=Cn();return m.project=u.project!==void 0&&u.project!==null?a.Project.fromPartial(u.project):void 0,m}};function Rn(){return{collectionId:"",sourceId:""}}a.GetSourceRequest={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.sourceId!==""&&m.uint32(26).string(u.sourceId),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Rn();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 3:C.sourceId=g.string();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",sourceId:Q(u.sourceId)?String(u.sourceId):""}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.sourceId!==void 0&&(m.sourceId=u.sourceId),m},fromPartial(u){var m,g;const B=Rn();return B.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",B.sourceId=(g=u.sourceId)!==null&&g!==void 0?g:"",B}};function kn(){return{source:void 0}}a.GetSourceResponse={encode(u,m=h.Writer.create()){return u.source!==void 0&&a.Source.encode(u.source,m.uint32(10).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=kn();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.source=a.Source.decode(g,g.uint32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{source:Q(u.source)?a.Source.fromJSON(u.source):void 0}},toJSON(u){const m={};return u.source!==void 0&&(m.source=u.source?a.Source.toJSON(u.source):void 0),m},fromPartial(u){const m=kn();return m.source=u.source!==void 0&&u.source!==null?a.Source.fromPartial(u.source):void 0,m}};function Pn(){return{collectionId:""}}a.GetSourcesRequest={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Pn();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):""}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),m},fromPartial(u){var m;const g=Pn();return g.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",g}};function On(){return{sources:[]}}a.GetSourcesResponse={encode(u,m=h.Writer.create()){for(const g of u.sources)a.Source.encode(g,m.uint32(10).fork()).ldelim();return m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=On();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.sources.push(a.Source.decode(g,g.uint32()));break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{sources:Array.isArray(u==null?void 0:u.sources)?u.sources.map(m=>a.Source.fromJSON(m)):[]}},toJSON(u){const m={};return u.sources?m.sources=u.sources.map(g=>g?a.Source.toJSON(g):void 0):m.sources=[],m},fromPartial(u){var m;const g=On();return g.sources=((m=u.sources)===null||m===void 0?void 0:m.map(B=>a.Source.fromPartial(B)))||[],g}};function wn(){return{collectionId:"",sourceId:"",updateMask:void 0,metadata:void 0,address:void 0,preview:void 0}}a.UpdateSourceRequest={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.sourceId!==""&&m.uint32(26).string(u.sourceId),u.updateMask!==void 0&&b.FieldMask.encode(b.FieldMask.wrap(u.updateMask),m.uint32(34).fork()).ldelim(),u.metadata!==void 0&&S.Value.encode(S.Value.wrap(u.metadata),m.uint32(42).fork()).ldelim(),u.address!==void 0&&a.SourceAddress.encode(u.address,m.uint32(50).fork()).ldelim(),u.preview!==void 0&&a.PreviewAddress.encode(u.preview,m.uint32(58).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=wn();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 3:C.sourceId=g.string();break;case 4:C.updateMask=b.FieldMask.unwrap(b.FieldMask.decode(g,g.uint32()));break;case 5:C.metadata=S.Value.unwrap(S.Value.decode(g,g.uint32()));break;case 6:C.address=a.SourceAddress.decode(g,g.uint32());break;case 7:C.preview=a.PreviewAddress.decode(g,g.uint32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",sourceId:Q(u.sourceId)?String(u.sourceId):"",updateMask:Q(u.updateMask)?b.FieldMask.unwrap(b.FieldMask.fromJSON(u.updateMask)):void 0,metadata:Q(u==null?void 0:u.metadata)?u.metadata:void 0,address:Q(u.address)?a.SourceAddress.fromJSON(u.address):void 0,preview:Q(u.preview)?a.PreviewAddress.fromJSON(u.preview):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.sourceId!==void 0&&(m.sourceId=u.sourceId),u.updateMask!==void 0&&(m.updateMask=b.FieldMask.toJSON(b.FieldMask.wrap(u.updateMask))),u.metadata!==void 0&&(m.metadata=u.metadata),u.address!==void 0&&(m.address=u.address?a.SourceAddress.toJSON(u.address):void 0),u.preview!==void 0&&(m.preview=u.preview?a.PreviewAddress.toJSON(u.preview):void 0),m},fromPartial(u){var m,g,B,C;const q=wn();return q.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",q.sourceId=(g=u.sourceId)!==null&&g!==void 0?g:"",q.updateMask=(B=u.updateMask)!==null&&B!==void 0?B:void 0,q.metadata=(C=u.metadata)!==null&&C!==void 0?C:void 0,q.address=u.address!==void 0&&u.address!==null?a.SourceAddress.fromPartial(u.address):void 0,q.preview=u.preview!==void 0&&u.preview!==null?a.PreviewAddress.fromPartial(u.preview):void 0,q}};function Nn(){return{source:void 0,broadcastUpdated:!1}}a.UpdateSourceResponse={encode(u,m=h.Writer.create()){return u.source!==void 0&&a.Source.encode(u.source,m.uint32(10).fork()).ldelim(),u.broadcastUpdated===!0&&m.uint32(16).bool(u.broadcastUpdated),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Nn();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.source=a.Source.decode(g,g.uint32());break;case 2:C.broadcastUpdated=g.bool();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{source:Q(u.source)?a.Source.fromJSON(u.source):void 0,broadcastUpdated:Q(u.broadcastUpdated)?Boolean(u.broadcastUpdated):!1}},toJSON(u){const m={};return u.source!==void 0&&(m.source=u.source?a.Source.toJSON(u.source):void 0),u.broadcastUpdated!==void 0&&(m.broadcastUpdated=u.broadcastUpdated),m},fromPartial(u){var m;const g=Nn();return g.source=u.source!==void 0&&u.source!==null?a.Source.fromPartial(u.source):void 0,g.broadcastUpdated=(m=u.broadcastUpdated)!==null&&m!==void 0?m:!1,g}};function An(){return{collectionId:"",projectId:"",sourceId:"",force:void 0}}a.RemoveSourceFromProjectRequest={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.sourceId!==""&&m.uint32(26).string(u.sourceId),u.force!==void 0&&m.uint32(32).bool(u.force),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=An();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.projectId=g.string();break;case 3:C.sourceId=g.string();break;case 4:C.force=g.bool();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",sourceId:Q(u.sourceId)?String(u.sourceId):"",force:Q(u.force)?Boolean(u.force):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.sourceId!==void 0&&(m.sourceId=u.sourceId),u.force!==void 0&&(m.force=u.force),m},fromPartial(u){var m,g,B,C;const q=An();return q.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",q.projectId=(g=u.projectId)!==null&&g!==void 0?g:"",q.sourceId=(B=u.sourceId)!==null&&B!==void 0?B:"",q.force=(C=u.force)!==null&&C!==void 0?C:void 0,q}};function Ln(){return{project:void 0,broadcastUpdated:!1}}a.RemoveSourceFromProjectResponse={encode(u,m=h.Writer.create()){return u.project!==void 0&&a.Project.encode(u.project,m.uint32(10).fork()).ldelim(),u.broadcastUpdated===!0&&m.uint32(16).bool(u.broadcastUpdated),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Ln();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.project=a.Project.decode(g,g.uint32());break;case 2:C.broadcastUpdated=g.bool();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{project:Q(u.project)?a.Project.fromJSON(u.project):void 0,broadcastUpdated:Q(u.broadcastUpdated)?Boolean(u.broadcastUpdated):!1}},toJSON(u){const m={};return u.project!==void 0&&(m.project=u.project?a.Project.toJSON(u.project):void 0),u.broadcastUpdated!==void 0&&(m.broadcastUpdated=u.broadcastUpdated),m},fromPartial(u){var m;const g=Ln();return g.project=u.project!==void 0&&u.project!==null?a.Project.fromPartial(u.project):void 0,g.broadcastUpdated=(m=u.broadcastUpdated)!==null&&m!==void 0?m:!1,g}};function Dn(){return{serviceUserId:"",displayName:void 0,role:void 0,maxDuration:void 0}}a.CreateAccessTokenRequest={encode(u,m=h.Writer.create()){return u.serviceUserId!==""&&m.uint32(10).string(u.serviceUserId),u.displayName!==void 0&&m.uint32(34).string(u.displayName),u.role!==void 0&&m.uint32(16).int32(be(u.role)),u.maxDuration!==void 0&&m.uint32(24).uint32(u.maxDuration),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Dn();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.serviceUserId=g.string();break;case 4:C.displayName=g.string();break;case 2:C.role=Se(g.int32());break;case 3:C.maxDuration=g.uint32();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{serviceUserId:Q(u.serviceUserId)?String(u.serviceUserId):"",displayName:Q(u.displayName)?String(u.displayName):void 0,role:Q(u.role)?Se(u.role):void 0,maxDuration:Q(u.maxDuration)?Number(u.maxDuration):void 0}},toJSON(u){const m={};return u.serviceUserId!==void 0&&(m.serviceUserId=u.serviceUserId),u.displayName!==void 0&&(m.displayName=u.displayName),u.role!==void 0&&(m.role=u.role!==void 0?Te(u.role):void 0),u.maxDuration!==void 0&&(m.maxDuration=Math.round(u.maxDuration)),m},fromPartial(u){var m,g,B,C;const q=Dn();return q.serviceUserId=(m=u.serviceUserId)!==null&&m!==void 0?m:"",q.displayName=(g=u.displayName)!==null&&g!==void 0?g:void 0,q.role=(B=u.role)!==null&&B!==void 0?B:void 0,q.maxDuration=(C=u.maxDuration)!==null&&C!==void 0?C:void 0,q}};function $n(){return{accessToken:""}}a.CreateAccessTokenResponse={encode(u,m=h.Writer.create()){return u.accessToken!==""&&m.uint32(10).string(u.accessToken),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=$n();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.accessToken=g.string();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{accessToken:Q(u.accessToken)?String(u.accessToken):""}},toJSON(u){const m={};return u.accessToken!==void 0&&(m.accessToken=u.accessToken),m},fromPartial(u){var m;const g=$n();return g.accessToken=(m=u.accessToken)!==null&&m!==void 0?m:"",g}};function Mn(){return{displayName:"",serviceUserId:void 0}}a.GuestAccessTokenDirect={encode(u,m=h.Writer.create()){return u.displayName!==""&&m.uint32(10).string(u.displayName),u.serviceUserId!==void 0&&m.uint32(18).string(u.serviceUserId),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Mn();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.displayName=g.string();break;case 2:C.serviceUserId=g.string();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{displayName:Q(u.displayName)?String(u.displayName):"",serviceUserId:Q(u.serviceUserId)?String(u.serviceUserId):void 0}},toJSON(u){const m={};return u.displayName!==void 0&&(m.displayName=u.displayName),u.serviceUserId!==void 0&&(m.serviceUserId=u.serviceUserId),m},fromPartial(u){var m,g;const B=Mn();return B.displayName=(m=u.displayName)!==null&&m!==void 0?m:"",B.serviceUserId=(g=u.serviceUserId)!==null&&g!==void 0?g:void 0,B}};function Un(){return{maxDuration:void 0}}a.GuestAccessTokenExchange={encode(u,m=h.Writer.create()){return u.maxDuration!==void 0&&m.uint32(8).uint32(u.maxDuration),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Un();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.maxDuration=g.uint32();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{maxDuration:Q(u.maxDuration)?Number(u.maxDuration):void 0}},toJSON(u){const m={};return u.maxDuration!==void 0&&(m.maxDuration=Math.round(u.maxDuration)),m},fromPartial(u){var m;const g=Un();return g.maxDuration=(m=u.maxDuration)!==null&&m!==void 0?m:void 0,g}};function Bn(){return{direct:void 0,exchange:void 0}}a.GuestAccessToken={encode(u,m=h.Writer.create()){return u.direct!==void 0&&a.GuestAccessTokenDirect.encode(u.direct,m.uint32(10).fork()).ldelim(),u.exchange!==void 0&&a.GuestAccessTokenExchange.encode(u.exchange,m.uint32(18).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Bn();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.direct=a.GuestAccessTokenDirect.decode(g,g.uint32());break;case 2:C.exchange=a.GuestAccessTokenExchange.decode(g,g.uint32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{direct:Q(u.direct)?a.GuestAccessTokenDirect.fromJSON(u.direct):void 0,exchange:Q(u.exchange)?a.GuestAccessTokenExchange.fromJSON(u.exchange):void 0}},toJSON(u){const m={};return u.direct!==void 0&&(m.direct=u.direct?a.GuestAccessTokenDirect.toJSON(u.direct):void 0),u.exchange!==void 0&&(m.exchange=u.exchange?a.GuestAccessTokenExchange.toJSON(u.exchange):void 0),m},fromPartial(u){const m=Bn();return m.direct=u.direct!==void 0&&u.direct!==null?a.GuestAccessTokenDirect.fromPartial(u.direct):void 0,m.exchange=u.exchange!==void 0&&u.exchange!==null?a.GuestAccessTokenExchange.fromPartial(u.exchange):void 0,m}};function Vn(){return{collectionId:"",projectId:"",maxDuration:void 0,role:he.ROLE_UNSPECIFIED,token:void 0,url:void 0}}a.CreateGuestAccessTokenRequest={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.maxDuration!==void 0&&m.uint32(24).uint32(u.maxDuration),u.role!==he.ROLE_UNSPECIFIED&&m.uint32(32).int32(be(u.role)),u.token!==void 0&&a.GuestAccessToken.encode(u.token,m.uint32(42).fork()).ldelim(),u.url!==void 0&&m.uint32(50).string(u.url),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Vn();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.projectId=g.string();break;case 3:C.maxDuration=g.uint32();break;case 4:C.role=Se(g.int32());break;case 5:C.token=a.GuestAccessToken.decode(g,g.uint32());break;case 6:C.url=g.string();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",maxDuration:Q(u.maxDuration)?Number(u.maxDuration):void 0,role:Q(u.role)?Se(u.role):he.ROLE_UNSPECIFIED,token:Q(u.token)?a.GuestAccessToken.fromJSON(u.token):void 0,url:Q(u.url)?String(u.url):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.maxDuration!==void 0&&(m.maxDuration=Math.round(u.maxDuration)),u.role!==void 0&&(m.role=Te(u.role)),u.token!==void 0&&(m.token=u.token?a.GuestAccessToken.toJSON(u.token):void 0),u.url!==void 0&&(m.url=u.url),m},fromPartial(u){var m,g,B,C,q;const fe=Vn();return fe.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",fe.projectId=(g=u.projectId)!==null&&g!==void 0?g:"",fe.maxDuration=(B=u.maxDuration)!==null&&B!==void 0?B:void 0,fe.role=(C=u.role)!==null&&C!==void 0?C:he.ROLE_UNSPECIFIED,fe.token=u.token!==void 0&&u.token!==null?a.GuestAccessToken.fromPartial(u.token):void 0,fe.url=(q=u.url)!==null&&q!==void 0?q:void 0,fe}};function Fn(){return{accessToken:"",url:void 0}}a.CreateGuestAccessTokenResponse={encode(u,m=h.Writer.create()){return u.accessToken!==""&&m.uint32(10).string(u.accessToken),u.url!==void 0&&m.uint32(18).string(u.url),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Fn();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.accessToken=g.string();break;case 2:C.url=g.string();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{accessToken:Q(u.accessToken)?String(u.accessToken):"",url:Q(u.url)?String(u.url):void 0}},toJSON(u){const m={};return u.accessToken!==void 0&&(m.accessToken=u.accessToken),u.url!==void 0&&(m.url=u.url),m},fromPartial(u){var m,g;const B=Fn();return B.accessToken=(m=u.accessToken)!==null&&m!==void 0?m:"",B.url=(g=u.url)!==null&&g!==void 0?g:void 0,B}};function Jn(){return{collectionId:"",projectId:"",displayName:""}}a.CreateWebRtcAccessTokenRequest={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.displayName!==""&&m.uint32(26).string(u.displayName),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Jn();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.projectId=g.string();break;case 3:C.displayName=g.string();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",displayName:Q(u.displayName)?String(u.displayName):""}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.displayName!==void 0&&(m.displayName=u.displayName),m},fromPartial(u){var m,g,B;const C=Jn();return C.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",C.projectId=(g=u.projectId)!==null&&g!==void 0?g:"",C.displayName=(B=u.displayName)!==null&&B!==void 0?B:"",C}};function qn(){return{webrtcAccess:void 0}}a.CreateWebRtcAccessTokenResponse={encode(u,m=h.Writer.create()){return u.webrtcAccess!==void 0&&a.WebRtcAccess.encode(u.webrtcAccess,m.uint32(18).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=qn();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 2:C.webrtcAccess=a.WebRtcAccess.decode(g,g.uint32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{webrtcAccess:Q(u.webrtcAccess)?a.WebRtcAccess.fromJSON(u.webrtcAccess):void 0}},toJSON(u){const m={};return u.webrtcAccess!==void 0&&(m.webrtcAccess=u.webrtcAccess?a.WebRtcAccess.toJSON(u.webrtcAccess):void 0),m},fromPartial(u){const m=qn();return m.webrtcAccess=u.webrtcAccess!==void 0&&u.webrtcAccess!==null?a.WebRtcAccess.fromPartial(u.webrtcAccess):void 0,m}};function Gn(){return{}}a.RefreshAccessTokenRequest={encode(u,m=h.Writer.create()){return m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Gn();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){default:g.skipType(q&7);break}}return C},fromJSON(u){return{}},toJSON(u){return{}},fromPartial(u){return Gn()}};function Wn(){return{}}a.RefreshAccessTokenResponse={encode(u,m=h.Writer.create()){return m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Wn();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){default:g.skipType(q&7);break}}return C},fromJSON(u){return{}},toJSON(u){return{}},fromPartial(u){return Wn()}};function xn(){return{collectionId:"",projectId:"",code:"",url:"",autoDelete:void 0}}a.GuestCode={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.code!==""&&m.uint32(26).string(u.code),u.url!==""&&m.uint32(34).string(u.url),u.autoDelete!==void 0&&v.Timestamp.encode(st(u.autoDelete),m.uint32(42).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=xn();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.projectId=g.string();break;case 3:C.code=g.string();break;case 4:C.url=g.string();break;case 5:C.autoDelete=dt(v.Timestamp.decode(g,g.uint32()));break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",code:Q(u.code)?String(u.code):"",url:Q(u.url)?String(u.url):"",autoDelete:Q(u.autoDelete)?String(u.autoDelete):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.code!==void 0&&(m.code=u.code),u.url!==void 0&&(m.url=u.url),u.autoDelete!==void 0&&(m.autoDelete=u.autoDelete),m},fromPartial(u){var m,g,B,C,q;const fe=xn();return fe.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",fe.projectId=(g=u.projectId)!==null&&g!==void 0?g:"",fe.code=(B=u.code)!==null&&B!==void 0?B:"",fe.url=(C=u.url)!==null&&C!==void 0?C:"",fe.autoDelete=(q=u.autoDelete)!==null&&q!==void 0?q:void 0,fe}};function Hn(){return{serviceId:"",code:""}}a.GuestCodeRedirectRequest={encode(u,m=h.Writer.create()){return u.serviceId!==""&&m.uint32(10).string(u.serviceId),u.code!==""&&m.uint32(18).string(u.code),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Hn();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.serviceId=g.string();break;case 2:C.code=g.string();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{serviceId:Q(u.serviceId)?String(u.serviceId):"",code:Q(u.code)?String(u.code):""}},toJSON(u){const m={};return u.serviceId!==void 0&&(m.serviceId=u.serviceId),u.code!==void 0&&(m.code=u.code),m},fromPartial(u){var m,g;const B=Hn();return B.serviceId=(m=u.serviceId)!==null&&m!==void 0?m:"",B.code=(g=u.code)!==null&&g!==void 0?g:"",B}};function zn(){return{}}a.GuestCodeRedirectResponse={encode(u,m=h.Writer.create()){return m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=zn();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){default:g.skipType(q&7);break}}return C},fromJSON(u){return{}},toJSON(u){return{}},fromPartial(u){return zn()}};function Yn(){return{alg:"",kty:"",use:"",kid:"",e:"",n:""}}a.JsonWebKey={encode(u,m=h.Writer.create()){return u.alg!==""&&m.uint32(10).string(u.alg),u.kty!==""&&m.uint32(18).string(u.kty),u.use!==""&&m.uint32(26).string(u.use),u.kid!==""&&m.uint32(34).string(u.kid),u.e!==""&&m.uint32(42).string(u.e),u.n!==""&&m.uint32(50).string(u.n),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Yn();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.alg=g.string();break;case 2:C.kty=g.string();break;case 3:C.use=g.string();break;case 4:C.kid=g.string();break;case 5:C.e=g.string();break;case 6:C.n=g.string();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{alg:Q(u.alg)?String(u.alg):"",kty:Q(u.kty)?String(u.kty):"",use:Q(u.use)?String(u.use):"",kid:Q(u.kid)?String(u.kid):"",e:Q(u.e)?String(u.e):"",n:Q(u.n)?String(u.n):""}},toJSON(u){const m={};return u.alg!==void 0&&(m.alg=u.alg),u.kty!==void 0&&(m.kty=u.kty),u.use!==void 0&&(m.use=u.use),u.kid!==void 0&&(m.kid=u.kid),u.e!==void 0&&(m.e=u.e),u.n!==void 0&&(m.n=u.n),m},fromPartial(u){var m,g,B,C,q,fe;const Ce=Yn();return Ce.alg=(m=u.alg)!==null&&m!==void 0?m:"",Ce.kty=(g=u.kty)!==null&&g!==void 0?g:"",Ce.use=(B=u.use)!==null&&B!==void 0?B:"",Ce.kid=(C=u.kid)!==null&&C!==void 0?C:"",Ce.e=(q=u.e)!==null&&q!==void 0?q:"",Ce.n=(fe=u.n)!==null&&fe!==void 0?fe:"",Ce}};function Kn(){return{}}a.GetJsonWebKeySetRequest={encode(u,m=h.Writer.create()){return m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Kn();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){default:g.skipType(q&7);break}}return C},fromJSON(u){return{}},toJSON(u){return{}},fromPartial(u){return Kn()}};function Qn(){return{keys:[]}}a.GetJsonWebKeySetResponse={encode(u,m=h.Writer.create()){for(const g of u.keys)a.JsonWebKey.encode(g,m.uint32(10).fork()).ldelim();return m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Qn();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.keys.push(a.JsonWebKey.decode(g,g.uint32()));break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{keys:Array.isArray(u==null?void 0:u.keys)?u.keys.map(m=>a.JsonWebKey.fromJSON(m)):[]}},toJSON(u){const m={};return u.keys?m.keys=u.keys.map(g=>g?a.JsonWebKey.toJSON(g):void 0):m.keys=[],m},fromPartial(u){var m;const g=Qn();return g.keys=((m=u.keys)===null||m===void 0?void 0:m.map(B=>a.JsonWebKey.fromPartial(B)))||[],g}};function Zn(){return{}}a.GetTestTokenRequest={encode(u,m=h.Writer.create()){return m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Zn();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){default:g.skipType(q&7);break}}return C},fromJSON(u){return{}},toJSON(u){return{}},fromPartial(u){return Zn()}};function jn(){return{accessToken:""}}a.GetTestTokenResponse={encode(u,m=h.Writer.create()){return u.accessToken!==""&&m.uint32(10).string(u.accessToken),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=jn();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.accessToken=g.string();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{accessToken:Q(u.accessToken)?String(u.accessToken):""}},toJSON(u){const m={};return u.accessToken!==void 0&&(m.accessToken=u.accessToken),m},fromPartial(u){var m;const g=jn();return g.accessToken=(m=u.accessToken)!==null&&m!==void 0?m:"",g}};function Xn(){return{collectionId:"",projectId:"",destinationId:"",destination:void 0}}a.DestinationCreateEvent={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.destinationId!==""&&m.uint32(26).string(u.destinationId),u.destination!==void 0&&a.Destination.encode(u.destination,m.uint32(34).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Xn();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.projectId=g.string();break;case 3:C.destinationId=g.string();break;case 4:C.destination=a.Destination.decode(g,g.uint32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",destinationId:Q(u.destinationId)?String(u.destinationId):"",destination:Q(u.destination)?a.Destination.fromJSON(u.destination):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.destinationId!==void 0&&(m.destinationId=u.destinationId),u.destination!==void 0&&(m.destination=u.destination?a.Destination.toJSON(u.destination):void 0),m},fromPartial(u){var m,g,B;const C=Xn();return C.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",C.projectId=(g=u.projectId)!==null&&g!==void 0?g:"",C.destinationId=(B=u.destinationId)!==null&&B!==void 0?B:"",C.destination=u.destination!==void 0&&u.destination!==null?a.Destination.fromPartial(u.destination):void 0,C}};function er(){return{collectionId:"",projectId:"",destinationId:""}}a.DestinationDeleteEvent={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.destinationId!==""&&m.uint32(26).string(u.destinationId),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=er();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.projectId=g.string();break;case 3:C.destinationId=g.string();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",destinationId:Q(u.destinationId)?String(u.destinationId):""}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.destinationId!==void 0&&(m.destinationId=u.destinationId),m},fromPartial(u){var m,g,B;const C=er();return C.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",C.projectId=(g=u.projectId)!==null&&g!==void 0?g:"",C.destinationId=(B=u.destinationId)!==null&&B!==void 0?B:"",C}};function tr(){return{collectionId:"",projectId:"",destinationId:"",updateMask:[],destination:void 0}}a.DestinationUpdateEvent={encode(u,m=h.Writer.create()){u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.destinationId!==""&&m.uint32(26).string(u.destinationId);for(const g of u.updateMask)m.uint32(34).string(g);return u.destination!==void 0&&a.Destination.encode(u.destination,m.uint32(42).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=tr();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.projectId=g.string();break;case 3:C.destinationId=g.string();break;case 4:C.updateMask.push(g.string());break;case 5:C.destination=a.Destination.decode(g,g.uint32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",destinationId:Q(u.destinationId)?String(u.destinationId):"",updateMask:Array.isArray(u==null?void 0:u.updateMask)?u.updateMask.map(m=>String(m)):[],destination:Q(u.destination)?a.Destination.fromJSON(u.destination):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.destinationId!==void 0&&(m.destinationId=u.destinationId),u.updateMask?m.updateMask=u.updateMask.map(g=>g):m.updateMask=[],u.destination!==void 0&&(m.destination=u.destination?a.Destination.toJSON(u.destination):void 0),m},fromPartial(u){var m,g,B,C;const q=tr();return q.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",q.projectId=(g=u.projectId)!==null&&g!==void 0?g:"",q.destinationId=(B=u.destinationId)!==null&&B!==void 0?B:"",q.updateMask=((C=u.updateMask)===null||C===void 0?void 0:C.map(fe=>fe))||[],q.destination=u.destination!==void 0&&u.destination!==null?a.Destination.fromPartial(u.destination):void 0,q}};function nr(){return{collectionId:"",projectId:"",destinationId:"",connect:void 0}}a.DestinationStateEvent={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.destinationId!==""&&m.uint32(26).string(u.destinationId),u.connect!==void 0&&m.uint32(32).int32(rt(u.connect)),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=nr();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.projectId=g.string();break;case 3:C.destinationId=g.string();break;case 4:C.connect=xe(g.int32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",destinationId:Q(u.destinationId)?String(u.destinationId):"",connect:Q(u.connect)?xe(u.connect):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.destinationId!==void 0&&(m.destinationId=u.destinationId),u.connect!==void 0&&(m.connect=u.connect!==void 0?nt(u.connect):void 0),m},fromPartial(u){var m,g,B,C;const q=nr();return q.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",q.projectId=(g=u.projectId)!==null&&g!==void 0?g:"",q.destinationId=(B=u.destinationId)!==null&&B!==void 0?B:"",q.connect=(C=u.connect)!==null&&C!==void 0?C:void 0,q}};function rr(){return{collectionId:"",projectId:"",project:void 0}}a.ProjectCreateEvent={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.project!==void 0&&a.Project.encode(u.project,m.uint32(26).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=rr();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.projectId=g.string();break;case 3:C.project=a.Project.decode(g,g.uint32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",project:Q(u.project)?a.Project.fromJSON(u.project):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.project!==void 0&&(m.project=u.project?a.Project.toJSON(u.project):void 0),m},fromPartial(u){var m,g;const B=rr();return B.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",B.projectId=(g=u.projectId)!==null&&g!==void 0?g:"",B.project=u.project!==void 0&&u.project!==null?a.Project.fromPartial(u.project):void 0,B}};function ir(){return{collectionId:"",projectId:""}}a.ProjectDeleteEvent={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=ir();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.projectId=g.string();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):""}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),m},fromPartial(u){var m,g;const B=ir();return B.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",B.projectId=(g=u.projectId)!==null&&g!==void 0?g:"",B}};function ar(){return{collectionId:"",projectId:"",updateMask:[],project:void 0}}a.ProjectUpdateEvent={encode(u,m=h.Writer.create()){u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId);for(const g of u.updateMask)m.uint32(26).string(g);return u.project!==void 0&&a.Project.encode(u.project,m.uint32(34).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=ar();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.projectId=g.string();break;case 3:C.updateMask.push(g.string());break;case 4:C.project=a.Project.decode(g,g.uint32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",updateMask:Array.isArray(u==null?void 0:u.updateMask)?u.updateMask.map(m=>String(m)):[],project:Q(u.project)?a.Project.fromJSON(u.project):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.updateMask?m.updateMask=u.updateMask.map(g=>g):m.updateMask=[],u.project!==void 0&&(m.project=u.project?a.Project.toJSON(u.project):void 0),m},fromPartial(u){var m,g,B;const C=ar();return C.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",C.projectId=(g=u.projectId)!==null&&g!==void 0?g:"",C.updateMask=((B=u.updateMask)===null||B===void 0?void 0:B.map(q=>q))||[],C.project=u.project!==void 0&&u.project!==null?a.Project.fromPartial(u.project):void 0,C}};function or(){return{collectionId:"",projectId:"",broadcastId:"",phase:void 0,error:void 0}}a.ProjectBroadcastStateEvent={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.broadcastId!==""&&m.uint32(26).string(u.broadcastId),u.phase!==void 0&&m.uint32(32).int32(le(u.phase)),u.error!==void 0&&m.uint32(40).int32(Re(u.error)),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=or();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.projectId=g.string();break;case 3:C.broadcastId=g.string();break;case 4:C.phase=te(g.int32());break;case 5:C.error=_e(g.int32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",broadcastId:Q(u.broadcastId)?String(u.broadcastId):"",phase:Q(u.phase)?te(u.phase):void 0,error:Q(u.error)?_e(u.error):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.broadcastId!==void 0&&(m.broadcastId=u.broadcastId),u.phase!==void 0&&(m.phase=u.phase!==void 0?se(u.phase):void 0),u.error!==void 0&&(m.error=u.error!==void 0?et(u.error):void 0),m},fromPartial(u){var m,g,B,C,q;const fe=or();return fe.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",fe.projectId=(g=u.projectId)!==null&&g!==void 0?g:"",fe.broadcastId=(B=u.broadcastId)!==null&&B!==void 0?B:"",fe.phase=(C=u.phase)!==null&&C!==void 0?C:void 0,fe.error=(q=u.error)!==null&&q!==void 0?q:void 0,fe}};function sr(){return{collectionId:"",collection:void 0}}a.CollectionCreateEvent={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.collection!==void 0&&a.Collection.encode(u.collection,m.uint32(18).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=sr();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.collection=a.Collection.decode(g,g.uint32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",collection:Q(u.collection)?a.Collection.fromJSON(u.collection):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.collection!==void 0&&(m.collection=u.collection?a.Collection.toJSON(u.collection):void 0),m},fromPartial(u){var m;const g=sr();return g.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",g.collection=u.collection!==void 0&&u.collection!==null?a.Collection.fromPartial(u.collection):void 0,g}};function dr(){return{collectionId:""}}a.CollectionDeleteEvent={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=dr();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):""}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),m},fromPartial(u){var m;const g=dr();return g.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",g}};function cr(){return{collectionId:"",updateMask:[],collection:void 0}}a.CollectionUpdateEvent={encode(u,m=h.Writer.create()){u.collectionId!==""&&m.uint32(10).string(u.collectionId);for(const g of u.updateMask)m.uint32(18).string(g);return u.collection!==void 0&&a.Collection.encode(u.collection,m.uint32(26).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=cr();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.updateMask.push(g.string());break;case 3:C.collection=a.Collection.decode(g,g.uint32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",updateMask:Array.isArray(u==null?void 0:u.updateMask)?u.updateMask.map(m=>String(m)):[],collection:Q(u.collection)?a.Collection.fromJSON(u.collection):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.updateMask?m.updateMask=u.updateMask.map(g=>g):m.updateMask=[],u.collection!==void 0&&(m.collection=u.collection?a.Collection.toJSON(u.collection):void 0),m},fromPartial(u){var m,g;const B=cr();return B.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",B.updateMask=((g=u.updateMask)===null||g===void 0?void 0:g.map(C=>C))||[],B.collection=u.collection!==void 0&&u.collection!==null?a.Collection.fromPartial(u.collection):void 0,B}};function ur(){return{collectionId:"",sourceId:"",source:void 0}}a.SourceCreateEvent={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.sourceId!==""&&m.uint32(18).string(u.sourceId),u.source!==void 0&&a.Source.encode(u.source,m.uint32(26).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=ur();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.sourceId=g.string();break;case 3:C.source=a.Source.decode(g,g.uint32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",sourceId:Q(u.sourceId)?String(u.sourceId):"",source:Q(u.source)?a.Source.fromJSON(u.source):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.sourceId!==void 0&&(m.sourceId=u.sourceId),u.source!==void 0&&(m.source=u.source?a.Source.toJSON(u.source):void 0),m},fromPartial(u){var m,g;const B=ur();return B.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",B.sourceId=(g=u.sourceId)!==null&&g!==void 0?g:"",B.source=u.source!==void 0&&u.source!==null?a.Source.fromPartial(u.source):void 0,B}};function lr(){return{collectionId:"",sourceId:""}}a.SourceDeleteEvent={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.sourceId!==""&&m.uint32(18).string(u.sourceId),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=lr();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.sourceId=g.string();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",sourceId:Q(u.sourceId)?String(u.sourceId):""}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.sourceId!==void 0&&(m.sourceId=u.sourceId),m},fromPartial(u){var m,g;const B=lr();return B.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",B.sourceId=(g=u.sourceId)!==null&&g!==void 0?g:"",B}};function fr(){return{collectionId:"",sourceId:"",updateMask:[],source:void 0}}a.SourceUpdateEvent={encode(u,m=h.Writer.create()){u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.sourceId!==""&&m.uint32(18).string(u.sourceId);for(const g of u.updateMask)m.uint32(26).string(g);return u.source!==void 0&&a.Source.encode(u.source,m.uint32(34).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=fr();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.sourceId=g.string();break;case 3:C.updateMask.push(g.string());break;case 4:C.source=a.Source.decode(g,g.uint32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",sourceId:Q(u.sourceId)?String(u.sourceId):"",updateMask:Array.isArray(u==null?void 0:u.updateMask)?u.updateMask.map(m=>String(m)):[],source:Q(u.source)?a.Source.fromJSON(u.source):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.sourceId!==void 0&&(m.sourceId=u.sourceId),u.updateMask?m.updateMask=u.updateMask.map(g=>g):m.updateMask=[],u.source!==void 0&&(m.source=u.source?a.Source.toJSON(u.source):void 0),m},fromPartial(u){var m,g,B;const C=fr();return C.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",C.sourceId=(g=u.sourceId)!==null&&g!==void 0?g:"",C.updateMask=((B=u.updateMask)===null||B===void 0?void 0:B.map(q=>q))||[],C.source=u.source!==void 0&&u.source!==null?a.Source.fromPartial(u.source):void 0,C}};function pr(){return{collectionId:"",sourceId:"",projectId:"",source:void 0}}a.SourceAddEvent={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.sourceId!==""&&m.uint32(18).string(u.sourceId),u.projectId!==""&&m.uint32(26).string(u.projectId),u.source!==void 0&&a.Source.encode(u.source,m.uint32(34).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=pr();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.sourceId=g.string();break;case 3:C.projectId=g.string();break;case 4:C.source=a.Source.decode(g,g.uint32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",sourceId:Q(u.sourceId)?String(u.sourceId):"",projectId:Q(u.projectId)?String(u.projectId):"",source:Q(u.source)?a.Source.fromJSON(u.source):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.sourceId!==void 0&&(m.sourceId=u.sourceId),u.projectId!==void 0&&(m.projectId=u.projectId),u.source!==void 0&&(m.source=u.source?a.Source.toJSON(u.source):void 0),m},fromPartial(u){var m,g,B;const C=pr();return C.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",C.sourceId=(g=u.sourceId)!==null&&g!==void 0?g:"",C.projectId=(B=u.projectId)!==null&&B!==void 0?B:"",C.source=u.source!==void 0&&u.source!==null?a.Source.fromPartial(u.source):void 0,C}};function hr(){return{collectionId:"",sourceId:"",projectId:""}}a.SourceRemoveEvent={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.sourceId!==""&&m.uint32(18).string(u.sourceId),u.projectId!==""&&m.uint32(26).string(u.projectId),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=hr();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.sourceId=g.string();break;case 3:C.projectId=g.string();break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",sourceId:Q(u.sourceId)?String(u.sourceId):"",projectId:Q(u.projectId)?String(u.projectId):""}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.sourceId!==void 0&&(m.sourceId=u.sourceId),u.projectId!==void 0&&(m.projectId=u.projectId),m},fromPartial(u){var m,g,B;const C=hr();return C.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",C.sourceId=(g=u.sourceId)!==null&&g!==void 0?g:"",C.projectId=(B=u.projectId)!==null&&B!==void 0?B:"",C}};function mr(){return{collectionId:"",projectId:"",sourceId:"",connect:void 0}}a.SourceStateEvent={encode(u,m=h.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.sourceId!==""&&m.uint32(26).string(u.sourceId),u.connect!==void 0&&m.uint32(32).int32(rt(u.connect)),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=mr();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collectionId=g.string();break;case 2:C.projectId=g.string();break;case 3:C.sourceId=g.string();break;case 4:C.connect=xe(g.int32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",sourceId:Q(u.sourceId)?String(u.sourceId):"",connect:Q(u.connect)?xe(u.connect):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.sourceId!==void 0&&(m.sourceId=u.sourceId),u.connect!==void 0&&(m.connect=u.connect!==void 0?nt(u.connect):void 0),m},fromPartial(u){var m,g,B,C;const q=mr();return q.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",q.projectId=(g=u.projectId)!==null&&g!==void 0?g:"",q.sourceId=(B=u.sourceId)!==null&&B!==void 0?B:"",q.connect=(C=u.connect)!==null&&C!==void 0?C:void 0,q}};function vr(){return{create:void 0,update:void 0,delete:void 0}}a.CollectionEvent={encode(u,m=h.Writer.create()){return u.create!==void 0&&a.CollectionCreateEvent.encode(u.create,m.uint32(10).fork()).ldelim(),u.update!==void 0&&a.CollectionUpdateEvent.encode(u.update,m.uint32(18).fork()).ldelim(),u.delete!==void 0&&a.CollectionDeleteEvent.encode(u.delete,m.uint32(26).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=vr();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.create=a.CollectionCreateEvent.decode(g,g.uint32());break;case 2:C.update=a.CollectionUpdateEvent.decode(g,g.uint32());break;case 3:C.delete=a.CollectionDeleteEvent.decode(g,g.uint32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{create:Q(u.create)?a.CollectionCreateEvent.fromJSON(u.create):void 0,update:Q(u.update)?a.CollectionUpdateEvent.fromJSON(u.update):void 0,delete:Q(u.delete)?a.CollectionDeleteEvent.fromJSON(u.delete):void 0}},toJSON(u){const m={};return u.create!==void 0&&(m.create=u.create?a.CollectionCreateEvent.toJSON(u.create):void 0),u.update!==void 0&&(m.update=u.update?a.CollectionUpdateEvent.toJSON(u.update):void 0),u.delete!==void 0&&(m.delete=u.delete?a.CollectionDeleteEvent.toJSON(u.delete):void 0),m},fromPartial(u){const m=vr();return m.create=u.create!==void 0&&u.create!==null?a.CollectionCreateEvent.fromPartial(u.create):void 0,m.update=u.update!==void 0&&u.update!==null?a.CollectionUpdateEvent.fromPartial(u.update):void 0,m.delete=u.delete!==void 0&&u.delete!==null?a.CollectionDeleteEvent.fromPartial(u.delete):void 0,m}};function gr(){return{create:void 0,update:void 0,delete:void 0,state:void 0}}a.DestinationEvent={encode(u,m=h.Writer.create()){return u.create!==void 0&&a.DestinationCreateEvent.encode(u.create,m.uint32(10).fork()).ldelim(),u.update!==void 0&&a.DestinationUpdateEvent.encode(u.update,m.uint32(18).fork()).ldelim(),u.delete!==void 0&&a.DestinationDeleteEvent.encode(u.delete,m.uint32(26).fork()).ldelim(),u.state!==void 0&&a.DestinationStateEvent.encode(u.state,m.uint32(34).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=gr();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.create=a.DestinationCreateEvent.decode(g,g.uint32());break;case 2:C.update=a.DestinationUpdateEvent.decode(g,g.uint32());break;case 3:C.delete=a.DestinationDeleteEvent.decode(g,g.uint32());break;case 4:C.state=a.DestinationStateEvent.decode(g,g.uint32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{create:Q(u.create)?a.DestinationCreateEvent.fromJSON(u.create):void 0,update:Q(u.update)?a.DestinationUpdateEvent.fromJSON(u.update):void 0,delete:Q(u.delete)?a.DestinationDeleteEvent.fromJSON(u.delete):void 0,state:Q(u.state)?a.DestinationStateEvent.fromJSON(u.state):void 0}},toJSON(u){const m={};return u.create!==void 0&&(m.create=u.create?a.DestinationCreateEvent.toJSON(u.create):void 0),u.update!==void 0&&(m.update=u.update?a.DestinationUpdateEvent.toJSON(u.update):void 0),u.delete!==void 0&&(m.delete=u.delete?a.DestinationDeleteEvent.toJSON(u.delete):void 0),u.state!==void 0&&(m.state=u.state?a.DestinationStateEvent.toJSON(u.state):void 0),m},fromPartial(u){const m=gr();return m.create=u.create!==void 0&&u.create!==null?a.DestinationCreateEvent.fromPartial(u.create):void 0,m.update=u.update!==void 0&&u.update!==null?a.DestinationUpdateEvent.fromPartial(u.update):void 0,m.delete=u.delete!==void 0&&u.delete!==null?a.DestinationDeleteEvent.fromPartial(u.delete):void 0,m.state=u.state!==void 0&&u.state!==null?a.DestinationStateEvent.fromPartial(u.state):void 0,m}};function Sr(){return{create:void 0,update:void 0,delete:void 0,state:void 0}}a.ProjectEvent={encode(u,m=h.Writer.create()){return u.create!==void 0&&a.ProjectCreateEvent.encode(u.create,m.uint32(10).fork()).ldelim(),u.update!==void 0&&a.ProjectUpdateEvent.encode(u.update,m.uint32(18).fork()).ldelim(),u.delete!==void 0&&a.ProjectDeleteEvent.encode(u.delete,m.uint32(26).fork()).ldelim(),u.state!==void 0&&a.ProjectBroadcastStateEvent.encode(u.state,m.uint32(34).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=Sr();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.create=a.ProjectCreateEvent.decode(g,g.uint32());break;case 2:C.update=a.ProjectUpdateEvent.decode(g,g.uint32());break;case 3:C.delete=a.ProjectDeleteEvent.decode(g,g.uint32());break;case 4:C.state=a.ProjectBroadcastStateEvent.decode(g,g.uint32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{create:Q(u.create)?a.ProjectCreateEvent.fromJSON(u.create):void 0,update:Q(u.update)?a.ProjectUpdateEvent.fromJSON(u.update):void 0,delete:Q(u.delete)?a.ProjectDeleteEvent.fromJSON(u.delete):void 0,state:Q(u.state)?a.ProjectBroadcastStateEvent.fromJSON(u.state):void 0}},toJSON(u){const m={};return u.create!==void 0&&(m.create=u.create?a.ProjectCreateEvent.toJSON(u.create):void 0),u.update!==void 0&&(m.update=u.update?a.ProjectUpdateEvent.toJSON(u.update):void 0),u.delete!==void 0&&(m.delete=u.delete?a.ProjectDeleteEvent.toJSON(u.delete):void 0),u.state!==void 0&&(m.state=u.state?a.ProjectBroadcastStateEvent.toJSON(u.state):void 0),m},fromPartial(u){const m=Sr();return m.create=u.create!==void 0&&u.create!==null?a.ProjectCreateEvent.fromPartial(u.create):void 0,m.update=u.update!==void 0&&u.update!==null?a.ProjectUpdateEvent.fromPartial(u.update):void 0,m.delete=u.delete!==void 0&&u.delete!==null?a.ProjectDeleteEvent.fromPartial(u.delete):void 0,m.state=u.state!==void 0&&u.state!==null?a.ProjectBroadcastStateEvent.fromPartial(u.state):void 0,m}};function yr(){return{create:void 0,update:void 0,delete:void 0,add:void 0,remove:void 0,state:void 0}}a.SourceEvent={encode(u,m=h.Writer.create()){return u.create!==void 0&&a.SourceCreateEvent.encode(u.create,m.uint32(10).fork()).ldelim(),u.update!==void 0&&a.SourceUpdateEvent.encode(u.update,m.uint32(18).fork()).ldelim(),u.delete!==void 0&&a.SourceDeleteEvent.encode(u.delete,m.uint32(26).fork()).ldelim(),u.add!==void 0&&a.SourceAddEvent.encode(u.add,m.uint32(34).fork()).ldelim(),u.remove!==void 0&&a.SourceDeleteEvent.encode(u.remove,m.uint32(42).fork()).ldelim(),u.state!==void 0&&a.SourceStateEvent.encode(u.state,m.uint32(50).fork()).ldelim(),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=yr();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.create=a.SourceCreateEvent.decode(g,g.uint32());break;case 2:C.update=a.SourceUpdateEvent.decode(g,g.uint32());break;case 3:C.delete=a.SourceDeleteEvent.decode(g,g.uint32());break;case 4:C.add=a.SourceAddEvent.decode(g,g.uint32());break;case 5:C.remove=a.SourceDeleteEvent.decode(g,g.uint32());break;case 6:C.state=a.SourceStateEvent.decode(g,g.uint32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{create:Q(u.create)?a.SourceCreateEvent.fromJSON(u.create):void 0,update:Q(u.update)?a.SourceUpdateEvent.fromJSON(u.update):void 0,delete:Q(u.delete)?a.SourceDeleteEvent.fromJSON(u.delete):void 0,add:Q(u.add)?a.SourceAddEvent.fromJSON(u.add):void 0,remove:Q(u.remove)?a.SourceDeleteEvent.fromJSON(u.remove):void 0,state:Q(u.state)?a.SourceStateEvent.fromJSON(u.state):void 0}},toJSON(u){const m={};return u.create!==void 0&&(m.create=u.create?a.SourceCreateEvent.toJSON(u.create):void 0),u.update!==void 0&&(m.update=u.update?a.SourceUpdateEvent.toJSON(u.update):void 0),u.delete!==void 0&&(m.delete=u.delete?a.SourceDeleteEvent.toJSON(u.delete):void 0),u.add!==void 0&&(m.add=u.add?a.SourceAddEvent.toJSON(u.add):void 0),u.remove!==void 0&&(m.remove=u.remove?a.SourceDeleteEvent.toJSON(u.remove):void 0),u.state!==void 0&&(m.state=u.state?a.SourceStateEvent.toJSON(u.state):void 0),m},fromPartial(u){const m=yr();return m.create=u.create!==void 0&&u.create!==null?a.SourceCreateEvent.fromPartial(u.create):void 0,m.update=u.update!==void 0&&u.update!==null?a.SourceUpdateEvent.fromPartial(u.update):void 0,m.delete=u.delete!==void 0&&u.delete!==null?a.SourceDeleteEvent.fromPartial(u.delete):void 0,m.add=u.add!==void 0&&u.add!==null?a.SourceAddEvent.fromPartial(u.add):void 0,m.remove=u.remove!==void 0&&u.remove!==null?a.SourceDeleteEvent.fromPartial(u.remove):void 0,m.state=u.state!==void 0&&u.state!==null?a.SourceStateEvent.fromPartial(u.state):void 0,m}};function br(){return{collection:void 0,destination:void 0,project:void 0,source:void 0,unspecified:void 0}}a.LiveEvent={encode(u,m=h.Writer.create()){return u.collection!==void 0&&a.CollectionEvent.encode(u.collection,m.uint32(10).fork()).ldelim(),u.destination!==void 0&&a.DestinationEvent.encode(u.destination,m.uint32(18).fork()).ldelim(),u.project!==void 0&&a.ProjectEvent.encode(u.project,m.uint32(26).fork()).ldelim(),u.source!==void 0&&a.SourceEvent.encode(u.source,m.uint32(34).fork()).ldelim(),u.unspecified!==void 0&&m.uint32(40).int32((0,S.nullValueToNumber)(u.unspecified)),m},decode(u,m){const g=u instanceof h.Reader?u:new h.Reader(u);let B=m===void 0?g.len:g.pos+m;const C=br();for(;g.pos<B;){const q=g.uint32();switch(q>>>3){case 1:C.collection=a.CollectionEvent.decode(g,g.uint32());break;case 2:C.destination=a.DestinationEvent.decode(g,g.uint32());break;case 3:C.project=a.ProjectEvent.decode(g,g.uint32());break;case 4:C.source=a.SourceEvent.decode(g,g.uint32());break;case 5:C.unspecified=(0,S.nullValueFromJSON)(g.int32());break;default:g.skipType(q&7);break}}return C},fromJSON(u){return{collection:Q(u.collection)?a.CollectionEvent.fromJSON(u.collection):void 0,destination:Q(u.destination)?a.DestinationEvent.fromJSON(u.destination):void 0,project:Q(u.project)?a.ProjectEvent.fromJSON(u.project):void 0,source:Q(u.source)?a.SourceEvent.fromJSON(u.source):void 0,unspecified:Q(u.unspecified)?(0,S.nullValueFromJSON)(u.unspecified):void 0}},toJSON(u){const m={};return u.collection!==void 0&&(m.collection=u.collection?a.CollectionEvent.toJSON(u.collection):void 0),u.destination!==void 0&&(m.destination=u.destination?a.DestinationEvent.toJSON(u.destination):void 0),u.project!==void 0&&(m.project=u.project?a.ProjectEvent.toJSON(u.project):void 0),u.source!==void 0&&(m.source=u.source?a.SourceEvent.toJSON(u.source):void 0),u.unspecified!==void 0&&(m.unspecified=u.unspecified!==void 0?(0,S.nullValueToJSON)(u.unspecified):void 0),m},fromPartial(u){var m;const g=br();return g.collection=u.collection!==void 0&&u.collection!==null?a.CollectionEvent.fromPartial(u.collection):void 0,g.destination=u.destination!==void 0&&u.destination!==null?a.DestinationEvent.fromPartial(u.destination):void 0,g.project=u.project!==void 0&&u.project!==null?a.ProjectEvent.fromPartial(u.project):void 0,g.source=u.source!==void 0&&u.source!==null?a.SourceEvent.fromPartial(u.source):void 0,g.unspecified=(m=u.unspecified)!==null&&m!==void 0?m:void 0,g}};class _r{constructor(m){this.rpc=m,this.CreateCollection=this.CreateCollection.bind(this),this.GetCollection=this.GetCollection.bind(this),this.GetCollections=this.GetCollections.bind(this),this.UpdateCollection=this.UpdateCollection.bind(this),this.DeleteCollection=this.DeleteCollection.bind(this)}CreateCollection(m){const g=a.CreateCollectionRequest.encode(m).finish();return this.rpc.request("live.v21.CollectionService","CreateCollection",g).then(C=>a.CreateCollectionResponse.decode(new h.Reader(C)))}GetCollection(m){const g=a.GetCollectionRequest.encode(m).finish();return this.rpc.request("live.v21.CollectionService","GetCollection",g).then(C=>a.GetCollectionResponse.decode(new h.Reader(C)))}GetCollections(m){const g=a.GetCollectionsRequest.encode(m).finish();return this.rpc.request("live.v21.CollectionService","GetCollections",g).then(C=>a.GetCollectionsResponse.decode(new h.Reader(C)))}UpdateCollection(m){const g=a.UpdateCollectionRequest.encode(m).finish();return this.rpc.request("live.v21.CollectionService","UpdateCollection",g).then(C=>a.UpdateCollectionResponse.decode(new h.Reader(C)))}DeleteCollection(m){const g=a.DeleteCollectionRequest.encode(m).finish();return this.rpc.request("live.v21.CollectionService","DeleteCollection",g).then(C=>a.DeleteCollectionResponse.decode(new h.Reader(C)))}}a.CollectionServiceClientImpl=_r,a.CollectionServiceDefinition={name:"CollectionService",fullName:"live.v21.CollectionService",methods:{createCollection:{name:"CreateCollection",requestType:a.CreateCollectionRequest,requestStream:!1,responseType:a.CreateCollectionResponse,responseStream:!1,options:{}},getCollection:{name:"GetCollection",requestType:a.GetCollectionRequest,requestStream:!1,responseType:a.GetCollectionResponse,responseStream:!1,options:{}},getCollections:{name:"GetCollections",requestType:a.GetCollectionsRequest,requestStream:!1,responseType:a.GetCollectionsResponse,responseStream:!1,options:{}},updateCollection:{name:"UpdateCollection",requestType:a.UpdateCollectionRequest,requestStream:!1,responseType:a.UpdateCollectionResponse,responseStream:!1,options:{}},deleteCollection:{name:"DeleteCollection",requestType:a.DeleteCollectionRequest,requestStream:!1,responseType:a.DeleteCollectionResponse,responseStream:!1,options:{}}}};class Er{constructor(m){this.rpc=m,this.CreateProject=this.CreateProject.bind(this),this.GetProject=this.GetProject.bind(this),this.DeleteProject=this.DeleteProject.bind(this),this.UpdateProject=this.UpdateProject.bind(this),this.StartProjectBroadcast=this.StartProjectBroadcast.bind(this),this.StopProjectBroadcast=this.StopProjectBroadcast.bind(this),this.StartProjectWebRtc=this.StartProjectWebRtc.bind(this),this.StopProjectWebRtc=this.StopProjectWebRtc.bind(this),this.GetProjectBroadcastSnapshot=this.GetProjectBroadcastSnapshot.bind(this),this.GetProjectBroadcastStatus=this.GetProjectBroadcastStatus.bind(this)}CreateProject(m){const g=a.CreateProjectRequest.encode(m).finish();return this.rpc.request("live.v21.ProjectService","CreateProject",g).then(C=>a.CreateProjectResponse.decode(new h.Reader(C)))}GetProject(m){const g=a.GetProjectRequest.encode(m).finish();return this.rpc.request("live.v21.ProjectService","GetProject",g).then(C=>a.GetProjectResponse.decode(new h.Reader(C)))}DeleteProject(m){const g=a.DeleteProjectRequest.encode(m).finish();return this.rpc.request("live.v21.ProjectService","DeleteProject",g).then(C=>a.DeleteProjectResponse.decode(new h.Reader(C)))}UpdateProject(m){const g=a.UpdateProjectRequest.encode(m).finish();return this.rpc.request("live.v21.ProjectService","UpdateProject",g).then(C=>a.UpdateProjectResponse.decode(new h.Reader(C)))}StartProjectBroadcast(m){const g=a.StartProjectBroadcastRequest.encode(m).finish();return this.rpc.request("live.v21.ProjectService","StartProjectBroadcast",g).then(C=>a.StartProjectBroadcastResponse.decode(new h.Reader(C)))}StopProjectBroadcast(m){const g=a.StopProjectBroadcastRequest.encode(m).finish();return this.rpc.request("live.v21.ProjectService","StopProjectBroadcast",g).then(C=>a.StopProjectBroadcastResponse.decode(new h.Reader(C)))}StartProjectWebRtc(m){const g=a.StartProjectWebRtcRequest.encode(m).finish();return this.rpc.request("live.v21.ProjectService","StartProjectWebRtc",g).then(C=>a.StartProjectWebRtcResponse.decode(new h.Reader(C)))}StopProjectWebRtc(m){const g=a.StopProjectWebRtcRequest.encode(m).finish();return this.rpc.request("live.v21.ProjectService","StopProjectWebRtc",g).then(C=>a.StopProjectWebRtcResponse.decode(new h.Reader(C)))}GetProjectBroadcastSnapshot(m){const g=a.GetProjectBroadcastSnapshotRequest.encode(m).finish();return this.rpc.request("live.v21.ProjectService","GetProjectBroadcastSnapshot",g).then(C=>a.GetProjectBroadcastSnapshotResponse.decode(new h.Reader(C)))}GetProjectBroadcastStatus(m){const g=a.GetProjectBroadcastStatusRequest.encode(m).finish();return this.rpc.request("live.v21.ProjectService","GetProjectBroadcastStatus",g).then(C=>a.GetProjectBroadcastStatusResponse.decode(new h.Reader(C)))}}a.ProjectServiceClientImpl=Er,a.ProjectServiceDefinition={name:"ProjectService",fullName:"live.v21.ProjectService",methods:{createProject:{name:"CreateProject",requestType:a.CreateProjectRequest,requestStream:!1,responseType:a.CreateProjectResponse,responseStream:!1,options:{}},getProject:{name:"GetProject",requestType:a.GetProjectRequest,requestStream:!1,responseType:a.GetProjectResponse,responseStream:!1,options:{}},deleteProject:{name:"DeleteProject",requestType:a.DeleteProjectRequest,requestStream:!1,responseType:a.DeleteProjectResponse,responseStream:!1,options:{}},updateProject:{name:"UpdateProject",requestType:a.UpdateProjectRequest,requestStream:!1,responseType:a.UpdateProjectResponse,responseStream:!1,options:{}},startProjectBroadcast:{name:"StartProjectBroadcast",requestType:a.StartProjectBroadcastRequest,requestStream:!1,responseType:a.StartProjectBroadcastResponse,responseStream:!1,options:{}},stopProjectBroadcast:{name:"StopProjectBroadcast",requestType:a.StopProjectBroadcastRequest,requestStream:!1,responseType:a.StopProjectBroadcastResponse,responseStream:!1,options:{}},startProjectWebRtc:{name:"StartProjectWebRtc",requestType:a.StartProjectWebRtcRequest,requestStream:!1,responseType:a.StartProjectWebRtcResponse,responseStream:!1,options:{}},stopProjectWebRtc:{name:"StopProjectWebRtc",requestType:a.StopProjectWebRtcRequest,requestStream:!1,responseType:a.StopProjectWebRtcResponse,responseStream:!1,options:{}},getProjectBroadcastSnapshot:{name:"GetProjectBroadcastSnapshot",requestType:a.GetProjectBroadcastSnapshotRequest,requestStream:!1,responseType:a.GetProjectBroadcastSnapshotResponse,responseStream:!1,options:{}},getProjectBroadcastStatus:{name:"GetProjectBroadcastStatus",requestType:a.GetProjectBroadcastStatusRequest,requestStream:!1,responseType:a.GetProjectBroadcastStatusResponse,responseStream:!1,options:{}}}};class Tr{constructor(m){this.rpc=m,this.CreateDestination=this.CreateDestination.bind(this),this.GetDestination=this.GetDestination.bind(this),this.UpdateDestination=this.UpdateDestination.bind(this),this.DeleteDestination=this.DeleteDestination.bind(this)}CreateDestination(m){const g=a.CreateDestinationRequest.encode(m).finish();return this.rpc.request("live.v21.DestinationService","CreateDestination",g).then(C=>a.CreateDestinationResponse.decode(new h.Reader(C)))}GetDestination(m){const g=a.GetDestinationRequest.encode(m).finish();return this.rpc.request("live.v21.DestinationService","GetDestination",g).then(C=>a.GetDestinationResponse.decode(new h.Reader(C)))}UpdateDestination(m){const g=a.UpdateDestinationRequest.encode(m).finish();return this.rpc.request("live.v21.DestinationService","UpdateDestination",g).then(C=>a.UpdateDestinationResponse.decode(new h.Reader(C)))}DeleteDestination(m){const g=a.DeleteDestinationRequest.encode(m).finish();return this.rpc.request("live.v21.DestinationService","DeleteDestination",g).then(C=>a.DeleteDestinationResponse.decode(new h.Reader(C)))}}a.DestinationServiceClientImpl=Tr,a.DestinationServiceDefinition={name:"DestinationService",fullName:"live.v21.DestinationService",methods:{createDestination:{name:"CreateDestination",requestType:a.CreateDestinationRequest,requestStream:!1,responseType:a.CreateDestinationResponse,responseStream:!1,options:{}},getDestination:{name:"GetDestination",requestType:a.GetDestinationRequest,requestStream:!1,responseType:a.GetDestinationResponse,responseStream:!1,options:{}},updateDestination:{name:"UpdateDestination",requestType:a.UpdateDestinationRequest,requestStream:!1,responseType:a.UpdateDestinationResponse,responseStream:!1,options:{}},deleteDestination:{name:"DeleteDestination",requestType:a.DeleteDestinationRequest,requestStream:!1,responseType:a.DeleteDestinationResponse,responseStream:!1,options:{}}}};class Ir{constructor(m){this.rpc=m,this.CreateSource=this.CreateSource.bind(this),this.DeleteSource=this.DeleteSource.bind(this),this.UpdateSource=this.UpdateSource.bind(this),this.UpdateSourceInProject=this.UpdateSourceInProject.bind(this),this.GetSource=this.GetSource.bind(this),this.GetSources=this.GetSources.bind(this),this.AddSourceToProject=this.AddSourceToProject.bind(this),this.RemoveSourceFromProject=this.RemoveSourceFromProject.bind(this)}CreateSource(m){const g=a.CreateSourceRequest.encode(m).finish();return this.rpc.request("live.v21.SourceService","CreateSource",g).then(C=>a.CreateSourceResponse.decode(new h.Reader(C)))}DeleteSource(m){const g=a.DeleteSourceRequest.encode(m).finish();return this.rpc.request("live.v21.SourceService","DeleteSource",g).then(C=>a.DeleteSourceResponse.decode(new h.Reader(C)))}UpdateSource(m){const g=a.UpdateSourceRequest.encode(m).finish();return this.rpc.request("live.v21.SourceService","UpdateSource",g).then(C=>a.UpdateSourceResponse.decode(new h.Reader(C)))}UpdateSourceInProject(m){const g=a.UpdateSourceInProjectRequest.encode(m).finish();return this.rpc.request("live.v21.SourceService","UpdateSourceInProject",g).then(C=>a.UpdateSourceInProjectResponse.decode(new h.Reader(C)))}GetSource(m){const g=a.GetSourceRequest.encode(m).finish();return this.rpc.request("live.v21.SourceService","GetSource",g).then(C=>a.GetSourceResponse.decode(new h.Reader(C)))}GetSources(m){const g=a.GetSourcesRequest.encode(m).finish();return this.rpc.request("live.v21.SourceService","GetSources",g).then(C=>a.GetSourcesResponse.decode(new h.Reader(C)))}AddSourceToProject(m){const g=a.AddSourceToProjectRequest.encode(m).finish();return this.rpc.request("live.v21.SourceService","AddSourceToProject",g).then(C=>a.AddSourceToProjectResponse.decode(new h.Reader(C)))}RemoveSourceFromProject(m){const g=a.RemoveSourceFromProjectRequest.encode(m).finish();return this.rpc.request("live.v21.SourceService","RemoveSourceFromProject",g).then(C=>a.RemoveSourceFromProjectResponse.decode(new h.Reader(C)))}}a.SourceServiceClientImpl=Ir,a.SourceServiceDefinition={name:"SourceService",fullName:"live.v21.SourceService",methods:{createSource:{name:"CreateSource",requestType:a.CreateSourceRequest,requestStream:!1,responseType:a.CreateSourceResponse,responseStream:!1,options:{}},deleteSource:{name:"DeleteSource",requestType:a.DeleteSourceRequest,requestStream:!1,responseType:a.DeleteSourceResponse,responseStream:!1,options:{}},updateSource:{name:"UpdateSource",requestType:a.UpdateSourceRequest,requestStream:!1,responseType:a.UpdateSourceResponse,responseStream:!1,options:{}},updateSourceInProject:{name:"UpdateSourceInProject",requestType:a.UpdateSourceInProjectRequest,requestStream:!1,responseType:a.UpdateSourceInProjectResponse,responseStream:!1,options:{}},getSource:{name:"GetSource",requestType:a.GetSourceRequest,requestStream:!1,responseType:a.GetSourceResponse,responseStream:!1,options:{}},getSources:{name:"GetSources",requestType:a.GetSourcesRequest,requestStream:!1,responseType:a.GetSourcesResponse,responseStream:!1,options:{}},addSourceToProject:{name:"AddSourceToProject",requestType:a.AddSourceToProjectRequest,requestStream:!1,responseType:a.AddSourceToProjectResponse,responseStream:!1,options:{}},removeSourceFromProject:{name:"RemoveSourceFromProject",requestType:a.RemoveSourceFromProjectRequest,requestStream:!1,responseType:a.RemoveSourceFromProjectResponse,responseStream:!1,options:{}}}};class Cr{constructor(m){this.rpc=m,this.CreateAccessToken=this.CreateAccessToken.bind(this)}CreateAccessToken(m){const g=a.CreateAccessTokenRequest.encode(m).finish();return this.rpc.request("live.v21.BackendAuthenticationService","CreateAccessToken",g).then(C=>a.CreateAccessTokenResponse.decode(new h.Reader(C)))}}a.BackendAuthenticationServiceClientImpl=Cr,a.BackendAuthenticationServiceDefinition={name:"BackendAuthenticationService",fullName:"live.v21.BackendAuthenticationService",methods:{createAccessToken:{name:"CreateAccessToken",requestType:a.CreateAccessTokenRequest,requestStream:!1,responseType:a.CreateAccessTokenResponse,responseStream:!1,options:{}}}};class Rr{constructor(m){this.rpc=m,this.CreateGuestAccessToken=this.CreateGuestAccessToken.bind(this),this.RefreshAccessToken=this.RefreshAccessToken.bind(this),this.CreateWebRtcAccessToken=this.CreateWebRtcAccessToken.bind(this)}CreateGuestAccessToken(m){const g=a.CreateGuestAccessTokenRequest.encode(m).finish();return this.rpc.request("live.v21.AuthenticationService","CreateGuestAccessToken",g).then(C=>a.CreateGuestAccessTokenResponse.decode(new h.Reader(C)))}RefreshAccessToken(m){const g=a.RefreshAccessTokenRequest.encode(m).finish();return this.rpc.request("live.v21.AuthenticationService","RefreshAccessToken",g).then(C=>a.RefreshAccessTokenResponse.decode(new h.Reader(C)))}CreateWebRtcAccessToken(m){const g=a.CreateWebRtcAccessTokenRequest.encode(m).finish();return this.rpc.request("live.v21.AuthenticationService","CreateWebRtcAccessToken",g).then(C=>a.CreateWebRtcAccessTokenResponse.decode(new h.Reader(C)))}}a.AuthenticationServiceClientImpl=Rr,a.AuthenticationServiceDefinition={name:"AuthenticationService",fullName:"live.v21.AuthenticationService",methods:{createGuestAccessToken:{name:"CreateGuestAccessToken",requestType:a.CreateGuestAccessTokenRequest,requestStream:!1,responseType:a.CreateGuestAccessTokenResponse,responseStream:!1,options:{}},refreshAccessToken:{name:"RefreshAccessToken",requestType:a.RefreshAccessTokenRequest,requestStream:!1,responseType:a.RefreshAccessTokenResponse,responseStream:!1,options:{}},createWebRtcAccessToken:{name:"CreateWebRtcAccessToken",requestType:a.CreateWebRtcAccessTokenRequest,requestStream:!1,responseType:a.CreateWebRtcAccessTokenResponse,responseStream:!1,options:{}}}};class kr{constructor(m){this.rpc=m,this.GetJsonWebKeySet=this.GetJsonWebKeySet.bind(this),this.GuestCodeRedirect=this.GuestCodeRedirect.bind(this)}GetJsonWebKeySet(m){const g=a.GetJsonWebKeySetRequest.encode(m).finish();return this.rpc.request("live.v21.PublicAuthenticationService","GetJsonWebKeySet",g).then(C=>a.GetJsonWebKeySetResponse.decode(new h.Reader(C)))}GuestCodeRedirect(m){const g=a.GuestCodeRedirectRequest.encode(m).finish();return this.rpc.request("live.v21.PublicAuthenticationService","GuestCodeRedirect",g).then(C=>a.GuestCodeRedirectResponse.decode(new h.Reader(C)))}}a.PublicAuthenticationServiceClientImpl=kr,a.PublicAuthenticationServiceDefinition={name:"PublicAuthenticationService",fullName:"live.v21.PublicAuthenticationService",methods:{getJsonWebKeySet:{name:"GetJsonWebKeySet",requestType:a.GetJsonWebKeySetRequest,requestStream:!1,responseType:a.GetJsonWebKeySetResponse,responseStream:!1,options:{}},guestCodeRedirect:{name:"GuestCodeRedirect",requestType:a.GuestCodeRedirectRequest,requestStream:!1,responseType:a.GuestCodeRedirectResponse,responseStream:!1,options:{}}}};var Ue=(()=>{if(typeof Ue!="undefined")return Ue;if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof commonjsGlobal$1!="undefined")return commonjsGlobal$1;throw"Unable to locate global object"})();const Pr=Ue.atob||(u=>Ue.Buffer.from(u,"base64").toString("binary"));function Or(u){const m=Pr(u),g=new Uint8Array(m.length);for(let B=0;B<m.length;++B)g[B]=m.charCodeAt(B);return g}const wr=Ue.btoa||(u=>Ue.Buffer.from(u,"binary").toString("base64"));function Nr(u){const m=[];return u.forEach(g=>{m.push(String.fromCharCode(g))}),wr(m.join(""))}function st(u){const m=new Date(u),g=m.getTime()/1e3,B=m.getTime()%1e3*1e6;return{seconds:g,nanos:B}}function dt(u){let m=u.seconds*1e3;return m+=u.nanos/1e6,new Date(m).toISOString()}h.util.Long!==p.default&&(h.util.Long=p.default,h.configure());function Q(u){return u!=null}}(api$1),function(a){var s=commonjsGlobal$1&&commonjsGlobal$1.__createBinding||(Object.create?function(T,k,w,P){P===void 0&&(P=w);var $=Object.getOwnPropertyDescriptor(k,w);(!$||("get"in $?!k.__esModule:$.writable||$.configurable))&&($={enumerable:!0,get:function(){return k[w]}}),Object.defineProperty(T,P,$)}:function(T,k,w,P){P===void 0&&(P=w),T[P]=k[w]}),d=commonjsGlobal$1&&commonjsGlobal$1.__setModuleDefault||(Object.create?function(T,k){Object.defineProperty(T,"default",{enumerable:!0,value:k})}:function(T,k){T.default=k}),c=commonjsGlobal$1&&commonjsGlobal$1.__decorate||function(T,k,w,P){var $=arguments.length,U=$<3?k:P===null?P=Object.getOwnPropertyDescriptor(k,w):P,E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(T,k,w,P);else for(var D=T.length-1;D>=0;D--)(E=T[D])&&(U=($<3?E(U):$>3?E(k,w,U):E(k,w))||U);return $>3&&U&&Object.defineProperty(k,w,U),U},l=commonjsGlobal$1&&commonjsGlobal$1.__importStar||function(T){if(T&&T.__esModule)return T;var k={};if(T!=null)for(var w in T)w!=="default"&&Object.prototype.hasOwnProperty.call(T,w)&&s(k,T,w);return d(k,T),k},p=commonjsGlobal$1&&commonjsGlobal$1.__metadata||function(T,k){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(T,k)};Object.defineProperty(a,"__esModule",{value:!0}),a.LiveApi=void 0;const h=l(lib$1),v=api$2,S=l(api$1),b=decorator,_="LiveApi";class I extends v.ApiClient{constructor(k,w,P,$,U,E,D){super(k,P,E,_,D),this.handlers={},this.eventApi=w,this.accessTokenRefreshCallback=$,this.publicAuthentication=this.clientFactory.create(S.PublicAuthenticationServiceDefinition,this.channel),U!=null&&(this.backendAuthentication=this.clientFactory.create(S.BackendAuthenticationServiceDefinition,this.channel,{"*":{metadata:h.Metadata({"X-Api-Key":U})}})),this.eventApi.on("event",{name:`${I.LIVEAPI_EVENT_PREFIX}:*`,ignoreSessionEvents:!0,allowedSessionEvents:[`${I.LIVEAPI_EVENT_PREFIX}:EVENT_TYPE_PROJECT:EVENT_SUB_TYPE_STATE`]},this.eventCallback.bind(this))}on(k,w){var P;this.handlers[k]=(P=this.handlers[k])!==null&&P!==void 0?P:[],this.handlers[k].push(w)}off(k,w){this.handlers[k]=this.handlers[k].filter(P=>P!==w)}emitToHandlers(k,w,P){var $;for(const U of($=this.handlers[k])!==null&&$!==void 0?$:[])U(Object.values(P).find(E=>!!E),w)}async subscribeToCollection(k){await this.eventApi.subscribe(`${I.LIVEAPI_EVENT_PREFIX}:*`,{target:{collectionId:k}})}async unsubscribeFromCollection(k){await this.eventApi.unsubscribe(`${I.LIVEAPI_EVENT_PREFIX}:*`,{target:{collectionId:k}})}async subscribeToProject(k,w){await this.eventApi.subscribe(`${I.LIVEAPI_EVENT_PREFIX}:*`,{target:{collectionId:k,projectId:w}})}async unsubscribeFromProject(k,w){await this.eventApi.unsubscribe(`${I.LIVEAPI_EVENT_PREFIX}:*`,{target:{collectionId:k,projectId:w}})}eventCallback(k){let P=k.name.split(`${I.LIVEAPI_EVENT_PREFIX}:`)[1].split(":"),$=S.eventTypeFromJSON(P[0]),U=S.eventSubTypeFromJSON(P[1]);this.log.info("processing event: "+$+"/"+U),I.liveApiEventMap[$]&&this.emitToHandlers($,U,k.payload)}_setup(k){let w=this;k.onHeader=function(P){let $=P.get("Authorization");if($!=null){const U=$.split(" ");if(U.length==2&&U[0]=="Bearer"){let E=U[1];w.log.info("received refresh token"),w.accessTokenRefreshCallback(E)}}},this.collection=this.clientFactory.create(S.CollectionServiceDefinition,this.channel,{"*":k}),this.project=this.clientFactory.create(S.ProjectServiceDefinition,this.channel,{"*":k}),this.source=this.clientFactory.create(S.SourceServiceDefinition,this.channel,{"*":k}),this.destination=this.clientFactory.create(S.DestinationServiceDefinition,this.channel,{"*":k}),this.authentication=this.clientFactory.create(S.AuthenticationServiceDefinition,this.channel,{"*":k})}}I.LIVEAPI_EVENT_PREFIX="apistream:live",c([(0,b.RequiresSdkAuthentication)(),p("design:type",Object)],I.prototype,"collection",void 0),c([(0,b.RequiresSdkAuthentication)(),p("design:type",Object)],I.prototype,"project",void 0),c([(0,b.RequiresSdkAuthentication)(),p("design:type",Object)],I.prototype,"source",void 0),c([(0,b.RequiresSdkAuthentication)(),p("design:type",Object)],I.prototype,"destination",void 0),c([(0,b.RequiresSdkAuthentication)(),p("design:type",Object)],I.prototype,"authentication",void 0),a.LiveApi=I,function(T){T.liveApiEventMap={[S.EventType.EVENT_TYPE_COLLECTION]:"collection",[S.EventType.EVENT_TYPE_PROJECT]:"project",[S.EventType.EVENT_TYPE_SOURCE]:"source",[S.EventType.EVENT_TYPE_DESTINATION]:"destination",[S.EventType.EVENT_TYPE_UNSPECIFIED]:"unspecified"}}(I=a.LiveApi||(a.LiveApi={}))}(liveapi);var eventapi={},dist$1={},api={};/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */var extendStatics=function(a,s){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,c){d.__proto__=c}||function(d,c){for(var l in c)c.hasOwnProperty(l)&&(d[l]=c[l])},extendStatics(a,s)};function __extends(a,s){extendStatics(a,s);function d(){this.constructor=a}a.prototype=s===null?Object.create(s):(d.prototype=s.prototype,new d)}function isFunction$1(a){return typeof a=="function"}var _enable_super_gross_mode_that_will_cause_bad_things=!1,config$2={Promise:void 0,set useDeprecatedSynchronousErrorHandling(a){if(a){var s=new Error;""+s.stack}_enable_super_gross_mode_that_will_cause_bad_things=a},get useDeprecatedSynchronousErrorHandling(){return _enable_super_gross_mode_that_will_cause_bad_things}};function hostReportError(a){setTimeout(function(){throw a},0)}var empty$2={closed:!0,next:function(a){},error:function(a){if(config$2.useDeprecatedSynchronousErrorHandling)throw a;hostReportError(a)},complete:function(){}},isArray$2=function(){return Array.isArray||function(a){return a&&typeof a.length=="number"}}();function isObject$4(a){return a!==null&&typeof a=="object"}var UnsubscriptionErrorImpl=function(){function a(s){return Error.call(this),this.message=s?s.length+` errors occurred during unsubscription:
`+s.map(function(d,c){return c+1+") "+d.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=s,this}return a.prototype=Object.create(Error.prototype),a}(),UnsubscriptionError=UnsubscriptionErrorImpl,Subscription=function(){function a(s){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,s&&(this._ctorUnsubscribe=!0,this._unsubscribe=s)}return a.prototype.unsubscribe=function(){var s;if(!this.closed){var d=this,c=d._parentOrParents,l=d._ctorUnsubscribe,p=d._unsubscribe,h=d._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,c instanceof a)c.remove(this);else if(c!==null)for(var v=0;v<c.length;++v){var S=c[v];S.remove(this)}if(isFunction$1(p)){l&&(this._unsubscribe=void 0);try{p.call(this)}catch(I){s=I instanceof UnsubscriptionError?flattenUnsubscriptionErrors(I.errors):[I]}}if(isArray$2(h))for(var v=-1,b=h.length;++v<b;){var _=h[v];if(isObject$4(_))try{_.unsubscribe()}catch(T){s=s||[],T instanceof UnsubscriptionError?s=s.concat(flattenUnsubscriptionErrors(T.errors)):s.push(T)}}if(s)throw new UnsubscriptionError(s)}},a.prototype.add=function(s){var d=s;if(!s)return a.EMPTY;switch(typeof s){case"function":d=new a(s);case"object":if(d===this||d.closed||typeof d.unsubscribe!="function")return d;if(this.closed)return d.unsubscribe(),d;if(!(d instanceof a)){var c=d;d=new a,d._subscriptions=[c]}break;default:throw new Error("unrecognized teardown "+s+" added to Subscription.")}var l=d._parentOrParents;if(l===null)d._parentOrParents=this;else if(l instanceof a){if(l===this)return d;d._parentOrParents=[l,this]}else if(l.indexOf(this)===-1)l.push(this);else return d;var p=this._subscriptions;return p===null?this._subscriptions=[d]:p.push(d),d},a.prototype.remove=function(s){var d=this._subscriptions;if(d){var c=d.indexOf(s);c!==-1&&d.splice(c,1)}},a.EMPTY=function(s){return s.closed=!0,s}(new a),a}();function flattenUnsubscriptionErrors(a){return a.reduce(function(s,d){return s.concat(d instanceof UnsubscriptionError?d.errors:d)},[])}var rxSubscriber=function(){return typeof Symbol=="function"?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),Subscriber=function(a){__extends(s,a);function s(d,c,l){var p=a.call(this)||this;switch(p.syncErrorValue=null,p.syncErrorThrown=!1,p.syncErrorThrowable=!1,p.isStopped=!1,arguments.length){case 0:p.destination=empty$2;break;case 1:if(!d){p.destination=empty$2;break}if(typeof d=="object"){d instanceof s?(p.syncErrorThrowable=d.syncErrorThrowable,p.destination=d,d.add(p)):(p.syncErrorThrowable=!0,p.destination=new SafeSubscriber(p,d));break}default:p.syncErrorThrowable=!0,p.destination=new SafeSubscriber(p,d,c,l);break}return p}return s.prototype[rxSubscriber]=function(){return this},s.create=function(d,c,l){var p=new s(d,c,l);return p.syncErrorThrowable=!1,p},s.prototype.next=function(d){this.isStopped||this._next(d)},s.prototype.error=function(d){this.isStopped||(this.isStopped=!0,this._error(d))},s.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},s.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,a.prototype.unsubscribe.call(this))},s.prototype._next=function(d){this.destination.next(d)},s.prototype._error=function(d){this.destination.error(d),this.unsubscribe()},s.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},s.prototype._unsubscribeAndRecycle=function(){var d=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=d,this},s}(Subscription),SafeSubscriber=function(a){__extends(s,a);function s(d,c,l,p){var h=a.call(this)||this;h._parentSubscriber=d;var v,S=h;return isFunction$1(c)?v=c:c&&(v=c.next,l=c.error,p=c.complete,c!==empty$2&&(S=Object.create(c),isFunction$1(S.unsubscribe)&&h.add(S.unsubscribe.bind(S)),S.unsubscribe=h.unsubscribe.bind(h))),h._context=S,h._next=v,h._error=l,h._complete=p,h}return s.prototype.next=function(d){if(!this.isStopped&&this._next){var c=this._parentSubscriber;!config$2.useDeprecatedSynchronousErrorHandling||!c.syncErrorThrowable?this.__tryOrUnsub(this._next,d):this.__tryOrSetError(c,this._next,d)&&this.unsubscribe()}},s.prototype.error=function(d){if(!this.isStopped){var c=this._parentSubscriber,l=config$2.useDeprecatedSynchronousErrorHandling;if(this._error)!l||!c.syncErrorThrowable?(this.__tryOrUnsub(this._error,d),this.unsubscribe()):(this.__tryOrSetError(c,this._error,d),this.unsubscribe());else if(c.syncErrorThrowable)l?(c.syncErrorValue=d,c.syncErrorThrown=!0):hostReportError(d),this.unsubscribe();else{if(this.unsubscribe(),l)throw d;hostReportError(d)}}},s.prototype.complete=function(){var d=this;if(!this.isStopped){var c=this._parentSubscriber;if(this._complete){var l=function(){return d._complete.call(d._context)};!config$2.useDeprecatedSynchronousErrorHandling||!c.syncErrorThrowable?(this.__tryOrUnsub(l),this.unsubscribe()):(this.__tryOrSetError(c,l),this.unsubscribe())}else this.unsubscribe()}},s.prototype.__tryOrUnsub=function(d,c){try{d.call(this._context,c)}catch(l){if(this.unsubscribe(),config$2.useDeprecatedSynchronousErrorHandling)throw l;hostReportError(l)}},s.prototype.__tryOrSetError=function(d,c,l){if(!config$2.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{c.call(this._context,l)}catch(p){return config$2.useDeprecatedSynchronousErrorHandling?(d.syncErrorValue=p,d.syncErrorThrown=!0,!0):(hostReportError(p),!0)}return!1},s.prototype._unsubscribe=function(){var d=this._parentSubscriber;this._context=null,this._parentSubscriber=null,d.unsubscribe()},s}(Subscriber);function canReportError(a){for(;a;){var s=a,d=s.closed,c=s.destination,l=s.isStopped;if(d||l)return!1;c&&c instanceof Subscriber?a=c:a=null}return!0}function toSubscriber(a,s,d){if(a){if(a instanceof Subscriber)return a;if(a[rxSubscriber])return a[rxSubscriber]()}return!a&&!s&&!d?new Subscriber(empty$2):new Subscriber(a,s,d)}var observable=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function identity(a){return a}function pipe(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];return pipeFromArray(a)}function pipeFromArray(a){return a.length===0?identity:a.length===1?a[0]:function(d){return a.reduce(function(c,l){return l(c)},d)}}var Observable=function(){function a(s){this._isScalar=!1,s&&(this._subscribe=s)}return a.prototype.lift=function(s){var d=new a;return d.source=this,d.operator=s,d},a.prototype.subscribe=function(s,d,c){var l=this.operator,p=toSubscriber(s,d,c);if(l?p.add(l.call(p,this.source)):p.add(this.source||config$2.useDeprecatedSynchronousErrorHandling&&!p.syncErrorThrowable?this._subscribe(p):this._trySubscribe(p)),config$2.useDeprecatedSynchronousErrorHandling&&p.syncErrorThrowable&&(p.syncErrorThrowable=!1,p.syncErrorThrown))throw p.syncErrorValue;return p},a.prototype._trySubscribe=function(s){try{return this._subscribe(s)}catch(d){config$2.useDeprecatedSynchronousErrorHandling&&(s.syncErrorThrown=!0,s.syncErrorValue=d),canReportError(s)?s.error(d):console.warn(d)}},a.prototype.forEach=function(s,d){var c=this;return d=getPromiseCtor(d),new d(function(l,p){var h;h=c.subscribe(function(v){try{s(v)}catch(S){p(S),h&&h.unsubscribe()}},p,l)})},a.prototype._subscribe=function(s){var d=this.source;return d&&d.subscribe(s)},a.prototype[observable]=function(){return this},a.prototype.pipe=function(){for(var s=[],d=0;d<arguments.length;d++)s[d]=arguments[d];return s.length===0?this:pipeFromArray(s)(this)},a.prototype.toPromise=function(s){var d=this;return s=getPromiseCtor(s),new s(function(c,l){var p;d.subscribe(function(h){return p=h},function(h){return l(h)},function(){return c(p)})})},a.create=function(s){return new a(s)},a}();function getPromiseCtor(a){if(a||(a=config$2.Promise||Promise),!a)throw new Error("no Promise impl found");return a}var subscribeToArray=function(a){return function(s){for(var d=0,c=a.length;d<c&&!s.closed;d++)s.next(a[d]);s.complete()}},subscribeToPromise=function(a){return function(s){return a.then(function(d){s.closed||(s.next(d),s.complete())},function(d){return s.error(d)}).then(null,hostReportError),s}};function getSymbolIterator(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var iterator=getSymbolIterator(),subscribeToIterable=function(a){return function(s){var d=a[iterator]();do{var c=void 0;try{c=d.next()}catch(l){return s.error(l),s}if(c.done){s.complete();break}if(s.next(c.value),s.closed)break}while(!0);return typeof d.return=="function"&&s.add(function(){d.return&&d.return()}),s}},subscribeToObservable=function(a){return function(s){var d=a[observable]();if(typeof d.subscribe!="function")throw new TypeError("Provided object does not correctly implement Symbol.observable");return d.subscribe(s)}},isArrayLike=function(a){return a&&typeof a.length=="number"&&typeof a!="function"};function isPromise(a){return!!a&&typeof a.subscribe!="function"&&typeof a.then=="function"}var subscribeTo=function(a){if(!!a&&typeof a[observable]=="function")return subscribeToObservable(a);if(isArrayLike(a))return subscribeToArray(a);if(isPromise(a))return subscribeToPromise(a);if(!!a&&typeof a[iterator]=="function")return subscribeToIterable(a);var s=isObject$4(a)?"an invalid object":"'"+a+"'",d="You provided "+s+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.";throw new TypeError(d)},SimpleInnerSubscriber=function(a){__extends(s,a);function s(d){var c=a.call(this)||this;return c.parent=d,c}return s.prototype._next=function(d){this.parent.notifyNext(d)},s.prototype._error=function(d){this.parent.notifyError(d),this.unsubscribe()},s.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},s}(Subscriber),SimpleOuterSubscriber=function(a){__extends(s,a);function s(){return a!==null&&a.apply(this,arguments)||this}return s.prototype.notifyNext=function(d){this.destination.next(d)},s.prototype.notifyError=function(d){this.destination.error(d)},s.prototype.notifyComplete=function(){this.destination.complete()},s}(Subscriber);function innerSubscribe(a,s){if(!s.closed){if(a instanceof Observable)return a.subscribe(s);var d;try{d=subscribeTo(a)(s)}catch(c){s.error(c)}return d}}function audit(a){return function(d){return d.lift(new AuditOperator(a))}}var AuditOperator=function(){function a(s){this.durationSelector=s}return a.prototype.call=function(s,d){return d.subscribe(new AuditSubscriber(s,this.durationSelector))},a}(),AuditSubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.durationSelector=c,l.hasValue=!1,l}return s.prototype._next=function(d){if(this.value=d,this.hasValue=!0,!this.throttled){var c=void 0;try{var l=this.durationSelector;c=l(d)}catch(h){return this.destination.error(h)}var p=innerSubscribe(c,new SimpleInnerSubscriber(this));!p||p.closed?this.clearThrottle():this.add(this.throttled=p)}},s.prototype.clearThrottle=function(){var d=this,c=d.value,l=d.hasValue,p=d.throttled;p&&(this.remove(p),this.throttled=void 0,p.unsubscribe()),l&&(this.value=void 0,this.hasValue=!1,this.destination.next(c))},s.prototype.notifyNext=function(){this.clearThrottle()},s.prototype.notifyComplete=function(){this.clearThrottle()},s}(SimpleOuterSubscriber),Action=function(a){__extends(s,a);function s(d,c){return a.call(this)||this}return s.prototype.schedule=function(d,c){return this},s}(Subscription),AsyncAction=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d,c)||this;return l.scheduler=d,l.work=c,l.pending=!1,l}return s.prototype.schedule=function(d,c){if(c===void 0&&(c=0),this.closed)return this;this.state=d;var l=this.id,p=this.scheduler;return l!=null&&(this.id=this.recycleAsyncId(p,l,c)),this.pending=!0,this.delay=c,this.id=this.id||this.requestAsyncId(p,this.id,c),this},s.prototype.requestAsyncId=function(d,c,l){return l===void 0&&(l=0),setInterval(d.flush.bind(d,this),l)},s.prototype.recycleAsyncId=function(d,c,l){if(l===void 0&&(l=0),l!==null&&this.delay===l&&this.pending===!1)return c;clearInterval(c)},s.prototype.execute=function(d,c){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var l=this._execute(d,c);if(l)return l;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},s.prototype._execute=function(d,c){var l=!1,p=void 0;try{this.work(d)}catch(h){l=!0,p=!!h&&h||new Error(h)}if(l)return this.unsubscribe(),p},s.prototype._unsubscribe=function(){var d=this.id,c=this.scheduler,l=c.actions,p=l.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,p!==-1&&l.splice(p,1),d!=null&&(this.id=this.recycleAsyncId(c,d,null)),this.delay=null},s}(Action),Scheduler=function(){function a(s,d){d===void 0&&(d=a.now),this.SchedulerAction=s,this.now=d}return a.prototype.schedule=function(s,d,c){return d===void 0&&(d=0),new this.SchedulerAction(this,s).schedule(c,d)},a.now=function(){return Date.now()},a}(),AsyncScheduler=function(a){__extends(s,a);function s(d,c){c===void 0&&(c=Scheduler.now);var l=a.call(this,d,function(){return s.delegate&&s.delegate!==l?s.delegate.now():c()})||this;return l.actions=[],l.active=!1,l.scheduled=void 0,l}return s.prototype.schedule=function(d,c,l){return c===void 0&&(c=0),s.delegate&&s.delegate!==this?s.delegate.schedule(d,c,l):a.prototype.schedule.call(this,d,c,l)},s.prototype.flush=function(d){var c=this.actions;if(this.active){c.push(d);return}var l;this.active=!0;do if(l=d.execute(d.state,d.delay))break;while(d=c.shift());if(this.active=!1,l){for(;d=c.shift();)d.unsubscribe();throw l}},s}(Scheduler),asyncScheduler=new AsyncScheduler(AsyncAction),async=asyncScheduler;function isNumeric(a){return!isArray$2(a)&&a-parseFloat(a)+1>=0}function isScheduler(a){return a&&typeof a.schedule=="function"}function timer(a,s,d){a===void 0&&(a=0);var c=-1;return isNumeric(s)?c=Number(s)<1&&1||Number(s):isScheduler(s)&&(d=s),isScheduler(d)||(d=async),new Observable(function(l){var p=isNumeric(a)?a:+a-d.now();return d.schedule(dispatch$1,p,{index:0,period:c,subscriber:l})})}function dispatch$1(a){var s=a.index,d=a.period,c=a.subscriber;if(c.next(s),!c.closed){if(d===-1)return c.complete();a.index=s+1,this.schedule(a,d)}}function auditTime(a,s){return s===void 0&&(s=async),audit(function(){return timer(a,s)})}function buffer(a){return function(d){return d.lift(new BufferOperator(a))}}var BufferOperator=function(){function a(s){this.closingNotifier=s}return a.prototype.call=function(s,d){return d.subscribe(new BufferSubscriber(s,this.closingNotifier))},a}(),BufferSubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.buffer=[],l.add(innerSubscribe(c,new SimpleInnerSubscriber(l))),l}return s.prototype._next=function(d){this.buffer.push(d)},s.prototype.notifyNext=function(){var d=this.buffer;this.buffer=[],this.destination.next(d)},s}(SimpleOuterSubscriber);function bufferCount(a,s){return s===void 0&&(s=null),function(c){return c.lift(new BufferCountOperator(a,s))}}var BufferCountOperator=function(){function a(s,d){this.bufferSize=s,this.startBufferEvery=d,!d||s===d?this.subscriberClass=BufferCountSubscriber:this.subscriberClass=BufferSkipCountSubscriber}return a.prototype.call=function(s,d){return d.subscribe(new this.subscriberClass(s,this.bufferSize,this.startBufferEvery))},a}(),BufferCountSubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.bufferSize=c,l.buffer=[],l}return s.prototype._next=function(d){var c=this.buffer;c.push(d),c.length==this.bufferSize&&(this.destination.next(c),this.buffer=[])},s.prototype._complete=function(){var d=this.buffer;d.length>0&&this.destination.next(d),a.prototype._complete.call(this)},s}(Subscriber),BufferSkipCountSubscriber=function(a){__extends(s,a);function s(d,c,l){var p=a.call(this,d)||this;return p.bufferSize=c,p.startBufferEvery=l,p.buffers=[],p.count=0,p}return s.prototype._next=function(d){var c=this,l=c.bufferSize,p=c.startBufferEvery,h=c.buffers,v=c.count;this.count++,v%p===0&&h.push([]);for(var S=h.length;S--;){var b=h[S];b.push(d),b.length===l&&(h.splice(S,1),this.destination.next(b))}},s.prototype._complete=function(){for(var d=this,c=d.buffers,l=d.destination;c.length>0;){var p=c.shift();p.length>0&&l.next(p)}a.prototype._complete.call(this)},s}(Subscriber);function bufferTime(a){var s=arguments.length,d=async;isScheduler(arguments[arguments.length-1])&&(d=arguments[arguments.length-1],s--);var c=null;s>=2&&(c=arguments[1]);var l=Number.POSITIVE_INFINITY;return s>=3&&(l=arguments[2]),function(h){return h.lift(new BufferTimeOperator(a,c,l,d))}}var BufferTimeOperator=function(){function a(s,d,c,l){this.bufferTimeSpan=s,this.bufferCreationInterval=d,this.maxBufferSize=c,this.scheduler=l}return a.prototype.call=function(s,d){return d.subscribe(new BufferTimeSubscriber(s,this.bufferTimeSpan,this.bufferCreationInterval,this.maxBufferSize,this.scheduler))},a}(),Context=function(){function a(){this.buffer=[]}return a}(),BufferTimeSubscriber=function(a){__extends(s,a);function s(d,c,l,p,h){var v=a.call(this,d)||this;v.bufferTimeSpan=c,v.bufferCreationInterval=l,v.maxBufferSize=p,v.scheduler=h,v.contexts=[];var S=v.openContext();if(v.timespanOnly=l==null||l<0,v.timespanOnly){var b={subscriber:v,context:S,bufferTimeSpan:c};v.add(S.closeAction=h.schedule(dispatchBufferTimeSpanOnly,c,b))}else{var _={subscriber:v,context:S},I={bufferTimeSpan:c,bufferCreationInterval:l,subscriber:v,scheduler:h};v.add(S.closeAction=h.schedule(dispatchBufferClose,c,_)),v.add(h.schedule(dispatchBufferCreation,l,I))}return v}return s.prototype._next=function(d){for(var c=this.contexts,l=c.length,p,h=0;h<l;h++){var v=c[h],S=v.buffer;S.push(d),S.length==this.maxBufferSize&&(p=v)}p&&this.onBufferFull(p)},s.prototype._error=function(d){this.contexts.length=0,a.prototype._error.call(this,d)},s.prototype._complete=function(){for(var d=this,c=d.contexts,l=d.destination;c.length>0;){var p=c.shift();l.next(p.buffer)}a.prototype._complete.call(this)},s.prototype._unsubscribe=function(){this.contexts=null},s.prototype.onBufferFull=function(d){this.closeContext(d);var c=d.closeAction;if(c.unsubscribe(),this.remove(c),!this.closed&&this.timespanOnly){d=this.openContext();var l=this.bufferTimeSpan,p={subscriber:this,context:d,bufferTimeSpan:l};this.add(d.closeAction=this.scheduler.schedule(dispatchBufferTimeSpanOnly,l,p))}},s.prototype.openContext=function(){var d=new Context;return this.contexts.push(d),d},s.prototype.closeContext=function(d){this.destination.next(d.buffer);var c=this.contexts,l=c?c.indexOf(d):-1;l>=0&&c.splice(c.indexOf(d),1)},s}(Subscriber);function dispatchBufferTimeSpanOnly(a){var s=a.subscriber,d=a.context;d&&s.closeContext(d),s.closed||(a.context=s.openContext(),a.context.closeAction=this.schedule(a,a.bufferTimeSpan))}function dispatchBufferCreation(a){var s=a.bufferCreationInterval,d=a.bufferTimeSpan,c=a.subscriber,l=a.scheduler,p=c.openContext(),h=this;c.closed||(c.add(p.closeAction=l.schedule(dispatchBufferClose,d,{subscriber:c,context:p})),h.schedule(a,s))}function dispatchBufferClose(a){var s=a.subscriber,d=a.context;s.closeContext(d)}var InnerSubscriber=function(a){__extends(s,a);function s(d,c,l){var p=a.call(this)||this;return p.parent=d,p.outerValue=c,p.outerIndex=l,p.index=0,p}return s.prototype._next=function(d){this.parent.notifyNext(this.outerValue,d,this.outerIndex,this.index++,this)},s.prototype._error=function(d){this.parent.notifyError(d,this),this.unsubscribe()},s.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},s}(Subscriber);function subscribeToResult(a,s,d,c,l){if(l===void 0&&(l=new InnerSubscriber(a,d,c)),!l.closed)return s instanceof Observable?s.subscribe(l):subscribeTo(s)(l)}var OuterSubscriber=function(a){__extends(s,a);function s(){return a!==null&&a.apply(this,arguments)||this}return s.prototype.notifyNext=function(d,c,l,p,h){this.destination.next(c)},s.prototype.notifyError=function(d,c){this.destination.error(d)},s.prototype.notifyComplete=function(d){this.destination.complete()},s}(Subscriber);function bufferToggle(a,s){return function(c){return c.lift(new BufferToggleOperator(a,s))}}var BufferToggleOperator=function(){function a(s,d){this.openings=s,this.closingSelector=d}return a.prototype.call=function(s,d){return d.subscribe(new BufferToggleSubscriber(s,this.openings,this.closingSelector))},a}(),BufferToggleSubscriber=function(a){__extends(s,a);function s(d,c,l){var p=a.call(this,d)||this;return p.closingSelector=l,p.contexts=[],p.add(subscribeToResult(p,c)),p}return s.prototype._next=function(d){for(var c=this.contexts,l=c.length,p=0;p<l;p++)c[p].buffer.push(d)},s.prototype._error=function(d){for(var c=this.contexts;c.length>0;){var l=c.shift();l.subscription.unsubscribe(),l.buffer=null,l.subscription=null}this.contexts=null,a.prototype._error.call(this,d)},s.prototype._complete=function(){for(var d=this.contexts;d.length>0;){var c=d.shift();this.destination.next(c.buffer),c.subscription.unsubscribe(),c.buffer=null,c.subscription=null}this.contexts=null,a.prototype._complete.call(this)},s.prototype.notifyNext=function(d,c){d?this.closeBuffer(d):this.openBuffer(c)},s.prototype.notifyComplete=function(d){this.closeBuffer(d.context)},s.prototype.openBuffer=function(d){try{var c=this.closingSelector,l=c.call(this,d);l&&this.trySubscribe(l)}catch(p){this._error(p)}},s.prototype.closeBuffer=function(d){var c=this.contexts;if(c&&d){var l=d.buffer,p=d.subscription;this.destination.next(l),c.splice(c.indexOf(d),1),this.remove(p),p.unsubscribe()}},s.prototype.trySubscribe=function(d){var c=this.contexts,l=[],p=new Subscription,h={buffer:l,subscription:p};c.push(h);var v=subscribeToResult(this,d,h);!v||v.closed?this.closeBuffer(h):(v.context=h,this.add(v),p.add(v))},s}(OuterSubscriber);function bufferWhen(a){return function(s){return s.lift(new BufferWhenOperator(a))}}var BufferWhenOperator=function(){function a(s){this.closingSelector=s}return a.prototype.call=function(s,d){return d.subscribe(new BufferWhenSubscriber(s,this.closingSelector))},a}(),BufferWhenSubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.closingSelector=c,l.subscribing=!1,l.openBuffer(),l}return s.prototype._next=function(d){this.buffer.push(d)},s.prototype._complete=function(){var d=this.buffer;d&&this.destination.next(d),a.prototype._complete.call(this)},s.prototype._unsubscribe=function(){this.buffer=void 0,this.subscribing=!1},s.prototype.notifyNext=function(){this.openBuffer()},s.prototype.notifyComplete=function(){this.subscribing?this.complete():this.openBuffer()},s.prototype.openBuffer=function(){var d=this.closingSubscription;d&&(this.remove(d),d.unsubscribe());var c=this.buffer;this.buffer&&this.destination.next(c),this.buffer=[];var l;try{var p=this.closingSelector;l=p()}catch(h){return this.error(h)}d=new Subscription,this.closingSubscription=d,this.add(d),this.subscribing=!0,d.add(innerSubscribe(l,new SimpleInnerSubscriber(this))),this.subscribing=!1},s}(SimpleOuterSubscriber);function catchError(a){return function(d){var c=new CatchOperator(a),l=d.lift(c);return c.caught=l}}var CatchOperator=function(){function a(s){this.selector=s}return a.prototype.call=function(s,d){return d.subscribe(new CatchSubscriber(s,this.selector,this.caught))},a}(),CatchSubscriber=function(a){__extends(s,a);function s(d,c,l){var p=a.call(this,d)||this;return p.selector=c,p.caught=l,p}return s.prototype.error=function(d){if(!this.isStopped){var c=void 0;try{c=this.selector(d,this.caught)}catch(h){a.prototype.error.call(this,h);return}this._unsubscribeAndRecycle();var l=new SimpleInnerSubscriber(this);this.add(l);var p=innerSubscribe(c,l);p!==l&&this.add(p)}},s}(SimpleOuterSubscriber);function scheduleArray(a,s){return new Observable(function(d){var c=new Subscription,l=0;return c.add(s.schedule(function(){if(l===a.length){d.complete();return}d.next(a[l++]),d.closed||c.add(this.schedule())})),c})}function fromArray(a,s){return s?scheduleArray(a,s):new Observable(subscribeToArray(a))}var NONE={},CombineLatestOperator=function(){function a(s){this.resultSelector=s}return a.prototype.call=function(s,d){return d.subscribe(new CombineLatestSubscriber(s,this.resultSelector))},a}(),CombineLatestSubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.resultSelector=c,l.active=0,l.values=[],l.observables=[],l}return s.prototype._next=function(d){this.values.push(NONE),this.observables.push(d)},s.prototype._complete=function(){var d=this.observables,c=d.length;if(c===0)this.destination.complete();else{this.active=c,this.toRespond=c;for(var l=0;l<c;l++){var p=d[l];this.add(subscribeToResult(this,p,void 0,l))}}},s.prototype.notifyComplete=function(d){(this.active-=1)===0&&this.destination.complete()},s.prototype.notifyNext=function(d,c,l){var p=this.values,h=p[l],v=this.toRespond?h===NONE?--this.toRespond:this.toRespond:0;p[l]=c,v===0&&(this.resultSelector?this._tryResultSelector(p):this.destination.next(p.slice()))},s.prototype._tryResultSelector=function(d){var c;try{c=this.resultSelector.apply(this,d)}catch(l){this.destination.error(l);return}this.destination.next(c)},s}(OuterSubscriber);function combineAll(a){return function(s){return s.lift(new CombineLatestOperator(a))}}function scheduleObservable(a,s){return new Observable(function(d){var c=new Subscription;return c.add(s.schedule(function(){var l=a[observable]();c.add(l.subscribe({next:function(p){c.add(s.schedule(function(){return d.next(p)}))},error:function(p){c.add(s.schedule(function(){return d.error(p)}))},complete:function(){c.add(s.schedule(function(){return d.complete()}))}}))})),c})}function schedulePromise(a,s){return new Observable(function(d){var c=new Subscription;return c.add(s.schedule(function(){return a.then(function(l){c.add(s.schedule(function(){d.next(l),c.add(s.schedule(function(){return d.complete()}))}))},function(l){c.add(s.schedule(function(){return d.error(l)}))})})),c})}function scheduleIterable(a,s){if(!a)throw new Error("Iterable cannot be null");return new Observable(function(d){var c=new Subscription,l;return c.add(function(){l&&typeof l.return=="function"&&l.return()}),c.add(s.schedule(function(){l=a[iterator](),c.add(s.schedule(function(){if(!d.closed){var p,h;try{var v=l.next();p=v.value,h=v.done}catch(S){d.error(S);return}h?d.complete():(d.next(p),this.schedule())}}))})),c})}function isInteropObservable(a){return a&&typeof a[observable]=="function"}function isIterable(a){return a&&typeof a[iterator]=="function"}function scheduled(a,s){if(a!=null){if(isInteropObservable(a))return scheduleObservable(a,s);if(isPromise(a))return schedulePromise(a,s);if(isArrayLike(a))return scheduleArray(a,s);if(isIterable(a)||typeof a=="string")return scheduleIterable(a,s)}throw new TypeError((a!==null&&typeof a||a)+" is not observable")}function from(a,s){return s?scheduled(a,s):a instanceof Observable?a:new Observable(subscribeTo(a))}function combineLatest(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];var d=null;return typeof a[a.length-1]=="function"&&(d=a.pop()),a.length===1&&isArray$2(a[0])&&(a=a[0].slice()),function(c){return c.lift.call(from([c].concat(a)),new CombineLatestOperator(d))}}function of$1(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];var d=a[a.length-1];return isScheduler(d)?(a.pop(),scheduleArray(a,d)):fromArray(a)}function map(a,s){return function(c){if(typeof a!="function")throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return c.lift(new MapOperator(a,s))}}var MapOperator=function(){function a(s,d){this.project=s,this.thisArg=d}return a.prototype.call=function(s,d){return d.subscribe(new MapSubscriber(s,this.project,this.thisArg))},a}(),MapSubscriber=function(a){__extends(s,a);function s(d,c,l){var p=a.call(this,d)||this;return p.project=c,p.count=0,p.thisArg=l||p,p}return s.prototype._next=function(d){var c;try{c=this.project.call(this.thisArg,d,this.count++)}catch(l){this.destination.error(l);return}this.destination.next(c)},s}(Subscriber);function mergeMap(a,s,d){return d===void 0&&(d=Number.POSITIVE_INFINITY),typeof s=="function"?function(c){return c.pipe(mergeMap(function(l,p){return from(a(l,p)).pipe(map(function(h,v){return s(l,h,p,v)}))},d))}:(typeof s=="number"&&(d=s),function(c){return c.lift(new MergeMapOperator(a,d))})}var MergeMapOperator=function(){function a(s,d){d===void 0&&(d=Number.POSITIVE_INFINITY),this.project=s,this.concurrent=d}return a.prototype.call=function(s,d){return d.subscribe(new MergeMapSubscriber(s,this.project,this.concurrent))},a}(),MergeMapSubscriber=function(a){__extends(s,a);function s(d,c,l){l===void 0&&(l=Number.POSITIVE_INFINITY);var p=a.call(this,d)||this;return p.project=c,p.concurrent=l,p.hasCompleted=!1,p.buffer=[],p.active=0,p.index=0,p}return s.prototype._next=function(d){this.active<this.concurrent?this._tryNext(d):this.buffer.push(d)},s.prototype._tryNext=function(d){var c,l=this.index++;try{c=this.project(d,l)}catch(p){this.destination.error(p);return}this.active++,this._innerSub(c)},s.prototype._innerSub=function(d){var c=new SimpleInnerSubscriber(this),l=this.destination;l.add(c);var p=innerSubscribe(d,c);p!==c&&l.add(p)},s.prototype._complete=function(){this.hasCompleted=!0,this.active===0&&this.buffer.length===0&&this.destination.complete(),this.unsubscribe()},s.prototype.notifyNext=function(d){this.destination.next(d)},s.prototype.notifyComplete=function(){var d=this.buffer;this.active--,d.length>0?this._next(d.shift()):this.active===0&&this.hasCompleted&&this.destination.complete()},s}(SimpleOuterSubscriber),flatMap=mergeMap;function mergeAll(a){return a===void 0&&(a=Number.POSITIVE_INFINITY),mergeMap(identity,a)}function concatAll(){return mergeAll(1)}function concat$1(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];return concatAll()(of$1.apply(void 0,a))}function concat(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];return function(d){return d.lift.call(concat$1.apply(void 0,[d].concat(a)))}}function concatMap(a,s){return mergeMap(a,s,1)}function concatMapTo(a,s){return concatMap(function(){return a},s)}function count(a){return function(s){return s.lift(new CountOperator(a,s))}}var CountOperator=function(){function a(s,d){this.predicate=s,this.source=d}return a.prototype.call=function(s,d){return d.subscribe(new CountSubscriber(s,this.predicate,this.source))},a}(),CountSubscriber=function(a){__extends(s,a);function s(d,c,l){var p=a.call(this,d)||this;return p.predicate=c,p.source=l,p.count=0,p.index=0,p}return s.prototype._next=function(d){this.predicate?this._tryPredicate(d):this.count++},s.prototype._tryPredicate=function(d){var c;try{c=this.predicate(d,this.index++,this.source)}catch(l){this.destination.error(l);return}c&&this.count++},s.prototype._complete=function(){this.destination.next(this.count),this.destination.complete()},s}(Subscriber);function debounce(a){return function(s){return s.lift(new DebounceOperator(a))}}var DebounceOperator=function(){function a(s){this.durationSelector=s}return a.prototype.call=function(s,d){return d.subscribe(new DebounceSubscriber(s,this.durationSelector))},a}(),DebounceSubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.durationSelector=c,l.hasValue=!1,l}return s.prototype._next=function(d){try{var c=this.durationSelector.call(this,d);c&&this._tryNext(d,c)}catch(l){this.destination.error(l)}},s.prototype._complete=function(){this.emitValue(),this.destination.complete()},s.prototype._tryNext=function(d,c){var l=this.durationSubscription;this.value=d,this.hasValue=!0,l&&(l.unsubscribe(),this.remove(l)),l=innerSubscribe(c,new SimpleInnerSubscriber(this)),l&&!l.closed&&this.add(this.durationSubscription=l)},s.prototype.notifyNext=function(){this.emitValue()},s.prototype.notifyComplete=function(){this.emitValue()},s.prototype.emitValue=function(){if(this.hasValue){var d=this.value,c=this.durationSubscription;c&&(this.durationSubscription=void 0,c.unsubscribe(),this.remove(c)),this.value=void 0,this.hasValue=!1,a.prototype._next.call(this,d)}},s}(SimpleOuterSubscriber);function debounceTime(a,s){return s===void 0&&(s=async),function(d){return d.lift(new DebounceTimeOperator(a,s))}}var DebounceTimeOperator=function(){function a(s,d){this.dueTime=s,this.scheduler=d}return a.prototype.call=function(s,d){return d.subscribe(new DebounceTimeSubscriber(s,this.dueTime,this.scheduler))},a}(),DebounceTimeSubscriber=function(a){__extends(s,a);function s(d,c,l){var p=a.call(this,d)||this;return p.dueTime=c,p.scheduler=l,p.debouncedSubscription=null,p.lastValue=null,p.hasValue=!1,p}return s.prototype._next=function(d){this.clearDebounce(),this.lastValue=d,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(dispatchNext$1,this.dueTime,this))},s.prototype._complete=function(){this.debouncedNext(),this.destination.complete()},s.prototype.debouncedNext=function(){if(this.clearDebounce(),this.hasValue){var d=this.lastValue;this.lastValue=null,this.hasValue=!1,this.destination.next(d)}},s.prototype.clearDebounce=function(){var d=this.debouncedSubscription;d!==null&&(this.remove(d),d.unsubscribe(),this.debouncedSubscription=null)},s}(Subscriber);function dispatchNext$1(a){a.debouncedNext()}function defaultIfEmpty(a){return a===void 0&&(a=null),function(s){return s.lift(new DefaultIfEmptyOperator(a))}}var DefaultIfEmptyOperator=function(){function a(s){this.defaultValue=s}return a.prototype.call=function(s,d){return d.subscribe(new DefaultIfEmptySubscriber(s,this.defaultValue))},a}(),DefaultIfEmptySubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.defaultValue=c,l.isEmpty=!0,l}return s.prototype._next=function(d){this.isEmpty=!1,this.destination.next(d)},s.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},s}(Subscriber);function isDate$1(a){return a instanceof Date&&!isNaN(+a)}var EMPTY=new Observable(function(a){return a.complete()});function empty$1(a){return a?emptyScheduled(a):EMPTY}function emptyScheduled(a){return new Observable(function(s){return a.schedule(function(){return s.complete()})})}function throwError(a,s){return s?new Observable(function(d){return s.schedule(dispatch,0,{error:a,subscriber:d})}):new Observable(function(d){return d.error(a)})}function dispatch(a){var s=a.error,d=a.subscriber;d.error(s)}var Notification=function(){function a(s,d,c){this.kind=s,this.value=d,this.error=c,this.hasValue=s==="N"}return a.prototype.observe=function(s){switch(this.kind){case"N":return s.next&&s.next(this.value);case"E":return s.error&&s.error(this.error);case"C":return s.complete&&s.complete()}},a.prototype.do=function(s,d,c){var l=this.kind;switch(l){case"N":return s&&s(this.value);case"E":return d&&d(this.error);case"C":return c&&c()}},a.prototype.accept=function(s,d,c){return s&&typeof s.next=="function"?this.observe(s):this.do(s,d,c)},a.prototype.toObservable=function(){var s=this.kind;switch(s){case"N":return of$1(this.value);case"E":return throwError(this.error);case"C":return empty$1()}throw new Error("unexpected notification kind value")},a.createNext=function(s){return typeof s!="undefined"?new a("N",s):a.undefinedValueNotification},a.createError=function(s){return new a("E",void 0,s)},a.createComplete=function(){return a.completeNotification},a.completeNotification=new a("C"),a.undefinedValueNotification=new a("N",void 0),a}();function delay(a,s){s===void 0&&(s=async);var d=isDate$1(a),c=d?+a-s.now():Math.abs(a);return function(l){return l.lift(new DelayOperator(c,s))}}var DelayOperator=function(){function a(s,d){this.delay=s,this.scheduler=d}return a.prototype.call=function(s,d){return d.subscribe(new DelaySubscriber(s,this.delay,this.scheduler))},a}(),DelaySubscriber=function(a){__extends(s,a);function s(d,c,l){var p=a.call(this,d)||this;return p.delay=c,p.scheduler=l,p.queue=[],p.active=!1,p.errored=!1,p}return s.dispatch=function(d){for(var c=d.source,l=c.queue,p=d.scheduler,h=d.destination;l.length>0&&l[0].time-p.now()<=0;)l.shift().notification.observe(h);if(l.length>0){var v=Math.max(0,l[0].time-p.now());this.schedule(d,v)}else this.unsubscribe(),c.active=!1},s.prototype._schedule=function(d){this.active=!0;var c=this.destination;c.add(d.schedule(s.dispatch,this.delay,{source:this,destination:this.destination,scheduler:d}))},s.prototype.scheduleNotification=function(d){if(this.errored!==!0){var c=this.scheduler,l=new DelayMessage(c.now()+this.delay,d);this.queue.push(l),this.active===!1&&this._schedule(c)}},s.prototype._next=function(d){this.scheduleNotification(Notification.createNext(d))},s.prototype._error=function(d){this.errored=!0,this.queue=[],this.destination.error(d),this.unsubscribe()},s.prototype._complete=function(){this.scheduleNotification(Notification.createComplete()),this.unsubscribe()},s}(Subscriber),DelayMessage=function(){function a(s,d){this.time=s,this.notification=d}return a}();function delayWhen(a,s){return s?function(d){return new SubscriptionDelayObservable(d,s).lift(new DelayWhenOperator(a))}:function(d){return d.lift(new DelayWhenOperator(a))}}var DelayWhenOperator=function(){function a(s){this.delayDurationSelector=s}return a.prototype.call=function(s,d){return d.subscribe(new DelayWhenSubscriber(s,this.delayDurationSelector))},a}(),DelayWhenSubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.delayDurationSelector=c,l.completed=!1,l.delayNotifierSubscriptions=[],l.index=0,l}return s.prototype.notifyNext=function(d,c,l,p,h){this.destination.next(d),this.removeSubscription(h),this.tryComplete()},s.prototype.notifyError=function(d,c){this._error(d)},s.prototype.notifyComplete=function(d){var c=this.removeSubscription(d);c&&this.destination.next(c),this.tryComplete()},s.prototype._next=function(d){var c=this.index++;try{var l=this.delayDurationSelector(d,c);l&&this.tryDelay(l,d)}catch(p){this.destination.error(p)}},s.prototype._complete=function(){this.completed=!0,this.tryComplete(),this.unsubscribe()},s.prototype.removeSubscription=function(d){d.unsubscribe();var c=this.delayNotifierSubscriptions.indexOf(d);return c!==-1&&this.delayNotifierSubscriptions.splice(c,1),d.outerValue},s.prototype.tryDelay=function(d,c){var l=subscribeToResult(this,d,c);if(l&&!l.closed){var p=this.destination;p.add(l),this.delayNotifierSubscriptions.push(l)}},s.prototype.tryComplete=function(){this.completed&&this.delayNotifierSubscriptions.length===0&&this.destination.complete()},s}(OuterSubscriber),SubscriptionDelayObservable=function(a){__extends(s,a);function s(d,c){var l=a.call(this)||this;return l.source=d,l.subscriptionDelay=c,l}return s.prototype._subscribe=function(d){this.subscriptionDelay.subscribe(new SubscriptionDelaySubscriber(d,this.source))},s}(Observable),SubscriptionDelaySubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this)||this;return l.parent=d,l.source=c,l.sourceSubscribed=!1,l}return s.prototype._next=function(d){this.subscribeToSource()},s.prototype._error=function(d){this.unsubscribe(),this.parent.error(d)},s.prototype._complete=function(){this.unsubscribe(),this.subscribeToSource()},s.prototype.subscribeToSource=function(){this.sourceSubscribed||(this.sourceSubscribed=!0,this.unsubscribe(),this.source.subscribe(this.parent))},s}(Subscriber);function dematerialize(){return function(s){return s.lift(new DeMaterializeOperator)}}var DeMaterializeOperator=function(){function a(){}return a.prototype.call=function(s,d){return d.subscribe(new DeMaterializeSubscriber(s))},a}(),DeMaterializeSubscriber=function(a){__extends(s,a);function s(d){return a.call(this,d)||this}return s.prototype._next=function(d){d.observe(this.destination)},s}(Subscriber);function distinct(a,s){return function(d){return d.lift(new DistinctOperator(a,s))}}var DistinctOperator=function(){function a(s,d){this.keySelector=s,this.flushes=d}return a.prototype.call=function(s,d){return d.subscribe(new DistinctSubscriber(s,this.keySelector,this.flushes))},a}(),DistinctSubscriber=function(a){__extends(s,a);function s(d,c,l){var p=a.call(this,d)||this;return p.keySelector=c,p.values=new Set,l&&p.add(innerSubscribe(l,new SimpleInnerSubscriber(p))),p}return s.prototype.notifyNext=function(){this.values.clear()},s.prototype.notifyError=function(d){this._error(d)},s.prototype._next=function(d){this.keySelector?this._useKeySelector(d):this._finalizeNext(d,d)},s.prototype._useKeySelector=function(d){var c,l=this.destination;try{c=this.keySelector(d)}catch(p){l.error(p);return}this._finalizeNext(c,d)},s.prototype._finalizeNext=function(d,c){var l=this.values;l.has(d)||(l.add(d),this.destination.next(c))},s}(SimpleOuterSubscriber);function distinctUntilChanged(a,s){return function(d){return d.lift(new DistinctUntilChangedOperator(a,s))}}var DistinctUntilChangedOperator=function(){function a(s,d){this.compare=s,this.keySelector=d}return a.prototype.call=function(s,d){return d.subscribe(new DistinctUntilChangedSubscriber(s,this.compare,this.keySelector))},a}(),DistinctUntilChangedSubscriber=function(a){__extends(s,a);function s(d,c,l){var p=a.call(this,d)||this;return p.keySelector=l,p.hasKey=!1,typeof c=="function"&&(p.compare=c),p}return s.prototype.compare=function(d,c){return d===c},s.prototype._next=function(d){var c;try{var l=this.keySelector;c=l?l(d):d}catch(v){return this.destination.error(v)}var p=!1;if(this.hasKey)try{var h=this.compare;p=h(this.key,c)}catch(v){return this.destination.error(v)}else this.hasKey=!0;p||(this.key=c,this.destination.next(d))},s}(Subscriber);function distinctUntilKeyChanged(a,s){return distinctUntilChanged(function(d,c){return s?s(d[a],c[a]):d[a]===c[a]})}var ArgumentOutOfRangeErrorImpl=function(){function a(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return a.prototype=Object.create(Error.prototype),a}(),ArgumentOutOfRangeError=ArgumentOutOfRangeErrorImpl;function filter(a,s){return function(c){return c.lift(new FilterOperator(a,s))}}var FilterOperator=function(){function a(s,d){this.predicate=s,this.thisArg=d}return a.prototype.call=function(s,d){return d.subscribe(new FilterSubscriber(s,this.predicate,this.thisArg))},a}(),FilterSubscriber=function(a){__extends(s,a);function s(d,c,l){var p=a.call(this,d)||this;return p.predicate=c,p.thisArg=l,p.count=0,p}return s.prototype._next=function(d){var c;try{c=this.predicate.call(this.thisArg,d,this.count++)}catch(l){this.destination.error(l);return}c&&this.destination.next(d)},s}(Subscriber),EmptyErrorImpl=function(){function a(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return a.prototype=Object.create(Error.prototype),a}(),EmptyError=EmptyErrorImpl;function throwIfEmpty(a){return a===void 0&&(a=defaultErrorFactory),function(s){return s.lift(new ThrowIfEmptyOperator(a))}}var ThrowIfEmptyOperator=function(){function a(s){this.errorFactory=s}return a.prototype.call=function(s,d){return d.subscribe(new ThrowIfEmptySubscriber(s,this.errorFactory))},a}(),ThrowIfEmptySubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.errorFactory=c,l.hasValue=!1,l}return s.prototype._next=function(d){this.hasValue=!0,this.destination.next(d)},s.prototype._complete=function(){if(this.hasValue)return this.destination.complete();var d=void 0;try{d=this.errorFactory()}catch(c){d=c}this.destination.error(d)},s}(Subscriber);function defaultErrorFactory(){return new EmptyError}function take(a){return function(s){return a===0?empty$1():s.lift(new TakeOperator(a))}}var TakeOperator=function(){function a(s){if(this.total=s,this.total<0)throw new ArgumentOutOfRangeError}return a.prototype.call=function(s,d){return d.subscribe(new TakeSubscriber(s,this.total))},a}(),TakeSubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.total=c,l.count=0,l}return s.prototype._next=function(d){var c=this.total,l=++this.count;l<=c&&(this.destination.next(d),l===c&&(this.destination.complete(),this.unsubscribe()))},s}(Subscriber);function elementAt(a,s){if(a<0)throw new ArgumentOutOfRangeError;var d=arguments.length>=2;return function(c){return c.pipe(filter(function(l,p){return p===a}),take(1),d?defaultIfEmpty(s):throwIfEmpty(function(){return new ArgumentOutOfRangeError}))}}function endWith(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];return function(d){return concat$1(d,of$1.apply(void 0,a))}}function every(a,s){return function(d){return d.lift(new EveryOperator(a,s,d))}}var EveryOperator=function(){function a(s,d,c){this.predicate=s,this.thisArg=d,this.source=c}return a.prototype.call=function(s,d){return d.subscribe(new EverySubscriber(s,this.predicate,this.thisArg,this.source))},a}(),EverySubscriber=function(a){__extends(s,a);function s(d,c,l,p){var h=a.call(this,d)||this;return h.predicate=c,h.thisArg=l,h.source=p,h.index=0,h.thisArg=l||h,h}return s.prototype.notifyComplete=function(d){this.destination.next(d),this.destination.complete()},s.prototype._next=function(d){var c=!1;try{c=this.predicate.call(this.thisArg,d,this.index++,this.source)}catch(l){this.destination.error(l);return}c||this.notifyComplete(!1)},s.prototype._complete=function(){this.notifyComplete(!0)},s}(Subscriber);function exhaust(){return function(a){return a.lift(new SwitchFirstOperator)}}var SwitchFirstOperator=function(){function a(){}return a.prototype.call=function(s,d){return d.subscribe(new SwitchFirstSubscriber(s))},a}(),SwitchFirstSubscriber=function(a){__extends(s,a);function s(d){var c=a.call(this,d)||this;return c.hasCompleted=!1,c.hasSubscription=!1,c}return s.prototype._next=function(d){this.hasSubscription||(this.hasSubscription=!0,this.add(innerSubscribe(d,new SimpleInnerSubscriber(this))))},s.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete()},s.prototype.notifyComplete=function(){this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},s}(SimpleOuterSubscriber);function exhaustMap(a,s){return s?function(d){return d.pipe(exhaustMap(function(c,l){return from(a(c,l)).pipe(map(function(p,h){return s(c,p,l,h)}))}))}:function(d){return d.lift(new ExhaustMapOperator(a))}}var ExhaustMapOperator=function(){function a(s){this.project=s}return a.prototype.call=function(s,d){return d.subscribe(new ExhaustMapSubscriber(s,this.project))},a}(),ExhaustMapSubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.project=c,l.hasSubscription=!1,l.hasCompleted=!1,l.index=0,l}return s.prototype._next=function(d){this.hasSubscription||this.tryNext(d)},s.prototype.tryNext=function(d){var c,l=this.index++;try{c=this.project(d,l)}catch(p){this.destination.error(p);return}this.hasSubscription=!0,this._innerSub(c)},s.prototype._innerSub=function(d){var c=new SimpleInnerSubscriber(this),l=this.destination;l.add(c);var p=innerSubscribe(d,c);p!==c&&l.add(p)},s.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete(),this.unsubscribe()},s.prototype.notifyNext=function(d){this.destination.next(d)},s.prototype.notifyError=function(d){this.destination.error(d)},s.prototype.notifyComplete=function(){this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},s}(SimpleOuterSubscriber);function expand(a,s,d){return s===void 0&&(s=Number.POSITIVE_INFINITY),s=(s||0)<1?Number.POSITIVE_INFINITY:s,function(c){return c.lift(new ExpandOperator(a,s,d))}}var ExpandOperator=function(){function a(s,d,c){this.project=s,this.concurrent=d,this.scheduler=c}return a.prototype.call=function(s,d){return d.subscribe(new ExpandSubscriber(s,this.project,this.concurrent,this.scheduler))},a}(),ExpandSubscriber=function(a){__extends(s,a);function s(d,c,l,p){var h=a.call(this,d)||this;return h.project=c,h.concurrent=l,h.scheduler=p,h.index=0,h.active=0,h.hasCompleted=!1,l<Number.POSITIVE_INFINITY&&(h.buffer=[]),h}return s.dispatch=function(d){var c=d.subscriber,l=d.result,p=d.value,h=d.index;c.subscribeToProjection(l,p,h)},s.prototype._next=function(d){var c=this.destination;if(c.closed){this._complete();return}var l=this.index++;if(this.active<this.concurrent){c.next(d);try{var p=this.project,h=p(d,l);if(!this.scheduler)this.subscribeToProjection(h,d,l);else{var v={subscriber:this,result:h,value:d,index:l},S=this.destination;S.add(this.scheduler.schedule(s.dispatch,0,v))}}catch(b){c.error(b)}}else this.buffer.push(d)},s.prototype.subscribeToProjection=function(d,c,l){this.active++;var p=this.destination;p.add(innerSubscribe(d,new SimpleInnerSubscriber(this)))},s.prototype._complete=function(){this.hasCompleted=!0,this.hasCompleted&&this.active===0&&this.destination.complete(),this.unsubscribe()},s.prototype.notifyNext=function(d){this._next(d)},s.prototype.notifyComplete=function(){var d=this.buffer;this.active--,d&&d.length>0&&this._next(d.shift()),this.hasCompleted&&this.active===0&&this.destination.complete()},s}(SimpleOuterSubscriber);function finalize(a){return function(s){return s.lift(new FinallyOperator(a))}}var FinallyOperator=function(){function a(s){this.callback=s}return a.prototype.call=function(s,d){return d.subscribe(new FinallySubscriber(s,this.callback))},a}(),FinallySubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.add(new Subscription(c)),l}return s}(Subscriber);function find$1(a,s){if(typeof a!="function")throw new TypeError("predicate is not a function");return function(d){return d.lift(new FindValueOperator(a,d,!1,s))}}var FindValueOperator=function(){function a(s,d,c,l){this.predicate=s,this.source=d,this.yieldIndex=c,this.thisArg=l}return a.prototype.call=function(s,d){return d.subscribe(new FindValueSubscriber(s,this.predicate,this.source,this.yieldIndex,this.thisArg))},a}(),FindValueSubscriber=function(a){__extends(s,a);function s(d,c,l,p,h){var v=a.call(this,d)||this;return v.predicate=c,v.source=l,v.yieldIndex=p,v.thisArg=h,v.index=0,v}return s.prototype.notifyComplete=function(d){var c=this.destination;c.next(d),c.complete(),this.unsubscribe()},s.prototype._next=function(d){var c=this,l=c.predicate,p=c.thisArg,h=this.index++;try{var v=l.call(p||this,d,h,this.source);v&&this.notifyComplete(this.yieldIndex?h:d)}catch(S){this.destination.error(S)}},s.prototype._complete=function(){this.notifyComplete(this.yieldIndex?-1:void 0)},s}(Subscriber);function findIndex(a,s){return function(d){return d.lift(new FindValueOperator(a,d,!0,s))}}function first(a,s){var d=arguments.length>=2;return function(c){return c.pipe(a?filter(function(l,p){return a(l,p,c)}):identity,take(1),d?defaultIfEmpty(s):throwIfEmpty(function(){return new EmptyError}))}}var ObjectUnsubscribedErrorImpl=function(){function a(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return a.prototype=Object.create(Error.prototype),a}(),ObjectUnsubscribedError=ObjectUnsubscribedErrorImpl,SubjectSubscription=function(a){__extends(s,a);function s(d,c){var l=a.call(this)||this;return l.subject=d,l.subscriber=c,l.closed=!1,l}return s.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var d=this.subject,c=d.observers;if(this.subject=null,!(!c||c.length===0||d.isStopped||d.closed)){var l=c.indexOf(this.subscriber);l!==-1&&c.splice(l,1)}}},s}(Subscription),SubjectSubscriber=function(a){__extends(s,a);function s(d){var c=a.call(this,d)||this;return c.destination=d,c}return s}(Subscriber),Subject=function(a){__extends(s,a);function s(){var d=a.call(this)||this;return d.observers=[],d.closed=!1,d.isStopped=!1,d.hasError=!1,d.thrownError=null,d}return s.prototype[rxSubscriber]=function(){return new SubjectSubscriber(this)},s.prototype.lift=function(d){var c=new AnonymousSubject(this,this);return c.operator=d,c},s.prototype.next=function(d){if(this.closed)throw new ObjectUnsubscribedError;if(!this.isStopped)for(var c=this.observers,l=c.length,p=c.slice(),h=0;h<l;h++)p[h].next(d)},s.prototype.error=function(d){if(this.closed)throw new ObjectUnsubscribedError;this.hasError=!0,this.thrownError=d,this.isStopped=!0;for(var c=this.observers,l=c.length,p=c.slice(),h=0;h<l;h++)p[h].error(d);this.observers.length=0},s.prototype.complete=function(){if(this.closed)throw new ObjectUnsubscribedError;this.isStopped=!0;for(var d=this.observers,c=d.length,l=d.slice(),p=0;p<c;p++)l[p].complete();this.observers.length=0},s.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},s.prototype._trySubscribe=function(d){if(this.closed)throw new ObjectUnsubscribedError;return a.prototype._trySubscribe.call(this,d)},s.prototype._subscribe=function(d){if(this.closed)throw new ObjectUnsubscribedError;return this.hasError?(d.error(this.thrownError),Subscription.EMPTY):this.isStopped?(d.complete(),Subscription.EMPTY):(this.observers.push(d),new SubjectSubscription(this,d))},s.prototype.asObservable=function(){var d=new Observable;return d.source=this,d},s.create=function(d,c){return new AnonymousSubject(d,c)},s}(Observable),AnonymousSubject=function(a){__extends(s,a);function s(d,c){var l=a.call(this)||this;return l.destination=d,l.source=c,l}return s.prototype.next=function(d){var c=this.destination;c&&c.next&&c.next(d)},s.prototype.error=function(d){var c=this.destination;c&&c.error&&this.destination.error(d)},s.prototype.complete=function(){var d=this.destination;d&&d.complete&&this.destination.complete()},s.prototype._subscribe=function(d){var c=this.source;return c?this.source.subscribe(d):Subscription.EMPTY},s}(Subject);function groupBy(a,s,d,c){return function(l){return l.lift(new GroupByOperator(a,s,d,c))}}var GroupByOperator=function(){function a(s,d,c,l){this.keySelector=s,this.elementSelector=d,this.durationSelector=c,this.subjectSelector=l}return a.prototype.call=function(s,d){return d.subscribe(new GroupBySubscriber(s,this.keySelector,this.elementSelector,this.durationSelector,this.subjectSelector))},a}(),GroupBySubscriber=function(a){__extends(s,a);function s(d,c,l,p,h){var v=a.call(this,d)||this;return v.keySelector=c,v.elementSelector=l,v.durationSelector=p,v.subjectSelector=h,v.groups=null,v.attemptedToUnsubscribe=!1,v.count=0,v}return s.prototype._next=function(d){var c;try{c=this.keySelector(d)}catch(l){this.error(l);return}this._group(d,c)},s.prototype._group=function(d,c){var l=this.groups;l||(l=this.groups=new Map);var p=l.get(c),h;if(this.elementSelector)try{h=this.elementSelector(d)}catch(b){this.error(b)}else h=d;if(!p){p=this.subjectSelector?this.subjectSelector():new Subject,l.set(c,p);var v=new GroupedObservable(c,p,this);if(this.destination.next(v),this.durationSelector){var S=void 0;try{S=this.durationSelector(new GroupedObservable(c,p))}catch(b){this.error(b);return}this.add(S.subscribe(new GroupDurationSubscriber(c,p,this)))}}p.closed||p.next(h)},s.prototype._error=function(d){var c=this.groups;c&&(c.forEach(function(l,p){l.error(d)}),c.clear()),this.destination.error(d)},s.prototype._complete=function(){var d=this.groups;d&&(d.forEach(function(c,l){c.complete()}),d.clear()),this.destination.complete()},s.prototype.removeGroup=function(d){this.groups.delete(d)},s.prototype.unsubscribe=function(){this.closed||(this.attemptedToUnsubscribe=!0,this.count===0&&a.prototype.unsubscribe.call(this))},s}(Subscriber),GroupDurationSubscriber=function(a){__extends(s,a);function s(d,c,l){var p=a.call(this,c)||this;return p.key=d,p.group=c,p.parent=l,p}return s.prototype._next=function(d){this.complete()},s.prototype._unsubscribe=function(){var d=this,c=d.parent,l=d.key;this.key=this.parent=null,c&&c.removeGroup(l)},s}(Subscriber),GroupedObservable=function(a){__extends(s,a);function s(d,c,l){var p=a.call(this)||this;return p.key=d,p.groupSubject=c,p.refCountSubscription=l,p}return s.prototype._subscribe=function(d){var c=new Subscription,l=this,p=l.refCountSubscription,h=l.groupSubject;return p&&!p.closed&&c.add(new InnerRefCountSubscription(p)),c.add(h.subscribe(d)),c},s}(Observable),InnerRefCountSubscription=function(a){__extends(s,a);function s(d){var c=a.call(this)||this;return c.parent=d,d.count++,c}return s.prototype.unsubscribe=function(){var d=this.parent;!d.closed&&!this.closed&&(a.prototype.unsubscribe.call(this),d.count-=1,d.count===0&&d.attemptedToUnsubscribe&&d.unsubscribe())},s}(Subscription);function ignoreElements(){return function(s){return s.lift(new IgnoreElementsOperator)}}var IgnoreElementsOperator=function(){function a(){}return a.prototype.call=function(s,d){return d.subscribe(new IgnoreElementsSubscriber(s))},a}(),IgnoreElementsSubscriber=function(a){__extends(s,a);function s(){return a!==null&&a.apply(this,arguments)||this}return s.prototype._next=function(d){},s}(Subscriber);function isEmpty(){return function(a){return a.lift(new IsEmptyOperator)}}var IsEmptyOperator=function(){function a(){}return a.prototype.call=function(s,d){return d.subscribe(new IsEmptySubscriber(s))},a}(),IsEmptySubscriber=function(a){__extends(s,a);function s(d){return a.call(this,d)||this}return s.prototype.notifyComplete=function(d){var c=this.destination;c.next(d),c.complete()},s.prototype._next=function(d){this.notifyComplete(!1)},s.prototype._complete=function(){this.notifyComplete(!0)},s}(Subscriber);function takeLast(a){return function(d){return a===0?empty$1():d.lift(new TakeLastOperator(a))}}var TakeLastOperator=function(){function a(s){if(this.total=s,this.total<0)throw new ArgumentOutOfRangeError}return a.prototype.call=function(s,d){return d.subscribe(new TakeLastSubscriber(s,this.total))},a}(),TakeLastSubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.total=c,l.ring=new Array,l.count=0,l}return s.prototype._next=function(d){var c=this.ring,l=this.total,p=this.count++;if(c.length<l)c.push(d);else{var h=p%l;c[h]=d}},s.prototype._complete=function(){var d=this.destination,c=this.count;if(c>0)for(var l=this.count>=this.total?this.total:this.count,p=this.ring,h=0;h<l;h++){var v=c++%l;d.next(p[v])}d.complete()},s}(Subscriber);function last(a,s){var d=arguments.length>=2;return function(c){return c.pipe(a?filter(function(l,p){return a(l,p,c)}):identity,takeLast(1),d?defaultIfEmpty(s):throwIfEmpty(function(){return new EmptyError}))}}function mapTo(a){return function(s){return s.lift(new MapToOperator(a))}}var MapToOperator=function(){function a(s){this.value=s}return a.prototype.call=function(s,d){return d.subscribe(new MapToSubscriber(s,this.value))},a}(),MapToSubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.value=c,l}return s.prototype._next=function(d){this.destination.next(this.value)},s}(Subscriber);function materialize(){return function(s){return s.lift(new MaterializeOperator)}}var MaterializeOperator=function(){function a(){}return a.prototype.call=function(s,d){return d.subscribe(new MaterializeSubscriber(s))},a}(),MaterializeSubscriber=function(a){__extends(s,a);function s(d){return a.call(this,d)||this}return s.prototype._next=function(d){this.destination.next(Notification.createNext(d))},s.prototype._error=function(d){var c=this.destination;c.next(Notification.createError(d)),c.complete()},s.prototype._complete=function(){var d=this.destination;d.next(Notification.createComplete()),d.complete()},s}(Subscriber);function scan(a,s){var d=!1;return arguments.length>=2&&(d=!0),function(l){return l.lift(new ScanOperator(a,s,d))}}var ScanOperator=function(){function a(s,d,c){c===void 0&&(c=!1),this.accumulator=s,this.seed=d,this.hasSeed=c}return a.prototype.call=function(s,d){return d.subscribe(new ScanSubscriber(s,this.accumulator,this.seed,this.hasSeed))},a}(),ScanSubscriber=function(a){__extends(s,a);function s(d,c,l,p){var h=a.call(this,d)||this;return h.accumulator=c,h._seed=l,h.hasSeed=p,h.index=0,h}return Object.defineProperty(s.prototype,"seed",{get:function(){return this._seed},set:function(d){this.hasSeed=!0,this._seed=d},enumerable:!0,configurable:!0}),s.prototype._next=function(d){if(!this.hasSeed)this.seed=d,this.destination.next(d);else return this._tryNext(d)},s.prototype._tryNext=function(d){var c=this.index++,l;try{l=this.accumulator(this.seed,d,c)}catch(p){this.destination.error(p)}this.seed=l,this.destination.next(l)},s}(Subscriber);function reduce(a,s){return arguments.length>=2?function(c){return pipe(scan(a,s),takeLast(1),defaultIfEmpty(s))(c)}:function(c){return pipe(scan(function(l,p,h){return a(l,p,h+1)}),takeLast(1))(c)}}function max(a){var s=typeof a=="function"?function(d,c){return a(d,c)>0?d:c}:function(d,c){return d>c?d:c};return reduce(s)}function merge$2(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];var d=Number.POSITIVE_INFINITY,c=null,l=a[a.length-1];return isScheduler(l)?(c=a.pop(),a.length>1&&typeof a[a.length-1]=="number"&&(d=a.pop())):typeof l=="number"&&(d=a.pop()),c===null&&a.length===1&&a[0]instanceof Observable?a[0]:mergeAll(d)(fromArray(a,c))}function merge$1(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];return function(d){return d.lift.call(merge$2.apply(void 0,[d].concat(a)))}}function mergeMapTo(a,s,d){return d===void 0&&(d=Number.POSITIVE_INFINITY),typeof s=="function"?mergeMap(function(){return a},s,d):(typeof s=="number"&&(d=s),mergeMap(function(){return a},d))}function mergeScan(a,s,d){return d===void 0&&(d=Number.POSITIVE_INFINITY),function(c){return c.lift(new MergeScanOperator(a,s,d))}}var MergeScanOperator=function(){function a(s,d,c){this.accumulator=s,this.seed=d,this.concurrent=c}return a.prototype.call=function(s,d){return d.subscribe(new MergeScanSubscriber(s,this.accumulator,this.seed,this.concurrent))},a}(),MergeScanSubscriber=function(a){__extends(s,a);function s(d,c,l,p){var h=a.call(this,d)||this;return h.accumulator=c,h.acc=l,h.concurrent=p,h.hasValue=!1,h.hasCompleted=!1,h.buffer=[],h.active=0,h.index=0,h}return s.prototype._next=function(d){if(this.active<this.concurrent){var c=this.index++,l=this.destination,p=void 0;try{var h=this.accumulator;p=h(this.acc,d,c)}catch(v){return l.error(v)}this.active++,this._innerSub(p)}else this.buffer.push(d)},s.prototype._innerSub=function(d){var c=new SimpleInnerSubscriber(this),l=this.destination;l.add(c);var p=innerSubscribe(d,c);p!==c&&l.add(p)},s.prototype._complete=function(){this.hasCompleted=!0,this.active===0&&this.buffer.length===0&&(this.hasValue===!1&&this.destination.next(this.acc),this.destination.complete()),this.unsubscribe()},s.prototype.notifyNext=function(d){var c=this.destination;this.acc=d,this.hasValue=!0,c.next(d)},s.prototype.notifyComplete=function(){var d=this.buffer;this.active--,d.length>0?this._next(d.shift()):this.active===0&&this.hasCompleted&&(this.hasValue===!1&&this.destination.next(this.acc),this.destination.complete())},s}(SimpleOuterSubscriber);function min(a){var s=typeof a=="function"?function(d,c){return a(d,c)<0?d:c}:function(d,c){return d<c?d:c};return reduce(s)}function refCount(){return function(s){return s.lift(new RefCountOperator(s))}}var RefCountOperator=function(){function a(s){this.connectable=s}return a.prototype.call=function(s,d){var c=this.connectable;c._refCount++;var l=new RefCountSubscriber(s,c),p=d.subscribe(l);return l.closed||(l.connection=c.connect()),p},a}(),RefCountSubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.connectable=c,l}return s.prototype._unsubscribe=function(){var d=this.connectable;if(!d){this.connection=null;return}this.connectable=null;var c=d._refCount;if(c<=0){this.connection=null;return}if(d._refCount=c-1,c>1){this.connection=null;return}var l=this.connection,p=d._connection;this.connection=null,p&&(!l||p===l)&&p.unsubscribe()},s}(Subscriber),ConnectableObservable=function(a){__extends(s,a);function s(d,c){var l=a.call(this)||this;return l.source=d,l.subjectFactory=c,l._refCount=0,l._isComplete=!1,l}return s.prototype._subscribe=function(d){return this.getSubject().subscribe(d)},s.prototype.getSubject=function(){var d=this._subject;return(!d||d.isStopped)&&(this._subject=this.subjectFactory()),this._subject},s.prototype.connect=function(){var d=this._connection;return d||(this._isComplete=!1,d=this._connection=new Subscription,d.add(this.source.subscribe(new ConnectableSubscriber(this.getSubject(),this))),d.closed&&(this._connection=null,d=Subscription.EMPTY)),d},s.prototype.refCount=function(){return refCount()(this)},s}(Observable),connectableObservableDescriptor=function(){var a=ConnectableObservable.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:a._subscribe},_isComplete:{value:a._isComplete,writable:!0},getSubject:{value:a.getSubject},connect:{value:a.connect},refCount:{value:a.refCount}}}(),ConnectableSubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.connectable=c,l}return s.prototype._error=function(d){this._unsubscribe(),a.prototype._error.call(this,d)},s.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),a.prototype._complete.call(this)},s.prototype._unsubscribe=function(){var d=this.connectable;if(d){this.connectable=null;var c=d._connection;d._refCount=0,d._subject=null,d._connection=null,c&&c.unsubscribe()}},s}(SubjectSubscriber);function multicast(a,s){return function(c){var l;if(typeof a=="function"?l=a:l=function(){return a},typeof s=="function")return c.lift(new MulticastOperator(l,s));var p=Object.create(c,connectableObservableDescriptor);return p.source=c,p.subjectFactory=l,p}}var MulticastOperator=function(){function a(s,d){this.subjectFactory=s,this.selector=d}return a.prototype.call=function(s,d){var c=this.selector,l=this.subjectFactory(),p=c(l).subscribe(s);return p.add(d.subscribe(l)),p},a}();function observeOn(a,s){return s===void 0&&(s=0),function(c){return c.lift(new ObserveOnOperator(a,s))}}var ObserveOnOperator=function(){function a(s,d){d===void 0&&(d=0),this.scheduler=s,this.delay=d}return a.prototype.call=function(s,d){return d.subscribe(new ObserveOnSubscriber(s,this.scheduler,this.delay))},a}(),ObserveOnSubscriber=function(a){__extends(s,a);function s(d,c,l){l===void 0&&(l=0);var p=a.call(this,d)||this;return p.scheduler=c,p.delay=l,p}return s.dispatch=function(d){var c=d.notification,l=d.destination;c.observe(l),this.unsubscribe()},s.prototype.scheduleMessage=function(d){var c=this.destination;c.add(this.scheduler.schedule(s.dispatch,this.delay,new ObserveOnMessage(d,this.destination)))},s.prototype._next=function(d){this.scheduleMessage(Notification.createNext(d))},s.prototype._error=function(d){this.scheduleMessage(Notification.createError(d)),this.unsubscribe()},s.prototype._complete=function(){this.scheduleMessage(Notification.createComplete()),this.unsubscribe()},s}(Subscriber),ObserveOnMessage=function(){function a(s,d){this.notification=s,this.destination=d}return a}();function onErrorResumeNext(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];return a.length===1&&isArray$2(a[0])&&(a=a[0]),function(d){return d.lift(new OnErrorResumeNextOperator(a))}}var OnErrorResumeNextOperator=function(){function a(s){this.nextSources=s}return a.prototype.call=function(s,d){return d.subscribe(new OnErrorResumeNextSubscriber(s,this.nextSources))},a}(),OnErrorResumeNextSubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.destination=d,l.nextSources=c,l}return s.prototype.notifyError=function(){this.subscribeToNextSource()},s.prototype.notifyComplete=function(){this.subscribeToNextSource()},s.prototype._error=function(d){this.subscribeToNextSource(),this.unsubscribe()},s.prototype._complete=function(){this.subscribeToNextSource(),this.unsubscribe()},s.prototype.subscribeToNextSource=function(){var d=this.nextSources.shift();if(d){var c=new SimpleInnerSubscriber(this),l=this.destination;l.add(c);var p=innerSubscribe(d,c);p!==c&&l.add(p)}else this.destination.complete()},s}(SimpleOuterSubscriber);function pairwise(){return function(a){return a.lift(new PairwiseOperator)}}var PairwiseOperator=function(){function a(){}return a.prototype.call=function(s,d){return d.subscribe(new PairwiseSubscriber(s))},a}(),PairwiseSubscriber=function(a){__extends(s,a);function s(d){var c=a.call(this,d)||this;return c.hasPrev=!1,c}return s.prototype._next=function(d){var c;this.hasPrev?c=[this.prev,d]:this.hasPrev=!0,this.prev=d,c&&this.destination.next(c)},s}(Subscriber);function not(a,s){function d(){return!d.pred.apply(d.thisArg,arguments)}return d.pred=a,d.thisArg=s,d}function partition(a,s){return function(d){return[filter(a,s)(d),filter(not(a,s))(d)]}}function pluck(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];var d=a.length;if(d===0)throw new Error("list of properties cannot be empty.");return function(c){return map(plucker(a,d))(c)}}function plucker(a,s){var d=function(c){for(var l=c,p=0;p<s;p++){var h=l!=null?l[a[p]]:void 0;if(h!==void 0)l=h;else return}return l};return d}function publish(a){return a?multicast(function(){return new Subject},a):multicast(new Subject)}var BehaviorSubject=function(a){__extends(s,a);function s(d){var c=a.call(this)||this;return c._value=d,c}return Object.defineProperty(s.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),s.prototype._subscribe=function(d){var c=a.prototype._subscribe.call(this,d);return c&&!c.closed&&d.next(this._value),c},s.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new ObjectUnsubscribedError;return this._value},s.prototype.next=function(d){a.prototype.next.call(this,this._value=d)},s}(Subject);function publishBehavior(a){return function(s){return multicast(new BehaviorSubject(a))(s)}}var AsyncSubject=function(a){__extends(s,a);function s(){var d=a!==null&&a.apply(this,arguments)||this;return d.value=null,d.hasNext=!1,d.hasCompleted=!1,d}return s.prototype._subscribe=function(d){return this.hasError?(d.error(this.thrownError),Subscription.EMPTY):this.hasCompleted&&this.hasNext?(d.next(this.value),d.complete(),Subscription.EMPTY):a.prototype._subscribe.call(this,d)},s.prototype.next=function(d){this.hasCompleted||(this.value=d,this.hasNext=!0)},s.prototype.error=function(d){this.hasCompleted||a.prototype.error.call(this,d)},s.prototype.complete=function(){this.hasCompleted=!0,this.hasNext&&a.prototype.next.call(this,this.value),a.prototype.complete.call(this)},s}(Subject);function publishLast(){return function(a){return multicast(new AsyncSubject)(a)}}var QueueAction=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d,c)||this;return l.scheduler=d,l.work=c,l}return s.prototype.schedule=function(d,c){return c===void 0&&(c=0),c>0?a.prototype.schedule.call(this,d,c):(this.delay=c,this.state=d,this.scheduler.flush(this),this)},s.prototype.execute=function(d,c){return c>0||this.closed?a.prototype.execute.call(this,d,c):this._execute(d,c)},s.prototype.requestAsyncId=function(d,c,l){return l===void 0&&(l=0),l!==null&&l>0||l===null&&this.delay>0?a.prototype.requestAsyncId.call(this,d,c,l):d.flush(this)},s}(AsyncAction),QueueScheduler=function(a){__extends(s,a);function s(){return a!==null&&a.apply(this,arguments)||this}return s}(AsyncScheduler),queueScheduler=new QueueScheduler(QueueAction),queue=queueScheduler,ReplaySubject=function(a){__extends(s,a);function s(d,c,l){d===void 0&&(d=Number.POSITIVE_INFINITY),c===void 0&&(c=Number.POSITIVE_INFINITY);var p=a.call(this)||this;return p.scheduler=l,p._events=[],p._infiniteTimeWindow=!1,p._bufferSize=d<1?1:d,p._windowTime=c<1?1:c,c===Number.POSITIVE_INFINITY?(p._infiniteTimeWindow=!0,p.next=p.nextInfiniteTimeWindow):p.next=p.nextTimeWindow,p}return s.prototype.nextInfiniteTimeWindow=function(d){if(!this.isStopped){var c=this._events;c.push(d),c.length>this._bufferSize&&c.shift()}a.prototype.next.call(this,d)},s.prototype.nextTimeWindow=function(d){this.isStopped||(this._events.push(new ReplayEvent(this._getNow(),d)),this._trimBufferThenGetEvents()),a.prototype.next.call(this,d)},s.prototype._subscribe=function(d){var c=this._infiniteTimeWindow,l=c?this._events:this._trimBufferThenGetEvents(),p=this.scheduler,h=l.length,v;if(this.closed)throw new ObjectUnsubscribedError;if(this.isStopped||this.hasError?v=Subscription.EMPTY:(this.observers.push(d),v=new SubjectSubscription(this,d)),p&&d.add(d=new ObserveOnSubscriber(d,p)),c)for(var S=0;S<h&&!d.closed;S++)d.next(l[S]);else for(var S=0;S<h&&!d.closed;S++)d.next(l[S].value);return this.hasError?d.error(this.thrownError):this.isStopped&&d.complete(),v},s.prototype._getNow=function(){return(this.scheduler||queue).now()},s.prototype._trimBufferThenGetEvents=function(){for(var d=this._getNow(),c=this._bufferSize,l=this._windowTime,p=this._events,h=p.length,v=0;v<h&&!(d-p[v].time<l);)v++;return h>c&&(v=Math.max(v,h-c)),v>0&&p.splice(0,v),p},s}(Subject),ReplayEvent=function(){function a(s,d){this.time=s,this.value=d}return a}();function publishReplay(a,s,d,c){d&&typeof d!="function"&&(c=d);var l=typeof d=="function"?d:void 0,p=new ReplaySubject(a,s,c);return function(h){return multicast(function(){return p},l)(h)}}function race$1(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];if(a.length===1)if(isArray$2(a[0]))a=a[0];else return a[0];return fromArray(a,void 0).lift(new RaceOperator)}var RaceOperator=function(){function a(){}return a.prototype.call=function(s,d){return d.subscribe(new RaceSubscriber(s))},a}(),RaceSubscriber=function(a){__extends(s,a);function s(d){var c=a.call(this,d)||this;return c.hasFirst=!1,c.observables=[],c.subscriptions=[],c}return s.prototype._next=function(d){this.observables.push(d)},s.prototype._complete=function(){var d=this.observables,c=d.length;if(c===0)this.destination.complete();else{for(var l=0;l<c&&!this.hasFirst;l++){var p=d[l],h=subscribeToResult(this,p,void 0,l);this.subscriptions&&this.subscriptions.push(h),this.add(h)}this.observables=null}},s.prototype.notifyNext=function(d,c,l){if(!this.hasFirst){this.hasFirst=!0;for(var p=0;p<this.subscriptions.length;p++)if(p!==l){var h=this.subscriptions[p];h.unsubscribe(),this.remove(h)}this.subscriptions=null}this.destination.next(c)},s}(OuterSubscriber);function race(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];return function(c){return a.length===1&&isArray$2(a[0])&&(a=a[0]),c.lift.call(race$1.apply(void 0,[c].concat(a)))}}function repeat(a){return a===void 0&&(a=-1),function(s){return a===0?empty$1():a<0?s.lift(new RepeatOperator(-1,s)):s.lift(new RepeatOperator(a-1,s))}}var RepeatOperator=function(){function a(s,d){this.count=s,this.source=d}return a.prototype.call=function(s,d){return d.subscribe(new RepeatSubscriber(s,this.count,this.source))},a}(),RepeatSubscriber=function(a){__extends(s,a);function s(d,c,l){var p=a.call(this,d)||this;return p.count=c,p.source=l,p}return s.prototype.complete=function(){if(!this.isStopped){var d=this,c=d.source,l=d.count;if(l===0)return a.prototype.complete.call(this);l>-1&&(this.count=l-1),c.subscribe(this._unsubscribeAndRecycle())}},s}(Subscriber);function repeatWhen(a){return function(s){return s.lift(new RepeatWhenOperator(a))}}var RepeatWhenOperator=function(){function a(s){this.notifier=s}return a.prototype.call=function(s,d){return d.subscribe(new RepeatWhenSubscriber(s,this.notifier,d))},a}(),RepeatWhenSubscriber=function(a){__extends(s,a);function s(d,c,l){var p=a.call(this,d)||this;return p.notifier=c,p.source=l,p.sourceIsBeingSubscribedTo=!0,p}return s.prototype.notifyNext=function(){this.sourceIsBeingSubscribedTo=!0,this.source.subscribe(this)},s.prototype.notifyComplete=function(){if(this.sourceIsBeingSubscribedTo===!1)return a.prototype.complete.call(this)},s.prototype.complete=function(){if(this.sourceIsBeingSubscribedTo=!1,!this.isStopped){if(this.retries||this.subscribeToRetries(),!this.retriesSubscription||this.retriesSubscription.closed)return a.prototype.complete.call(this);this._unsubscribeAndRecycle(),this.notifications.next(void 0)}},s.prototype._unsubscribe=function(){var d=this,c=d.notifications,l=d.retriesSubscription;c&&(c.unsubscribe(),this.notifications=void 0),l&&(l.unsubscribe(),this.retriesSubscription=void 0),this.retries=void 0},s.prototype._unsubscribeAndRecycle=function(){var d=this._unsubscribe;return this._unsubscribe=null,a.prototype._unsubscribeAndRecycle.call(this),this._unsubscribe=d,this},s.prototype.subscribeToRetries=function(){this.notifications=new Subject;var d;try{var c=this.notifier;d=c(this.notifications)}catch{return a.prototype.complete.call(this)}this.retries=d,this.retriesSubscription=innerSubscribe(d,new SimpleInnerSubscriber(this))},s}(SimpleOuterSubscriber);function retry(a){return a===void 0&&(a=-1),function(s){return s.lift(new RetryOperator(a,s))}}var RetryOperator=function(){function a(s,d){this.count=s,this.source=d}return a.prototype.call=function(s,d){return d.subscribe(new RetrySubscriber(s,this.count,this.source))},a}(),RetrySubscriber=function(a){__extends(s,a);function s(d,c,l){var p=a.call(this,d)||this;return p.count=c,p.source=l,p}return s.prototype.error=function(d){if(!this.isStopped){var c=this,l=c.source,p=c.count;if(p===0)return a.prototype.error.call(this,d);p>-1&&(this.count=p-1),l.subscribe(this._unsubscribeAndRecycle())}},s}(Subscriber);function retryWhen(a){return function(s){return s.lift(new RetryWhenOperator(a,s))}}var RetryWhenOperator=function(){function a(s,d){this.notifier=s,this.source=d}return a.prototype.call=function(s,d){return d.subscribe(new RetryWhenSubscriber(s,this.notifier,this.source))},a}(),RetryWhenSubscriber=function(a){__extends(s,a);function s(d,c,l){var p=a.call(this,d)||this;return p.notifier=c,p.source=l,p}return s.prototype.error=function(d){if(!this.isStopped){var c=this.errors,l=this.retries,p=this.retriesSubscription;if(l)this.errors=void 0,this.retriesSubscription=void 0;else{c=new Subject;try{var h=this.notifier;l=h(c)}catch(v){return a.prototype.error.call(this,v)}p=innerSubscribe(l,new SimpleInnerSubscriber(this))}this._unsubscribeAndRecycle(),this.errors=c,this.retries=l,this.retriesSubscription=p,c.next(d)}},s.prototype._unsubscribe=function(){var d=this,c=d.errors,l=d.retriesSubscription;c&&(c.unsubscribe(),this.errors=void 0),l&&(l.unsubscribe(),this.retriesSubscription=void 0),this.retries=void 0},s.prototype.notifyNext=function(){var d=this._unsubscribe;this._unsubscribe=null,this._unsubscribeAndRecycle(),this._unsubscribe=d,this.source.subscribe(this)},s}(SimpleOuterSubscriber);function sample(a){return function(s){return s.lift(new SampleOperator(a))}}var SampleOperator=function(){function a(s){this.notifier=s}return a.prototype.call=function(s,d){var c=new SampleSubscriber(s),l=d.subscribe(c);return l.add(innerSubscribe(this.notifier,new SimpleInnerSubscriber(c))),l},a}(),SampleSubscriber=function(a){__extends(s,a);function s(){var d=a!==null&&a.apply(this,arguments)||this;return d.hasValue=!1,d}return s.prototype._next=function(d){this.value=d,this.hasValue=!0},s.prototype.notifyNext=function(){this.emitValue()},s.prototype.notifyComplete=function(){this.emitValue()},s.prototype.emitValue=function(){this.hasValue&&(this.hasValue=!1,this.destination.next(this.value))},s}(SimpleOuterSubscriber);function sampleTime(a,s){return s===void 0&&(s=async),function(d){return d.lift(new SampleTimeOperator(a,s))}}var SampleTimeOperator=function(){function a(s,d){this.period=s,this.scheduler=d}return a.prototype.call=function(s,d){return d.subscribe(new SampleTimeSubscriber(s,this.period,this.scheduler))},a}(),SampleTimeSubscriber=function(a){__extends(s,a);function s(d,c,l){var p=a.call(this,d)||this;return p.period=c,p.scheduler=l,p.hasValue=!1,p.add(l.schedule(dispatchNotification,c,{subscriber:p,period:c})),p}return s.prototype._next=function(d){this.lastValue=d,this.hasValue=!0},s.prototype.notifyNext=function(){this.hasValue&&(this.hasValue=!1,this.destination.next(this.lastValue))},s}(Subscriber);function dispatchNotification(a){var s=a.subscriber,d=a.period;s.notifyNext(),this.schedule(a,d)}function sequenceEqual(a,s){return function(d){return d.lift(new SequenceEqualOperator(a,s))}}var SequenceEqualOperator=function(){function a(s,d){this.compareTo=s,this.comparator=d}return a.prototype.call=function(s,d){return d.subscribe(new SequenceEqualSubscriber(s,this.compareTo,this.comparator))},a}(),SequenceEqualSubscriber=function(a){__extends(s,a);function s(d,c,l){var p=a.call(this,d)||this;return p.compareTo=c,p.comparator=l,p._a=[],p._b=[],p._oneComplete=!1,p.destination.add(c.subscribe(new SequenceEqualCompareToSubscriber(d,p))),p}return s.prototype._next=function(d){this._oneComplete&&this._b.length===0?this.emit(!1):(this._a.push(d),this.checkValues())},s.prototype._complete=function(){this._oneComplete?this.emit(this._a.length===0&&this._b.length===0):this._oneComplete=!0,this.unsubscribe()},s.prototype.checkValues=function(){for(var d=this,c=d._a,l=d._b,p=d.comparator;c.length>0&&l.length>0;){var h=c.shift(),v=l.shift(),S=!1;try{S=p?p(h,v):h===v}catch(b){this.destination.error(b)}S||this.emit(!1)}},s.prototype.emit=function(d){var c=this.destination;c.next(d),c.complete()},s.prototype.nextB=function(d){this._oneComplete&&this._a.length===0?this.emit(!1):(this._b.push(d),this.checkValues())},s.prototype.completeB=function(){this._oneComplete?this.emit(this._a.length===0&&this._b.length===0):this._oneComplete=!0},s}(Subscriber),SequenceEqualCompareToSubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.parent=c,l}return s.prototype._next=function(d){this.parent.nextB(d)},s.prototype._error=function(d){this.parent.error(d),this.unsubscribe()},s.prototype._complete=function(){this.parent.completeB(),this.unsubscribe()},s}(Subscriber);function shareSubjectFactory(){return new Subject}function share(){return function(a){return refCount()(multicast(shareSubjectFactory)(a))}}function shareReplay(a,s,d){var c;return a&&typeof a=="object"?c=a:c={bufferSize:a,windowTime:s,refCount:!1,scheduler:d},function(l){return l.lift(shareReplayOperator(c))}}function shareReplayOperator(a){var s=a.bufferSize,d=s===void 0?Number.POSITIVE_INFINITY:s,c=a.windowTime,l=c===void 0?Number.POSITIVE_INFINITY:c,p=a.refCount,h=a.scheduler,v,S=0,b,_=!1,I=!1;return function(k){S++;var w;!v||_?(_=!1,v=new ReplaySubject(d,l,h),w=v.subscribe(this),b=k.subscribe({next:function(P){v.next(P)},error:function(P){_=!0,v.error(P)},complete:function(){I=!0,b=void 0,v.complete()}}),I&&(b=void 0)):w=v.subscribe(this),this.add(function(){S--,w.unsubscribe(),w=void 0,b&&!I&&p&&S===0&&(b.unsubscribe(),b=void 0,v=void 0)})}}function single(a){return function(s){return s.lift(new SingleOperator(a,s))}}var SingleOperator=function(){function a(s,d){this.predicate=s,this.source=d}return a.prototype.call=function(s,d){return d.subscribe(new SingleSubscriber(s,this.predicate,this.source))},a}(),SingleSubscriber=function(a){__extends(s,a);function s(d,c,l){var p=a.call(this,d)||this;return p.predicate=c,p.source=l,p.seenValue=!1,p.index=0,p}return s.prototype.applySingleValue=function(d){this.seenValue?this.destination.error("Sequence contains more than one element"):(this.seenValue=!0,this.singleValue=d)},s.prototype._next=function(d){var c=this.index++;this.predicate?this.tryNext(d,c):this.applySingleValue(d)},s.prototype.tryNext=function(d,c){try{this.predicate(d,c,this.source)&&this.applySingleValue(d)}catch(l){this.destination.error(l)}},s.prototype._complete=function(){var d=this.destination;this.index>0?(d.next(this.seenValue?this.singleValue:void 0),d.complete()):d.error(new EmptyError)},s}(Subscriber);function skip(a){return function(s){return s.lift(new SkipOperator(a))}}var SkipOperator=function(){function a(s){this.total=s}return a.prototype.call=function(s,d){return d.subscribe(new SkipSubscriber(s,this.total))},a}(),SkipSubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.total=c,l.count=0,l}return s.prototype._next=function(d){++this.count>this.total&&this.destination.next(d)},s}(Subscriber);function skipLast(a){return function(s){return s.lift(new SkipLastOperator(a))}}var SkipLastOperator=function(){function a(s){if(this._skipCount=s,this._skipCount<0)throw new ArgumentOutOfRangeError}return a.prototype.call=function(s,d){return this._skipCount===0?d.subscribe(new Subscriber(s)):d.subscribe(new SkipLastSubscriber(s,this._skipCount))},a}(),SkipLastSubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l._skipCount=c,l._count=0,l._ring=new Array(c),l}return s.prototype._next=function(d){var c=this._skipCount,l=this._count++;if(l<c)this._ring[l]=d;else{var p=l%c,h=this._ring,v=h[p];h[p]=d,this.destination.next(v)}},s}(Subscriber);function skipUntil(a){return function(s){return s.lift(new SkipUntilOperator(a))}}var SkipUntilOperator=function(){function a(s){this.notifier=s}return a.prototype.call=function(s,d){return d.subscribe(new SkipUntilSubscriber(s,this.notifier))},a}(),SkipUntilSubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;l.hasValue=!1;var p=new SimpleInnerSubscriber(l);l.add(p),l.innerSubscription=p;var h=innerSubscribe(c,p);return h!==p&&(l.add(h),l.innerSubscription=h),l}return s.prototype._next=function(d){this.hasValue&&a.prototype._next.call(this,d)},s.prototype.notifyNext=function(){this.hasValue=!0,this.innerSubscription&&this.innerSubscription.unsubscribe()},s.prototype.notifyComplete=function(){},s}(SimpleOuterSubscriber);function skipWhile(a){return function(s){return s.lift(new SkipWhileOperator(a))}}var SkipWhileOperator=function(){function a(s){this.predicate=s}return a.prototype.call=function(s,d){return d.subscribe(new SkipWhileSubscriber(s,this.predicate))},a}(),SkipWhileSubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.predicate=c,l.skipping=!0,l.index=0,l}return s.prototype._next=function(d){var c=this.destination;this.skipping&&this.tryCallPredicate(d),this.skipping||c.next(d)},s.prototype.tryCallPredicate=function(d){try{var c=this.predicate(d,this.index++);this.skipping=Boolean(c)}catch(l){this.destination.error(l)}},s}(Subscriber);function startWith(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];var d=a[a.length-1];return isScheduler(d)?(a.pop(),function(c){return concat$1(a,c,d)}):function(c){return concat$1(a,c)}}var nextHandle=1,RESOLVED=function(){return Promise.resolve()}(),activeHandles={};function findAndClearHandle(a){return a in activeHandles?(delete activeHandles[a],!0):!1}var Immediate={setImmediate:function(a){var s=nextHandle++;return activeHandles[s]=!0,RESOLVED.then(function(){return findAndClearHandle(s)&&a()}),s},clearImmediate:function(a){findAndClearHandle(a)}},AsapAction=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d,c)||this;return l.scheduler=d,l.work=c,l}return s.prototype.requestAsyncId=function(d,c,l){return l===void 0&&(l=0),l!==null&&l>0?a.prototype.requestAsyncId.call(this,d,c,l):(d.actions.push(this),d.scheduled||(d.scheduled=Immediate.setImmediate(d.flush.bind(d,null))))},s.prototype.recycleAsyncId=function(d,c,l){if(l===void 0&&(l=0),l!==null&&l>0||l===null&&this.delay>0)return a.prototype.recycleAsyncId.call(this,d,c,l);d.actions.length===0&&(Immediate.clearImmediate(c),d.scheduled=void 0)},s}(AsyncAction),AsapScheduler=function(a){__extends(s,a);function s(){return a!==null&&a.apply(this,arguments)||this}return s.prototype.flush=function(d){this.active=!0,this.scheduled=void 0;var c=this.actions,l,p=-1,h=c.length;d=d||c.shift();do if(l=d.execute(d.state,d.delay))break;while(++p<h&&(d=c.shift()));if(this.active=!1,l){for(;++p<h&&(d=c.shift());)d.unsubscribe();throw l}},s}(AsyncScheduler),asapScheduler=new AsapScheduler(AsapAction),asap=asapScheduler,SubscribeOnObservable=function(a){__extends(s,a);function s(d,c,l){c===void 0&&(c=0),l===void 0&&(l=asap);var p=a.call(this)||this;return p.source=d,p.delayTime=c,p.scheduler=l,(!isNumeric(c)||c<0)&&(p.delayTime=0),(!l||typeof l.schedule!="function")&&(p.scheduler=asap),p}return s.create=function(d,c,l){return c===void 0&&(c=0),l===void 0&&(l=asap),new s(d,c,l)},s.dispatch=function(d){var c=d.source,l=d.subscriber;return this.add(c.subscribe(l))},s.prototype._subscribe=function(d){var c=this.delayTime,l=this.source,p=this.scheduler;return p.schedule(s.dispatch,c,{source:l,subscriber:d})},s}(Observable);function subscribeOn(a,s){return s===void 0&&(s=0),function(c){return c.lift(new SubscribeOnOperator(a,s))}}var SubscribeOnOperator=function(){function a(s,d){this.scheduler=s,this.delay=d}return a.prototype.call=function(s,d){return new SubscribeOnObservable(d,this.delay,this.scheduler).subscribe(s)},a}();function switchMap(a,s){return typeof s=="function"?function(d){return d.pipe(switchMap(function(c,l){return from(a(c,l)).pipe(map(function(p,h){return s(c,p,l,h)}))}))}:function(d){return d.lift(new SwitchMapOperator(a))}}var SwitchMapOperator=function(){function a(s){this.project=s}return a.prototype.call=function(s,d){return d.subscribe(new SwitchMapSubscriber(s,this.project))},a}(),SwitchMapSubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.project=c,l.index=0,l}return s.prototype._next=function(d){var c,l=this.index++;try{c=this.project(d,l)}catch(p){this.destination.error(p);return}this._innerSub(c)},s.prototype._innerSub=function(d){var c=this.innerSubscription;c&&c.unsubscribe();var l=new SimpleInnerSubscriber(this),p=this.destination;p.add(l),this.innerSubscription=innerSubscribe(d,l),this.innerSubscription!==l&&p.add(this.innerSubscription)},s.prototype._complete=function(){var d=this.innerSubscription;(!d||d.closed)&&a.prototype._complete.call(this),this.unsubscribe()},s.prototype._unsubscribe=function(){this.innerSubscription=void 0},s.prototype.notifyComplete=function(){this.innerSubscription=void 0,this.isStopped&&a.prototype._complete.call(this)},s.prototype.notifyNext=function(d){this.destination.next(d)},s}(SimpleOuterSubscriber);function switchAll(){return switchMap(identity)}function switchMapTo(a,s){return s?switchMap(function(){return a},s):switchMap(function(){return a})}function takeUntil(a){return function(s){return s.lift(new TakeUntilOperator(a))}}var TakeUntilOperator=function(){function a(s){this.notifier=s}return a.prototype.call=function(s,d){var c=new TakeUntilSubscriber(s),l=innerSubscribe(this.notifier,new SimpleInnerSubscriber(c));return l&&!c.seenValue?(c.add(l),d.subscribe(c)):c},a}(),TakeUntilSubscriber=function(a){__extends(s,a);function s(d){var c=a.call(this,d)||this;return c.seenValue=!1,c}return s.prototype.notifyNext=function(){this.seenValue=!0,this.complete()},s.prototype.notifyComplete=function(){},s}(SimpleOuterSubscriber);function takeWhile(a,s){return s===void 0&&(s=!1),function(d){return d.lift(new TakeWhileOperator(a,s))}}var TakeWhileOperator=function(){function a(s,d){this.predicate=s,this.inclusive=d}return a.prototype.call=function(s,d){return d.subscribe(new TakeWhileSubscriber(s,this.predicate,this.inclusive))},a}(),TakeWhileSubscriber=function(a){__extends(s,a);function s(d,c,l){var p=a.call(this,d)||this;return p.predicate=c,p.inclusive=l,p.index=0,p}return s.prototype._next=function(d){var c=this.destination,l;try{l=this.predicate(d,this.index++)}catch(p){c.error(p);return}this.nextOrComplete(d,l)},s.prototype.nextOrComplete=function(d,c){var l=this.destination;Boolean(c)?l.next(d):(this.inclusive&&l.next(d),l.complete())},s}(Subscriber);function noop$2(){}function tap(a,s,d){return function(l){return l.lift(new DoOperator(a,s,d))}}var DoOperator=function(){function a(s,d,c){this.nextOrObserver=s,this.error=d,this.complete=c}return a.prototype.call=function(s,d){return d.subscribe(new TapSubscriber(s,this.nextOrObserver,this.error,this.complete))},a}(),TapSubscriber=function(a){__extends(s,a);function s(d,c,l,p){var h=a.call(this,d)||this;return h._tapNext=noop$2,h._tapError=noop$2,h._tapComplete=noop$2,h._tapError=l||noop$2,h._tapComplete=p||noop$2,isFunction$1(c)?(h._context=h,h._tapNext=c):c&&(h._context=c,h._tapNext=c.next||noop$2,h._tapError=c.error||noop$2,h._tapComplete=c.complete||noop$2),h}return s.prototype._next=function(d){try{this._tapNext.call(this._context,d)}catch(c){this.destination.error(c);return}this.destination.next(d)},s.prototype._error=function(d){try{this._tapError.call(this._context,d)}catch(c){this.destination.error(c);return}this.destination.error(d)},s.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(d){this.destination.error(d);return}return this.destination.complete()},s}(Subscriber),defaultThrottleConfig={leading:!0,trailing:!1};function throttle(a,s){return s===void 0&&(s=defaultThrottleConfig),function(d){return d.lift(new ThrottleOperator(a,!!s.leading,!!s.trailing))}}var ThrottleOperator=function(){function a(s,d,c){this.durationSelector=s,this.leading=d,this.trailing=c}return a.prototype.call=function(s,d){return d.subscribe(new ThrottleSubscriber(s,this.durationSelector,this.leading,this.trailing))},a}(),ThrottleSubscriber=function(a){__extends(s,a);function s(d,c,l,p){var h=a.call(this,d)||this;return h.destination=d,h.durationSelector=c,h._leading=l,h._trailing=p,h._hasValue=!1,h}return s.prototype._next=function(d){this._hasValue=!0,this._sendValue=d,this._throttled||(this._leading?this.send():this.throttle(d))},s.prototype.send=function(){var d=this,c=d._hasValue,l=d._sendValue;c&&(this.destination.next(l),this.throttle(l)),this._hasValue=!1,this._sendValue=void 0},s.prototype.throttle=function(d){var c=this.tryDurationSelector(d);c&&this.add(this._throttled=innerSubscribe(c,new SimpleInnerSubscriber(this)))},s.prototype.tryDurationSelector=function(d){try{return this.durationSelector(d)}catch(c){return this.destination.error(c),null}},s.prototype.throttlingDone=function(){var d=this,c=d._throttled,l=d._trailing;c&&c.unsubscribe(),this._throttled=void 0,l&&this.send()},s.prototype.notifyNext=function(){this.throttlingDone()},s.prototype.notifyComplete=function(){this.throttlingDone()},s}(SimpleOuterSubscriber);function throttleTime(a,s,d){return s===void 0&&(s=async),d===void 0&&(d=defaultThrottleConfig),function(c){return c.lift(new ThrottleTimeOperator(a,s,d.leading,d.trailing))}}var ThrottleTimeOperator=function(){function a(s,d,c,l){this.duration=s,this.scheduler=d,this.leading=c,this.trailing=l}return a.prototype.call=function(s,d){return d.subscribe(new ThrottleTimeSubscriber(s,this.duration,this.scheduler,this.leading,this.trailing))},a}(),ThrottleTimeSubscriber=function(a){__extends(s,a);function s(d,c,l,p,h){var v=a.call(this,d)||this;return v.duration=c,v.scheduler=l,v.leading=p,v.trailing=h,v._hasTrailingValue=!1,v._trailingValue=null,v}return s.prototype._next=function(d){this.throttled?this.trailing&&(this._trailingValue=d,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(dispatchNext,this.duration,{subscriber:this})),this.leading?this.destination.next(d):this.trailing&&(this._trailingValue=d,this._hasTrailingValue=!0))},s.prototype._complete=function(){this._hasTrailingValue?(this.destination.next(this._trailingValue),this.destination.complete()):this.destination.complete()},s.prototype.clearThrottle=function(){var d=this.throttled;d&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),d.unsubscribe(),this.remove(d),this.throttled=null)},s}(Subscriber);function dispatchNext(a){var s=a.subscriber;s.clearThrottle()}function defer(a){return new Observable(function(s){var d;try{d=a()}catch(l){s.error(l);return}var c=d?from(d):empty$1();return c.subscribe(s)})}function timeInterval(a){return a===void 0&&(a=async),function(s){return defer(function(){return s.pipe(scan(function(d,c){var l=d.current;return{value:c,current:a.now(),last:l}},{current:a.now(),value:void 0,last:void 0}),map(function(d){var c=d.current,l=d.last,p=d.value;return new TimeInterval(p,c-l)}))})}}var TimeInterval=function(){function a(s,d){this.value=s,this.interval=d}return a}(),TimeoutErrorImpl=function(){function a(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}return a.prototype=Object.create(Error.prototype),a}(),TimeoutError=TimeoutErrorImpl;function timeoutWith(a,s,d){return d===void 0&&(d=async),function(c){var l=isDate$1(a),p=l?+a-d.now():Math.abs(a);return c.lift(new TimeoutWithOperator(p,l,s,d))}}var TimeoutWithOperator=function(){function a(s,d,c,l){this.waitFor=s,this.absoluteTimeout=d,this.withObservable=c,this.scheduler=l}return a.prototype.call=function(s,d){return d.subscribe(new TimeoutWithSubscriber(s,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))},a}(),TimeoutWithSubscriber=function(a){__extends(s,a);function s(d,c,l,p,h){var v=a.call(this,d)||this;return v.absoluteTimeout=c,v.waitFor=l,v.withObservable=p,v.scheduler=h,v.scheduleTimeout(),v}return s.dispatchTimeout=function(d){var c=d.withObservable;d._unsubscribeAndRecycle(),d.add(innerSubscribe(c,new SimpleInnerSubscriber(d)))},s.prototype.scheduleTimeout=function(){var d=this.action;d?this.action=d.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(s.dispatchTimeout,this.waitFor,this))},s.prototype._next=function(d){this.absoluteTimeout||this.scheduleTimeout(),a.prototype._next.call(this,d)},s.prototype._unsubscribe=function(){this.action=void 0,this.scheduler=null,this.withObservable=null},s}(SimpleOuterSubscriber);function timeout(a,s){return s===void 0&&(s=async),timeoutWith(a,throwError(new TimeoutError),s)}function timestamp(a){return a===void 0&&(a=async),map(function(s){return new Timestamp(s,a.now())})}var Timestamp=function(){function a(s,d){this.value=s,this.timestamp=d}return a}();function toArrayReducer(a,s,d){return d===0?[s]:(a.push(s),a)}function toArray(){return reduce(toArrayReducer,[])}function window$1(a){return function(d){return d.lift(new WindowOperator$1(a))}}var WindowOperator$1=function(){function a(s){this.windowBoundaries=s}return a.prototype.call=function(s,d){var c=new WindowSubscriber$1(s),l=d.subscribe(c);return l.closed||c.add(innerSubscribe(this.windowBoundaries,new SimpleInnerSubscriber(c))),l},a}(),WindowSubscriber$1=function(a){__extends(s,a);function s(d){var c=a.call(this,d)||this;return c.window=new Subject,d.next(c.window),c}return s.prototype.notifyNext=function(){this.openWindow()},s.prototype.notifyError=function(d){this._error(d)},s.prototype.notifyComplete=function(){this._complete()},s.prototype._next=function(d){this.window.next(d)},s.prototype._error=function(d){this.window.error(d),this.destination.error(d)},s.prototype._complete=function(){this.window.complete(),this.destination.complete()},s.prototype._unsubscribe=function(){this.window=null},s.prototype.openWindow=function(){var d=this.window;d&&d.complete();var c=this.destination,l=this.window=new Subject;c.next(l)},s}(SimpleOuterSubscriber);function windowCount(a,s){return s===void 0&&(s=0),function(c){return c.lift(new WindowCountOperator(a,s))}}var WindowCountOperator=function(){function a(s,d){this.windowSize=s,this.startWindowEvery=d}return a.prototype.call=function(s,d){return d.subscribe(new WindowCountSubscriber(s,this.windowSize,this.startWindowEvery))},a}(),WindowCountSubscriber=function(a){__extends(s,a);function s(d,c,l){var p=a.call(this,d)||this;return p.destination=d,p.windowSize=c,p.startWindowEvery=l,p.windows=[new Subject],p.count=0,d.next(p.windows[0]),p}return s.prototype._next=function(d){for(var c=this.startWindowEvery>0?this.startWindowEvery:this.windowSize,l=this.destination,p=this.windowSize,h=this.windows,v=h.length,S=0;S<v&&!this.closed;S++)h[S].next(d);var b=this.count-p+1;if(b>=0&&b%c===0&&!this.closed&&h.shift().complete(),++this.count%c===0&&!this.closed){var _=new Subject;h.push(_),l.next(_)}},s.prototype._error=function(d){var c=this.windows;if(c)for(;c.length>0&&!this.closed;)c.shift().error(d);this.destination.error(d)},s.prototype._complete=function(){var d=this.windows;if(d)for(;d.length>0&&!this.closed;)d.shift().complete();this.destination.complete()},s.prototype._unsubscribe=function(){this.count=0,this.windows=null},s}(Subscriber);function windowTime(a){var s=async,d=null,c=Number.POSITIVE_INFINITY;return isScheduler(arguments[3])&&(s=arguments[3]),isScheduler(arguments[2])?s=arguments[2]:isNumeric(arguments[2])&&(c=Number(arguments[2])),isScheduler(arguments[1])?s=arguments[1]:isNumeric(arguments[1])&&(d=Number(arguments[1])),function(p){return p.lift(new WindowTimeOperator(a,d,c,s))}}var WindowTimeOperator=function(){function a(s,d,c,l){this.windowTimeSpan=s,this.windowCreationInterval=d,this.maxWindowSize=c,this.scheduler=l}return a.prototype.call=function(s,d){return d.subscribe(new WindowTimeSubscriber(s,this.windowTimeSpan,this.windowCreationInterval,this.maxWindowSize,this.scheduler))},a}(),CountedSubject=function(a){__extends(s,a);function s(){var d=a!==null&&a.apply(this,arguments)||this;return d._numberOfNextedValues=0,d}return s.prototype.next=function(d){this._numberOfNextedValues++,a.prototype.next.call(this,d)},Object.defineProperty(s.prototype,"numberOfNextedValues",{get:function(){return this._numberOfNextedValues},enumerable:!0,configurable:!0}),s}(Subject),WindowTimeSubscriber=function(a){__extends(s,a);function s(d,c,l,p,h){var v=a.call(this,d)||this;v.destination=d,v.windowTimeSpan=c,v.windowCreationInterval=l,v.maxWindowSize=p,v.scheduler=h,v.windows=[];var S=v.openWindow();if(l!==null&&l>=0){var b={subscriber:v,window:S,context:null},_={windowTimeSpan:c,windowCreationInterval:l,subscriber:v,scheduler:h};v.add(h.schedule(dispatchWindowClose,c,b)),v.add(h.schedule(dispatchWindowCreation,l,_))}else{var I={subscriber:v,window:S,windowTimeSpan:c};v.add(h.schedule(dispatchWindowTimeSpanOnly,c,I))}return v}return s.prototype._next=function(d){for(var c=this.windows,l=c.length,p=0;p<l;p++){var h=c[p];h.closed||(h.next(d),h.numberOfNextedValues>=this.maxWindowSize&&this.closeWindow(h))}},s.prototype._error=function(d){for(var c=this.windows;c.length>0;)c.shift().error(d);this.destination.error(d)},s.prototype._complete=function(){for(var d=this.windows;d.length>0;){var c=d.shift();c.closed||c.complete()}this.destination.complete()},s.prototype.openWindow=function(){var d=new CountedSubject;this.windows.push(d);var c=this.destination;return c.next(d),d},s.prototype.closeWindow=function(d){d.complete();var c=this.windows;c.splice(c.indexOf(d),1)},s}(Subscriber);function dispatchWindowTimeSpanOnly(a){var s=a.subscriber,d=a.windowTimeSpan,c=a.window;c&&s.closeWindow(c),a.window=s.openWindow(),this.schedule(a,d)}function dispatchWindowCreation(a){var s=a.windowTimeSpan,d=a.subscriber,c=a.scheduler,l=a.windowCreationInterval,p=d.openWindow(),h=this,v={action:h,subscription:null},S={subscriber:d,window:p,context:v};v.subscription=c.schedule(dispatchWindowClose,s,S),h.add(v.subscription),h.schedule(a,l)}function dispatchWindowClose(a){var s=a.subscriber,d=a.window,c=a.context;c&&c.action&&c.subscription&&c.action.remove(c.subscription),s.closeWindow(d)}function windowToggle(a,s){return function(d){return d.lift(new WindowToggleOperator(a,s))}}var WindowToggleOperator=function(){function a(s,d){this.openings=s,this.closingSelector=d}return a.prototype.call=function(s,d){return d.subscribe(new WindowToggleSubscriber(s,this.openings,this.closingSelector))},a}(),WindowToggleSubscriber=function(a){__extends(s,a);function s(d,c,l){var p=a.call(this,d)||this;return p.openings=c,p.closingSelector=l,p.contexts=[],p.add(p.openSubscription=subscribeToResult(p,c,c)),p}return s.prototype._next=function(d){var c=this.contexts;if(c)for(var l=c.length,p=0;p<l;p++)c[p].window.next(d)},s.prototype._error=function(d){var c=this.contexts;if(this.contexts=null,c)for(var l=c.length,p=-1;++p<l;){var h=c[p];h.window.error(d),h.subscription.unsubscribe()}a.prototype._error.call(this,d)},s.prototype._complete=function(){var d=this.contexts;if(this.contexts=null,d)for(var c=d.length,l=-1;++l<c;){var p=d[l];p.window.complete(),p.subscription.unsubscribe()}a.prototype._complete.call(this)},s.prototype._unsubscribe=function(){var d=this.contexts;if(this.contexts=null,d)for(var c=d.length,l=-1;++l<c;){var p=d[l];p.window.unsubscribe(),p.subscription.unsubscribe()}},s.prototype.notifyNext=function(d,c,l,p,h){if(d===this.openings){var v=void 0;try{var S=this.closingSelector;v=S(c)}catch(k){return this.error(k)}var b=new Subject,_=new Subscription,I={window:b,subscription:_};this.contexts.push(I);var T=subscribeToResult(this,v,I);T.closed?this.closeWindow(this.contexts.length-1):(T.context=I,_.add(T)),this.destination.next(b)}else this.closeWindow(this.contexts.indexOf(d))},s.prototype.notifyError=function(d){this.error(d)},s.prototype.notifyComplete=function(d){d!==this.openSubscription&&this.closeWindow(this.contexts.indexOf(d.context))},s.prototype.closeWindow=function(d){if(d!==-1){var c=this.contexts,l=c[d],p=l.window,h=l.subscription;c.splice(d,1),p.complete(),h.unsubscribe()}},s}(OuterSubscriber);function windowWhen(a){return function(d){return d.lift(new WindowOperator(a))}}var WindowOperator=function(){function a(s){this.closingSelector=s}return a.prototype.call=function(s,d){return d.subscribe(new WindowSubscriber(s,this.closingSelector))},a}(),WindowSubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.destination=d,l.closingSelector=c,l.openWindow(),l}return s.prototype.notifyNext=function(d,c,l,p,h){this.openWindow(h)},s.prototype.notifyError=function(d){this._error(d)},s.prototype.notifyComplete=function(d){this.openWindow(d)},s.prototype._next=function(d){this.window.next(d)},s.prototype._error=function(d){this.window.error(d),this.destination.error(d),this.unsubscribeClosingNotification()},s.prototype._complete=function(){this.window.complete(),this.destination.complete(),this.unsubscribeClosingNotification()},s.prototype.unsubscribeClosingNotification=function(){this.closingNotification&&this.closingNotification.unsubscribe()},s.prototype.openWindow=function(d){d===void 0&&(d=null),d&&(this.remove(d),d.unsubscribe());var c=this.window;c&&c.complete();var l=this.window=new Subject;this.destination.next(l);var p;try{var h=this.closingSelector;p=h()}catch(v){this.destination.error(v),this.window.error(v);return}this.add(this.closingNotification=subscribeToResult(this,p))},s}(OuterSubscriber);function withLatestFrom(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];return function(d){var c;typeof a[a.length-1]=="function"&&(c=a.pop());var l=a;return d.lift(new WithLatestFromOperator(l,c))}}var WithLatestFromOperator=function(){function a(s,d){this.observables=s,this.project=d}return a.prototype.call=function(s,d){return d.subscribe(new WithLatestFromSubscriber(s,this.observables,this.project))},a}(),WithLatestFromSubscriber=function(a){__extends(s,a);function s(d,c,l){var p=a.call(this,d)||this;p.observables=c,p.project=l,p.toRespond=[];var h=c.length;p.values=new Array(h);for(var v=0;v<h;v++)p.toRespond.push(v);for(var v=0;v<h;v++){var S=c[v];p.add(subscribeToResult(p,S,void 0,v))}return p}return s.prototype.notifyNext=function(d,c,l){this.values[l]=c;var p=this.toRespond;if(p.length>0){var h=p.indexOf(l);h!==-1&&p.splice(h,1)}},s.prototype.notifyComplete=function(){},s.prototype._next=function(d){if(this.toRespond.length===0){var c=[d].concat(this.values);this.project?this._tryProject(c):this.destination.next(c)}},s.prototype._tryProject=function(d){var c;try{c=this.project.apply(this,d)}catch(l){this.destination.error(l);return}this.destination.next(c)},s}(OuterSubscriber);function zip$1(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];var d=a[a.length-1];return typeof d=="function"&&a.pop(),fromArray(a,void 0).lift(new ZipOperator(d))}var ZipOperator=function(){function a(s){this.resultSelector=s}return a.prototype.call=function(s,d){return d.subscribe(new ZipSubscriber(s,this.resultSelector))},a}(),ZipSubscriber=function(a){__extends(s,a);function s(d,c,l){var p=a.call(this,d)||this;return p.resultSelector=c,p.iterators=[],p.active=0,p.resultSelector=typeof c=="function"?c:void 0,p}return s.prototype._next=function(d){var c=this.iterators;isArray$2(d)?c.push(new StaticArrayIterator(d)):typeof d[iterator]=="function"?c.push(new StaticIterator(d[iterator]())):c.push(new ZipBufferIterator(this.destination,this,d))},s.prototype._complete=function(){var d=this.iterators,c=d.length;if(this.unsubscribe(),c===0){this.destination.complete();return}this.active=c;for(var l=0;l<c;l++){var p=d[l];if(p.stillUnsubscribed){var h=this.destination;h.add(p.subscribe())}else this.active--}},s.prototype.notifyInactive=function(){this.active--,this.active===0&&this.destination.complete()},s.prototype.checkIterators=function(){for(var d=this.iterators,c=d.length,l=this.destination,p=0;p<c;p++){var h=d[p];if(typeof h.hasValue=="function"&&!h.hasValue())return}for(var v=!1,S=[],p=0;p<c;p++){var h=d[p],b=h.next();if(h.hasCompleted()&&(v=!0),b.done){l.complete();return}S.push(b.value)}this.resultSelector?this._tryresultSelector(S):l.next(S),v&&l.complete()},s.prototype._tryresultSelector=function(d){var c;try{c=this.resultSelector.apply(this,d)}catch(l){this.destination.error(l);return}this.destination.next(c)},s}(Subscriber),StaticIterator=function(){function a(s){this.iterator=s,this.nextResult=s.next()}return a.prototype.hasValue=function(){return!0},a.prototype.next=function(){var s=this.nextResult;return this.nextResult=this.iterator.next(),s},a.prototype.hasCompleted=function(){var s=this.nextResult;return Boolean(s&&s.done)},a}(),StaticArrayIterator=function(){function a(s){this.array=s,this.index=0,this.length=0,this.length=s.length}return a.prototype[iterator]=function(){return this},a.prototype.next=function(s){var d=this.index++,c=this.array;return d<this.length?{value:c[d],done:!1}:{value:null,done:!0}},a.prototype.hasValue=function(){return this.array.length>this.index},a.prototype.hasCompleted=function(){return this.array.length===this.index},a}(),ZipBufferIterator=function(a){__extends(s,a);function s(d,c,l){var p=a.call(this,d)||this;return p.parent=c,p.observable=l,p.stillUnsubscribed=!0,p.buffer=[],p.isComplete=!1,p}return s.prototype[iterator]=function(){return this},s.prototype.next=function(){var d=this.buffer;return d.length===0&&this.isComplete?{value:null,done:!0}:{value:d.shift(),done:!1}},s.prototype.hasValue=function(){return this.buffer.length>0},s.prototype.hasCompleted=function(){return this.buffer.length===0&&this.isComplete},s.prototype.notifyComplete=function(){this.buffer.length>0?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()},s.prototype.notifyNext=function(d){this.buffer.push(d),this.parent.checkIterators()},s.prototype.subscribe=function(){return innerSubscribe(this.observable,new SimpleInnerSubscriber(this))},s}(SimpleOuterSubscriber);function zip(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];return function(c){return c.lift.call(zip$1.apply(void 0,[c].concat(a)))}}function zipAll(a){return function(s){return s.lift(new ZipOperator(a))}}var operators=Object.freeze(Object.defineProperty({__proto__:null,audit,auditTime,buffer,bufferCount,bufferTime,bufferToggle,bufferWhen,catchError,combineAll,combineLatest,concat,concatAll,concatMap,concatMapTo,count,debounce,debounceTime,defaultIfEmpty,delay,delayWhen,dematerialize,distinct,distinctUntilChanged,distinctUntilKeyChanged,elementAt,endWith,every,exhaust,exhaustMap,expand,filter,finalize,find:find$1,findIndex,first,groupBy,ignoreElements,isEmpty,last,map,mapTo,materialize,max,merge:merge$1,mergeAll,mergeMap,flatMap,mergeMapTo,mergeScan,min,multicast,observeOn,onErrorResumeNext,pairwise,partition,pluck,publish,publishBehavior,publishLast,publishReplay,race,reduce,repeat,repeatWhen,retry,retryWhen,refCount,sample,sampleTime,scan,sequenceEqual,share,shareReplay,single,skip,skipLast,skipUntil,skipWhile,startWith,subscribeOn,switchAll,switchMap,switchMapTo,take,takeLast,takeUntil,takeWhile,tap,throttle,throttleTime,throwIfEmpty,timeInterval,timeout,timeoutWith,timestamp,toArray,window:window$1,windowCount,windowTime,windowToggle,windowWhen,withLatestFrom,zip,zipAll},Symbol.toStringTag,{value:"Module"})),require$$2=getAugmentedNamespace(operators),struct={};(function(a){var s=commonjsGlobal$1&&commonjsGlobal$1.__createBinding||(Object.create?function(E,D,F,J){J===void 0&&(J=F),Object.defineProperty(E,J,{enumerable:!0,get:function(){return D[F]}})}:function(E,D,F,J){J===void 0&&(J=F),E[J]=D[F]}),d=commonjsGlobal$1&&commonjsGlobal$1.__setModuleDefault||(Object.create?function(E,D){Object.defineProperty(E,"default",{enumerable:!0,value:D})}:function(E,D){E.default=D}),c=commonjsGlobal$1&&commonjsGlobal$1.__importStar||function(E){if(E&&E.__esModule)return E;var D={};if(E!=null)for(var F in E)F!=="default"&&Object.hasOwnProperty.call(E,F)&&s(D,E,F);return d(D,E),D},l=commonjsGlobal$1&&commonjsGlobal$1.__importDefault||function(E){return E&&E.__esModule?E:{default:E}};Object.defineProperty(a,"__esModule",{value:!0}),a.ListValue=a.Value=a.Struct_FieldsEntry=a.Struct=a.nullValueToNumber=a.nullValueToJSON=a.nullValueFromJSON=a.NullValue=a.protobufPackage=void 0;const p=l(umd.exports),h=c(minimal$2);a.protobufPackage="google.protobuf";var v;(function(E){E.NULL_VALUE="NULL_VALUE"})(v=a.NullValue||(a.NullValue={}));function S(E){switch(E){case 0:case"NULL_VALUE":return v.NULL_VALUE;default:throw new P.Error("Unrecognized enum value "+E+" for enum NullValue")}}a.nullValueFromJSON=S;function b(E){switch(E){case v.NULL_VALUE:return"NULL_VALUE";default:return"UNKNOWN"}}a.nullValueToJSON=b;function _(E){switch(E){case v.NULL_VALUE:return 0;default:return 0}}a.nullValueToNumber=_;function I(){return{fields:{}}}a.Struct={encode(E,D=h.Writer.create()){return Object.entries(E.fields).forEach(([F,J])=>{J!==void 0&&a.Struct_FieldsEntry.encode({key:F,value:J},D.uint32(10).fork()).ldelim()}),D},decode(E,D){const F=E instanceof h.Reader?E:new h.Reader(E);let J=D===void 0?F.len:F.pos+D;const G=I();for(;F.pos<J;){const x=F.uint32();switch(x>>>3){case 1:const Y=a.Struct_FieldsEntry.decode(F,F.uint32());Y.value!==void 0&&(G.fields[Y.key]=Y.value);break;default:F.skipType(x&7);break}}return G},fromJSON(E){return{fields:$(E.fields)?Object.entries(E.fields).reduce((D,[F,J])=>(D[F]=J,D),{}):{}}},toJSON(E){const D={};return D.fields={},E.fields&&Object.entries(E.fields).forEach(([F,J])=>{D.fields[F]=J}),D},fromPartial(E){var D;const F=I();return F.fields=Object.entries((D=E.fields)!==null&&D!==void 0?D:{}).reduce((J,[G,x])=>(x!==void 0&&(J[G]=x),J),{}),F},wrap(E){const D=I();return E!==void 0&&Object.keys(E).forEach(F=>{D.fields[F]=E[F]}),D},unwrap(E){const D={};return Object.keys(E.fields).forEach(F=>{D[F]=E.fields[F]}),D}};function T(){return{key:"",value:void 0}}a.Struct_FieldsEntry={encode(E,D=h.Writer.create()){return E.key!==""&&D.uint32(10).string(E.key),E.value!==void 0&&a.Value.encode(a.Value.wrap(E.value),D.uint32(18).fork()).ldelim(),D},decode(E,D){const F=E instanceof h.Reader?E:new h.Reader(E);let J=D===void 0?F.len:F.pos+D;const G=T();for(;F.pos<J;){const x=F.uint32();switch(x>>>3){case 1:G.key=F.string();break;case 2:G.value=a.Value.unwrap(a.Value.decode(F,F.uint32()));break;default:F.skipType(x&7);break}}return G},fromJSON(E){return{key:U(E.key)?String(E.key):"",value:U(E==null?void 0:E.value)?E.value:void 0}},toJSON(E){const D={};return E.key!==void 0&&(D.key=E.key),E.value!==void 0&&(D.value=E.value),D},fromPartial(E){var D,F;const J=T();return J.key=(D=E.key)!==null&&D!==void 0?D:"",J.value=(F=E.value)!==null&&F!==void 0?F:void 0,J}};function k(){return{nullValue:void 0,numberValue:void 0,stringValue:void 0,boolValue:void 0,structValue:void 0,listValue:void 0}}a.Value={encode(E,D=h.Writer.create()){return E.nullValue!==void 0&&D.uint32(8).int32(_(E.nullValue)),E.numberValue!==void 0&&D.uint32(17).double(E.numberValue),E.stringValue!==void 0&&D.uint32(26).string(E.stringValue),E.boolValue!==void 0&&D.uint32(32).bool(E.boolValue),E.structValue!==void 0&&a.Struct.encode(a.Struct.wrap(E.structValue),D.uint32(42).fork()).ldelim(),E.listValue!==void 0&&a.ListValue.encode(a.ListValue.wrap(E.listValue),D.uint32(50).fork()).ldelim(),D},decode(E,D){const F=E instanceof h.Reader?E:new h.Reader(E);let J=D===void 0?F.len:F.pos+D;const G=k();for(;F.pos<J;){const x=F.uint32();switch(x>>>3){case 1:G.nullValue=S(F.int32());break;case 2:G.numberValue=F.double();break;case 3:G.stringValue=F.string();break;case 4:G.boolValue=F.bool();break;case 5:G.structValue=a.Struct.unwrap(a.Struct.decode(F,F.uint32()));break;case 6:G.listValue=a.ListValue.unwrap(a.ListValue.decode(F,F.uint32()));break;default:F.skipType(x&7);break}}return G},fromJSON(E){return{nullValue:U(E.nullValue)?S(E.nullValue):void 0,numberValue:U(E.numberValue)?Number(E.numberValue):void 0,stringValue:U(E.stringValue)?String(E.stringValue):void 0,boolValue:U(E.boolValue)?Boolean(E.boolValue):void 0,structValue:$(E.structValue)?E.structValue:void 0,listValue:Array.isArray(E.listValue)?[...E.listValue]:void 0}},toJSON(E){const D={};return E.nullValue!==void 0&&(D.nullValue=E.nullValue!==void 0?b(E.nullValue):void 0),E.numberValue!==void 0&&(D.numberValue=E.numberValue),E.stringValue!==void 0&&(D.stringValue=E.stringValue),E.boolValue!==void 0&&(D.boolValue=E.boolValue),E.structValue!==void 0&&(D.structValue=E.structValue),E.listValue!==void 0&&(D.listValue=E.listValue),D},fromPartial(E){var D,F,J,G,x,Y;const N=k();return N.nullValue=(D=E.nullValue)!==null&&D!==void 0?D:void 0,N.numberValue=(F=E.numberValue)!==null&&F!==void 0?F:void 0,N.stringValue=(J=E.stringValue)!==null&&J!==void 0?J:void 0,N.boolValue=(G=E.boolValue)!==null&&G!==void 0?G:void 0,N.structValue=(x=E.structValue)!==null&&x!==void 0?x:void 0,N.listValue=(Y=E.listValue)!==null&&Y!==void 0?Y:void 0,N},wrap(E){const D=k();if(E===null)D.nullValue=v.NULL_VALUE;else if(typeof E=="boolean")D.boolValue=E;else if(typeof E=="number")D.numberValue=E;else if(typeof E=="string")D.stringValue=E;else if(Array.isArray(E))D.listValue=E;else if(typeof E=="object")D.structValue=E;else if(typeof E!="undefined")throw new Error("Unsupported any value type: "+typeof E);return D},unwrap(E){if((E==null?void 0:E.stringValue)!==void 0)return E.stringValue;if((E==null?void 0:E.numberValue)!==void 0)return E.numberValue;if((E==null?void 0:E.boolValue)!==void 0)return E.boolValue;if((E==null?void 0:E.structValue)!==void 0)return E.structValue;if((E==null?void 0:E.listValue)!==void 0)return E.listValue;if((E==null?void 0:E.nullValue)!==void 0)return null}};function w(){return{values:[]}}a.ListValue={encode(E,D=h.Writer.create()){for(const F of E.values)a.Value.encode(a.Value.wrap(F),D.uint32(10).fork()).ldelim();return D},decode(E,D){const F=E instanceof h.Reader?E:new h.Reader(E);let J=D===void 0?F.len:F.pos+D;const G=w();for(;F.pos<J;){const x=F.uint32();switch(x>>>3){case 1:G.values.push(a.Value.unwrap(a.Value.decode(F,F.uint32())));break;default:F.skipType(x&7);break}}return G},fromJSON(E){return{values:Array.isArray(E==null?void 0:E.values)?[...E.values]:[]}},toJSON(E){const D={};return E.values?D.values=E.values.map(F=>F):D.values=[],D},fromPartial(E){var D;const F=w();return F.values=((D=E.values)===null||D===void 0?void 0:D.map(J=>J))||[],F},wrap(E){const D=w();return D.values=E!=null?E:[],D},unwrap(E){return E.values}};var P=(()=>{if(typeof P!="undefined")return P;if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof commonjsGlobal$1!="undefined")return commonjsGlobal$1;throw"Unable to locate global object"})();h.util.Long!==p.default&&(h.util.Long=p.default,h.configure());function $(E){return typeof E=="object"&&E!==null}function U(E){return E!=null}})(struct),function(a){var s=commonjsGlobal$1&&commonjsGlobal$1.__createBinding||(Object.create?function(N,z,Z,L){L===void 0&&(L=Z),Object.defineProperty(N,L,{enumerable:!0,get:function(){return z[Z]}})}:function(N,z,Z,L){L===void 0&&(L=Z),N[L]=z[Z]}),d=commonjsGlobal$1&&commonjsGlobal$1.__setModuleDefault||(Object.create?function(N,z){Object.defineProperty(N,"default",{enumerable:!0,value:z})}:function(N,z){N.default=z}),c=commonjsGlobal$1&&commonjsGlobal$1.__importStar||function(N){if(N&&N.__esModule)return N;var z={};if(N!=null)for(var Z in N)Z!=="default"&&Object.hasOwnProperty.call(N,Z)&&s(z,N,Z);return d(z,N),z},l=commonjsGlobal$1&&commonjsGlobal$1.__importDefault||function(N){return N&&N.__esModule?N:{default:N}};Object.defineProperty(a,"__esModule",{value:!0}),a.EventServiceDefinition=a.EventServiceClientImpl=a.EventsStreamResponse=a.EventsStreamRequest=a.EventsStreamReconnectRequest=a.EventsStreamError=a.SubscribePayload=a.PublishEventResponse=a.PublishEventRequest=a.EventTarget=a.eventsStreamMessageTypeToNumber=a.eventsStreamMessageTypeToJSON=a.eventsStreamMessageTypeFromJSON=a.EventsStreamMessageType=a.protobufPackage=void 0;const p=l(umd.exports),h=c(minimal$2),v=require$$2,S=struct;a.protobufPackage="apis.event.v2";var b;(function(N){N.EVENTS_STREAM_MESSAGE_TYPE_UNSPECIFIED="EVENTS_STREAM_MESSAGE_TYPE_UNSPECIFIED",N.EVENTS_STREAM_MESSAGE_TYPE_PING="EVENTS_STREAM_MESSAGE_TYPE_PING",N.EVENTS_STREAM_MESSAGE_TYPE_ERROR="EVENTS_STREAM_MESSAGE_TYPE_ERROR",N.EVENTS_STREAM_MESSAGE_TYPE_SUBSCRIBED="EVENTS_STREAM_MESSAGE_TYPE_SUBSCRIBED",N.EVENTS_STREAM_MESSAGE_TYPE_UNSUBSCRIBED="EVENTS_STREAM_MESSAGE_TYPE_UNSUBSCRIBED",N.EVENTS_STREAM_MESSAGE_TYPE_PUBLISHED="EVENTS_STREAM_MESSAGE_TYPE_PUBLISHED"})(b=a.EventsStreamMessageType||(a.EventsStreamMessageType={}));function _(N){switch(N){case 0:case"EVENTS_STREAM_MESSAGE_TYPE_UNSPECIFIED":return b.EVENTS_STREAM_MESSAGE_TYPE_UNSPECIFIED;case 1:case"EVENTS_STREAM_MESSAGE_TYPE_PING":return b.EVENTS_STREAM_MESSAGE_TYPE_PING;case 2:case"EVENTS_STREAM_MESSAGE_TYPE_ERROR":return b.EVENTS_STREAM_MESSAGE_TYPE_ERROR;case 3:case"EVENTS_STREAM_MESSAGE_TYPE_SUBSCRIBED":return b.EVENTS_STREAM_MESSAGE_TYPE_SUBSCRIBED;case 4:case"EVENTS_STREAM_MESSAGE_TYPE_UNSUBSCRIBED":return b.EVENTS_STREAM_MESSAGE_TYPE_UNSUBSCRIBED;case 5:case"EVENTS_STREAM_MESSAGE_TYPE_PUBLISHED":return b.EVENTS_STREAM_MESSAGE_TYPE_PUBLISHED;default:throw new G.Error("Unrecognized enum value "+N+" for enum EventsStreamMessageType")}}a.eventsStreamMessageTypeFromJSON=_;function I(N){switch(N){case b.EVENTS_STREAM_MESSAGE_TYPE_UNSPECIFIED:return"EVENTS_STREAM_MESSAGE_TYPE_UNSPECIFIED";case b.EVENTS_STREAM_MESSAGE_TYPE_PING:return"EVENTS_STREAM_MESSAGE_TYPE_PING";case b.EVENTS_STREAM_MESSAGE_TYPE_ERROR:return"EVENTS_STREAM_MESSAGE_TYPE_ERROR";case b.EVENTS_STREAM_MESSAGE_TYPE_SUBSCRIBED:return"EVENTS_STREAM_MESSAGE_TYPE_SUBSCRIBED";case b.EVENTS_STREAM_MESSAGE_TYPE_UNSUBSCRIBED:return"EVENTS_STREAM_MESSAGE_TYPE_UNSUBSCRIBED";case b.EVENTS_STREAM_MESSAGE_TYPE_PUBLISHED:return"EVENTS_STREAM_MESSAGE_TYPE_PUBLISHED";default:return"UNKNOWN"}}a.eventsStreamMessageTypeToJSON=I;function T(N){switch(N){case b.EVENTS_STREAM_MESSAGE_TYPE_UNSPECIFIED:return 0;case b.EVENTS_STREAM_MESSAGE_TYPE_PING:return 1;case b.EVENTS_STREAM_MESSAGE_TYPE_ERROR:return 2;case b.EVENTS_STREAM_MESSAGE_TYPE_SUBSCRIBED:return 3;case b.EVENTS_STREAM_MESSAGE_TYPE_UNSUBSCRIBED:return 4;case b.EVENTS_STREAM_MESSAGE_TYPE_PUBLISHED:return 5;default:return 0}}a.eventsStreamMessageTypeToNumber=T;function k(){return{collectionId:void 0,projectId:void 0,layoutId:void 0}}a.EventTarget={encode(N,z=h.Writer.create()){return N.collectionId!==void 0&&z.uint32(42).string(N.collectionId),N.projectId!==void 0&&z.uint32(34).string(N.projectId),N.layoutId!==void 0&&z.uint32(10).string(N.layoutId),z},decode(N,z){const Z=N instanceof h.Reader?N:new h.Reader(N);let L=z===void 0?Z.len:Z.pos+z;const V=k();for(;Z.pos<L;){const H=Z.uint32();switch(H>>>3){case 5:V.collectionId=Z.string();break;case 4:V.projectId=Z.string();break;case 1:V.layoutId=Z.string();break;default:Z.skipType(H&7);break}}return V},fromJSON(N){return{collectionId:Y(N.collectionId)?String(N.collectionId):void 0,projectId:Y(N.projectId)?String(N.projectId):void 0,layoutId:Y(N.layoutId)?String(N.layoutId):void 0}},toJSON(N){const z={};return N.collectionId!==void 0&&(z.collectionId=N.collectionId),N.projectId!==void 0&&(z.projectId=N.projectId),N.layoutId!==void 0&&(z.layoutId=N.layoutId),z},fromPartial(N){var z,Z,L;const V=k();return V.collectionId=(z=N.collectionId)!==null&&z!==void 0?z:void 0,V.projectId=(Z=N.projectId)!==null&&Z!==void 0?Z:void 0,V.layoutId=(L=N.layoutId)!==null&&L!==void 0?L:void 0,V}};function w(){return{name:"",payload:void 0,requestMetadata:void 0,target:void 0}}a.PublishEventRequest={encode(N,z=h.Writer.create()){return N.name!==""&&z.uint32(10).string(N.name),N.payload!==void 0&&S.Struct.encode(S.Struct.wrap(N.payload),z.uint32(18).fork()).ldelim(),N.requestMetadata!==void 0&&S.Value.encode(S.Value.wrap(N.requestMetadata),z.uint32(34).fork()).ldelim(),N.target!==void 0&&a.EventTarget.encode(N.target,z.uint32(26).fork()).ldelim(),z},decode(N,z){const Z=N instanceof h.Reader?N:new h.Reader(N);let L=z===void 0?Z.len:Z.pos+z;const V=w();for(;Z.pos<L;){const H=Z.uint32();switch(H>>>3){case 1:V.name=Z.string();break;case 2:V.payload=S.Struct.unwrap(S.Struct.decode(Z,Z.uint32()));break;case 4:V.requestMetadata=S.Value.unwrap(S.Value.decode(Z,Z.uint32()));break;case 3:V.target=a.EventTarget.decode(Z,Z.uint32());break;default:Z.skipType(H&7);break}}return V},fromJSON(N){return{name:Y(N.name)?String(N.name):"",payload:x(N.payload)?N.payload:void 0,requestMetadata:Y(N==null?void 0:N.requestMetadata)?N.requestMetadata:void 0,target:Y(N.target)?a.EventTarget.fromJSON(N.target):void 0}},toJSON(N){const z={};return N.name!==void 0&&(z.name=N.name),N.payload!==void 0&&(z.payload=N.payload),N.requestMetadata!==void 0&&(z.requestMetadata=N.requestMetadata),N.target!==void 0&&(z.target=N.target?a.EventTarget.toJSON(N.target):void 0),z},fromPartial(N){var z,Z,L;const V=w();return V.name=(z=N.name)!==null&&z!==void 0?z:"",V.payload=(Z=N.payload)!==null&&Z!==void 0?Z:void 0,V.requestMetadata=(L=N.requestMetadata)!==null&&L!==void 0?L:void 0,V.target=N.target!==void 0&&N.target!==null?a.EventTarget.fromPartial(N.target):void 0,V}};function P(){return{name:"",payload:void 0,target:void 0,requestMetadata:void 0,id:""}}a.PublishEventResponse={encode(N,z=h.Writer.create()){return N.name!==""&&z.uint32(10).string(N.name),N.payload!==void 0&&S.Struct.encode(S.Struct.wrap(N.payload),z.uint32(18).fork()).ldelim(),N.target!==void 0&&a.EventTarget.encode(N.target,z.uint32(26).fork()).ldelim(),N.requestMetadata!==void 0&&S.Value.encode(S.Value.wrap(N.requestMetadata),z.uint32(34).fork()).ldelim(),N.id!==""&&z.uint32(42).string(N.id),z},decode(N,z){const Z=N instanceof h.Reader?N:new h.Reader(N);let L=z===void 0?Z.len:Z.pos+z;const V=P();for(;Z.pos<L;){const H=Z.uint32();switch(H>>>3){case 1:V.name=Z.string();break;case 2:V.payload=S.Struct.unwrap(S.Struct.decode(Z,Z.uint32()));break;case 3:V.target=a.EventTarget.decode(Z,Z.uint32());break;case 4:V.requestMetadata=S.Value.unwrap(S.Value.decode(Z,Z.uint32()));break;case 5:V.id=Z.string();break;default:Z.skipType(H&7);break}}return V},fromJSON(N){return{name:Y(N.name)?String(N.name):"",payload:x(N.payload)?N.payload:void 0,target:Y(N.target)?a.EventTarget.fromJSON(N.target):void 0,requestMetadata:Y(N==null?void 0:N.requestMetadata)?N.requestMetadata:void 0,id:Y(N.id)?String(N.id):""}},toJSON(N){const z={};return N.name!==void 0&&(z.name=N.name),N.payload!==void 0&&(z.payload=N.payload),N.target!==void 0&&(z.target=N.target?a.EventTarget.toJSON(N.target):void 0),N.requestMetadata!==void 0&&(z.requestMetadata=N.requestMetadata),N.id!==void 0&&(z.id=N.id),z},fromPartial(N){var z,Z,L,V;const H=P();return H.name=(z=N.name)!==null&&z!==void 0?z:"",H.payload=(Z=N.payload)!==null&&Z!==void 0?Z:void 0,H.target=N.target!==void 0&&N.target!==null?a.EventTarget.fromPartial(N.target):void 0,H.requestMetadata=(L=N.requestMetadata)!==null&&L!==void 0?L:void 0,H.id=(V=N.id)!==null&&V!==void 0?V:"",H}};function $(){return{name:"",target:void 0}}a.SubscribePayload={encode(N,z=h.Writer.create()){return N.name!==""&&z.uint32(10).string(N.name),N.target!==void 0&&a.EventTarget.encode(N.target,z.uint32(18).fork()).ldelim(),z},decode(N,z){const Z=N instanceof h.Reader?N:new h.Reader(N);let L=z===void 0?Z.len:Z.pos+z;const V=$();for(;Z.pos<L;){const H=Z.uint32();switch(H>>>3){case 1:V.name=Z.string();break;case 2:V.target=a.EventTarget.decode(Z,Z.uint32());break;default:Z.skipType(H&7);break}}return V},fromJSON(N){return{name:Y(N.name)?String(N.name):"",target:Y(N.target)?a.EventTarget.fromJSON(N.target):void 0}},toJSON(N){const z={};return N.name!==void 0&&(z.name=N.name),N.target!==void 0&&(z.target=N.target?a.EventTarget.toJSON(N.target):void 0),z},fromPartial(N){var z;const Z=$();return Z.name=(z=N.name)!==null&&z!==void 0?z:"",Z.target=N.target!==void 0&&N.target!==null?a.EventTarget.fromPartial(N.target):void 0,Z}};function U(){return{code:0,message:""}}a.EventsStreamError={encode(N,z=h.Writer.create()){return N.code!==0&&z.uint32(8).int32(N.code),N.message!==""&&z.uint32(18).string(N.message),z},decode(N,z){const Z=N instanceof h.Reader?N:new h.Reader(N);let L=z===void 0?Z.len:Z.pos+z;const V=U();for(;Z.pos<L;){const H=Z.uint32();switch(H>>>3){case 1:V.code=Z.int32();break;case 2:V.message=Z.string();break;default:Z.skipType(H&7);break}}return V},fromJSON(N){return{code:Y(N.code)?Number(N.code):0,message:Y(N.message)?String(N.message):""}},toJSON(N){const z={};return N.code!==void 0&&(z.code=Math.round(N.code)),N.message!==void 0&&(z.message=N.message),z},fromPartial(N){var z,Z;const L=U();return L.code=(z=N.code)!==null&&z!==void 0?z:0,L.message=(Z=N.message)!==null&&Z!==void 0?Z:"",L}};function E(){return{reauthenticate:!1,beforeTimestamp:""}}a.EventsStreamReconnectRequest={encode(N,z=h.Writer.create()){return N.reauthenticate===!0&&z.uint32(8).bool(N.reauthenticate),N.beforeTimestamp!==""&&z.uint32(18).string(N.beforeTimestamp),z},decode(N,z){const Z=N instanceof h.Reader?N:new h.Reader(N);let L=z===void 0?Z.len:Z.pos+z;const V=E();for(;Z.pos<L;){const H=Z.uint32();switch(H>>>3){case 1:V.reauthenticate=Z.bool();break;case 2:V.beforeTimestamp=Z.string();break;default:Z.skipType(H&7);break}}return V},fromJSON(N){return{reauthenticate:Y(N.reauthenticate)?Boolean(N.reauthenticate):!1,beforeTimestamp:Y(N.beforeTimestamp)?String(N.beforeTimestamp):""}},toJSON(N){const z={};return N.reauthenticate!==void 0&&(z.reauthenticate=N.reauthenticate),N.beforeTimestamp!==void 0&&(z.beforeTimestamp=N.beforeTimestamp),z},fromPartial(N){var z,Z;const L=E();return L.reauthenticate=(z=N.reauthenticate)!==null&&z!==void 0?z:!1,L.beforeTimestamp=(Z=N.beforeTimestamp)!==null&&Z!==void 0?Z:"",L}};function D(){return{correlationId:void 0,subscribe:void 0,unsubscribe:void 0,publish:void 0,ping:void 0}}a.EventsStreamRequest={encode(N,z=h.Writer.create()){return N.correlationId!==void 0&&z.uint32(10).string(N.correlationId),N.subscribe!==void 0&&a.SubscribePayload.encode(N.subscribe,z.uint32(802).fork()).ldelim(),N.unsubscribe!==void 0&&a.SubscribePayload.encode(N.unsubscribe,z.uint32(810).fork()).ldelim(),N.publish!==void 0&&a.PublishEventRequest.encode(N.publish,z.uint32(818).fork()).ldelim(),N.ping!==void 0&&z.uint32(826).string(N.ping),z},decode(N,z){const Z=N instanceof h.Reader?N:new h.Reader(N);let L=z===void 0?Z.len:Z.pos+z;const V=D();for(;Z.pos<L;){const H=Z.uint32();switch(H>>>3){case 1:V.correlationId=Z.string();break;case 100:V.subscribe=a.SubscribePayload.decode(Z,Z.uint32());break;case 101:V.unsubscribe=a.SubscribePayload.decode(Z,Z.uint32());break;case 102:V.publish=a.PublishEventRequest.decode(Z,Z.uint32());break;case 103:V.ping=Z.string();break;default:Z.skipType(H&7);break}}return V},fromJSON(N){return{correlationId:Y(N.correlationId)?String(N.correlationId):void 0,subscribe:Y(N.subscribe)?a.SubscribePayload.fromJSON(N.subscribe):void 0,unsubscribe:Y(N.unsubscribe)?a.SubscribePayload.fromJSON(N.unsubscribe):void 0,publish:Y(N.publish)?a.PublishEventRequest.fromJSON(N.publish):void 0,ping:Y(N.ping)?String(N.ping):void 0}},toJSON(N){const z={};return N.correlationId!==void 0&&(z.correlationId=N.correlationId),N.subscribe!==void 0&&(z.subscribe=N.subscribe?a.SubscribePayload.toJSON(N.subscribe):void 0),N.unsubscribe!==void 0&&(z.unsubscribe=N.unsubscribe?a.SubscribePayload.toJSON(N.unsubscribe):void 0),N.publish!==void 0&&(z.publish=N.publish?a.PublishEventRequest.toJSON(N.publish):void 0),N.ping!==void 0&&(z.ping=N.ping),z},fromPartial(N){var z,Z;const L=D();return L.correlationId=(z=N.correlationId)!==null&&z!==void 0?z:void 0,L.subscribe=N.subscribe!==void 0&&N.subscribe!==null?a.SubscribePayload.fromPartial(N.subscribe):void 0,L.unsubscribe=N.unsubscribe!==void 0&&N.unsubscribe!==null?a.SubscribePayload.fromPartial(N.unsubscribe):void 0,L.publish=N.publish!==void 0&&N.publish!==null?a.PublishEventRequest.fromPartial(N.publish):void 0,L.ping=(Z=N.ping)!==null&&Z!==void 0?Z:void 0,L}};function F(){return{correlationId:void 0,sessionId:void 0,event:void 0,pong:void 0,error:void 0,subscribed:void 0,unsubscribed:void 0,published:void 0,reconnectBefore:void 0}}a.EventsStreamResponse={encode(N,z=h.Writer.create()){return N.correlationId!==void 0&&z.uint32(18).string(N.correlationId),N.sessionId!==void 0&&z.uint32(26).string(N.sessionId),N.event!==void 0&&a.PublishEventResponse.encode(N.event,z.uint32(802).fork()).ldelim(),N.pong!==void 0&&z.uint32(1602).string(N.pong),N.error!==void 0&&a.EventsStreamError.encode(N.error,z.uint32(1610).fork()).ldelim(),N.subscribed!==void 0&&a.SubscribePayload.encode(N.subscribed,z.uint32(1618).fork()).ldelim(),N.unsubscribed!==void 0&&a.SubscribePayload.encode(N.unsubscribed,z.uint32(1626).fork()).ldelim(),N.published!==void 0&&a.PublishEventResponse.encode(N.published,z.uint32(1634).fork()).ldelim(),N.reconnectBefore!==void 0&&a.EventsStreamReconnectRequest.encode(N.reconnectBefore,z.uint32(1642).fork()).ldelim(),z},decode(N,z){const Z=N instanceof h.Reader?N:new h.Reader(N);let L=z===void 0?Z.len:Z.pos+z;const V=F();for(;Z.pos<L;){const H=Z.uint32();switch(H>>>3){case 2:V.correlationId=Z.string();break;case 3:V.sessionId=Z.string();break;case 100:V.event=a.PublishEventResponse.decode(Z,Z.uint32());break;case 200:V.pong=Z.string();break;case 201:V.error=a.EventsStreamError.decode(Z,Z.uint32());break;case 202:V.subscribed=a.SubscribePayload.decode(Z,Z.uint32());break;case 203:V.unsubscribed=a.SubscribePayload.decode(Z,Z.uint32());break;case 204:V.published=a.PublishEventResponse.decode(Z,Z.uint32());break;case 205:V.reconnectBefore=a.EventsStreamReconnectRequest.decode(Z,Z.uint32());break;default:Z.skipType(H&7);break}}return V},fromJSON(N){return{correlationId:Y(N.correlationId)?String(N.correlationId):void 0,sessionId:Y(N.sessionId)?String(N.sessionId):void 0,event:Y(N.event)?a.PublishEventResponse.fromJSON(N.event):void 0,pong:Y(N.pong)?String(N.pong):void 0,error:Y(N.error)?a.EventsStreamError.fromJSON(N.error):void 0,subscribed:Y(N.subscribed)?a.SubscribePayload.fromJSON(N.subscribed):void 0,unsubscribed:Y(N.unsubscribed)?a.SubscribePayload.fromJSON(N.unsubscribed):void 0,published:Y(N.published)?a.PublishEventResponse.fromJSON(N.published):void 0,reconnectBefore:Y(N.reconnectBefore)?a.EventsStreamReconnectRequest.fromJSON(N.reconnectBefore):void 0}},toJSON(N){const z={};return N.correlationId!==void 0&&(z.correlationId=N.correlationId),N.sessionId!==void 0&&(z.sessionId=N.sessionId),N.event!==void 0&&(z.event=N.event?a.PublishEventResponse.toJSON(N.event):void 0),N.pong!==void 0&&(z.pong=N.pong),N.error!==void 0&&(z.error=N.error?a.EventsStreamError.toJSON(N.error):void 0),N.subscribed!==void 0&&(z.subscribed=N.subscribed?a.SubscribePayload.toJSON(N.subscribed):void 0),N.unsubscribed!==void 0&&(z.unsubscribed=N.unsubscribed?a.SubscribePayload.toJSON(N.unsubscribed):void 0),N.published!==void 0&&(z.published=N.published?a.PublishEventResponse.toJSON(N.published):void 0),N.reconnectBefore!==void 0&&(z.reconnectBefore=N.reconnectBefore?a.EventsStreamReconnectRequest.toJSON(N.reconnectBefore):void 0),z},fromPartial(N){var z,Z,L;const V=F();return V.correlationId=(z=N.correlationId)!==null&&z!==void 0?z:void 0,V.sessionId=(Z=N.sessionId)!==null&&Z!==void 0?Z:void 0,V.event=N.event!==void 0&&N.event!==null?a.PublishEventResponse.fromPartial(N.event):void 0,V.pong=(L=N.pong)!==null&&L!==void 0?L:void 0,V.error=N.error!==void 0&&N.error!==null?a.EventsStreamError.fromPartial(N.error):void 0,V.subscribed=N.subscribed!==void 0&&N.subscribed!==null?a.SubscribePayload.fromPartial(N.subscribed):void 0,V.unsubscribed=N.unsubscribed!==void 0&&N.unsubscribed!==null?a.SubscribePayload.fromPartial(N.unsubscribed):void 0,V.published=N.published!==void 0&&N.published!==null?a.PublishEventResponse.fromPartial(N.published):void 0,V.reconnectBefore=N.reconnectBefore!==void 0&&N.reconnectBefore!==null?a.EventsStreamReconnectRequest.fromPartial(N.reconnectBefore):void 0,V}};class J{constructor(z){this.rpc=z,this.Stream=this.Stream.bind(this),this.Publish=this.Publish.bind(this)}Stream(z){const Z=z.pipe(v.map(V=>a.EventsStreamRequest.encode(V).finish()));return this.rpc.bidirectionalStreamingRequest("apis.event.v2.EventService","Stream",Z).pipe(v.map(V=>a.EventsStreamResponse.decode(new h.Reader(V))))}Publish(z){const Z=a.PublishEventRequest.encode(z).finish();return this.rpc.request("apis.event.v2.EventService","Publish",Z).then(V=>a.PublishEventResponse.decode(new h.Reader(V)))}}a.EventServiceClientImpl=J,a.EventServiceDefinition={name:"EventService",fullName:"apis.event.v2.EventService",methods:{stream:{name:"Stream",requestType:a.EventsStreamRequest,requestStream:!0,responseType:a.EventsStreamResponse,responseStream:!0,options:{}},publish:{name:"Publish",requestType:a.PublishEventRequest,requestStream:!1,responseType:a.PublishEventResponse,responseStream:!1,options:{}}}};var G=(()=>{if(typeof G!="undefined")return G;if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof commonjsGlobal$1!="undefined")return commonjsGlobal$1;throw"Unable to locate global object"})();h.util.Long!==p.default&&(h.util.Long=p.default,h.configure());function x(N){return typeof N=="object"&&N!==null}function Y(N){return N!=null}}(api),function(a){var s=commonjsGlobal$1&&commonjsGlobal$1.__createBinding||(Object.create?function(c,l,p,h){h===void 0&&(h=p),Object.defineProperty(c,h,{enumerable:!0,get:function(){return l[p]}})}:function(c,l,p,h){h===void 0&&(h=p),c[h]=l[p]}),d=commonjsGlobal$1&&commonjsGlobal$1.__exportStar||function(c,l){for(var p in c)p!=="default"&&!l.hasOwnProperty(p)&&s(l,c,p)};Object.defineProperty(a,"__esModule",{value:!0}),a.eventsApiSupportedEvents=a.eventsApiEventRpcCalls=void 0,d(api,a),a.eventsApiEventRpcCalls={ping:"pong",publish:"published",subscribe:"subscribed",unsubscribe:"unsubscribed"},a.eventsApiSupportedEvents=[...Object.values(a.eventsApiEventRpcCalls),"error","event","reconnectBefore"]}(dist$1);var ws=null;typeof WebSocket!="undefined"?ws=WebSocket:typeof MozWebSocket!="undefined"?ws=MozWebSocket:typeof commonjsGlobal$1!="undefined"?ws=commonjsGlobal$1.WebSocket||commonjsGlobal$1.MozWebSocket:typeof window!="undefined"?ws=window.WebSocket||window.MozWebSocket:typeof self!="undefined"&&(ws=self.WebSocket||self.MozWebSocket);var browser$1=ws,matcher={exports:{}},escapeStringRegexp$1=a=>{if(typeof a!="string")throw new TypeError("Expected a string");return a.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")};const escapeStringRegexp=escapeStringRegexp$1,regexpCache=new Map;function sanitizeArray(a,s){if(!Array.isArray(a))switch(typeof a){case"string":a=[a];break;case"undefined":a=[];break;default:throw new TypeError(`Expected '${s}' to be a string or an array, but got a type of '${typeof a}'`)}return a.filter(d=>{if(typeof d!="string"){if(typeof d=="undefined")return!1;throw new TypeError(`Expected '${s}' to be an array of strings, but found a type of '${typeof d}' in the array`)}return!0})}function makeRegexp(a,s){s={caseSensitive:!1,...s};const d=a+JSON.stringify(s);if(regexpCache.has(d))return regexpCache.get(d);const c=a[0]==="!";c&&(a=a.slice(1)),a=escapeStringRegexp(a).replace(/\\\*/g,"[\\s\\S]*");const l=new RegExp(`^${a}$`,s.caseSensitive?"":"i");return l.negated=c,regexpCache.set(d,l),l}matcher.exports=(a,s,d)=>{if(a=sanitizeArray(a,"inputs"),s=sanitizeArray(s,"patterns"),s.length===0)return[];const c=s[0][0]==="!";s=s.map(p=>makeRegexp(p,d));const l=[];for(const p of a){let h=c;for(const v of s)v.test(p)&&(h=!v.negated);h&&l.push(p)}return l},matcher.exports.isMatch=(a,s,d)=>(a=sanitizeArray(a,"inputs"),s=sanitizeArray(s,"patterns"),s.length===0?!1:a.some(c=>s.every(l=>{const p=makeRegexp(l,d),h=p.test(c);return p.negated?!h:h})));var __createBinding=commonjsGlobal$1&&commonjsGlobal$1.__createBinding||(Object.create?function(a,s,d,c){c===void 0&&(c=d);var l=Object.getOwnPropertyDescriptor(s,d);(!l||("get"in l?!s.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return s[d]}}),Object.defineProperty(a,c,l)}:function(a,s,d,c){c===void 0&&(c=d),a[c]=s[d]}),__setModuleDefault=commonjsGlobal$1&&commonjsGlobal$1.__setModuleDefault||(Object.create?function(a,s){Object.defineProperty(a,"default",{enumerable:!0,value:s})}:function(a,s){a.default=s}),__importStar=commonjsGlobal$1&&commonjsGlobal$1.__importStar||function(a){if(a&&a.__esModule)return a;var s={};if(a!=null)for(var d in a)d!=="default"&&Object.prototype.hasOwnProperty.call(a,d)&&__createBinding(s,a,d);return __setModuleDefault(s,a),s},__importDefault$2=commonjsGlobal$1&&commonjsGlobal$1.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(eventapi,"__esModule",{value:!0}),eventapi.EventApi=void 0;const EventApiModel=__importStar(dist$1),isomorphic_ws_1=__importDefault$2(browser$1),uuid_1=require$$1$2,NiceGrpc=__importStar(lib$1),matcher_1=matcher.exports,api_1=api$2,clientVersion=version$3,WS_PING_INTERVAL=2e4,WS_PING_TIMEOUT=1e4,WS_RECONNECT_DELAY=2e3,WS_MAX_BADAUTH_ATTEMPTS=3,LOG_CATEGORY="EventApi";class EventApi extends api_1.ApiClient{constructor(s,d,c,l,p,h){super(s,d,l,LOG_CATEGORY,p,h),this.websocketServer=c,this.subscriptions=new Set,this.eventHandlers={},this.calls={},this.messageQueue=[],this.websocketReady=!1,this.reconnectionAttempts=0,this.badAuthentication=!1,this.eventsClient=null}publish(...s){return this.websocketReady?this.call("publish",s[0]):this.eventsClient.publish(...s)}connect(){if(!this.ws){this.cleanup();const s=this.accessToken,d=[`version=${clientVersion}`,`sessionid=${this.sessionId}`];this.sdkVersion&&d.push(`sdkversion=${this.sdkVersion}`),this.ws=new isomorphic_ws_1.default(`${this.websocketServer}/stream?${d.join("&")}`,["Bearer",this.accessToken]);let c;this.ws.addEventListener("message",l=>{const p=JSON.parse(l.data.toString()),h=p.result;if(p.error&&(c=p.error,this.handleEvent("error",{error:{code:p.code,message:p.message}}),["You do not have permission to this resource","You do not have permission to this resource"].includes(p.message)&&(this.badAuthentication=!0)),!h)return;h.reconnectBefore&&h.reconnectBefore.reauthenticate&&this.accessToken===s&&(this.badAuthentication=!0);const v=EventApiModel.eventsApiSupportedEvents.find(S=>!!h[S]);v&&this.handleEvent(v,h)}),this.ws.addEventListener("open",()=>{this.log.info("websocket connected"),this.call("ping","hello",{timeout:WS_PING_TIMEOUT,skipQueue:!0}).then(()=>{this.ready()}).catch(l=>{!c&&l.message!=="Stream connection closed"&&this.disconnect("hello timeout")})}),this.ws.addEventListener("close",l=>{var p;c?this.reconnect(`${(p=c==null?void 0:c.message)!==null&&p!==void 0?p:"unknown"}`):this.reconnect(`closed - ${l.reason||l.code}`)}),this.ws.addEventListener("error",l=>{c=l})}}async subscribe(s,d={}){return this.call("subscribe",{name:s,...d}).then(()=>{this.subscriptions.add(JSON.stringify({name:s,...d}))})}async unsubscribe(s,d={}){this.subscriptions.delete(JSON.stringify({name:s,payload:d})),await this.call("unsubscribe",{name:s,...d})}on(s,d,c){const l=c||d,p={ignoreSessionEvents:!1,allowedSessionEvents:[],...c?d:{}};this.eventHandlers[s]||(this.eventHandlers[s]=[]),this.eventHandlers[s].push({...p,handler:l})}off(s,d,c){var l;const p=c||d,h={ignoreSessionEvents:!1,allowedSessionEvents:[],...c?d:{}};this.eventHandlers[s]=((l=this.eventHandlers[s])!==null&&l!==void 0?l:[]).filter(v=>!(v.ignoreSessionEvents===h.ignoreSessionEvents&&v.allowedSessionEvents===h.allowedSessionEvents&&v.handler===p&&v.name===h.name))}disconnect(s){this.log.warn(`disconnected from events reason=${s}`),Object.values(this.calls).forEach(d=>{clearTimeout(d.timeout),d.reject(new Error("Stream connection closed"))}),this.calls={},this.cleanup()}_setup(s){this.eventsClient=this.clientFactory.create(EventApiModel.EventServiceDefinition,this.channel,{"*":s}),this.badAuthentication&&(this.badAuthentication=!1,this.reconnectionAttempts=0,this.reconnect("updated token"))}ready(){this.reconnectionAttempts=0,this.badAuthentication=!1,this.websocketReady=!0,this.handleEvent("connected",{connected:void 0});for(const s of this.subscriptions.values())this.send({subscribe:JSON.parse(s),correlationId:(0,uuid_1.v4)()});for(const s of this.messageQueue)this.send(s);this.messageQueue=[],this.pingLoop=setInterval(()=>{this.ping()},WS_PING_INTERVAL)}ping(){this.call("ping",`${+new Date}`,{timeout:WS_PING_TIMEOUT}).catch(()=>{this.reconnect("connection stalled")})}reconnect(s){this.disconnect(s),this.reconnectTimeout=setTimeout(()=>{if(this.reconnectionAttempts++,this.badAuthentication&&this.reconnectionAttempts>=WS_MAX_BADAUTH_ATTEMPTS){this.log.warn("Maximum number of reconnection attempts reached with bad authentication, please re-authenticate the SDK");return}this.connect()},WS_RECONNECT_DELAY)}send(s){this.ws&&this.ws.readyState===this.ws.OPEN?this.ws.send(JSON.stringify(s)):this.log.warn("Message sent to a disconnected stream")}handleEvent(s,d){var c;if(this.calls[d.correlationId]){const l=EventApiModel.eventsApiEventRpcCalls[this.calls[d.correlationId].method]===s,p=!!d.error;if(l||p){this.resolveCall(s,d);return}}for(const l of(c=this.eventHandlers[s])!==null&&c!==void 0?c:[]){if(s==="event"&&d.event){if(d.sessionId===this.sessionId&&l.ignoreSessionEvents&&!l.allowedSessionEvents.includes(d.event.name)){this.log.trace("ignorning user event from self: "+d.event.name+", payload.sessionId="+d.sessionId+", this.sessionId");continue}if(l.name&&!(0,matcher_1.isMatch)(d.event.name,l.name))continue;if(this.eventLogCallback){let p,h=d.event.name,v;if(d.event.name.startsWith(EventApi.APISTREAM_EVENT_PREFIX)){let S=d.event.name.split(":");S.length==4&&(p=S[1],h=S[2],v=S[3]),this.eventLogCallback(p,h,v,d)}}}else if(d.sessionId===this.sessionId&&l.ignoreSessionEvents){this.log.trace("ignorning event from self: "+d.event.name+", payload.sessionId="+d.sessionId+", this.sessionId");continue}this.log.trace("processing event: payload.sessionId="+d.sessionId+", this.sessionId"),l.handler(d?d[s]:void 0,{isFromCurrentSession:d.sessionId===this.sessionId})}}async call(s,d,c={timeout:2e4,skipQueue:!1}){this.ws||this.connect();const l=(0,uuid_1.v4)();return new Promise((p,h)=>{const v=setTimeout(()=>{delete this.calls[l],h(new Error("Request timed out"))},c.timeout);this.calls[l]={resolve:p,reject:h,timeout:v,method:s},this.websocketReady||c.skipQueue?this.send({[s]:d,correlationId:l}):this.messageQueue.push({[s]:d,correlationId:l})})}resolveCall(s,d){const c=this.calls[d.correlationId];if(!!c){if(clearTimeout(c.timeout),delete this.calls[d.correlationId],s==="error"&&d.error){c.reject(new NiceGrpc.ClientError("error",d.error.code,d.error.message));return}c.resolve(d[s])}}cleanup(){clearTimeout(this.pingLoop),clearTimeout(this.reconnectTimeout),this.websocketReady=!1,this.ws&&(this.ws.onclose=function(){},this.ws.close(),this.ws=null)}}eventapi.EventApi=EventApi,EventApi.APISTREAM_EVENT_PREFIX="apistream";var livekit={},__importDefault$1=commonjsGlobal$1&&commonjsGlobal$1.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(livekit,"__esModule",{value:!0}),livekit.LiveKitUtils=void 0;const jwt_decode_1=__importDefault$1(require$$0$1);class LiveKitUtils{static decodeJwt(s){return(0,jwt_decode_1.default)(s,{header:!1})}static isRoomAdmin(s){return LiveKitUtils.decodeJwt(s).video.roomAdmin}static getRoomName(s){return LiveKitUtils.decodeJwt(s).video.room}}livekit.LiveKitUtils=LiveKitUtils,function(a){var s=commonjsGlobal$1&&commonjsGlobal$1.__createBinding||(Object.create?function(Y,N,z,Z){Z===void 0&&(Z=z);var L=Object.getOwnPropertyDescriptor(N,z);(!L||("get"in L?!N.__esModule:L.writable||L.configurable))&&(L={enumerable:!0,get:function(){return N[z]}}),Object.defineProperty(Y,Z,L)}:function(Y,N,z,Z){Z===void 0&&(Z=z),Y[Z]=N[z]}),d=commonjsGlobal$1&&commonjsGlobal$1.__setModuleDefault||(Object.create?function(Y,N){Object.defineProperty(Y,"default",{enumerable:!0,value:N})}:function(Y,N){Y.default=N}),c=commonjsGlobal$1&&commonjsGlobal$1.__importStar||function(Y){if(Y&&Y.__esModule)return Y;var N={};if(Y!=null)for(var z in Y)z!=="default"&&Object.prototype.hasOwnProperty.call(Y,z)&&s(N,Y,z);return d(N,Y),N},l=commonjsGlobal$1&&commonjsGlobal$1.__importDefault||function(Y){return Y&&Y.__esModule?Y:{default:Y}};Object.defineProperty(a,"__esModule",{value:!0}),a.ApiStream=a.LiveKitUtils=a.EventApiModel=a.LayoutApiModel=a.LiveApiModel=void 0;const p=l(require$$0$1),h=require$$1$2,v=require$$2$1,S=layoutapi,b=liveapi,_=eventapi,I=c(api$1);a.LiveApiModel=I;const T=c(dist$2);a.LayoutApiModel=T;const k=c(dist$1);a.EventApiModel=k;const w=livekit;Object.defineProperty(a,"LiveKitUtils",{enumerable:!0,get:function(){return w.LiveKitUtils}});const P=logger,$=version$3,U={dev:"http://127.0.0.1:8081",stage:"https://live.silly.horse/grpcweb/live/v2",prod:"https://live.api.stream/grpcweb/live/v2"},E={dev:"https://live.silly.horse/grpcweb/layout/v2",stage:"https://live.silly.horse/grpcweb/layout/v2",prod:"https://live.api.stream/grpcweb/layout/v2"},D={dev:"wss://live.silly.horse/event/v2",stage:"wss://live.silly.horse/event/v2",prod:"wss://live.api.stream/event/v2"},F={dev:"https://live.silly.horse/grpcweb/event/v2",stage:"https://live.silly.horse/grpcweb/event/v2",prod:"https://live.api.stream/grpcweb/event/v2"},J={dev:"wss://live.silly.horse/webrtc/v2",stage:"wss://live.silly.horse/webrtc/v2",prod:"wss://live.api.stream/webrtc/v2"},G={dev:"https://live.silly.horse/webrtc/v2",stage:"https://live.silly.horse/webrtc/v2",prod:"https://live.api.stream/webrtc/v2"};class x{constructor(N={}){var z;const Z={env:"prod",logLevel:"Warn",...N};this.env=Z.env;let L=(0,h.v4)();Z.sessionId!=null&&(L=Z.sessionId),this.log=P.logger.getCategory("ApiStream"),this.setLogLevel(Z.env=="dev"?"Trace":Z.logLevel);const V=(z=Z.overrideEndpoints)!==null&&z!==void 0?z:{};V.liveApiServer==null&&(V.liveApiServer=U[this.env]),V.layoutApiServer==null&&(V.layoutApiServer=E[this.env]),V.eventApiServer==null&&(V.eventApiServer=F[this.env]),V.eventApiWebSocketServer==null&&(V.eventApiWebSocketServer=D[this.env]),this.eventApi=new _.EventApi(L,V.eventApiServer,V.eventApiWebSocketServer,Z.sdkVersion,Z.apiLogCallback,Z.eventLogCallback),this.layoutApi=new S.LayoutApi(L,this.eventApi,V.layoutApiServer,Z.sdkVersion,Z.apiLogCallback),this.liveApi=new b.LiveApi(L,this.eventApi,V.liveApiServer,this.setAccessToken.bind(this),Z.apiKey,Z.sdkVersion,Z.apiLogCallback),this.eventApi.on("reconnectBefore",H=>{H.reauthenticate&&this.liveApi.authentication.refreshAccessToken({}).catch(()=>{})}),this.log.info("api.stream: sessionid="+L+", version="+$+", sdkVersion="+Z.sdkVersion)}LiveApi(){return this.liveApi}LayoutApi(){return this.layoutApi}EventApi(){return this.eventApi}setLogLevel(N){try{let z=v.LogLevel.toLogLevel(N);P.logger.updateRuntimeSettings({level:z})}catch{this.log.warn(`unknown logging level ${N}`)}}setAccessToken(N){this.decodedAccessToken=x.decodeAccessToken(N),this.log.debug("setting accessToken",N,this.decodedAccessToken),this.layoutApi.setAccessToken(N),this.liveApi.setAccessToken(N),this.eventApi.setAccessToken(N)}getAccessToken(){return this.decodedAccessToken}getGuestProject(){return this.decodedAccessToken.guestControl}async load(N){if(N==null&&typeof window!="undefined"){let z=this.parseQuery();z.get(x.ACCESS_TOKEN_QUERY_PARAM)!=null&&(N=z.get(x.ACCESS_TOKEN_QUERY_PARAM))}return N!=null&&(this.setAccessToken(N),this.decodedAccessToken.guestControl!=null)?(this.log.info("loading guest token and exchanging"),await this.LiveApi().authentication.refreshAccessToken({}),this.log.info("auto-loading project = "+JSON.stringify(this.decodedAccessToken.guestControl)),this.decodedAccessToken.guestControl):null}getLiveKitServer(N=!1){return N?G[this.env]:J[this.env]}parseQuery(){let N=window.location.search,z=new Map,Z=(N[0]==="?"?N.substr(1):N).split("&");for(let L=0;L<Z.length;L++){let V=Z[L].split("=");V.length==2&&(z.set(decodeURIComponent(V[0]),decodeURIComponent(V[1]||"")),this.log.debug(`found query param: ${decodeURIComponent(V[0])}=${decodeURIComponent(V[1]||"")}`))}return z}static decodeAccessToken(N){let z=(0,p.default)(N,{header:!1}),Z={serviceUserId:z.user.serviceUserId,userId:z.user.userId,displayName:z.user.displayName,trial:z.user.trial,demo:z.user.demo};return z.guestControl!=null&&(Z.guestControl={collectionId:z.guestControl.collectionId,projectId:z.guestControl.projectId,role:I.roleFromJSON(z.guestControl.role)}),Z}}a.ApiStream=x,x.ACCESS_TOKEN_QUERY_PARAM="at"}(lib$2);var dist={},grants={};Object.defineProperty(grants,"__esModule",{value:!0});var livekit_models={};(function(a){var s=commonjsGlobal$1&&commonjsGlobal$1.__importDefault||function(A){return A&&A.__esModule?A:{default:A}};Object.defineProperty(a,"__esModule",{value:!0}),a.ParticipantTracks=a.UserPacket=a.SpeakerInfo=a.ActiveSpeakerUpdate=a.DataPacket=a.VideoLayer=a.TrackInfo=a.ParticipantInfo=a.Codec=a.Room=a.dataPacket_KindToJSON=a.dataPacket_KindFromJSON=a.DataPacket_Kind=a.participantInfo_StateToJSON=a.participantInfo_StateFromJSON=a.ParticipantInfo_State=a.connectionQualityToJSON=a.connectionQualityFromJSON=a.ConnectionQuality=a.videoQualityToJSON=a.videoQualityFromJSON=a.VideoQuality=a.trackSourceToJSON=a.trackSourceFromJSON=a.TrackSource=a.trackTypeToJSON=a.trackTypeFromJSON=a.TrackType=a.protobufPackage=void 0;const d=s(umd.exports),c=s(minimal$2);a.protobufPackage="livekit";var l;(function(A){A[A.AUDIO=0]="AUDIO",A[A.VIDEO=1]="VIDEO",A[A.DATA=2]="DATA",A[A.UNRECOGNIZED=-1]="UNRECOGNIZED"})(l=a.TrackType||(a.TrackType={}));function p(A){switch(A){case 0:case"AUDIO":return l.AUDIO;case 1:case"VIDEO":return l.VIDEO;case 2:case"DATA":return l.DATA;case-1:case"UNRECOGNIZED":default:return l.UNRECOGNIZED}}a.trackTypeFromJSON=p;function h(A){switch(A){case l.AUDIO:return"AUDIO";case l.VIDEO:return"VIDEO";case l.DATA:return"DATA";default:return"UNKNOWN"}}a.trackTypeToJSON=h;var v;(function(A){A[A.UNKNOWN=0]="UNKNOWN",A[A.CAMERA=1]="CAMERA",A[A.MICROPHONE=2]="MICROPHONE",A[A.SCREEN_SHARE=3]="SCREEN_SHARE",A[A.SCREEN_SHARE_AUDIO=4]="SCREEN_SHARE_AUDIO",A[A.UNRECOGNIZED=-1]="UNRECOGNIZED"})(v=a.TrackSource||(a.TrackSource={}));function S(A){switch(A){case 0:case"UNKNOWN":return v.UNKNOWN;case 1:case"CAMERA":return v.CAMERA;case 2:case"MICROPHONE":return v.MICROPHONE;case 3:case"SCREEN_SHARE":return v.SCREEN_SHARE;case 4:case"SCREEN_SHARE_AUDIO":return v.SCREEN_SHARE_AUDIO;case-1:case"UNRECOGNIZED":default:return v.UNRECOGNIZED}}a.trackSourceFromJSON=S;function b(A){switch(A){case v.UNKNOWN:return"UNKNOWN";case v.CAMERA:return"CAMERA";case v.MICROPHONE:return"MICROPHONE";case v.SCREEN_SHARE:return"SCREEN_SHARE";case v.SCREEN_SHARE_AUDIO:return"SCREEN_SHARE_AUDIO";default:return"UNKNOWN"}}a.trackSourceToJSON=b;var _;(function(A){A[A.LOW=0]="LOW",A[A.MEDIUM=1]="MEDIUM",A[A.HIGH=2]="HIGH",A[A.UNRECOGNIZED=-1]="UNRECOGNIZED"})(_=a.VideoQuality||(a.VideoQuality={}));function I(A){switch(A){case 0:case"LOW":return _.LOW;case 1:case"MEDIUM":return _.MEDIUM;case 2:case"HIGH":return _.HIGH;case-1:case"UNRECOGNIZED":default:return _.UNRECOGNIZED}}a.videoQualityFromJSON=I;function T(A){switch(A){case _.LOW:return"LOW";case _.MEDIUM:return"MEDIUM";case _.HIGH:return"HIGH";default:return"UNKNOWN"}}a.videoQualityToJSON=T;var k;(function(A){A[A.POOR=0]="POOR",A[A.GOOD=1]="GOOD",A[A.EXCELLENT=2]="EXCELLENT",A[A.UNRECOGNIZED=-1]="UNRECOGNIZED"})(k=a.ConnectionQuality||(a.ConnectionQuality={}));function w(A){switch(A){case 0:case"POOR":return k.POOR;case 1:case"GOOD":return k.GOOD;case 2:case"EXCELLENT":return k.EXCELLENT;case-1:case"UNRECOGNIZED":default:return k.UNRECOGNIZED}}a.connectionQualityFromJSON=w;function P(A){switch(A){case k.POOR:return"POOR";case k.GOOD:return"GOOD";case k.EXCELLENT:return"EXCELLENT";default:return"UNKNOWN"}}a.connectionQualityToJSON=P;var $;(function(A){A[A.JOINING=0]="JOINING",A[A.JOINED=1]="JOINED",A[A.ACTIVE=2]="ACTIVE",A[A.DISCONNECTED=3]="DISCONNECTED",A[A.UNRECOGNIZED=-1]="UNRECOGNIZED"})($=a.ParticipantInfo_State||(a.ParticipantInfo_State={}));function U(A){switch(A){case 0:case"JOINING":return $.JOINING;case 1:case"JOINED":return $.JOINED;case 2:case"ACTIVE":return $.ACTIVE;case 3:case"DISCONNECTED":return $.DISCONNECTED;case-1:case"UNRECOGNIZED":default:return $.UNRECOGNIZED}}a.participantInfo_StateFromJSON=U;function E(A){switch(A){case $.JOINING:return"JOINING";case $.JOINED:return"JOINED";case $.ACTIVE:return"ACTIVE";case $.DISCONNECTED:return"DISCONNECTED";default:return"UNKNOWN"}}a.participantInfo_StateToJSON=E;var D;(function(A){A[A.RELIABLE=0]="RELIABLE",A[A.LOSSY=1]="LOSSY",A[A.UNRECOGNIZED=-1]="UNRECOGNIZED"})(D=a.DataPacket_Kind||(a.DataPacket_Kind={}));function F(A){switch(A){case 0:case"RELIABLE":return D.RELIABLE;case 1:case"LOSSY":return D.LOSSY;case-1:case"UNRECOGNIZED":default:return D.UNRECOGNIZED}}a.dataPacket_KindFromJSON=F;function J(A){switch(A){case D.RELIABLE:return"RELIABLE";case D.LOSSY:return"LOSSY";default:return"UNKNOWN"}}a.dataPacket_KindToJSON=J;const G={sid:"",name:"",emptyTimeout:0,maxParticipants:0,creationTime:0,turnPassword:"",metadata:"",numParticipants:0,activeRecording:!1};a.Room={encode(A,W=c.default.Writer.create()){A.sid!==""&&W.uint32(10).string(A.sid),A.name!==""&&W.uint32(18).string(A.name),A.emptyTimeout!==0&&W.uint32(24).uint32(A.emptyTimeout),A.maxParticipants!==0&&W.uint32(32).uint32(A.maxParticipants),A.creationTime!==0&&W.uint32(40).int64(A.creationTime),A.turnPassword!==""&&W.uint32(50).string(A.turnPassword);for(const ee of A.enabledCodecs)a.Codec.encode(ee,W.uint32(58).fork()).ldelim();return A.metadata!==""&&W.uint32(66).string(A.metadata),A.numParticipants!==0&&W.uint32(72).uint32(A.numParticipants),A.activeRecording===!0&&W.uint32(80).bool(A.activeRecording),W},decode(A,W){const ee=A instanceof c.default.Reader?A:new c.default.Reader(A);let ce=W===void 0?ee.len:ee.pos+W;const re=Object.assign({},G);for(re.enabledCodecs=[];ee.pos<ce;){const te=ee.uint32();switch(te>>>3){case 1:re.sid=ee.string();break;case 2:re.name=ee.string();break;case 3:re.emptyTimeout=ee.uint32();break;case 4:re.maxParticipants=ee.uint32();break;case 5:re.creationTime=ve(ee.int64());break;case 6:re.turnPassword=ee.string();break;case 7:re.enabledCodecs.push(a.Codec.decode(ee,ee.uint32()));break;case 8:re.metadata=ee.string();break;case 9:re.numParticipants=ee.uint32();break;case 10:re.activeRecording=ee.bool();break;default:ee.skipType(te&7);break}}return re},fromJSON(A){const W=Object.assign({},G);if(W.enabledCodecs=[],A.sid!==void 0&&A.sid!==null?W.sid=String(A.sid):W.sid="",A.name!==void 0&&A.name!==null?W.name=String(A.name):W.name="",A.emptyTimeout!==void 0&&A.emptyTimeout!==null?W.emptyTimeout=Number(A.emptyTimeout):W.emptyTimeout=0,A.maxParticipants!==void 0&&A.maxParticipants!==null?W.maxParticipants=Number(A.maxParticipants):W.maxParticipants=0,A.creationTime!==void 0&&A.creationTime!==null?W.creationTime=Number(A.creationTime):W.creationTime=0,A.turnPassword!==void 0&&A.turnPassword!==null?W.turnPassword=String(A.turnPassword):W.turnPassword="",A.enabledCodecs!==void 0&&A.enabledCodecs!==null)for(const ee of A.enabledCodecs)W.enabledCodecs.push(a.Codec.fromJSON(ee));return A.metadata!==void 0&&A.metadata!==null?W.metadata=String(A.metadata):W.metadata="",A.numParticipants!==void 0&&A.numParticipants!==null?W.numParticipants=Number(A.numParticipants):W.numParticipants=0,A.activeRecording!==void 0&&A.activeRecording!==null?W.activeRecording=Boolean(A.activeRecording):W.activeRecording=!1,W},toJSON(A){const W={};return A.sid!==void 0&&(W.sid=A.sid),A.name!==void 0&&(W.name=A.name),A.emptyTimeout!==void 0&&(W.emptyTimeout=A.emptyTimeout),A.maxParticipants!==void 0&&(W.maxParticipants=A.maxParticipants),A.creationTime!==void 0&&(W.creationTime=A.creationTime),A.turnPassword!==void 0&&(W.turnPassword=A.turnPassword),A.enabledCodecs?W.enabledCodecs=A.enabledCodecs.map(ee=>ee?a.Codec.toJSON(ee):void 0):W.enabledCodecs=[],A.metadata!==void 0&&(W.metadata=A.metadata),A.numParticipants!==void 0&&(W.numParticipants=A.numParticipants),A.activeRecording!==void 0&&(W.activeRecording=A.activeRecording),W},fromPartial(A){const W=Object.assign({},G);if(W.enabledCodecs=[],A.sid!==void 0&&A.sid!==null?W.sid=A.sid:W.sid="",A.name!==void 0&&A.name!==null?W.name=A.name:W.name="",A.emptyTimeout!==void 0&&A.emptyTimeout!==null?W.emptyTimeout=A.emptyTimeout:W.emptyTimeout=0,A.maxParticipants!==void 0&&A.maxParticipants!==null?W.maxParticipants=A.maxParticipants:W.maxParticipants=0,A.creationTime!==void 0&&A.creationTime!==null?W.creationTime=A.creationTime:W.creationTime=0,A.turnPassword!==void 0&&A.turnPassword!==null?W.turnPassword=A.turnPassword:W.turnPassword="",A.enabledCodecs!==void 0&&A.enabledCodecs!==null)for(const ee of A.enabledCodecs)W.enabledCodecs.push(a.Codec.fromPartial(ee));return A.metadata!==void 0&&A.metadata!==null?W.metadata=A.metadata:W.metadata="",A.numParticipants!==void 0&&A.numParticipants!==null?W.numParticipants=A.numParticipants:W.numParticipants=0,A.activeRecording!==void 0&&A.activeRecording!==null?W.activeRecording=A.activeRecording:W.activeRecording=!1,W}};const x={mime:"",fmtpLine:""};a.Codec={encode(A,W=c.default.Writer.create()){return A.mime!==""&&W.uint32(10).string(A.mime),A.fmtpLine!==""&&W.uint32(18).string(A.fmtpLine),W},decode(A,W){const ee=A instanceof c.default.Reader?A:new c.default.Reader(A);let ce=W===void 0?ee.len:ee.pos+W;const re=Object.assign({},x);for(;ee.pos<ce;){const te=ee.uint32();switch(te>>>3){case 1:re.mime=ee.string();break;case 2:re.fmtpLine=ee.string();break;default:ee.skipType(te&7);break}}return re},fromJSON(A){const W=Object.assign({},x);return A.mime!==void 0&&A.mime!==null?W.mime=String(A.mime):W.mime="",A.fmtpLine!==void 0&&A.fmtpLine!==null?W.fmtpLine=String(A.fmtpLine):W.fmtpLine="",W},toJSON(A){const W={};return A.mime!==void 0&&(W.mime=A.mime),A.fmtpLine!==void 0&&(W.fmtpLine=A.fmtpLine),W},fromPartial(A){const W=Object.assign({},x);return A.mime!==void 0&&A.mime!==null?W.mime=A.mime:W.mime="",A.fmtpLine!==void 0&&A.fmtpLine!==null?W.fmtpLine=A.fmtpLine:W.fmtpLine="",W}};const Y={sid:"",identity:"",state:0,metadata:"",joinedAt:0,hidden:!1,recorder:!1,name:""};a.ParticipantInfo={encode(A,W=c.default.Writer.create()){A.sid!==""&&W.uint32(10).string(A.sid),A.identity!==""&&W.uint32(18).string(A.identity),A.state!==0&&W.uint32(24).int32(A.state);for(const ee of A.tracks)a.TrackInfo.encode(ee,W.uint32(34).fork()).ldelim();return A.metadata!==""&&W.uint32(42).string(A.metadata),A.joinedAt!==0&&W.uint32(48).int64(A.joinedAt),A.hidden===!0&&W.uint32(56).bool(A.hidden),A.recorder===!0&&W.uint32(64).bool(A.recorder),A.name!==""&&W.uint32(74).string(A.name),W},decode(A,W){const ee=A instanceof c.default.Reader?A:new c.default.Reader(A);let ce=W===void 0?ee.len:ee.pos+W;const re=Object.assign({},Y);for(re.tracks=[];ee.pos<ce;){const te=ee.uint32();switch(te>>>3){case 1:re.sid=ee.string();break;case 2:re.identity=ee.string();break;case 3:re.state=ee.int32();break;case 4:re.tracks.push(a.TrackInfo.decode(ee,ee.uint32()));break;case 5:re.metadata=ee.string();break;case 6:re.joinedAt=ve(ee.int64());break;case 7:re.hidden=ee.bool();break;case 8:re.recorder=ee.bool();break;case 9:re.name=ee.string();break;default:ee.skipType(te&7);break}}return re},fromJSON(A){const W=Object.assign({},Y);if(W.tracks=[],A.sid!==void 0&&A.sid!==null?W.sid=String(A.sid):W.sid="",A.identity!==void 0&&A.identity!==null?W.identity=String(A.identity):W.identity="",A.state!==void 0&&A.state!==null?W.state=U(A.state):W.state=0,A.tracks!==void 0&&A.tracks!==null)for(const ee of A.tracks)W.tracks.push(a.TrackInfo.fromJSON(ee));return A.metadata!==void 0&&A.metadata!==null?W.metadata=String(A.metadata):W.metadata="",A.joinedAt!==void 0&&A.joinedAt!==null?W.joinedAt=Number(A.joinedAt):W.joinedAt=0,A.hidden!==void 0&&A.hidden!==null?W.hidden=Boolean(A.hidden):W.hidden=!1,A.recorder!==void 0&&A.recorder!==null?W.recorder=Boolean(A.recorder):W.recorder=!1,A.name!==void 0&&A.name!==null?W.name=String(A.name):W.name="",W},toJSON(A){const W={};return A.sid!==void 0&&(W.sid=A.sid),A.identity!==void 0&&(W.identity=A.identity),A.state!==void 0&&(W.state=E(A.state)),A.tracks?W.tracks=A.tracks.map(ee=>ee?a.TrackInfo.toJSON(ee):void 0):W.tracks=[],A.metadata!==void 0&&(W.metadata=A.metadata),A.joinedAt!==void 0&&(W.joinedAt=A.joinedAt),A.hidden!==void 0&&(W.hidden=A.hidden),A.recorder!==void 0&&(W.recorder=A.recorder),A.name!==void 0&&(W.name=A.name),W},fromPartial(A){const W=Object.assign({},Y);if(W.tracks=[],A.sid!==void 0&&A.sid!==null?W.sid=A.sid:W.sid="",A.identity!==void 0&&A.identity!==null?W.identity=A.identity:W.identity="",A.state!==void 0&&A.state!==null?W.state=A.state:W.state=0,A.tracks!==void 0&&A.tracks!==null)for(const ee of A.tracks)W.tracks.push(a.TrackInfo.fromPartial(ee));return A.metadata!==void 0&&A.metadata!==null?W.metadata=A.metadata:W.metadata="",A.joinedAt!==void 0&&A.joinedAt!==null?W.joinedAt=A.joinedAt:W.joinedAt=0,A.hidden!==void 0&&A.hidden!==null?W.hidden=A.hidden:W.hidden=!1,A.recorder!==void 0&&A.recorder!==null?W.recorder=A.recorder:W.recorder=!1,A.name!==void 0&&A.name!==null?W.name=A.name:W.name="",W}};const N={sid:"",type:0,name:"",muted:!1,width:0,height:0,simulcast:!1,disableDtx:!1,source:0,mimeType:""};a.TrackInfo={encode(A,W=c.default.Writer.create()){A.sid!==""&&W.uint32(10).string(A.sid),A.type!==0&&W.uint32(16).int32(A.type),A.name!==""&&W.uint32(26).string(A.name),A.muted===!0&&W.uint32(32).bool(A.muted),A.width!==0&&W.uint32(40).uint32(A.width),A.height!==0&&W.uint32(48).uint32(A.height),A.simulcast===!0&&W.uint32(56).bool(A.simulcast),A.disableDtx===!0&&W.uint32(64).bool(A.disableDtx),A.source!==0&&W.uint32(72).int32(A.source);for(const ee of A.layers)a.VideoLayer.encode(ee,W.uint32(82).fork()).ldelim();return A.mimeType!==""&&W.uint32(90).string(A.mimeType),W},decode(A,W){const ee=A instanceof c.default.Reader?A:new c.default.Reader(A);let ce=W===void 0?ee.len:ee.pos+W;const re=Object.assign({},N);for(re.layers=[];ee.pos<ce;){const te=ee.uint32();switch(te>>>3){case 1:re.sid=ee.string();break;case 2:re.type=ee.int32();break;case 3:re.name=ee.string();break;case 4:re.muted=ee.bool();break;case 5:re.width=ee.uint32();break;case 6:re.height=ee.uint32();break;case 7:re.simulcast=ee.bool();break;case 8:re.disableDtx=ee.bool();break;case 9:re.source=ee.int32();break;case 10:re.layers.push(a.VideoLayer.decode(ee,ee.uint32()));break;case 11:re.mimeType=ee.string();break;default:ee.skipType(te&7);break}}return re},fromJSON(A){const W=Object.assign({},N);if(W.layers=[],A.sid!==void 0&&A.sid!==null?W.sid=String(A.sid):W.sid="",A.type!==void 0&&A.type!==null?W.type=p(A.type):W.type=0,A.name!==void 0&&A.name!==null?W.name=String(A.name):W.name="",A.muted!==void 0&&A.muted!==null?W.muted=Boolean(A.muted):W.muted=!1,A.width!==void 0&&A.width!==null?W.width=Number(A.width):W.width=0,A.height!==void 0&&A.height!==null?W.height=Number(A.height):W.height=0,A.simulcast!==void 0&&A.simulcast!==null?W.simulcast=Boolean(A.simulcast):W.simulcast=!1,A.disableDtx!==void 0&&A.disableDtx!==null?W.disableDtx=Boolean(A.disableDtx):W.disableDtx=!1,A.source!==void 0&&A.source!==null?W.source=S(A.source):W.source=0,A.layers!==void 0&&A.layers!==null)for(const ee of A.layers)W.layers.push(a.VideoLayer.fromJSON(ee));return A.mimeType!==void 0&&A.mimeType!==null?W.mimeType=String(A.mimeType):W.mimeType="",W},toJSON(A){const W={};return A.sid!==void 0&&(W.sid=A.sid),A.type!==void 0&&(W.type=h(A.type)),A.name!==void 0&&(W.name=A.name),A.muted!==void 0&&(W.muted=A.muted),A.width!==void 0&&(W.width=A.width),A.height!==void 0&&(W.height=A.height),A.simulcast!==void 0&&(W.simulcast=A.simulcast),A.disableDtx!==void 0&&(W.disableDtx=A.disableDtx),A.source!==void 0&&(W.source=b(A.source)),A.layers?W.layers=A.layers.map(ee=>ee?a.VideoLayer.toJSON(ee):void 0):W.layers=[],A.mimeType!==void 0&&(W.mimeType=A.mimeType),W},fromPartial(A){const W=Object.assign({},N);if(W.layers=[],A.sid!==void 0&&A.sid!==null?W.sid=A.sid:W.sid="",A.type!==void 0&&A.type!==null?W.type=A.type:W.type=0,A.name!==void 0&&A.name!==null?W.name=A.name:W.name="",A.muted!==void 0&&A.muted!==null?W.muted=A.muted:W.muted=!1,A.width!==void 0&&A.width!==null?W.width=A.width:W.width=0,A.height!==void 0&&A.height!==null?W.height=A.height:W.height=0,A.simulcast!==void 0&&A.simulcast!==null?W.simulcast=A.simulcast:W.simulcast=!1,A.disableDtx!==void 0&&A.disableDtx!==null?W.disableDtx=A.disableDtx:W.disableDtx=!1,A.source!==void 0&&A.source!==null?W.source=A.source:W.source=0,A.layers!==void 0&&A.layers!==null)for(const ee of A.layers)W.layers.push(a.VideoLayer.fromPartial(ee));return A.mimeType!==void 0&&A.mimeType!==null?W.mimeType=A.mimeType:W.mimeType="",W}};const z={quality:0,width:0,height:0,bitrate:0};a.VideoLayer={encode(A,W=c.default.Writer.create()){return A.quality!==0&&W.uint32(8).int32(A.quality),A.width!==0&&W.uint32(16).uint32(A.width),A.height!==0&&W.uint32(24).uint32(A.height),A.bitrate!==0&&W.uint32(32).uint32(A.bitrate),W},decode(A,W){const ee=A instanceof c.default.Reader?A:new c.default.Reader(A);let ce=W===void 0?ee.len:ee.pos+W;const re=Object.assign({},z);for(;ee.pos<ce;){const te=ee.uint32();switch(te>>>3){case 1:re.quality=ee.int32();break;case 2:re.width=ee.uint32();break;case 3:re.height=ee.uint32();break;case 4:re.bitrate=ee.uint32();break;default:ee.skipType(te&7);break}}return re},fromJSON(A){const W=Object.assign({},z);return A.quality!==void 0&&A.quality!==null?W.quality=I(A.quality):W.quality=0,A.width!==void 0&&A.width!==null?W.width=Number(A.width):W.width=0,A.height!==void 0&&A.height!==null?W.height=Number(A.height):W.height=0,A.bitrate!==void 0&&A.bitrate!==null?W.bitrate=Number(A.bitrate):W.bitrate=0,W},toJSON(A){const W={};return A.quality!==void 0&&(W.quality=T(A.quality)),A.width!==void 0&&(W.width=A.width),A.height!==void 0&&(W.height=A.height),A.bitrate!==void 0&&(W.bitrate=A.bitrate),W},fromPartial(A){const W=Object.assign({},z);return A.quality!==void 0&&A.quality!==null?W.quality=A.quality:W.quality=0,A.width!==void 0&&A.width!==null?W.width=A.width:W.width=0,A.height!==void 0&&A.height!==null?W.height=A.height:W.height=0,A.bitrate!==void 0&&A.bitrate!==null?W.bitrate=A.bitrate:W.bitrate=0,W}};const Z={kind:0};a.DataPacket={encode(A,W=c.default.Writer.create()){return A.kind!==0&&W.uint32(8).int32(A.kind),A.user!==void 0&&a.UserPacket.encode(A.user,W.uint32(18).fork()).ldelim(),A.speaker!==void 0&&a.ActiveSpeakerUpdate.encode(A.speaker,W.uint32(26).fork()).ldelim(),W},decode(A,W){const ee=A instanceof c.default.Reader?A:new c.default.Reader(A);let ce=W===void 0?ee.len:ee.pos+W;const re=Object.assign({},Z);for(;ee.pos<ce;){const te=ee.uint32();switch(te>>>3){case 1:re.kind=ee.int32();break;case 2:re.user=a.UserPacket.decode(ee,ee.uint32());break;case 3:re.speaker=a.ActiveSpeakerUpdate.decode(ee,ee.uint32());break;default:ee.skipType(te&7);break}}return re},fromJSON(A){const W=Object.assign({},Z);return A.kind!==void 0&&A.kind!==null?W.kind=F(A.kind):W.kind=0,A.user!==void 0&&A.user!==null?W.user=a.UserPacket.fromJSON(A.user):W.user=void 0,A.speaker!==void 0&&A.speaker!==null?W.speaker=a.ActiveSpeakerUpdate.fromJSON(A.speaker):W.speaker=void 0,W},toJSON(A){const W={};return A.kind!==void 0&&(W.kind=J(A.kind)),A.user!==void 0&&(W.user=A.user?a.UserPacket.toJSON(A.user):void 0),A.speaker!==void 0&&(W.speaker=A.speaker?a.ActiveSpeakerUpdate.toJSON(A.speaker):void 0),W},fromPartial(A){const W=Object.assign({},Z);return A.kind!==void 0&&A.kind!==null?W.kind=A.kind:W.kind=0,A.user!==void 0&&A.user!==null?W.user=a.UserPacket.fromPartial(A.user):W.user=void 0,A.speaker!==void 0&&A.speaker!==null?W.speaker=a.ActiveSpeakerUpdate.fromPartial(A.speaker):W.speaker=void 0,W}};const L={};a.ActiveSpeakerUpdate={encode(A,W=c.default.Writer.create()){for(const ee of A.speakers)a.SpeakerInfo.encode(ee,W.uint32(10).fork()).ldelim();return W},decode(A,W){const ee=A instanceof c.default.Reader?A:new c.default.Reader(A);let ce=W===void 0?ee.len:ee.pos+W;const re=Object.assign({},L);for(re.speakers=[];ee.pos<ce;){const te=ee.uint32();switch(te>>>3){case 1:re.speakers.push(a.SpeakerInfo.decode(ee,ee.uint32()));break;default:ee.skipType(te&7);break}}return re},fromJSON(A){const W=Object.assign({},L);if(W.speakers=[],A.speakers!==void 0&&A.speakers!==null)for(const ee of A.speakers)W.speakers.push(a.SpeakerInfo.fromJSON(ee));return W},toJSON(A){const W={};return A.speakers?W.speakers=A.speakers.map(ee=>ee?a.SpeakerInfo.toJSON(ee):void 0):W.speakers=[],W},fromPartial(A){const W=Object.assign({},L);if(W.speakers=[],A.speakers!==void 0&&A.speakers!==null)for(const ee of A.speakers)W.speakers.push(a.SpeakerInfo.fromPartial(ee));return W}};const V={sid:"",level:0,active:!1};a.SpeakerInfo={encode(A,W=c.default.Writer.create()){return A.sid!==""&&W.uint32(10).string(A.sid),A.level!==0&&W.uint32(21).float(A.level),A.active===!0&&W.uint32(24).bool(A.active),W},decode(A,W){const ee=A instanceof c.default.Reader?A:new c.default.Reader(A);let ce=W===void 0?ee.len:ee.pos+W;const re=Object.assign({},V);for(;ee.pos<ce;){const te=ee.uint32();switch(te>>>3){case 1:re.sid=ee.string();break;case 2:re.level=ee.float();break;case 3:re.active=ee.bool();break;default:ee.skipType(te&7);break}}return re},fromJSON(A){const W=Object.assign({},V);return A.sid!==void 0&&A.sid!==null?W.sid=String(A.sid):W.sid="",A.level!==void 0&&A.level!==null?W.level=Number(A.level):W.level=0,A.active!==void 0&&A.active!==null?W.active=Boolean(A.active):W.active=!1,W},toJSON(A){const W={};return A.sid!==void 0&&(W.sid=A.sid),A.level!==void 0&&(W.level=A.level),A.active!==void 0&&(W.active=A.active),W},fromPartial(A){const W=Object.assign({},V);return A.sid!==void 0&&A.sid!==null?W.sid=A.sid:W.sid="",A.level!==void 0&&A.level!==null?W.level=A.level:W.level=0,A.active!==void 0&&A.active!==null?W.active=A.active:W.active=!1,W}};const H={participantSid:"",destinationSids:""};a.UserPacket={encode(A,W=c.default.Writer.create()){A.participantSid!==""&&W.uint32(10).string(A.participantSid),A.payload.length!==0&&W.uint32(18).bytes(A.payload);for(const ee of A.destinationSids)W.uint32(26).string(ee);return W},decode(A,W){const ee=A instanceof c.default.Reader?A:new c.default.Reader(A);let ce=W===void 0?ee.len:ee.pos+W;const re=Object.assign({},H);for(re.destinationSids=[],re.payload=new Uint8Array;ee.pos<ce;){const te=ee.uint32();switch(te>>>3){case 1:re.participantSid=ee.string();break;case 2:re.payload=ee.bytes();break;case 3:re.destinationSids.push(ee.string());break;default:ee.skipType(te&7);break}}return re},fromJSON(A){const W=Object.assign({},H);if(W.destinationSids=[],W.payload=new Uint8Array,A.participantSid!==void 0&&A.participantSid!==null?W.participantSid=String(A.participantSid):W.participantSid="",A.payload!==void 0&&A.payload!==null&&(W.payload=oe(A.payload)),A.destinationSids!==void 0&&A.destinationSids!==null)for(const ee of A.destinationSids)W.destinationSids.push(String(ee));return W},toJSON(A){const W={};return A.participantSid!==void 0&&(W.participantSid=A.participantSid),A.payload!==void 0&&(W.payload=me(A.payload!==void 0?A.payload:new Uint8Array)),A.destinationSids?W.destinationSids=A.destinationSids.map(ee=>ee):W.destinationSids=[],W},fromPartial(A){const W=Object.assign({},H);if(W.destinationSids=[],A.participantSid!==void 0&&A.participantSid!==null?W.participantSid=A.participantSid:W.participantSid="",A.payload!==void 0&&A.payload!==null?W.payload=A.payload:W.payload=new Uint8Array,A.destinationSids!==void 0&&A.destinationSids!==null)for(const ee of A.destinationSids)W.destinationSids.push(ee);return W}};const de={participantSid:"",trackSids:""};a.ParticipantTracks={encode(A,W=c.default.Writer.create()){A.participantSid!==""&&W.uint32(10).string(A.participantSid);for(const ee of A.trackSids)W.uint32(18).string(ee);return W},decode(A,W){const ee=A instanceof c.default.Reader?A:new c.default.Reader(A);let ce=W===void 0?ee.len:ee.pos+W;const re=Object.assign({},de);for(re.trackSids=[];ee.pos<ce;){const te=ee.uint32();switch(te>>>3){case 1:re.participantSid=ee.string();break;case 2:re.trackSids.push(ee.string());break;default:ee.skipType(te&7);break}}return re},fromJSON(A){const W=Object.assign({},de);if(W.trackSids=[],A.participantSid!==void 0&&A.participantSid!==null?W.participantSid=String(A.participantSid):W.participantSid="",A.trackSids!==void 0&&A.trackSids!==null)for(const ee of A.trackSids)W.trackSids.push(String(ee));return W},toJSON(A){const W={};return A.participantSid!==void 0&&(W.participantSid=A.participantSid),A.trackSids?W.trackSids=A.trackSids.map(ee=>ee):W.trackSids=[],W},fromPartial(A){const W=Object.assign({},de);if(W.trackSids=[],A.participantSid!==void 0&&A.participantSid!==null?W.participantSid=A.participantSid:W.participantSid="",A.trackSids!==void 0&&A.trackSids!==null)for(const ee of A.trackSids)W.trackSids.push(ee);return W}};var X=(()=>{if(typeof X!="undefined")return X;if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof commonjsGlobal$1!="undefined")return commonjsGlobal$1;throw"Unable to locate global object"})();const K=X.atob||(A=>X.Buffer.from(A,"base64").toString("binary"));function oe(A){const W=K(A),ee=new Uint8Array(W.length);for(let ce=0;ce<W.length;++ce)ee[ce]=W.charCodeAt(ce);return ee}const pe=X.btoa||(A=>X.Buffer.from(A,"binary").toString("base64"));function me(A){const W=[];for(const ee of A)W.push(String.fromCharCode(ee));return pe(W.join(""))}function ve(A){if(A.gt(Number.MAX_SAFE_INTEGER))throw new X.Error("Value is larger than Number.MAX_SAFE_INTEGER");return A.toNumber()}c.default.util.Long!==d.default&&(c.default.util.Long=d.default,c.default.configure())})(livekit_models);var RoomServiceClient$1={},livekit_room={};(function(a){var s=commonjsGlobal$1&&commonjsGlobal$1.__importDefault||function(L){return L&&L.__esModule?L:{default:L}};Object.defineProperty(a,"__esModule",{value:!0}),a.UpdateRoomMetadataRequest=a.SendDataResponse=a.SendDataRequest=a.UpdateSubscriptionsResponse=a.UpdateSubscriptionsRequest=a.UpdateParticipantRequest=a.ParticipantPermission=a.MuteRoomTrackResponse=a.MuteRoomTrackRequest=a.RemoveParticipantResponse=a.RoomParticipantIdentity=a.ListParticipantsResponse=a.ListParticipantsRequest=a.DeleteRoomResponse=a.DeleteRoomRequest=a.ListRoomsResponse=a.ListRoomsRequest=a.CreateRoomRequest=a.protobufPackage=void 0;const d=s(umd.exports),c=s(minimal$2),l=livekit_models;a.protobufPackage="livekit";const p={name:"",emptyTimeout:0,maxParticipants:0,nodeId:"",metadata:""};a.CreateRoomRequest={encode(L,V=c.default.Writer.create()){return L.name!==""&&V.uint32(10).string(L.name),L.emptyTimeout!==0&&V.uint32(16).uint32(L.emptyTimeout),L.maxParticipants!==0&&V.uint32(24).uint32(L.maxParticipants),L.nodeId!==""&&V.uint32(34).string(L.nodeId),L.metadata!==""&&V.uint32(42).string(L.metadata),V},decode(L,V){const H=L instanceof c.default.Reader?L:new c.default.Reader(L);let de=V===void 0?H.len:H.pos+V;const X=Object.assign({},p);for(;H.pos<de;){const K=H.uint32();switch(K>>>3){case 1:X.name=H.string();break;case 2:X.emptyTimeout=H.uint32();break;case 3:X.maxParticipants=H.uint32();break;case 4:X.nodeId=H.string();break;case 5:X.metadata=H.string();break;default:H.skipType(K&7);break}}return X},fromJSON(L){const V=Object.assign({},p);return L.name!==void 0&&L.name!==null?V.name=String(L.name):V.name="",L.emptyTimeout!==void 0&&L.emptyTimeout!==null?V.emptyTimeout=Number(L.emptyTimeout):V.emptyTimeout=0,L.maxParticipants!==void 0&&L.maxParticipants!==null?V.maxParticipants=Number(L.maxParticipants):V.maxParticipants=0,L.nodeId!==void 0&&L.nodeId!==null?V.nodeId=String(L.nodeId):V.nodeId="",L.metadata!==void 0&&L.metadata!==null?V.metadata=String(L.metadata):V.metadata="",V},toJSON(L){const V={};return L.name!==void 0&&(V.name=L.name),L.emptyTimeout!==void 0&&(V.emptyTimeout=L.emptyTimeout),L.maxParticipants!==void 0&&(V.maxParticipants=L.maxParticipants),L.nodeId!==void 0&&(V.nodeId=L.nodeId),L.metadata!==void 0&&(V.metadata=L.metadata),V},fromPartial(L){const V=Object.assign({},p);return L.name!==void 0&&L.name!==null?V.name=L.name:V.name="",L.emptyTimeout!==void 0&&L.emptyTimeout!==null?V.emptyTimeout=L.emptyTimeout:V.emptyTimeout=0,L.maxParticipants!==void 0&&L.maxParticipants!==null?V.maxParticipants=L.maxParticipants:V.maxParticipants=0,L.nodeId!==void 0&&L.nodeId!==null?V.nodeId=L.nodeId:V.nodeId="",L.metadata!==void 0&&L.metadata!==null?V.metadata=L.metadata:V.metadata="",V}};const h={names:""};a.ListRoomsRequest={encode(L,V=c.default.Writer.create()){for(const H of L.names)V.uint32(10).string(H);return V},decode(L,V){const H=L instanceof c.default.Reader?L:new c.default.Reader(L);let de=V===void 0?H.len:H.pos+V;const X=Object.assign({},h);for(X.names=[];H.pos<de;){const K=H.uint32();switch(K>>>3){case 1:X.names.push(H.string());break;default:H.skipType(K&7);break}}return X},fromJSON(L){const V=Object.assign({},h);if(V.names=[],L.names!==void 0&&L.names!==null)for(const H of L.names)V.names.push(String(H));return V},toJSON(L){const V={};return L.names?V.names=L.names.map(H=>H):V.names=[],V},fromPartial(L){const V=Object.assign({},h);if(V.names=[],L.names!==void 0&&L.names!==null)for(const H of L.names)V.names.push(H);return V}};const v={};a.ListRoomsResponse={encode(L,V=c.default.Writer.create()){for(const H of L.rooms)l.Room.encode(H,V.uint32(10).fork()).ldelim();return V},decode(L,V){const H=L instanceof c.default.Reader?L:new c.default.Reader(L);let de=V===void 0?H.len:H.pos+V;const X=Object.assign({},v);for(X.rooms=[];H.pos<de;){const K=H.uint32();switch(K>>>3){case 1:X.rooms.push(l.Room.decode(H,H.uint32()));break;default:H.skipType(K&7);break}}return X},fromJSON(L){const V=Object.assign({},v);if(V.rooms=[],L.rooms!==void 0&&L.rooms!==null)for(const H of L.rooms)V.rooms.push(l.Room.fromJSON(H));return V},toJSON(L){const V={};return L.rooms?V.rooms=L.rooms.map(H=>H?l.Room.toJSON(H):void 0):V.rooms=[],V},fromPartial(L){const V=Object.assign({},v);if(V.rooms=[],L.rooms!==void 0&&L.rooms!==null)for(const H of L.rooms)V.rooms.push(l.Room.fromPartial(H));return V}};const S={room:""};a.DeleteRoomRequest={encode(L,V=c.default.Writer.create()){return L.room!==""&&V.uint32(10).string(L.room),V},decode(L,V){const H=L instanceof c.default.Reader?L:new c.default.Reader(L);let de=V===void 0?H.len:H.pos+V;const X=Object.assign({},S);for(;H.pos<de;){const K=H.uint32();switch(K>>>3){case 1:X.room=H.string();break;default:H.skipType(K&7);break}}return X},fromJSON(L){const V=Object.assign({},S);return L.room!==void 0&&L.room!==null?V.room=String(L.room):V.room="",V},toJSON(L){const V={};return L.room!==void 0&&(V.room=L.room),V},fromPartial(L){const V=Object.assign({},S);return L.room!==void 0&&L.room!==null?V.room=L.room:V.room="",V}};const b={};a.DeleteRoomResponse={encode(L,V=c.default.Writer.create()){return V},decode(L,V){const H=L instanceof c.default.Reader?L:new c.default.Reader(L);let de=V===void 0?H.len:H.pos+V;const X=Object.assign({},b);for(;H.pos<de;){const K=H.uint32();switch(K>>>3){default:H.skipType(K&7);break}}return X},fromJSON(L){return Object.assign({},b)},toJSON(L){return{}},fromPartial(L){return Object.assign({},b)}};const _={room:""};a.ListParticipantsRequest={encode(L,V=c.default.Writer.create()){return L.room!==""&&V.uint32(10).string(L.room),V},decode(L,V){const H=L instanceof c.default.Reader?L:new c.default.Reader(L);let de=V===void 0?H.len:H.pos+V;const X=Object.assign({},_);for(;H.pos<de;){const K=H.uint32();switch(K>>>3){case 1:X.room=H.string();break;default:H.skipType(K&7);break}}return X},fromJSON(L){const V=Object.assign({},_);return L.room!==void 0&&L.room!==null?V.room=String(L.room):V.room="",V},toJSON(L){const V={};return L.room!==void 0&&(V.room=L.room),V},fromPartial(L){const V=Object.assign({},_);return L.room!==void 0&&L.room!==null?V.room=L.room:V.room="",V}};const I={};a.ListParticipantsResponse={encode(L,V=c.default.Writer.create()){for(const H of L.participants)l.ParticipantInfo.encode(H,V.uint32(10).fork()).ldelim();return V},decode(L,V){const H=L instanceof c.default.Reader?L:new c.default.Reader(L);let de=V===void 0?H.len:H.pos+V;const X=Object.assign({},I);for(X.participants=[];H.pos<de;){const K=H.uint32();switch(K>>>3){case 1:X.participants.push(l.ParticipantInfo.decode(H,H.uint32()));break;default:H.skipType(K&7);break}}return X},fromJSON(L){const V=Object.assign({},I);if(V.participants=[],L.participants!==void 0&&L.participants!==null)for(const H of L.participants)V.participants.push(l.ParticipantInfo.fromJSON(H));return V},toJSON(L){const V={};return L.participants?V.participants=L.participants.map(H=>H?l.ParticipantInfo.toJSON(H):void 0):V.participants=[],V},fromPartial(L){const V=Object.assign({},I);if(V.participants=[],L.participants!==void 0&&L.participants!==null)for(const H of L.participants)V.participants.push(l.ParticipantInfo.fromPartial(H));return V}};const T={room:"",identity:""};a.RoomParticipantIdentity={encode(L,V=c.default.Writer.create()){return L.room!==""&&V.uint32(10).string(L.room),L.identity!==""&&V.uint32(18).string(L.identity),V},decode(L,V){const H=L instanceof c.default.Reader?L:new c.default.Reader(L);let de=V===void 0?H.len:H.pos+V;const X=Object.assign({},T);for(;H.pos<de;){const K=H.uint32();switch(K>>>3){case 1:X.room=H.string();break;case 2:X.identity=H.string();break;default:H.skipType(K&7);break}}return X},fromJSON(L){const V=Object.assign({},T);return L.room!==void 0&&L.room!==null?V.room=String(L.room):V.room="",L.identity!==void 0&&L.identity!==null?V.identity=String(L.identity):V.identity="",V},toJSON(L){const V={};return L.room!==void 0&&(V.room=L.room),L.identity!==void 0&&(V.identity=L.identity),V},fromPartial(L){const V=Object.assign({},T);return L.room!==void 0&&L.room!==null?V.room=L.room:V.room="",L.identity!==void 0&&L.identity!==null?V.identity=L.identity:V.identity="",V}};const k={};a.RemoveParticipantResponse={encode(L,V=c.default.Writer.create()){return V},decode(L,V){const H=L instanceof c.default.Reader?L:new c.default.Reader(L);let de=V===void 0?H.len:H.pos+V;const X=Object.assign({},k);for(;H.pos<de;){const K=H.uint32();switch(K>>>3){default:H.skipType(K&7);break}}return X},fromJSON(L){return Object.assign({},k)},toJSON(L){return{}},fromPartial(L){return Object.assign({},k)}};const w={room:"",identity:"",trackSid:"",muted:!1};a.MuteRoomTrackRequest={encode(L,V=c.default.Writer.create()){return L.room!==""&&V.uint32(10).string(L.room),L.identity!==""&&V.uint32(18).string(L.identity),L.trackSid!==""&&V.uint32(26).string(L.trackSid),L.muted===!0&&V.uint32(32).bool(L.muted),V},decode(L,V){const H=L instanceof c.default.Reader?L:new c.default.Reader(L);let de=V===void 0?H.len:H.pos+V;const X=Object.assign({},w);for(;H.pos<de;){const K=H.uint32();switch(K>>>3){case 1:X.room=H.string();break;case 2:X.identity=H.string();break;case 3:X.trackSid=H.string();break;case 4:X.muted=H.bool();break;default:H.skipType(K&7);break}}return X},fromJSON(L){const V=Object.assign({},w);return L.room!==void 0&&L.room!==null?V.room=String(L.room):V.room="",L.identity!==void 0&&L.identity!==null?V.identity=String(L.identity):V.identity="",L.trackSid!==void 0&&L.trackSid!==null?V.trackSid=String(L.trackSid):V.trackSid="",L.muted!==void 0&&L.muted!==null?V.muted=Boolean(L.muted):V.muted=!1,V},toJSON(L){const V={};return L.room!==void 0&&(V.room=L.room),L.identity!==void 0&&(V.identity=L.identity),L.trackSid!==void 0&&(V.trackSid=L.trackSid),L.muted!==void 0&&(V.muted=L.muted),V},fromPartial(L){const V=Object.assign({},w);return L.room!==void 0&&L.room!==null?V.room=L.room:V.room="",L.identity!==void 0&&L.identity!==null?V.identity=L.identity:V.identity="",L.trackSid!==void 0&&L.trackSid!==null?V.trackSid=L.trackSid:V.trackSid="",L.muted!==void 0&&L.muted!==null?V.muted=L.muted:V.muted=!1,V}};const P={};a.MuteRoomTrackResponse={encode(L,V=c.default.Writer.create()){return L.track!==void 0&&l.TrackInfo.encode(L.track,V.uint32(10).fork()).ldelim(),V},decode(L,V){const H=L instanceof c.default.Reader?L:new c.default.Reader(L);let de=V===void 0?H.len:H.pos+V;const X=Object.assign({},P);for(;H.pos<de;){const K=H.uint32();switch(K>>>3){case 1:X.track=l.TrackInfo.decode(H,H.uint32());break;default:H.skipType(K&7);break}}return X},fromJSON(L){const V=Object.assign({},P);return L.track!==void 0&&L.track!==null?V.track=l.TrackInfo.fromJSON(L.track):V.track=void 0,V},toJSON(L){const V={};return L.track!==void 0&&(V.track=L.track?l.TrackInfo.toJSON(L.track):void 0),V},fromPartial(L){const V=Object.assign({},P);return L.track!==void 0&&L.track!==null?V.track=l.TrackInfo.fromPartial(L.track):V.track=void 0,V}};const $={canSubscribe:!1,canPublish:!1,canPublishData:!1};a.ParticipantPermission={encode(L,V=c.default.Writer.create()){return L.canSubscribe===!0&&V.uint32(8).bool(L.canSubscribe),L.canPublish===!0&&V.uint32(16).bool(L.canPublish),L.canPublishData===!0&&V.uint32(24).bool(L.canPublishData),V},decode(L,V){const H=L instanceof c.default.Reader?L:new c.default.Reader(L);let de=V===void 0?H.len:H.pos+V;const X=Object.assign({},$);for(;H.pos<de;){const K=H.uint32();switch(K>>>3){case 1:X.canSubscribe=H.bool();break;case 2:X.canPublish=H.bool();break;case 3:X.canPublishData=H.bool();break;default:H.skipType(K&7);break}}return X},fromJSON(L){const V=Object.assign({},$);return L.canSubscribe!==void 0&&L.canSubscribe!==null?V.canSubscribe=Boolean(L.canSubscribe):V.canSubscribe=!1,L.canPublish!==void 0&&L.canPublish!==null?V.canPublish=Boolean(L.canPublish):V.canPublish=!1,L.canPublishData!==void 0&&L.canPublishData!==null?V.canPublishData=Boolean(L.canPublishData):V.canPublishData=!1,V},toJSON(L){const V={};return L.canSubscribe!==void 0&&(V.canSubscribe=L.canSubscribe),L.canPublish!==void 0&&(V.canPublish=L.canPublish),L.canPublishData!==void 0&&(V.canPublishData=L.canPublishData),V},fromPartial(L){const V=Object.assign({},$);return L.canSubscribe!==void 0&&L.canSubscribe!==null?V.canSubscribe=L.canSubscribe:V.canSubscribe=!1,L.canPublish!==void 0&&L.canPublish!==null?V.canPublish=L.canPublish:V.canPublish=!1,L.canPublishData!==void 0&&L.canPublishData!==null?V.canPublishData=L.canPublishData:V.canPublishData=!1,V}};const U={room:"",identity:"",metadata:""};a.UpdateParticipantRequest={encode(L,V=c.default.Writer.create()){return L.room!==""&&V.uint32(10).string(L.room),L.identity!==""&&V.uint32(18).string(L.identity),L.metadata!==""&&V.uint32(26).string(L.metadata),L.permission!==void 0&&a.ParticipantPermission.encode(L.permission,V.uint32(34).fork()).ldelim(),V},decode(L,V){const H=L instanceof c.default.Reader?L:new c.default.Reader(L);let de=V===void 0?H.len:H.pos+V;const X=Object.assign({},U);for(;H.pos<de;){const K=H.uint32();switch(K>>>3){case 1:X.room=H.string();break;case 2:X.identity=H.string();break;case 3:X.metadata=H.string();break;case 4:X.permission=a.ParticipantPermission.decode(H,H.uint32());break;default:H.skipType(K&7);break}}return X},fromJSON(L){const V=Object.assign({},U);return L.room!==void 0&&L.room!==null?V.room=String(L.room):V.room="",L.identity!==void 0&&L.identity!==null?V.identity=String(L.identity):V.identity="",L.metadata!==void 0&&L.metadata!==null?V.metadata=String(L.metadata):V.metadata="",L.permission!==void 0&&L.permission!==null?V.permission=a.ParticipantPermission.fromJSON(L.permission):V.permission=void 0,V},toJSON(L){const V={};return L.room!==void 0&&(V.room=L.room),L.identity!==void 0&&(V.identity=L.identity),L.metadata!==void 0&&(V.metadata=L.metadata),L.permission!==void 0&&(V.permission=L.permission?a.ParticipantPermission.toJSON(L.permission):void 0),V},fromPartial(L){const V=Object.assign({},U);return L.room!==void 0&&L.room!==null?V.room=L.room:V.room="",L.identity!==void 0&&L.identity!==null?V.identity=L.identity:V.identity="",L.metadata!==void 0&&L.metadata!==null?V.metadata=L.metadata:V.metadata="",L.permission!==void 0&&L.permission!==null?V.permission=a.ParticipantPermission.fromPartial(L.permission):V.permission=void 0,V}};const E={room:"",identity:"",trackSids:"",subscribe:!1};a.UpdateSubscriptionsRequest={encode(L,V=c.default.Writer.create()){L.room!==""&&V.uint32(10).string(L.room),L.identity!==""&&V.uint32(18).string(L.identity);for(const H of L.trackSids)V.uint32(26).string(H);L.subscribe===!0&&V.uint32(32).bool(L.subscribe);for(const H of L.participantTracks)l.ParticipantTracks.encode(H,V.uint32(42).fork()).ldelim();return V},decode(L,V){const H=L instanceof c.default.Reader?L:new c.default.Reader(L);let de=V===void 0?H.len:H.pos+V;const X=Object.assign({},E);for(X.trackSids=[],X.participantTracks=[];H.pos<de;){const K=H.uint32();switch(K>>>3){case 1:X.room=H.string();break;case 2:X.identity=H.string();break;case 3:X.trackSids.push(H.string());break;case 4:X.subscribe=H.bool();break;case 5:X.participantTracks.push(l.ParticipantTracks.decode(H,H.uint32()));break;default:H.skipType(K&7);break}}return X},fromJSON(L){const V=Object.assign({},E);if(V.trackSids=[],V.participantTracks=[],L.room!==void 0&&L.room!==null?V.room=String(L.room):V.room="",L.identity!==void 0&&L.identity!==null?V.identity=String(L.identity):V.identity="",L.trackSids!==void 0&&L.trackSids!==null)for(const H of L.trackSids)V.trackSids.push(String(H));if(L.subscribe!==void 0&&L.subscribe!==null?V.subscribe=Boolean(L.subscribe):V.subscribe=!1,L.participantTracks!==void 0&&L.participantTracks!==null)for(const H of L.participantTracks)V.participantTracks.push(l.ParticipantTracks.fromJSON(H));return V},toJSON(L){const V={};return L.room!==void 0&&(V.room=L.room),L.identity!==void 0&&(V.identity=L.identity),L.trackSids?V.trackSids=L.trackSids.map(H=>H):V.trackSids=[],L.subscribe!==void 0&&(V.subscribe=L.subscribe),L.participantTracks?V.participantTracks=L.participantTracks.map(H=>H?l.ParticipantTracks.toJSON(H):void 0):V.participantTracks=[],V},fromPartial(L){const V=Object.assign({},E);if(V.trackSids=[],V.participantTracks=[],L.room!==void 0&&L.room!==null?V.room=L.room:V.room="",L.identity!==void 0&&L.identity!==null?V.identity=L.identity:V.identity="",L.trackSids!==void 0&&L.trackSids!==null)for(const H of L.trackSids)V.trackSids.push(H);if(L.subscribe!==void 0&&L.subscribe!==null?V.subscribe=L.subscribe:V.subscribe=!1,L.participantTracks!==void 0&&L.participantTracks!==null)for(const H of L.participantTracks)V.participantTracks.push(l.ParticipantTracks.fromPartial(H));return V}};const D={};a.UpdateSubscriptionsResponse={encode(L,V=c.default.Writer.create()){return V},decode(L,V){const H=L instanceof c.default.Reader?L:new c.default.Reader(L);let de=V===void 0?H.len:H.pos+V;const X=Object.assign({},D);for(;H.pos<de;){const K=H.uint32();switch(K>>>3){default:H.skipType(K&7);break}}return X},fromJSON(L){return Object.assign({},D)},toJSON(L){return{}},fromPartial(L){return Object.assign({},D)}};const F={room:"",kind:0,destinationSids:""};a.SendDataRequest={encode(L,V=c.default.Writer.create()){L.room!==""&&V.uint32(10).string(L.room),L.data.length!==0&&V.uint32(18).bytes(L.data),L.kind!==0&&V.uint32(24).int32(L.kind);for(const H of L.destinationSids)V.uint32(34).string(H);return V},decode(L,V){const H=L instanceof c.default.Reader?L:new c.default.Reader(L);let de=V===void 0?H.len:H.pos+V;const X=Object.assign({},F);for(X.destinationSids=[],X.data=new Uint8Array;H.pos<de;){const K=H.uint32();switch(K>>>3){case 1:X.room=H.string();break;case 2:X.data=H.bytes();break;case 3:X.kind=H.int32();break;case 4:X.destinationSids.push(H.string());break;default:H.skipType(K&7);break}}return X},fromJSON(L){const V=Object.assign({},F);if(V.destinationSids=[],V.data=new Uint8Array,L.room!==void 0&&L.room!==null?V.room=String(L.room):V.room="",L.data!==void 0&&L.data!==null&&(V.data=N(L.data)),L.kind!==void 0&&L.kind!==null?V.kind=l.dataPacket_KindFromJSON(L.kind):V.kind=0,L.destinationSids!==void 0&&L.destinationSids!==null)for(const H of L.destinationSids)V.destinationSids.push(String(H));return V},toJSON(L){const V={};return L.room!==void 0&&(V.room=L.room),L.data!==void 0&&(V.data=Z(L.data!==void 0?L.data:new Uint8Array)),L.kind!==void 0&&(V.kind=l.dataPacket_KindToJSON(L.kind)),L.destinationSids?V.destinationSids=L.destinationSids.map(H=>H):V.destinationSids=[],V},fromPartial(L){const V=Object.assign({},F);if(V.destinationSids=[],L.room!==void 0&&L.room!==null?V.room=L.room:V.room="",L.data!==void 0&&L.data!==null?V.data=L.data:V.data=new Uint8Array,L.kind!==void 0&&L.kind!==null?V.kind=L.kind:V.kind=0,L.destinationSids!==void 0&&L.destinationSids!==null)for(const H of L.destinationSids)V.destinationSids.push(H);return V}};const J={};a.SendDataResponse={encode(L,V=c.default.Writer.create()){return V},decode(L,V){const H=L instanceof c.default.Reader?L:new c.default.Reader(L);let de=V===void 0?H.len:H.pos+V;const X=Object.assign({},J);for(;H.pos<de;){const K=H.uint32();switch(K>>>3){default:H.skipType(K&7);break}}return X},fromJSON(L){return Object.assign({},J)},toJSON(L){return{}},fromPartial(L){return Object.assign({},J)}};const G={room:"",metadata:""};a.UpdateRoomMetadataRequest={encode(L,V=c.default.Writer.create()){return L.room!==""&&V.uint32(10).string(L.room),L.metadata!==""&&V.uint32(18).string(L.metadata),V},decode(L,V){const H=L instanceof c.default.Reader?L:new c.default.Reader(L);let de=V===void 0?H.len:H.pos+V;const X=Object.assign({},G);for(;H.pos<de;){const K=H.uint32();switch(K>>>3){case 1:X.room=H.string();break;case 2:X.metadata=H.string();break;default:H.skipType(K&7);break}}return X},fromJSON(L){const V=Object.assign({},G);return L.room!==void 0&&L.room!==null?V.room=String(L.room):V.room="",L.metadata!==void 0&&L.metadata!==null?V.metadata=String(L.metadata):V.metadata="",V},toJSON(L){const V={};return L.room!==void 0&&(V.room=L.room),L.metadata!==void 0&&(V.metadata=L.metadata),V},fromPartial(L){const V=Object.assign({},G);return L.room!==void 0&&L.room!==null?V.room=L.room:V.room="",L.metadata!==void 0&&L.metadata!==null?V.metadata=L.metadata:V.metadata="",V}};var x=(()=>{if(typeof x!="undefined")return x;if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof commonjsGlobal$1!="undefined")return commonjsGlobal$1;throw"Unable to locate global object"})();const Y=x.atob||(L=>x.Buffer.from(L,"base64").toString("binary"));function N(L){const V=Y(L),H=new Uint8Array(V.length);for(let de=0;de<V.length;++de)H[de]=V.charCodeAt(de);return H}const z=x.btoa||(L=>x.Buffer.from(L,"binary").toString("base64"));function Z(L){const V=[];for(const H of L)V.push(String.fromCharCode(H));return z(V.join(""))}c.default.util.Long!==d.default&&(c.default.util.Long=d.default,c.default.configure())})(livekit_room);var TwirpRPC={},axios$2={exports:{}},bind$2=function a(s,d){return function(){for(var l=new Array(arguments.length),p=0;p<l.length;p++)l[p]=arguments[p];return s.apply(d,l)}},bind$1=bind$2,toString=Object.prototype.toString;function isArray$1(a){return toString.call(a)==="[object Array]"}function isUndefined(a){return typeof a=="undefined"}function isBuffer(a){return a!==null&&!isUndefined(a)&&a.constructor!==null&&!isUndefined(a.constructor)&&typeof a.constructor.isBuffer=="function"&&a.constructor.isBuffer(a)}function isArrayBuffer(a){return toString.call(a)==="[object ArrayBuffer]"}function isFormData(a){return typeof FormData!="undefined"&&a instanceof FormData}function isArrayBufferView(a){var s;return typeof ArrayBuffer!="undefined"&&ArrayBuffer.isView?s=ArrayBuffer.isView(a):s=a&&a.buffer&&a.buffer instanceof ArrayBuffer,s}function isString(a){return typeof a=="string"}function isNumber(a){return typeof a=="number"}function isObject$3(a){return a!==null&&typeof a=="object"}function isPlainObject(a){if(toString.call(a)!=="[object Object]")return!1;var s=Object.getPrototypeOf(a);return s===null||s===Object.prototype}function isDate(a){return toString.call(a)==="[object Date]"}function isFile(a){return toString.call(a)==="[object File]"}function isBlob(a){return toString.call(a)==="[object Blob]"}function isFunction(a){return toString.call(a)==="[object Function]"}function isStream(a){return isObject$3(a)&&isFunction(a.pipe)}function isURLSearchParams(a){return typeof URLSearchParams!="undefined"&&a instanceof URLSearchParams}function trim$1(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function isStandardBrowserEnv(){return typeof navigator!="undefined"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")?!1:typeof window!="undefined"&&typeof document!="undefined"}function forEach(a,s){if(!(a===null||typeof a=="undefined"))if(typeof a!="object"&&(a=[a]),isArray$1(a))for(var d=0,c=a.length;d<c;d++)s.call(null,a[d],d,a);else for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&s.call(null,a[l],l,a)}function merge(){var a={};function s(l,p){isPlainObject(a[p])&&isPlainObject(l)?a[p]=merge(a[p],l):isPlainObject(l)?a[p]=merge({},l):isArray$1(l)?a[p]=l.slice():a[p]=l}for(var d=0,c=arguments.length;d<c;d++)forEach(arguments[d],s);return a}function extend(a,s,d){return forEach(s,function(l,p){d&&typeof l=="function"?a[p]=bind$1(l,d):a[p]=l}),a}function stripBOM(a){return a.charCodeAt(0)===65279&&(a=a.slice(1)),a}var utils$d={isArray:isArray$1,isArrayBuffer,isBuffer,isFormData,isArrayBufferView,isString,isNumber,isObject:isObject$3,isPlainObject,isUndefined,isDate,isFile,isBlob,isFunction,isStream,isURLSearchParams,isStandardBrowserEnv,forEach,merge,extend,trim:trim$1,stripBOM},utils$c=utils$d;function encode(a){return encodeURIComponent(a).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var buildURL$2=function a(s,d,c){if(!d)return s;var l;if(c)l=c(d);else if(utils$c.isURLSearchParams(d))l=d.toString();else{var p=[];utils$c.forEach(d,function(S,b){S===null||typeof S=="undefined"||(utils$c.isArray(S)?b=b+"[]":S=[S],utils$c.forEach(S,function(I){utils$c.isDate(I)?I=I.toISOString():utils$c.isObject(I)&&(I=JSON.stringify(I)),p.push(encode(b)+"="+encode(I))}))}),l=p.join("&")}if(l){var h=s.indexOf("#");h!==-1&&(s=s.slice(0,h)),s+=(s.indexOf("?")===-1?"?":"&")+l}return s},utils$b=utils$d;function InterceptorManager$1(){this.handlers=[]}InterceptorManager$1.prototype.use=function a(s,d,c){return this.handlers.push({fulfilled:s,rejected:d,synchronous:c?c.synchronous:!1,runWhen:c?c.runWhen:null}),this.handlers.length-1},InterceptorManager$1.prototype.eject=function a(s){this.handlers[s]&&(this.handlers[s]=null)},InterceptorManager$1.prototype.forEach=function a(s){utils$b.forEach(this.handlers,function(c){c!==null&&s(c)})};var InterceptorManager_1=InterceptorManager$1,utils$a=utils$d,normalizeHeaderName$1=function a(s,d){utils$a.forEach(s,function(l,p){p!==d&&p.toUpperCase()===d.toUpperCase()&&(s[d]=l,delete s[p])})},enhanceError$2=function a(s,d,c,l,p){return s.config=d,c&&(s.code=c),s.request=l,s.response=p,s.isAxiosError=!0,s.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},s},enhanceError$1=enhanceError$2,createError$2=function a(s,d,c,l,p){var h=new Error(s);return enhanceError$1(h,d,c,l,p)},createError$1=createError$2,settle$1=function a(s,d,c){var l=c.config.validateStatus;!c.status||!l||l(c.status)?s(c):d(createError$1("Request failed with status code "+c.status,c.config,null,c.request,c))},utils$9=utils$d,cookies$1=utils$9.isStandardBrowserEnv()?function a(){return{write:function(d,c,l,p,h,v){var S=[];S.push(d+"="+encodeURIComponent(c)),utils$9.isNumber(l)&&S.push("expires="+new Date(l).toGMTString()),utils$9.isString(p)&&S.push("path="+p),utils$9.isString(h)&&S.push("domain="+h),v===!0&&S.push("secure"),document.cookie=S.join("; ")},read:function(d){var c=document.cookie.match(new RegExp("(^|;\\s*)("+d+")=([^;]*)"));return c?decodeURIComponent(c[3]):null},remove:function(d){this.write(d,"",Date.now()-864e5)}}}():function a(){return{write:function(){},read:function(){return null},remove:function(){}}}(),isAbsoluteURL$1=function a(s){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(s)},combineURLs$1=function a(s,d){return d?s.replace(/\/+$/,"")+"/"+d.replace(/^\/+/,""):s},isAbsoluteURL=isAbsoluteURL$1,combineURLs=combineURLs$1,buildFullPath$1=function a(s,d){return s&&!isAbsoluteURL(d)?combineURLs(s,d):d},utils$8=utils$d,ignoreDuplicateOf=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],parseHeaders$1=function a(s){var d={},c,l,p;return s&&utils$8.forEach(s.split(`
`),function(v){if(p=v.indexOf(":"),c=utils$8.trim(v.substr(0,p)).toLowerCase(),l=utils$8.trim(v.substr(p+1)),c){if(d[c]&&ignoreDuplicateOf.indexOf(c)>=0)return;c==="set-cookie"?d[c]=(d[c]?d[c]:[]).concat([l]):d[c]=d[c]?d[c]+", "+l:l}}),d},utils$7=utils$d,isURLSameOrigin$1=utils$7.isStandardBrowserEnv()?function a(){var s=/(msie|trident)/i.test(navigator.userAgent),d=document.createElement("a"),c;function l(p){var h=p;return s&&(d.setAttribute("href",h),h=d.href),d.setAttribute("href",h),{href:d.href,protocol:d.protocol?d.protocol.replace(/:$/,""):"",host:d.host,search:d.search?d.search.replace(/^\?/,""):"",hash:d.hash?d.hash.replace(/^#/,""):"",hostname:d.hostname,port:d.port,pathname:d.pathname.charAt(0)==="/"?d.pathname:"/"+d.pathname}}return c=l(window.location.href),function(h){var v=utils$7.isString(h)?l(h):h;return v.protocol===c.protocol&&v.host===c.host}}():function a(){return function(){return!0}}(),utils$6=utils$d,settle=settle$1,cookies=cookies$1,buildURL$1=buildURL$2,buildFullPath=buildFullPath$1,parseHeaders=parseHeaders$1,isURLSameOrigin=isURLSameOrigin$1,createError=createError$2,xhr=function a(s){return new Promise(function(c,l){var p=s.data,h=s.headers,v=s.responseType;utils$6.isFormData(p)&&delete h["Content-Type"];var S=new XMLHttpRequest;if(s.auth){var b=s.auth.username||"",_=s.auth.password?unescape(encodeURIComponent(s.auth.password)):"";h.Authorization="Basic "+btoa(b+":"+_)}var I=buildFullPath(s.baseURL,s.url);S.open(s.method.toUpperCase(),buildURL$1(I,s.params,s.paramsSerializer),!0),S.timeout=s.timeout;function T(){if(!!S){var w="getAllResponseHeaders"in S?parseHeaders(S.getAllResponseHeaders()):null,P=!v||v==="text"||v==="json"?S.responseText:S.response,$={data:P,status:S.status,statusText:S.statusText,headers:w,config:s,request:S};settle(c,l,$),S=null}}if("onloadend"in S?S.onloadend=T:S.onreadystatechange=function(){!S||S.readyState!==4||S.status===0&&!(S.responseURL&&S.responseURL.indexOf("file:")===0)||setTimeout(T)},S.onabort=function(){!S||(l(createError("Request aborted",s,"ECONNABORTED",S)),S=null)},S.onerror=function(){l(createError("Network Error",s,null,S)),S=null},S.ontimeout=function(){var P="timeout of "+s.timeout+"ms exceeded";s.timeoutErrorMessage&&(P=s.timeoutErrorMessage),l(createError(P,s,s.transitional&&s.transitional.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",S)),S=null},utils$6.isStandardBrowserEnv()){var k=(s.withCredentials||isURLSameOrigin(I))&&s.xsrfCookieName?cookies.read(s.xsrfCookieName):void 0;k&&(h[s.xsrfHeaderName]=k)}"setRequestHeader"in S&&utils$6.forEach(h,function(P,$){typeof p=="undefined"&&$.toLowerCase()==="content-type"?delete h[$]:S.setRequestHeader($,P)}),utils$6.isUndefined(s.withCredentials)||(S.withCredentials=!!s.withCredentials),v&&v!=="json"&&(S.responseType=s.responseType),typeof s.onDownloadProgress=="function"&&S.addEventListener("progress",s.onDownloadProgress),typeof s.onUploadProgress=="function"&&S.upload&&S.upload.addEventListener("progress",s.onUploadProgress),s.cancelToken&&s.cancelToken.promise.then(function(P){!S||(S.abort(),l(P),S=null)}),p||(p=null),S.send(p)})},utils$5=utils$d,normalizeHeaderName=normalizeHeaderName$1,enhanceError=enhanceError$2,DEFAULT_CONTENT_TYPE={"Content-Type":"application/x-www-form-urlencoded"};function setContentTypeIfUnset(a,s){!utils$5.isUndefined(a)&&utils$5.isUndefined(a["Content-Type"])&&(a["Content-Type"]=s)}function getDefaultAdapter(){var a;return(typeof XMLHttpRequest!="undefined"||typeof process!="undefined"&&Object.prototype.toString.call(process)==="[object process]")&&(a=xhr),a}function stringifySafely(a,s,d){if(utils$5.isString(a))try{return(s||JSON.parse)(a),utils$5.trim(a)}catch(c){if(c.name!=="SyntaxError")throw c}return(d||JSON.stringify)(a)}var defaults$3={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:getDefaultAdapter(),transformRequest:[function a(s,d){return normalizeHeaderName(d,"Accept"),normalizeHeaderName(d,"Content-Type"),utils$5.isFormData(s)||utils$5.isArrayBuffer(s)||utils$5.isBuffer(s)||utils$5.isStream(s)||utils$5.isFile(s)||utils$5.isBlob(s)?s:utils$5.isArrayBufferView(s)?s.buffer:utils$5.isURLSearchParams(s)?(setContentTypeIfUnset(d,"application/x-www-form-urlencoded;charset=utf-8"),s.toString()):utils$5.isObject(s)||d&&d["Content-Type"]==="application/json"?(setContentTypeIfUnset(d,"application/json"),stringifySafely(s)):s}],transformResponse:[function a(s){var d=this.transitional,c=d&&d.silentJSONParsing,l=d&&d.forcedJSONParsing,p=!c&&this.responseType==="json";if(p||l&&utils$5.isString(s)&&s.length)try{return JSON.parse(s)}catch(h){if(p)throw h.name==="SyntaxError"?enhanceError(h,this,"E_JSON_PARSE"):h}return s}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function a(s){return s>=200&&s<300}};defaults$3.headers={common:{Accept:"application/json, text/plain, */*"}},utils$5.forEach(["delete","get","head"],function a(s){defaults$3.headers[s]={}}),utils$5.forEach(["post","put","patch"],function a(s){defaults$3.headers[s]=utils$5.merge(DEFAULT_CONTENT_TYPE)});var defaults_1=defaults$3,utils$4=utils$d,defaults$2=defaults_1,transformData$1=function a(s,d,c){var l=this||defaults$2;return utils$4.forEach(c,function(h){s=h.call(l,s,d)}),s},isCancel$1=function a(s){return!!(s&&s.__CANCEL__)},utils$3=utils$d,transformData=transformData$1,isCancel=isCancel$1,defaults$1=defaults_1;function throwIfCancellationRequested(a){a.cancelToken&&a.cancelToken.throwIfRequested()}var dispatchRequest$1=function a(s){throwIfCancellationRequested(s),s.headers=s.headers||{},s.data=transformData.call(s,s.data,s.headers,s.transformRequest),s.headers=utils$3.merge(s.headers.common||{},s.headers[s.method]||{},s.headers),utils$3.forEach(["delete","get","head","post","put","patch","common"],function(l){delete s.headers[l]});var d=s.adapter||defaults$1.adapter;return d(s).then(function(l){return throwIfCancellationRequested(s),l.data=transformData.call(s,l.data,l.headers,s.transformResponse),l},function(l){return isCancel(l)||(throwIfCancellationRequested(s),l&&l.response&&(l.response.data=transformData.call(s,l.response.data,l.response.headers,s.transformResponse))),Promise.reject(l)})},utils$2=utils$d,mergeConfig$2=function a(s,d){d=d||{};var c={},l=["url","method","data"],p=["headers","auth","proxy","params"],h=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],v=["validateStatus"];function S(T,k){return utils$2.isPlainObject(T)&&utils$2.isPlainObject(k)?utils$2.merge(T,k):utils$2.isPlainObject(k)?utils$2.merge({},k):utils$2.isArray(k)?k.slice():k}function b(T){utils$2.isUndefined(d[T])?utils$2.isUndefined(s[T])||(c[T]=S(void 0,s[T])):c[T]=S(s[T],d[T])}utils$2.forEach(l,function(k){utils$2.isUndefined(d[k])||(c[k]=S(void 0,d[k]))}),utils$2.forEach(p,b),utils$2.forEach(h,function(k){utils$2.isUndefined(d[k])?utils$2.isUndefined(s[k])||(c[k]=S(void 0,s[k])):c[k]=S(void 0,d[k])}),utils$2.forEach(v,function(k){k in d?c[k]=S(s[k],d[k]):k in s&&(c[k]=S(void 0,s[k]))});var _=l.concat(p).concat(h).concat(v),I=Object.keys(s).concat(Object.keys(d)).filter(function(k){return _.indexOf(k)===-1});return utils$2.forEach(I,b),c};const name="axios",version$2="0.21.4",description="Promise based HTTP client for the browser and node.js",main="index.js",scripts={test:"grunt test",start:"node ./sandbox/server.js",build:"NODE_ENV=production grunt build",preversion:"npm test",version:"npm run build && grunt version && git add -A dist && git add CHANGELOG.md bower.json package.json",postversion:"git push && git push --tags",examples:"node ./examples/server.js",coveralls:"cat coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js",fix:"eslint --fix lib/**/*.js"},repository={type:"git",url:"https://github.com/axios/axios.git"},keywords=["xhr","http","ajax","promise","node"],author="Matt Zabriskie",license="MIT",bugs={url:"https://github.com/axios/axios/issues"},homepage="https://axios-http.com",devDependencies={coveralls:"^3.0.0","es6-promise":"^4.2.4",grunt:"^1.3.0","grunt-banner":"^0.6.0","grunt-cli":"^1.2.0","grunt-contrib-clean":"^1.1.0","grunt-contrib-watch":"^1.0.0","grunt-eslint":"^23.0.0","grunt-karma":"^4.0.0","grunt-mocha-test":"^0.13.3","grunt-ts":"^6.0.0-beta.19","grunt-webpack":"^4.0.2","istanbul-instrumenter-loader":"^1.0.0","jasmine-core":"^2.4.1",karma:"^6.3.2","karma-chrome-launcher":"^3.1.0","karma-firefox-launcher":"^2.1.0","karma-jasmine":"^1.1.1","karma-jasmine-ajax":"^0.1.13","karma-safari-launcher":"^1.0.0","karma-sauce-launcher":"^4.3.6","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.8","karma-webpack":"^4.0.2","load-grunt-tasks":"^3.5.2",minimist:"^1.2.0",mocha:"^8.2.1",sinon:"^4.5.0","terser-webpack-plugin":"^4.2.3",typescript:"^4.0.5","url-search-params":"^0.10.0",webpack:"^4.44.2","webpack-dev-server":"^3.11.0"},browser={"./lib/adapters/http.js":"./lib/adapters/xhr.js"},jsdelivr="dist/axios.min.js",unpkg="dist/axios.min.js",typings="./index.d.ts",dependencies={"follow-redirects":"^1.14.0"},bundlesize=[{path:"./dist/axios.min.js",threshold:"5kB"}];var require$$0={name,version:version$2,description,main,scripts,repository,keywords,author,license,bugs,homepage,devDependencies,browser,jsdelivr,unpkg,typings,dependencies,bundlesize},pkg=require$$0,validators$1={};["object","boolean","number","function","string","symbol"].forEach(function(a,s){validators$1[a]=function(c){return typeof c===a||"a"+(s<1?"n ":" ")+a}});var deprecatedWarnings={},currentVerArr=pkg.version.split(".");function isOlderVersion(a,s){for(var d=s?s.split("."):currentVerArr,c=a.split("."),l=0;l<3;l++){if(d[l]>c[l])return!0;if(d[l]<c[l])return!1}return!1}validators$1.transitional=function a(s,d,c){var l=d&&isOlderVersion(d);function p(h,v){return"[Axios v"+pkg.version+"] Transitional option '"+h+"'"+v+(c?". "+c:"")}return function(h,v,S){if(s===!1)throw new Error(p(v," has been removed in "+d));return l&&!deprecatedWarnings[v]&&(deprecatedWarnings[v]=!0,console.warn(p(v," has been deprecated since v"+d+" and will be removed in the near future"))),s?s(h,v,S):!0}};function assertOptions(a,s,d){if(typeof a!="object")throw new TypeError("options must be an object");for(var c=Object.keys(a),l=c.length;l-- >0;){var p=c[l],h=s[p];if(h){var v=a[p],S=v===void 0||h(v,p,a);if(S!==!0)throw new TypeError("option "+p+" must be "+S);continue}if(d!==!0)throw Error("Unknown option "+p)}}var validator$1={isOlderVersion,assertOptions,validators:validators$1},utils$1=utils$d,buildURL=buildURL$2,InterceptorManager=InterceptorManager_1,dispatchRequest=dispatchRequest$1,mergeConfig$1=mergeConfig$2,validator=validator$1,validators=validator.validators;function Axios$1(a){this.defaults=a,this.interceptors={request:new InterceptorManager,response:new InterceptorManager}}Axios$1.prototype.request=function a(s){typeof s=="string"?(s=arguments[1]||{},s.url=arguments[0]):s=s||{},s=mergeConfig$1(this.defaults,s),s.method?s.method=s.method.toLowerCase():this.defaults.method?s.method=this.defaults.method.toLowerCase():s.method="get";var d=s.transitional;d!==void 0&&validator.assertOptions(d,{silentJSONParsing:validators.transitional(validators.boolean,"1.0.0"),forcedJSONParsing:validators.transitional(validators.boolean,"1.0.0"),clarifyTimeoutError:validators.transitional(validators.boolean,"1.0.0")},!1);var c=[],l=!0;this.interceptors.request.forEach(function(T){typeof T.runWhen=="function"&&T.runWhen(s)===!1||(l=l&&T.synchronous,c.unshift(T.fulfilled,T.rejected))});var p=[];this.interceptors.response.forEach(function(T){p.push(T.fulfilled,T.rejected)});var h;if(!l){var v=[dispatchRequest,void 0];for(Array.prototype.unshift.apply(v,c),v=v.concat(p),h=Promise.resolve(s);v.length;)h=h.then(v.shift(),v.shift());return h}for(var S=s;c.length;){var b=c.shift(),_=c.shift();try{S=b(S)}catch(I){_(I);break}}try{h=dispatchRequest(S)}catch(I){return Promise.reject(I)}for(;p.length;)h=h.then(p.shift(),p.shift());return h},Axios$1.prototype.getUri=function a(s){return s=mergeConfig$1(this.defaults,s),buildURL(s.url,s.params,s.paramsSerializer).replace(/^\?/,"")},utils$1.forEach(["delete","get","head","options"],function a(s){Axios$1.prototype[s]=function(d,c){return this.request(mergeConfig$1(c||{},{method:s,url:d,data:(c||{}).data}))}}),utils$1.forEach(["post","put","patch"],function a(s){Axios$1.prototype[s]=function(d,c,l){return this.request(mergeConfig$1(l||{},{method:s,url:d,data:c}))}});var Axios_1=Axios$1;function Cancel$1(a){this.message=a}Cancel$1.prototype.toString=function a(){return"Cancel"+(this.message?": "+this.message:"")},Cancel$1.prototype.__CANCEL__=!0;var Cancel_1=Cancel$1,Cancel=Cancel_1;function CancelToken(a){if(typeof a!="function")throw new TypeError("executor must be a function.");var s;this.promise=new Promise(function(l){s=l});var d=this;a(function(l){d.reason||(d.reason=new Cancel(l),s(d.reason))})}CancelToken.prototype.throwIfRequested=function a(){if(this.reason)throw this.reason},CancelToken.source=function a(){var s,d=new CancelToken(function(l){s=l});return{token:d,cancel:s}};var CancelToken_1=CancelToken,spread=function a(s){return function(c){return s.apply(null,c)}},isAxiosError=function a(s){return typeof s=="object"&&s.isAxiosError===!0},utils=utils$d,bind=bind$2,Axios=Axios_1,mergeConfig=mergeConfig$2,defaults=defaults_1;function createInstance(a){var s=new Axios(a),d=bind(Axios.prototype.request,s);return utils.extend(d,Axios.prototype,s),utils.extend(d,s),d}var axios$1=createInstance(defaults);axios$1.Axios=Axios,axios$1.create=function a(s){return createInstance(mergeConfig(axios$1.defaults,s))},axios$1.Cancel=Cancel_1,axios$1.CancelToken=CancelToken_1,axios$1.isCancel=isCancel$1,axios$1.all=function a(s){return Promise.all(s)},axios$1.spread=spread,axios$1.isAxiosError=isAxiosError,axios$2.exports=axios$1,axios$2.exports.default=axios$1;var axios=axios$2.exports,mapObj$1={exports:{}};const isObject$2=a=>typeof a=="object"&&a!==null,mapObjectSkip=Symbol("skip"),isObjectCustom=a=>isObject$2(a)&&!(a instanceof RegExp)&&!(a instanceof Error)&&!(a instanceof Date),mapObject=(a,s,d,c=new WeakMap)=>{if(d={deep:!1,target:{},...d},c.has(a))return c.get(a);c.set(a,d.target);const{target:l}=d;delete d.target;const p=h=>h.map(v=>isObjectCustom(v)?mapObject(v,s,d,c):v);if(Array.isArray(a))return p(a);for(const[h,v]of Object.entries(a)){const S=s(h,v,a);if(S===mapObjectSkip)continue;let[b,_,{shouldRecurse:I=!0}={}]=S;b!=="__proto__"&&(d.deep&&I&&isObjectCustom(_)&&(_=Array.isArray(_)?p(_):mapObject(_,s,d,c)),l[b]=_)}return l};mapObj$1.exports=(a,s,d)=>{if(!isObject$2(a))throw new TypeError(`Expected an object, got \`${a}\` (${typeof a})`);return mapObject(a,s,d)},mapObj$1.exports.mapObjectSkip=mapObjectSkip;var camelcase={exports:{}};const UPPERCASE=/[\p{Lu}]/u,LOWERCASE=/[\p{Ll}]/u,LEADING_CAPITAL=/^[\p{Lu}](?![\p{Lu}])/gu,IDENTIFIER=/([\p{Alpha}\p{N}_]|$)/u,SEPARATORS=/[_.\- ]+/,LEADING_SEPARATORS=new RegExp("^"+SEPARATORS.source),SEPARATORS_AND_IDENTIFIER=new RegExp(SEPARATORS.source+IDENTIFIER.source,"gu"),NUMBERS_AND_IDENTIFIER=new RegExp("\\d+"+IDENTIFIER.source,"gu"),preserveCamelCase=(a,s,d)=>{let c=!1,l=!1,p=!1;for(let h=0;h<a.length;h++){const v=a[h];c&&UPPERCASE.test(v)?(a=a.slice(0,h)+"-"+a.slice(h),c=!1,p=l,l=!0,h++):l&&p&&LOWERCASE.test(v)?(a=a.slice(0,h-1)+"-"+a.slice(h-1),p=l,l=!1,c=!0):(c=s(v)===v&&d(v)!==v,p=l,l=d(v)===v&&s(v)!==v)}return a},preserveConsecutiveUppercase=(a,s)=>(LEADING_CAPITAL.lastIndex=0,a.replace(LEADING_CAPITAL,d=>s(d))),postProcess=(a,s)=>(SEPARATORS_AND_IDENTIFIER.lastIndex=0,NUMBERS_AND_IDENTIFIER.lastIndex=0,a.replace(SEPARATORS_AND_IDENTIFIER,(d,c)=>s(c)).replace(NUMBERS_AND_IDENTIFIER,d=>s(d))),camelCase$1=(a,s)=>{if(!(typeof a=="string"||Array.isArray(a)))throw new TypeError("Expected the input to be `string | string[]`");if(s={pascalCase:!1,preserveConsecutiveUppercase:!1,...s},Array.isArray(a)?a=a.map(p=>p.trim()).filter(p=>p.length).join("-"):a=a.trim(),a.length===0)return"";const d=s.locale===!1?p=>p.toLowerCase():p=>p.toLocaleLowerCase(s.locale),c=s.locale===!1?p=>p.toUpperCase():p=>p.toLocaleUpperCase(s.locale);return a.length===1?s.pascalCase?c(a):d(a):(a!==d(a)&&(a=preserveCamelCase(a,d,c)),a=a.replace(LEADING_SEPARATORS,""),s.preserveConsecutiveUppercase?a=preserveConsecutiveUppercase(a,d):a=d(a),s.pascalCase&&(a=c(a.charAt(0))+a.slice(1)),postProcess(a,c))};camelcase.exports=camelCase$1,camelcase.exports.default=camelCase$1;class QuickLRU{constructor(s={}){if(!(s.maxSize&&s.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");this.maxSize=s.maxSize,this.onEviction=s.onEviction,this.cache=new Map,this.oldCache=new Map,this._size=0}_set(s,d){if(this.cache.set(s,d),this._size++,this._size>=this.maxSize){if(this._size=0,typeof this.onEviction=="function")for(const[c,l]of this.oldCache.entries())this.onEviction(c,l);this.oldCache=this.cache,this.cache=new Map}}get(s){if(this.cache.has(s))return this.cache.get(s);if(this.oldCache.has(s)){const d=this.oldCache.get(s);return this.oldCache.delete(s),this._set(s,d),d}}set(s,d){return this.cache.has(s)?this.cache.set(s,d):this._set(s,d),this}has(s){return this.cache.has(s)||this.oldCache.has(s)}peek(s){if(this.cache.has(s))return this.cache.get(s);if(this.oldCache.has(s))return this.oldCache.get(s)}delete(s){const d=this.cache.delete(s);return d&&this._size--,this.oldCache.delete(s)||d}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}*keys(){for(const[s]of this)yield s}*values(){for(const[,s]of this)yield s}*[Symbol.iterator](){for(const s of this.cache)yield s;for(const s of this.oldCache){const[d]=s;this.cache.has(d)||(yield s)}}get size(){let s=0;for(const d of this.oldCache.keys())this.cache.has(d)||s++;return Math.min(this._size+s,this.maxSize)}}var quickLru=QuickLRU;const mapObj=mapObj$1.exports,camelCase=camelcase.exports,QuickLru=quickLru,has=(a,s)=>a.some(d=>typeof d=="string"?d===s:(d.lastIndex=0,d.test(s))),cache$1=new QuickLru({maxSize:1e5}),isObject$1=a=>typeof a=="object"&&a!==null&&!(a instanceof RegExp)&&!(a instanceof Error)&&!(a instanceof Date),camelCaseConvert=(a,s)=>{if(!isObject$1(a))return a;s={deep:!1,pascalCase:!1,...s};const{exclude:d,pascalCase:c,stopPaths:l,deep:p}=s,h=new Set(l),v=S=>(b,_)=>{if(p&&isObject$1(_)){const I=S===void 0?b:`${S}.${b}`;h.has(I)||(_=mapObj(_,v(I)))}if(!(d&&has(d,b))){const I=c?`${b}_`:b;if(cache$1.has(I))b=cache$1.get(I);else{const T=camelCase(b,{pascalCase:c,locale:!1});b.length<100&&cache$1.set(I,T),b=T}}return[b,_]};return mapObj(a,v(void 0))};var camelcaseKeys=(a,s)=>Array.isArray(a)?Object.keys(a).map(d=>camelCaseConvert(a[d],s)):camelCaseConvert(a,s),__importDefault=commonjsGlobal$1&&commonjsGlobal$1.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(TwirpRPC,"__esModule",{value:!0}),TwirpRPC.TwirpRpc=TwirpRPC.livekitPackage=void 0;const axios_1=__importDefault(axios),camelcase_keys_1=__importDefault(camelcaseKeys),defaultPrefix="/twirp";TwirpRPC.livekitPackage="livekit";class TwirpRpc{constructor(s,d,c,l){this.host=s,this.pkg=d,this.prefix=c||defaultPrefix;let p={baseURL:s};l!=null&&(p.headers={Host:l}),this.instance=axios_1.default.create(p)}request(s,d,c,l){return new Promise((p,h)=>{const v=`${this.prefix}/${this.pkg}.${s}/${d}`;this.instance.post(v,c,{headers:l}).then(S=>{p(camelcase_keys_1.default(S.data,{deep:!0}))}).catch(h)})}}TwirpRPC.TwirpRpc=TwirpRpc;var __awaiter=commonjsGlobal$1&&commonjsGlobal$1.__awaiter||function(a,s,d,c){function l(p){return p instanceof d?p:new d(function(h){h(p)})}return new(d||(d=Promise))(function(p,h){function v(_){try{b(c.next(_))}catch(I){h(I)}}function S(_){try{b(c.throw(_))}catch(I){h(I)}}function b(_){_.done?p(_.value):l(_.value).then(v,S)}b((c=c.apply(a,s||[])).next())})};Object.defineProperty(RoomServiceClient$1,"__esModule",{value:!0}),RoomServiceClient$1.RoomServiceClient=void 0;const livekit_models_1=livekit_models,livekit_room_1=livekit_room,TwirpRPC_1=TwirpRPC,svc="RoomService";class RoomServiceClient{constructor(s,d,c,l,p){this.rpc=new TwirpRPC_1.TwirpRpc(s,TwirpRPC_1.livekitPackage,void 0,p),this.apiKey=d,this.secret=c,this.jwt=l}createRoom(s){return __awaiter(this,void 0,void 0,function*(){const d=yield this.rpc.request(svc,"CreateRoom",livekit_room_1.CreateRoomRequest.toJSON(livekit_room_1.CreateRoomRequest.fromPartial(s)),this.authHeader({roomCreate:!0}));return livekit_models_1.Room.fromJSON(d)})}listRooms(s){return __awaiter(this,void 0,void 0,function*(){const d=yield this.rpc.request(svc,"ListRooms",livekit_room_1.ListRoomsRequest.toJSON({names:s!=null?s:[]}),this.authHeader({roomList:!0}));return livekit_room_1.ListRoomsResponse.fromJSON(d).rooms})}deleteRoom(s){return __awaiter(this,void 0,void 0,function*(){yield this.rpc.request(svc,"DeleteRoom",livekit_room_1.DeleteRoomRequest.toJSON({room:s}),this.authHeader({roomCreate:!0}))})}updateRoomMetadata(s,d){return __awaiter(this,void 0,void 0,function*(){const c=yield this.rpc.request(svc,"UpdateRoomMetadata",livekit_room_1.UpdateRoomMetadataRequest.toJSON({room:s,metadata:d}),this.authHeader({roomAdmin:!0,room:s}));return livekit_models_1.Room.fromJSON(c)})}listParticipants(s){return __awaiter(this,void 0,void 0,function*(){const d=yield this.rpc.request(svc,"ListParticipants",livekit_room_1.ListParticipantsRequest.toJSON({room:s}),this.authHeader({roomAdmin:!0,room:s}));return livekit_room_1.ListParticipantsResponse.fromJSON(d).participants})}getParticipant(s,d){return __awaiter(this,void 0,void 0,function*(){const c=yield this.rpc.request(svc,"GetParticipant",livekit_room_1.RoomParticipantIdentity.toJSON({room:s,identity:d}),this.authHeader({roomAdmin:!0,room:s}));return livekit_models_1.ParticipantInfo.fromJSON(c)})}removeParticipant(s,d){return __awaiter(this,void 0,void 0,function*(){yield this.rpc.request(svc,"RemoveParticipant",livekit_room_1.RoomParticipantIdentity.toJSON({room:s,identity:d}),this.authHeader({roomAdmin:!0,room:s}))})}mutePublishedTrack(s,d,c,l){return __awaiter(this,void 0,void 0,function*(){const p=livekit_room_1.MuteRoomTrackRequest.toJSON({room:s,identity:d,trackSid:c,muted:l}),h=yield this.rpc.request(svc,"MutePublishedTrack",p,this.authHeader({roomAdmin:!0,room:s}));return livekit_room_1.MuteRoomTrackResponse.fromJSON(h).track})}updateParticipant(s,d,c,l){return __awaiter(this,void 0,void 0,function*(){const p={room:s,identity:d,metadata:c||"",permission:l},h=yield this.rpc.request(svc,"UpdateParticipant",livekit_room_1.UpdateParticipantRequest.toJSON(p),this.authHeader({roomAdmin:!0,room:s}));return livekit_models_1.ParticipantInfo.fromJSON(h)})}updateSubscriptions(s,d,c,l){return __awaiter(this,void 0,void 0,function*(){const p=livekit_room_1.UpdateSubscriptionsRequest.toJSON({room:s,identity:d,trackSids:c,subscribe:l,participantTracks:[]});yield this.rpc.request(svc,"UpdateSubscriptions",p,this.authHeader({roomAdmin:!0,room:s}))})}sendData(s,d,c,l=[]){return __awaiter(this,void 0,void 0,function*(){const p=livekit_room_1.SendDataRequest.toJSON({room:s,data:d,kind:c,destinationSids:l});yield this.rpc.request(svc,"SendData",p,this.authHeader({roomAdmin:!0,room:s}))})}authHeader(s){if(this.jwt!=null)return{Authorization:`Bearer ${this.jwt}`}}}RoomServiceClient$1.RoomServiceClient=RoomServiceClient,function(a){var s=commonjsGlobal$1&&commonjsGlobal$1.__createBinding||(Object.create?function(l,p,h,v){v===void 0&&(v=h),Object.defineProperty(l,v,{enumerable:!0,get:function(){return p[h]}})}:function(l,p,h,v){v===void 0&&(v=h),l[v]=p[h]}),d=commonjsGlobal$1&&commonjsGlobal$1.__exportStar||function(l,p){for(var h in l)h!=="default"&&!Object.prototype.hasOwnProperty.call(p,h)&&s(p,l,h)};Object.defineProperty(a,"__esModule",{value:!0}),a.TrackType=a.TrackInfo=a.Room=a.ParticipantInfo_State=a.ParticipantInfo=a.DataPacket_Kind=void 0,d(grants,a);var c=livekit_models;Object.defineProperty(a,"DataPacket_Kind",{enumerable:!0,get:function(){return c.DataPacket_Kind}}),Object.defineProperty(a,"ParticipantInfo",{enumerable:!0,get:function(){return c.ParticipantInfo}}),Object.defineProperty(a,"ParticipantInfo_State",{enumerable:!0,get:function(){return c.ParticipantInfo_State}}),Object.defineProperty(a,"Room",{enumerable:!0,get:function(){return c.Room}}),Object.defineProperty(a,"TrackInfo",{enumerable:!0,get:function(){return c.TrackInfo}}),Object.defineProperty(a,"TrackType",{enumerable:!0,get:function(){return c.TrackType}}),d(RoomServiceClient$1,a)}(dist);function _mergeNamespaces$1(a,s){return s.forEach(function(d){d&&typeof d!="string"&&!Array.isArray(d)&&Object.keys(d).forEach(function(c){if(c!=="default"&&!(c in a)){var l=Object.getOwnPropertyDescriptor(d,c);Object.defineProperty(a,c,l.get?l:{enumerable:!0,get:function(){return d[c]}})}})}),Object.freeze(a)}var commonjsGlobal=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function getDefaultExportFromCjs(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var loglevelExports={},loglevel={get exports(){return loglevelExports},set exports(a){loglevelExports=a}};(function(a){(function(s,d){a.exports?a.exports=d():s.log=d()})(commonjsGlobal,function(){var s=function(){},d="undefined",c=typeof window!==d&&typeof window.navigator!==d&&/Trident\/|MSIE /.test(window.navigator.userAgent),l=["trace","debug","info","warn","error"];function p(P,$){var U=P[$];if(typeof U.bind=="function")return U.bind(P);try{return Function.prototype.bind.call(U,P)}catch{return function(){return Function.prototype.apply.apply(U,[P,arguments])}}}function h(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function v(P){return P==="debug"&&(P="log"),typeof console===d?!1:P==="trace"&&c?h:console[P]!==void 0?p(console,P):console.log!==void 0?p(console,"log"):s}function S(P,$){for(var U=0;U<l.length;U++){var E=l[U];this[E]=U<P?s:this.methodFactory(E,P,$)}this.log=this.debug}function b(P,$,U){return function(){typeof console!==d&&(S.call(this,$,U),this[P].apply(this,arguments))}}function _(P,$,U){return v(P)||b.apply(this,arguments)}function I(P,$,U){var E=this,D;$=$==null?"WARN":$;var F="loglevel";typeof P=="string"?F+=":"+P:typeof P=="symbol"&&(F=void 0);function J(N){var z=(l[N]||"silent").toUpperCase();if(!(typeof window===d||!F)){try{window.localStorage[F]=z;return}catch{}try{window.document.cookie=encodeURIComponent(F)+"="+z+";"}catch{}}}function G(){var N;if(!(typeof window===d||!F)){try{N=window.localStorage[F]}catch{}if(typeof N===d)try{var z=window.document.cookie,Z=z.indexOf(encodeURIComponent(F)+"=");Z!==-1&&(N=/^([^;]+)/.exec(z.slice(Z))[1])}catch{}return E.levels[N]===void 0&&(N=void 0),N}}function x(){if(!(typeof window===d||!F)){try{window.localStorage.removeItem(F);return}catch{}try{window.document.cookie=encodeURIComponent(F)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}E.name=P,E.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},E.methodFactory=U||_,E.getLevel=function(){return D},E.setLevel=function(N,z){if(typeof N=="string"&&E.levels[N.toUpperCase()]!==void 0&&(N=E.levels[N.toUpperCase()]),typeof N=="number"&&N>=0&&N<=E.levels.SILENT){if(D=N,z!==!1&&J(N),S.call(E,N,P),typeof console===d&&N<E.levels.SILENT)return"No console available for logging"}else throw"log.setLevel() called with invalid level: "+N},E.setDefaultLevel=function(N){$=N,G()||E.setLevel(N,!1)},E.resetLevel=function(){E.setLevel($,!1),x()},E.enableAll=function(N){E.setLevel(E.levels.TRACE,N)},E.disableAll=function(N){E.setLevel(E.levels.SILENT,N)};var Y=G();Y==null&&(Y=$),E.setLevel(Y,!1)}var T=new I,k={};T.getLogger=function($){if(typeof $!="symbol"&&typeof $!="string"||$==="")throw new TypeError("You must supply a name when creating a logger.");var U=k[$];return U||(U=k[$]=new I($,T.getLevel(),T.methodFactory)),U};var w=typeof window!==d?window.log:void 0;return T.noConflict=function(){return typeof window!==d&&window.log===T&&(window.log=w),T},T.getLoggers=function(){return k},T.default=T,T})})(loglevel);var LogLevel;(function(a){a[a.trace=0]="trace",a[a.debug=1]="debug",a[a.info=2]="info",a[a.warn=3]="warn",a[a.error=4]="error",a[a.silent=5]="silent"})(LogLevel||(LogLevel={}));const livekitLogger=loglevelExports.getLogger("livekit");livekitLogger.setLevel(LogLevel.info);function setLogLevel(a){livekitLogger.setLevel(a)}var long=Long,wasm=null;try{wasm=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(a){}function Long(a,s,d){this.low=a|0,this.high=s|0,this.unsigned=!!d}Long.prototype.__isLong__,Object.defineProperty(Long.prototype,"__isLong__",{value:!0});function isLong(a){return(a&&a.__isLong__)===!0}Long.isLong=isLong;var INT_CACHE={},UINT_CACHE={};function fromInt(a,s){var d,c,l;return s?(a>>>=0,(l=0<=a&&a<256)&&(c=UINT_CACHE[a],c)?c:(d=fromBits(a,(a|0)<0?-1:0,!0),l&&(UINT_CACHE[a]=d),d)):(a|=0,(l=-128<=a&&a<128)&&(c=INT_CACHE[a],c)?c:(d=fromBits(a,a<0?-1:0,!1),l&&(INT_CACHE[a]=d),d))}Long.fromInt=fromInt;function fromNumber(a,s){if(isNaN(a))return s?UZERO:ZERO;if(s){if(a<0)return UZERO;if(a>=TWO_PWR_64_DBL)return MAX_UNSIGNED_VALUE}else{if(a<=-TWO_PWR_63_DBL)return MIN_VALUE;if(a+1>=TWO_PWR_63_DBL)return MAX_VALUE}return a<0?fromNumber(-a,s).neg():fromBits(a%TWO_PWR_32_DBL|0,a/TWO_PWR_32_DBL|0,s)}Long.fromNumber=fromNumber;function fromBits(a,s,d){return new Long(a,s,d)}Long.fromBits=fromBits;var pow_dbl=Math.pow;function fromString(a,s,d){if(a.length===0)throw Error("empty string");if(a==="NaN"||a==="Infinity"||a==="+Infinity"||a==="-Infinity")return ZERO;if(typeof s=="number"?(d=s,s=!1):s=!!s,d=d||10,d<2||36<d)throw RangeError("radix");var c;if((c=a.indexOf("-"))>0)throw Error("interior hyphen");if(c===0)return fromString(a.substring(1),s,d).neg();for(var l=fromNumber(pow_dbl(d,8)),p=ZERO,h=0;h<a.length;h+=8){var v=Math.min(8,a.length-h),S=parseInt(a.substring(h,h+v),d);if(v<8){var b=fromNumber(pow_dbl(d,v));p=p.mul(b).add(fromNumber(S))}else p=p.mul(l),p=p.add(fromNumber(S))}return p.unsigned=s,p}Long.fromString=fromString;function fromValue(a,s){return typeof a=="number"?fromNumber(a,s):typeof a=="string"?fromString(a,s):fromBits(a.low,a.high,typeof s=="boolean"?s:a.unsigned)}Long.fromValue=fromValue;var TWO_PWR_16_DBL=1<<16,TWO_PWR_24_DBL=1<<24,TWO_PWR_32_DBL=TWO_PWR_16_DBL*TWO_PWR_16_DBL,TWO_PWR_64_DBL=TWO_PWR_32_DBL*TWO_PWR_32_DBL,TWO_PWR_63_DBL=TWO_PWR_64_DBL/2,TWO_PWR_24=fromInt(TWO_PWR_24_DBL),ZERO=fromInt(0);Long.ZERO=ZERO;var UZERO=fromInt(0,!0);Long.UZERO=UZERO;var ONE=fromInt(1);Long.ONE=ONE;var UONE=fromInt(1,!0);Long.UONE=UONE;var NEG_ONE=fromInt(-1);Long.NEG_ONE=NEG_ONE;var MAX_VALUE=fromBits(-1,2147483647,!1);Long.MAX_VALUE=MAX_VALUE;var MAX_UNSIGNED_VALUE=fromBits(-1,-1,!0);Long.MAX_UNSIGNED_VALUE=MAX_UNSIGNED_VALUE;var MIN_VALUE=fromBits(0,-2147483648,!1);Long.MIN_VALUE=MIN_VALUE;var LongPrototype=Long.prototype;LongPrototype.toInt=function a(){return this.unsigned?this.low>>>0:this.low},LongPrototype.toNumber=function a(){return this.unsigned?(this.high>>>0)*TWO_PWR_32_DBL+(this.low>>>0):this.high*TWO_PWR_32_DBL+(this.low>>>0)},LongPrototype.toString=function a(s){if(s=s||10,s<2||36<s)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(MIN_VALUE)){var d=fromNumber(s),c=this.div(d),l=c.mul(d).sub(this);return c.toString(s)+l.toInt().toString(s)}else return"-"+this.neg().toString(s);for(var p=fromNumber(pow_dbl(s,6),this.unsigned),h=this,v="";;){var S=h.div(p),b=h.sub(S.mul(p)).toInt()>>>0,_=b.toString(s);if(h=S,h.isZero())return _+v;for(;_.length<6;)_="0"+_;v=""+_+v}},LongPrototype.getHighBits=function a(){return this.high},LongPrototype.getHighBitsUnsigned=function a(){return this.high>>>0},LongPrototype.getLowBits=function a(){return this.low},LongPrototype.getLowBitsUnsigned=function a(){return this.low>>>0},LongPrototype.getNumBitsAbs=function a(){if(this.isNegative())return this.eq(MIN_VALUE)?64:this.neg().getNumBitsAbs();for(var s=this.high!=0?this.high:this.low,d=31;d>0&&(s&1<<d)==0;d--);return this.high!=0?d+33:d+1},LongPrototype.isZero=function a(){return this.high===0&&this.low===0},LongPrototype.eqz=LongPrototype.isZero,LongPrototype.isNegative=function a(){return!this.unsigned&&this.high<0},LongPrototype.isPositive=function a(){return this.unsigned||this.high>=0},LongPrototype.isOdd=function a(){return(this.low&1)===1},LongPrototype.isEven=function a(){return(this.low&1)===0},LongPrototype.equals=function a(s){return isLong(s)||(s=fromValue(s)),this.unsigned!==s.unsigned&&this.high>>>31===1&&s.high>>>31===1?!1:this.high===s.high&&this.low===s.low},LongPrototype.eq=LongPrototype.equals,LongPrototype.notEquals=function a(s){return!this.eq(s)},LongPrototype.neq=LongPrototype.notEquals,LongPrototype.ne=LongPrototype.notEquals,LongPrototype.lessThan=function a(s){return this.comp(s)<0},LongPrototype.lt=LongPrototype.lessThan,LongPrototype.lessThanOrEqual=function a(s){return this.comp(s)<=0},LongPrototype.lte=LongPrototype.lessThanOrEqual,LongPrototype.le=LongPrototype.lessThanOrEqual,LongPrototype.greaterThan=function a(s){return this.comp(s)>0},LongPrototype.gt=LongPrototype.greaterThan,LongPrototype.greaterThanOrEqual=function a(s){return this.comp(s)>=0},LongPrototype.gte=LongPrototype.greaterThanOrEqual,LongPrototype.ge=LongPrototype.greaterThanOrEqual,LongPrototype.compare=function a(s){if(isLong(s)||(s=fromValue(s)),this.eq(s))return 0;var d=this.isNegative(),c=s.isNegative();return d&&!c?-1:!d&&c?1:this.unsigned?s.high>>>0>this.high>>>0||s.high===this.high&&s.low>>>0>this.low>>>0?-1:1:this.sub(s).isNegative()?-1:1},LongPrototype.comp=LongPrototype.compare,LongPrototype.negate=function a(){return!this.unsigned&&this.eq(MIN_VALUE)?MIN_VALUE:this.not().add(ONE)},LongPrototype.neg=LongPrototype.negate,LongPrototype.add=function a(s){isLong(s)||(s=fromValue(s));var d=this.high>>>16,c=this.high&65535,l=this.low>>>16,p=this.low&65535,h=s.high>>>16,v=s.high&65535,S=s.low>>>16,b=s.low&65535,_=0,I=0,T=0,k=0;return k+=p+b,T+=k>>>16,k&=65535,T+=l+S,I+=T>>>16,T&=65535,I+=c+v,_+=I>>>16,I&=65535,_+=d+h,_&=65535,fromBits(T<<16|k,_<<16|I,this.unsigned)},LongPrototype.subtract=function a(s){return isLong(s)||(s=fromValue(s)),this.add(s.neg())},LongPrototype.sub=LongPrototype.subtract,LongPrototype.multiply=function a(s){if(this.isZero())return ZERO;if(isLong(s)||(s=fromValue(s)),wasm){var d=wasm.mul(this.low,this.high,s.low,s.high);return fromBits(d,wasm.get_high(),this.unsigned)}if(s.isZero())return ZERO;if(this.eq(MIN_VALUE))return s.isOdd()?MIN_VALUE:ZERO;if(s.eq(MIN_VALUE))return this.isOdd()?MIN_VALUE:ZERO;if(this.isNegative())return s.isNegative()?this.neg().mul(s.neg()):this.neg().mul(s).neg();if(s.isNegative())return this.mul(s.neg()).neg();if(this.lt(TWO_PWR_24)&&s.lt(TWO_PWR_24))return fromNumber(this.toNumber()*s.toNumber(),this.unsigned);var c=this.high>>>16,l=this.high&65535,p=this.low>>>16,h=this.low&65535,v=s.high>>>16,S=s.high&65535,b=s.low>>>16,_=s.low&65535,I=0,T=0,k=0,w=0;return w+=h*_,k+=w>>>16,w&=65535,k+=p*_,T+=k>>>16,k&=65535,k+=h*b,T+=k>>>16,k&=65535,T+=l*_,I+=T>>>16,T&=65535,T+=p*b,I+=T>>>16,T&=65535,T+=h*S,I+=T>>>16,T&=65535,I+=c*_+l*b+p*S+h*v,I&=65535,fromBits(k<<16|w,I<<16|T,this.unsigned)},LongPrototype.mul=LongPrototype.multiply,LongPrototype.divide=function a(s){if(isLong(s)||(s=fromValue(s)),s.isZero())throw Error("division by zero");if(wasm){if(!this.unsigned&&this.high===-2147483648&&s.low===-1&&s.high===-1)return this;var d=(this.unsigned?wasm.div_u:wasm.div_s)(this.low,this.high,s.low,s.high);return fromBits(d,wasm.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?UZERO:ZERO;var c,l,p;if(this.unsigned){if(s.unsigned||(s=s.toUnsigned()),s.gt(this))return UZERO;if(s.gt(this.shru(1)))return UONE;p=UZERO}else{if(this.eq(MIN_VALUE)){if(s.eq(ONE)||s.eq(NEG_ONE))return MIN_VALUE;if(s.eq(MIN_VALUE))return ONE;var h=this.shr(1);return c=h.div(s).shl(1),c.eq(ZERO)?s.isNegative()?ONE:NEG_ONE:(l=this.sub(s.mul(c)),p=c.add(l.div(s)),p)}else if(s.eq(MIN_VALUE))return this.unsigned?UZERO:ZERO;if(this.isNegative())return s.isNegative()?this.neg().div(s.neg()):this.neg().div(s).neg();if(s.isNegative())return this.div(s.neg()).neg();p=ZERO}for(l=this;l.gte(s);){c=Math.max(1,Math.floor(l.toNumber()/s.toNumber()));for(var v=Math.ceil(Math.log(c)/Math.LN2),S=v<=48?1:pow_dbl(2,v-48),b=fromNumber(c),_=b.mul(s);_.isNegative()||_.gt(l);)c-=S,b=fromNumber(c,this.unsigned),_=b.mul(s);b.isZero()&&(b=ONE),p=p.add(b),l=l.sub(_)}return p},LongPrototype.div=LongPrototype.divide,LongPrototype.modulo=function a(s){if(isLong(s)||(s=fromValue(s)),wasm){var d=(this.unsigned?wasm.rem_u:wasm.rem_s)(this.low,this.high,s.low,s.high);return fromBits(d,wasm.get_high(),this.unsigned)}return this.sub(this.div(s).mul(s))},LongPrototype.mod=LongPrototype.modulo,LongPrototype.rem=LongPrototype.modulo,LongPrototype.not=function a(){return fromBits(~this.low,~this.high,this.unsigned)},LongPrototype.and=function a(s){return isLong(s)||(s=fromValue(s)),fromBits(this.low&s.low,this.high&s.high,this.unsigned)},LongPrototype.or=function a(s){return isLong(s)||(s=fromValue(s)),fromBits(this.low|s.low,this.high|s.high,this.unsigned)},LongPrototype.xor=function a(s){return isLong(s)||(s=fromValue(s)),fromBits(this.low^s.low,this.high^s.high,this.unsigned)},LongPrototype.shiftLeft=function a(s){return isLong(s)&&(s=s.toInt()),(s&=63)===0?this:s<32?fromBits(this.low<<s,this.high<<s|this.low>>>32-s,this.unsigned):fromBits(0,this.low<<s-32,this.unsigned)},LongPrototype.shl=LongPrototype.shiftLeft,LongPrototype.shiftRight=function a(s){return isLong(s)&&(s=s.toInt()),(s&=63)===0?this:s<32?fromBits(this.low>>>s|this.high<<32-s,this.high>>s,this.unsigned):fromBits(this.high>>s-32,this.high>=0?0:-1,this.unsigned)},LongPrototype.shr=LongPrototype.shiftRight,LongPrototype.shiftRightUnsigned=function a(s){if(isLong(s)&&(s=s.toInt()),s&=63,s===0)return this;var d=this.high;if(s<32){var c=this.low;return fromBits(c>>>s|d<<32-s,d>>>s,this.unsigned)}else return s===32?fromBits(d,0,this.unsigned):fromBits(d>>>s-32,0,this.unsigned)},LongPrototype.shru=LongPrototype.shiftRightUnsigned,LongPrototype.shr_u=LongPrototype.shiftRightUnsigned,LongPrototype.toSigned=function a(){return this.unsigned?fromBits(this.low,this.high,!1):this},LongPrototype.toUnsigned=function a(){return this.unsigned?this:fromBits(this.low,this.high,!0)},LongPrototype.toBytes=function a(s){return s?this.toBytesLE():this.toBytesBE()},LongPrototype.toBytesLE=function a(){var s=this.high,d=this.low;return[d&255,d>>>8&255,d>>>16&255,d>>>24,s&255,s>>>8&255,s>>>16&255,s>>>24]},LongPrototype.toBytesBE=function a(){var s=this.high,d=this.low;return[s>>>24,s>>>16&255,s>>>8&255,s&255,d>>>24,d>>>16&255,d>>>8&255,d&255]},Long.fromBytes=function a(s,d,c){return c?Long.fromBytesLE(s,d):Long.fromBytesBE(s,d)},Long.fromBytesLE=function a(s,d){return new Long(s[0]|s[1]<<8|s[2]<<16|s[3]<<24,s[4]|s[5]<<8|s[6]<<16|s[7]<<24,d)},Long.fromBytesBE=function a(s,d){return new Long(s[4]<<24|s[5]<<16|s[6]<<8|s[7],s[0]<<24|s[1]<<16|s[2]<<8|s[3],d)};var minimalExports={},minimal$1={get exports(){return minimalExports},set exports(a){minimalExports=a}},indexMinimal={},minimal={},aspromise,hasRequiredAspromise;function requireAspromise(){if(hasRequiredAspromise)return aspromise;hasRequiredAspromise=1,aspromise=a;function a(s,d){for(var c=new Array(arguments.length-1),l=0,p=2,h=!0;p<arguments.length;)c[l++]=arguments[p++];return new Promise(function(S,b){c[l]=function(I){if(h)if(h=!1,I)b(I);else{for(var T=new Array(arguments.length-1),k=0;k<T.length;)T[k++]=arguments[k];S.apply(null,T)}};try{s.apply(d||null,c)}catch(_){h&&(h=!1,b(_))}})}return aspromise}var base64$1={},hasRequiredBase64;function requireBase64(){return hasRequiredBase64||(hasRequiredBase64=1,function(a){var s=a;s.length=function(v){var S=v.length;if(!S)return 0;for(var b=0;--S%4>1&&v.charAt(S)==="=";)++b;return Math.ceil(v.length*3)/4-b};for(var d=new Array(64),c=new Array(123),l=0;l<64;)c[d[l]=l<26?l+65:l<52?l+71:l<62?l-4:l-59|43]=l++;s.encode=function(v,S,b){for(var _=null,I=[],T=0,k=0,w;S<b;){var P=v[S++];switch(k){case 0:I[T++]=d[P>>2],w=(P&3)<<4,k=1;break;case 1:I[T++]=d[w|P>>4],w=(P&15)<<2,k=2;break;case 2:I[T++]=d[w|P>>6],I[T++]=d[P&63],k=0;break}T>8191&&((_||(_=[])).push(String.fromCharCode.apply(String,I)),T=0)}return k&&(I[T++]=d[w],I[T++]=61,k===1&&(I[T++]=61)),_?(T&&_.push(String.fromCharCode.apply(String,I.slice(0,T))),_.join("")):String.fromCharCode.apply(String,I.slice(0,T))};var p="invalid encoding";s.decode=function(v,S,b){for(var _=b,I=0,T,k=0;k<v.length;){var w=v.charCodeAt(k++);if(w===61&&I>1)break;if((w=c[w])===void 0)throw Error(p);switch(I){case 0:T=w,I=1;break;case 1:S[b++]=T<<2|(w&48)>>4,T=w,I=2;break;case 2:S[b++]=(T&15)<<4|(w&60)>>2,T=w,I=3;break;case 3:S[b++]=(T&3)<<6|w,I=0;break}}if(I===1)throw Error(p);return b-_},s.test=function(v){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(v)}}(base64$1)),base64$1}var eventemitter,hasRequiredEventemitter;function requireEventemitter(){if(hasRequiredEventemitter)return eventemitter;hasRequiredEventemitter=1,eventemitter=a;function a(){this._listeners={}}return a.prototype.on=function(d,c,l){return(this._listeners[d]||(this._listeners[d]=[])).push({fn:c,ctx:l||this}),this},a.prototype.off=function(d,c){if(d===void 0)this._listeners={};else if(c===void 0)this._listeners[d]=[];else for(var l=this._listeners[d],p=0;p<l.length;)l[p].fn===c?l.splice(p,1):++p;return this},a.prototype.emit=function(d){var c=this._listeners[d];if(c){for(var l=[],p=1;p<arguments.length;)l.push(arguments[p++]);for(p=0;p<c.length;)c[p].fn.apply(c[p++].ctx,l)}return this},eventemitter}var float,hasRequiredFloat;function requireFloat(){if(hasRequiredFloat)return float;hasRequiredFloat=1,float=a(a);function a(p){return typeof Float32Array!="undefined"?function(){var h=new Float32Array([-0]),v=new Uint8Array(h.buffer),S=v[3]===128;function b(k,w,P){h[0]=k,w[P]=v[0],w[P+1]=v[1],w[P+2]=v[2],w[P+3]=v[3]}function _(k,w,P){h[0]=k,w[P]=v[3],w[P+1]=v[2],w[P+2]=v[1],w[P+3]=v[0]}p.writeFloatLE=S?b:_,p.writeFloatBE=S?_:b;function I(k,w){return v[0]=k[w],v[1]=k[w+1],v[2]=k[w+2],v[3]=k[w+3],h[0]}function T(k,w){return v[3]=k[w],v[2]=k[w+1],v[1]=k[w+2],v[0]=k[w+3],h[0]}p.readFloatLE=S?I:T,p.readFloatBE=S?T:I}():function(){function h(S,b,_,I){var T=b<0?1:0;if(T&&(b=-b),b===0)S(1/b>0?0:2147483648,_,I);else if(isNaN(b))S(2143289344,_,I);else if(b>34028234663852886e22)S((T<<31|2139095040)>>>0,_,I);else if(b<11754943508222875e-54)S((T<<31|Math.round(b/1401298464324817e-60))>>>0,_,I);else{var k=Math.floor(Math.log(b)/Math.LN2),w=Math.round(b*Math.pow(2,-k)*8388608)&8388607;S((T<<31|k+127<<23|w)>>>0,_,I)}}p.writeFloatLE=h.bind(null,s),p.writeFloatBE=h.bind(null,d);function v(S,b,_){var I=S(b,_),T=(I>>31)*2+1,k=I>>>23&255,w=I&8388607;return k===255?w?NaN:T*(1/0):k===0?T*1401298464324817e-60*w:T*Math.pow(2,k-150)*(w+8388608)}p.readFloatLE=v.bind(null,c),p.readFloatBE=v.bind(null,l)}(),typeof Float64Array!="undefined"?function(){var h=new Float64Array([-0]),v=new Uint8Array(h.buffer),S=v[7]===128;function b(k,w,P){h[0]=k,w[P]=v[0],w[P+1]=v[1],w[P+2]=v[2],w[P+3]=v[3],w[P+4]=v[4],w[P+5]=v[5],w[P+6]=v[6],w[P+7]=v[7]}function _(k,w,P){h[0]=k,w[P]=v[7],w[P+1]=v[6],w[P+2]=v[5],w[P+3]=v[4],w[P+4]=v[3],w[P+5]=v[2],w[P+6]=v[1],w[P+7]=v[0]}p.writeDoubleLE=S?b:_,p.writeDoubleBE=S?_:b;function I(k,w){return v[0]=k[w],v[1]=k[w+1],v[2]=k[w+2],v[3]=k[w+3],v[4]=k[w+4],v[5]=k[w+5],v[6]=k[w+6],v[7]=k[w+7],h[0]}function T(k,w){return v[7]=k[w],v[6]=k[w+1],v[5]=k[w+2],v[4]=k[w+3],v[3]=k[w+4],v[2]=k[w+5],v[1]=k[w+6],v[0]=k[w+7],h[0]}p.readDoubleLE=S?I:T,p.readDoubleBE=S?T:I}():function(){function h(S,b,_,I,T,k){var w=I<0?1:0;if(w&&(I=-I),I===0)S(0,T,k+b),S(1/I>0?0:2147483648,T,k+_);else if(isNaN(I))S(0,T,k+b),S(2146959360,T,k+_);else if(I>17976931348623157e292)S(0,T,k+b),S((w<<31|2146435072)>>>0,T,k+_);else{var P;if(I<22250738585072014e-324)P=I/5e-324,S(P>>>0,T,k+b),S((w<<31|P/4294967296)>>>0,T,k+_);else{var $=Math.floor(Math.log(I)/Math.LN2);$===1024&&($=1023),P=I*Math.pow(2,-$),S(P*4503599627370496>>>0,T,k+b),S((w<<31|$+1023<<20|P*1048576&1048575)>>>0,T,k+_)}}}p.writeDoubleLE=h.bind(null,s,0,4),p.writeDoubleBE=h.bind(null,d,4,0);function v(S,b,_,I,T){var k=S(I,T+b),w=S(I,T+_),P=(w>>31)*2+1,$=w>>>20&2047,U=4294967296*(w&1048575)+k;return $===2047?U?NaN:P*(1/0):$===0?P*5e-324*U:P*Math.pow(2,$-1075)*(U+4503599627370496)}p.readDoubleLE=v.bind(null,c,0,4),p.readDoubleBE=v.bind(null,l,4,0)}(),p}function s(p,h,v){h[v]=p&255,h[v+1]=p>>>8&255,h[v+2]=p>>>16&255,h[v+3]=p>>>24}function d(p,h,v){h[v]=p>>>24,h[v+1]=p>>>16&255,h[v+2]=p>>>8&255,h[v+3]=p&255}function c(p,h){return(p[h]|p[h+1]<<8|p[h+2]<<16|p[h+3]<<24)>>>0}function l(p,h){return(p[h]<<24|p[h+1]<<16|p[h+2]<<8|p[h+3])>>>0}return float}var inquire_1,hasRequiredInquire;function requireInquire(){if(hasRequiredInquire)return inquire_1;hasRequiredInquire=1,inquire_1=a;function a(s){try{var d=void 0;if(d&&(d.length||Object.keys(d).length))return d}catch{}return null}return inquire_1}var utf8$2={},hasRequiredUtf8;function requireUtf8(){return hasRequiredUtf8||(hasRequiredUtf8=1,function(a){var s=a;s.length=function(c){for(var l=0,p=0,h=0;h<c.length;++h)p=c.charCodeAt(h),p<128?l+=1:p<2048?l+=2:(p&64512)===55296&&(c.charCodeAt(h+1)&64512)===56320?(++h,l+=4):l+=3;return l},s.read=function(c,l,p){var h=p-l;if(h<1)return"";for(var v=null,S=[],b=0,_;l<p;)_=c[l++],_<128?S[b++]=_:_>191&&_<224?S[b++]=(_&31)<<6|c[l++]&63:_>239&&_<365?(_=((_&7)<<18|(c[l++]&63)<<12|(c[l++]&63)<<6|c[l++]&63)-65536,S[b++]=55296+(_>>10),S[b++]=56320+(_&1023)):S[b++]=(_&15)<<12|(c[l++]&63)<<6|c[l++]&63,b>8191&&((v||(v=[])).push(String.fromCharCode.apply(String,S)),b=0);return v?(b&&v.push(String.fromCharCode.apply(String,S.slice(0,b))),v.join("")):String.fromCharCode.apply(String,S.slice(0,b))},s.write=function(c,l,p){for(var h=p,v,S,b=0;b<c.length;++b)v=c.charCodeAt(b),v<128?l[p++]=v:v<2048?(l[p++]=v>>6|192,l[p++]=v&63|128):(v&64512)===55296&&((S=c.charCodeAt(b+1))&64512)===56320?(v=65536+((v&1023)<<10)+(S&1023),++b,l[p++]=v>>18|240,l[p++]=v>>12&63|128,l[p++]=v>>6&63|128,l[p++]=v&63|128):(l[p++]=v>>12|224,l[p++]=v>>6&63|128,l[p++]=v&63|128);return p-h}}(utf8$2)),utf8$2}var pool_1,hasRequiredPool;function requirePool(){if(hasRequiredPool)return pool_1;hasRequiredPool=1,pool_1=a;function a(s,d,c){var l=c||8192,p=l>>>1,h=null,v=l;return function(b){if(b<1||b>p)return s(b);v+b>l&&(h=s(l),v=0);var _=d.call(h,v,v+=b);return v&7&&(v=(v|7)+1),_}}return pool_1}var longbits,hasRequiredLongbits;function requireLongbits(){if(hasRequiredLongbits)return longbits;hasRequiredLongbits=1,longbits=s;var a=requireMinimal();function s(p,h){this.lo=p>>>0,this.hi=h>>>0}var d=s.zero=new s(0,0);d.toNumber=function(){return 0},d.zzEncode=d.zzDecode=function(){return this},d.length=function(){return 1};var c=s.zeroHash="\0\0\0\0\0\0\0\0";s.fromNumber=function(h){if(h===0)return d;var v=h<0;v&&(h=-h);var S=h>>>0,b=(h-S)/4294967296>>>0;return v&&(b=~b>>>0,S=~S>>>0,++S>4294967295&&(S=0,++b>4294967295&&(b=0))),new s(S,b)},s.from=function(h){if(typeof h=="number")return s.fromNumber(h);if(a.isString(h))if(a.Long)h=a.Long.fromString(h);else return s.fromNumber(parseInt(h,10));return h.low||h.high?new s(h.low>>>0,h.high>>>0):d},s.prototype.toNumber=function(h){if(!h&&this.hi>>>31){var v=~this.lo+1>>>0,S=~this.hi>>>0;return v||(S=S+1>>>0),-(v+S*4294967296)}return this.lo+this.hi*4294967296},s.prototype.toLong=function(h){return a.Long?new a.Long(this.lo|0,this.hi|0,Boolean(h)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(h)}};var l=String.prototype.charCodeAt;return s.fromHash=function(h){return h===c?d:new s((l.call(h,0)|l.call(h,1)<<8|l.call(h,2)<<16|l.call(h,3)<<24)>>>0,(l.call(h,4)|l.call(h,5)<<8|l.call(h,6)<<16|l.call(h,7)<<24)>>>0)},s.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},s.prototype.zzEncode=function(){var h=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^h)>>>0,this.lo=(this.lo<<1^h)>>>0,this},s.prototype.zzDecode=function(){var h=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^h)>>>0,this.hi=(this.hi>>>1^h)>>>0,this},s.prototype.length=function(){var h=this.lo,v=(this.lo>>>28|this.hi<<4)>>>0,S=this.hi>>>24;return S===0?v===0?h<16384?h<128?1:2:h<2097152?3:4:v<16384?v<128?5:6:v<2097152?7:8:S<128?9:10},longbits}var hasRequiredMinimal;function requireMinimal(){return hasRequiredMinimal||(hasRequiredMinimal=1,function(a){var s=a;s.asPromise=requireAspromise(),s.base64=requireBase64(),s.EventEmitter=requireEventemitter(),s.float=requireFloat(),s.inquire=requireInquire(),s.utf8=requireUtf8(),s.pool=requirePool(),s.LongBits=requireLongbits(),s.isNode=Boolean(typeof commonjsGlobal!="undefined"&&commonjsGlobal&&commonjsGlobal.process&&commonjsGlobal.process.versions&&commonjsGlobal.process.versions.node),s.global=s.isNode&&commonjsGlobal||typeof window!="undefined"&&window||typeof self!="undefined"&&self||commonjsGlobal,s.emptyArray=Object.freeze?Object.freeze([]):[],s.emptyObject=Object.freeze?Object.freeze({}):{},s.isInteger=Number.isInteger||function(p){return typeof p=="number"&&isFinite(p)&&Math.floor(p)===p},s.isString=function(p){return typeof p=="string"||p instanceof String},s.isObject=function(p){return p&&typeof p=="object"},s.isset=s.isSet=function(p,h){var v=p[h];return v!=null&&p.hasOwnProperty(h)?typeof v!="object"||(Array.isArray(v)?v.length:Object.keys(v).length)>0:!1},s.Buffer=function(){try{var l=s.inquire("buffer").Buffer;return l.prototype.utf8Write?l:null}catch{return null}}(),s._Buffer_from=null,s._Buffer_allocUnsafe=null,s.newBuffer=function(p){return typeof p=="number"?s.Buffer?s._Buffer_allocUnsafe(p):new s.Array(p):s.Buffer?s._Buffer_from(p):typeof Uint8Array=="undefined"?p:new Uint8Array(p)},s.Array=typeof Uint8Array!="undefined"?Uint8Array:Array,s.Long=s.global.dcodeIO&&s.global.dcodeIO.Long||s.global.Long||s.inquire("long"),s.key2Re=/^true|false|0|1$/,s.key32Re=/^-?(?:0|[1-9][0-9]*)$/,s.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,s.longToHash=function(p){return p?s.LongBits.from(p).toHash():s.LongBits.zeroHash},s.longFromHash=function(p,h){var v=s.LongBits.fromHash(p);return s.Long?s.Long.fromBits(v.lo,v.hi,h):v.toNumber(Boolean(h))};function d(l,p,h){for(var v=Object.keys(p),S=0;S<v.length;++S)(l[v[S]]===void 0||!h)&&(l[v[S]]=p[v[S]]);return l}s.merge=d,s.lcFirst=function(p){return p.charAt(0).toLowerCase()+p.substring(1)};function c(l){function p(h,v){if(!(this instanceof p))return new p(h,v);Object.defineProperty(this,"message",{get:function(){return h}}),Error.captureStackTrace?Error.captureStackTrace(this,p):Object.defineProperty(this,"stack",{value:new Error().stack||""}),v&&d(this,v)}return p.prototype=Object.create(Error.prototype,{constructor:{value:p,writable:!0,enumerable:!1,configurable:!0},name:{get(){return l},set:void 0,enumerable:!1,configurable:!0},toString:{value(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),p}s.newError=c,s.ProtocolError=c("ProtocolError"),s.oneOfGetter=function(p){for(var h={},v=0;v<p.length;++v)h[p[v]]=1;return function(){for(var S=Object.keys(this),b=S.length-1;b>-1;--b)if(h[S[b]]===1&&this[S[b]]!==void 0&&this[S[b]]!==null)return S[b]}},s.oneOfSetter=function(p){return function(h){for(var v=0;v<p.length;++v)p[v]!==h&&delete this[p[v]]}},s.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},s._configure=function(){var l=s.Buffer;if(!l){s._Buffer_from=s._Buffer_allocUnsafe=null;return}s._Buffer_from=l.from!==Uint8Array.from&&l.from||function(h,v){return new l(h,v)},s._Buffer_allocUnsafe=l.allocUnsafe||function(h){return new l(h)}}}(minimal)),minimal}var writer$2=Writer$1,util$4=requireMinimal(),BufferWriter$1,LongBits$1=util$4.LongBits,base64=util$4.base64,utf8$1=util$4.utf8;function Op(a,s,d){this.fn=a,this.len=s,this.next=void 0,this.val=d}function noop$1(){}function State(a){this.head=a.head,this.tail=a.tail,this.len=a.len,this.next=a.states}function Writer$1(){this.len=0,this.head=new Op(noop$1,0,0),this.tail=this.head,this.states=null}var create$1$1=function a(){return util$4.Buffer?function(){return(Writer$1.create=function(){return new BufferWriter$1})()}:function(){return new Writer$1}};Writer$1.create=create$1$1(),Writer$1.alloc=function a(s){return new util$4.Array(s)},util$4.Array!==Array&&(Writer$1.alloc=util$4.pool(Writer$1.alloc,util$4.Array.prototype.subarray)),Writer$1.prototype._push=function a(s,d,c){return this.tail=this.tail.next=new Op(s,d,c),this.len+=d,this};function writeByte(a,s,d){s[d]=a&255}function writeVarint32(a,s,d){for(;a>127;)s[d++]=a&127|128,a>>>=7;s[d]=a}function VarintOp(a,s){this.len=a,this.next=void 0,this.val=s}VarintOp.prototype=Object.create(Op.prototype),VarintOp.prototype.fn=writeVarint32,Writer$1.prototype.uint32=function a(s){return this.len+=(this.tail=this.tail.next=new VarintOp((s=s>>>0)<128?1:s<16384?2:s<2097152?3:s<268435456?4:5,s)).len,this},Writer$1.prototype.int32=function a(s){return s<0?this._push(writeVarint64,10,LongBits$1.fromNumber(s)):this.uint32(s)},Writer$1.prototype.sint32=function a(s){return this.uint32((s<<1^s>>31)>>>0)};function writeVarint64(a,s,d){for(;a.hi;)s[d++]=a.lo&127|128,a.lo=(a.lo>>>7|a.hi<<25)>>>0,a.hi>>>=7;for(;a.lo>127;)s[d++]=a.lo&127|128,a.lo=a.lo>>>7;s[d++]=a.lo}Writer$1.prototype.uint64=function a(s){var d=LongBits$1.from(s);return this._push(writeVarint64,d.length(),d)},Writer$1.prototype.int64=Writer$1.prototype.uint64,Writer$1.prototype.sint64=function a(s){var d=LongBits$1.from(s).zzEncode();return this._push(writeVarint64,d.length(),d)},Writer$1.prototype.bool=function a(s){return this._push(writeByte,1,s?1:0)};function writeFixed32(a,s,d){s[d]=a&255,s[d+1]=a>>>8&255,s[d+2]=a>>>16&255,s[d+3]=a>>>24}Writer$1.prototype.fixed32=function a(s){return this._push(writeFixed32,4,s>>>0)},Writer$1.prototype.sfixed32=Writer$1.prototype.fixed32,Writer$1.prototype.fixed64=function a(s){var d=LongBits$1.from(s);return this._push(writeFixed32,4,d.lo)._push(writeFixed32,4,d.hi)},Writer$1.prototype.sfixed64=Writer$1.prototype.fixed64,Writer$1.prototype.float=function a(s){return this._push(util$4.float.writeFloatLE,4,s)},Writer$1.prototype.double=function a(s){return this._push(util$4.float.writeDoubleLE,8,s)};var writeBytes=util$4.Array.prototype.set?function a(s,d,c){d.set(s,c)}:function a(s,d,c){for(var l=0;l<s.length;++l)d[c+l]=s[l]};Writer$1.prototype.bytes=function a(s){var d=s.length>>>0;if(!d)return this._push(writeByte,1,0);if(util$4.isString(s)){var c=Writer$1.alloc(d=base64.length(s));base64.decode(s,c,0),s=c}return this.uint32(d)._push(writeBytes,d,s)},Writer$1.prototype.string=function a(s){var d=utf8$1.length(s);return d?this.uint32(d)._push(utf8$1.write,d,s):this._push(writeByte,1,0)},Writer$1.prototype.fork=function a(){return this.states=new State(this),this.head=this.tail=new Op(noop$1,0,0),this.len=0,this},Writer$1.prototype.reset=function a(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Op(noop$1,0,0),this.len=0),this},Writer$1.prototype.ldelim=function a(){var s=this.head,d=this.tail,c=this.len;return this.reset().uint32(c),c&&(this.tail.next=s.next,this.tail=d,this.len+=c),this},Writer$1.prototype.finish=function a(){for(var s=this.head.next,d=this.constructor.alloc(this.len),c=0;s;)s.fn(s.val,d,c),c+=s.len,s=s.next;return d},Writer$1._configure=function(a){BufferWriter$1=a,Writer$1.create=create$1$1(),BufferWriter$1._configure()};var writer_buffer=BufferWriter,Writer=writer$2;(BufferWriter.prototype=Object.create(Writer.prototype)).constructor=BufferWriter;var util$3=requireMinimal();function BufferWriter(){Writer.call(this)}BufferWriter._configure=function(){BufferWriter.alloc=util$3._Buffer_allocUnsafe,BufferWriter.writeBytesBuffer=util$3.Buffer&&util$3.Buffer.prototype instanceof Uint8Array&&util$3.Buffer.prototype.set.name==="set"?function(s,d,c){d.set(s,c)}:function(s,d,c){if(s.copy)s.copy(d,c,0,s.length);else for(var l=0;l<s.length;)d[c++]=s[l++]}},BufferWriter.prototype.bytes=function a(s){util$3.isString(s)&&(s=util$3._Buffer_from(s,"base64"));var d=s.length>>>0;return this.uint32(d),d&&this._push(BufferWriter.writeBytesBuffer,d,s),this};function writeStringBuffer(a,s,d){a.length<40?util$3.utf8.write(a,s,d):s.utf8Write?s.utf8Write(a,d):s.write(a,d)}BufferWriter.prototype.string=function a(s){var d=util$3.Buffer.byteLength(s);return this.uint32(d),d&&this._push(writeStringBuffer,d,s),this},BufferWriter._configure();var reader=Reader$1,util$2=requireMinimal(),BufferReader$1,LongBits=util$2.LongBits,utf8=util$2.utf8;function indexOutOfRange(a,s){return RangeError("index out of range: "+a.pos+" + "+(s||1)+" > "+a.len)}function Reader$1(a){this.buf=a,this.pos=0,this.len=a.length}var create_array=typeof Uint8Array!="undefined"?function a(s){if(s instanceof Uint8Array||Array.isArray(s))return new Reader$1(s);throw Error("illegal buffer")}:function a(s){if(Array.isArray(s))return new Reader$1(s);throw Error("illegal buffer")},create$2=function a(){return util$2.Buffer?function(d){return(Reader$1.create=function(l){return util$2.Buffer.isBuffer(l)?new BufferReader$1(l):create_array(l)})(d)}:create_array};Reader$1.create=create$2(),Reader$1.prototype._slice=util$2.Array.prototype.subarray||util$2.Array.prototype.slice,Reader$1.prototype.uint32=function a(){var s=4294967295;return function(){if(s=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(s=(s|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(s=(s|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(s=(s|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(s=(s|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return s;if((this.pos+=5)>this.len)throw this.pos=this.len,indexOutOfRange(this,10);return s}}(),Reader$1.prototype.int32=function a(){return this.uint32()|0},Reader$1.prototype.sint32=function a(){var s=this.uint32();return s>>>1^-(s&1)|0};function readLongVarint(){var a=new LongBits(0,0),s=0;if(this.len-this.pos>4){for(;s<4;++s)if(a.lo=(a.lo|(this.buf[this.pos]&127)<<s*7)>>>0,this.buf[this.pos++]<128)return a;if(a.lo=(a.lo|(this.buf[this.pos]&127)<<28)>>>0,a.hi=(a.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return a;s=0}else{for(;s<3;++s){if(this.pos>=this.len)throw indexOutOfRange(this);if(a.lo=(a.lo|(this.buf[this.pos]&127)<<s*7)>>>0,this.buf[this.pos++]<128)return a}return a.lo=(a.lo|(this.buf[this.pos++]&127)<<s*7)>>>0,a}if(this.len-this.pos>4){for(;s<5;++s)if(a.hi=(a.hi|(this.buf[this.pos]&127)<<s*7+3)>>>0,this.buf[this.pos++]<128)return a}else for(;s<5;++s){if(this.pos>=this.len)throw indexOutOfRange(this);if(a.hi=(a.hi|(this.buf[this.pos]&127)<<s*7+3)>>>0,this.buf[this.pos++]<128)return a}throw Error("invalid varint encoding")}Reader$1.prototype.bool=function a(){return this.uint32()!==0};function readFixed32_end(a,s){return(a[s-4]|a[s-3]<<8|a[s-2]<<16|a[s-1]<<24)>>>0}Reader$1.prototype.fixed32=function a(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)},Reader$1.prototype.sfixed32=function a(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)|0};function readFixed64(){if(this.pos+8>this.len)throw indexOutOfRange(this,8);return new LongBits(readFixed32_end(this.buf,this.pos+=4),readFixed32_end(this.buf,this.pos+=4))}Reader$1.prototype.float=function a(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);var s=util$2.float.readFloatLE(this.buf,this.pos);return this.pos+=4,s},Reader$1.prototype.double=function a(){if(this.pos+8>this.len)throw indexOutOfRange(this,4);var s=util$2.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,s},Reader$1.prototype.bytes=function a(){var s=this.uint32(),d=this.pos,c=this.pos+s;if(c>this.len)throw indexOutOfRange(this,s);return this.pos+=s,Array.isArray(this.buf)?this.buf.slice(d,c):d===c?new this.buf.constructor(0):this._slice.call(this.buf,d,c)},Reader$1.prototype.string=function a(){var s=this.bytes();return utf8.read(s,0,s.length)},Reader$1.prototype.skip=function a(s){if(typeof s=="number"){if(this.pos+s>this.len)throw indexOutOfRange(this,s);this.pos+=s}else do if(this.pos>=this.len)throw indexOutOfRange(this);while(this.buf[this.pos++]&128);return this},Reader$1.prototype.skipType=function(a){switch(a){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(a=this.uint32()&7)!==4;)this.skipType(a);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+a+" at offset "+this.pos)}return this},Reader$1._configure=function(a){BufferReader$1=a,Reader$1.create=create$2(),BufferReader$1._configure();var s=util$2.Long?"toLong":"toNumber";util$2.merge(Reader$1.prototype,{int64:function(){return readLongVarint.call(this)[s](!1)},uint64:function(){return readLongVarint.call(this)[s](!0)},sint64:function(){return readLongVarint.call(this).zzDecode()[s](!1)},fixed64:function(){return readFixed64.call(this)[s](!0)},sfixed64:function(){return readFixed64.call(this)[s](!1)}})};var reader_buffer=BufferReader,Reader=reader;(BufferReader.prototype=Object.create(Reader.prototype)).constructor=BufferReader;var util$1=requireMinimal();function BufferReader(a){Reader.call(this,a)}BufferReader._configure=function(){util$1.Buffer&&(BufferReader.prototype._slice=util$1.Buffer.prototype.slice)},BufferReader.prototype.string=function a(){var s=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+s,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+s,this.len))},BufferReader._configure();var rpc={},service=Service,util=requireMinimal();(Service.prototype=Object.create(util.EventEmitter.prototype)).constructor=Service;function Service(a,s,d){if(typeof a!="function")throw TypeError("rpcImpl must be a function");util.EventEmitter.call(this),this.rpcImpl=a,this.requestDelimited=Boolean(s),this.responseDelimited=Boolean(d)}Service.prototype.rpcCall=function a(s,d,c,l,p){if(!l)throw TypeError("request must be specified");var h=this;if(!p)return util.asPromise(a,h,s,d,c,l);if(!h.rpcImpl){setTimeout(function(){p(Error("already ended"))},0);return}try{return h.rpcImpl(s,d[h.requestDelimited?"encodeDelimited":"encode"](l).finish(),function(S,b){if(S)return h.emit("error",S,s),p(S);if(b===null){h.end(!0);return}if(!(b instanceof c))try{b=c[h.responseDelimited?"decodeDelimited":"decode"](b)}catch(_){return h.emit("error",_,s),p(_)}return h.emit("data",b,s),p(null,b)})}catch(v){h.emit("error",v,s),setTimeout(function(){p(v)},0);return}},Service.prototype.end=function a(s){return this.rpcImpl&&(s||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this},function(a){var s=a;s.Service=service}(rpc);var roots={};(function(a){var s=a;s.build="minimal",s.Writer=writer$2,s.BufferWriter=writer_buffer,s.Reader=reader,s.BufferReader=reader_buffer,s.util=requireMinimal(),s.rpc=rpc,s.roots=roots,s.configure=d;function d(){s.util._configure(),s.Writer._configure(s.BufferWriter),s.Reader._configure(s.BufferReader)}d()})(indexMinimal),function(a){a.exports=indexMinimal}(minimal$1);var _m0=getDefaultExportFromCjs(minimalExports);(()=>{if(typeof globalThis!="undefined")return globalThis;if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global;throw"Unable to locate global object"})(),_m0.util.Long!==long&&(_m0.util.Long=long,_m0.configure());var TrackType;(function(a){a[a.AUDIO=0]="AUDIO",a[a.VIDEO=1]="VIDEO",a[a.DATA=2]="DATA",a[a.UNRECOGNIZED=-1]="UNRECOGNIZED"})(TrackType||(TrackType={}));function trackTypeFromJSON(a){switch(a){case 0:case"AUDIO":return TrackType.AUDIO;case 1:case"VIDEO":return TrackType.VIDEO;case 2:case"DATA":return TrackType.DATA;case-1:case"UNRECOGNIZED":default:return TrackType.UNRECOGNIZED}}function trackTypeToJSON(a){switch(a){case TrackType.AUDIO:return"AUDIO";case TrackType.VIDEO:return"VIDEO";case TrackType.DATA:return"DATA";case TrackType.UNRECOGNIZED:default:return"UNRECOGNIZED"}}var TrackSource;(function(a){a[a.UNKNOWN=0]="UNKNOWN",a[a.CAMERA=1]="CAMERA",a[a.MICROPHONE=2]="MICROPHONE",a[a.SCREEN_SHARE=3]="SCREEN_SHARE",a[a.SCREEN_SHARE_AUDIO=4]="SCREEN_SHARE_AUDIO",a[a.UNRECOGNIZED=-1]="UNRECOGNIZED"})(TrackSource||(TrackSource={}));function trackSourceFromJSON(a){switch(a){case 0:case"UNKNOWN":return TrackSource.UNKNOWN;case 1:case"CAMERA":return TrackSource.CAMERA;case 2:case"MICROPHONE":return TrackSource.MICROPHONE;case 3:case"SCREEN_SHARE":return TrackSource.SCREEN_SHARE;case 4:case"SCREEN_SHARE_AUDIO":return TrackSource.SCREEN_SHARE_AUDIO;case-1:case"UNRECOGNIZED":default:return TrackSource.UNRECOGNIZED}}function trackSourceToJSON(a){switch(a){case TrackSource.UNKNOWN:return"UNKNOWN";case TrackSource.CAMERA:return"CAMERA";case TrackSource.MICROPHONE:return"MICROPHONE";case TrackSource.SCREEN_SHARE:return"SCREEN_SHARE";case TrackSource.SCREEN_SHARE_AUDIO:return"SCREEN_SHARE_AUDIO";case TrackSource.UNRECOGNIZED:default:return"UNRECOGNIZED"}}var VideoQuality;(function(a){a[a.LOW=0]="LOW",a[a.MEDIUM=1]="MEDIUM",a[a.HIGH=2]="HIGH",a[a.OFF=3]="OFF",a[a.UNRECOGNIZED=-1]="UNRECOGNIZED"})(VideoQuality||(VideoQuality={}));function videoQualityFromJSON(a){switch(a){case 0:case"LOW":return VideoQuality.LOW;case 1:case"MEDIUM":return VideoQuality.MEDIUM;case 2:case"HIGH":return VideoQuality.HIGH;case 3:case"OFF":return VideoQuality.OFF;case-1:case"UNRECOGNIZED":default:return VideoQuality.UNRECOGNIZED}}function videoQualityToJSON(a){switch(a){case VideoQuality.LOW:return"LOW";case VideoQuality.MEDIUM:return"MEDIUM";case VideoQuality.HIGH:return"HIGH";case VideoQuality.OFF:return"OFF";case VideoQuality.UNRECOGNIZED:default:return"UNRECOGNIZED"}}var ConnectionQuality$1;(function(a){a[a.POOR=0]="POOR",a[a.GOOD=1]="GOOD",a[a.EXCELLENT=2]="EXCELLENT",a[a.UNRECOGNIZED=-1]="UNRECOGNIZED"})(ConnectionQuality$1||(ConnectionQuality$1={}));function connectionQualityFromJSON(a){switch(a){case 0:case"POOR":return ConnectionQuality$1.POOR;case 1:case"GOOD":return ConnectionQuality$1.GOOD;case 2:case"EXCELLENT":return ConnectionQuality$1.EXCELLENT;case-1:case"UNRECOGNIZED":default:return ConnectionQuality$1.UNRECOGNIZED}}function connectionQualityToJSON(a){switch(a){case ConnectionQuality$1.POOR:return"POOR";case ConnectionQuality$1.GOOD:return"GOOD";case ConnectionQuality$1.EXCELLENT:return"EXCELLENT";case ConnectionQuality$1.UNRECOGNIZED:default:return"UNRECOGNIZED"}}var ClientConfigSetting;(function(a){a[a.UNSET=0]="UNSET",a[a.DISABLED=1]="DISABLED",a[a.ENABLED=2]="ENABLED",a[a.UNRECOGNIZED=-1]="UNRECOGNIZED"})(ClientConfigSetting||(ClientConfigSetting={}));function clientConfigSettingFromJSON(a){switch(a){case 0:case"UNSET":return ClientConfigSetting.UNSET;case 1:case"DISABLED":return ClientConfigSetting.DISABLED;case 2:case"ENABLED":return ClientConfigSetting.ENABLED;case-1:case"UNRECOGNIZED":default:return ClientConfigSetting.UNRECOGNIZED}}function clientConfigSettingToJSON(a){switch(a){case ClientConfigSetting.UNSET:return"UNSET";case ClientConfigSetting.DISABLED:return"DISABLED";case ClientConfigSetting.ENABLED:return"ENABLED";case ClientConfigSetting.UNRECOGNIZED:default:return"UNRECOGNIZED"}}var DisconnectReason;(function(a){a[a.UNKNOWN_REASON=0]="UNKNOWN_REASON",a[a.CLIENT_INITIATED=1]="CLIENT_INITIATED",a[a.DUPLICATE_IDENTITY=2]="DUPLICATE_IDENTITY",a[a.SERVER_SHUTDOWN=3]="SERVER_SHUTDOWN",a[a.PARTICIPANT_REMOVED=4]="PARTICIPANT_REMOVED",a[a.ROOM_DELETED=5]="ROOM_DELETED",a[a.STATE_MISMATCH=6]="STATE_MISMATCH",a[a.JOIN_FAILURE=7]="JOIN_FAILURE",a[a.UNRECOGNIZED=-1]="UNRECOGNIZED"})(DisconnectReason||(DisconnectReason={}));function disconnectReasonFromJSON(a){switch(a){case 0:case"UNKNOWN_REASON":return DisconnectReason.UNKNOWN_REASON;case 1:case"CLIENT_INITIATED":return DisconnectReason.CLIENT_INITIATED;case 2:case"DUPLICATE_IDENTITY":return DisconnectReason.DUPLICATE_IDENTITY;case 3:case"SERVER_SHUTDOWN":return DisconnectReason.SERVER_SHUTDOWN;case 4:case"PARTICIPANT_REMOVED":return DisconnectReason.PARTICIPANT_REMOVED;case 5:case"ROOM_DELETED":return DisconnectReason.ROOM_DELETED;case 6:case"STATE_MISMATCH":return DisconnectReason.STATE_MISMATCH;case 7:case"JOIN_FAILURE":return DisconnectReason.JOIN_FAILURE;case-1:case"UNRECOGNIZED":default:return DisconnectReason.UNRECOGNIZED}}function disconnectReasonToJSON(a){switch(a){case DisconnectReason.UNKNOWN_REASON:return"UNKNOWN_REASON";case DisconnectReason.CLIENT_INITIATED:return"CLIENT_INITIATED";case DisconnectReason.DUPLICATE_IDENTITY:return"DUPLICATE_IDENTITY";case DisconnectReason.SERVER_SHUTDOWN:return"SERVER_SHUTDOWN";case DisconnectReason.PARTICIPANT_REMOVED:return"PARTICIPANT_REMOVED";case DisconnectReason.ROOM_DELETED:return"ROOM_DELETED";case DisconnectReason.STATE_MISMATCH:return"STATE_MISMATCH";case DisconnectReason.JOIN_FAILURE:return"JOIN_FAILURE";case DisconnectReason.UNRECOGNIZED:default:return"UNRECOGNIZED"}}var ReconnectReason;(function(a){a[a.RR_UNKOWN=0]="RR_UNKOWN",a[a.RR_SIGNAL_DISCONNECTED=1]="RR_SIGNAL_DISCONNECTED",a[a.RR_PUBLISHER_FAILED=2]="RR_PUBLISHER_FAILED",a[a.RR_SUBSCRIBER_FAILED=3]="RR_SUBSCRIBER_FAILED",a[a.RR_SWITCH_CANDIDATE=4]="RR_SWITCH_CANDIDATE",a[a.UNRECOGNIZED=-1]="UNRECOGNIZED"})(ReconnectReason||(ReconnectReason={}));var ParticipantInfo_State;(function(a){a[a.JOINING=0]="JOINING",a[a.JOINED=1]="JOINED",a[a.ACTIVE=2]="ACTIVE",a[a.DISCONNECTED=3]="DISCONNECTED",a[a.UNRECOGNIZED=-1]="UNRECOGNIZED"})(ParticipantInfo_State||(ParticipantInfo_State={}));function participantInfo_StateFromJSON(a){switch(a){case 0:case"JOINING":return ParticipantInfo_State.JOINING;case 1:case"JOINED":return ParticipantInfo_State.JOINED;case 2:case"ACTIVE":return ParticipantInfo_State.ACTIVE;case 3:case"DISCONNECTED":return ParticipantInfo_State.DISCONNECTED;case-1:case"UNRECOGNIZED":default:return ParticipantInfo_State.UNRECOGNIZED}}function participantInfo_StateToJSON(a){switch(a){case ParticipantInfo_State.JOINING:return"JOINING";case ParticipantInfo_State.JOINED:return"JOINED";case ParticipantInfo_State.ACTIVE:return"ACTIVE";case ParticipantInfo_State.DISCONNECTED:return"DISCONNECTED";case ParticipantInfo_State.UNRECOGNIZED:default:return"UNRECOGNIZED"}}var Encryption_Type;(function(a){a[a.NONE=0]="NONE",a[a.GCM=1]="GCM",a[a.CUSTOM=2]="CUSTOM",a[a.UNRECOGNIZED=-1]="UNRECOGNIZED"})(Encryption_Type||(Encryption_Type={}));function encryption_TypeFromJSON(a){switch(a){case 0:case"NONE":return Encryption_Type.NONE;case 1:case"GCM":return Encryption_Type.GCM;case 2:case"CUSTOM":return Encryption_Type.CUSTOM;case-1:case"UNRECOGNIZED":default:return Encryption_Type.UNRECOGNIZED}}function encryption_TypeToJSON(a){switch(a){case Encryption_Type.NONE:return"NONE";case Encryption_Type.GCM:return"GCM";case Encryption_Type.CUSTOM:return"CUSTOM";case Encryption_Type.UNRECOGNIZED:default:return"UNRECOGNIZED"}}var DataPacket_Kind;(function(a){a[a.RELIABLE=0]="RELIABLE",a[a.LOSSY=1]="LOSSY",a[a.UNRECOGNIZED=-1]="UNRECOGNIZED"})(DataPacket_Kind||(DataPacket_Kind={}));function dataPacket_KindFromJSON(a){switch(a){case 0:case"RELIABLE":return DataPacket_Kind.RELIABLE;case 1:case"LOSSY":return DataPacket_Kind.LOSSY;case-1:case"UNRECOGNIZED":default:return DataPacket_Kind.UNRECOGNIZED}}function dataPacket_KindToJSON(a){switch(a){case DataPacket_Kind.RELIABLE:return"RELIABLE";case DataPacket_Kind.LOSSY:return"LOSSY";case DataPacket_Kind.UNRECOGNIZED:default:return"UNRECOGNIZED"}}var ServerInfo_Edition;(function(a){a[a.Standard=0]="Standard",a[a.Cloud=1]="Cloud",a[a.UNRECOGNIZED=-1]="UNRECOGNIZED"})(ServerInfo_Edition||(ServerInfo_Edition={}));function serverInfo_EditionFromJSON(a){switch(a){case 0:case"Standard":return ServerInfo_Edition.Standard;case 1:case"Cloud":return ServerInfo_Edition.Cloud;case-1:case"UNRECOGNIZED":default:return ServerInfo_Edition.UNRECOGNIZED}}function serverInfo_EditionToJSON(a){switch(a){case ServerInfo_Edition.Standard:return"Standard";case ServerInfo_Edition.Cloud:return"Cloud";case ServerInfo_Edition.UNRECOGNIZED:default:return"UNRECOGNIZED"}}var ClientInfo_SDK;(function(a){a[a.UNKNOWN=0]="UNKNOWN",a[a.JS=1]="JS",a[a.SWIFT=2]="SWIFT",a[a.ANDROID=3]="ANDROID",a[a.FLUTTER=4]="FLUTTER",a[a.GO=5]="GO",a[a.UNITY=6]="UNITY",a[a.UNRECOGNIZED=-1]="UNRECOGNIZED"})(ClientInfo_SDK||(ClientInfo_SDK={}));function clientInfo_SDKFromJSON(a){switch(a){case 0:case"UNKNOWN":return ClientInfo_SDK.UNKNOWN;case 1:case"JS":return ClientInfo_SDK.JS;case 2:case"SWIFT":return ClientInfo_SDK.SWIFT;case 3:case"ANDROID":return ClientInfo_SDK.ANDROID;case 4:case"FLUTTER":return ClientInfo_SDK.FLUTTER;case 5:case"GO":return ClientInfo_SDK.GO;case 6:case"UNITY":return ClientInfo_SDK.UNITY;case-1:case"UNRECOGNIZED":default:return ClientInfo_SDK.UNRECOGNIZED}}function clientInfo_SDKToJSON(a){switch(a){case ClientInfo_SDK.UNKNOWN:return"UNKNOWN";case ClientInfo_SDK.JS:return"JS";case ClientInfo_SDK.SWIFT:return"SWIFT";case ClientInfo_SDK.ANDROID:return"ANDROID";case ClientInfo_SDK.FLUTTER:return"FLUTTER";case ClientInfo_SDK.GO:return"GO";case ClientInfo_SDK.UNITY:return"UNITY";case ClientInfo_SDK.UNRECOGNIZED:default:return"UNRECOGNIZED"}}function createBaseRoom(){return{sid:"",name:"",emptyTimeout:0,maxParticipants:0,creationTime:0,turnPassword:"",enabledCodecs:[],metadata:"",numParticipants:0,activeRecording:!1}}const Room$1={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();a.sid!==""&&s.uint32(10).string(a.sid),a.name!==""&&s.uint32(18).string(a.name),a.emptyTimeout!==0&&s.uint32(24).uint32(a.emptyTimeout),a.maxParticipants!==0&&s.uint32(32).uint32(a.maxParticipants),a.creationTime!==0&&s.uint32(40).int64(a.creationTime),a.turnPassword!==""&&s.uint32(50).string(a.turnPassword);for(const d of a.enabledCodecs)Codec.encode(d,s.uint32(58).fork()).ldelim();return a.metadata!==""&&s.uint32(66).string(a.metadata),a.numParticipants!==0&&s.uint32(72).uint32(a.numParticipants),a.activeRecording===!0&&s.uint32(80).bool(a.activeRecording),s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseRoom();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.sid=d.string();break;case 2:l.name=d.string();break;case 3:l.emptyTimeout=d.uint32();break;case 4:l.maxParticipants=d.uint32();break;case 5:l.creationTime=longToNumber$1(d.int64());break;case 6:l.turnPassword=d.string();break;case 7:l.enabledCodecs.push(Codec.decode(d,d.uint32()));break;case 8:l.metadata=d.string();break;case 9:l.numParticipants=d.uint32();break;case 10:l.activeRecording=d.bool();break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{sid:isSet$1(a.sid)?String(a.sid):"",name:isSet$1(a.name)?String(a.name):"",emptyTimeout:isSet$1(a.emptyTimeout)?Number(a.emptyTimeout):0,maxParticipants:isSet$1(a.maxParticipants)?Number(a.maxParticipants):0,creationTime:isSet$1(a.creationTime)?Number(a.creationTime):0,turnPassword:isSet$1(a.turnPassword)?String(a.turnPassword):"",enabledCodecs:Array.isArray(a==null?void 0:a.enabledCodecs)?a.enabledCodecs.map(s=>Codec.fromJSON(s)):[],metadata:isSet$1(a.metadata)?String(a.metadata):"",numParticipants:isSet$1(a.numParticipants)?Number(a.numParticipants):0,activeRecording:isSet$1(a.activeRecording)?Boolean(a.activeRecording):!1}},toJSON(a){const s={};return a.sid!==void 0&&(s.sid=a.sid),a.name!==void 0&&(s.name=a.name),a.emptyTimeout!==void 0&&(s.emptyTimeout=Math.round(a.emptyTimeout)),a.maxParticipants!==void 0&&(s.maxParticipants=Math.round(a.maxParticipants)),a.creationTime!==void 0&&(s.creationTime=Math.round(a.creationTime)),a.turnPassword!==void 0&&(s.turnPassword=a.turnPassword),a.enabledCodecs?s.enabledCodecs=a.enabledCodecs.map(d=>d?Codec.toJSON(d):void 0):s.enabledCodecs=[],a.metadata!==void 0&&(s.metadata=a.metadata),a.numParticipants!==void 0&&(s.numParticipants=Math.round(a.numParticipants)),a.activeRecording!==void 0&&(s.activeRecording=a.activeRecording),s},create(a){return Room$1.fromPartial(a!=null?a:{})},fromPartial(a){var s,d,c,l,p,h,v,S,b,_;const I=createBaseRoom();return I.sid=(s=a.sid)!==null&&s!==void 0?s:"",I.name=(d=a.name)!==null&&d!==void 0?d:"",I.emptyTimeout=(c=a.emptyTimeout)!==null&&c!==void 0?c:0,I.maxParticipants=(l=a.maxParticipants)!==null&&l!==void 0?l:0,I.creationTime=(p=a.creationTime)!==null&&p!==void 0?p:0,I.turnPassword=(h=a.turnPassword)!==null&&h!==void 0?h:"",I.enabledCodecs=((v=a.enabledCodecs)===null||v===void 0?void 0:v.map(T=>Codec.fromPartial(T)))||[],I.metadata=(S=a.metadata)!==null&&S!==void 0?S:"",I.numParticipants=(b=a.numParticipants)!==null&&b!==void 0?b:0,I.activeRecording=(_=a.activeRecording)!==null&&_!==void 0?_:!1,I}};function createBaseCodec(){return{mime:"",fmtpLine:""}}const Codec={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();return a.mime!==""&&s.uint32(10).string(a.mime),a.fmtpLine!==""&&s.uint32(18).string(a.fmtpLine),s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseCodec();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.mime=d.string();break;case 2:l.fmtpLine=d.string();break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{mime:isSet$1(a.mime)?String(a.mime):"",fmtpLine:isSet$1(a.fmtpLine)?String(a.fmtpLine):""}},toJSON(a){const s={};return a.mime!==void 0&&(s.mime=a.mime),a.fmtpLine!==void 0&&(s.fmtpLine=a.fmtpLine),s},create(a){return Codec.fromPartial(a!=null?a:{})},fromPartial(a){var s,d;const c=createBaseCodec();return c.mime=(s=a.mime)!==null&&s!==void 0?s:"",c.fmtpLine=(d=a.fmtpLine)!==null&&d!==void 0?d:"",c}};function createBaseParticipantPermission(){return{canSubscribe:!1,canPublish:!1,canPublishData:!1,canPublishSources:[],hidden:!1,recorder:!1}}const ParticipantPermission={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();a.canSubscribe===!0&&s.uint32(8).bool(a.canSubscribe),a.canPublish===!0&&s.uint32(16).bool(a.canPublish),a.canPublishData===!0&&s.uint32(24).bool(a.canPublishData),s.uint32(74).fork();for(const d of a.canPublishSources)s.int32(d);return s.ldelim(),a.hidden===!0&&s.uint32(56).bool(a.hidden),a.recorder===!0&&s.uint32(64).bool(a.recorder),s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseParticipantPermission();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.canSubscribe=d.bool();break;case 2:l.canPublish=d.bool();break;case 3:l.canPublishData=d.bool();break;case 9:if((p&7)===2){const h=d.uint32()+d.pos;for(;d.pos<h;)l.canPublishSources.push(d.int32())}else l.canPublishSources.push(d.int32());break;case 7:l.hidden=d.bool();break;case 8:l.recorder=d.bool();break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{canSubscribe:isSet$1(a.canSubscribe)?Boolean(a.canSubscribe):!1,canPublish:isSet$1(a.canPublish)?Boolean(a.canPublish):!1,canPublishData:isSet$1(a.canPublishData)?Boolean(a.canPublishData):!1,canPublishSources:Array.isArray(a==null?void 0:a.canPublishSources)?a.canPublishSources.map(s=>trackSourceFromJSON(s)):[],hidden:isSet$1(a.hidden)?Boolean(a.hidden):!1,recorder:isSet$1(a.recorder)?Boolean(a.recorder):!1}},toJSON(a){const s={};return a.canSubscribe!==void 0&&(s.canSubscribe=a.canSubscribe),a.canPublish!==void 0&&(s.canPublish=a.canPublish),a.canPublishData!==void 0&&(s.canPublishData=a.canPublishData),a.canPublishSources?s.canPublishSources=a.canPublishSources.map(d=>trackSourceToJSON(d)):s.canPublishSources=[],a.hidden!==void 0&&(s.hidden=a.hidden),a.recorder!==void 0&&(s.recorder=a.recorder),s},create(a){return ParticipantPermission.fromPartial(a!=null?a:{})},fromPartial(a){var s,d,c,l,p,h;const v=createBaseParticipantPermission();return v.canSubscribe=(s=a.canSubscribe)!==null&&s!==void 0?s:!1,v.canPublish=(d=a.canPublish)!==null&&d!==void 0?d:!1,v.canPublishData=(c=a.canPublishData)!==null&&c!==void 0?c:!1,v.canPublishSources=((l=a.canPublishSources)===null||l===void 0?void 0:l.map(S=>S))||[],v.hidden=(p=a.hidden)!==null&&p!==void 0?p:!1,v.recorder=(h=a.recorder)!==null&&h!==void 0?h:!1,v}};function createBaseParticipantInfo(){return{sid:"",identity:"",state:0,tracks:[],metadata:"",joinedAt:0,name:"",version:0,permission:void 0,region:"",isPublisher:!1}}const ParticipantInfo={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();a.sid!==""&&s.uint32(10).string(a.sid),a.identity!==""&&s.uint32(18).string(a.identity),a.state!==0&&s.uint32(24).int32(a.state);for(const d of a.tracks)TrackInfo.encode(d,s.uint32(34).fork()).ldelim();return a.metadata!==""&&s.uint32(42).string(a.metadata),a.joinedAt!==0&&s.uint32(48).int64(a.joinedAt),a.name!==""&&s.uint32(74).string(a.name),a.version!==0&&s.uint32(80).uint32(a.version),a.permission!==void 0&&ParticipantPermission.encode(a.permission,s.uint32(90).fork()).ldelim(),a.region!==""&&s.uint32(98).string(a.region),a.isPublisher===!0&&s.uint32(104).bool(a.isPublisher),s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseParticipantInfo();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.sid=d.string();break;case 2:l.identity=d.string();break;case 3:l.state=d.int32();break;case 4:l.tracks.push(TrackInfo.decode(d,d.uint32()));break;case 5:l.metadata=d.string();break;case 6:l.joinedAt=longToNumber$1(d.int64());break;case 9:l.name=d.string();break;case 10:l.version=d.uint32();break;case 11:l.permission=ParticipantPermission.decode(d,d.uint32());break;case 12:l.region=d.string();break;case 13:l.isPublisher=d.bool();break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{sid:isSet$1(a.sid)?String(a.sid):"",identity:isSet$1(a.identity)?String(a.identity):"",state:isSet$1(a.state)?participantInfo_StateFromJSON(a.state):0,tracks:Array.isArray(a==null?void 0:a.tracks)?a.tracks.map(s=>TrackInfo.fromJSON(s)):[],metadata:isSet$1(a.metadata)?String(a.metadata):"",joinedAt:isSet$1(a.joinedAt)?Number(a.joinedAt):0,name:isSet$1(a.name)?String(a.name):"",version:isSet$1(a.version)?Number(a.version):0,permission:isSet$1(a.permission)?ParticipantPermission.fromJSON(a.permission):void 0,region:isSet$1(a.region)?String(a.region):"",isPublisher:isSet$1(a.isPublisher)?Boolean(a.isPublisher):!1}},toJSON(a){const s={};return a.sid!==void 0&&(s.sid=a.sid),a.identity!==void 0&&(s.identity=a.identity),a.state!==void 0&&(s.state=participantInfo_StateToJSON(a.state)),a.tracks?s.tracks=a.tracks.map(d=>d?TrackInfo.toJSON(d):void 0):s.tracks=[],a.metadata!==void 0&&(s.metadata=a.metadata),a.joinedAt!==void 0&&(s.joinedAt=Math.round(a.joinedAt)),a.name!==void 0&&(s.name=a.name),a.version!==void 0&&(s.version=Math.round(a.version)),a.permission!==void 0&&(s.permission=a.permission?ParticipantPermission.toJSON(a.permission):void 0),a.region!==void 0&&(s.region=a.region),a.isPublisher!==void 0&&(s.isPublisher=a.isPublisher),s},create(a){return ParticipantInfo.fromPartial(a!=null?a:{})},fromPartial(a){var s,d,c,l,p,h,v,S,b,_;const I=createBaseParticipantInfo();return I.sid=(s=a.sid)!==null&&s!==void 0?s:"",I.identity=(d=a.identity)!==null&&d!==void 0?d:"",I.state=(c=a.state)!==null&&c!==void 0?c:0,I.tracks=((l=a.tracks)===null||l===void 0?void 0:l.map(T=>TrackInfo.fromPartial(T)))||[],I.metadata=(p=a.metadata)!==null&&p!==void 0?p:"",I.joinedAt=(h=a.joinedAt)!==null&&h!==void 0?h:0,I.name=(v=a.name)!==null&&v!==void 0?v:"",I.version=(S=a.version)!==null&&S!==void 0?S:0,I.permission=a.permission!==void 0&&a.permission!==null?ParticipantPermission.fromPartial(a.permission):void 0,I.region=(b=a.region)!==null&&b!==void 0?b:"",I.isPublisher=(_=a.isPublisher)!==null&&_!==void 0?_:!1,I}};function createBaseSimulcastCodecInfo(){return{mimeType:"",mid:"",cid:"",layers:[]}}const SimulcastCodecInfo={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();a.mimeType!==""&&s.uint32(10).string(a.mimeType),a.mid!==""&&s.uint32(18).string(a.mid),a.cid!==""&&s.uint32(26).string(a.cid);for(const d of a.layers)VideoLayer.encode(d,s.uint32(34).fork()).ldelim();return s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseSimulcastCodecInfo();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.mimeType=d.string();break;case 2:l.mid=d.string();break;case 3:l.cid=d.string();break;case 4:l.layers.push(VideoLayer.decode(d,d.uint32()));break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{mimeType:isSet$1(a.mimeType)?String(a.mimeType):"",mid:isSet$1(a.mid)?String(a.mid):"",cid:isSet$1(a.cid)?String(a.cid):"",layers:Array.isArray(a==null?void 0:a.layers)?a.layers.map(s=>VideoLayer.fromJSON(s)):[]}},toJSON(a){const s={};return a.mimeType!==void 0&&(s.mimeType=a.mimeType),a.mid!==void 0&&(s.mid=a.mid),a.cid!==void 0&&(s.cid=a.cid),a.layers?s.layers=a.layers.map(d=>d?VideoLayer.toJSON(d):void 0):s.layers=[],s},create(a){return SimulcastCodecInfo.fromPartial(a!=null?a:{})},fromPartial(a){var s,d,c,l;const p=createBaseSimulcastCodecInfo();return p.mimeType=(s=a.mimeType)!==null&&s!==void 0?s:"",p.mid=(d=a.mid)!==null&&d!==void 0?d:"",p.cid=(c=a.cid)!==null&&c!==void 0?c:"",p.layers=((l=a.layers)===null||l===void 0?void 0:l.map(h=>VideoLayer.fromPartial(h)))||[],p}};function createBaseTrackInfo(){return{sid:"",type:0,name:"",muted:!1,width:0,height:0,simulcast:!1,disableDtx:!1,source:0,layers:[],mimeType:"",mid:"",codecs:[],stereo:!1,disableRed:!1,encryption:0}}const TrackInfo={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();a.sid!==""&&s.uint32(10).string(a.sid),a.type!==0&&s.uint32(16).int32(a.type),a.name!==""&&s.uint32(26).string(a.name),a.muted===!0&&s.uint32(32).bool(a.muted),a.width!==0&&s.uint32(40).uint32(a.width),a.height!==0&&s.uint32(48).uint32(a.height),a.simulcast===!0&&s.uint32(56).bool(a.simulcast),a.disableDtx===!0&&s.uint32(64).bool(a.disableDtx),a.source!==0&&s.uint32(72).int32(a.source);for(const d of a.layers)VideoLayer.encode(d,s.uint32(82).fork()).ldelim();a.mimeType!==""&&s.uint32(90).string(a.mimeType),a.mid!==""&&s.uint32(98).string(a.mid);for(const d of a.codecs)SimulcastCodecInfo.encode(d,s.uint32(106).fork()).ldelim();return a.stereo===!0&&s.uint32(112).bool(a.stereo),a.disableRed===!0&&s.uint32(120).bool(a.disableRed),a.encryption!==0&&s.uint32(128).int32(a.encryption),s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseTrackInfo();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.sid=d.string();break;case 2:l.type=d.int32();break;case 3:l.name=d.string();break;case 4:l.muted=d.bool();break;case 5:l.width=d.uint32();break;case 6:l.height=d.uint32();break;case 7:l.simulcast=d.bool();break;case 8:l.disableDtx=d.bool();break;case 9:l.source=d.int32();break;case 10:l.layers.push(VideoLayer.decode(d,d.uint32()));break;case 11:l.mimeType=d.string();break;case 12:l.mid=d.string();break;case 13:l.codecs.push(SimulcastCodecInfo.decode(d,d.uint32()));break;case 14:l.stereo=d.bool();break;case 15:l.disableRed=d.bool();break;case 16:l.encryption=d.int32();break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{sid:isSet$1(a.sid)?String(a.sid):"",type:isSet$1(a.type)?trackTypeFromJSON(a.type):0,name:isSet$1(a.name)?String(a.name):"",muted:isSet$1(a.muted)?Boolean(a.muted):!1,width:isSet$1(a.width)?Number(a.width):0,height:isSet$1(a.height)?Number(a.height):0,simulcast:isSet$1(a.simulcast)?Boolean(a.simulcast):!1,disableDtx:isSet$1(a.disableDtx)?Boolean(a.disableDtx):!1,source:isSet$1(a.source)?trackSourceFromJSON(a.source):0,layers:Array.isArray(a==null?void 0:a.layers)?a.layers.map(s=>VideoLayer.fromJSON(s)):[],mimeType:isSet$1(a.mimeType)?String(a.mimeType):"",mid:isSet$1(a.mid)?String(a.mid):"",codecs:Array.isArray(a==null?void 0:a.codecs)?a.codecs.map(s=>SimulcastCodecInfo.fromJSON(s)):[],stereo:isSet$1(a.stereo)?Boolean(a.stereo):!1,disableRed:isSet$1(a.disableRed)?Boolean(a.disableRed):!1,encryption:isSet$1(a.encryption)?encryption_TypeFromJSON(a.encryption):0}},toJSON(a){const s={};return a.sid!==void 0&&(s.sid=a.sid),a.type!==void 0&&(s.type=trackTypeToJSON(a.type)),a.name!==void 0&&(s.name=a.name),a.muted!==void 0&&(s.muted=a.muted),a.width!==void 0&&(s.width=Math.round(a.width)),a.height!==void 0&&(s.height=Math.round(a.height)),a.simulcast!==void 0&&(s.simulcast=a.simulcast),a.disableDtx!==void 0&&(s.disableDtx=a.disableDtx),a.source!==void 0&&(s.source=trackSourceToJSON(a.source)),a.layers?s.layers=a.layers.map(d=>d?VideoLayer.toJSON(d):void 0):s.layers=[],a.mimeType!==void 0&&(s.mimeType=a.mimeType),a.mid!==void 0&&(s.mid=a.mid),a.codecs?s.codecs=a.codecs.map(d=>d?SimulcastCodecInfo.toJSON(d):void 0):s.codecs=[],a.stereo!==void 0&&(s.stereo=a.stereo),a.disableRed!==void 0&&(s.disableRed=a.disableRed),a.encryption!==void 0&&(s.encryption=encryption_TypeToJSON(a.encryption)),s},create(a){return TrackInfo.fromPartial(a!=null?a:{})},fromPartial(a){var s,d,c,l,p,h,v,S,b,_,I,T,k,w,P,$;const U=createBaseTrackInfo();return U.sid=(s=a.sid)!==null&&s!==void 0?s:"",U.type=(d=a.type)!==null&&d!==void 0?d:0,U.name=(c=a.name)!==null&&c!==void 0?c:"",U.muted=(l=a.muted)!==null&&l!==void 0?l:!1,U.width=(p=a.width)!==null&&p!==void 0?p:0,U.height=(h=a.height)!==null&&h!==void 0?h:0,U.simulcast=(v=a.simulcast)!==null&&v!==void 0?v:!1,U.disableDtx=(S=a.disableDtx)!==null&&S!==void 0?S:!1,U.source=(b=a.source)!==null&&b!==void 0?b:0,U.layers=((_=a.layers)===null||_===void 0?void 0:_.map(E=>VideoLayer.fromPartial(E)))||[],U.mimeType=(I=a.mimeType)!==null&&I!==void 0?I:"",U.mid=(T=a.mid)!==null&&T!==void 0?T:"",U.codecs=((k=a.codecs)===null||k===void 0?void 0:k.map(E=>SimulcastCodecInfo.fromPartial(E)))||[],U.stereo=(w=a.stereo)!==null&&w!==void 0?w:!1,U.disableRed=(P=a.disableRed)!==null&&P!==void 0?P:!1,U.encryption=($=a.encryption)!==null&&$!==void 0?$:0,U}};function createBaseVideoLayer(){return{quality:0,width:0,height:0,bitrate:0,ssrc:0}}const VideoLayer={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();return a.quality!==0&&s.uint32(8).int32(a.quality),a.width!==0&&s.uint32(16).uint32(a.width),a.height!==0&&s.uint32(24).uint32(a.height),a.bitrate!==0&&s.uint32(32).uint32(a.bitrate),a.ssrc!==0&&s.uint32(40).uint32(a.ssrc),s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseVideoLayer();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.quality=d.int32();break;case 2:l.width=d.uint32();break;case 3:l.height=d.uint32();break;case 4:l.bitrate=d.uint32();break;case 5:l.ssrc=d.uint32();break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{quality:isSet$1(a.quality)?videoQualityFromJSON(a.quality):0,width:isSet$1(a.width)?Number(a.width):0,height:isSet$1(a.height)?Number(a.height):0,bitrate:isSet$1(a.bitrate)?Number(a.bitrate):0,ssrc:isSet$1(a.ssrc)?Number(a.ssrc):0}},toJSON(a){const s={};return a.quality!==void 0&&(s.quality=videoQualityToJSON(a.quality)),a.width!==void 0&&(s.width=Math.round(a.width)),a.height!==void 0&&(s.height=Math.round(a.height)),a.bitrate!==void 0&&(s.bitrate=Math.round(a.bitrate)),a.ssrc!==void 0&&(s.ssrc=Math.round(a.ssrc)),s},create(a){return VideoLayer.fromPartial(a!=null?a:{})},fromPartial(a){var s,d,c,l,p;const h=createBaseVideoLayer();return h.quality=(s=a.quality)!==null&&s!==void 0?s:0,h.width=(d=a.width)!==null&&d!==void 0?d:0,h.height=(c=a.height)!==null&&c!==void 0?c:0,h.bitrate=(l=a.bitrate)!==null&&l!==void 0?l:0,h.ssrc=(p=a.ssrc)!==null&&p!==void 0?p:0,h}};function createBaseDataPacket(){return{kind:0,value:void 0}}const DataPacket={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();var d;switch(a.kind!==0&&s.uint32(8).int32(a.kind),(d=a.value)===null||d===void 0?void 0:d.$case){case"user":UserPacket.encode(a.value.user,s.uint32(18).fork()).ldelim();break;case"speaker":ActiveSpeakerUpdate.encode(a.value.speaker,s.uint32(26).fork()).ldelim();break}return s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseDataPacket();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.kind=d.int32();break;case 2:l.value={$case:"user",user:UserPacket.decode(d,d.uint32())};break;case 3:l.value={$case:"speaker",speaker:ActiveSpeakerUpdate.decode(d,d.uint32())};break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{kind:isSet$1(a.kind)?dataPacket_KindFromJSON(a.kind):0,value:isSet$1(a.user)?{$case:"user",user:UserPacket.fromJSON(a.user)}:isSet$1(a.speaker)?{$case:"speaker",speaker:ActiveSpeakerUpdate.fromJSON(a.speaker)}:void 0}},toJSON(a){var s,d,c,l,p,h;const v={};return a.kind!==void 0&&(v.kind=dataPacket_KindToJSON(a.kind)),((s=a.value)===null||s===void 0?void 0:s.$case)==="user"&&(v.user=!((d=a.value)===null||d===void 0)&&d.user?UserPacket.toJSON((c=a.value)===null||c===void 0?void 0:c.user):void 0),((l=a.value)===null||l===void 0?void 0:l.$case)==="speaker"&&(v.speaker=!((p=a.value)===null||p===void 0)&&p.speaker?ActiveSpeakerUpdate.toJSON((h=a.value)===null||h===void 0?void 0:h.speaker):void 0),v},create(a){return DataPacket.fromPartial(a!=null?a:{})},fromPartial(a){var s,d,c,l,p,h,v;const S=createBaseDataPacket();return S.kind=(s=a.kind)!==null&&s!==void 0?s:0,((d=a.value)===null||d===void 0?void 0:d.$case)==="user"&&((c=a.value)===null||c===void 0?void 0:c.user)!==void 0&&((l=a.value)===null||l===void 0?void 0:l.user)!==null&&(S.value={$case:"user",user:UserPacket.fromPartial(a.value.user)}),((p=a.value)===null||p===void 0?void 0:p.$case)==="speaker"&&((h=a.value)===null||h===void 0?void 0:h.speaker)!==void 0&&((v=a.value)===null||v===void 0?void 0:v.speaker)!==null&&(S.value={$case:"speaker",speaker:ActiveSpeakerUpdate.fromPartial(a.value.speaker)}),S}};function createBaseActiveSpeakerUpdate(){return{speakers:[]}}const ActiveSpeakerUpdate={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();for(const d of a.speakers)SpeakerInfo.encode(d,s.uint32(10).fork()).ldelim();return s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseActiveSpeakerUpdate();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.speakers.push(SpeakerInfo.decode(d,d.uint32()));break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{speakers:Array.isArray(a==null?void 0:a.speakers)?a.speakers.map(s=>SpeakerInfo.fromJSON(s)):[]}},toJSON(a){const s={};return a.speakers?s.speakers=a.speakers.map(d=>d?SpeakerInfo.toJSON(d):void 0):s.speakers=[],s},create(a){return ActiveSpeakerUpdate.fromPartial(a!=null?a:{})},fromPartial(a){var s;const d=createBaseActiveSpeakerUpdate();return d.speakers=((s=a.speakers)===null||s===void 0?void 0:s.map(c=>SpeakerInfo.fromPartial(c)))||[],d}};function createBaseSpeakerInfo(){return{sid:"",level:0,active:!1}}const SpeakerInfo={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();return a.sid!==""&&s.uint32(10).string(a.sid),a.level!==0&&s.uint32(21).float(a.level),a.active===!0&&s.uint32(24).bool(a.active),s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseSpeakerInfo();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.sid=d.string();break;case 2:l.level=d.float();break;case 3:l.active=d.bool();break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{sid:isSet$1(a.sid)?String(a.sid):"",level:isSet$1(a.level)?Number(a.level):0,active:isSet$1(a.active)?Boolean(a.active):!1}},toJSON(a){const s={};return a.sid!==void 0&&(s.sid=a.sid),a.level!==void 0&&(s.level=a.level),a.active!==void 0&&(s.active=a.active),s},create(a){return SpeakerInfo.fromPartial(a!=null?a:{})},fromPartial(a){var s,d,c;const l=createBaseSpeakerInfo();return l.sid=(s=a.sid)!==null&&s!==void 0?s:"",l.level=(d=a.level)!==null&&d!==void 0?d:0,l.active=(c=a.active)!==null&&c!==void 0?c:!1,l}};function createBaseUserPacket(){return{participantSid:"",payload:new Uint8Array,destinationSids:[],topic:void 0}}const UserPacket={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();a.participantSid!==""&&s.uint32(10).string(a.participantSid),a.payload.length!==0&&s.uint32(18).bytes(a.payload);for(const d of a.destinationSids)s.uint32(26).string(d);return a.topic!==void 0&&s.uint32(34).string(a.topic),s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseUserPacket();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.participantSid=d.string();break;case 2:l.payload=d.bytes();break;case 3:l.destinationSids.push(d.string());break;case 4:l.topic=d.string();break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{participantSid:isSet$1(a.participantSid)?String(a.participantSid):"",payload:isSet$1(a.payload)?bytesFromBase64(a.payload):new Uint8Array,destinationSids:Array.isArray(a==null?void 0:a.destinationSids)?a.destinationSids.map(s=>String(s)):[],topic:isSet$1(a.topic)?String(a.topic):void 0}},toJSON(a){const s={};return a.participantSid!==void 0&&(s.participantSid=a.participantSid),a.payload!==void 0&&(s.payload=base64FromBytes(a.payload!==void 0?a.payload:new Uint8Array)),a.destinationSids?s.destinationSids=a.destinationSids.map(d=>d):s.destinationSids=[],a.topic!==void 0&&(s.topic=a.topic),s},create(a){return UserPacket.fromPartial(a!=null?a:{})},fromPartial(a){var s,d,c,l;const p=createBaseUserPacket();return p.participantSid=(s=a.participantSid)!==null&&s!==void 0?s:"",p.payload=(d=a.payload)!==null&&d!==void 0?d:new Uint8Array,p.destinationSids=((c=a.destinationSids)===null||c===void 0?void 0:c.map(h=>h))||[],p.topic=(l=a.topic)!==null&&l!==void 0?l:void 0,p}};function createBaseParticipantTracks(){return{participantSid:"",trackSids:[]}}const ParticipantTracks={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();a.participantSid!==""&&s.uint32(10).string(a.participantSid);for(const d of a.trackSids)s.uint32(18).string(d);return s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseParticipantTracks();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.participantSid=d.string();break;case 2:l.trackSids.push(d.string());break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{participantSid:isSet$1(a.participantSid)?String(a.participantSid):"",trackSids:Array.isArray(a==null?void 0:a.trackSids)?a.trackSids.map(s=>String(s)):[]}},toJSON(a){const s={};return a.participantSid!==void 0&&(s.participantSid=a.participantSid),a.trackSids?s.trackSids=a.trackSids.map(d=>d):s.trackSids=[],s},create(a){return ParticipantTracks.fromPartial(a!=null?a:{})},fromPartial(a){var s,d;const c=createBaseParticipantTracks();return c.participantSid=(s=a.participantSid)!==null&&s!==void 0?s:"",c.trackSids=((d=a.trackSids)===null||d===void 0?void 0:d.map(l=>l))||[],c}};function createBaseServerInfo(){return{edition:0,version:"",protocol:0,region:"",nodeId:"",debugInfo:""}}const ServerInfo={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();return a.edition!==0&&s.uint32(8).int32(a.edition),a.version!==""&&s.uint32(18).string(a.version),a.protocol!==0&&s.uint32(24).int32(a.protocol),a.region!==""&&s.uint32(34).string(a.region),a.nodeId!==""&&s.uint32(42).string(a.nodeId),a.debugInfo!==""&&s.uint32(50).string(a.debugInfo),s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseServerInfo();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.edition=d.int32();break;case 2:l.version=d.string();break;case 3:l.protocol=d.int32();break;case 4:l.region=d.string();break;case 5:l.nodeId=d.string();break;case 6:l.debugInfo=d.string();break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{edition:isSet$1(a.edition)?serverInfo_EditionFromJSON(a.edition):0,version:isSet$1(a.version)?String(a.version):"",protocol:isSet$1(a.protocol)?Number(a.protocol):0,region:isSet$1(a.region)?String(a.region):"",nodeId:isSet$1(a.nodeId)?String(a.nodeId):"",debugInfo:isSet$1(a.debugInfo)?String(a.debugInfo):""}},toJSON(a){const s={};return a.edition!==void 0&&(s.edition=serverInfo_EditionToJSON(a.edition)),a.version!==void 0&&(s.version=a.version),a.protocol!==void 0&&(s.protocol=Math.round(a.protocol)),a.region!==void 0&&(s.region=a.region),a.nodeId!==void 0&&(s.nodeId=a.nodeId),a.debugInfo!==void 0&&(s.debugInfo=a.debugInfo),s},create(a){return ServerInfo.fromPartial(a!=null?a:{})},fromPartial(a){var s,d,c,l,p,h;const v=createBaseServerInfo();return v.edition=(s=a.edition)!==null&&s!==void 0?s:0,v.version=(d=a.version)!==null&&d!==void 0?d:"",v.protocol=(c=a.protocol)!==null&&c!==void 0?c:0,v.region=(l=a.region)!==null&&l!==void 0?l:"",v.nodeId=(p=a.nodeId)!==null&&p!==void 0?p:"",v.debugInfo=(h=a.debugInfo)!==null&&h!==void 0?h:"",v}};function createBaseClientInfo(){return{sdk:0,version:"",protocol:0,os:"",osVersion:"",deviceModel:"",browser:"",browserVersion:"",address:"",network:""}}const ClientInfo={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();return a.sdk!==0&&s.uint32(8).int32(a.sdk),a.version!==""&&s.uint32(18).string(a.version),a.protocol!==0&&s.uint32(24).int32(a.protocol),a.os!==""&&s.uint32(34).string(a.os),a.osVersion!==""&&s.uint32(42).string(a.osVersion),a.deviceModel!==""&&s.uint32(50).string(a.deviceModel),a.browser!==""&&s.uint32(58).string(a.browser),a.browserVersion!==""&&s.uint32(66).string(a.browserVersion),a.address!==""&&s.uint32(74).string(a.address),a.network!==""&&s.uint32(82).string(a.network),s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseClientInfo();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.sdk=d.int32();break;case 2:l.version=d.string();break;case 3:l.protocol=d.int32();break;case 4:l.os=d.string();break;case 5:l.osVersion=d.string();break;case 6:l.deviceModel=d.string();break;case 7:l.browser=d.string();break;case 8:l.browserVersion=d.string();break;case 9:l.address=d.string();break;case 10:l.network=d.string();break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{sdk:isSet$1(a.sdk)?clientInfo_SDKFromJSON(a.sdk):0,version:isSet$1(a.version)?String(a.version):"",protocol:isSet$1(a.protocol)?Number(a.protocol):0,os:isSet$1(a.os)?String(a.os):"",osVersion:isSet$1(a.osVersion)?String(a.osVersion):"",deviceModel:isSet$1(a.deviceModel)?String(a.deviceModel):"",browser:isSet$1(a.browser)?String(a.browser):"",browserVersion:isSet$1(a.browserVersion)?String(a.browserVersion):"",address:isSet$1(a.address)?String(a.address):"",network:isSet$1(a.network)?String(a.network):""}},toJSON(a){const s={};return a.sdk!==void 0&&(s.sdk=clientInfo_SDKToJSON(a.sdk)),a.version!==void 0&&(s.version=a.version),a.protocol!==void 0&&(s.protocol=Math.round(a.protocol)),a.os!==void 0&&(s.os=a.os),a.osVersion!==void 0&&(s.osVersion=a.osVersion),a.deviceModel!==void 0&&(s.deviceModel=a.deviceModel),a.browser!==void 0&&(s.browser=a.browser),a.browserVersion!==void 0&&(s.browserVersion=a.browserVersion),a.address!==void 0&&(s.address=a.address),a.network!==void 0&&(s.network=a.network),s},create(a){return ClientInfo.fromPartial(a!=null?a:{})},fromPartial(a){var s,d,c,l,p,h,v,S,b,_;const I=createBaseClientInfo();return I.sdk=(s=a.sdk)!==null&&s!==void 0?s:0,I.version=(d=a.version)!==null&&d!==void 0?d:"",I.protocol=(c=a.protocol)!==null&&c!==void 0?c:0,I.os=(l=a.os)!==null&&l!==void 0?l:"",I.osVersion=(p=a.osVersion)!==null&&p!==void 0?p:"",I.deviceModel=(h=a.deviceModel)!==null&&h!==void 0?h:"",I.browser=(v=a.browser)!==null&&v!==void 0?v:"",I.browserVersion=(S=a.browserVersion)!==null&&S!==void 0?S:"",I.address=(b=a.address)!==null&&b!==void 0?b:"",I.network=(_=a.network)!==null&&_!==void 0?_:"",I}};function createBaseClientConfiguration(){return{video:void 0,screen:void 0,resumeConnection:0,disabledCodecs:void 0,forceRelay:0}}const ClientConfiguration={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();return a.video!==void 0&&VideoConfiguration.encode(a.video,s.uint32(10).fork()).ldelim(),a.screen!==void 0&&VideoConfiguration.encode(a.screen,s.uint32(18).fork()).ldelim(),a.resumeConnection!==0&&s.uint32(24).int32(a.resumeConnection),a.disabledCodecs!==void 0&&DisabledCodecs.encode(a.disabledCodecs,s.uint32(34).fork()).ldelim(),a.forceRelay!==0&&s.uint32(40).int32(a.forceRelay),s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseClientConfiguration();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.video=VideoConfiguration.decode(d,d.uint32());break;case 2:l.screen=VideoConfiguration.decode(d,d.uint32());break;case 3:l.resumeConnection=d.int32();break;case 4:l.disabledCodecs=DisabledCodecs.decode(d,d.uint32());break;case 5:l.forceRelay=d.int32();break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{video:isSet$1(a.video)?VideoConfiguration.fromJSON(a.video):void 0,screen:isSet$1(a.screen)?VideoConfiguration.fromJSON(a.screen):void 0,resumeConnection:isSet$1(a.resumeConnection)?clientConfigSettingFromJSON(a.resumeConnection):0,disabledCodecs:isSet$1(a.disabledCodecs)?DisabledCodecs.fromJSON(a.disabledCodecs):void 0,forceRelay:isSet$1(a.forceRelay)?clientConfigSettingFromJSON(a.forceRelay):0}},toJSON(a){const s={};return a.video!==void 0&&(s.video=a.video?VideoConfiguration.toJSON(a.video):void 0),a.screen!==void 0&&(s.screen=a.screen?VideoConfiguration.toJSON(a.screen):void 0),a.resumeConnection!==void 0&&(s.resumeConnection=clientConfigSettingToJSON(a.resumeConnection)),a.disabledCodecs!==void 0&&(s.disabledCodecs=a.disabledCodecs?DisabledCodecs.toJSON(a.disabledCodecs):void 0),a.forceRelay!==void 0&&(s.forceRelay=clientConfigSettingToJSON(a.forceRelay)),s},create(a){return ClientConfiguration.fromPartial(a!=null?a:{})},fromPartial(a){var s,d;const c=createBaseClientConfiguration();return c.video=a.video!==void 0&&a.video!==null?VideoConfiguration.fromPartial(a.video):void 0,c.screen=a.screen!==void 0&&a.screen!==null?VideoConfiguration.fromPartial(a.screen):void 0,c.resumeConnection=(s=a.resumeConnection)!==null&&s!==void 0?s:0,c.disabledCodecs=a.disabledCodecs!==void 0&&a.disabledCodecs!==null?DisabledCodecs.fromPartial(a.disabledCodecs):void 0,c.forceRelay=(d=a.forceRelay)!==null&&d!==void 0?d:0,c}};function createBaseVideoConfiguration(){return{hardwareEncoder:0}}const VideoConfiguration={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();return a.hardwareEncoder!==0&&s.uint32(8).int32(a.hardwareEncoder),s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseVideoConfiguration();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.hardwareEncoder=d.int32();break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{hardwareEncoder:isSet$1(a.hardwareEncoder)?clientConfigSettingFromJSON(a.hardwareEncoder):0}},toJSON(a){const s={};return a.hardwareEncoder!==void 0&&(s.hardwareEncoder=clientConfigSettingToJSON(a.hardwareEncoder)),s},create(a){return VideoConfiguration.fromPartial(a!=null?a:{})},fromPartial(a){var s;const d=createBaseVideoConfiguration();return d.hardwareEncoder=(s=a.hardwareEncoder)!==null&&s!==void 0?s:0,d}};function createBaseDisabledCodecs(){return{codecs:[]}}const DisabledCodecs={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();for(const d of a.codecs)Codec.encode(d,s.uint32(10).fork()).ldelim();return s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseDisabledCodecs();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.codecs.push(Codec.decode(d,d.uint32()));break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{codecs:Array.isArray(a==null?void 0:a.codecs)?a.codecs.map(s=>Codec.fromJSON(s)):[]}},toJSON(a){const s={};return a.codecs?s.codecs=a.codecs.map(d=>d?Codec.toJSON(d):void 0):s.codecs=[],s},create(a){return DisabledCodecs.fromPartial(a!=null?a:{})},fromPartial(a){var s;const d=createBaseDisabledCodecs();return d.codecs=((s=a.codecs)===null||s===void 0?void 0:s.map(c=>Codec.fromPartial(c)))||[],d}};var tsProtoGlobalThis$1=(()=>{if(typeof globalThis!="undefined")return globalThis;if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global;throw"Unable to locate global object"})();function bytesFromBase64(a){if(tsProtoGlobalThis$1.Buffer)return Uint8Array.from(tsProtoGlobalThis$1.Buffer.from(a,"base64"));{const s=tsProtoGlobalThis$1.atob(a),d=new Uint8Array(s.length);for(let c=0;c<s.length;++c)d[c]=s.charCodeAt(c);return d}}function base64FromBytes(a){if(tsProtoGlobalThis$1.Buffer)return tsProtoGlobalThis$1.Buffer.from(a).toString("base64");{const s=[];return a.forEach(d=>{s.push(String.fromCharCode(d))}),tsProtoGlobalThis$1.btoa(s.join(""))}}function longToNumber$1(a){if(a.gt(Number.MAX_SAFE_INTEGER))throw new tsProtoGlobalThis$1.Error("Value is larger than Number.MAX_SAFE_INTEGER");return a.toNumber()}_m0.util.Long!==long&&(_m0.util.Long=long,_m0.configure());function isSet$1(a){return a!=null}const maxRetryDelay=7e3,DEFAULT_RETRY_DELAYS_IN_MS=[0,300,2*2*300,3*3*300,4*4*300,maxRetryDelay,maxRetryDelay,maxRetryDelay,maxRetryDelay,maxRetryDelay];class DefaultReconnectPolicy{constructor(s){this._retryDelays=s!==void 0?[...s]:DEFAULT_RETRY_DELAYS_IN_MS}nextRetryDelayInMs(s){if(s.retryCount>=this._retryDelays.length)return null;const d=this._retryDelays[s.retryCount];return s.retryCount<=1?d:d+Math.random()*1e3}}function _asyncIterator(a){var s,d,c,l=2;for(typeof Symbol!="undefined"&&(d=Symbol.asyncIterator,c=Symbol.iterator);l--;){if(d&&(s=a[d])!=null)return s.call(a);if(c&&(s=a[c])!=null)return new AsyncFromSyncIterator(s.call(a));d="@@asyncIterator",c="@@iterator"}throw new TypeError("Object is not async iterable")}function AsyncFromSyncIterator(a){function s(d){if(Object(d)!==d)return Promise.reject(new TypeError(d+" is not an object."));var c=d.done;return Promise.resolve(d.value).then(function(l){return{value:l,done:c}})}return AsyncFromSyncIterator=function(d){this.s=d,this.n=d.next},AsyncFromSyncIterator.prototype={s:null,n:null,next:function(){return s(this.n.apply(this.s,arguments))},return:function(d){var c=this.s.return;return c===void 0?Promise.resolve({value:d,done:!0}):s(c.apply(this.s,arguments))},throw:function(d){var c=this.s.return;return c===void 0?Promise.reject(d):s(c.apply(this.s,arguments))}},new AsyncFromSyncIterator(a)}function ownKeys(a,s){var d=Object.keys(a);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(a);s&&(c=c.filter(function(l){return Object.getOwnPropertyDescriptor(a,l).enumerable})),d.push.apply(d,c)}return d}function _objectSpread2(a){for(var s=1;s<arguments.length;s++){var d=arguments[s]!=null?arguments[s]:{};s%2?ownKeys(Object(d),!0).forEach(function(c){_defineProperty(a,c,d[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(d)):ownKeys(Object(d)).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(d,c))})}return a}function _defineProperty(a,s,d){return s=_toPropertyKey(s),s in a?Object.defineProperty(a,s,{value:d,enumerable:!0,configurable:!0,writable:!0}):a[s]=d,a}function _toPrimitive(a,s){if(typeof a!="object"||a===null)return a;var d=a[Symbol.toPrimitive];if(d!==void 0){var c=d.call(a,s||"default");if(typeof c!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _toPropertyKey(a){var s=_toPrimitive(a,"string");return typeof s=="symbol"?s:String(s)}let logDisabled_=!0,deprecationWarnings_=!0;function extractVersion(a,s,d){const c=a.match(s);return c&&c.length>=d&&parseInt(c[d],10)}function wrapPeerConnectionEvent(a,s,d){if(!a.RTCPeerConnection)return;const c=a.RTCPeerConnection.prototype,l=c.addEventListener;c.addEventListener=function(h,v){if(h!==s)return l.apply(this,arguments);const S=b=>{const _=d(b);_&&(v.handleEvent?v.handleEvent(_):v(_))};return this._eventMap=this._eventMap||{},this._eventMap[s]||(this._eventMap[s]=new Map),this._eventMap[s].set(v,S),l.apply(this,[h,S])};const p=c.removeEventListener;c.removeEventListener=function(h,v){if(h!==s||!this._eventMap||!this._eventMap[s])return p.apply(this,arguments);if(!this._eventMap[s].has(v))return p.apply(this,arguments);const S=this._eventMap[s].get(v);return this._eventMap[s].delete(v),this._eventMap[s].size===0&&delete this._eventMap[s],Object.keys(this._eventMap).length===0&&delete this._eventMap,p.apply(this,[h,S])},Object.defineProperty(c,"on"+s,{get(){return this["_on"+s]},set(h){this["_on"+s]&&(this.removeEventListener(s,this["_on"+s]),delete this["_on"+s]),h&&this.addEventListener(s,this["_on"+s]=h)},enumerable:!0,configurable:!0})}function disableLog(a){return typeof a!="boolean"?new Error("Argument type: "+typeof a+". Please use a boolean."):(logDisabled_=a,a?"adapter.js logging disabled":"adapter.js logging enabled")}function disableWarnings(a){return typeof a!="boolean"?new Error("Argument type: "+typeof a+". Please use a boolean."):(deprecationWarnings_=!a,"adapter.js deprecation warnings "+(a?"disabled":"enabled"))}function log(){if(typeof window=="object"){if(logDisabled_)return;typeof console!="undefined"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function deprecated(a,s){!deprecationWarnings_||console.warn(a+" is deprecated, please use "+s+" instead.")}function detectBrowser(a){const s={browser:null,version:null};if(typeof a=="undefined"||!a.navigator)return s.browser="Not a browser.",s;const{navigator:d}=a;if(d.mozGetUserMedia)s.browser="firefox",s.version=extractVersion(d.userAgent,/Firefox\/(\d+)\./,1);else if(d.webkitGetUserMedia||a.isSecureContext===!1&&a.webkitRTCPeerConnection&&!a.RTCIceGatherer)s.browser="chrome",s.version=extractVersion(d.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(a.RTCPeerConnection&&d.userAgent.match(/AppleWebKit\/(\d+)\./))s.browser="safari",s.version=extractVersion(d.userAgent,/AppleWebKit\/(\d+)\./,1),s.supportsUnifiedPlan=a.RTCRtpTransceiver&&"currentDirection"in a.RTCRtpTransceiver.prototype;else return s.browser="Not a supported browser.",s;return s}function isObject(a){return Object.prototype.toString.call(a)==="[object Object]"}function compactObject(a){return isObject(a)?Object.keys(a).reduce(function(s,d){const c=isObject(a[d]),l=c?compactObject(a[d]):a[d],p=c&&!Object.keys(l).length;return l===void 0||p?s:Object.assign(s,{[d]:l})},{}):a}function walkStats(a,s,d){!s||d.has(s.id)||(d.set(s.id,s),Object.keys(s).forEach(c=>{c.endsWith("Id")?walkStats(a,a.get(s[c]),d):c.endsWith("Ids")&&s[c].forEach(l=>{walkStats(a,a.get(l),d)})}))}function filterStats(a,s,d){const c=d?"outbound-rtp":"inbound-rtp",l=new Map;if(s===null)return l;const p=[];return a.forEach(h=>{h.type==="track"&&h.trackIdentifier===s.id&&p.push(h)}),p.forEach(h=>{a.forEach(v=>{v.type===c&&v.trackId===h.id&&walkStats(a,v,l)})}),l}const logging=log;function shimGetUserMedia$2(a,s){const d=a&&a.navigator;if(!d.mediaDevices)return;const c=function(v){if(typeof v!="object"||v.mandatory||v.optional)return v;const S={};return Object.keys(v).forEach(b=>{if(b==="require"||b==="advanced"||b==="mediaSource")return;const _=typeof v[b]=="object"?v[b]:{ideal:v[b]};_.exact!==void 0&&typeof _.exact=="number"&&(_.min=_.max=_.exact);const I=function(T,k){return T?T+k.charAt(0).toUpperCase()+k.slice(1):k==="deviceId"?"sourceId":k};if(_.ideal!==void 0){S.optional=S.optional||[];let T={};typeof _.ideal=="number"?(T[I("min",b)]=_.ideal,S.optional.push(T),T={},T[I("max",b)]=_.ideal,S.optional.push(T)):(T[I("",b)]=_.ideal,S.optional.push(T))}_.exact!==void 0&&typeof _.exact!="number"?(S.mandatory=S.mandatory||{},S.mandatory[I("",b)]=_.exact):["min","max"].forEach(T=>{_[T]!==void 0&&(S.mandatory=S.mandatory||{},S.mandatory[I(T,b)]=_[T])})}),v.advanced&&(S.optional=(S.optional||[]).concat(v.advanced)),S},l=function(v,S){if(s.version>=61)return S(v);if(v=JSON.parse(JSON.stringify(v)),v&&typeof v.audio=="object"){const b=function(_,I,T){I in _&&!(T in _)&&(_[T]=_[I],delete _[I])};v=JSON.parse(JSON.stringify(v)),b(v.audio,"autoGainControl","googAutoGainControl"),b(v.audio,"noiseSuppression","googNoiseSuppression"),v.audio=c(v.audio)}if(v&&typeof v.video=="object"){let b=v.video.facingMode;b=b&&(typeof b=="object"?b:{ideal:b});const _=s.version<66;if(b&&(b.exact==="user"||b.exact==="environment"||b.ideal==="user"||b.ideal==="environment")&&!(d.mediaDevices.getSupportedConstraints&&d.mediaDevices.getSupportedConstraints().facingMode&&!_)){delete v.video.facingMode;let I;if(b.exact==="environment"||b.ideal==="environment"?I=["back","rear"]:(b.exact==="user"||b.ideal==="user")&&(I=["front"]),I)return d.mediaDevices.enumerateDevices().then(T=>{T=T.filter(w=>w.kind==="videoinput");let k=T.find(w=>I.some(P=>w.label.toLowerCase().includes(P)));return!k&&T.length&&I.includes("back")&&(k=T[T.length-1]),k&&(v.video.deviceId=b.exact?{exact:k.deviceId}:{ideal:k.deviceId}),v.video=c(v.video),logging("chrome: "+JSON.stringify(v)),S(v)})}v.video=c(v.video)}return logging("chrome: "+JSON.stringify(v)),S(v)},p=function(v){return s.version>=64?v:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[v.name]||v.name,message:v.message,constraint:v.constraint||v.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},h=function(v,S,b){l(v,_=>{d.webkitGetUserMedia(_,S,I=>{b&&b(p(I))})})};if(d.getUserMedia=h.bind(d),d.mediaDevices.getUserMedia){const v=d.mediaDevices.getUserMedia.bind(d.mediaDevices);d.mediaDevices.getUserMedia=function(S){return l(S,b=>v(b).then(_=>{if(b.audio&&!_.getAudioTracks().length||b.video&&!_.getVideoTracks().length)throw _.getTracks().forEach(I=>{I.stop()}),new DOMException("","NotFoundError");return _},_=>Promise.reject(p(_))))}}}function shimGetDisplayMedia$1(a,s){if(!(a.navigator.mediaDevices&&"getDisplayMedia"in a.navigator.mediaDevices)&&!!a.navigator.mediaDevices){if(typeof s!="function"){console.error("shimGetDisplayMedia: getSourceId argument is not a function");return}a.navigator.mediaDevices.getDisplayMedia=function(c){return s(c).then(l=>{const p=c.video&&c.video.width,h=c.video&&c.video.height,v=c.video&&c.video.frameRate;return c.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:l,maxFrameRate:v||3}},p&&(c.video.mandatory.maxWidth=p),h&&(c.video.mandatory.maxHeight=h),a.navigator.mediaDevices.getUserMedia(c)})}}}function shimMediaStream(a){a.MediaStream=a.MediaStream||a.webkitMediaStream}function shimOnTrack$1(a){if(typeof a=="object"&&a.RTCPeerConnection&&!("ontrack"in a.RTCPeerConnection.prototype)){Object.defineProperty(a.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(d){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=d)},enumerable:!0,configurable:!0});const s=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=c=>{c.stream.addEventListener("addtrack",l=>{let p;a.RTCPeerConnection.prototype.getReceivers?p=this.getReceivers().find(v=>v.track&&v.track.id===l.track.id):p={track:l.track};const h=new Event("track");h.track=l.track,h.receiver=p,h.transceiver={receiver:p},h.streams=[c.stream],this.dispatchEvent(h)}),c.stream.getTracks().forEach(l=>{let p;a.RTCPeerConnection.prototype.getReceivers?p=this.getReceivers().find(v=>v.track&&v.track.id===l.id):p={track:l};const h=new Event("track");h.track=l,h.receiver=p,h.transceiver={receiver:p},h.streams=[c.stream],this.dispatchEvent(h)})},this.addEventListener("addstream",this._ontrackpoly)),s.apply(this,arguments)}}else wrapPeerConnectionEvent(a,"track",s=>(s.transceiver||Object.defineProperty(s,"transceiver",{value:{receiver:s.receiver}}),s))}function shimGetSendersWithDtmf(a){if(typeof a=="object"&&a.RTCPeerConnection&&!("getSenders"in a.RTCPeerConnection.prototype)&&"createDTMFSender"in a.RTCPeerConnection.prototype){const s=function(l,p){return{track:p,get dtmf(){return this._dtmf===void 0&&(p.kind==="audio"?this._dtmf=l.createDTMFSender(p):this._dtmf=null),this._dtmf},_pc:l}};if(!a.RTCPeerConnection.prototype.getSenders){a.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const l=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=function(v,S){let b=l.apply(this,arguments);return b||(b=s(this,v),this._senders.push(b)),b};const p=a.RTCPeerConnection.prototype.removeTrack;a.RTCPeerConnection.prototype.removeTrack=function(v){p.apply(this,arguments);const S=this._senders.indexOf(v);S!==-1&&this._senders.splice(S,1)}}const d=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(p){this._senders=this._senders||[],d.apply(this,[p]),p.getTracks().forEach(h=>{this._senders.push(s(this,h))})};const c=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(p){this._senders=this._senders||[],c.apply(this,[p]),p.getTracks().forEach(h=>{const v=this._senders.find(S=>S.track===h);v&&this._senders.splice(this._senders.indexOf(v),1)})}}else if(typeof a=="object"&&a.RTCPeerConnection&&"getSenders"in a.RTCPeerConnection.prototype&&"createDTMFSender"in a.RTCPeerConnection.prototype&&a.RTCRtpSender&&!("dtmf"in a.RTCRtpSender.prototype)){const s=a.RTCPeerConnection.prototype.getSenders;a.RTCPeerConnection.prototype.getSenders=function(){const c=s.apply(this,[]);return c.forEach(l=>l._pc=this),c},Object.defineProperty(a.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function shimGetStats(a){if(!a.RTCPeerConnection)return;const s=a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(){const[c,l,p]=arguments;if(arguments.length>0&&typeof c=="function")return s.apply(this,arguments);if(s.length===0&&(arguments.length===0||typeof c!="function"))return s.apply(this,[]);const h=function(S){const b={};return S.result().forEach(I=>{const T={id:I.id,timestamp:I.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[I.type]||I.type};I.names().forEach(k=>{T[k]=I.stat(k)}),b[T.id]=T}),b},v=function(S){return new Map(Object.keys(S).map(b=>[b,S[b]]))};if(arguments.length>=2){const S=function(b){l(v(h(b)))};return s.apply(this,[S,c])}return new Promise((S,b)=>{s.apply(this,[function(_){S(v(h(_)))},b])}).then(l,p)}}function shimSenderReceiverGetStats(a){if(!(typeof a=="object"&&a.RTCPeerConnection&&a.RTCRtpSender&&a.RTCRtpReceiver))return;if(!("getStats"in a.RTCRtpSender.prototype)){const d=a.RTCPeerConnection.prototype.getSenders;d&&(a.RTCPeerConnection.prototype.getSenders=function(){const p=d.apply(this,[]);return p.forEach(h=>h._pc=this),p});const c=a.RTCPeerConnection.prototype.addTrack;c&&(a.RTCPeerConnection.prototype.addTrack=function(){const p=c.apply(this,arguments);return p._pc=this,p}),a.RTCRtpSender.prototype.getStats=function(){const p=this;return this._pc.getStats().then(h=>filterStats(h,p.track,!0))}}if(!("getStats"in a.RTCRtpReceiver.prototype)){const d=a.RTCPeerConnection.prototype.getReceivers;d&&(a.RTCPeerConnection.prototype.getReceivers=function(){const l=d.apply(this,[]);return l.forEach(p=>p._pc=this),l}),wrapPeerConnectionEvent(a,"track",c=>(c.receiver._pc=c.srcElement,c)),a.RTCRtpReceiver.prototype.getStats=function(){const l=this;return this._pc.getStats().then(p=>filterStats(p,l.track,!1))}}if(!("getStats"in a.RTCRtpSender.prototype&&"getStats"in a.RTCRtpReceiver.prototype))return;const s=a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof a.MediaStreamTrack){const c=arguments[0];let l,p,h;return this.getSenders().forEach(v=>{v.track===c&&(l?h=!0:l=v)}),this.getReceivers().forEach(v=>(v.track===c&&(p?h=!0:p=v),v.track===c)),h||l&&p?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):l?l.getStats():p?p.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return s.apply(this,arguments)}}function shimAddTrackRemoveTrackWithNative(a){a.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(h=>this._shimmedLocalStreams[h][0])};const s=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=function(h,v){if(!v)return s.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const S=s.apply(this,arguments);return this._shimmedLocalStreams[v.id]?this._shimmedLocalStreams[v.id].indexOf(S)===-1&&this._shimmedLocalStreams[v.id].push(S):this._shimmedLocalStreams[v.id]=[v,S],S};const d=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(h){this._shimmedLocalStreams=this._shimmedLocalStreams||{},h.getTracks().forEach(b=>{if(this.getSenders().find(I=>I.track===b))throw new DOMException("Track already exists.","InvalidAccessError")});const v=this.getSenders();d.apply(this,arguments);const S=this.getSenders().filter(b=>v.indexOf(b)===-1);this._shimmedLocalStreams[h.id]=[h].concat(S)};const c=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(h){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[h.id],c.apply(this,arguments)};const l=a.RTCPeerConnection.prototype.removeTrack;a.RTCPeerConnection.prototype.removeTrack=function(h){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},h&&Object.keys(this._shimmedLocalStreams).forEach(v=>{const S=this._shimmedLocalStreams[v].indexOf(h);S!==-1&&this._shimmedLocalStreams[v].splice(S,1),this._shimmedLocalStreams[v].length===1&&delete this._shimmedLocalStreams[v]}),l.apply(this,arguments)}}function shimAddTrackRemoveTrack(a,s){if(!a.RTCPeerConnection)return;if(a.RTCPeerConnection.prototype.addTrack&&s.version>=65)return shimAddTrackRemoveTrackWithNative(a);const d=a.RTCPeerConnection.prototype.getLocalStreams;a.RTCPeerConnection.prototype.getLocalStreams=function(){const _=d.apply(this);return this._reverseStreams=this._reverseStreams||{},_.map(I=>this._reverseStreams[I.id])};const c=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(_){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},_.getTracks().forEach(I=>{if(this.getSenders().find(k=>k.track===I))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[_.id]){const I=new a.MediaStream(_.getTracks());this._streams[_.id]=I,this._reverseStreams[I.id]=_,_=I}c.apply(this,[_])};const l=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(_){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},l.apply(this,[this._streams[_.id]||_]),delete this._reverseStreams[this._streams[_.id]?this._streams[_.id].id:_.id],delete this._streams[_.id]},a.RTCPeerConnection.prototype.addTrack=function(_,I){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const T=[].slice.call(arguments,1);if(T.length!==1||!T[0].getTracks().find(P=>P===_))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(P=>P.track===_))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const w=this._streams[I.id];if(w)w.addTrack(_),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const P=new a.MediaStream([_]);this._streams[I.id]=P,this._reverseStreams[P.id]=I,this.addStream(P)}return this.getSenders().find(P=>P.track===_)};function p(b,_){let I=_.sdp;return Object.keys(b._reverseStreams||[]).forEach(T=>{const k=b._reverseStreams[T],w=b._streams[k.id];I=I.replace(new RegExp(w.id,"g"),k.id)}),new RTCSessionDescription({type:_.type,sdp:I})}function h(b,_){let I=_.sdp;return Object.keys(b._reverseStreams||[]).forEach(T=>{const k=b._reverseStreams[T],w=b._streams[k.id];I=I.replace(new RegExp(k.id,"g"),w.id)}),new RTCSessionDescription({type:_.type,sdp:I})}["createOffer","createAnswer"].forEach(function(b){const _=a.RTCPeerConnection.prototype[b],I={[b](){const T=arguments;return arguments.length&&typeof arguments[0]=="function"?_.apply(this,[w=>{const P=p(this,w);T[0].apply(null,[P])},w=>{T[1]&&T[1].apply(null,w)},arguments[2]]):_.apply(this,arguments).then(w=>p(this,w))}};a.RTCPeerConnection.prototype[b]=I[b]});const v=a.RTCPeerConnection.prototype.setLocalDescription;a.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?v.apply(this,arguments):(arguments[0]=h(this,arguments[0]),v.apply(this,arguments))};const S=Object.getOwnPropertyDescriptor(a.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(a.RTCPeerConnection.prototype,"localDescription",{get(){const b=S.get.apply(this);return b.type===""?b:p(this,b)}}),a.RTCPeerConnection.prototype.removeTrack=function(_){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!_._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(_._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let T;Object.keys(this._streams).forEach(k=>{this._streams[k].getTracks().find(P=>_.track===P)&&(T=this._streams[k])}),T&&(T.getTracks().length===1?this.removeStream(this._reverseStreams[T.id]):T.removeTrack(_.track),this.dispatchEvent(new Event("negotiationneeded")))}}function shimPeerConnection$1(a,s){!a.RTCPeerConnection&&a.webkitRTCPeerConnection&&(a.RTCPeerConnection=a.webkitRTCPeerConnection),!!a.RTCPeerConnection&&s.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(d){const c=a.RTCPeerConnection.prototype[d],l={[d](){return arguments[0]=new(d==="addIceCandidate"?a.RTCIceCandidate:a.RTCSessionDescription)(arguments[0]),c.apply(this,arguments)}};a.RTCPeerConnection.prototype[d]=l[d]})}function fixNegotiationNeeded(a,s){wrapPeerConnectionEvent(a,"negotiationneeded",d=>{const c=d.target;if(!((s.version<72||c.getConfiguration&&c.getConfiguration().sdpSemantics==="plan-b")&&c.signalingState!=="stable"))return d})}var chromeShim=Object.freeze({__proto__:null,fixNegotiationNeeded,shimAddTrackRemoveTrack,shimAddTrackRemoveTrackWithNative,shimGetDisplayMedia:shimGetDisplayMedia$1,shimGetSendersWithDtmf,shimGetStats,shimGetUserMedia:shimGetUserMedia$2,shimMediaStream,shimOnTrack:shimOnTrack$1,shimPeerConnection:shimPeerConnection$1,shimSenderReceiverGetStats});function shimGetUserMedia$1(a,s){const d=a&&a.navigator,c=a&&a.MediaStreamTrack;if(d.getUserMedia=function(l,p,h){deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),d.mediaDevices.getUserMedia(l).then(p,h)},!(s.version>55&&"autoGainControl"in d.mediaDevices.getSupportedConstraints())){const l=function(h,v,S){v in h&&!(S in h)&&(h[S]=h[v],delete h[v])},p=d.mediaDevices.getUserMedia.bind(d.mediaDevices);if(d.mediaDevices.getUserMedia=function(h){return typeof h=="object"&&typeof h.audio=="object"&&(h=JSON.parse(JSON.stringify(h)),l(h.audio,"autoGainControl","mozAutoGainControl"),l(h.audio,"noiseSuppression","mozNoiseSuppression")),p(h)},c&&c.prototype.getSettings){const h=c.prototype.getSettings;c.prototype.getSettings=function(){const v=h.apply(this,arguments);return l(v,"mozAutoGainControl","autoGainControl"),l(v,"mozNoiseSuppression","noiseSuppression"),v}}if(c&&c.prototype.applyConstraints){const h=c.prototype.applyConstraints;c.prototype.applyConstraints=function(v){return this.kind==="audio"&&typeof v=="object"&&(v=JSON.parse(JSON.stringify(v)),l(v,"autoGainControl","mozAutoGainControl"),l(v,"noiseSuppression","mozNoiseSuppression")),h.apply(this,[v])}}}}function shimGetDisplayMedia(a,s){a.navigator.mediaDevices&&"getDisplayMedia"in a.navigator.mediaDevices||!a.navigator.mediaDevices||(a.navigator.mediaDevices.getDisplayMedia=function(c){if(!(c&&c.video)){const l=new DOMException("getDisplayMedia without video constraints is undefined");return l.name="NotFoundError",l.code=8,Promise.reject(l)}return c.video===!0?c.video={mediaSource:s}:c.video.mediaSource=s,a.navigator.mediaDevices.getUserMedia(c)})}function shimOnTrack(a){typeof a=="object"&&a.RTCTrackEvent&&"receiver"in a.RTCTrackEvent.prototype&&!("transceiver"in a.RTCTrackEvent.prototype)&&Object.defineProperty(a.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function shimPeerConnection(a,s){if(typeof a!="object"||!(a.RTCPeerConnection||a.mozRTCPeerConnection))return;!a.RTCPeerConnection&&a.mozRTCPeerConnection&&(a.RTCPeerConnection=a.mozRTCPeerConnection),s.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(l){const p=a.RTCPeerConnection.prototype[l],h={[l](){return arguments[0]=new(l==="addIceCandidate"?a.RTCIceCandidate:a.RTCSessionDescription)(arguments[0]),p.apply(this,arguments)}};a.RTCPeerConnection.prototype[l]=h[l]});const d={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},c=a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(){const[p,h,v]=arguments;return c.apply(this,[p||null]).then(S=>{if(s.version<53&&!h)try{S.forEach(b=>{b.type=d[b.type]||b.type})}catch(b){if(b.name!=="TypeError")throw b;S.forEach((_,I)=>{S.set(I,Object.assign({},_,{type:d[_.type]||_.type}))})}return S}).then(h,v)}}function shimSenderGetStats(a){if(!(typeof a=="object"&&a.RTCPeerConnection&&a.RTCRtpSender)||a.RTCRtpSender&&"getStats"in a.RTCRtpSender.prototype)return;const s=a.RTCPeerConnection.prototype.getSenders;s&&(a.RTCPeerConnection.prototype.getSenders=function(){const l=s.apply(this,[]);return l.forEach(p=>p._pc=this),l});const d=a.RTCPeerConnection.prototype.addTrack;d&&(a.RTCPeerConnection.prototype.addTrack=function(){const l=d.apply(this,arguments);return l._pc=this,l}),a.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function shimReceiverGetStats(a){if(!(typeof a=="object"&&a.RTCPeerConnection&&a.RTCRtpSender)||a.RTCRtpSender&&"getStats"in a.RTCRtpReceiver.prototype)return;const s=a.RTCPeerConnection.prototype.getReceivers;s&&(a.RTCPeerConnection.prototype.getReceivers=function(){const c=s.apply(this,[]);return c.forEach(l=>l._pc=this),c}),wrapPeerConnectionEvent(a,"track",d=>(d.receiver._pc=d.srcElement,d)),a.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function shimRemoveStream(a){!a.RTCPeerConnection||"removeStream"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.removeStream=function(d){deprecated("removeStream","removeTrack"),this.getSenders().forEach(c=>{c.track&&d.getTracks().includes(c.track)&&this.removeTrack(c)})})}function shimRTCDataChannel(a){a.DataChannel&&!a.RTCDataChannel&&(a.RTCDataChannel=a.DataChannel)}function shimAddTransceiver(a){if(!(typeof a=="object"&&a.RTCPeerConnection))return;const s=a.RTCPeerConnection.prototype.addTransceiver;s&&(a.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];const c=arguments[1],l=c&&"sendEncodings"in c;l&&c.sendEncodings.forEach(h=>{if("rid"in h&&!/^[a-z0-9]{0,16}$/i.test(h.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in h&&!(parseFloat(h.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in h&&!(parseFloat(h.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const p=s.apply(this,arguments);if(l){const{sender:h}=p,v=h.getParameters();(!("encodings"in v)||v.encodings.length===1&&Object.keys(v.encodings[0]).length===0)&&(v.encodings=c.sendEncodings,h.sendEncodings=c.sendEncodings,this.setParametersPromises.push(h.setParameters(v).then(()=>{delete h.sendEncodings}).catch(()=>{delete h.sendEncodings})))}return p})}function shimGetParameters(a){if(!(typeof a=="object"&&a.RTCRtpSender))return;const s=a.RTCRtpSender.prototype.getParameters;s&&(a.RTCRtpSender.prototype.getParameters=function(){const c=s.apply(this,arguments);return"encodings"in c||(c.encodings=[].concat(this.sendEncodings||[{}])),c})}function shimCreateOffer(a){if(!(typeof a=="object"&&a.RTCPeerConnection))return;const s=a.RTCPeerConnection.prototype.createOffer;a.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>s.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):s.apply(this,arguments)}}function shimCreateAnswer(a){if(!(typeof a=="object"&&a.RTCPeerConnection))return;const s=a.RTCPeerConnection.prototype.createAnswer;a.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>s.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):s.apply(this,arguments)}}var firefoxShim=Object.freeze({__proto__:null,shimAddTransceiver,shimCreateAnswer,shimCreateOffer,shimGetDisplayMedia,shimGetParameters,shimGetUserMedia:shimGetUserMedia$1,shimOnTrack,shimPeerConnection,shimRTCDataChannel,shimReceiverGetStats,shimRemoveStream,shimSenderGetStats});function shimLocalStreamsAPI(a){if(!(typeof a!="object"||!a.RTCPeerConnection)){if("getLocalStreams"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in a.RTCPeerConnection.prototype)){const s=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addStream=function(c){this._localStreams||(this._localStreams=[]),this._localStreams.includes(c)||this._localStreams.push(c),c.getAudioTracks().forEach(l=>s.call(this,l,c)),c.getVideoTracks().forEach(l=>s.call(this,l,c))},a.RTCPeerConnection.prototype.addTrack=function(c){for(var l=arguments.length,p=new Array(l>1?l-1:0),h=1;h<l;h++)p[h-1]=arguments[h];return p&&p.forEach(v=>{this._localStreams?this._localStreams.includes(v)||this._localStreams.push(v):this._localStreams=[v]}),s.apply(this,arguments)}}"removeStream"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.removeStream=function(d){this._localStreams||(this._localStreams=[]);const c=this._localStreams.indexOf(d);if(c===-1)return;this._localStreams.splice(c,1);const l=d.getTracks();this.getSenders().forEach(p=>{l.includes(p.track)&&this.removeTrack(p)})})}}function shimRemoteStreamsAPI(a){if(!(typeof a!="object"||!a.RTCPeerConnection)&&("getRemoteStreams"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in a.RTCPeerConnection.prototype))){Object.defineProperty(a.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(d){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=d),this.addEventListener("track",this._onaddstreampoly=c=>{c.streams.forEach(l=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(l))return;this._remoteStreams.push(l);const p=new Event("addstream");p.stream=l,this.dispatchEvent(p)})})}});const s=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){const c=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(l){l.streams.forEach(p=>{if(c._remoteStreams||(c._remoteStreams=[]),c._remoteStreams.indexOf(p)>=0)return;c._remoteStreams.push(p);const h=new Event("addstream");h.stream=p,c.dispatchEvent(h)})}),s.apply(c,arguments)}}}function shimCallbacksAPI(a){if(typeof a!="object"||!a.RTCPeerConnection)return;const s=a.RTCPeerConnection.prototype,d=s.createOffer,c=s.createAnswer,l=s.setLocalDescription,p=s.setRemoteDescription,h=s.addIceCandidate;s.createOffer=function(b,_){const I=arguments.length>=2?arguments[2]:arguments[0],T=d.apply(this,[I]);return _?(T.then(b,_),Promise.resolve()):T},s.createAnswer=function(b,_){const I=arguments.length>=2?arguments[2]:arguments[0],T=c.apply(this,[I]);return _?(T.then(b,_),Promise.resolve()):T};let v=function(S,b,_){const I=l.apply(this,[S]);return _?(I.then(b,_),Promise.resolve()):I};s.setLocalDescription=v,v=function(S,b,_){const I=p.apply(this,[S]);return _?(I.then(b,_),Promise.resolve()):I},s.setRemoteDescription=v,v=function(S,b,_){const I=h.apply(this,[S]);return _?(I.then(b,_),Promise.resolve()):I},s.addIceCandidate=v}function shimGetUserMedia(a){const s=a&&a.navigator;if(s.mediaDevices&&s.mediaDevices.getUserMedia){const d=s.mediaDevices,c=d.getUserMedia.bind(d);s.mediaDevices.getUserMedia=l=>c(shimConstraints(l))}!s.getUserMedia&&s.mediaDevices&&s.mediaDevices.getUserMedia&&(s.getUserMedia=function(c,l,p){s.mediaDevices.getUserMedia(c).then(l,p)}.bind(s))}function shimConstraints(a){return a&&a.video!==void 0?Object.assign({},a,{video:compactObject(a.video)}):a}function shimRTCIceServerUrls(a){if(!a.RTCPeerConnection)return;const s=a.RTCPeerConnection;a.RTCPeerConnection=function(c,l){if(c&&c.iceServers){const p=[];for(let h=0;h<c.iceServers.length;h++){let v=c.iceServers[h];!v.hasOwnProperty("urls")&&v.hasOwnProperty("url")?(deprecated("RTCIceServer.url","RTCIceServer.urls"),v=JSON.parse(JSON.stringify(v)),v.urls=v.url,delete v.url,p.push(v)):p.push(c.iceServers[h])}c.iceServers=p}return new s(c,l)},a.RTCPeerConnection.prototype=s.prototype,"generateCertificate"in s&&Object.defineProperty(a.RTCPeerConnection,"generateCertificate",{get(){return s.generateCertificate}})}function shimTrackEventTransceiver(a){typeof a=="object"&&a.RTCTrackEvent&&"receiver"in a.RTCTrackEvent.prototype&&!("transceiver"in a.RTCTrackEvent.prototype)&&Object.defineProperty(a.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function shimCreateOfferLegacy(a){const s=a.RTCPeerConnection.prototype.createOffer;a.RTCPeerConnection.prototype.createOffer=function(c){if(c){typeof c.offerToReceiveAudio!="undefined"&&(c.offerToReceiveAudio=!!c.offerToReceiveAudio);const l=this.getTransceivers().find(h=>h.receiver.track.kind==="audio");c.offerToReceiveAudio===!1&&l?l.direction==="sendrecv"?l.setDirection?l.setDirection("sendonly"):l.direction="sendonly":l.direction==="recvonly"&&(l.setDirection?l.setDirection("inactive"):l.direction="inactive"):c.offerToReceiveAudio===!0&&!l&&this.addTransceiver("audio",{direction:"recvonly"}),typeof c.offerToReceiveVideo!="undefined"&&(c.offerToReceiveVideo=!!c.offerToReceiveVideo);const p=this.getTransceivers().find(h=>h.receiver.track.kind==="video");c.offerToReceiveVideo===!1&&p?p.direction==="sendrecv"?p.setDirection?p.setDirection("sendonly"):p.direction="sendonly":p.direction==="recvonly"&&(p.setDirection?p.setDirection("inactive"):p.direction="inactive"):c.offerToReceiveVideo===!0&&!p&&this.addTransceiver("video",{direction:"recvonly"})}return s.apply(this,arguments)}}function shimAudioContext(a){typeof a!="object"||a.AudioContext||(a.AudioContext=a.webkitAudioContext)}var safariShim=Object.freeze({__proto__:null,shimAudioContext,shimCallbacksAPI,shimConstraints,shimCreateOfferLegacy,shimGetUserMedia,shimLocalStreamsAPI,shimRTCIceServerUrls,shimRemoteStreamsAPI,shimTrackEventTransceiver}),sdpExports={},sdp$1={get exports(){return sdpExports},set exports(a){sdpExports=a}};(function(a){const s={};s.generateIdentifier=function(){return Math.random().toString(36).substr(2,10)},s.localCName=s.generateIdentifier(),s.splitLines=function(d){return d.trim().split(`
`).map(c=>c.trim())},s.splitSections=function(d){return d.split(`
m=`).map((l,p)=>(p>0?"m="+l:l).trim()+`\r
`)},s.getDescription=function(d){const c=s.splitSections(d);return c&&c[0]},s.getMediaSections=function(d){const c=s.splitSections(d);return c.shift(),c},s.matchPrefix=function(d,c){return s.splitLines(d).filter(l=>l.indexOf(c)===0)},s.parseCandidate=function(d){let c;d.indexOf("a=candidate:")===0?c=d.substring(12).split(" "):c=d.substring(10).split(" ");const l={foundation:c[0],component:{1:"rtp",2:"rtcp"}[c[1]]||c[1],protocol:c[2].toLowerCase(),priority:parseInt(c[3],10),ip:c[4],address:c[4],port:parseInt(c[5],10),type:c[7]};for(let p=8;p<c.length;p+=2)switch(c[p]){case"raddr":l.relatedAddress=c[p+1];break;case"rport":l.relatedPort=parseInt(c[p+1],10);break;case"tcptype":l.tcpType=c[p+1];break;case"ufrag":l.ufrag=c[p+1],l.usernameFragment=c[p+1];break;default:l[c[p]]===void 0&&(l[c[p]]=c[p+1]);break}return l},s.writeCandidate=function(d){const c=[];c.push(d.foundation);const l=d.component;l==="rtp"?c.push(1):l==="rtcp"?c.push(2):c.push(l),c.push(d.protocol.toUpperCase()),c.push(d.priority),c.push(d.address||d.ip),c.push(d.port);const p=d.type;return c.push("typ"),c.push(p),p!=="host"&&d.relatedAddress&&d.relatedPort&&(c.push("raddr"),c.push(d.relatedAddress),c.push("rport"),c.push(d.relatedPort)),d.tcpType&&d.protocol.toLowerCase()==="tcp"&&(c.push("tcptype"),c.push(d.tcpType)),(d.usernameFragment||d.ufrag)&&(c.push("ufrag"),c.push(d.usernameFragment||d.ufrag)),"candidate:"+c.join(" ")},s.parseIceOptions=function(d){return d.substr(14).split(" ")},s.parseRtpMap=function(d){let c=d.substr(9).split(" ");const l={payloadType:parseInt(c.shift(),10)};return c=c[0].split("/"),l.name=c[0],l.clockRate=parseInt(c[1],10),l.channels=c.length===3?parseInt(c[2],10):1,l.numChannels=l.channels,l},s.writeRtpMap=function(d){let c=d.payloadType;d.preferredPayloadType!==void 0&&(c=d.preferredPayloadType);const l=d.channels||d.numChannels||1;return"a=rtpmap:"+c+" "+d.name+"/"+d.clockRate+(l!==1?"/"+l:"")+`\r
`},s.parseExtmap=function(d){const c=d.substr(9).split(" ");return{id:parseInt(c[0],10),direction:c[0].indexOf("/")>0?c[0].split("/")[1]:"sendrecv",uri:c[1]}},s.writeExtmap=function(d){return"a=extmap:"+(d.id||d.preferredId)+(d.direction&&d.direction!=="sendrecv"?"/"+d.direction:"")+" "+d.uri+`\r
`},s.parseFmtp=function(d){const c={};let l;const p=d.substr(d.indexOf(" ")+1).split(";");for(let h=0;h<p.length;h++)l=p[h].trim().split("="),c[l[0].trim()]=l[1];return c},s.writeFmtp=function(d){let c="",l=d.payloadType;if(d.preferredPayloadType!==void 0&&(l=d.preferredPayloadType),d.parameters&&Object.keys(d.parameters).length){const p=[];Object.keys(d.parameters).forEach(h=>{d.parameters[h]!==void 0?p.push(h+"="+d.parameters[h]):p.push(h)}),c+="a=fmtp:"+l+" "+p.join(";")+`\r
`}return c},s.parseRtcpFb=function(d){const c=d.substr(d.indexOf(" ")+1).split(" ");return{type:c.shift(),parameter:c.join(" ")}},s.writeRtcpFb=function(d){let c="",l=d.payloadType;return d.preferredPayloadType!==void 0&&(l=d.preferredPayloadType),d.rtcpFeedback&&d.rtcpFeedback.length&&d.rtcpFeedback.forEach(p=>{c+="a=rtcp-fb:"+l+" "+p.type+(p.parameter&&p.parameter.length?" "+p.parameter:"")+`\r
`}),c},s.parseSsrcMedia=function(d){const c=d.indexOf(" "),l={ssrc:parseInt(d.substr(7,c-7),10)},p=d.indexOf(":",c);return p>-1?(l.attribute=d.substr(c+1,p-c-1),l.value=d.substr(p+1)):l.attribute=d.substr(c+1),l},s.parseSsrcGroup=function(d){const c=d.substr(13).split(" ");return{semantics:c.shift(),ssrcs:c.map(l=>parseInt(l,10))}},s.getMid=function(d){const c=s.matchPrefix(d,"a=mid:")[0];if(c)return c.substr(6)},s.parseFingerprint=function(d){const c=d.substr(14).split(" ");return{algorithm:c[0].toLowerCase(),value:c[1].toUpperCase()}},s.getDtlsParameters=function(d,c){const l=s.matchPrefix(d+c,"a=fingerprint:");return{role:"auto",fingerprints:l.map(s.parseFingerprint)}},s.writeDtlsParameters=function(d,c){let l="a=setup:"+c+`\r
`;return d.fingerprints.forEach(p=>{l+="a=fingerprint:"+p.algorithm+" "+p.value+`\r
`}),l},s.parseCryptoLine=function(d){const c=d.substr(9).split(" ");return{tag:parseInt(c[0],10),cryptoSuite:c[1],keyParams:c[2],sessionParams:c.slice(3)}},s.writeCryptoLine=function(d){return"a=crypto:"+d.tag+" "+d.cryptoSuite+" "+(typeof d.keyParams=="object"?s.writeCryptoKeyParams(d.keyParams):d.keyParams)+(d.sessionParams?" "+d.sessionParams.join(" "):"")+`\r
`},s.parseCryptoKeyParams=function(d){if(d.indexOf("inline:")!==0)return null;const c=d.substr(7).split("|");return{keyMethod:"inline",keySalt:c[0],lifeTime:c[1],mkiValue:c[2]?c[2].split(":")[0]:void 0,mkiLength:c[2]?c[2].split(":")[1]:void 0}},s.writeCryptoKeyParams=function(d){return d.keyMethod+":"+d.keySalt+(d.lifeTime?"|"+d.lifeTime:"")+(d.mkiValue&&d.mkiLength?"|"+d.mkiValue+":"+d.mkiLength:"")},s.getCryptoParameters=function(d,c){return s.matchPrefix(d+c,"a=crypto:").map(s.parseCryptoLine)},s.getIceParameters=function(d,c){const l=s.matchPrefix(d+c,"a=ice-ufrag:")[0],p=s.matchPrefix(d+c,"a=ice-pwd:")[0];return l&&p?{usernameFragment:l.substr(12),password:p.substr(10)}:null},s.writeIceParameters=function(d){let c="a=ice-ufrag:"+d.usernameFragment+`\r
a=ice-pwd:`+d.password+`\r
`;return d.iceLite&&(c+=`a=ice-lite\r
`),c},s.parseRtpParameters=function(d){const c={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},p=s.splitLines(d)[0].split(" ");for(let h=3;h<p.length;h++){const v=p[h],S=s.matchPrefix(d,"a=rtpmap:"+v+" ")[0];if(S){const b=s.parseRtpMap(S),_=s.matchPrefix(d,"a=fmtp:"+v+" ");switch(b.parameters=_.length?s.parseFmtp(_[0]):{},b.rtcpFeedback=s.matchPrefix(d,"a=rtcp-fb:"+v+" ").map(s.parseRtcpFb),c.codecs.push(b),b.name.toUpperCase()){case"RED":case"ULPFEC":c.fecMechanisms.push(b.name.toUpperCase());break}}}return s.matchPrefix(d,"a=extmap:").forEach(h=>{c.headerExtensions.push(s.parseExtmap(h))}),c},s.writeRtpDescription=function(d,c){let l="";l+="m="+d+" ",l+=c.codecs.length>0?"9":"0",l+=" UDP/TLS/RTP/SAVPF ",l+=c.codecs.map(h=>h.preferredPayloadType!==void 0?h.preferredPayloadType:h.payloadType).join(" ")+`\r
`,l+=`c=IN IP4 0.0.0.0\r
`,l+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,c.codecs.forEach(h=>{l+=s.writeRtpMap(h),l+=s.writeFmtp(h),l+=s.writeRtcpFb(h)});let p=0;return c.codecs.forEach(h=>{h.maxptime>p&&(p=h.maxptime)}),p>0&&(l+="a=maxptime:"+p+`\r
`),c.headerExtensions&&c.headerExtensions.forEach(h=>{l+=s.writeExtmap(h)}),l},s.parseRtpEncodingParameters=function(d){const c=[],l=s.parseRtpParameters(d),p=l.fecMechanisms.indexOf("RED")!==-1,h=l.fecMechanisms.indexOf("ULPFEC")!==-1,v=s.matchPrefix(d,"a=ssrc:").map(T=>s.parseSsrcMedia(T)).filter(T=>T.attribute==="cname"),S=v.length>0&&v[0].ssrc;let b;const _=s.matchPrefix(d,"a=ssrc-group:FID").map(T=>T.substr(17).split(" ").map(w=>parseInt(w,10)));_.length>0&&_[0].length>1&&_[0][0]===S&&(b=_[0][1]),l.codecs.forEach(T=>{if(T.name.toUpperCase()==="RTX"&&T.parameters.apt){let k={ssrc:S,codecPayloadType:parseInt(T.parameters.apt,10)};S&&b&&(k.rtx={ssrc:b}),c.push(k),p&&(k=JSON.parse(JSON.stringify(k)),k.fec={ssrc:S,mechanism:h?"red+ulpfec":"red"},c.push(k))}}),c.length===0&&S&&c.push({ssrc:S});let I=s.matchPrefix(d,"b=");return I.length&&(I[0].indexOf("b=TIAS:")===0?I=parseInt(I[0].substr(7),10):I[0].indexOf("b=AS:")===0?I=parseInt(I[0].substr(5),10)*1e3*.95-50*40*8:I=void 0,c.forEach(T=>{T.maxBitrate=I})),c},s.parseRtcpParameters=function(d){const c={},l=s.matchPrefix(d,"a=ssrc:").map(v=>s.parseSsrcMedia(v)).filter(v=>v.attribute==="cname")[0];l&&(c.cname=l.value,c.ssrc=l.ssrc);const p=s.matchPrefix(d,"a=rtcp-rsize");c.reducedSize=p.length>0,c.compound=p.length===0;const h=s.matchPrefix(d,"a=rtcp-mux");return c.mux=h.length>0,c},s.writeRtcpParameters=function(d){let c="";return d.reducedSize&&(c+=`a=rtcp-rsize\r
`),d.mux&&(c+=`a=rtcp-mux\r
`),d.ssrc!==void 0&&d.cname&&(c+="a=ssrc:"+d.ssrc+" cname:"+d.cname+`\r
`),c},s.parseMsid=function(d){let c;const l=s.matchPrefix(d,"a=msid:");if(l.length===1)return c=l[0].substr(7).split(" "),{stream:c[0],track:c[1]};const p=s.matchPrefix(d,"a=ssrc:").map(h=>s.parseSsrcMedia(h)).filter(h=>h.attribute==="msid");if(p.length>0)return c=p[0].value.split(" "),{stream:c[0],track:c[1]}},s.parseSctpDescription=function(d){const c=s.parseMLine(d),l=s.matchPrefix(d,"a=max-message-size:");let p;l.length>0&&(p=parseInt(l[0].substr(19),10)),isNaN(p)&&(p=65536);const h=s.matchPrefix(d,"a=sctp-port:");if(h.length>0)return{port:parseInt(h[0].substr(12),10),protocol:c.fmt,maxMessageSize:p};const v=s.matchPrefix(d,"a=sctpmap:");if(v.length>0){const S=v[0].substr(10).split(" ");return{port:parseInt(S[0],10),protocol:S[1],maxMessageSize:p}}},s.writeSctpDescription=function(d,c){let l=[];return d.protocol!=="DTLS/SCTP"?l=["m="+d.kind+" 9 "+d.protocol+" "+c.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+c.port+`\r
`]:l=["m="+d.kind+" 9 "+d.protocol+" "+c.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+c.port+" "+c.protocol+` 65535\r
`],c.maxMessageSize!==void 0&&l.push("a=max-message-size:"+c.maxMessageSize+`\r
`),l.join("")},s.generateSessionId=function(){return Math.random().toString().substr(2,21)},s.writeSessionBoilerplate=function(d,c,l){let p;const h=c!==void 0?c:2;return d?p=d:p=s.generateSessionId(),`v=0\r
o=`+(l||"thisisadapterortc")+" "+p+" "+h+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},s.getDirection=function(d,c){const l=s.splitLines(d);for(let p=0;p<l.length;p++)switch(l[p]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return l[p].substr(2)}return c?s.getDirection(c):"sendrecv"},s.getKind=function(d){return s.splitLines(d)[0].split(" ")[0].substr(2)},s.isRejected=function(d){return d.split(" ",2)[1]==="0"},s.parseMLine=function(d){const l=s.splitLines(d)[0].substr(2).split(" ");return{kind:l[0],port:parseInt(l[1],10),protocol:l[2],fmt:l.slice(3).join(" ")}},s.parseOLine=function(d){const l=s.matchPrefix(d,"o=")[0].substr(2).split(" ");return{username:l[0],sessionId:l[1],sessionVersion:parseInt(l[2],10),netType:l[3],addressType:l[4],address:l[5]}},s.isValidSDP=function(d){if(typeof d!="string"||d.length===0)return!1;const c=s.splitLines(d);for(let l=0;l<c.length;l++)if(c[l].length<2||c[l].charAt(1)!=="=")return!1;return!0},a.exports=s})(sdp$1);var SDPUtils=sdpExports,sdp=_mergeNamespaces$1({__proto__:null,default:SDPUtils},[sdpExports]);function shimRTCIceCandidate(a){if(!a.RTCIceCandidate||a.RTCIceCandidate&&"foundation"in a.RTCIceCandidate.prototype)return;const s=a.RTCIceCandidate;a.RTCIceCandidate=function(c){if(typeof c=="object"&&c.candidate&&c.candidate.indexOf("a=")===0&&(c=JSON.parse(JSON.stringify(c)),c.candidate=c.candidate.substr(2)),c.candidate&&c.candidate.length){const l=new s(c),p=SDPUtils.parseCandidate(c.candidate),h=Object.assign(l,p);return h.toJSON=function(){return{candidate:h.candidate,sdpMid:h.sdpMid,sdpMLineIndex:h.sdpMLineIndex,usernameFragment:h.usernameFragment}},h}return new s(c)},a.RTCIceCandidate.prototype=s.prototype,wrapPeerConnectionEvent(a,"icecandidate",d=>(d.candidate&&Object.defineProperty(d,"candidate",{value:new a.RTCIceCandidate(d.candidate),writable:"false"}),d))}function shimMaxMessageSize(a,s){if(!a.RTCPeerConnection)return;"sctp"in a.RTCPeerConnection.prototype||Object.defineProperty(a.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp=="undefined"?null:this._sctp}});const d=function(v){if(!v||!v.sdp)return!1;const S=SDPUtils.splitSections(v.sdp);return S.shift(),S.some(b=>{const _=SDPUtils.parseMLine(b);return _&&_.kind==="application"&&_.protocol.indexOf("SCTP")!==-1})},c=function(v){const S=v.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(S===null||S.length<2)return-1;const b=parseInt(S[1],10);return b!==b?-1:b},l=function(v){let S=65536;return s.browser==="firefox"&&(s.version<57?v===-1?S=16384:S=2147483637:s.version<60?S=s.version===57?65535:65536:S=2147483637),S},p=function(v,S){let b=65536;s.browser==="firefox"&&s.version===57&&(b=65535);const _=SDPUtils.matchPrefix(v.sdp,"a=max-message-size:");return _.length>0?b=parseInt(_[0].substr(19),10):s.browser==="firefox"&&S!==-1&&(b=2147483637),b},h=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,s.browser==="chrome"&&s.version>=76){const{sdpSemantics:S}=this.getConfiguration();S==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp=="undefined"?null:this._sctp},enumerable:!0,configurable:!0})}if(d(arguments[0])){const S=c(arguments[0]),b=l(S),_=p(arguments[0],S);let I;b===0&&_===0?I=Number.POSITIVE_INFINITY:b===0||_===0?I=Math.max(b,_):I=Math.min(b,_);const T={};Object.defineProperty(T,"maxMessageSize",{get(){return I}}),this._sctp=T}return h.apply(this,arguments)}}function shimSendThrowTypeError(a){if(!(a.RTCPeerConnection&&"createDataChannel"in a.RTCPeerConnection.prototype))return;function s(c,l){const p=c.send;c.send=function(){const v=arguments[0],S=v.length||v.size||v.byteLength;if(c.readyState==="open"&&l.sctp&&S>l.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+l.sctp.maxMessageSize+" bytes)");return p.apply(c,arguments)}}const d=a.RTCPeerConnection.prototype.createDataChannel;a.RTCPeerConnection.prototype.createDataChannel=function(){const l=d.apply(this,arguments);return s(l,this),l},wrapPeerConnectionEvent(a,"datachannel",c=>(s(c.channel,c.target),c))}function shimConnectionState(a){if(!a.RTCPeerConnection||"connectionState"in a.RTCPeerConnection.prototype)return;const s=a.RTCPeerConnection.prototype;Object.defineProperty(s,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(s,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(d){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),d&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=d)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(d=>{const c=s[d];s[d]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=l=>{const p=l.target;if(p._lastConnectionState!==p.connectionState){p._lastConnectionState=p.connectionState;const h=new Event("connectionstatechange",l);p.dispatchEvent(h)}return l},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),c.apply(this,arguments)}})}function removeExtmapAllowMixed(a,s){if(!a.RTCPeerConnection||s.browser==="chrome"&&s.version>=71||s.browser==="safari"&&s.version>=605)return;const d=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(l){if(l&&l.sdp&&l.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const p=l.sdp.split(`
`).filter(h=>h.trim()!=="a=extmap-allow-mixed").join(`
`);a.RTCSessionDescription&&l instanceof a.RTCSessionDescription?arguments[0]=new a.RTCSessionDescription({type:l.type,sdp:p}):l.sdp=p}return d.apply(this,arguments)}}function shimAddIceCandidateNullOrEmpty(a,s){if(!(a.RTCPeerConnection&&a.RTCPeerConnection.prototype))return;const d=a.RTCPeerConnection.prototype.addIceCandidate;!d||d.length===0||(a.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(s.browser==="chrome"&&s.version<78||s.browser==="firefox"&&s.version<68||s.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():d.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function shimParameterlessSetLocalDescription(a,s){if(!(a.RTCPeerConnection&&a.RTCPeerConnection.prototype))return;const d=a.RTCPeerConnection.prototype.setLocalDescription;!d||d.length===0||(a.RTCPeerConnection.prototype.setLocalDescription=function(){let l=arguments[0]||{};if(typeof l!="object"||l.type&&l.sdp)return d.apply(this,arguments);if(l={type:l.type,sdp:l.sdp},!l.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":l.type="offer";break;default:l.type="answer";break}return l.sdp||l.type!=="offer"&&l.type!=="answer"?d.apply(this,[l]):(l.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(h=>d.apply(this,[h]))})}var commonShim=Object.freeze({__proto__:null,removeExtmapAllowMixed,shimAddIceCandidateNullOrEmpty,shimConnectionState,shimMaxMessageSize,shimParameterlessSetLocalDescription,shimRTCIceCandidate,shimSendThrowTypeError});function adapterFactory(){let{window:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const d=log,c=detectBrowser(a),l={browserDetails:c,commonShim,extractVersion,disableLog,disableWarnings,sdp};switch(c.browser){case"chrome":if(!chromeShim||!shimPeerConnection$1||!s.shimChrome)return d("Chrome shim is not included in this adapter release."),l;if(c.version===null)return d("Chrome shim can not determine version, not shimming."),l;d("adapter.js shimming chrome."),l.browserShim=chromeShim,shimAddIceCandidateNullOrEmpty(a,c),shimParameterlessSetLocalDescription(a),shimGetUserMedia$2(a,c),shimMediaStream(a),shimPeerConnection$1(a,c),shimOnTrack$1(a),shimAddTrackRemoveTrack(a,c),shimGetSendersWithDtmf(a),shimGetStats(a),shimSenderReceiverGetStats(a),fixNegotiationNeeded(a,c),shimRTCIceCandidate(a),shimConnectionState(a),shimMaxMessageSize(a,c),shimSendThrowTypeError(a),removeExtmapAllowMixed(a,c);break;case"firefox":if(!firefoxShim||!shimPeerConnection||!s.shimFirefox)return d("Firefox shim is not included in this adapter release."),l;d("adapter.js shimming firefox."),l.browserShim=firefoxShim,shimAddIceCandidateNullOrEmpty(a,c),shimParameterlessSetLocalDescription(a),shimGetUserMedia$1(a,c),shimPeerConnection(a,c),shimOnTrack(a),shimRemoveStream(a),shimSenderGetStats(a),shimReceiverGetStats(a),shimRTCDataChannel(a),shimAddTransceiver(a),shimGetParameters(a),shimCreateOffer(a),shimCreateAnswer(a),shimRTCIceCandidate(a),shimConnectionState(a),shimMaxMessageSize(a,c),shimSendThrowTypeError(a);break;case"safari":if(!safariShim||!s.shimSafari)return d("Safari shim is not included in this adapter release."),l;d("adapter.js shimming safari."),l.browserShim=safariShim,shimAddIceCandidateNullOrEmpty(a,c),shimParameterlessSetLocalDescription(a),shimRTCIceServerUrls(a),shimCreateOfferLegacy(a),shimCallbacksAPI(a),shimLocalStreamsAPI(a),shimRemoteStreamsAPI(a),shimTrackEventTransceiver(a),shimGetUserMedia(a),shimAudioContext(a),shimRTCIceCandidate(a),shimMaxMessageSize(a,c),shimSendThrowTypeError(a),removeExtmapAllowMixed(a,c);break;default:d("Unsupported browser!");break}return l}adapterFactory({window:typeof window=="undefined"?void 0:window});var SignalTarget;(function(a){a[a.PUBLISHER=0]="PUBLISHER",a[a.SUBSCRIBER=1]="SUBSCRIBER",a[a.UNRECOGNIZED=-1]="UNRECOGNIZED"})(SignalTarget||(SignalTarget={}));function signalTargetFromJSON(a){switch(a){case 0:case"PUBLISHER":return SignalTarget.PUBLISHER;case 1:case"SUBSCRIBER":return SignalTarget.SUBSCRIBER;case-1:case"UNRECOGNIZED":default:return SignalTarget.UNRECOGNIZED}}function signalTargetToJSON(a){switch(a){case SignalTarget.PUBLISHER:return"PUBLISHER";case SignalTarget.SUBSCRIBER:return"SUBSCRIBER";case SignalTarget.UNRECOGNIZED:default:return"UNRECOGNIZED"}}var StreamState;(function(a){a[a.ACTIVE=0]="ACTIVE",a[a.PAUSED=1]="PAUSED",a[a.UNRECOGNIZED=-1]="UNRECOGNIZED"})(StreamState||(StreamState={}));function streamStateFromJSON(a){switch(a){case 0:case"ACTIVE":return StreamState.ACTIVE;case 1:case"PAUSED":return StreamState.PAUSED;case-1:case"UNRECOGNIZED":default:return StreamState.UNRECOGNIZED}}function streamStateToJSON(a){switch(a){case StreamState.ACTIVE:return"ACTIVE";case StreamState.PAUSED:return"PAUSED";case StreamState.UNRECOGNIZED:default:return"UNRECOGNIZED"}}var CandidateProtocol;(function(a){a[a.UDP=0]="UDP",a[a.TCP=1]="TCP",a[a.TLS=2]="TLS",a[a.UNRECOGNIZED=-1]="UNRECOGNIZED"})(CandidateProtocol||(CandidateProtocol={}));function candidateProtocolFromJSON(a){switch(a){case 0:case"UDP":return CandidateProtocol.UDP;case 1:case"TCP":return CandidateProtocol.TCP;case 2:case"TLS":return CandidateProtocol.TLS;case-1:case"UNRECOGNIZED":default:return CandidateProtocol.UNRECOGNIZED}}function candidateProtocolToJSON(a){switch(a){case CandidateProtocol.UDP:return"UDP";case CandidateProtocol.TCP:return"TCP";case CandidateProtocol.TLS:return"TLS";case CandidateProtocol.UNRECOGNIZED:default:return"UNRECOGNIZED"}}function createBaseSignalRequest(){return{message:void 0}}const SignalRequest={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();var d;switch((d=a.message)===null||d===void 0?void 0:d.$case){case"offer":SessionDescription.encode(a.message.offer,s.uint32(10).fork()).ldelim();break;case"answer":SessionDescription.encode(a.message.answer,s.uint32(18).fork()).ldelim();break;case"trickle":TrickleRequest.encode(a.message.trickle,s.uint32(26).fork()).ldelim();break;case"addTrack":AddTrackRequest.encode(a.message.addTrack,s.uint32(34).fork()).ldelim();break;case"mute":MuteTrackRequest.encode(a.message.mute,s.uint32(42).fork()).ldelim();break;case"subscription":UpdateSubscription.encode(a.message.subscription,s.uint32(50).fork()).ldelim();break;case"trackSetting":UpdateTrackSettings.encode(a.message.trackSetting,s.uint32(58).fork()).ldelim();break;case"leave":LeaveRequest.encode(a.message.leave,s.uint32(66).fork()).ldelim();break;case"updateLayers":UpdateVideoLayers.encode(a.message.updateLayers,s.uint32(82).fork()).ldelim();break;case"subscriptionPermission":SubscriptionPermission.encode(a.message.subscriptionPermission,s.uint32(90).fork()).ldelim();break;case"syncState":SyncState.encode(a.message.syncState,s.uint32(98).fork()).ldelim();break;case"simulate":SimulateScenario.encode(a.message.simulate,s.uint32(106).fork()).ldelim();break;case"ping":s.uint32(112).int64(a.message.ping);break;case"updateMetadata":UpdateParticipantMetadata.encode(a.message.updateMetadata,s.uint32(122).fork()).ldelim();break;case"pingReq":Ping.encode(a.message.pingReq,s.uint32(130).fork()).ldelim();break}return s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseSignalRequest();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.message={$case:"offer",offer:SessionDescription.decode(d,d.uint32())};break;case 2:l.message={$case:"answer",answer:SessionDescription.decode(d,d.uint32())};break;case 3:l.message={$case:"trickle",trickle:TrickleRequest.decode(d,d.uint32())};break;case 4:l.message={$case:"addTrack",addTrack:AddTrackRequest.decode(d,d.uint32())};break;case 5:l.message={$case:"mute",mute:MuteTrackRequest.decode(d,d.uint32())};break;case 6:l.message={$case:"subscription",subscription:UpdateSubscription.decode(d,d.uint32())};break;case 7:l.message={$case:"trackSetting",trackSetting:UpdateTrackSettings.decode(d,d.uint32())};break;case 8:l.message={$case:"leave",leave:LeaveRequest.decode(d,d.uint32())};break;case 10:l.message={$case:"updateLayers",updateLayers:UpdateVideoLayers.decode(d,d.uint32())};break;case 11:l.message={$case:"subscriptionPermission",subscriptionPermission:SubscriptionPermission.decode(d,d.uint32())};break;case 12:l.message={$case:"syncState",syncState:SyncState.decode(d,d.uint32())};break;case 13:l.message={$case:"simulate",simulate:SimulateScenario.decode(d,d.uint32())};break;case 14:l.message={$case:"ping",ping:longToNumber(d.int64())};break;case 15:l.message={$case:"updateMetadata",updateMetadata:UpdateParticipantMetadata.decode(d,d.uint32())};break;case 16:l.message={$case:"pingReq",pingReq:Ping.decode(d,d.uint32())};break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{message:isSet(a.offer)?{$case:"offer",offer:SessionDescription.fromJSON(a.offer)}:isSet(a.answer)?{$case:"answer",answer:SessionDescription.fromJSON(a.answer)}:isSet(a.trickle)?{$case:"trickle",trickle:TrickleRequest.fromJSON(a.trickle)}:isSet(a.addTrack)?{$case:"addTrack",addTrack:AddTrackRequest.fromJSON(a.addTrack)}:isSet(a.mute)?{$case:"mute",mute:MuteTrackRequest.fromJSON(a.mute)}:isSet(a.subscription)?{$case:"subscription",subscription:UpdateSubscription.fromJSON(a.subscription)}:isSet(a.trackSetting)?{$case:"trackSetting",trackSetting:UpdateTrackSettings.fromJSON(a.trackSetting)}:isSet(a.leave)?{$case:"leave",leave:LeaveRequest.fromJSON(a.leave)}:isSet(a.updateLayers)?{$case:"updateLayers",updateLayers:UpdateVideoLayers.fromJSON(a.updateLayers)}:isSet(a.subscriptionPermission)?{$case:"subscriptionPermission",subscriptionPermission:SubscriptionPermission.fromJSON(a.subscriptionPermission)}:isSet(a.syncState)?{$case:"syncState",syncState:SyncState.fromJSON(a.syncState)}:isSet(a.simulate)?{$case:"simulate",simulate:SimulateScenario.fromJSON(a.simulate)}:isSet(a.ping)?{$case:"ping",ping:Number(a.ping)}:isSet(a.updateMetadata)?{$case:"updateMetadata",updateMetadata:UpdateParticipantMetadata.fromJSON(a.updateMetadata)}:isSet(a.pingReq)?{$case:"pingReq",pingReq:Ping.fromJSON(a.pingReq)}:void 0}},toJSON(a){var s,d,c,l,p,h,v,S,b,_,I,T,k,w,P,$,U,E,D,F,J,G,x,Y,N,z,Z,L,V,H,de,X,K,oe,pe,me,ve,A,W,ee,ce,re,te,se;const le={};return((s=a.message)===null||s===void 0?void 0:s.$case)==="offer"&&(le.offer=!((d=a.message)===null||d===void 0)&&d.offer?SessionDescription.toJSON((c=a.message)===null||c===void 0?void 0:c.offer):void 0),((l=a.message)===null||l===void 0?void 0:l.$case)==="answer"&&(le.answer=!((p=a.message)===null||p===void 0)&&p.answer?SessionDescription.toJSON((h=a.message)===null||h===void 0?void 0:h.answer):void 0),((v=a.message)===null||v===void 0?void 0:v.$case)==="trickle"&&(le.trickle=!((S=a.message)===null||S===void 0)&&S.trickle?TrickleRequest.toJSON((b=a.message)===null||b===void 0?void 0:b.trickle):void 0),((_=a.message)===null||_===void 0?void 0:_.$case)==="addTrack"&&(le.addTrack=!((I=a.message)===null||I===void 0)&&I.addTrack?AddTrackRequest.toJSON((T=a.message)===null||T===void 0?void 0:T.addTrack):void 0),((k=a.message)===null||k===void 0?void 0:k.$case)==="mute"&&(le.mute=!((w=a.message)===null||w===void 0)&&w.mute?MuteTrackRequest.toJSON((P=a.message)===null||P===void 0?void 0:P.mute):void 0),(($=a.message)===null||$===void 0?void 0:$.$case)==="subscription"&&(le.subscription=!((U=a.message)===null||U===void 0)&&U.subscription?UpdateSubscription.toJSON((E=a.message)===null||E===void 0?void 0:E.subscription):void 0),((D=a.message)===null||D===void 0?void 0:D.$case)==="trackSetting"&&(le.trackSetting=!((F=a.message)===null||F===void 0)&&F.trackSetting?UpdateTrackSettings.toJSON((J=a.message)===null||J===void 0?void 0:J.trackSetting):void 0),((G=a.message)===null||G===void 0?void 0:G.$case)==="leave"&&(le.leave=!((x=a.message)===null||x===void 0)&&x.leave?LeaveRequest.toJSON((Y=a.message)===null||Y===void 0?void 0:Y.leave):void 0),((N=a.message)===null||N===void 0?void 0:N.$case)==="updateLayers"&&(le.updateLayers=!((z=a.message)===null||z===void 0)&&z.updateLayers?UpdateVideoLayers.toJSON((Z=a.message)===null||Z===void 0?void 0:Z.updateLayers):void 0),((L=a.message)===null||L===void 0?void 0:L.$case)==="subscriptionPermission"&&(le.subscriptionPermission=!((V=a.message)===null||V===void 0)&&V.subscriptionPermission?SubscriptionPermission.toJSON((H=a.message)===null||H===void 0?void 0:H.subscriptionPermission):void 0),((de=a.message)===null||de===void 0?void 0:de.$case)==="syncState"&&(le.syncState=!((X=a.message)===null||X===void 0)&&X.syncState?SyncState.toJSON((K=a.message)===null||K===void 0?void 0:K.syncState):void 0),((oe=a.message)===null||oe===void 0?void 0:oe.$case)==="simulate"&&(le.simulate=!((pe=a.message)===null||pe===void 0)&&pe.simulate?SimulateScenario.toJSON((me=a.message)===null||me===void 0?void 0:me.simulate):void 0),((ve=a.message)===null||ve===void 0?void 0:ve.$case)==="ping"&&(le.ping=Math.round((A=a.message)===null||A===void 0?void 0:A.ping)),((W=a.message)===null||W===void 0?void 0:W.$case)==="updateMetadata"&&(le.updateMetadata=!((ee=a.message)===null||ee===void 0)&&ee.updateMetadata?UpdateParticipantMetadata.toJSON((ce=a.message)===null||ce===void 0?void 0:ce.updateMetadata):void 0),((re=a.message)===null||re===void 0?void 0:re.$case)==="pingReq"&&(le.pingReq=!((te=a.message)===null||te===void 0)&&te.pingReq?Ping.toJSON((se=a.message)===null||se===void 0?void 0:se.pingReq):void 0),le},create(a){return SignalRequest.fromPartial(a!=null?a:{})},fromPartial(a){var s,d,c,l,p,h,v,S,b,_,I,T,k,w,P,$,U,E,D,F,J,G,x,Y,N,z,Z,L,V,H,de,X,K,oe,pe,me,ve,A,W,ee,ce,re,te,se,le;const ue=createBaseSignalRequest();return((s=a.message)===null||s===void 0?void 0:s.$case)==="offer"&&((d=a.message)===null||d===void 0?void 0:d.offer)!==void 0&&((c=a.message)===null||c===void 0?void 0:c.offer)!==null&&(ue.message={$case:"offer",offer:SessionDescription.fromPartial(a.message.offer)}),((l=a.message)===null||l===void 0?void 0:l.$case)==="answer"&&((p=a.message)===null||p===void 0?void 0:p.answer)!==void 0&&((h=a.message)===null||h===void 0?void 0:h.answer)!==null&&(ue.message={$case:"answer",answer:SessionDescription.fromPartial(a.message.answer)}),((v=a.message)===null||v===void 0?void 0:v.$case)==="trickle"&&((S=a.message)===null||S===void 0?void 0:S.trickle)!==void 0&&((b=a.message)===null||b===void 0?void 0:b.trickle)!==null&&(ue.message={$case:"trickle",trickle:TrickleRequest.fromPartial(a.message.trickle)}),((_=a.message)===null||_===void 0?void 0:_.$case)==="addTrack"&&((I=a.message)===null||I===void 0?void 0:I.addTrack)!==void 0&&((T=a.message)===null||T===void 0?void 0:T.addTrack)!==null&&(ue.message={$case:"addTrack",addTrack:AddTrackRequest.fromPartial(a.message.addTrack)}),((k=a.message)===null||k===void 0?void 0:k.$case)==="mute"&&((w=a.message)===null||w===void 0?void 0:w.mute)!==void 0&&((P=a.message)===null||P===void 0?void 0:P.mute)!==null&&(ue.message={$case:"mute",mute:MuteTrackRequest.fromPartial(a.message.mute)}),(($=a.message)===null||$===void 0?void 0:$.$case)==="subscription"&&((U=a.message)===null||U===void 0?void 0:U.subscription)!==void 0&&((E=a.message)===null||E===void 0?void 0:E.subscription)!==null&&(ue.message={$case:"subscription",subscription:UpdateSubscription.fromPartial(a.message.subscription)}),((D=a.message)===null||D===void 0?void 0:D.$case)==="trackSetting"&&((F=a.message)===null||F===void 0?void 0:F.trackSetting)!==void 0&&((J=a.message)===null||J===void 0?void 0:J.trackSetting)!==null&&(ue.message={$case:"trackSetting",trackSetting:UpdateTrackSettings.fromPartial(a.message.trackSetting)}),((G=a.message)===null||G===void 0?void 0:G.$case)==="leave"&&((x=a.message)===null||x===void 0?void 0:x.leave)!==void 0&&((Y=a.message)===null||Y===void 0?void 0:Y.leave)!==null&&(ue.message={$case:"leave",leave:LeaveRequest.fromPartial(a.message.leave)}),((N=a.message)===null||N===void 0?void 0:N.$case)==="updateLayers"&&((z=a.message)===null||z===void 0?void 0:z.updateLayers)!==void 0&&((Z=a.message)===null||Z===void 0?void 0:Z.updateLayers)!==null&&(ue.message={$case:"updateLayers",updateLayers:UpdateVideoLayers.fromPartial(a.message.updateLayers)}),((L=a.message)===null||L===void 0?void 0:L.$case)==="subscriptionPermission"&&((V=a.message)===null||V===void 0?void 0:V.subscriptionPermission)!==void 0&&((H=a.message)===null||H===void 0?void 0:H.subscriptionPermission)!==null&&(ue.message={$case:"subscriptionPermission",subscriptionPermission:SubscriptionPermission.fromPartial(a.message.subscriptionPermission)}),((de=a.message)===null||de===void 0?void 0:de.$case)==="syncState"&&((X=a.message)===null||X===void 0?void 0:X.syncState)!==void 0&&((K=a.message)===null||K===void 0?void 0:K.syncState)!==null&&(ue.message={$case:"syncState",syncState:SyncState.fromPartial(a.message.syncState)}),((oe=a.message)===null||oe===void 0?void 0:oe.$case)==="simulate"&&((pe=a.message)===null||pe===void 0?void 0:pe.simulate)!==void 0&&((me=a.message)===null||me===void 0?void 0:me.simulate)!==null&&(ue.message={$case:"simulate",simulate:SimulateScenario.fromPartial(a.message.simulate)}),((ve=a.message)===null||ve===void 0?void 0:ve.$case)==="ping"&&((A=a.message)===null||A===void 0?void 0:A.ping)!==void 0&&((W=a.message)===null||W===void 0?void 0:W.ping)!==null&&(ue.message={$case:"ping",ping:a.message.ping}),((ee=a.message)===null||ee===void 0?void 0:ee.$case)==="updateMetadata"&&((ce=a.message)===null||ce===void 0?void 0:ce.updateMetadata)!==void 0&&((re=a.message)===null||re===void 0?void 0:re.updateMetadata)!==null&&(ue.message={$case:"updateMetadata",updateMetadata:UpdateParticipantMetadata.fromPartial(a.message.updateMetadata)}),((te=a.message)===null||te===void 0?void 0:te.$case)==="pingReq"&&((se=a.message)===null||se===void 0?void 0:se.pingReq)!==void 0&&((le=a.message)===null||le===void 0?void 0:le.pingReq)!==null&&(ue.message={$case:"pingReq",pingReq:Ping.fromPartial(a.message.pingReq)}),ue}};function createBaseSignalResponse(){return{message:void 0}}const SignalResponse={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();var d;switch((d=a.message)===null||d===void 0?void 0:d.$case){case"join":JoinResponse.encode(a.message.join,s.uint32(10).fork()).ldelim();break;case"answer":SessionDescription.encode(a.message.answer,s.uint32(18).fork()).ldelim();break;case"offer":SessionDescription.encode(a.message.offer,s.uint32(26).fork()).ldelim();break;case"trickle":TrickleRequest.encode(a.message.trickle,s.uint32(34).fork()).ldelim();break;case"update":ParticipantUpdate.encode(a.message.update,s.uint32(42).fork()).ldelim();break;case"trackPublished":TrackPublishedResponse.encode(a.message.trackPublished,s.uint32(50).fork()).ldelim();break;case"leave":LeaveRequest.encode(a.message.leave,s.uint32(66).fork()).ldelim();break;case"mute":MuteTrackRequest.encode(a.message.mute,s.uint32(74).fork()).ldelim();break;case"speakersChanged":SpeakersChanged.encode(a.message.speakersChanged,s.uint32(82).fork()).ldelim();break;case"roomUpdate":RoomUpdate.encode(a.message.roomUpdate,s.uint32(90).fork()).ldelim();break;case"connectionQuality":ConnectionQualityUpdate.encode(a.message.connectionQuality,s.uint32(98).fork()).ldelim();break;case"streamStateUpdate":StreamStateUpdate.encode(a.message.streamStateUpdate,s.uint32(106).fork()).ldelim();break;case"subscribedQualityUpdate":SubscribedQualityUpdate.encode(a.message.subscribedQualityUpdate,s.uint32(114).fork()).ldelim();break;case"subscriptionPermissionUpdate":SubscriptionPermissionUpdate.encode(a.message.subscriptionPermissionUpdate,s.uint32(122).fork()).ldelim();break;case"refreshToken":s.uint32(130).string(a.message.refreshToken);break;case"trackUnpublished":TrackUnpublishedResponse.encode(a.message.trackUnpublished,s.uint32(138).fork()).ldelim();break;case"pong":s.uint32(144).int64(a.message.pong);break;case"reconnect":ReconnectResponse.encode(a.message.reconnect,s.uint32(154).fork()).ldelim();break;case"pongResp":Pong.encode(a.message.pongResp,s.uint32(162).fork()).ldelim();break}return s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseSignalResponse();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.message={$case:"join",join:JoinResponse.decode(d,d.uint32())};break;case 2:l.message={$case:"answer",answer:SessionDescription.decode(d,d.uint32())};break;case 3:l.message={$case:"offer",offer:SessionDescription.decode(d,d.uint32())};break;case 4:l.message={$case:"trickle",trickle:TrickleRequest.decode(d,d.uint32())};break;case 5:l.message={$case:"update",update:ParticipantUpdate.decode(d,d.uint32())};break;case 6:l.message={$case:"trackPublished",trackPublished:TrackPublishedResponse.decode(d,d.uint32())};break;case 8:l.message={$case:"leave",leave:LeaveRequest.decode(d,d.uint32())};break;case 9:l.message={$case:"mute",mute:MuteTrackRequest.decode(d,d.uint32())};break;case 10:l.message={$case:"speakersChanged",speakersChanged:SpeakersChanged.decode(d,d.uint32())};break;case 11:l.message={$case:"roomUpdate",roomUpdate:RoomUpdate.decode(d,d.uint32())};break;case 12:l.message={$case:"connectionQuality",connectionQuality:ConnectionQualityUpdate.decode(d,d.uint32())};break;case 13:l.message={$case:"streamStateUpdate",streamStateUpdate:StreamStateUpdate.decode(d,d.uint32())};break;case 14:l.message={$case:"subscribedQualityUpdate",subscribedQualityUpdate:SubscribedQualityUpdate.decode(d,d.uint32())};break;case 15:l.message={$case:"subscriptionPermissionUpdate",subscriptionPermissionUpdate:SubscriptionPermissionUpdate.decode(d,d.uint32())};break;case 16:l.message={$case:"refreshToken",refreshToken:d.string()};break;case 17:l.message={$case:"trackUnpublished",trackUnpublished:TrackUnpublishedResponse.decode(d,d.uint32())};break;case 18:l.message={$case:"pong",pong:longToNumber(d.int64())};break;case 19:l.message={$case:"reconnect",reconnect:ReconnectResponse.decode(d,d.uint32())};break;case 20:l.message={$case:"pongResp",pongResp:Pong.decode(d,d.uint32())};break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{message:isSet(a.join)?{$case:"join",join:JoinResponse.fromJSON(a.join)}:isSet(a.answer)?{$case:"answer",answer:SessionDescription.fromJSON(a.answer)}:isSet(a.offer)?{$case:"offer",offer:SessionDescription.fromJSON(a.offer)}:isSet(a.trickle)?{$case:"trickle",trickle:TrickleRequest.fromJSON(a.trickle)}:isSet(a.update)?{$case:"update",update:ParticipantUpdate.fromJSON(a.update)}:isSet(a.trackPublished)?{$case:"trackPublished",trackPublished:TrackPublishedResponse.fromJSON(a.trackPublished)}:isSet(a.leave)?{$case:"leave",leave:LeaveRequest.fromJSON(a.leave)}:isSet(a.mute)?{$case:"mute",mute:MuteTrackRequest.fromJSON(a.mute)}:isSet(a.speakersChanged)?{$case:"speakersChanged",speakersChanged:SpeakersChanged.fromJSON(a.speakersChanged)}:isSet(a.roomUpdate)?{$case:"roomUpdate",roomUpdate:RoomUpdate.fromJSON(a.roomUpdate)}:isSet(a.connectionQuality)?{$case:"connectionQuality",connectionQuality:ConnectionQualityUpdate.fromJSON(a.connectionQuality)}:isSet(a.streamStateUpdate)?{$case:"streamStateUpdate",streamStateUpdate:StreamStateUpdate.fromJSON(a.streamStateUpdate)}:isSet(a.subscribedQualityUpdate)?{$case:"subscribedQualityUpdate",subscribedQualityUpdate:SubscribedQualityUpdate.fromJSON(a.subscribedQualityUpdate)}:isSet(a.subscriptionPermissionUpdate)?{$case:"subscriptionPermissionUpdate",subscriptionPermissionUpdate:SubscriptionPermissionUpdate.fromJSON(a.subscriptionPermissionUpdate)}:isSet(a.refreshToken)?{$case:"refreshToken",refreshToken:String(a.refreshToken)}:isSet(a.trackUnpublished)?{$case:"trackUnpublished",trackUnpublished:TrackUnpublishedResponse.fromJSON(a.trackUnpublished)}:isSet(a.pong)?{$case:"pong",pong:Number(a.pong)}:isSet(a.reconnect)?{$case:"reconnect",reconnect:ReconnectResponse.fromJSON(a.reconnect)}:isSet(a.pongResp)?{$case:"pongResp",pongResp:Pong.fromJSON(a.pongResp)}:void 0}},toJSON(a){var s,d,c,l,p,h,v,S,b,_,I,T,k,w,P,$,U,E,D,F,J,G,x,Y,N,z,Z,L,V,H,de,X,K,oe,pe,me,ve,A,W,ee,ce,re,te,se,le,ue,De,Oe,qe,ke,$e,Ge,He,ge,ze;const ye={};return((s=a.message)===null||s===void 0?void 0:s.$case)==="join"&&(ye.join=!((d=a.message)===null||d===void 0)&&d.join?JoinResponse.toJSON((c=a.message)===null||c===void 0?void 0:c.join):void 0),((l=a.message)===null||l===void 0?void 0:l.$case)==="answer"&&(ye.answer=!((p=a.message)===null||p===void 0)&&p.answer?SessionDescription.toJSON((h=a.message)===null||h===void 0?void 0:h.answer):void 0),((v=a.message)===null||v===void 0?void 0:v.$case)==="offer"&&(ye.offer=!((S=a.message)===null||S===void 0)&&S.offer?SessionDescription.toJSON((b=a.message)===null||b===void 0?void 0:b.offer):void 0),((_=a.message)===null||_===void 0?void 0:_.$case)==="trickle"&&(ye.trickle=!((I=a.message)===null||I===void 0)&&I.trickle?TrickleRequest.toJSON((T=a.message)===null||T===void 0?void 0:T.trickle):void 0),((k=a.message)===null||k===void 0?void 0:k.$case)==="update"&&(ye.update=!((w=a.message)===null||w===void 0)&&w.update?ParticipantUpdate.toJSON((P=a.message)===null||P===void 0?void 0:P.update):void 0),(($=a.message)===null||$===void 0?void 0:$.$case)==="trackPublished"&&(ye.trackPublished=!((U=a.message)===null||U===void 0)&&U.trackPublished?TrackPublishedResponse.toJSON((E=a.message)===null||E===void 0?void 0:E.trackPublished):void 0),((D=a.message)===null||D===void 0?void 0:D.$case)==="leave"&&(ye.leave=!((F=a.message)===null||F===void 0)&&F.leave?LeaveRequest.toJSON((J=a.message)===null||J===void 0?void 0:J.leave):void 0),((G=a.message)===null||G===void 0?void 0:G.$case)==="mute"&&(ye.mute=!((x=a.message)===null||x===void 0)&&x.mute?MuteTrackRequest.toJSON((Y=a.message)===null||Y===void 0?void 0:Y.mute):void 0),((N=a.message)===null||N===void 0?void 0:N.$case)==="speakersChanged"&&(ye.speakersChanged=!((z=a.message)===null||z===void 0)&&z.speakersChanged?SpeakersChanged.toJSON((Z=a.message)===null||Z===void 0?void 0:Z.speakersChanged):void 0),((L=a.message)===null||L===void 0?void 0:L.$case)==="roomUpdate"&&(ye.roomUpdate=!((V=a.message)===null||V===void 0)&&V.roomUpdate?RoomUpdate.toJSON((H=a.message)===null||H===void 0?void 0:H.roomUpdate):void 0),((de=a.message)===null||de===void 0?void 0:de.$case)==="connectionQuality"&&(ye.connectionQuality=!((X=a.message)===null||X===void 0)&&X.connectionQuality?ConnectionQualityUpdate.toJSON((K=a.message)===null||K===void 0?void 0:K.connectionQuality):void 0),((oe=a.message)===null||oe===void 0?void 0:oe.$case)==="streamStateUpdate"&&(ye.streamStateUpdate=!((pe=a.message)===null||pe===void 0)&&pe.streamStateUpdate?StreamStateUpdate.toJSON((me=a.message)===null||me===void 0?void 0:me.streamStateUpdate):void 0),((ve=a.message)===null||ve===void 0?void 0:ve.$case)==="subscribedQualityUpdate"&&(ye.subscribedQualityUpdate=!((A=a.message)===null||A===void 0)&&A.subscribedQualityUpdate?SubscribedQualityUpdate.toJSON((W=a.message)===null||W===void 0?void 0:W.subscribedQualityUpdate):void 0),((ee=a.message)===null||ee===void 0?void 0:ee.$case)==="subscriptionPermissionUpdate"&&(ye.subscriptionPermissionUpdate=!((ce=a.message)===null||ce===void 0)&&ce.subscriptionPermissionUpdate?SubscriptionPermissionUpdate.toJSON((re=a.message)===null||re===void 0?void 0:re.subscriptionPermissionUpdate):void 0),((te=a.message)===null||te===void 0?void 0:te.$case)==="refreshToken"&&(ye.refreshToken=(se=a.message)===null||se===void 0?void 0:se.refreshToken),((le=a.message)===null||le===void 0?void 0:le.$case)==="trackUnpublished"&&(ye.trackUnpublished=!((ue=a.message)===null||ue===void 0)&&ue.trackUnpublished?TrackUnpublishedResponse.toJSON((De=a.message)===null||De===void 0?void 0:De.trackUnpublished):void 0),((Oe=a.message)===null||Oe===void 0?void 0:Oe.$case)==="pong"&&(ye.pong=Math.round((qe=a.message)===null||qe===void 0?void 0:qe.pong)),((ke=a.message)===null||ke===void 0?void 0:ke.$case)==="reconnect"&&(ye.reconnect=!(($e=a.message)===null||$e===void 0)&&$e.reconnect?ReconnectResponse.toJSON((Ge=a.message)===null||Ge===void 0?void 0:Ge.reconnect):void 0),((He=a.message)===null||He===void 0?void 0:He.$case)==="pongResp"&&(ye.pongResp=!((ge=a.message)===null||ge===void 0)&&ge.pongResp?Pong.toJSON((ze=a.message)===null||ze===void 0?void 0:ze.pongResp):void 0),ye},create(a){return SignalResponse.fromPartial(a!=null?a:{})},fromPartial(a){var s,d,c,l,p,h,v,S,b,_,I,T,k,w,P,$,U,E,D,F,J,G,x,Y,N,z,Z,L,V,H,de,X,K,oe,pe,me,ve,A,W,ee,ce,re,te,se,le,ue,De,Oe,qe,ke,$e,Ge,He,ge,ze,ye,Ye;const he=createBaseSignalResponse();return((s=a.message)===null||s===void 0?void 0:s.$case)==="join"&&((d=a.message)===null||d===void 0?void 0:d.join)!==void 0&&((c=a.message)===null||c===void 0?void 0:c.join)!==null&&(he.message={$case:"join",join:JoinResponse.fromPartial(a.message.join)}),((l=a.message)===null||l===void 0?void 0:l.$case)==="answer"&&((p=a.message)===null||p===void 0?void 0:p.answer)!==void 0&&((h=a.message)===null||h===void 0?void 0:h.answer)!==null&&(he.message={$case:"answer",answer:SessionDescription.fromPartial(a.message.answer)}),((v=a.message)===null||v===void 0?void 0:v.$case)==="offer"&&((S=a.message)===null||S===void 0?void 0:S.offer)!==void 0&&((b=a.message)===null||b===void 0?void 0:b.offer)!==null&&(he.message={$case:"offer",offer:SessionDescription.fromPartial(a.message.offer)}),((_=a.message)===null||_===void 0?void 0:_.$case)==="trickle"&&((I=a.message)===null||I===void 0?void 0:I.trickle)!==void 0&&((T=a.message)===null||T===void 0?void 0:T.trickle)!==null&&(he.message={$case:"trickle",trickle:TrickleRequest.fromPartial(a.message.trickle)}),((k=a.message)===null||k===void 0?void 0:k.$case)==="update"&&((w=a.message)===null||w===void 0?void 0:w.update)!==void 0&&((P=a.message)===null||P===void 0?void 0:P.update)!==null&&(he.message={$case:"update",update:ParticipantUpdate.fromPartial(a.message.update)}),(($=a.message)===null||$===void 0?void 0:$.$case)==="trackPublished"&&((U=a.message)===null||U===void 0?void 0:U.trackPublished)!==void 0&&((E=a.message)===null||E===void 0?void 0:E.trackPublished)!==null&&(he.message={$case:"trackPublished",trackPublished:TrackPublishedResponse.fromPartial(a.message.trackPublished)}),((D=a.message)===null||D===void 0?void 0:D.$case)==="leave"&&((F=a.message)===null||F===void 0?void 0:F.leave)!==void 0&&((J=a.message)===null||J===void 0?void 0:J.leave)!==null&&(he.message={$case:"leave",leave:LeaveRequest.fromPartial(a.message.leave)}),((G=a.message)===null||G===void 0?void 0:G.$case)==="mute"&&((x=a.message)===null||x===void 0?void 0:x.mute)!==void 0&&((Y=a.message)===null||Y===void 0?void 0:Y.mute)!==null&&(he.message={$case:"mute",mute:MuteTrackRequest.fromPartial(a.message.mute)}),((N=a.message)===null||N===void 0?void 0:N.$case)==="speakersChanged"&&((z=a.message)===null||z===void 0?void 0:z.speakersChanged)!==void 0&&((Z=a.message)===null||Z===void 0?void 0:Z.speakersChanged)!==null&&(he.message={$case:"speakersChanged",speakersChanged:SpeakersChanged.fromPartial(a.message.speakersChanged)}),((L=a.message)===null||L===void 0?void 0:L.$case)==="roomUpdate"&&((V=a.message)===null||V===void 0?void 0:V.roomUpdate)!==void 0&&((H=a.message)===null||H===void 0?void 0:H.roomUpdate)!==null&&(he.message={$case:"roomUpdate",roomUpdate:RoomUpdate.fromPartial(a.message.roomUpdate)}),((de=a.message)===null||de===void 0?void 0:de.$case)==="connectionQuality"&&((X=a.message)===null||X===void 0?void 0:X.connectionQuality)!==void 0&&((K=a.message)===null||K===void 0?void 0:K.connectionQuality)!==null&&(he.message={$case:"connectionQuality",connectionQuality:ConnectionQualityUpdate.fromPartial(a.message.connectionQuality)}),((oe=a.message)===null||oe===void 0?void 0:oe.$case)==="streamStateUpdate"&&((pe=a.message)===null||pe===void 0?void 0:pe.streamStateUpdate)!==void 0&&((me=a.message)===null||me===void 0?void 0:me.streamStateUpdate)!==null&&(he.message={$case:"streamStateUpdate",streamStateUpdate:StreamStateUpdate.fromPartial(a.message.streamStateUpdate)}),((ve=a.message)===null||ve===void 0?void 0:ve.$case)==="subscribedQualityUpdate"&&((A=a.message)===null||A===void 0?void 0:A.subscribedQualityUpdate)!==void 0&&((W=a.message)===null||W===void 0?void 0:W.subscribedQualityUpdate)!==null&&(he.message={$case:"subscribedQualityUpdate",subscribedQualityUpdate:SubscribedQualityUpdate.fromPartial(a.message.subscribedQualityUpdate)}),((ee=a.message)===null||ee===void 0?void 0:ee.$case)==="subscriptionPermissionUpdate"&&((ce=a.message)===null||ce===void 0?void 0:ce.subscriptionPermissionUpdate)!==void 0&&((re=a.message)===null||re===void 0?void 0:re.subscriptionPermissionUpdate)!==null&&(he.message={$case:"subscriptionPermissionUpdate",subscriptionPermissionUpdate:SubscriptionPermissionUpdate.fromPartial(a.message.subscriptionPermissionUpdate)}),((te=a.message)===null||te===void 0?void 0:te.$case)==="refreshToken"&&((se=a.message)===null||se===void 0?void 0:se.refreshToken)!==void 0&&((le=a.message)===null||le===void 0?void 0:le.refreshToken)!==null&&(he.message={$case:"refreshToken",refreshToken:a.message.refreshToken}),((ue=a.message)===null||ue===void 0?void 0:ue.$case)==="trackUnpublished"&&((De=a.message)===null||De===void 0?void 0:De.trackUnpublished)!==void 0&&((Oe=a.message)===null||Oe===void 0?void 0:Oe.trackUnpublished)!==null&&(he.message={$case:"trackUnpublished",trackUnpublished:TrackUnpublishedResponse.fromPartial(a.message.trackUnpublished)}),((qe=a.message)===null||qe===void 0?void 0:qe.$case)==="pong"&&((ke=a.message)===null||ke===void 0?void 0:ke.pong)!==void 0&&(($e=a.message)===null||$e===void 0?void 0:$e.pong)!==null&&(he.message={$case:"pong",pong:a.message.pong}),((Ge=a.message)===null||Ge===void 0?void 0:Ge.$case)==="reconnect"&&((He=a.message)===null||He===void 0?void 0:He.reconnect)!==void 0&&((ge=a.message)===null||ge===void 0?void 0:ge.reconnect)!==null&&(he.message={$case:"reconnect",reconnect:ReconnectResponse.fromPartial(a.message.reconnect)}),((ze=a.message)===null||ze===void 0?void 0:ze.$case)==="pongResp"&&((ye=a.message)===null||ye===void 0?void 0:ye.pongResp)!==void 0&&((Ye=a.message)===null||Ye===void 0?void 0:Ye.pongResp)!==null&&(he.message={$case:"pongResp",pongResp:Pong.fromPartial(a.message.pongResp)}),he}};function createBaseSimulcastCodec(){return{codec:"",cid:"",enableSimulcastLayers:!1}}const SimulcastCodec={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();return a.codec!==""&&s.uint32(10).string(a.codec),a.cid!==""&&s.uint32(18).string(a.cid),a.enableSimulcastLayers===!0&&s.uint32(24).bool(a.enableSimulcastLayers),s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseSimulcastCodec();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.codec=d.string();break;case 2:l.cid=d.string();break;case 3:l.enableSimulcastLayers=d.bool();break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{codec:isSet(a.codec)?String(a.codec):"",cid:isSet(a.cid)?String(a.cid):"",enableSimulcastLayers:isSet(a.enableSimulcastLayers)?Boolean(a.enableSimulcastLayers):!1}},toJSON(a){const s={};return a.codec!==void 0&&(s.codec=a.codec),a.cid!==void 0&&(s.cid=a.cid),a.enableSimulcastLayers!==void 0&&(s.enableSimulcastLayers=a.enableSimulcastLayers),s},create(a){return SimulcastCodec.fromPartial(a!=null?a:{})},fromPartial(a){var s,d,c;const l=createBaseSimulcastCodec();return l.codec=(s=a.codec)!==null&&s!==void 0?s:"",l.cid=(d=a.cid)!==null&&d!==void 0?d:"",l.enableSimulcastLayers=(c=a.enableSimulcastLayers)!==null&&c!==void 0?c:!1,l}};function createBaseAddTrackRequest(){return{cid:"",name:"",type:0,width:0,height:0,muted:!1,disableDtx:!1,source:0,layers:[],simulcastCodecs:[],sid:"",stereo:!1,disableRed:!1,encryption:0}}const AddTrackRequest={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();a.cid!==""&&s.uint32(10).string(a.cid),a.name!==""&&s.uint32(18).string(a.name),a.type!==0&&s.uint32(24).int32(a.type),a.width!==0&&s.uint32(32).uint32(a.width),a.height!==0&&s.uint32(40).uint32(a.height),a.muted===!0&&s.uint32(48).bool(a.muted),a.disableDtx===!0&&s.uint32(56).bool(a.disableDtx),a.source!==0&&s.uint32(64).int32(a.source);for(const d of a.layers)VideoLayer.encode(d,s.uint32(74).fork()).ldelim();for(const d of a.simulcastCodecs)SimulcastCodec.encode(d,s.uint32(82).fork()).ldelim();return a.sid!==""&&s.uint32(90).string(a.sid),a.stereo===!0&&s.uint32(96).bool(a.stereo),a.disableRed===!0&&s.uint32(104).bool(a.disableRed),a.encryption!==0&&s.uint32(112).int32(a.encryption),s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseAddTrackRequest();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.cid=d.string();break;case 2:l.name=d.string();break;case 3:l.type=d.int32();break;case 4:l.width=d.uint32();break;case 5:l.height=d.uint32();break;case 6:l.muted=d.bool();break;case 7:l.disableDtx=d.bool();break;case 8:l.source=d.int32();break;case 9:l.layers.push(VideoLayer.decode(d,d.uint32()));break;case 10:l.simulcastCodecs.push(SimulcastCodec.decode(d,d.uint32()));break;case 11:l.sid=d.string();break;case 12:l.stereo=d.bool();break;case 13:l.disableRed=d.bool();break;case 14:l.encryption=d.int32();break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{cid:isSet(a.cid)?String(a.cid):"",name:isSet(a.name)?String(a.name):"",type:isSet(a.type)?trackTypeFromJSON(a.type):0,width:isSet(a.width)?Number(a.width):0,height:isSet(a.height)?Number(a.height):0,muted:isSet(a.muted)?Boolean(a.muted):!1,disableDtx:isSet(a.disableDtx)?Boolean(a.disableDtx):!1,source:isSet(a.source)?trackSourceFromJSON(a.source):0,layers:Array.isArray(a==null?void 0:a.layers)?a.layers.map(s=>VideoLayer.fromJSON(s)):[],simulcastCodecs:Array.isArray(a==null?void 0:a.simulcastCodecs)?a.simulcastCodecs.map(s=>SimulcastCodec.fromJSON(s)):[],sid:isSet(a.sid)?String(a.sid):"",stereo:isSet(a.stereo)?Boolean(a.stereo):!1,disableRed:isSet(a.disableRed)?Boolean(a.disableRed):!1,encryption:isSet(a.encryption)?encryption_TypeFromJSON(a.encryption):0}},toJSON(a){const s={};return a.cid!==void 0&&(s.cid=a.cid),a.name!==void 0&&(s.name=a.name),a.type!==void 0&&(s.type=trackTypeToJSON(a.type)),a.width!==void 0&&(s.width=Math.round(a.width)),a.height!==void 0&&(s.height=Math.round(a.height)),a.muted!==void 0&&(s.muted=a.muted),a.disableDtx!==void 0&&(s.disableDtx=a.disableDtx),a.source!==void 0&&(s.source=trackSourceToJSON(a.source)),a.layers?s.layers=a.layers.map(d=>d?VideoLayer.toJSON(d):void 0):s.layers=[],a.simulcastCodecs?s.simulcastCodecs=a.simulcastCodecs.map(d=>d?SimulcastCodec.toJSON(d):void 0):s.simulcastCodecs=[],a.sid!==void 0&&(s.sid=a.sid),a.stereo!==void 0&&(s.stereo=a.stereo),a.disableRed!==void 0&&(s.disableRed=a.disableRed),a.encryption!==void 0&&(s.encryption=encryption_TypeToJSON(a.encryption)),s},create(a){return AddTrackRequest.fromPartial(a!=null?a:{})},fromPartial(a){var s,d,c,l,p,h,v,S,b,_,I,T,k,w;const P=createBaseAddTrackRequest();return P.cid=(s=a.cid)!==null&&s!==void 0?s:"",P.name=(d=a.name)!==null&&d!==void 0?d:"",P.type=(c=a.type)!==null&&c!==void 0?c:0,P.width=(l=a.width)!==null&&l!==void 0?l:0,P.height=(p=a.height)!==null&&p!==void 0?p:0,P.muted=(h=a.muted)!==null&&h!==void 0?h:!1,P.disableDtx=(v=a.disableDtx)!==null&&v!==void 0?v:!1,P.source=(S=a.source)!==null&&S!==void 0?S:0,P.layers=((b=a.layers)===null||b===void 0?void 0:b.map($=>VideoLayer.fromPartial($)))||[],P.simulcastCodecs=((_=a.simulcastCodecs)===null||_===void 0?void 0:_.map($=>SimulcastCodec.fromPartial($)))||[],P.sid=(I=a.sid)!==null&&I!==void 0?I:"",P.stereo=(T=a.stereo)!==null&&T!==void 0?T:!1,P.disableRed=(k=a.disableRed)!==null&&k!==void 0?k:!1,P.encryption=(w=a.encryption)!==null&&w!==void 0?w:0,P}};function createBaseTrickleRequest(){return{candidateInit:"",target:0}}const TrickleRequest={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();return a.candidateInit!==""&&s.uint32(10).string(a.candidateInit),a.target!==0&&s.uint32(16).int32(a.target),s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseTrickleRequest();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.candidateInit=d.string();break;case 2:l.target=d.int32();break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{candidateInit:isSet(a.candidateInit)?String(a.candidateInit):"",target:isSet(a.target)?signalTargetFromJSON(a.target):0}},toJSON(a){const s={};return a.candidateInit!==void 0&&(s.candidateInit=a.candidateInit),a.target!==void 0&&(s.target=signalTargetToJSON(a.target)),s},create(a){return TrickleRequest.fromPartial(a!=null?a:{})},fromPartial(a){var s,d;const c=createBaseTrickleRequest();return c.candidateInit=(s=a.candidateInit)!==null&&s!==void 0?s:"",c.target=(d=a.target)!==null&&d!==void 0?d:0,c}};function createBaseMuteTrackRequest(){return{sid:"",muted:!1}}const MuteTrackRequest={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();return a.sid!==""&&s.uint32(10).string(a.sid),a.muted===!0&&s.uint32(16).bool(a.muted),s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseMuteTrackRequest();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.sid=d.string();break;case 2:l.muted=d.bool();break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{sid:isSet(a.sid)?String(a.sid):"",muted:isSet(a.muted)?Boolean(a.muted):!1}},toJSON(a){const s={};return a.sid!==void 0&&(s.sid=a.sid),a.muted!==void 0&&(s.muted=a.muted),s},create(a){return MuteTrackRequest.fromPartial(a!=null?a:{})},fromPartial(a){var s,d;const c=createBaseMuteTrackRequest();return c.sid=(s=a.sid)!==null&&s!==void 0?s:"",c.muted=(d=a.muted)!==null&&d!==void 0?d:!1,c}};function createBaseJoinResponse(){return{room:void 0,participant:void 0,otherParticipants:[],serverVersion:"",iceServers:[],subscriberPrimary:!1,alternativeUrl:"",clientConfiguration:void 0,serverRegion:"",pingTimeout:0,pingInterval:0,serverInfo:void 0}}const JoinResponse={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();a.room!==void 0&&Room$1.encode(a.room,s.uint32(10).fork()).ldelim(),a.participant!==void 0&&ParticipantInfo.encode(a.participant,s.uint32(18).fork()).ldelim();for(const d of a.otherParticipants)ParticipantInfo.encode(d,s.uint32(26).fork()).ldelim();a.serverVersion!==""&&s.uint32(34).string(a.serverVersion);for(const d of a.iceServers)ICEServer.encode(d,s.uint32(42).fork()).ldelim();return a.subscriberPrimary===!0&&s.uint32(48).bool(a.subscriberPrimary),a.alternativeUrl!==""&&s.uint32(58).string(a.alternativeUrl),a.clientConfiguration!==void 0&&ClientConfiguration.encode(a.clientConfiguration,s.uint32(66).fork()).ldelim(),a.serverRegion!==""&&s.uint32(74).string(a.serverRegion),a.pingTimeout!==0&&s.uint32(80).int32(a.pingTimeout),a.pingInterval!==0&&s.uint32(88).int32(a.pingInterval),a.serverInfo!==void 0&&ServerInfo.encode(a.serverInfo,s.uint32(98).fork()).ldelim(),s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseJoinResponse();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.room=Room$1.decode(d,d.uint32());break;case 2:l.participant=ParticipantInfo.decode(d,d.uint32());break;case 3:l.otherParticipants.push(ParticipantInfo.decode(d,d.uint32()));break;case 4:l.serverVersion=d.string();break;case 5:l.iceServers.push(ICEServer.decode(d,d.uint32()));break;case 6:l.subscriberPrimary=d.bool();break;case 7:l.alternativeUrl=d.string();break;case 8:l.clientConfiguration=ClientConfiguration.decode(d,d.uint32());break;case 9:l.serverRegion=d.string();break;case 10:l.pingTimeout=d.int32();break;case 11:l.pingInterval=d.int32();break;case 12:l.serverInfo=ServerInfo.decode(d,d.uint32());break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{room:isSet(a.room)?Room$1.fromJSON(a.room):void 0,participant:isSet(a.participant)?ParticipantInfo.fromJSON(a.participant):void 0,otherParticipants:Array.isArray(a==null?void 0:a.otherParticipants)?a.otherParticipants.map(s=>ParticipantInfo.fromJSON(s)):[],serverVersion:isSet(a.serverVersion)?String(a.serverVersion):"",iceServers:Array.isArray(a==null?void 0:a.iceServers)?a.iceServers.map(s=>ICEServer.fromJSON(s)):[],subscriberPrimary:isSet(a.subscriberPrimary)?Boolean(a.subscriberPrimary):!1,alternativeUrl:isSet(a.alternativeUrl)?String(a.alternativeUrl):"",clientConfiguration:isSet(a.clientConfiguration)?ClientConfiguration.fromJSON(a.clientConfiguration):void 0,serverRegion:isSet(a.serverRegion)?String(a.serverRegion):"",pingTimeout:isSet(a.pingTimeout)?Number(a.pingTimeout):0,pingInterval:isSet(a.pingInterval)?Number(a.pingInterval):0,serverInfo:isSet(a.serverInfo)?ServerInfo.fromJSON(a.serverInfo):void 0}},toJSON(a){const s={};return a.room!==void 0&&(s.room=a.room?Room$1.toJSON(a.room):void 0),a.participant!==void 0&&(s.participant=a.participant?ParticipantInfo.toJSON(a.participant):void 0),a.otherParticipants?s.otherParticipants=a.otherParticipants.map(d=>d?ParticipantInfo.toJSON(d):void 0):s.otherParticipants=[],a.serverVersion!==void 0&&(s.serverVersion=a.serverVersion),a.iceServers?s.iceServers=a.iceServers.map(d=>d?ICEServer.toJSON(d):void 0):s.iceServers=[],a.subscriberPrimary!==void 0&&(s.subscriberPrimary=a.subscriberPrimary),a.alternativeUrl!==void 0&&(s.alternativeUrl=a.alternativeUrl),a.clientConfiguration!==void 0&&(s.clientConfiguration=a.clientConfiguration?ClientConfiguration.toJSON(a.clientConfiguration):void 0),a.serverRegion!==void 0&&(s.serverRegion=a.serverRegion),a.pingTimeout!==void 0&&(s.pingTimeout=Math.round(a.pingTimeout)),a.pingInterval!==void 0&&(s.pingInterval=Math.round(a.pingInterval)),a.serverInfo!==void 0&&(s.serverInfo=a.serverInfo?ServerInfo.toJSON(a.serverInfo):void 0),s},create(a){return JoinResponse.fromPartial(a!=null?a:{})},fromPartial(a){var s,d,c,l,p,h,v,S;const b=createBaseJoinResponse();return b.room=a.room!==void 0&&a.room!==null?Room$1.fromPartial(a.room):void 0,b.participant=a.participant!==void 0&&a.participant!==null?ParticipantInfo.fromPartial(a.participant):void 0,b.otherParticipants=((s=a.otherParticipants)===null||s===void 0?void 0:s.map(_=>ParticipantInfo.fromPartial(_)))||[],b.serverVersion=(d=a.serverVersion)!==null&&d!==void 0?d:"",b.iceServers=((c=a.iceServers)===null||c===void 0?void 0:c.map(_=>ICEServer.fromPartial(_)))||[],b.subscriberPrimary=(l=a.subscriberPrimary)!==null&&l!==void 0?l:!1,b.alternativeUrl=(p=a.alternativeUrl)!==null&&p!==void 0?p:"",b.clientConfiguration=a.clientConfiguration!==void 0&&a.clientConfiguration!==null?ClientConfiguration.fromPartial(a.clientConfiguration):void 0,b.serverRegion=(h=a.serverRegion)!==null&&h!==void 0?h:"",b.pingTimeout=(v=a.pingTimeout)!==null&&v!==void 0?v:0,b.pingInterval=(S=a.pingInterval)!==null&&S!==void 0?S:0,b.serverInfo=a.serverInfo!==void 0&&a.serverInfo!==null?ServerInfo.fromPartial(a.serverInfo):void 0,b}};function createBaseReconnectResponse(){return{iceServers:[],clientConfiguration:void 0}}const ReconnectResponse={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();for(const d of a.iceServers)ICEServer.encode(d,s.uint32(10).fork()).ldelim();return a.clientConfiguration!==void 0&&ClientConfiguration.encode(a.clientConfiguration,s.uint32(18).fork()).ldelim(),s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseReconnectResponse();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.iceServers.push(ICEServer.decode(d,d.uint32()));break;case 2:l.clientConfiguration=ClientConfiguration.decode(d,d.uint32());break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{iceServers:Array.isArray(a==null?void 0:a.iceServers)?a.iceServers.map(s=>ICEServer.fromJSON(s)):[],clientConfiguration:isSet(a.clientConfiguration)?ClientConfiguration.fromJSON(a.clientConfiguration):void 0}},toJSON(a){const s={};return a.iceServers?s.iceServers=a.iceServers.map(d=>d?ICEServer.toJSON(d):void 0):s.iceServers=[],a.clientConfiguration!==void 0&&(s.clientConfiguration=a.clientConfiguration?ClientConfiguration.toJSON(a.clientConfiguration):void 0),s},create(a){return ReconnectResponse.fromPartial(a!=null?a:{})},fromPartial(a){var s;const d=createBaseReconnectResponse();return d.iceServers=((s=a.iceServers)===null||s===void 0?void 0:s.map(c=>ICEServer.fromPartial(c)))||[],d.clientConfiguration=a.clientConfiguration!==void 0&&a.clientConfiguration!==null?ClientConfiguration.fromPartial(a.clientConfiguration):void 0,d}};function createBaseTrackPublishedResponse(){return{cid:"",track:void 0}}const TrackPublishedResponse={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();return a.cid!==""&&s.uint32(10).string(a.cid),a.track!==void 0&&TrackInfo.encode(a.track,s.uint32(18).fork()).ldelim(),s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseTrackPublishedResponse();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.cid=d.string();break;case 2:l.track=TrackInfo.decode(d,d.uint32());break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{cid:isSet(a.cid)?String(a.cid):"",track:isSet(a.track)?TrackInfo.fromJSON(a.track):void 0}},toJSON(a){const s={};return a.cid!==void 0&&(s.cid=a.cid),a.track!==void 0&&(s.track=a.track?TrackInfo.toJSON(a.track):void 0),s},create(a){return TrackPublishedResponse.fromPartial(a!=null?a:{})},fromPartial(a){var s;const d=createBaseTrackPublishedResponse();return d.cid=(s=a.cid)!==null&&s!==void 0?s:"",d.track=a.track!==void 0&&a.track!==null?TrackInfo.fromPartial(a.track):void 0,d}};function createBaseTrackUnpublishedResponse(){return{trackSid:""}}const TrackUnpublishedResponse={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();return a.trackSid!==""&&s.uint32(10).string(a.trackSid),s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseTrackUnpublishedResponse();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.trackSid=d.string();break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{trackSid:isSet(a.trackSid)?String(a.trackSid):""}},toJSON(a){const s={};return a.trackSid!==void 0&&(s.trackSid=a.trackSid),s},create(a){return TrackUnpublishedResponse.fromPartial(a!=null?a:{})},fromPartial(a){var s;const d=createBaseTrackUnpublishedResponse();return d.trackSid=(s=a.trackSid)!==null&&s!==void 0?s:"",d}};function createBaseSessionDescription(){return{type:"",sdp:""}}const SessionDescription={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();return a.type!==""&&s.uint32(10).string(a.type),a.sdp!==""&&s.uint32(18).string(a.sdp),s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseSessionDescription();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.type=d.string();break;case 2:l.sdp=d.string();break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{type:isSet(a.type)?String(a.type):"",sdp:isSet(a.sdp)?String(a.sdp):""}},toJSON(a){const s={};return a.type!==void 0&&(s.type=a.type),a.sdp!==void 0&&(s.sdp=a.sdp),s},create(a){return SessionDescription.fromPartial(a!=null?a:{})},fromPartial(a){var s,d;const c=createBaseSessionDescription();return c.type=(s=a.type)!==null&&s!==void 0?s:"",c.sdp=(d=a.sdp)!==null&&d!==void 0?d:"",c}};function createBaseParticipantUpdate(){return{participants:[]}}const ParticipantUpdate={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();for(const d of a.participants)ParticipantInfo.encode(d,s.uint32(10).fork()).ldelim();return s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseParticipantUpdate();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.participants.push(ParticipantInfo.decode(d,d.uint32()));break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{participants:Array.isArray(a==null?void 0:a.participants)?a.participants.map(s=>ParticipantInfo.fromJSON(s)):[]}},toJSON(a){const s={};return a.participants?s.participants=a.participants.map(d=>d?ParticipantInfo.toJSON(d):void 0):s.participants=[],s},create(a){return ParticipantUpdate.fromPartial(a!=null?a:{})},fromPartial(a){var s;const d=createBaseParticipantUpdate();return d.participants=((s=a.participants)===null||s===void 0?void 0:s.map(c=>ParticipantInfo.fromPartial(c)))||[],d}};function createBaseUpdateSubscription(){return{trackSids:[],subscribe:!1,participantTracks:[]}}const UpdateSubscription={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();for(const d of a.trackSids)s.uint32(10).string(d);a.subscribe===!0&&s.uint32(16).bool(a.subscribe);for(const d of a.participantTracks)ParticipantTracks.encode(d,s.uint32(26).fork()).ldelim();return s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseUpdateSubscription();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.trackSids.push(d.string());break;case 2:l.subscribe=d.bool();break;case 3:l.participantTracks.push(ParticipantTracks.decode(d,d.uint32()));break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{trackSids:Array.isArray(a==null?void 0:a.trackSids)?a.trackSids.map(s=>String(s)):[],subscribe:isSet(a.subscribe)?Boolean(a.subscribe):!1,participantTracks:Array.isArray(a==null?void 0:a.participantTracks)?a.participantTracks.map(s=>ParticipantTracks.fromJSON(s)):[]}},toJSON(a){const s={};return a.trackSids?s.trackSids=a.trackSids.map(d=>d):s.trackSids=[],a.subscribe!==void 0&&(s.subscribe=a.subscribe),a.participantTracks?s.participantTracks=a.participantTracks.map(d=>d?ParticipantTracks.toJSON(d):void 0):s.participantTracks=[],s},create(a){return UpdateSubscription.fromPartial(a!=null?a:{})},fromPartial(a){var s,d,c;const l=createBaseUpdateSubscription();return l.trackSids=((s=a.trackSids)===null||s===void 0?void 0:s.map(p=>p))||[],l.subscribe=(d=a.subscribe)!==null&&d!==void 0?d:!1,l.participantTracks=((c=a.participantTracks)===null||c===void 0?void 0:c.map(p=>ParticipantTracks.fromPartial(p)))||[],l}};function createBaseUpdateTrackSettings(){return{trackSids:[],disabled:!1,quality:0,width:0,height:0,fps:0,priority:0}}const UpdateTrackSettings={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();for(const d of a.trackSids)s.uint32(10).string(d);return a.disabled===!0&&s.uint32(24).bool(a.disabled),a.quality!==0&&s.uint32(32).int32(a.quality),a.width!==0&&s.uint32(40).uint32(a.width),a.height!==0&&s.uint32(48).uint32(a.height),a.fps!==0&&s.uint32(56).uint32(a.fps),a.priority!==0&&s.uint32(64).uint32(a.priority),s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseUpdateTrackSettings();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.trackSids.push(d.string());break;case 3:l.disabled=d.bool();break;case 4:l.quality=d.int32();break;case 5:l.width=d.uint32();break;case 6:l.height=d.uint32();break;case 7:l.fps=d.uint32();break;case 8:l.priority=d.uint32();break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{trackSids:Array.isArray(a==null?void 0:a.trackSids)?a.trackSids.map(s=>String(s)):[],disabled:isSet(a.disabled)?Boolean(a.disabled):!1,quality:isSet(a.quality)?videoQualityFromJSON(a.quality):0,width:isSet(a.width)?Number(a.width):0,height:isSet(a.height)?Number(a.height):0,fps:isSet(a.fps)?Number(a.fps):0,priority:isSet(a.priority)?Number(a.priority):0}},toJSON(a){const s={};return a.trackSids?s.trackSids=a.trackSids.map(d=>d):s.trackSids=[],a.disabled!==void 0&&(s.disabled=a.disabled),a.quality!==void 0&&(s.quality=videoQualityToJSON(a.quality)),a.width!==void 0&&(s.width=Math.round(a.width)),a.height!==void 0&&(s.height=Math.round(a.height)),a.fps!==void 0&&(s.fps=Math.round(a.fps)),a.priority!==void 0&&(s.priority=Math.round(a.priority)),s},create(a){return UpdateTrackSettings.fromPartial(a!=null?a:{})},fromPartial(a){var s,d,c,l,p,h,v;const S=createBaseUpdateTrackSettings();return S.trackSids=((s=a.trackSids)===null||s===void 0?void 0:s.map(b=>b))||[],S.disabled=(d=a.disabled)!==null&&d!==void 0?d:!1,S.quality=(c=a.quality)!==null&&c!==void 0?c:0,S.width=(l=a.width)!==null&&l!==void 0?l:0,S.height=(p=a.height)!==null&&p!==void 0?p:0,S.fps=(h=a.fps)!==null&&h!==void 0?h:0,S.priority=(v=a.priority)!==null&&v!==void 0?v:0,S}};function createBaseLeaveRequest(){return{canReconnect:!1,reason:0}}const LeaveRequest={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();return a.canReconnect===!0&&s.uint32(8).bool(a.canReconnect),a.reason!==0&&s.uint32(16).int32(a.reason),s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseLeaveRequest();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.canReconnect=d.bool();break;case 2:l.reason=d.int32();break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{canReconnect:isSet(a.canReconnect)?Boolean(a.canReconnect):!1,reason:isSet(a.reason)?disconnectReasonFromJSON(a.reason):0}},toJSON(a){const s={};return a.canReconnect!==void 0&&(s.canReconnect=a.canReconnect),a.reason!==void 0&&(s.reason=disconnectReasonToJSON(a.reason)),s},create(a){return LeaveRequest.fromPartial(a!=null?a:{})},fromPartial(a){var s,d;const c=createBaseLeaveRequest();return c.canReconnect=(s=a.canReconnect)!==null&&s!==void 0?s:!1,c.reason=(d=a.reason)!==null&&d!==void 0?d:0,c}};function createBaseUpdateVideoLayers(){return{trackSid:"",layers:[]}}const UpdateVideoLayers={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();a.trackSid!==""&&s.uint32(10).string(a.trackSid);for(const d of a.layers)VideoLayer.encode(d,s.uint32(18).fork()).ldelim();return s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseUpdateVideoLayers();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.trackSid=d.string();break;case 2:l.layers.push(VideoLayer.decode(d,d.uint32()));break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{trackSid:isSet(a.trackSid)?String(a.trackSid):"",layers:Array.isArray(a==null?void 0:a.layers)?a.layers.map(s=>VideoLayer.fromJSON(s)):[]}},toJSON(a){const s={};return a.trackSid!==void 0&&(s.trackSid=a.trackSid),a.layers?s.layers=a.layers.map(d=>d?VideoLayer.toJSON(d):void 0):s.layers=[],s},create(a){return UpdateVideoLayers.fromPartial(a!=null?a:{})},fromPartial(a){var s,d;const c=createBaseUpdateVideoLayers();return c.trackSid=(s=a.trackSid)!==null&&s!==void 0?s:"",c.layers=((d=a.layers)===null||d===void 0?void 0:d.map(l=>VideoLayer.fromPartial(l)))||[],c}};function createBaseUpdateParticipantMetadata(){return{metadata:""}}const UpdateParticipantMetadata={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();return a.metadata!==""&&s.uint32(10).string(a.metadata),s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseUpdateParticipantMetadata();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.metadata=d.string();break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{metadata:isSet(a.metadata)?String(a.metadata):""}},toJSON(a){const s={};return a.metadata!==void 0&&(s.metadata=a.metadata),s},create(a){return UpdateParticipantMetadata.fromPartial(a!=null?a:{})},fromPartial(a){var s;const d=createBaseUpdateParticipantMetadata();return d.metadata=(s=a.metadata)!==null&&s!==void 0?s:"",d}};function createBaseICEServer(){return{urls:[],username:"",credential:""}}const ICEServer={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();for(const d of a.urls)s.uint32(10).string(d);return a.username!==""&&s.uint32(18).string(a.username),a.credential!==""&&s.uint32(26).string(a.credential),s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseICEServer();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.urls.push(d.string());break;case 2:l.username=d.string();break;case 3:l.credential=d.string();break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{urls:Array.isArray(a==null?void 0:a.urls)?a.urls.map(s=>String(s)):[],username:isSet(a.username)?String(a.username):"",credential:isSet(a.credential)?String(a.credential):""}},toJSON(a){const s={};return a.urls?s.urls=a.urls.map(d=>d):s.urls=[],a.username!==void 0&&(s.username=a.username),a.credential!==void 0&&(s.credential=a.credential),s},create(a){return ICEServer.fromPartial(a!=null?a:{})},fromPartial(a){var s,d,c;const l=createBaseICEServer();return l.urls=((s=a.urls)===null||s===void 0?void 0:s.map(p=>p))||[],l.username=(d=a.username)!==null&&d!==void 0?d:"",l.credential=(c=a.credential)!==null&&c!==void 0?c:"",l}};function createBaseSpeakersChanged(){return{speakers:[]}}const SpeakersChanged={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();for(const d of a.speakers)SpeakerInfo.encode(d,s.uint32(10).fork()).ldelim();return s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseSpeakersChanged();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.speakers.push(SpeakerInfo.decode(d,d.uint32()));break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{speakers:Array.isArray(a==null?void 0:a.speakers)?a.speakers.map(s=>SpeakerInfo.fromJSON(s)):[]}},toJSON(a){const s={};return a.speakers?s.speakers=a.speakers.map(d=>d?SpeakerInfo.toJSON(d):void 0):s.speakers=[],s},create(a){return SpeakersChanged.fromPartial(a!=null?a:{})},fromPartial(a){var s;const d=createBaseSpeakersChanged();return d.speakers=((s=a.speakers)===null||s===void 0?void 0:s.map(c=>SpeakerInfo.fromPartial(c)))||[],d}};function createBaseRoomUpdate(){return{room:void 0}}const RoomUpdate={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();return a.room!==void 0&&Room$1.encode(a.room,s.uint32(10).fork()).ldelim(),s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseRoomUpdate();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.room=Room$1.decode(d,d.uint32());break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{room:isSet(a.room)?Room$1.fromJSON(a.room):void 0}},toJSON(a){const s={};return a.room!==void 0&&(s.room=a.room?Room$1.toJSON(a.room):void 0),s},create(a){return RoomUpdate.fromPartial(a!=null?a:{})},fromPartial(a){const s=createBaseRoomUpdate();return s.room=a.room!==void 0&&a.room!==null?Room$1.fromPartial(a.room):void 0,s}};function createBaseConnectionQualityInfo(){return{participantSid:"",quality:0,score:0}}const ConnectionQualityInfo={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();return a.participantSid!==""&&s.uint32(10).string(a.participantSid),a.quality!==0&&s.uint32(16).int32(a.quality),a.score!==0&&s.uint32(29).float(a.score),s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseConnectionQualityInfo();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.participantSid=d.string();break;case 2:l.quality=d.int32();break;case 3:l.score=d.float();break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{participantSid:isSet(a.participantSid)?String(a.participantSid):"",quality:isSet(a.quality)?connectionQualityFromJSON(a.quality):0,score:isSet(a.score)?Number(a.score):0}},toJSON(a){const s={};return a.participantSid!==void 0&&(s.participantSid=a.participantSid),a.quality!==void 0&&(s.quality=connectionQualityToJSON(a.quality)),a.score!==void 0&&(s.score=a.score),s},create(a){return ConnectionQualityInfo.fromPartial(a!=null?a:{})},fromPartial(a){var s,d,c;const l=createBaseConnectionQualityInfo();return l.participantSid=(s=a.participantSid)!==null&&s!==void 0?s:"",l.quality=(d=a.quality)!==null&&d!==void 0?d:0,l.score=(c=a.score)!==null&&c!==void 0?c:0,l}};function createBaseConnectionQualityUpdate(){return{updates:[]}}const ConnectionQualityUpdate={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();for(const d of a.updates)ConnectionQualityInfo.encode(d,s.uint32(10).fork()).ldelim();return s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseConnectionQualityUpdate();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.updates.push(ConnectionQualityInfo.decode(d,d.uint32()));break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{updates:Array.isArray(a==null?void 0:a.updates)?a.updates.map(s=>ConnectionQualityInfo.fromJSON(s)):[]}},toJSON(a){const s={};return a.updates?s.updates=a.updates.map(d=>d?ConnectionQualityInfo.toJSON(d):void 0):s.updates=[],s},create(a){return ConnectionQualityUpdate.fromPartial(a!=null?a:{})},fromPartial(a){var s;const d=createBaseConnectionQualityUpdate();return d.updates=((s=a.updates)===null||s===void 0?void 0:s.map(c=>ConnectionQualityInfo.fromPartial(c)))||[],d}};function createBaseStreamStateInfo(){return{participantSid:"",trackSid:"",state:0}}const StreamStateInfo={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();return a.participantSid!==""&&s.uint32(10).string(a.participantSid),a.trackSid!==""&&s.uint32(18).string(a.trackSid),a.state!==0&&s.uint32(24).int32(a.state),s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseStreamStateInfo();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.participantSid=d.string();break;case 2:l.trackSid=d.string();break;case 3:l.state=d.int32();break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{participantSid:isSet(a.participantSid)?String(a.participantSid):"",trackSid:isSet(a.trackSid)?String(a.trackSid):"",state:isSet(a.state)?streamStateFromJSON(a.state):0}},toJSON(a){const s={};return a.participantSid!==void 0&&(s.participantSid=a.participantSid),a.trackSid!==void 0&&(s.trackSid=a.trackSid),a.state!==void 0&&(s.state=streamStateToJSON(a.state)),s},create(a){return StreamStateInfo.fromPartial(a!=null?a:{})},fromPartial(a){var s,d,c;const l=createBaseStreamStateInfo();return l.participantSid=(s=a.participantSid)!==null&&s!==void 0?s:"",l.trackSid=(d=a.trackSid)!==null&&d!==void 0?d:"",l.state=(c=a.state)!==null&&c!==void 0?c:0,l}};function createBaseStreamStateUpdate(){return{streamStates:[]}}const StreamStateUpdate={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();for(const d of a.streamStates)StreamStateInfo.encode(d,s.uint32(10).fork()).ldelim();return s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseStreamStateUpdate();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.streamStates.push(StreamStateInfo.decode(d,d.uint32()));break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{streamStates:Array.isArray(a==null?void 0:a.streamStates)?a.streamStates.map(s=>StreamStateInfo.fromJSON(s)):[]}},toJSON(a){const s={};return a.streamStates?s.streamStates=a.streamStates.map(d=>d?StreamStateInfo.toJSON(d):void 0):s.streamStates=[],s},create(a){return StreamStateUpdate.fromPartial(a!=null?a:{})},fromPartial(a){var s;const d=createBaseStreamStateUpdate();return d.streamStates=((s=a.streamStates)===null||s===void 0?void 0:s.map(c=>StreamStateInfo.fromPartial(c)))||[],d}};function createBaseSubscribedQuality(){return{quality:0,enabled:!1}}const SubscribedQuality={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();return a.quality!==0&&s.uint32(8).int32(a.quality),a.enabled===!0&&s.uint32(16).bool(a.enabled),s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseSubscribedQuality();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.quality=d.int32();break;case 2:l.enabled=d.bool();break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{quality:isSet(a.quality)?videoQualityFromJSON(a.quality):0,enabled:isSet(a.enabled)?Boolean(a.enabled):!1}},toJSON(a){const s={};return a.quality!==void 0&&(s.quality=videoQualityToJSON(a.quality)),a.enabled!==void 0&&(s.enabled=a.enabled),s},create(a){return SubscribedQuality.fromPartial(a!=null?a:{})},fromPartial(a){var s,d;const c=createBaseSubscribedQuality();return c.quality=(s=a.quality)!==null&&s!==void 0?s:0,c.enabled=(d=a.enabled)!==null&&d!==void 0?d:!1,c}};function createBaseSubscribedCodec(){return{codec:"",qualities:[]}}const SubscribedCodec={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();a.codec!==""&&s.uint32(10).string(a.codec);for(const d of a.qualities)SubscribedQuality.encode(d,s.uint32(18).fork()).ldelim();return s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseSubscribedCodec();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.codec=d.string();break;case 2:l.qualities.push(SubscribedQuality.decode(d,d.uint32()));break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{codec:isSet(a.codec)?String(a.codec):"",qualities:Array.isArray(a==null?void 0:a.qualities)?a.qualities.map(s=>SubscribedQuality.fromJSON(s)):[]}},toJSON(a){const s={};return a.codec!==void 0&&(s.codec=a.codec),a.qualities?s.qualities=a.qualities.map(d=>d?SubscribedQuality.toJSON(d):void 0):s.qualities=[],s},create(a){return SubscribedCodec.fromPartial(a!=null?a:{})},fromPartial(a){var s,d;const c=createBaseSubscribedCodec();return c.codec=(s=a.codec)!==null&&s!==void 0?s:"",c.qualities=((d=a.qualities)===null||d===void 0?void 0:d.map(l=>SubscribedQuality.fromPartial(l)))||[],c}};function createBaseSubscribedQualityUpdate(){return{trackSid:"",subscribedQualities:[],subscribedCodecs:[]}}const SubscribedQualityUpdate={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();a.trackSid!==""&&s.uint32(10).string(a.trackSid);for(const d of a.subscribedQualities)SubscribedQuality.encode(d,s.uint32(18).fork()).ldelim();for(const d of a.subscribedCodecs)SubscribedCodec.encode(d,s.uint32(26).fork()).ldelim();return s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseSubscribedQualityUpdate();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.trackSid=d.string();break;case 2:l.subscribedQualities.push(SubscribedQuality.decode(d,d.uint32()));break;case 3:l.subscribedCodecs.push(SubscribedCodec.decode(d,d.uint32()));break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{trackSid:isSet(a.trackSid)?String(a.trackSid):"",subscribedQualities:Array.isArray(a==null?void 0:a.subscribedQualities)?a.subscribedQualities.map(s=>SubscribedQuality.fromJSON(s)):[],subscribedCodecs:Array.isArray(a==null?void 0:a.subscribedCodecs)?a.subscribedCodecs.map(s=>SubscribedCodec.fromJSON(s)):[]}},toJSON(a){const s={};return a.trackSid!==void 0&&(s.trackSid=a.trackSid),a.subscribedQualities?s.subscribedQualities=a.subscribedQualities.map(d=>d?SubscribedQuality.toJSON(d):void 0):s.subscribedQualities=[],a.subscribedCodecs?s.subscribedCodecs=a.subscribedCodecs.map(d=>d?SubscribedCodec.toJSON(d):void 0):s.subscribedCodecs=[],s},create(a){return SubscribedQualityUpdate.fromPartial(a!=null?a:{})},fromPartial(a){var s,d,c;const l=createBaseSubscribedQualityUpdate();return l.trackSid=(s=a.trackSid)!==null&&s!==void 0?s:"",l.subscribedQualities=((d=a.subscribedQualities)===null||d===void 0?void 0:d.map(p=>SubscribedQuality.fromPartial(p)))||[],l.subscribedCodecs=((c=a.subscribedCodecs)===null||c===void 0?void 0:c.map(p=>SubscribedCodec.fromPartial(p)))||[],l}};function createBaseTrackPermission(){return{participantSid:"",allTracks:!1,trackSids:[],participantIdentity:""}}const TrackPermission={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();a.participantSid!==""&&s.uint32(10).string(a.participantSid),a.allTracks===!0&&s.uint32(16).bool(a.allTracks);for(const d of a.trackSids)s.uint32(26).string(d);return a.participantIdentity!==""&&s.uint32(34).string(a.participantIdentity),s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseTrackPermission();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.participantSid=d.string();break;case 2:l.allTracks=d.bool();break;case 3:l.trackSids.push(d.string());break;case 4:l.participantIdentity=d.string();break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{participantSid:isSet(a.participantSid)?String(a.participantSid):"",allTracks:isSet(a.allTracks)?Boolean(a.allTracks):!1,trackSids:Array.isArray(a==null?void 0:a.trackSids)?a.trackSids.map(s=>String(s)):[],participantIdentity:isSet(a.participantIdentity)?String(a.participantIdentity):""}},toJSON(a){const s={};return a.participantSid!==void 0&&(s.participantSid=a.participantSid),a.allTracks!==void 0&&(s.allTracks=a.allTracks),a.trackSids?s.trackSids=a.trackSids.map(d=>d):s.trackSids=[],a.participantIdentity!==void 0&&(s.participantIdentity=a.participantIdentity),s},create(a){return TrackPermission.fromPartial(a!=null?a:{})},fromPartial(a){var s,d,c,l;const p=createBaseTrackPermission();return p.participantSid=(s=a.participantSid)!==null&&s!==void 0?s:"",p.allTracks=(d=a.allTracks)!==null&&d!==void 0?d:!1,p.trackSids=((c=a.trackSids)===null||c===void 0?void 0:c.map(h=>h))||[],p.participantIdentity=(l=a.participantIdentity)!==null&&l!==void 0?l:"",p}};function createBaseSubscriptionPermission(){return{allParticipants:!1,trackPermissions:[]}}const SubscriptionPermission={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();a.allParticipants===!0&&s.uint32(8).bool(a.allParticipants);for(const d of a.trackPermissions)TrackPermission.encode(d,s.uint32(18).fork()).ldelim();return s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseSubscriptionPermission();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.allParticipants=d.bool();break;case 2:l.trackPermissions.push(TrackPermission.decode(d,d.uint32()));break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{allParticipants:isSet(a.allParticipants)?Boolean(a.allParticipants):!1,trackPermissions:Array.isArray(a==null?void 0:a.trackPermissions)?a.trackPermissions.map(s=>TrackPermission.fromJSON(s)):[]}},toJSON(a){const s={};return a.allParticipants!==void 0&&(s.allParticipants=a.allParticipants),a.trackPermissions?s.trackPermissions=a.trackPermissions.map(d=>d?TrackPermission.toJSON(d):void 0):s.trackPermissions=[],s},create(a){return SubscriptionPermission.fromPartial(a!=null?a:{})},fromPartial(a){var s,d;const c=createBaseSubscriptionPermission();return c.allParticipants=(s=a.allParticipants)!==null&&s!==void 0?s:!1,c.trackPermissions=((d=a.trackPermissions)===null||d===void 0?void 0:d.map(l=>TrackPermission.fromPartial(l)))||[],c}};function createBaseSubscriptionPermissionUpdate(){return{participantSid:"",trackSid:"",allowed:!1}}const SubscriptionPermissionUpdate={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();return a.participantSid!==""&&s.uint32(10).string(a.participantSid),a.trackSid!==""&&s.uint32(18).string(a.trackSid),a.allowed===!0&&s.uint32(24).bool(a.allowed),s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseSubscriptionPermissionUpdate();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.participantSid=d.string();break;case 2:l.trackSid=d.string();break;case 3:l.allowed=d.bool();break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{participantSid:isSet(a.participantSid)?String(a.participantSid):"",trackSid:isSet(a.trackSid)?String(a.trackSid):"",allowed:isSet(a.allowed)?Boolean(a.allowed):!1}},toJSON(a){const s={};return a.participantSid!==void 0&&(s.participantSid=a.participantSid),a.trackSid!==void 0&&(s.trackSid=a.trackSid),a.allowed!==void 0&&(s.allowed=a.allowed),s},create(a){return SubscriptionPermissionUpdate.fromPartial(a!=null?a:{})},fromPartial(a){var s,d,c;const l=createBaseSubscriptionPermissionUpdate();return l.participantSid=(s=a.participantSid)!==null&&s!==void 0?s:"",l.trackSid=(d=a.trackSid)!==null&&d!==void 0?d:"",l.allowed=(c=a.allowed)!==null&&c!==void 0?c:!1,l}};function createBaseSyncState(){return{answer:void 0,subscription:void 0,publishTracks:[],dataChannels:[],offer:void 0}}const SyncState={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();a.answer!==void 0&&SessionDescription.encode(a.answer,s.uint32(10).fork()).ldelim(),a.subscription!==void 0&&UpdateSubscription.encode(a.subscription,s.uint32(18).fork()).ldelim();for(const d of a.publishTracks)TrackPublishedResponse.encode(d,s.uint32(26).fork()).ldelim();for(const d of a.dataChannels)DataChannelInfo.encode(d,s.uint32(34).fork()).ldelim();return a.offer!==void 0&&SessionDescription.encode(a.offer,s.uint32(42).fork()).ldelim(),s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseSyncState();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.answer=SessionDescription.decode(d,d.uint32());break;case 2:l.subscription=UpdateSubscription.decode(d,d.uint32());break;case 3:l.publishTracks.push(TrackPublishedResponse.decode(d,d.uint32()));break;case 4:l.dataChannels.push(DataChannelInfo.decode(d,d.uint32()));break;case 5:l.offer=SessionDescription.decode(d,d.uint32());break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{answer:isSet(a.answer)?SessionDescription.fromJSON(a.answer):void 0,subscription:isSet(a.subscription)?UpdateSubscription.fromJSON(a.subscription):void 0,publishTracks:Array.isArray(a==null?void 0:a.publishTracks)?a.publishTracks.map(s=>TrackPublishedResponse.fromJSON(s)):[],dataChannels:Array.isArray(a==null?void 0:a.dataChannels)?a.dataChannels.map(s=>DataChannelInfo.fromJSON(s)):[],offer:isSet(a.offer)?SessionDescription.fromJSON(a.offer):void 0}},toJSON(a){const s={};return a.answer!==void 0&&(s.answer=a.answer?SessionDescription.toJSON(a.answer):void 0),a.subscription!==void 0&&(s.subscription=a.subscription?UpdateSubscription.toJSON(a.subscription):void 0),a.publishTracks?s.publishTracks=a.publishTracks.map(d=>d?TrackPublishedResponse.toJSON(d):void 0):s.publishTracks=[],a.dataChannels?s.dataChannels=a.dataChannels.map(d=>d?DataChannelInfo.toJSON(d):void 0):s.dataChannels=[],a.offer!==void 0&&(s.offer=a.offer?SessionDescription.toJSON(a.offer):void 0),s},create(a){return SyncState.fromPartial(a!=null?a:{})},fromPartial(a){var s,d;const c=createBaseSyncState();return c.answer=a.answer!==void 0&&a.answer!==null?SessionDescription.fromPartial(a.answer):void 0,c.subscription=a.subscription!==void 0&&a.subscription!==null?UpdateSubscription.fromPartial(a.subscription):void 0,c.publishTracks=((s=a.publishTracks)===null||s===void 0?void 0:s.map(l=>TrackPublishedResponse.fromPartial(l)))||[],c.dataChannels=((d=a.dataChannels)===null||d===void 0?void 0:d.map(l=>DataChannelInfo.fromPartial(l)))||[],c.offer=a.offer!==void 0&&a.offer!==null?SessionDescription.fromPartial(a.offer):void 0,c}};function createBaseDataChannelInfo(){return{label:"",id:0,target:0}}const DataChannelInfo={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();return a.label!==""&&s.uint32(10).string(a.label),a.id!==0&&s.uint32(16).uint32(a.id),a.target!==0&&s.uint32(24).int32(a.target),s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseDataChannelInfo();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.label=d.string();break;case 2:l.id=d.uint32();break;case 3:l.target=d.int32();break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{label:isSet(a.label)?String(a.label):"",id:isSet(a.id)?Number(a.id):0,target:isSet(a.target)?signalTargetFromJSON(a.target):0}},toJSON(a){const s={};return a.label!==void 0&&(s.label=a.label),a.id!==void 0&&(s.id=Math.round(a.id)),a.target!==void 0&&(s.target=signalTargetToJSON(a.target)),s},create(a){return DataChannelInfo.fromPartial(a!=null?a:{})},fromPartial(a){var s,d,c;const l=createBaseDataChannelInfo();return l.label=(s=a.label)!==null&&s!==void 0?s:"",l.id=(d=a.id)!==null&&d!==void 0?d:0,l.target=(c=a.target)!==null&&c!==void 0?c:0,l}};function createBaseSimulateScenario(){return{scenario:void 0}}const SimulateScenario={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();var d;switch((d=a.scenario)===null||d===void 0?void 0:d.$case){case"speakerUpdate":s.uint32(8).int32(a.scenario.speakerUpdate);break;case"nodeFailure":s.uint32(16).bool(a.scenario.nodeFailure);break;case"migration":s.uint32(24).bool(a.scenario.migration);break;case"serverLeave":s.uint32(32).bool(a.scenario.serverLeave);break;case"switchCandidateProtocol":s.uint32(40).int32(a.scenario.switchCandidateProtocol);break}return s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseSimulateScenario();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.scenario={$case:"speakerUpdate",speakerUpdate:d.int32()};break;case 2:l.scenario={$case:"nodeFailure",nodeFailure:d.bool()};break;case 3:l.scenario={$case:"migration",migration:d.bool()};break;case 4:l.scenario={$case:"serverLeave",serverLeave:d.bool()};break;case 5:l.scenario={$case:"switchCandidateProtocol",switchCandidateProtocol:d.int32()};break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{scenario:isSet(a.speakerUpdate)?{$case:"speakerUpdate",speakerUpdate:Number(a.speakerUpdate)}:isSet(a.nodeFailure)?{$case:"nodeFailure",nodeFailure:Boolean(a.nodeFailure)}:isSet(a.migration)?{$case:"migration",migration:Boolean(a.migration)}:isSet(a.serverLeave)?{$case:"serverLeave",serverLeave:Boolean(a.serverLeave)}:isSet(a.switchCandidateProtocol)?{$case:"switchCandidateProtocol",switchCandidateProtocol:candidateProtocolFromJSON(a.switchCandidateProtocol)}:void 0}},toJSON(a){var s,d,c,l,p,h,v,S,b,_,I;const T={};return((s=a.scenario)===null||s===void 0?void 0:s.$case)==="speakerUpdate"&&(T.speakerUpdate=Math.round((d=a.scenario)===null||d===void 0?void 0:d.speakerUpdate)),((c=a.scenario)===null||c===void 0?void 0:c.$case)==="nodeFailure"&&(T.nodeFailure=(l=a.scenario)===null||l===void 0?void 0:l.nodeFailure),((p=a.scenario)===null||p===void 0?void 0:p.$case)==="migration"&&(T.migration=(h=a.scenario)===null||h===void 0?void 0:h.migration),((v=a.scenario)===null||v===void 0?void 0:v.$case)==="serverLeave"&&(T.serverLeave=(S=a.scenario)===null||S===void 0?void 0:S.serverLeave),((b=a.scenario)===null||b===void 0?void 0:b.$case)==="switchCandidateProtocol"&&(T.switchCandidateProtocol=((_=a.scenario)===null||_===void 0?void 0:_.switchCandidateProtocol)!==void 0?candidateProtocolToJSON((I=a.scenario)===null||I===void 0?void 0:I.switchCandidateProtocol):void 0),T},create(a){return SimulateScenario.fromPartial(a!=null?a:{})},fromPartial(a){var s,d,c,l,p,h,v,S,b,_,I,T,k,w,P;const $=createBaseSimulateScenario();return((s=a.scenario)===null||s===void 0?void 0:s.$case)==="speakerUpdate"&&((d=a.scenario)===null||d===void 0?void 0:d.speakerUpdate)!==void 0&&((c=a.scenario)===null||c===void 0?void 0:c.speakerUpdate)!==null&&($.scenario={$case:"speakerUpdate",speakerUpdate:a.scenario.speakerUpdate}),((l=a.scenario)===null||l===void 0?void 0:l.$case)==="nodeFailure"&&((p=a.scenario)===null||p===void 0?void 0:p.nodeFailure)!==void 0&&((h=a.scenario)===null||h===void 0?void 0:h.nodeFailure)!==null&&($.scenario={$case:"nodeFailure",nodeFailure:a.scenario.nodeFailure}),((v=a.scenario)===null||v===void 0?void 0:v.$case)==="migration"&&((S=a.scenario)===null||S===void 0?void 0:S.migration)!==void 0&&((b=a.scenario)===null||b===void 0?void 0:b.migration)!==null&&($.scenario={$case:"migration",migration:a.scenario.migration}),((_=a.scenario)===null||_===void 0?void 0:_.$case)==="serverLeave"&&((I=a.scenario)===null||I===void 0?void 0:I.serverLeave)!==void 0&&((T=a.scenario)===null||T===void 0?void 0:T.serverLeave)!==null&&($.scenario={$case:"serverLeave",serverLeave:a.scenario.serverLeave}),((k=a.scenario)===null||k===void 0?void 0:k.$case)==="switchCandidateProtocol"&&((w=a.scenario)===null||w===void 0?void 0:w.switchCandidateProtocol)!==void 0&&((P=a.scenario)===null||P===void 0?void 0:P.switchCandidateProtocol)!==null&&($.scenario={$case:"switchCandidateProtocol",switchCandidateProtocol:a.scenario.switchCandidateProtocol}),$}};function createBasePing(){return{timestamp:0,rtt:0}}const Ping={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();return a.timestamp!==0&&s.uint32(8).int64(a.timestamp),a.rtt!==0&&s.uint32(16).int64(a.rtt),s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBasePing();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.timestamp=longToNumber(d.int64());break;case 2:l.rtt=longToNumber(d.int64());break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{timestamp:isSet(a.timestamp)?Number(a.timestamp):0,rtt:isSet(a.rtt)?Number(a.rtt):0}},toJSON(a){const s={};return a.timestamp!==void 0&&(s.timestamp=Math.round(a.timestamp)),a.rtt!==void 0&&(s.rtt=Math.round(a.rtt)),s},create(a){return Ping.fromPartial(a!=null?a:{})},fromPartial(a){var s,d;const c=createBasePing();return c.timestamp=(s=a.timestamp)!==null&&s!==void 0?s:0,c.rtt=(d=a.rtt)!==null&&d!==void 0?d:0,c}};function createBasePong(){return{lastPingTimestamp:0,timestamp:0}}const Pong={encode(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0.Writer.create();return a.lastPingTimestamp!==0&&s.uint32(8).int64(a.lastPingTimestamp),a.timestamp!==0&&s.uint32(16).int64(a.timestamp),s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBasePong();for(;d.pos<c;){const p=d.uint32();switch(p>>>3){case 1:l.lastPingTimestamp=longToNumber(d.int64());break;case 2:l.timestamp=longToNumber(d.int64());break;default:d.skipType(p&7);break}}return l},fromJSON(a){return{lastPingTimestamp:isSet(a.lastPingTimestamp)?Number(a.lastPingTimestamp):0,timestamp:isSet(a.timestamp)?Number(a.timestamp):0}},toJSON(a){const s={};return a.lastPingTimestamp!==void 0&&(s.lastPingTimestamp=Math.round(a.lastPingTimestamp)),a.timestamp!==void 0&&(s.timestamp=Math.round(a.timestamp)),s},create(a){return Pong.fromPartial(a!=null?a:{})},fromPartial(a){var s,d;const c=createBasePong();return c.lastPingTimestamp=(s=a.lastPingTimestamp)!==null&&s!==void 0?s:0,c.timestamp=(d=a.timestamp)!==null&&d!==void 0?d:0,c}};var tsProtoGlobalThis=(()=>{if(typeof globalThis!="undefined")return globalThis;if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global;throw"Unable to locate global object"})();function longToNumber(a){if(a.gt(Number.MAX_SAFE_INTEGER))throw new tsProtoGlobalThis.Error("Value is larger than Number.MAX_SAFE_INTEGER");return a.toNumber()}_m0.util.Long!==long&&(_m0.util.Long=long,_m0.configure());function isSet(a){return a!=null}class LivekitError extends Error{constructor(s,d){super(d||"an error has occured"),this.code=s}}class ConnectionError extends LivekitError{constructor(s,d,c){super(1,s),this.status=c,this.reason=d}}class DeviceUnsupportedError extends LivekitError{constructor(s){super(21,s!=null?s:"device is unsupported")}}class TrackInvalidError extends LivekitError{constructor(s){super(20,s!=null?s:"track is invalid")}}class UnsupportedServer extends LivekitError{constructor(s){super(10,s!=null?s:"unsupported server")}}class UnexpectedConnectionState extends LivekitError{constructor(s){super(12,s!=null?s:"unexpected connection state")}}class NegotiationError extends LivekitError{constructor(s){super(13,s!=null?s:"unable to negotiate")}}var MediaDeviceFailure;(function(a){a.PermissionDenied="PermissionDenied",a.NotFound="NotFound",a.DeviceInUse="DeviceInUse",a.Other="Other"})(MediaDeviceFailure||(MediaDeviceFailure={})),function(a){function s(d){if(d&&"name"in d)return d.name==="NotFoundError"||d.name==="DevicesNotFoundError"?a.NotFound:d.name==="NotAllowedError"||d.name==="PermissionDeniedError"?a.PermissionDenied:d.name==="NotReadableError"||d.name==="TrackStartError"?a.DeviceInUse:a.Other}a.getFailure=s}(MediaDeviceFailure||(MediaDeviceFailure={}));var RoomEvent;(function(a){a.Connected="connected",a.Reconnecting="reconnecting",a.Reconnected="reconnected",a.Disconnected="disconnected",a.ConnectionStateChanged="connectionStateChanged",a.StateChanged="connectionStateChanged",a.MediaDevicesChanged="mediaDevicesChanged",a.ParticipantConnected="participantConnected",a.ParticipantDisconnected="participantDisconnected",a.TrackPublished="trackPublished",a.TrackSubscribed="trackSubscribed",a.TrackSubscriptionFailed="trackSubscriptionFailed",a.TrackUnpublished="trackUnpublished",a.TrackUnsubscribed="trackUnsubscribed",a.TrackMuted="trackMuted",a.TrackUnmuted="trackUnmuted",a.LocalTrackPublished="localTrackPublished",a.LocalTrackUnpublished="localTrackUnpublished",a.ActiveSpeakersChanged="activeSpeakersChanged",a.ParticipantMetadataChanged="participantMetadataChanged",a.RoomMetadataChanged="roomMetadataChanged",a.DataReceived="dataReceived",a.ConnectionQualityChanged="connectionQualityChanged",a.TrackStreamStateChanged="trackStreamStateChanged",a.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",a.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",a.AudioPlaybackStatusChanged="audioPlaybackChanged",a.MediaDevicesError="mediaDevicesError",a.ParticipantPermissionsChanged="participantPermissionsChanged",a.SignalConnected="signalConnected",a.RecordingStatusChanged="recordingStatusChanged"})(RoomEvent||(RoomEvent={}));var ParticipantEvent;(function(a){a.TrackPublished="trackPublished",a.TrackSubscribed="trackSubscribed",a.TrackSubscriptionFailed="trackSubscriptionFailed",a.TrackUnpublished="trackUnpublished",a.TrackUnsubscribed="trackUnsubscribed",a.TrackMuted="trackMuted",a.TrackUnmuted="trackUnmuted",a.LocalTrackPublished="localTrackPublished",a.LocalTrackUnpublished="localTrackUnpublished",a.ParticipantMetadataChanged="participantMetadataChanged",a.DataReceived="dataReceived",a.IsSpeakingChanged="isSpeakingChanged",a.ConnectionQualityChanged="connectionQualityChanged",a.TrackStreamStateChanged="trackStreamStateChanged",a.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",a.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",a.MediaDevicesError="mediaDevicesError",a.ParticipantPermissionsChanged="participantPermissionsChanged"})(ParticipantEvent||(ParticipantEvent={}));var EngineEvent;(function(a){a.TransportsCreated="transportsCreated",a.Connected="connected",a.Disconnected="disconnected",a.Resuming="resuming",a.Resumed="resumed",a.Restarting="restarting",a.Restarted="restarted",a.SignalResumed="signalResumed",a.Closing="closing",a.MediaTrackAdded="mediaTrackAdded",a.ActiveSpeakersUpdate="activeSpeakersUpdate",a.DataPacketReceived="dataPacketReceived"})(EngineEvent||(EngineEvent={}));var TrackEvent;(function(a){a.Message="message",a.Muted="muted",a.Unmuted="unmuted",a.Restarted="restarted",a.Ended="ended",a.Subscribed="subscribed",a.Unsubscribed="unsubscribed",a.UpdateSettings="updateSettings",a.UpdateSubscription="updateSubscription",a.AudioPlaybackStarted="audioPlaybackStarted",a.AudioPlaybackFailed="audioPlaybackFailed",a.AudioSilenceDetected="audioSilenceDetected",a.VisibilityChanged="visibilityChanged",a.VideoDimensionsChanged="videoDimensionsChanged",a.ElementAttached="elementAttached",a.ElementDetached="elementDetached",a.UpstreamPaused="upstreamPaused",a.UpstreamResumed="upstreamResumed",a.SubscriptionPermissionChanged="subscriptionPermissionChanged",a.SubscriptionStatusChanged="subscriptionStatusChanged"})(TrackEvent||(TrackEvent={}));const monitorFrequency=2e3;function computeBitrate(a,s){if(!s)return 0;let d,c;return"bytesReceived"in a?(d=a.bytesReceived,c=s.bytesReceived):"bytesSent"in a&&(d=a.bytesSent,c=s.bytesSent),d===void 0||c===void 0||a.timestamp===void 0||s.timestamp===void 0?0:(d-c)*8*1e3/(a.timestamp-s.timestamp)}var uaParserExports={},uaParser={get exports(){return uaParserExports},set exports(a){uaParserExports=a}};(function(a,s){(function(d,c){var l="1.0.33",p="",h="?",v="function",S="undefined",b="object",_="string",I="major",T="model",k="name",w="type",P="vendor",$="version",U="architecture",E="console",D="mobile",F="tablet",J="smarttv",G="wearable",x="embedded",Y=350,N="Amazon",z="Apple",Z="ASUS",L="BlackBerry",V="Browser",H="Chrome",de="Edge",X="Firefox",K="Google",oe="Huawei",pe="LG",me="Microsoft",ve="Motorola",A="Opera",W="Samsung",ee="Sharp",ce="Sony",re="Xiaomi",te="Zebra",se="Facebook",le=function(Se,Te){var be={};for(var Ie in Se)Te[Ie]&&Te[Ie].length%2===0?be[Ie]=Te[Ie].concat(Se[Ie]):be[Ie]=Se[Ie];return be},ue=function(Se){for(var Te={},be=0;be<Se.length;be++)Te[Se[be].toUpperCase()]=Se[be];return Te},De=function(Se,Te){return typeof Se===_?Oe(Te).indexOf(Oe(Se))!==-1:!1},Oe=function(Se){return Se.toLowerCase()},qe=function(Se){return typeof Se===_?Se.replace(/[^\d\.]/g,p).split(".")[0]:c},ke=function(Se,Te){if(typeof Se===_)return Se=Se.replace(/^\s\s*/,p),typeof Te===S?Se:Se.substring(0,Y)},$e=function(Se,Te){for(var be=0,Ie,_e,et,Re,We,xe;be<Te.length&&!We;){var nt=Te[be],rt=Te[be+1];for(Ie=_e=0;Ie<nt.length&&!We;)if(We=nt[Ie++].exec(Se),We)for(et=0;et<rt.length;et++)xe=We[++_e],Re=rt[et],typeof Re===b&&Re.length>0?Re.length===2?typeof Re[1]==v?this[Re[0]]=Re[1].call(this,xe):this[Re[0]]=Re[1]:Re.length===3?typeof Re[1]===v&&!(Re[1].exec&&Re[1].test)?this[Re[0]]=xe?Re[1].call(this,xe,Re[2]):c:this[Re[0]]=xe?xe.replace(Re[1],Re[2]):c:Re.length===4&&(this[Re[0]]=xe?Re[3].call(this,xe.replace(Re[1],Re[2])):c):this[Re]=xe||c;be+=2}},Ge=function(Se,Te){for(var be in Te)if(typeof Te[be]===b&&Te[be].length>0){for(var Ie=0;Ie<Te[be].length;Ie++)if(De(Te[be][Ie],Se))return be===h?c:be}else if(De(Te[be],Se))return be===h?c:be;return Se},He={"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"},ge={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},ze={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[$,[k,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[$,[k,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[k,$],[/opios[\/ ]+([\w\.]+)/i],[$,[k,A+" Mini"]],[/\bopr\/([\w\.]+)/i],[$,[k,A]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[k,$],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[$,[k,"UC"+V]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[$,[k,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[$,[k,"WeChat"]],[/konqueror\/([\w\.]+)/i],[$,[k,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[$,[k,"IE"]],[/yabrowser\/([\w\.]+)/i],[$,[k,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[k,/(.+)/,"$1 Secure "+V],$],[/\bfocus\/([\w\.]+)/i],[$,[k,X+" Focus"]],[/\bopt\/([\w\.]+)/i],[$,[k,A+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[$,[k,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[$,[k,"Dolphin"]],[/coast\/([\w\.]+)/i],[$,[k,A+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[$,[k,"MIUI "+V]],[/fxios\/([-\w\.]+)/i],[$,[k,X]],[/\bqihu|(qi?ho?o?|360)browser/i],[[k,"360 "+V]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[k,/(.+)/,"$1 "+V],$],[/(comodo_dragon)\/([\w\.]+)/i],[[k,/_/g," "],$],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[k,$],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[k],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[k,se],$],[/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[k,$],[/\bgsa\/([\w\.]+) .*safari\//i],[$,[k,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[$,[k,H+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[k,H+" WebView"],$],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[$,[k,"Android "+V]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[k,$],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[$,[k,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[$,k],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[k,[$,Ge,He]],[/(webkit|khtml)\/([\w\.]+)/i],[k,$],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[k,"Netscape"],$],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[$,[k,X+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[k,$],[/(cobalt)\/([\w\.]+)/i],[k,[$,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[U,"amd64"]],[/(ia32(?=;))/i],[[U,Oe]],[/((?:i[346]|x)86)[;\)]/i],[[U,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[U,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[U,"armhf"]],[/windows (ce|mobile); ppc;/i],[[U,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[U,/ower/,p,Oe]],[/(sun4\w)[;\)]/i],[[U,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[U,Oe]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[T,[P,W],[w,F]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[T,[P,W],[w,D]],[/\((ip(?:hone|od)[\w ]*);/i],[T,[P,z],[w,D]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[T,[P,z],[w,F]],[/(macintosh);/i],[T,[P,z]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[T,[P,oe],[w,F]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[T,[P,oe],[w,D]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[T,/_/g," "],[P,re],[w,D]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[T,/_/g," "],[P,re],[w,F]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[T,[P,"OPPO"],[w,D]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[T,[P,"Vivo"],[w,D]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[T,[P,"Realme"],[w,D]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[T,[P,ve],[w,D]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[T,[P,ve],[w,F]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[T,[P,pe],[w,F]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[T,[P,pe],[w,D]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[T,[P,"Lenovo"],[w,F]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[T,/_/g," "],[P,"Nokia"],[w,D]],[/(pixel c)\b/i],[T,[P,K],[w,F]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[T,[P,K],[w,D]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[T,[P,ce],[w,D]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[T,"Xperia Tablet"],[P,ce],[w,F]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[T,[P,"OnePlus"],[w,D]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[T,[P,N],[w,F]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[T,/(.+)/g,"Fire Phone $1"],[P,N],[w,D]],[/(playbook);[-\w\),; ]+(rim)/i],[T,P,[w,F]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[T,[P,L],[w,D]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[T,[P,Z],[w,F]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[T,[P,Z],[w,D]],[/(nexus 9)/i],[T,[P,"HTC"],[w,F]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic|sony(?!-bra))[-_ ]?([-\w]*)/i],[P,[T,/_/g," "],[w,D]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[T,[P,"Acer"],[w,F]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[T,[P,"Meizu"],[w,D]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[T,[P,ee],[w,D]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[P,T,[w,D]],[/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[P,T,[w,F]],[/(surface duo)/i],[T,[P,me],[w,F]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[T,[P,"Fairphone"],[w,D]],[/(u304aa)/i],[T,[P,"AT&T"],[w,D]],[/\bsie-(\w*)/i],[T,[P,"Siemens"],[w,D]],[/\b(rct\w+) b/i],[T,[P,"RCA"],[w,F]],[/\b(venue[\d ]{2,7}) b/i],[T,[P,"Dell"],[w,F]],[/\b(q(?:mv|ta)\w+) b/i],[T,[P,"Verizon"],[w,F]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[T,[P,"Barnes & Noble"],[w,F]],[/\b(tm\d{3}\w+) b/i],[T,[P,"NuVision"],[w,F]],[/\b(k88) b/i],[T,[P,"ZTE"],[w,F]],[/\b(nx\d{3}j) b/i],[T,[P,"ZTE"],[w,D]],[/\b(gen\d{3}) b.+49h/i],[T,[P,"Swiss"],[w,D]],[/\b(zur\d{3}) b/i],[T,[P,"Swiss"],[w,F]],[/\b((zeki)?tb.*\b) b/i],[T,[P,"Zeki"],[w,F]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[P,"Dragon Touch"],T,[w,F]],[/\b(ns-?\w{0,9}) b/i],[T,[P,"Insignia"],[w,F]],[/\b((nxa|next)-?\w{0,9}) b/i],[T,[P,"NextBook"],[w,F]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[P,"Voice"],T,[w,D]],[/\b(lvtel\-)?(v1[12]) b/i],[[P,"LvTel"],T,[w,D]],[/\b(ph-1) /i],[T,[P,"Essential"],[w,D]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[T,[P,"Envizen"],[w,F]],[/\b(trio[-\w\. ]+) b/i],[T,[P,"MachSpeed"],[w,F]],[/\btu_(1491) b/i],[T,[P,"Rotor"],[w,F]],[/(shield[\w ]+) b/i],[T,[P,"Nvidia"],[w,F]],[/(sprint) (\w+)/i],[P,T,[w,D]],[/(kin\.[onetw]{3})/i],[[T,/\./g," "],[P,me],[w,D]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[T,[P,te],[w,F]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[T,[P,te],[w,D]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[P,T,[w,E]],[/droid.+; (shield) bui/i],[T,[P,"Nvidia"],[w,E]],[/(playstation [345portablevi]+)/i],[T,[P,ce],[w,E]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[T,[P,me],[w,E]],[/smart-tv.+(samsung)/i],[P,[w,J]],[/hbbtv.+maple;(\d+)/i],[[T,/^/,"SmartTV"],[P,W],[w,J]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[P,pe],[w,J]],[/(apple) ?tv/i],[P,[T,z+" TV"],[w,J]],[/crkey/i],[[T,H+"cast"],[P,K],[w,J]],[/droid.+aft(\w)( bui|\))/i],[T,[P,N],[w,J]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[T,[P,ee],[w,J]],[/(bravia[\w ]+)( bui|\))/i],[T,[P,ce],[w,J]],[/(mitv-\w{5}) bui/i],[T,[P,re],[w,J]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i],[[P,ke],[T,ke],[w,J]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[w,J]],[/((pebble))app/i],[P,T,[w,G]],[/droid.+; (glass) \d/i],[T,[P,K],[w,G]],[/droid.+; (wt63?0{2,3})\)/i],[T,[P,te],[w,G]],[/(quest( 2)?)/i],[T,[P,se],[w,G]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[P,[w,x]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[T,[w,D]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[T,[w,F]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[w,F]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[w,D]],[/(android[-\w\. ]{0,9});.+buil/i],[T,[P,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[$,[k,de+"HTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[$,[k,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[k,$],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[$,k]],os:[[/microsoft (windows) (vista|xp)/i],[k,$],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[k,[$,Ge,ge]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[k,"Windows"],[$,Ge,ge]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[$,/_/g,"."],[k,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[k,"Mac OS"],[$,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[$,k],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[k,$],[/\(bb(10);/i],[$,[k,L]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[$,[k,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[$,[k,X+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[$,[k,"webOS"]],[/crkey\/([\d\.]+)/i],[$,[k,H+"cast"]],[/(cros) [\w]+ ([\w\.]+\w)/i],[[k,"Chromium OS"],$],[/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[k,$],[/(sunos) ?([\w\.\d]*)/i],[[k,"Solaris"],$],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[k,$]]},ye=function(Se,Te){if(typeof Se===b&&(Te=Se,Se=c),!(this instanceof ye))return new ye(Se,Te).getResult();var be=Se||(typeof d!==S&&d.navigator&&d.navigator.userAgent?d.navigator.userAgent:p),Ie=Te?le(ze,Te):ze;return this.getBrowser=function(){var _e={};return _e[k]=c,_e[$]=c,$e.call(_e,be,Ie.browser),_e.major=qe(_e.version),_e},this.getCPU=function(){var _e={};return _e[U]=c,$e.call(_e,be,Ie.cpu),_e},this.getDevice=function(){var _e={};return _e[P]=c,_e[T]=c,_e[w]=c,$e.call(_e,be,Ie.device),_e},this.getEngine=function(){var _e={};return _e[k]=c,_e[$]=c,$e.call(_e,be,Ie.engine),_e},this.getOS=function(){var _e={};return _e[k]=c,_e[$]=c,$e.call(_e,be,Ie.os),_e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return be},this.setUA=function(_e){return be=typeof _e===_&&_e.length>Y?ke(_e,Y):_e,this},this.setUA(be),this};ye.VERSION=l,ye.BROWSER=ue([k,$,I]),ye.CPU=ue([U]),ye.DEVICE=ue([T,P,w,E,D,J,F,G,x]),ye.ENGINE=ye.OS=ue([k,$]),a.exports&&(s=a.exports=ye),s.UAParser=ye;var Ye=typeof d!==S&&(d.jQuery||d.Zepto);if(Ye&&!Ye.ua){var he=new ye;Ye.ua=he.getResult(),Ye.ua.get=function(){return he.getUA()},Ye.ua.set=function(Se){he.setUA(Se);var Te=he.getResult();for(var be in Te)Ye.ua[be]=Te[be]}}})(typeof window=="object"?window:commonjsGlobal)})(uaParser,uaParserExports);var UAParser=uaParserExports,version$1="1.7.0";const version=version$1,protocolVersion=9;function mergeDefaultOptions(a,s,d){const c=_objectSpread2({},a);return c.audio===!0&&(c.audio={}),c.video===!0&&(c.video={}),c.audio&&mergeObjectWithoutOverwriting(c.audio,s),c.video&&mergeObjectWithoutOverwriting(c.video,d),c}function mergeObjectWithoutOverwriting(a,s){return Object.keys(s).forEach(d=>{a[d]===void 0&&(a[d]=s[d])}),a}function constraintsForOptions(a){const s={};if(a.video)if(typeof a.video=="object"){const d={},c=d,l=a.video;Object.keys(l).forEach(p=>{switch(p){case"resolution":mergeObjectWithoutOverwriting(c,l.resolution);break;default:c[p]=l[p]}}),s.video=d}else s.video=a.video;else s.video=!1;return a.audio?typeof a.audio=="object"?s.audio=a.audio:s.audio=!0:s.audio=!1,s}async function detectSilence(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200;const d=getNewAudioContext();if(d){const c=d.createAnalyser();c.fftSize=2048;const l=c.frequencyBinCount,p=new Uint8Array(l);d.createMediaStreamSource(new MediaStream([a.mediaStreamTrack])).connect(c),await sleep(s),c.getByteTimeDomainData(p);const v=p.some(S=>S!==128&&S!==0);return d.close(),!v}return!1}function getNewAudioContext(){const a=window.AudioContext||window.webkitAudioContext;if(a)return new a({latencyHint:"interactive"})}const separator="|";function unpackStreamId(a){const s=a.split(separator);return s.length>1?[s[0],a.substr(s[0].length+1)]:[a,""]}async function sleep(a){return new Promise(s=>setTimeout(s,a))}function supportsTransceiver(){return"addTransceiver"in RTCPeerConnection.prototype}function supportsAddTrack(){return"addTrack"in RTCPeerConnection.prototype}function supportsAV1(){const a=RTCRtpReceiver.getCapabilities("video");let s=!1,d=!1;if(a){for(const c of a.codecs)if(c.mimeType==="video/AV1"){s=!0;break}for(const c of a.headerExtensions)if(c.uri==="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension"){d=!0;break}}return s&&d}function supportsSetSinkId(a){return document?(a||(a=document.createElement("audio")),"setSinkId"in a):!1}const setCodecPreferencesVersions={Chrome:"100",Chromium:"100",Safari:"15",Firefox:"100",Edge:"100",Brave:"1.40"};function supportsSetCodecPreferences(a){if(!isWeb()||!("setCodecPreferences"in a))return!1;const s=UAParser();if(!s.browser.name||!s.browser.version)return!1;const d=setCodecPreferencesVersions[s.browser.name];return d?compareVersions(s.browser.version,d)>=0:!1}function isFireFox(){return isWeb()?navigator.userAgent.indexOf("Firefox")!==-1:!1}function isSafari(){return isWeb()?/^((?!chrome|android).)*safari/i.test(navigator.userAgent):!1}function isMobile(){return isWeb()?/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent):!1}function isWeb(){return typeof document!="undefined"}function compareVersions(a,s){const d=a.split("."),c=s.split("."),l=Math.min(a.length,s.length);for(let p=0;p<l;++p){const h=parseInt(d[p],10),v=parseInt(c[p],10);if(h>v)return 1;if(h<v)return-1}return d.length==c.length?0:d.length<c.length?-1:1}function roDispatchCallback(a){for(const s of a)s.target.handleResize(s)}function ioDispatchCallback(a){for(const s of a)s.target.handleVisibilityChanged(s)}let resizeObserver=null;const getResizeObserver=()=>(resizeObserver||(resizeObserver=new ResizeObserver(roDispatchCallback)),resizeObserver);let intersectionObserver=null;const getIntersectionObserver=()=>(intersectionObserver||(intersectionObserver=new IntersectionObserver(ioDispatchCallback,{root:document,rootMargin:"0px"})),intersectionObserver);function getClientInfo(){return ClientInfo.fromPartial({sdk:ClientInfo_SDK.JS,protocol:protocolVersion,version})}let emptyVideoStreamTrack;function getEmptyVideoStreamTrack(){return emptyVideoStreamTrack||(emptyVideoStreamTrack=createDummyVideoStreamTrack()),emptyVideoStreamTrack}function createDummyVideoStreamTrack(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const l=document.createElement("canvas");l.width=a,l.height=s;const p=l.getContext("2d");p==null||p.fillRect(0,0,l.width,l.height),c&&p&&(p.beginPath(),p.arc(a/2,s/2,50,0,Math.PI*2,!0),p.closePath(),p.fillStyle="grey",p.fill());const h=l.captureStream(),[v]=h.getTracks();if(!v)throw Error("Could not get empty media stream video track");return v.enabled=d,v}let emptyAudioStreamTrack;function getEmptyAudioStreamTrack(){if(!emptyAudioStreamTrack){const a=new AudioContext,s=a.createOscillator(),d=a.createMediaStreamDestination();if(s.connect(d),s.start(),[emptyAudioStreamTrack]=d.stream.getAudioTracks(),!emptyAudioStreamTrack)throw Error("Could not get empty media stream audio track");emptyAudioStreamTrack.enabled=!1}return emptyAudioStreamTrack}class Future{constructor(s,d){this.onFinally=d,this.promise=new Promise(async(c,l)=>{this.resolve=c,this.reject=l,s&&await s(c,l)}).finally(()=>{var c;return(c=this.onFinally)===null||c===void 0?void 0:c.call(this)})}}class Mutex{constructor(){this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){this._locks+=1;let s;const d=new Promise(l=>s=()=>{this._locks-=1,l()}),c=this._locking.then(()=>s);return this._locking=this._locking.then(()=>d),c}}class Queue{constructor(s,d){this.maxConcurrent=s||1,this.minCycle=d||0,this.queueRunning=[],this.queueWaiting={},this.lastRun=0}dequeue(s){const d=this.queueRunning,c=d.findIndex(p=>p.hash===s);if(c==-1)throw"queue desync";const l=d[c];return d.splice(c,1),l}getFirstWaiting(){for(let s of Object.keys(this.queueWaiting).sort((d,c)=>d-c))if(this.queueWaiting[s]!==void 0&&this.queueWaiting[s].length>0)return this.queueWaiting[s]}end(s){this.dequeue(s).resolve();const c=this.getFirstWaiting();c!==void 0&&c.shift().resolve()}async wait(s,d){const c=d===void 0?0:d;let l={hash:s,priority:c};for(this.queueWaiting[c]==null&&(this.queueWaiting[c]=[]),this.queueRunning.length>=this.maxConcurrent&&(l.promise=new Promise(p=>{l.resolve=p}),this.queueWaiting[c].push(l),await l.promise),this.queueRunning.push(l),l.promise=new Promise(p=>{l.resolve=p});Date.now()-this.lastRun<this.minCycle;)await new Promise(p=>setTimeout(p,this.minCycle-Date.now()+this.lastRun));this.lastRun=Date.now()}run(s,d){const c=d===void 0?0:d,l=Symbol();return this.wait(l,c).then(()=>s()).finally(()=>{this.end(l)})}stat(){return{running:this.queueRunning.length,waiting:Object.keys(this.queueWaiting).reduce((s,d)=>s+=this.queueWaiting[d].length,0),last:this.lastRun}}async flush(){for(;this.stat().waiting>0;)for(let s of Object.keys(this.queueWaiting).sort((d,c)=>c-d)){const d=this.queueWaiting[s];d!==void 0&&d.length>0&&await d[d.length-1].promise}for(;this.queueRunning.length>0;)await Promise.allSettled(this.queueRunning.map(s=>s.promise))}}const defaultId="default";class DeviceManager{static getInstance(){return this.instance===void 0&&(this.instance=new DeviceManager),this.instance}async getDevices(s){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;var c;if(((c=DeviceManager.userMediaPromiseMap)===null||c===void 0?void 0:c.size)>0){livekitLogger.debug("awaiting getUserMedia promise");try{s?await DeviceManager.userMediaPromiseMap.get(s):await Promise.all(DeviceManager.userMediaPromiseMap.values())}catch{livekitLogger.warn("error waiting for media permissons")}}let l=await navigator.mediaDevices.enumerateDevices();if(d&&s&&(!DeviceManager.userMediaPromiseMap.get(s)||!isSafari())&&(l.length===0||l.some(h=>{const v=h.label==="",S=s?h.kind===s:!0;return v&&S}))){const h={video:s!=="audioinput"&&s!=="audiooutput",audio:s!=="videoinput"},v=await navigator.mediaDevices.getUserMedia(h);l=await navigator.mediaDevices.enumerateDevices(),v.getTracks().forEach(S=>{S.stop()})}return s&&(l=l.filter(p=>p.kind===s)),l}async normalizeDeviceId(s,d,c){if(d!==defaultId)return d;const p=(await this.getDevices(s)).find(h=>h.groupId===c&&h.deviceId!==defaultId);return p==null?void 0:p.deviceId}}DeviceManager.mediaDeviceKinds=["audioinput","audiooutput","videoinput"],DeviceManager.userMediaPromiseMap=new Map;var eventsExports={},events={get exports(){return eventsExports},set exports(a){eventsExports=a}},R=typeof Reflect=="object"?Reflect:null,ReflectApply=R&&typeof R.apply=="function"?R.apply:function a(s,d,c){return Function.prototype.apply.call(s,d,c)},ReflectOwnKeys;R&&typeof R.ownKeys=="function"?ReflectOwnKeys=R.ownKeys:Object.getOwnPropertySymbols?ReflectOwnKeys=function(s){return Object.getOwnPropertyNames(s).concat(Object.getOwnPropertySymbols(s))}:ReflectOwnKeys=function(s){return Object.getOwnPropertyNames(s)};function ProcessEmitWarning(a){console&&console.warn&&console.warn(a)}var NumberIsNaN=Number.isNaN||function a(s){return s!==s};function EventEmitter(){EventEmitter.init.call(this)}events.exports=EventEmitter,eventsExports.once=once,EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._eventsCount=0,EventEmitter.prototype._maxListeners=void 0;var defaultMaxListeners=10;function checkListener(a){if(typeof a!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof a)}Object.defineProperty(EventEmitter,"defaultMaxListeners",{enumerable:!0,get:function(){return defaultMaxListeners},set:function(a){if(typeof a!="number"||a<0||NumberIsNaN(a))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+a+".");defaultMaxListeners=a}}),EventEmitter.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},EventEmitter.prototype.setMaxListeners=function a(s){if(typeof s!="number"||s<0||NumberIsNaN(s))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+s+".");return this._maxListeners=s,this};function _getMaxListeners(a){return a._maxListeners===void 0?EventEmitter.defaultMaxListeners:a._maxListeners}EventEmitter.prototype.getMaxListeners=function a(){return _getMaxListeners(this)},EventEmitter.prototype.emit=function a(s){for(var d=[],c=1;c<arguments.length;c++)d.push(arguments[c]);var l=s==="error",p=this._events;if(p!==void 0)l=l&&p.error===void 0;else if(!l)return!1;if(l){var h;if(d.length>0&&(h=d[0]),h instanceof Error)throw h;var v=new Error("Unhandled error."+(h?" ("+h.message+")":""));throw v.context=h,v}var S=p[s];if(S===void 0)return!1;if(typeof S=="function")ReflectApply(S,this,d);else for(var b=S.length,_=arrayClone(S,b),c=0;c<b;++c)ReflectApply(_[c],this,d);return!0};function _addListener(a,s,d,c){var l,p,h;if(checkListener(d),p=a._events,p===void 0?(p=a._events=Object.create(null),a._eventsCount=0):(p.newListener!==void 0&&(a.emit("newListener",s,d.listener?d.listener:d),p=a._events),h=p[s]),h===void 0)h=p[s]=d,++a._eventsCount;else if(typeof h=="function"?h=p[s]=c?[d,h]:[h,d]:c?h.unshift(d):h.push(d),l=_getMaxListeners(a),l>0&&h.length>l&&!h.warned){h.warned=!0;var v=new Error("Possible EventEmitter memory leak detected. "+h.length+" "+String(s)+" listeners added. Use emitter.setMaxListeners() to increase limit");v.name="MaxListenersExceededWarning",v.emitter=a,v.type=s,v.count=h.length,ProcessEmitWarning(v)}return a}EventEmitter.prototype.addListener=function a(s,d){return _addListener(this,s,d,!1)},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.prependListener=function a(s,d){return _addListener(this,s,d,!0)};function onceWrapper(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function _onceWrap(a,s,d){var c={fired:!1,wrapFn:void 0,target:a,type:s,listener:d},l=onceWrapper.bind(c);return l.listener=d,c.wrapFn=l,l}EventEmitter.prototype.once=function a(s,d){return checkListener(d),this.on(s,_onceWrap(this,s,d)),this},EventEmitter.prototype.prependOnceListener=function a(s,d){return checkListener(d),this.prependListener(s,_onceWrap(this,s,d)),this},EventEmitter.prototype.removeListener=function a(s,d){var c,l,p,h,v;if(checkListener(d),l=this._events,l===void 0)return this;if(c=l[s],c===void 0)return this;if(c===d||c.listener===d)--this._eventsCount===0?this._events=Object.create(null):(delete l[s],l.removeListener&&this.emit("removeListener",s,c.listener||d));else if(typeof c!="function"){for(p=-1,h=c.length-1;h>=0;h--)if(c[h]===d||c[h].listener===d){v=c[h].listener,p=h;break}if(p<0)return this;p===0?c.shift():spliceOne(c,p),c.length===1&&(l[s]=c[0]),l.removeListener!==void 0&&this.emit("removeListener",s,v||d)}return this},EventEmitter.prototype.off=EventEmitter.prototype.removeListener,EventEmitter.prototype.removeAllListeners=function a(s){var d,c,l;if(c=this._events,c===void 0)return this;if(c.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):c[s]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete c[s]),this;if(arguments.length===0){var p=Object.keys(c),h;for(l=0;l<p.length;++l)h=p[l],h!=="removeListener"&&this.removeAllListeners(h);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(d=c[s],typeof d=="function")this.removeListener(s,d);else if(d!==void 0)for(l=d.length-1;l>=0;l--)this.removeListener(s,d[l]);return this};function _listeners(a,s,d){var c=a._events;if(c===void 0)return[];var l=c[s];return l===void 0?[]:typeof l=="function"?d?[l.listener||l]:[l]:d?unwrapListeners(l):arrayClone(l,l.length)}EventEmitter.prototype.listeners=function a(s){return _listeners(this,s,!0)},EventEmitter.prototype.rawListeners=function a(s){return _listeners(this,s,!1)},EventEmitter.listenerCount=function(a,s){return typeof a.listenerCount=="function"?a.listenerCount(s):listenerCount.call(a,s)},EventEmitter.prototype.listenerCount=listenerCount;function listenerCount(a){var s=this._events;if(s!==void 0){var d=s[a];if(typeof d=="function")return 1;if(d!==void 0)return d.length}return 0}EventEmitter.prototype.eventNames=function a(){return this._eventsCount>0?ReflectOwnKeys(this._events):[]};function arrayClone(a,s){for(var d=new Array(s),c=0;c<s;++c)d[c]=a[c];return d}function spliceOne(a,s){for(;s+1<a.length;s++)a[s]=a[s+1];a.pop()}function unwrapListeners(a){for(var s=new Array(a.length),d=0;d<s.length;++d)s[d]=a[d].listener||a[d];return s}function once(a,s){return new Promise(function(d,c){function l(h){a.removeListener(s,p),c(h)}function p(){typeof a.removeListener=="function"&&a.removeListener("error",l),d([].slice.call(arguments))}eventTargetAgnosticAddListener(a,s,p,{once:!0}),s!=="error"&&addErrorHandlerIfEventEmitter(a,l,{once:!0})})}function addErrorHandlerIfEventEmitter(a,s,d){typeof a.on=="function"&&eventTargetAgnosticAddListener(a,"error",s,d)}function eventTargetAgnosticAddListener(a,s,d,c){if(typeof a.on=="function")c.once?a.once(s,d):a.on(s,d);else if(typeof a.addEventListener=="function")a.addEventListener(s,function l(p){c.once&&a.removeEventListener(s,l),d(p)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof a)}const BACKGROUND_REACTION_DELAY=5e3,recycledElements=[];class Track extends eventsExports.EventEmitter{constructor(s,d){super(),this.attachedElements=[],this.isMuted=!1,this.streamState=Track.StreamState.Active,this._currentBitrate=0,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),document.visibilityState==="hidden"?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),BACKGROUND_REACTION_DELAY):this.handleAppVisibilityChanged()},this.setMaxListeners(100),this.kind=d,this._mediaStreamTrack=s,this._mediaStreamID=s.id,this.source=Track.Source.Unknown,isWeb()?(this.isInBackground=document.visibilityState==="hidden",document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(s){let d="audio";this.kind===Track.Kind.Video&&(d="video"),s||(d==="audio"&&(recycledElements.forEach(l=>{l.parentElement===null&&!s&&(s=l)}),s&&recycledElements.splice(recycledElements.indexOf(s),1)),s||(s=document.createElement(d))),this.attachedElements.includes(s)||this.attachedElements.push(s),attachToElement(this._mediaStreamTrack,s);const c=s.srcObject.getTracks();return c.some(l=>l.kind==="audio")&&s.play().then(()=>{this.emit(TrackEvent.AudioPlaybackStarted)}).catch(l=>{l.name==="NotAllowedError"?this.emit(TrackEvent.AudioPlaybackFailed,l):livekitLogger.warn("could not playback audio",l),s&&c.some(p=>p.kind==="video")&&l.name==="NotAllowedError"&&(s.muted=!0,s.play().catch(()=>{}))}),this.emit(TrackEvent.ElementAttached,s),s}detach(s){if(s){detachTrack(this._mediaStreamTrack,s);const c=this.attachedElements.indexOf(s);return c>=0&&(this.attachedElements.splice(c,1),this.recycleElement(s),this.emit(TrackEvent.ElementDetached,s)),s}const d=[];return this.attachedElements.forEach(c=>{detachTrack(this._mediaStreamTrack,c),d.push(c),this.recycleElement(c),this.emit(TrackEvent.ElementDetached,c)}),this.attachedElements=[],d}stop(){this.stopMonitor(),this._mediaStreamTrack.stop(),isWeb()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval)}recycleElement(s){if(s instanceof HTMLAudioElement){let d=!0;s.pause(),recycledElements.forEach(c=>{c.parentElement||(d=!1)}),d&&recycledElements.push(s)}}async handleAppVisibilityChanged(){this.isInBackground=document.visibilityState==="hidden"}}function attachToElement(a,s){let d;s.srcObject instanceof MediaStream?d=s.srcObject:d=new MediaStream;let c;a.kind==="audio"?c=d.getAudioTracks():c=d.getVideoTracks(),c.includes(a)||(c.forEach(l=>{d.removeTrack(l)}),d.addTrack(a)),s.autoplay=!0,s.muted=d.getAudioTracks().length===0,s instanceof HTMLVideoElement&&(s.playsInline=!0),s.srcObject!==d&&(s.srcObject=d,(isSafari()||isFireFox())&&s instanceof HTMLVideoElement&&setTimeout(()=>{s.srcObject=d,s.play().catch(()=>{})},0))}function detachTrack(a,s){if(s.srcObject instanceof MediaStream){const d=s.srcObject;d.removeTrack(a),d.getTracks().length>0?s.srcObject=d:s.srcObject=null}}(function(a){let s;(function(b){b.Audio="audio",b.Video="video",b.Unknown="unknown"})(s=a.Kind||(a.Kind={}));let d;(function(b){b.Camera="camera",b.Microphone="microphone",b.ScreenShare="screen_share",b.ScreenShareAudio="screen_share_audio",b.Unknown="unknown"})(d=a.Source||(a.Source={}));let c;(function(b){b.Active="active",b.Paused="paused",b.Unknown="unknown"})(c=a.StreamState||(a.StreamState={}));function l(b){switch(b){case s.Audio:return TrackType.AUDIO;case s.Video:return TrackType.VIDEO;default:return TrackType.UNRECOGNIZED}}a.kindToProto=l;function p(b){switch(b){case TrackType.AUDIO:return s.Audio;case TrackType.VIDEO:return s.Video;default:return s.Unknown}}a.kindFromProto=p;function h(b){switch(b){case d.Camera:return TrackSource.CAMERA;case d.Microphone:return TrackSource.MICROPHONE;case d.ScreenShare:return TrackSource.SCREEN_SHARE;case d.ScreenShareAudio:return TrackSource.SCREEN_SHARE_AUDIO;default:return TrackSource.UNRECOGNIZED}}a.sourceToProto=h;function v(b){switch(b){case TrackSource.CAMERA:return d.Camera;case TrackSource.MICROPHONE:return d.Microphone;case TrackSource.SCREEN_SHARE:return d.ScreenShare;case TrackSource.SCREEN_SHARE_AUDIO:return d.ScreenShareAudio;default:return d.Unknown}}a.sourceFromProto=v;function S(b){switch(b){case StreamState.ACTIVE:return c.Active;case StreamState.PAUSED:return c.Paused;default:return c.Unknown}}a.streamStateFromProto=S})(Track||(Track={}));const defaultDimensionsTimeout=2*1e3;class LocalTrack extends Track{constructor(s,d,c){let l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;super(s,d),this._isUpstreamPaused=!1,this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this.emit(TrackEvent.Ended,this)},this._mediaStreamTrack.addEventListener("ended",this.handleEnded),this.constraints=c!=null?c:s.getConstraints(),this.reacquireTrack=!1,this.providedByUser=l,this.muteQueue=new Queue}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==Track.Kind.Video)return;const{width:s,height:d}=this._mediaStreamTrack.getSettings();if(s&&d)return{width:s,height:d}}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}async waitForDimensions(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:defaultDimensionsTimeout;if(this.kind===Track.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");const d=Date.now();for(;Date.now()-d<s;){const c=this.dimensions;if(c)return c;await sleep(50)}throw new TrackInvalidError("unable to get track dimensions after timeout")}async getDeviceId(){if(this.source===Track.Source.ScreenShare)return;const{deviceId:s,groupId:d}=this._mediaStreamTrack.getSettings(),c=this.kind===Track.Kind.Audio?"audioinput":"videoinput";return DeviceManager.getInstance().normalizeDeviceId(c,s,d)}async mute(){return this.setTrackMuted(!0),this}async unmute(){return this.setTrackMuted(!1),this}async replaceTrack(s){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!this.sender)throw new TrackInvalidError("unable to replace an unpublished track");return this.attachedElements.forEach(c=>{detachTrack(this._mediaStreamTrack,c)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this.providedByUser||this._mediaStreamTrack.stop(),s.addEventListener("ended",this.handleEnded),livekitLogger.debug("replace MediaStreamTrack"),this.sender&&await this.sender.replaceTrack(s),this._mediaStreamTrack=s,this._mediaStreamTrack.enabled=!this.isMuted,await this.resumeUpstream(),this.attachedElements.forEach(c=>{attachToElement(s,c)}),this.mediaStream=new MediaStream([s]),this.providedByUser=d,this}async restart(s){s||(s=this.constraints),livekitLogger.debug("restarting track with constraints",s);const d={audio:!1,video:!1};this.kind===Track.Kind.Video?d.video=s:d.audio=s,this.attachedElements.forEach(p=>{detachTrack(this._mediaStreamTrack,p)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const c=await navigator.mediaDevices.getUserMedia(d),l=c.getTracks()[0];return l.addEventListener("ended",this.handleEnded),livekitLogger.debug("re-acquired MediaStreamTrack"),this.sender&&await this.sender.replaceTrack(l),this._mediaStreamTrack=l,await this.resumeUpstream(),this.attachedElements.forEach(p=>{attachToElement(l,p)}),this.mediaStream=c,this.constraints=s,this.emit(TrackEvent.Restarted,this),this}setTrackMuted(s){livekitLogger.debug("setting ".concat(this.kind," track ").concat(s?"muted":"unmuted")),!(this.isMuted===s&&this._mediaStreamTrack.enabled!==s)&&(this.isMuted=s,this._mediaStreamTrack.enabled=!s,this.emit(s?TrackEvent.Muted:TrackEvent.Unmuted,this))}get needsReAcquisition(){return this._mediaStreamTrack.readyState!=="live"||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}async handleAppVisibilityChanged(){await super.handleAppVisibilityChanged(),isMobile()&&(livekitLogger.debug("visibility changed, is in Background: ".concat(this.isInBackground)),!this.isInBackground&&this.needsReAcquisition&&!this.isUserProvided&&!this.isMuted&&(livekitLogger.debug("track needs to be reaquired, restarting ".concat(this.source)),await this.restart(),this.reacquireTrack=!1))}async pauseUpstream(){this.muteQueue.run(async()=>{if(this._isUpstreamPaused===!0)return;if(!this.sender){livekitLogger.warn("unable to pause upstream for an unpublished track");return}this._isUpstreamPaused=!0,this.emit(TrackEvent.UpstreamPaused,this);const s=this.kind===Track.Kind.Audio?getEmptyAudioStreamTrack():getEmptyVideoStreamTrack();await this.sender.replaceTrack(s)})}async resumeUpstream(){this.muteQueue.run(async()=>{if(this._isUpstreamPaused!==!1){if(!this.sender){livekitLogger.warn("unable to resume upstream for an unpublished track");return}this._isUpstreamPaused=!1,this.emit(TrackEvent.UpstreamResumed,this),await this.sender.replaceTrack(this._mediaStreamTrack)}})}}class LocalAudioTrack extends LocalTrack{constructor(s,d){let c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;super(s,Track.Kind.Audio,d,c),this.stopOnMute=!1,this.monitorSender=async()=>{if(!this.sender){this._currentBitrate=0;return}let l;try{l=await this.getSenderStats()}catch(p){livekitLogger.error("could not get audio sender stats",{error:p});return}l&&this.prevStats&&(this._currentBitrate=computeBitrate(l,this.prevStats)),this.prevStats=l},this.checkForSilence()}async setDeviceId(s){this.constraints.deviceId!==s&&(this.constraints.deviceId=s,this.isMuted||await this.restartTrack())}async mute(){return await this.muteQueue.run(async()=>{this.source===Track.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(livekitLogger.debug("stopping mic track"),this._mediaStreamTrack.stop()),await super.mute()}),this}async unmute(){return await this.muteQueue.run(async()=>{this.source===Track.Source.Microphone&&(this.stopOnMute||this._mediaStreamTrack.readyState==="ended")&&!this.isUserProvided&&(livekitLogger.debug("reacquiring mic track"),await this.restartTrack()),await super.unmute()}),this}async restartTrack(s){let d;if(s){const c=constraintsForOptions({audio:s});typeof c.audio!="boolean"&&(d=c.audio)}await this.restart(d)}async restart(s){const d=await super.restart(s);return this.checkForSilence(),d}startMonitor(){!isWeb()||this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},monitorFrequency))}async getSenderStats(){var s;if(!(!((s=this.sender)===null||s===void 0)&&s.getStats))return;const d=await this.sender.getStats();let c;return d.forEach(l=>{l.type==="outbound-rtp"&&(c={type:"audio",streamId:l.id,packetsSent:l.packetsSent,packetsLost:l.packetsLost,bytesSent:l.bytesSent,timestamp:l.timestamp,roundTripTime:l.roundTripTime,jitter:l.jitter})}),c}async checkForSilence(){await detectSilence(this)&&(this.isMuted||livekitLogger.warn("silence detected on local audio track"),this.emit(TrackEvent.AudioSilenceDetected))}}const refreshSubscribedCodecAfterNewCodec=5e3;class LocalVideoTrack extends LocalTrack{constructor(s,d){let c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;super(s,Track.Kind.Video,d,c),this.simulcastCodecs=new Map,this.monitorSender=async()=>{if(!this.sender){this._currentBitrate=0;return}let l;try{l=await this.getSenderStats()}catch(h){livekitLogger.error("could not get audio sender stats",{error:h});return}const p=new Map(l.map(h=>[h.rid,h]));if(this.prevStats){let h=0;p.forEach((v,S)=>{var b;const _=(b=this.prevStats)===null||b===void 0?void 0:b.get(S);h+=computeBitrate(v,_)}),this._currentBitrate=h}this.prevStats=p},this.senderLock=new Mutex}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(s){var d;if(this.signalClient=s,!isWeb())return;const c=(d=this.sender)===null||d===void 0?void 0:d.getParameters();c&&(this.encodings=c.encodings),!this.monitorInterval&&(this.monitorInterval=setInterval(()=>{this.monitorSender()},monitorFrequency))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach(s=>{s.mediaStreamTrack.stop()}),super.stop()}async mute(){return await this.muteQueue.run(async()=>{this.source===Track.Source.Camera&&!this.isUserProvided&&(livekitLogger.debug("stopping camera track"),this._mediaStreamTrack.stop()),await super.mute()}),this}async unmute(){return await this.muteQueue.run(async()=>{this.source===Track.Source.Camera&&!this.isUserProvided&&(livekitLogger.debug("reacquiring camera track"),await this.restartTrack()),await super.unmute()}),this}async getSenderStats(){var s;if(!(!((s=this.sender)===null||s===void 0)&&s.getStats))return[];const d=[],c=await this.sender.getStats();return c.forEach(l=>{var p;if(l.type==="outbound-rtp"){const h={type:"video",streamId:l.id,frameHeight:l.frameHeight,frameWidth:l.frameWidth,firCount:l.firCount,pliCount:l.pliCount,nackCount:l.nackCount,packetsSent:l.packetsSent,bytesSent:l.bytesSent,framesSent:l.framesSent,timestamp:l.timestamp,rid:(p=l.rid)!==null&&p!==void 0?p:l.id,retransmittedPacketsSent:l.retransmittedPacketsSent,qualityLimitationReason:l.qualityLimitationReason,qualityLimitationResolutionChanges:l.qualityLimitationResolutionChanges},v=c.get(l.remoteId);v&&(h.jitter=v.jitter,h.packetsLost=v.packetsLost,h.roundTripTime=v.roundTripTime),d.push(h)}}),d}setPublishingQuality(s){const d=[];for(let c=VideoQuality.LOW;c<=VideoQuality.HIGH;c+=1)d.push({quality:c,enabled:c<=s});livekitLogger.debug("setting publishing quality. max quality ".concat(s)),this.setPublishingLayers(d)}async setDeviceId(s){this.constraints.deviceId!==s&&(this.constraints.deviceId=s,this.isMuted||await this.restartTrack())}async restartTrack(s){let d;if(s){const c=constraintsForOptions({video:s});typeof c.video!="boolean"&&(d=c.video)}await this.restart(d)}addSimulcastTrack(s,d){if(this.simulcastCodecs.has(s))throw new Error("".concat(s," already added"));const c={codec:s,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:d};return this.simulcastCodecs.set(s,c),c}setSimulcastTrackSender(s,d){const c=this.simulcastCodecs.get(s);!c||(c.sender=d,setTimeout(()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)},refreshSubscribedCodecAfterNewCodec))}async setPublishingCodecs(s){if(livekitLogger.debug("setting publishing codecs",{codecs:s,currentCodec:this.codec}),!this.codec&&s.length>0)return await this.setPublishingLayers(s[0].qualities),[];this.subscribedCodecs=s;const d=[];var c=!1,l=!1,p;try{for(var h=_asyncIterator(s),v;c=!(v=await h.next()).done;c=!1){const S=v.value;if(!this.codec||this.codec===S.codec)await this.setPublishingLayers(S.qualities);else{const b=this.simulcastCodecs.get(S.codec);if(livekitLogger.debug("try setPublishingCodec for ".concat(S.codec),b),!b||!b.sender){for(const _ of S.qualities)if(_.enabled){d.push(S.codec);break}}else b.encodings&&(livekitLogger.debug("try setPublishingLayersForSender ".concat(S.codec)),await setPublishingLayersForSender(b.sender,b.encodings,S.qualities,this.senderLock))}}}catch(S){l=!0,p=S}finally{try{c&&h.return!=null&&await h.return()}finally{if(l)throw p}}return d}async setPublishingLayers(s){livekitLogger.debug("setting publishing layers",s),!(!this.sender||!this.encodings)&&await setPublishingLayersForSender(this.sender,this.encodings,s,this.senderLock)}async handleAppVisibilityChanged(){await super.handleAppVisibilityChanged(),!!isMobile()&&this.isInBackground&&this.source===Track.Source.Camera&&(this._mediaStreamTrack.enabled=!1)}}async function setPublishingLayersForSender(a,s,d,c){const l=await c.lock();livekitLogger.debug("setPublishingLayersForSender",{sender:a,qualities:d,senderEncodings:s});try{const p=a.getParameters(),{encodings:h}=p;if(!h)return;if(h.length!==s.length){livekitLogger.warn("cannot set publishing layers, encodings mismatch");return}let v=!1;h.forEach((S,b)=>{var _;let I=(_=S.rid)!==null&&_!==void 0?_:"";I===""&&(I="q");const T=videoQualityForRid(I),k=d.find(w=>w.quality===T);!k||S.active!==k.enabled&&(v=!0,S.active=k.enabled,livekitLogger.debug("setting layer ".concat(k.quality," to ").concat(S.active?"enabled":"disabled")),isFireFox()&&(k.enabled?(S.scaleResolutionDownBy=s[b].scaleResolutionDownBy,S.maxBitrate=s[b].maxBitrate,S.maxFrameRate=s[b].maxFrameRate):(S.scaleResolutionDownBy=4,S.maxBitrate=10,S.maxFrameRate=2)))}),v&&(p.encodings=h,await a.setParameters(p))}finally{l()}}function videoQualityForRid(a){switch(a){case"f":return VideoQuality.HIGH;case"h":return VideoQuality.MEDIUM;case"q":return VideoQuality.LOW;default:return VideoQuality.UNRECOGNIZED}}function videoLayersFromEncodings(a,s,d){return d?d.map(c=>{var l,p,h;const v=(l=c.scaleResolutionDownBy)!==null&&l!==void 0?l:1;let S=videoQualityForRid((p=c.rid)!==null&&p!==void 0?p:"");return S===VideoQuality.UNRECOGNIZED&&d.length===1&&(S=VideoQuality.HIGH),{quality:S,width:a/v,height:s/v,bitrate:(h=c.maxBitrate)!==null&&h!==void 0?h:0,ssrc:0}}):[{quality:VideoQuality.HIGH,width:a,height:s,bitrate:0,ssrc:0}]}class RemoteTrack extends Track{constructor(s,d,c,l){super(s,c),this.sid=d,this.receiver=l}setMuted(s){this.isMuted!==s&&(this.isMuted=s,this._mediaStreamTrack.enabled=!s,this.emit(s?TrackEvent.Muted:TrackEvent.Unmuted,this))}setMediaStream(s){this.mediaStream=s,s.onremovetrack=()=>{this.receiver=void 0,this._currentBitrate=0,this.emit(TrackEvent.Ended,this)}}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval(()=>this.monitorReceiver(),monitorFrequency))}}class RemoteAudioTrack extends RemoteTrack{constructor(s,d,c,l,p){super(s,d,Track.Kind.Audio,c),this.monitorReceiver=async()=>{if(!this.receiver){this._currentBitrate=0;return}const h=await this.getReceiverStats();h&&this.prevStats&&this.receiver&&(this._currentBitrate=computeBitrate(h,this.prevStats)),this.prevStats=h},this.audioContext=l,this.webAudioPluginNodes=[],p&&(this.sinkId=p.deviceId)}setVolume(s){var d;for(const c of this.attachedElements)this.audioContext?(d=this.gainNode)===null||d===void 0||d.gain.setTargetAtTime(s,0,.1):c.volume=s;this.elementVolume=s}getVolume(){if(this.elementVolume)return this.elementVolume;let s=0;return this.attachedElements.forEach(d=>{d.volume>s&&(s=d.volume)}),s}async setSinkId(s){this.sinkId=s,await Promise.all(this.attachedElements.map(d=>{if(!!supportsSetSinkId(d))return d.setSinkId(s)}))}attach(s){const d=this.attachedElements.length===0;return s?super.attach(s):s=super.attach(),this.elementVolume&&(s.volume=this.elementVolume),this.sinkId&&supportsSetSinkId(s)&&s.setSinkId(this.sinkId),this.audioContext&&d&&(livekitLogger.debug("using audio context mapping"),this.connectWebAudio(this.audioContext,s),s.volume=0,s.muted=!0),s}detach(s){let d;return s?(d=super.detach(s),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(d=super.detach(),this.disconnectWebAudio()),d}setAudioContext(s){this.audioContext=s,s&&this.attachedElements.length>0?this.connectWebAudio(s,this.attachedElements[0]):s||this.disconnectWebAudio()}setWebAudioPlugins(s){this.webAudioPluginNodes=s,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(s,d){this.disconnectWebAudio(),this.sourceNode=s.createMediaStreamSource(d.srcObject);let c=this.sourceNode;this.webAudioPluginNodes.forEach(l=>{c.connect(l),c=l}),this.gainNode=s.createGain(),c.connect(this.gainNode),this.gainNode.connect(s.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),s.state!=="running"&&s.resume().then(()=>{s.state!=="running"&&this.emit(TrackEvent.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))}).catch(l=>{this.emit(TrackEvent.AudioPlaybackFailed,l)})}disconnectWebAudio(){var s,d;(s=this.gainNode)===null||s===void 0||s.disconnect(),(d=this.sourceNode)===null||d===void 0||d.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}async getReceiverStats(){if(!this.receiver||!this.receiver.getStats)return;const s=await this.receiver.getStats();let d;return s.forEach(c=>{c.type==="inbound-rtp"&&(d={type:"audio",timestamp:c.timestamp,jitter:c.jitter,bytesReceived:c.bytesReceived,concealedSamples:c.concealedSamples,concealmentEvents:c.concealmentEvents,silentConcealedSamples:c.silentConcealedSamples,silentConcealmentEvents:c.silentConcealmentEvents,totalAudioEnergy:c.totalAudioEnergy,totalSamplesDuration:c.totalSamplesDuration})}),d}}function r(a,s,d){var c,l,p;s===void 0&&(s=50),d===void 0&&(d={});var h=(c=d.isImmediate)!=null&&c,v=(l=d.callback)!=null&&l,S=d.maxWait,b=Date.now(),_=[];function I(){if(S!==void 0){var k=Date.now()-b;if(k+s>=S)return S-k}return s}var T=function(){var k=[].slice.call(arguments),w=this;return new Promise(function(P,$){var U=h&&p===void 0;if(p!==void 0&&clearTimeout(p),p=setTimeout(function(){if(p=void 0,b=Date.now(),!h){var D=a.apply(w,k);v&&v(D),_.forEach(function(F){return(0,F.resolve)(D)}),_=[]}},I()),U){var E=a.apply(w,k);return v&&v(E),P(E)}_.push({resolve:P,reject:$})})};return T.cancel=function(k){p!==void 0&&clearTimeout(p),_.forEach(function(w){return(0,w.reject)(k)}),_=[]},T}class CriticalTimers{}CriticalTimers.setTimeout=function(){return setTimeout(...arguments)},CriticalTimers.setInterval=function(){return setInterval(...arguments)},CriticalTimers.clearTimeout=function(){return clearTimeout(...arguments)},CriticalTimers.clearInterval=function(){return clearInterval(...arguments)};const REACTION_DELAY=100;class RemoteVideoTrack extends RemoteTrack{constructor(s,d,c,l){super(s,d,Track.Kind.Video,c),this.elementInfos=[],this.hasUsedAttach=!1,this.monitorReceiver=async()=>{if(!this.receiver){this._currentBitrate=0;return}const p=await this.getReceiverStats();p&&this.prevStats&&this.receiver&&(this._currentBitrate=computeBitrate(p,this.prevStats)),this.prevStats=p},this.debouncedHandleResize=r(()=>{this.updateDimensions()},REACTION_DELAY),this.adaptiveStreamSettings=l}get isAdaptiveStream(){return this.adaptiveStreamSettings!==void 0}get mediaStreamTrack(){return this.isAdaptiveStream&&!this.hasUsedAttach&&livekitLogger.warn("When using adaptiveStream, you need to use remoteVideoTrack.attach() to add the track to a HTMLVideoElement, otherwise your video tracks might never start"),this._mediaStreamTrack}setMuted(s){super.setMuted(s),this.attachedElements.forEach(d=>{s?detachTrack(this._mediaStreamTrack,d):attachToElement(this._mediaStreamTrack,d)})}attach(s){if(s?super.attach(s):s=super.attach(),this.adaptiveStreamSettings&&this.elementInfos.find(d=>d.element===s)===void 0){const d=new HTMLElementInfo(s);this.observeElementInfo(d)}return this.hasUsedAttach=!0,s}observeElementInfo(s){this.adaptiveStreamSettings&&this.elementInfos.find(d=>d===s)===void 0?(s.handleResize=()=>{this.debouncedHandleResize()},s.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(s),s.observe(),this.debouncedHandleResize(),this.updateVisibility()):livekitLogger.warn("visibility resize observer not triggered")}stopObservingElementInfo(s){if(!this.isAdaptiveStream){livekitLogger.warn("stopObservingElementInfo ignored");return}const d=this.elementInfos.filter(c=>c===s);for(const c of d)c.stopObserving();this.elementInfos=this.elementInfos.filter(c=>c!==s),this.updateVisibility()}detach(s){let d=[];if(s)return this.stopObservingElement(s),super.detach(s);d=super.detach();for(const c of d)this.stopObservingElement(c);return d}getDecoderImplementation(){var s;return(s=this.prevStats)===null||s===void 0?void 0:s.decoderImplementation}async getReceiverStats(){if(!this.receiver||!this.receiver.getStats)return;const s=await this.receiver.getStats();let d;return s.forEach(c=>{c.type==="inbound-rtp"&&(d={type:"video",framesDecoded:c.framesDecoded,framesDropped:c.framesDropped,framesReceived:c.framesReceived,packetsReceived:c.packetsReceived,packetsLost:c.packetsLost,frameWidth:c.frameWidth,frameHeight:c.frameHeight,pliCount:c.pliCount,firCount:c.firCount,nackCount:c.nackCount,jitter:c.jitter,timestamp:c.timestamp,bytesReceived:c.bytesReceived,decoderImplementation:c.decoderImplementation})}),d}stopObservingElement(s){const d=this.elementInfos.filter(c=>c.element===s);for(const c of d)c.stopObserving();this.elementInfos=this.elementInfos.filter(c=>c.element!==s)}async handleAppVisibilityChanged(){await super.handleAppVisibilityChanged(),this.isAdaptiveStream&&this.updateVisibility()}updateVisibility(){var s,d;const c=this.elementInfos.reduce((h,v)=>Math.max(h,v.visibilityChangedAt||0),0),l=!((d=(s=this.adaptiveStreamSettings)===null||s===void 0?void 0:s.pauseVideoInBackground)!==null&&d!==void 0)||d?this.isInBackground:!1,p=this.elementInfos.some(h=>h.visible)&&!l;if(this.lastVisible!==p){if(!p&&Date.now()-c<REACTION_DELAY){CriticalTimers.setTimeout(()=>{this.updateVisibility()},REACTION_DELAY);return}this.lastVisible=p,this.emit(TrackEvent.VisibilityChanged,p,this)}}updateDimensions(){var s,d,c,l;let p=0,h=0;for(const v of this.elementInfos){const S=(d=(s=this.adaptiveStreamSettings)===null||s===void 0?void 0:s.pixelDensity)!==null&&d!==void 0?d:1,b=S==="screen"?window.devicePixelRatio:S,_=v.width()*b,I=v.height()*b;_+I>p+h&&(p=_,h=I)}((c=this.lastDimensions)===null||c===void 0?void 0:c.width)===p&&((l=this.lastDimensions)===null||l===void 0?void 0:l.height)===h||(this.lastDimensions={width:p,height:h},this.emit(TrackEvent.VideoDimensionsChanged,this.lastDimensions,this))}}class HTMLElementInfo{constructor(s,d){this.onVisibilityChanged=c=>{var l;const{target:p,isIntersecting:h}=c;p===this.element&&(this.visible=h,this.visibilityChangedAt=Date.now(),(l=this.handleVisibilityChanged)===null||l===void 0||l.call(this))},this.element=s,this.visible=d!=null?d:isElementInViewport(s),this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){this.element.handleResize=()=>{var s;(s=this.handleResize)===null||s===void 0||s.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,getIntersectionObserver().observe(this.element),getResizeObserver().observe(this.element)}stopObserving(){var s,d;(s=getIntersectionObserver())===null||s===void 0||s.unobserve(this.element),(d=getResizeObserver())===null||d===void 0||d.unobserve(this.element)}}function isElementInViewport(a){let s=a.offsetTop,d=a.offsetLeft;const c=a.offsetWidth,l=a.offsetHeight,{hidden:p}=a,{opacity:h,display:v}=getComputedStyle(a);for(;a.offsetParent;)a=a.offsetParent,s+=a.offsetTop,d+=a.offsetLeft;return s<window.pageYOffset+window.innerHeight&&d<window.pageXOffset+window.innerWidth&&s+l>window.pageYOffset&&d+c>window.pageXOffset&&!p&&(h!==""?parseFloat(h)>0:!0)&&v!=="none"}class TrackPublication extends eventsExports.EventEmitter{constructor(s,d,c){super(),this.metadataMuted=!1,this.handleMuted=()=>{this.emit(TrackEvent.Muted)},this.handleUnmuted=()=>{this.emit(TrackEvent.Unmuted)},this.setMaxListeners(100),this.kind=s,this.trackSid=d,this.trackName=c,this.source=Track.Source.Unknown}setTrack(s){this.track&&(this.track.off(TrackEvent.Muted,this.handleMuted),this.track.off(TrackEvent.Unmuted,this.handleUnmuted)),this.track=s,s&&(s.on(TrackEvent.Muted,this.handleMuted),s.on(TrackEvent.Unmuted,this.handleUnmuted))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return this.track!==void 0}get audioTrack(){if(this.track instanceof LocalAudioTrack||this.track instanceof RemoteAudioTrack)return this.track}get videoTrack(){if(this.track instanceof LocalVideoTrack||this.track instanceof RemoteVideoTrack)return this.track}updateInfo(s){this.trackSid=s.sid,this.trackName=s.name,this.source=Track.sourceFromProto(s.source),this.mimeType=s.mimeType,this.kind===Track.Kind.Video&&s.width>0&&(this.dimensions={width:s.width,height:s.height},this.simulcasted=s.simulcast),this.trackInfo=s,livekitLogger.trace("update publication info",{info:s})}}(function(a){(function(s){s.Desired="desired",s.Subscribed="subscribed",s.Unsubscribed="unsubscribed"})(a.SubscriptionStatus||(a.SubscriptionStatus={})),function(s){s.Allowed="allowed",s.NotAllowed="not_allowed"}(a.PermissionStatus||(a.PermissionStatus={}))})(TrackPublication||(TrackPublication={}));class LocalTrackPublication extends TrackPublication{get isUpstreamPaused(){var s;return(s=this.track)===null||s===void 0?void 0:s.isUpstreamPaused}constructor(s,d,c){super(s,d.sid,d.name),this.track=void 0,this.handleTrackEnded=()=>{this.emit(TrackEvent.Ended)},this.updateInfo(d),this.setTrack(c)}setTrack(s){this.track&&this.track.off(TrackEvent.Ended,this.handleTrackEnded),super.setTrack(s),s&&s.on(TrackEvent.Ended,this.handleTrackEnded)}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}async mute(){var s;return(s=this.track)===null||s===void 0?void 0:s.mute()}async unmute(){var s;return(s=this.track)===null||s===void 0?void 0:s.unmute()}async pauseUpstream(){var s;await((s=this.track)===null||s===void 0?void 0:s.pauseUpstream())}async resumeUpstream(){var s;await((s=this.track)===null||s===void 0?void 0:s.resumeUpstream())}}class VideoPreset{constructor(s,d,c,l){this.width=s,this.height=d,this.encoding={maxBitrate:c,maxFramerate:l}}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.width/this.height}}}const backupCodecs=["vp8","h264"];function isBackupCodec(a){return!!backupCodecs.find(s=>s===a)}var AudioPresets;(function(a){a.telephone={maxBitrate:12e3},a.speech={maxBitrate:2e4},a.music={maxBitrate:32e3},a.musicStereo={maxBitrate:48e3},a.musicHighQuality={maxBitrate:64e3},a.musicHighQualityStereo={maxBitrate:96e3}})(AudioPresets||(AudioPresets={}));const VideoPresets={h90:new VideoPreset(160,90,6e4,15),h180:new VideoPreset(320,180,12e4,15),h216:new VideoPreset(384,216,18e4,15),h360:new VideoPreset(640,360,3e5,20),h540:new VideoPreset(960,540,6e5,25),h720:new VideoPreset(1280,720,17e5,30),h1080:new VideoPreset(1920,1080,3e6,30),h1440:new VideoPreset(2560,1440,5e6,30),h2160:new VideoPreset(3840,2160,8e6,30)},VideoPresets43={h120:new VideoPreset(160,120,8e4,15),h180:new VideoPreset(240,180,1e5,15),h240:new VideoPreset(320,240,15e4,15),h360:new VideoPreset(480,360,225e3,20),h480:new VideoPreset(640,480,3e5,20),h540:new VideoPreset(720,540,45e4,25),h720:new VideoPreset(960,720,15e5,30),h1080:new VideoPreset(1440,1080,25e5,30),h1440:new VideoPreset(1920,1440,35e5,30)},ScreenSharePresets={h360fps3:new VideoPreset(640,360,2e5,3),h720fps5:new VideoPreset(1280,720,4e5,5),h720fps15:new VideoPreset(1280,720,1e6,15),h1080fps15:new VideoPreset(1920,1080,15e5,15),h1080fps30:new VideoPreset(1920,1080,3e6,30)};var ConnectionQuality;(function(a){a.Excellent="excellent",a.Good="good",a.Poor="poor",a.Unknown="unknown"})(ConnectionQuality||(ConnectionQuality={}));function qualityFromProto(a){switch(a){case ConnectionQuality$1.EXCELLENT:return ConnectionQuality.Excellent;case ConnectionQuality$1.GOOD:return ConnectionQuality.Good;case ConnectionQuality$1.POOR:return ConnectionQuality.Poor;default:return ConnectionQuality.Unknown}}class Participant extends eventsExports.EventEmitter{constructor(s,d,c,l){super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=ConnectionQuality.Unknown,this.setMaxListeners(100),this.sid=s,this.identity=d,this.name=c,this.metadata=l,this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map}getTracks(){return Array.from(this.tracks.values())}getTrack(s){for(const[,d]of this.tracks)if(d.source===s)return d}getTrackByName(s){for(const[,d]of this.tracks)if(d.trackName===s)return d}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var s;const d=this.getTrack(Track.Source.Camera);return!(!((s=d==null?void 0:d.isMuted)!==null&&s!==void 0)||s)}get isMicrophoneEnabled(){var s;const d=this.getTrack(Track.Source.Microphone);return!(!((s=d==null?void 0:d.isMuted)!==null&&s!==void 0)||s)}get isScreenShareEnabled(){return!!this.getTrack(Track.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(this.participantInfo.joinedAt*1e3):new Date}updateInfo(s){this.identity=s.identity,this.sid=s.sid,this.name=s.name,this.setMetadata(s.metadata),s.permission&&this.setPermissions(s.permission),this.participantInfo=s,livekitLogger.trace("update participant info",{info:s})}setMetadata(s){const d=this.metadata!==s,c=this.metadata;this.metadata=s,d&&this.emit(ParticipantEvent.ParticipantMetadataChanged,c)}setPermissions(s){var d,c,l,p,h;const v=this.permissions,S=s.canPublish!==((d=this.permissions)===null||d===void 0?void 0:d.canPublish)||s.canSubscribe!==((c=this.permissions)===null||c===void 0?void 0:c.canSubscribe)||s.canPublishData!==((l=this.permissions)===null||l===void 0?void 0:l.canPublishData)||s.hidden!==((p=this.permissions)===null||p===void 0?void 0:p.hidden)||s.recorder!==((h=this.permissions)===null||h===void 0?void 0:h.recorder)||s.canPublishSources.length!==this.permissions.canPublishSources.length||s.canPublishSources.some((b,_)=>{var I;return b!==((I=this.permissions)===null||I===void 0?void 0:I.canPublishSources[_])});return this.permissions=s,S&&this.emit(ParticipantEvent.ParticipantPermissionsChanged,v),S}setIsSpeaking(s){s!==this.isSpeaking&&(this.isSpeaking=s,s&&(this.lastSpokeAt=new Date),this.emit(ParticipantEvent.IsSpeakingChanged,s))}setConnectionQuality(s){const d=this._connectionQuality;this._connectionQuality=qualityFromProto(s),d!==this._connectionQuality&&this.emit(ParticipantEvent.ConnectionQualityChanged,this._connectionQuality)}addTrackPublication(s){s.on(TrackEvent.Muted,()=>{this.emit(ParticipantEvent.TrackMuted,s)}),s.on(TrackEvent.Unmuted,()=>{this.emit(ParticipantEvent.TrackUnmuted,s)});const d=s;switch(d.track&&(d.track.sid=s.trackSid),this.tracks.set(s.trackSid,s),s.kind){case Track.Kind.Audio:this.audioTracks.set(s.trackSid,s);break;case Track.Kind.Video:this.videoTracks.set(s.trackSid,s);break}}}function trackPermissionToProto(a){var s,d,c;if(!a.participantSid&&!a.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return{participantIdentity:(s=a.participantIdentity)!==null&&s!==void 0?s:"",participantSid:(d=a.participantSid)!==null&&d!==void 0?d:"",allTracks:(c=a.allowAll)!==null&&c!==void 0?c:!1,trackSids:a.allowedTrackSids||[]}}function mediaTrackToLocalTrack(a,s){switch(a.kind){case"audio":return new LocalAudioTrack(a,s,!1);case"video":return new LocalVideoTrack(a,s,!1);default:throw new TrackInvalidError("unsupported track type: ".concat(a.kind))}}const presets169=Object.values(VideoPresets),presets43=Object.values(VideoPresets43),presetsScreenShare=Object.values(ScreenSharePresets),defaultSimulcastPresets169=[VideoPresets.h180,VideoPresets.h360],defaultSimulcastPresets43=[VideoPresets43.h180,VideoPresets43.h360],computeDefaultScreenShareSimulcastPresets=a=>[{scaleResolutionDownBy:2,fps:3}].map(d=>{var c;return new VideoPreset(Math.floor(a.width/d.scaleResolutionDownBy),Math.floor(a.height/d.scaleResolutionDownBy),Math.max(15e4,Math.floor(a.encoding.maxBitrate/(d.scaleResolutionDownBy**2*(((c=a.encoding.maxFramerate)!==null&&c!==void 0?c:30)/d.fps)))),d.fps)}),videoRids=["q","h","f"];function computeVideoEncodings(a,s,d,c){var l,p;let h=c==null?void 0:c.videoEncoding;a&&(h=c==null?void 0:c.screenShareEncoding);const v=c==null?void 0:c.simulcast,S=c==null?void 0:c.scalabilityMode,b=c==null?void 0:c.videoCodec;if(!h&&!v&&!S||!s||!d)return[{}];h||(h=determineAppropriateEncoding(a,s,d,b),livekitLogger.debug("using video encoding",h));const _=new VideoPreset(s,d,h.maxBitrate,h.maxFramerate);if(S&&b==="av1"){livekitLogger.debug("using svc with scalabilityMode ".concat(S));const k=[];switch(S){case"L3T3":for(let w=0;w<3;w+=1)k.push({rid:videoRids[2-w],scaleResolutionDownBy:2**w,maxBitrate:h.maxBitrate/3**w,maxFramerate:_.encoding.maxFramerate,scalabilityMode:"L3T3"});return livekitLogger.debug("encodings",k),k;default:throw new Error("unsupported scalabilityMode: ".concat(S))}}if(!v)return[h];let I=[];a?I=(l=sortPresets(c==null?void 0:c.screenShareSimulcastLayers))!==null&&l!==void 0?l:defaultSimulcastLayers(a,_):I=(p=sortPresets(c==null?void 0:c.videoSimulcastLayers))!==null&&p!==void 0?p:defaultSimulcastLayers(a,_);let T;if(I.length>0){const k=I[0];I.length>1&&([,T]=I);const w=Math.max(s,d);if(w>=960&&T)return encodingsFromPresets(s,d,[k,T,_]);if(w>=480)return encodingsFromPresets(s,d,[k,_])}return encodingsFromPresets(s,d,[_])}function computeTrackBackupEncodings(a,s,d){var c,l,p,h;if(!d.backupCodec||d.backupCodec.codec===d.videoCodec)return;s!==d.backupCodec.codec&&livekitLogger.warn("requested a different codec than specified as backup",{serverRequested:s,backup:d.backupCodec.codec}),d.videoCodec=s,d.videoEncoding=d.backupCodec.encoding;const v=a.mediaStreamTrack.getSettings(),S=(c=v.width)!==null&&c!==void 0?c:(l=a.dimensions)===null||l===void 0?void 0:l.width,b=(p=v.height)!==null&&p!==void 0?p:(h=a.dimensions)===null||h===void 0?void 0:h.height;return computeVideoEncodings(a.source===Track.Source.ScreenShare,S,b,d)}function determineAppropriateEncoding(a,s,d,c){const l=presetsForResolution(a,s,d);let{encoding:p}=l[0];const h=Math.max(s,d);for(let v=0;v<l.length;v+=1){const S=l[v];if(p=S.encoding,S.width>=h)break}if(c)switch(c){case"av1":p.maxBitrate=p.maxBitrate*.7;break}return p}function presetsForResolution(a,s,d){if(a)return presetsScreenShare;const c=s>d?s/d:d/s;return Math.abs(c-16/9)<Math.abs(c-4/3)?presets169:presets43}function defaultSimulcastLayers(a,s){if(a)return computeDefaultScreenShareSimulcastPresets(s);const{width:d,height:c}=s,l=d>c?d/c:c/d;return Math.abs(l-16/9)<Math.abs(l-4/3)?defaultSimulcastPresets169:defaultSimulcastPresets43}function encodingsFromPresets(a,s,d){const c=[];return d.forEach((l,p)=>{if(p>=videoRids.length)return;const h=Math.min(a,s),v=videoRids[p];c.push({rid:v,scaleResolutionDownBy:Math.max(1,h/Math.min(l.width,l.height)),maxBitrate:l.encoding.maxBitrate,maxFramerate:l.encoding.maxFramerate})}),c}function sortPresets(a){if(!!a)return a.sort((s,d)=>{const{encoding:c}=s,{encoding:l}=d;return c.maxBitrate>l.maxBitrate?1:c.maxBitrate<l.maxBitrate?-1:c.maxBitrate===l.maxBitrate&&c.maxFramerate&&l.maxFramerate?c.maxFramerate>l.maxFramerate?1:-1:0})}class RemoteTrackPublication extends TrackPublication{constructor(s,d,c){super(s,d.sid,d.name),this.track=void 0,this.allowed=!0,this.disabled=!1,this.currentVideoQuality=VideoQuality.HIGH,this.handleEnded=l=>{this.setTrack(void 0),this.emit(TrackEvent.Ended,l)},this.handleVisibilityChange=l=>{livekitLogger.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(l),{trackSid:this.trackSid}),this.disabled=!l,this.emitTrackUpdate()},this.handleVideoDimensionsChange=l=>{livekitLogger.debug("adaptivestream video dimensions ".concat(l.width,"x").concat(l.height),{trackSid:this.trackSid}),this.videoDimensions=l,this.emitTrackUpdate()},this.subscribed=c,this.updateInfo(d)}setSubscribed(s){const d=this.subscriptionStatus,c=this.permissionStatus;this.subscribed=s,s&&(this.allowed=!0);const l={trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[{participantSid:"",trackSids:[this.trackSid]}]};this.emit(TrackEvent.UpdateSubscription,l),this.emitSubscriptionUpdateIfChanged(d),this.emitPermissionUpdateIfChanged(c)}get subscriptionStatus(){return this.subscribed===!1?TrackPublication.SubscriptionStatus.Unsubscribed:super.isSubscribed?TrackPublication.SubscriptionStatus.Subscribed:TrackPublication.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?TrackPublication.PermissionStatus.Allowed:TrackPublication.PermissionStatus.NotAllowed}get isSubscribed(){return this.subscribed===!1?!1:super.isSubscribed}get isDesired(){return this.subscribed!==!1}get isEnabled(){return!this.disabled}setEnabled(s){!this.isManualOperationAllowed()||this.disabled===!s||(this.disabled=!s,this.emitTrackUpdate())}setVideoQuality(s){!this.isManualOperationAllowed()||this.currentVideoQuality===s||(this.currentVideoQuality=s,this.videoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(s){var d,c;!this.isManualOperationAllowed()||((d=this.videoDimensions)===null||d===void 0?void 0:d.width)===s.width&&((c=this.videoDimensions)===null||c===void 0?void 0:c.height)===s.height||(this.track instanceof RemoteVideoTrack&&(this.videoDimensions=s),this.currentVideoQuality=void 0,this.emitTrackUpdate())}setVideoFPS(s){!this.isManualOperationAllowed()||this.track instanceof RemoteVideoTrack&&this.fps!==s&&(this.fps=s,this.emitTrackUpdate())}get videoQuality(){return this.currentVideoQuality}setTrack(s){const d=this.subscriptionStatus,c=this.permissionStatus,l=this.track;l!==s&&(l&&(l.off(TrackEvent.VideoDimensionsChanged,this.handleVideoDimensionsChange),l.off(TrackEvent.VisibilityChanged,this.handleVisibilityChange),l.off(TrackEvent.Ended,this.handleEnded),l.detach(),this.emit(TrackEvent.Unsubscribed,l)),super.setTrack(s),s&&(s.sid=this.trackSid,s.on(TrackEvent.VideoDimensionsChanged,this.handleVideoDimensionsChange),s.on(TrackEvent.VisibilityChanged,this.handleVisibilityChange),s.on(TrackEvent.Ended,this.handleEnded),this.emit(TrackEvent.Subscribed,s)),this.emitPermissionUpdateIfChanged(c),this.emitSubscriptionUpdateIfChanged(d))}setAllowed(s){const d=this.subscriptionStatus,c=this.permissionStatus;this.allowed=s,this.emitPermissionUpdateIfChanged(c),this.emitSubscriptionUpdateIfChanged(d)}updateInfo(s){var d;super.updateInfo(s),this.metadataMuted=s.muted,(d=this.track)===null||d===void 0||d.setMuted(s.muted)}emitSubscriptionUpdateIfChanged(s){const d=this.subscriptionStatus;s!==d&&this.emit(TrackEvent.SubscriptionStatusChanged,d,s)}emitPermissionUpdateIfChanged(s){this.permissionStatus!==s&&this.emit(TrackEvent.SubscriptionPermissionChanged,this.permissionStatus,s)}isManualOperationAllowed(){return this.isAdaptiveStream?(livekitLogger.warn("adaptive stream is enabled, cannot change track settings",{trackSid:this.trackSid}),!1):this.isDesired?!0:(livekitLogger.warn("cannot update track settings when not subscribed",{trackSid:this.trackSid}),!1)}get isAdaptiveStream(){return this.track instanceof RemoteVideoTrack&&this.track.isAdaptiveStream}emitTrackUpdate(){const s=UpdateTrackSettings.fromPartial({trackSids:[this.trackSid],disabled:this.disabled,fps:this.fps});this.videoDimensions?(s.width=this.videoDimensions.width,s.height=this.videoDimensions.height):this.currentVideoQuality!==void 0?s.quality=this.currentVideoQuality:s.quality=VideoQuality.HIGH,this.emit(TrackEvent.UpdateSettings,s)}}class RemoteParticipant extends Participant{static fromParticipantInfo(s,d){return new RemoteParticipant(s,d.sid,d.identity,d.name,d.metadata)}constructor(s,d,c,l,p){super(d,c||"",l,p),this.signalClient=s,this.tracks=new Map,this.audioTracks=new Map,this.videoTracks=new Map}addTrackPublication(s){super.addTrackPublication(s),s.on(TrackEvent.UpdateSettings,d=>{livekitLogger.debug("send update settings",d),this.signalClient.sendUpdateTrackSettings(d)}),s.on(TrackEvent.UpdateSubscription,d=>{d.participantTracks.forEach(c=>{c.participantSid=this.sid}),this.signalClient.sendUpdateSubscription(d)}),s.on(TrackEvent.SubscriptionPermissionChanged,d=>{this.emit(ParticipantEvent.TrackSubscriptionPermissionChanged,s,d)}),s.on(TrackEvent.SubscriptionStatusChanged,d=>{this.emit(ParticipantEvent.TrackSubscriptionStatusChanged,s,d)}),s.on(TrackEvent.Subscribed,d=>{this.emit(ParticipantEvent.TrackSubscribed,d,s)}),s.on(TrackEvent.Unsubscribed,d=>{this.emit(ParticipantEvent.TrackUnsubscribed,d,s)})}getTrack(s){const d=super.getTrack(s);if(d)return d}getTrackByName(s){const d=super.getTrackByName(s);if(d)return d}setVolume(s){this.volume=s;const d=this.getTrack(Track.Source.Microphone);d&&d.track&&d.track.setVolume(s)}getVolume(){const s=this.getTrack(Track.Source.Microphone);return s&&s.track?s.track.getVolume():this.volume}addSubscribedMediaTrack(s,d,c,l,p,h){let v=this.getTrackPublication(d);if(v||d.startsWith("TR")||this.tracks.forEach(_=>{!v&&s.kind===_.kind.toString()&&(v=_)}),!v){if(h===0){livekitLogger.error("could not find published track",{participant:this.sid,trackSid:d}),this.emit(ParticipantEvent.TrackSubscriptionFailed,d);return}h===void 0&&(h=20),setTimeout(()=>{this.addSubscribedMediaTrack(s,d,c,l,p,h-1)},150);return}if(s.readyState==="ended"){livekitLogger.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",{participant:this.sid,trackSid:d}),this.emit(ParticipantEvent.TrackSubscriptionFailed,d);return}const S=s.kind==="video";let b;return S?b=new RemoteVideoTrack(s,d,l,p):b=new RemoteAudioTrack(s,d,l,this.audioContext,this.audioOutput),b.source=v.source,b.isMuted=v.isMuted,b.setMediaStream(c),b.start(),v.setTrack(b),this.volume!==void 0&&b instanceof RemoteAudioTrack&&b.source===Track.Source.Microphone&&b.setVolume(this.volume),v}get hasMetadata(){return!!this.participantInfo}getTrackPublication(s){return this.tracks.get(s)}updateInfo(s){super.updateInfo(s);const d=new Map,c=new Map;s.tracks.forEach(l=>{var p;let h=this.getTrackPublication(l.sid);if(h)h.updateInfo(l);else{const v=Track.kindFromProto(l.type);if(!v)return;h=new RemoteTrackPublication(v,l,(p=this.signalClient.connectOptions)===null||p===void 0?void 0:p.autoSubscribe),h.updateInfo(l),c.set(l.sid,h);const S=Array.from(this.tracks.values()).find(b=>b.source===(h==null?void 0:h.source));S&&h.source!==Track.Source.Unknown&&livekitLogger.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(h.source),{oldTrack:S,newTrack:h,participant:this,participantInfo:s}),this.addTrackPublication(h)}d.set(l.sid,h)}),this.tracks.forEach(l=>{d.has(l.trackSid)||(livekitLogger.trace("detected removed track on remote participant, unpublishing",{publication:l,participantSid:this.sid}),this.unpublishTrack(l.trackSid,!0))}),c.forEach(l=>{this.emit(ParticipantEvent.TrackPublished,l)})}unpublishTrack(s,d){const c=this.tracks.get(s);if(!c)return;switch(this.tracks.delete(s),c.kind){case Track.Kind.Audio:this.audioTracks.delete(s);break;case Track.Kind.Video:this.videoTracks.delete(s);break}const{track:l}=c;l&&(l.stop(),c.setTrack(void 0)),d&&this.emit(ParticipantEvent.TrackUnpublished,c)}setAudioContext(s){this.audioContext=s,this.audioTracks.forEach(d=>d.track instanceof RemoteAudioTrack&&d.track.setAudioContext(s))}async setAudioOutput(s){this.audioOutput=s;const d=[];this.audioTracks.forEach(c=>{var l;c.track instanceof RemoteAudioTrack&&d.push(c.track.setSinkId((l=s.deviceId)!==null&&l!==void 0?l:"default"))}),await Promise.all(d)}emit(s){for(var d=arguments.length,c=new Array(d>1?d-1:0),l=1;l<d;l++)c[l-1]=arguments[l];return livekitLogger.trace("participant event",{participant:this.sid,event:s,args:c}),super.emit(s,...c)}}class LocalParticipant extends Participant{constructor(s,d,c,l){super(s,d),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new Future)},this.handleReconnected=()=>{var p,h;(h=(p=this.reconnectFuture)===null||p===void 0?void 0:p.resolve)===null||h===void 0||h.call(p),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleDisconnected=()=>{var p,h;(h=(p=this.reconnectFuture)===null||p===void 0?void 0:p.reject)===null||h===void 0||h.call(p,"Got disconnected during publishing attempt"),this.reconnectFuture=void 0},this.updateTrackSubscriptionPermissions=()=>{livekitLogger.debug("updating track subscription permissions",{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions}),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map(p=>trackPermissionToProto(p)))},this.onTrackUnmuted=p=>{this.onTrackMuted(p,p.isUpstreamPaused)},this.onTrackMuted=(p,h)=>{if(h===void 0&&(h=!0),!p.sid){livekitLogger.error("could not update mute status for unpublished track",p);return}this.engine.updateMuteStatus(p.sid,h)},this.onTrackUpstreamPaused=p=>{livekitLogger.debug("upstream paused"),this.onTrackMuted(p,!0)},this.onTrackUpstreamResumed=p=>{livekitLogger.debug("upstream resumed"),this.onTrackMuted(p,p.isMuted)},this.handleSubscribedQualityUpdate=async p=>{var h,v;if(!(!((h=this.roomOptions)===null||h===void 0)&&h.dynacast))return;const S=this.videoTracks.get(p.trackSid);if(!S){livekitLogger.warn("received subscribed quality update for unknown track",{method:"handleSubscribedQualityUpdate",sid:p.trackSid});return}if(p.subscribedCodecs.length>0){if(!S.videoTrack)return;const w=await S.videoTrack.setPublishingCodecs(p.subscribedCodecs);var b=!1,_=!1,I;try{for(var T=_asyncIterator(w),k;b=!(k=await T.next()).done;b=!1){const P=k.value;isBackupCodec(P)&&(livekitLogger.debug("publish ".concat(P," for ").concat(S.videoTrack.sid)),await this.publishAdditionalCodecForTrack(S.videoTrack,P,S.options))}}catch(P){_=!0,I=P}finally{try{b&&T.return!=null&&await T.return()}finally{if(_)throw I}}}else p.subscribedQualities.length>0&&await((v=S.videoTrack)===null||v===void 0?void 0:v.setPublishingLayers(p.subscribedQualities))},this.handleLocalTrackUnpublished=p=>{const h=this.tracks.get(p.trackSid);if(!h){livekitLogger.warn("received unpublished event for unknown track",{method:"handleLocalTrackUnpublished",trackSid:p.trackSid});return}this.unpublishTrack(h.track)},this.handleTrackEnded=async p=>{if(p.source===Track.Source.ScreenShare||p.source===Track.Source.ScreenShareAudio)livekitLogger.debug("unpublishing local track due to TrackEnded",{track:p.sid}),this.unpublishTrack(p);else if(p.isUserProvided)await p.mute();else if(p instanceof LocalAudioTrack||p instanceof LocalVideoTrack)try{if(isWeb())try{const h=await(navigator==null?void 0:navigator.permissions.query({name:p.source===Track.Source.Camera?"camera":"microphone"}));if(h&&h.state==="denied")throw livekitLogger.warn("user has revoked access to ".concat(p.source)),h.onchange=()=>{h.state!=="denied"&&(p.isMuted||p.restartTrack(),h.onchange=null)},new Error("GetUserMedia Permission denied")}catch{}p.isMuted||(livekitLogger.debug("track ended, attempting to use a different device"),await p.restartTrack())}catch{livekitLogger.warn("could not restart track, muting instead"),await p.mute()}},this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map,this.engine=c,this.roomOptions=l,this.setupEngine(c)}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}getTrack(s){const d=super.getTrack(s);if(d)return d}getTrackByName(s){const d=super.getTrackByName(s);if(d)return d}setupEngine(s){this.engine=s,this.engine.client.onRemoteMuteChanged=(d,c)=>{const l=this.tracks.get(d);!l||!l.track||(c?l.mute():l.unmute())},this.engine.client.onSubscribedQualityUpdate=this.handleSubscribedQualityUpdate,this.engine.client.onLocalTrackUnpublished=this.handleLocalTrackUnpublished,this.engine.on(EngineEvent.Connected,this.handleReconnected).on(EngineEvent.Restarted,this.handleReconnected).on(EngineEvent.Resumed,this.handleReconnected).on(EngineEvent.Restarting,this.handleReconnecting).on(EngineEvent.Resuming,this.handleReconnecting).on(EngineEvent.Disconnected,this.handleDisconnected)}setCameraEnabled(s,d,c){return this.setTrackEnabled(Track.Source.Camera,s,d,c)}setMicrophoneEnabled(s,d,c){return this.setTrackEnabled(Track.Source.Microphone,s,d,c)}setScreenShareEnabled(s,d,c){return this.setTrackEnabled(Track.Source.ScreenShare,s,d,c)}async setTrackEnabled(s,d,c,l){var p,h;livekitLogger.debug("setTrackEnabled",{source:s,enabled:d});let v=this.getTrack(s);if(d)if(v)await v.unmute();else{let S;if(this.pendingPublishing.has(s)){livekitLogger.info("skipping duplicate published source",{source:s});return}this.pendingPublishing.add(s);try{switch(s){case Track.Source.Camera:S=await this.createTracks({video:(p=c)!==null&&p!==void 0?p:!0});break;case Track.Source.Microphone:S=await this.createTracks({audio:(h=c)!==null&&h!==void 0?h:!0});break;case Track.Source.ScreenShare:S=await this.createScreenTracks(_objectSpread2({},c));break;default:throw new TrackInvalidError(s)}const b=[];for(const I of S)livekitLogger.info("publishing track",{localTrack:I}),b.push(this.publishTrack(I,l));[v]=await Promise.all(b)}catch(b){throw b instanceof Error&&!(b instanceof TrackInvalidError)&&this.emit(ParticipantEvent.MediaDevicesError,b),b}finally{this.pendingPublishing.delete(s)}}else if(v&&v.track)if(s===Track.Source.ScreenShare){v=await this.unpublishTrack(v.track);const S=this.getTrack(Track.Source.ScreenShareAudio);S&&S.track&&this.unpublishTrack(S.track)}else await v.mute();return v}async enableCameraAndMicrophone(){if(!(this.pendingPublishing.has(Track.Source.Camera)||this.pendingPublishing.has(Track.Source.Microphone))){this.pendingPublishing.add(Track.Source.Camera),this.pendingPublishing.add(Track.Source.Microphone);try{const s=await this.createTracks({audio:!0,video:!0});await Promise.all(s.map(d=>this.publishTrack(d)))}finally{this.pendingPublishing.delete(Track.Source.Camera),this.pendingPublishing.delete(Track.Source.Microphone)}}}async createTracks(s){var d,c;const l=mergeDefaultOptions(s,(d=this.roomOptions)===null||d===void 0?void 0:d.audioCaptureDefaults,(c=this.roomOptions)===null||c===void 0?void 0:c.videoCaptureDefaults),p=constraintsForOptions(l);let h;try{h=await navigator.mediaDevices.getUserMedia(p)}catch(v){throw v instanceof Error&&(p.audio&&(this.microphoneError=v),p.video&&(this.cameraError=v)),v}return p.audio&&(this.microphoneError=void 0),p.video&&(this.cameraError=void 0),h.getTracks().map(v=>{const S=v.kind==="audio";S?s.audio:s.video;let b;const _=S?p.audio:p.video;typeof _!="boolean"&&(b=_);const I=mediaTrackToLocalTrack(v,b);return I.kind===Track.Kind.Video?I.source=Track.Source.Camera:I.kind===Track.Kind.Audio&&(I.source=Track.Source.Microphone),I.mediaStream=h,I})}async createScreenTracks(s){var d;s===void 0&&(s={}),s.resolution===void 0&&(s.resolution=ScreenSharePresets.h1080fps15.resolution);let c=!0;if(s.resolution&&(isSafari()?c={width:{max:s.resolution.width},height:{max:s.resolution.height},frameRate:s.resolution.frameRate}:c={width:{ideal:s.resolution.width},height:{ideal:s.resolution.height},frameRate:s.resolution.frameRate}),navigator.mediaDevices.getDisplayMedia===void 0)throw new DeviceUnsupportedError("getDisplayMedia not supported");const l=await navigator.mediaDevices.getDisplayMedia({audio:(d=s.audio)!==null&&d!==void 0?d:!1,video:c,controller:s.controller,selfBrowserSurface:s.selfBrowserSurface,surfaceSwitching:s.surfaceSwitching,systemAudio:s.systemAudio}),p=l.getVideoTracks();if(p.length===0)throw new TrackInvalidError("no video track found");const h=new LocalVideoTrack(p[0],void 0,!1);h.source=Track.Source.ScreenShare;const v=[h];if(l.getAudioTracks().length>0){const S=new LocalAudioTrack(l.getAudioTracks()[0],void 0,!1);S.source=Track.Source.ScreenShareAudio,v.push(S)}return v}async publishTrack(s,d){var c,l,p;if(await((c=this.reconnectFuture)===null||c===void 0?void 0:c.promise),s instanceof LocalTrack&&this.pendingPublishPromises.has(s)&&await this.pendingPublishPromises.get(s),s instanceof MediaStreamTrack)switch(s.kind){case"audio":s=new LocalAudioTrack(s,void 0,!0);break;case"video":s=new LocalVideoTrack(s,void 0,!0);break;default:throw new TrackInvalidError("unsupported MediaStreamTrack kind ".concat(s.kind))}let h;if(this.tracks.forEach(_=>{!_.track||_.track===s&&(h=_)}),h)return livekitLogger.warn("track has already been published, skipping"),h;const v=(d==null?void 0:d.forceStereo)||"channelCount"in s.mediaStreamTrack.getSettings()&&s.mediaStreamTrack.getSettings().channelCount===2||s.mediaStreamTrack.getConstraints().channelCount===2;v&&(d||(d={}),d.dtx===void 0&&livekitLogger.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work."),d.red===void 0&&livekitLogger.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),(l=d.dtx)!==null&&l!==void 0||(d.dtx=!1),(p=d.red)!==null&&p!==void 0||(d.red=!1));const S=_objectSpread2(_objectSpread2({},this.roomOptions.publishDefaults),d);S.source&&(s.source=S.source);const b=this.publish(s,S,d,v);this.pendingPublishPromises.set(s,b);try{return await b}catch(_){throw _}finally{this.pendingPublishPromises.delete(s)}}async publish(s,d,c,l){var p,h,v,S;const b=Array.from(this.tracks.values()).find(P=>s instanceof LocalTrack&&P.source===s.source);if(b&&s.source!==Track.Source.Unknown)try{throw Error("publishing a second track with the same source: ".concat(s.source))}catch(P){P instanceof Error&&livekitLogger.warn(P.message,{oldTrack:b,newTrack:s,trace:P.stack})}d.stopMicTrackOnMute&&s instanceof LocalAudioTrack&&(s.stopOnMute=!0),s.source===Track.Source.ScreenShare&&isFireFox()&&(d.simulcast=!1),d.videoCodec==="av1"&&!supportsAV1()&&(d.videoCodec=void 0),s.on(TrackEvent.Muted,this.onTrackMuted),s.on(TrackEvent.Unmuted,this.onTrackUnmuted),s.on(TrackEvent.Ended,this.handleTrackEnded),s.on(TrackEvent.UpstreamPaused,this.onTrackUpstreamPaused),s.on(TrackEvent.UpstreamResumed,this.onTrackUpstreamResumed);const _=AddTrackRequest.fromPartial({cid:s.mediaStreamTrack.id,name:c==null?void 0:c.name,type:Track.kindToProto(s.kind),muted:s.isMuted,source:Track.sourceToProto(s.source),disableDtx:!(!((p=d.dtx)!==null&&p!==void 0)||p),stereo:l,disableRed:!(!((h=d.red)!==null&&h!==void 0)||h)});let I,T;if(s.kind===Track.Kind.Video){let P={width:0,height:0};try{P=await s.waitForDimensions()}catch{livekitLogger.error("could not determine track dimensions")}if(_.width=P.width,_.height=P.height,s instanceof LocalVideoTrack&&((d==null?void 0:d.videoCodec)==="av1"&&(d.scalabilityMode=(v=d.scalabilityMode)!==null&&v!==void 0?v:"L3T3"),d.videoCodec&&d.backupCodec&&d.videoCodec!==d.backupCodec.codec)){const $=_objectSpread2({},d);$.simulcast=!0,T=computeTrackBackupEncodings(s,d.backupCodec.codec,$),_.simulcastCodecs=[{codec:d.videoCodec,cid:s.mediaStreamTrack.id,enableSimulcastLayers:!0},{codec:d.backupCodec.codec,cid:"",enableSimulcastLayers:!0}]}I=computeVideoEncodings(s.source===Track.Source.ScreenShare,P.width,P.height,d),_.layers=videoLayersFromEncodings(_.width,_.height,T!=null?T:I)}else s.kind===Track.Kind.Audio&&d.audioBitrate&&(I=[{maxBitrate:d.audioBitrate}]);if(!this.engine||this.engine.isClosed)throw new UnexpectedConnectionState("cannot publish track when not connected");const k=await this.engine.addTrack(_),w=new LocalTrackPublication(s.kind,k,s);if(w.options=d,s.sid=k.sid,!this.engine.publisher)throw new UnexpectedConnectionState("publisher is closed");return livekitLogger.debug("publishing ".concat(s.kind," with encodings"),{encodings:I,trackInfo:k}),s.sender=await this.engine.createSender(s,d,I),s.codec==="av1"&&I&&((S=I[0])===null||S===void 0?void 0:S.maxBitrate)&&this.engine.publisher.setTrackCodecBitrate(_.cid,s.codec,I[0].maxBitrate/1e3),this.engine.negotiate(),s instanceof LocalVideoTrack?s.startMonitor(this.engine.client):s instanceof LocalAudioTrack&&s.startMonitor(),this.addTrackPublication(w),this.emit(ParticipantEvent.LocalTrackPublished,w),w}get isLocal(){return!0}async publishAdditionalCodecForTrack(s,d,c){var l;let p;if(this.tracks.forEach(I=>{!I.track||I.track===s&&(p=I)}),!p)throw new TrackInvalidError("track is not published");if(!(s instanceof LocalVideoTrack))throw new TrackInvalidError("track is not a video track");const h=_objectSpread2(_objectSpread2({},(l=this.roomOptions)===null||l===void 0?void 0:l.publishDefaults),c),v=computeTrackBackupEncodings(s,d,h);if(!v){livekitLogger.info("backup codec has been disabled, ignoring request to add additional codec for track");return}const S=s.addSimulcastTrack(d,v),b=AddTrackRequest.fromPartial({cid:S.mediaStreamTrack.id,type:Track.kindToProto(s.kind),muted:s.isMuted,source:Track.sourceToProto(s.source),sid:s.sid,simulcastCodecs:[{codec:h.videoCodec,cid:S.mediaStreamTrack.id,enableSimulcastLayers:h.simulcast}]});if(b.layers=videoLayersFromEncodings(b.width,b.height,v),!this.engine||this.engine.isClosed)throw new UnexpectedConnectionState("cannot publish track when not connected");const _=await this.engine.addTrack(b);await this.engine.createSimulcastSender(s,S,h,v),this.engine.negotiate(),livekitLogger.debug("published ".concat(d," for track ").concat(s.sid),{encodings:v,trackInfo:_})}async unpublishTrack(s,d){var c,l;const p=this.getPublicationForTrack(s);if(livekitLogger.debug("unpublishing track",{track:s,method:"unpublishTrack"}),!p||!p.track){livekitLogger.warn("track was not unpublished because no publication was found",{track:s,method:"unpublishTrack"});return}s=p.track,s.off(TrackEvent.Muted,this.onTrackMuted),s.off(TrackEvent.Unmuted,this.onTrackUnmuted),s.off(TrackEvent.Ended,this.handleTrackEnded),s.off(TrackEvent.UpstreamPaused,this.onTrackUpstreamPaused),s.off(TrackEvent.UpstreamResumed,this.onTrackUpstreamResumed),d===void 0&&(d=(l=(c=this.roomOptions)===null||c===void 0?void 0:c.stopLocalTrackOnUnpublish)!==null&&l!==void 0?l:!0),d&&s.stop();let h=!1;const v=s.sender;if(s.sender=void 0,this.engine.publisher&&this.engine.publisher.pc.connectionState!=="closed"&&v)try{if(this.engine.removeTrack(v)&&(h=!0),s instanceof LocalVideoTrack){for(const[,S]of s.simulcastCodecs)S.sender&&(this.engine.removeTrack(S.sender)&&(h=!0),S.sender=void 0);s.simulcastCodecs.clear()}}catch(S){livekitLogger.warn("failed to unpublish track",{error:S,method:"unpublishTrack"})}switch(this.tracks.delete(p.trackSid),p.kind){case Track.Kind.Audio:this.audioTracks.delete(p.trackSid);break;case Track.Kind.Video:this.videoTracks.delete(p.trackSid);break}return this.emit(ParticipantEvent.LocalTrackUnpublished,p),p.setTrack(void 0),h&&await this.engine.negotiate(),p}async unpublishTracks(s){return(await Promise.all(s.map(c=>this.unpublishTrack(c)))).filter(c=>c instanceof LocalTrackPublication)}async republishAllTracks(s){const d=[];this.tracks.forEach(c=>{c.track&&(s&&(c.options=_objectSpread2(_objectSpread2({},c.options),s)),d.push(c))}),await Promise.all(d.map(async c=>{const l=c.track;await this.unpublishTrack(l,!1),await this.publishTrack(l,c.options)}))}async publishData(s,d){let c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const l=Array.isArray(c)?c:c==null?void 0:c.destination,p=[],h=Array.isArray(c)?void 0:c.topic;l!==void 0&&l.forEach(S=>{S instanceof RemoteParticipant?p.push(S.sid):p.push(S)});const v={kind:d,value:{$case:"user",user:{participantSid:this.sid,payload:s,destinationSids:p,topic:h}}};await this.engine.sendDataPacket(v,d)}setTrackSubscriptionPermissions(s){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.participantTrackPermissions=d,this.allParticipantsAllowedToSubscribe=s,this.engine.client.isConnected&&this.updateTrackSubscriptionPermissions()}updateInfo(s){s.sid===this.sid&&(super.updateInfo(s),s.tracks.forEach(d=>{var c,l;const p=this.tracks.get(d.sid);if(p){const h=p.isMuted||((l=(c=p.track)===null||c===void 0?void 0:c.isUpstreamPaused)!==null&&l!==void 0?l:!1);h!==d.muted&&(livekitLogger.debug("updating server mute state after reconcile",{sid:d.sid,muted:h}),this.engine.client.sendMuteTrack(d.sid,h))}}))}getPublicationForTrack(s){let d;return this.tracks.forEach(c=>{const l=c.track;!l||(s instanceof MediaStreamTrack?(l instanceof LocalAudioTrack||l instanceof LocalVideoTrack)&&l.mediaStreamTrack===s&&(d=c):s===l&&(d=c))}),d}publishedTracksInfo(){const s=[];return this.tracks.forEach(d=>{d.track!==void 0&&s.push({cid:d.track.mediaStreamID,track:d.trackInfo})}),s}dataChannelsInfo(){const s=[],d=(c,l)=>{(c==null?void 0:c.id)!==void 0&&c.id!==null&&s.push({label:c.label,id:c.id,target:l})};return d(this.engine.dataChannelForKind(DataPacket_Kind.LOSSY),SignalTarget.PUBLISHER),d(this.engine.dataChannelForKind(DataPacket_Kind.RELIABLE),SignalTarget.PUBLISHER),d(this.engine.dataChannelForKind(DataPacket_Kind.LOSSY,!0),SignalTarget.SUBSCRIBER),d(this.engine.dataChannelForKind(DataPacket_Kind.RELIABLE,!0),SignalTarget.SUBSCRIBER),s}}const passThroughQueueSignals=["syncState","trickle","offer","answer","simulate","leave"];function canPassThroughQueue(a){const s=passThroughQueueSignals.includes(a.$case);return livekitLogger.trace("request allowed to bypass queue:",{canPass:s,req:a}),s}class SignalClient{constructor(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.rtt=0,this.isConnected=!1,this.isReconnecting=!1,this.useJSON=s,this.requestQueue=new Queue,this.queuedRequests=[],this.closingLock=new Mutex}async join(s,d,c,l){return this.isConnected=!1,this.options=c,await this.connect(s,d,c,l)}async reconnect(s,d,c,l){if(!this.options){livekitLogger.warn("attempted to reconnect without signal options being set, ignoring");return}return this.isReconnecting=!0,this.clearPingInterval(),await this.connect(s,d,_objectSpread2(_objectSpread2({},this.options),{},{reconnect:!0,sid:c,reconnectReason:l}))}connect(s,d,c,l){this.connectOptions=c,s.startsWith("http")&&(s=s.replace("http","ws")),s=s.replace(/\/$/,""),s+="/rtc";const p=getClientInfo(),h=createConnectionParams(d,p,c);return new Promise(async(v,S)=>{const b=async()=>{await this.close(),S(new ConnectionError("room connection has been cancelled"))};l!=null&&l.aborted&&b(),l==null||l.addEventListener("abort",b),livekitLogger.debug("connecting to ".concat(s+h)),this.ws&&await this.close(),this.ws=new WebSocket(s+h),this.ws.binaryType="arraybuffer",this.ws.onerror=async _=>{if(!this.isConnected){try{const I=await fetch("http".concat(s.substring(2),"/validate").concat(h));if(I.ok)S(new ConnectionError("Internal error",2,I.status));else{const T=await I.text();S(new ConnectionError(T,0,I.status))}}catch{S(new ConnectionError("server was not reachable",1))}return}this.handleWSError(_)},this.ws.onmessage=async _=>{var I,T,k,w;let P;if(typeof _.data=="string"){const $=JSON.parse(_.data);P=SignalResponse.fromJSON($)}else if(_.data instanceof ArrayBuffer)P=SignalResponse.decode(new Uint8Array(_.data));else{livekitLogger.error("could not decode websocket message: ".concat(typeof _.data));return}if(!this.isConnected){let $=!1;if(((I=P.message)===null||I===void 0?void 0:I.$case)==="join"?(this.isConnected=!0,l==null||l.removeEventListener("abort",b),this.pingTimeoutDuration=P.message.join.pingTimeout,this.pingIntervalDuration=P.message.join.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&(livekitLogger.debug("ping config",{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration}),this.startPingInterval()),v(P.message.join)):c.reconnect?(this.isConnected=!0,l==null||l.removeEventListener("abort",b),this.startPingInterval(),((T=P.message)===null||T===void 0?void 0:T.$case)==="reconnect"?v((k=P.message)===null||k===void 0?void 0:k.reconnect):(v(),$=!0)):c.reconnect||S(new ConnectionError("did not receive join response, got ".concat((w=P.message)===null||w===void 0?void 0:w.$case," instead"))),!$)return}this.signalLatency&&await sleep(this.signalLatency),this.handleSignalResponse(P)},this.ws.onclose=_=>{!this.isConnected||(livekitLogger.debug("websocket connection closed: ".concat(_.reason)),this.isConnected=!1,this.onClose&&this.onClose(_.reason),this.ws=void 0)}})}async close(){const s=await this.closingLock.lock();try{if(this.isConnected=!1,this.ws){this.ws.onclose=null,this.ws.onmessage=null,this.ws.onopen=null;const d=new Promise(c=>{this.ws?this.ws.onclose=c:c(!0)});this.ws.close(),await Promise.race([d,sleep(250)])}this.ws=void 0,this.clearPingInterval()}finally{s()}}sendOffer(s){livekitLogger.debug("sending offer",s),this.sendRequest({$case:"offer",offer:toProtoSessionDescription(s)})}sendAnswer(s){livekitLogger.debug("sending answer"),this.sendRequest({$case:"answer",answer:toProtoSessionDescription(s)})}sendIceCandidate(s,d){livekitLogger.trace("sending ice candidate",s),this.sendRequest({$case:"trickle",trickle:{candidateInit:JSON.stringify(s),target:d}})}sendMuteTrack(s,d){this.sendRequest({$case:"mute",mute:{sid:s,muted:d}})}sendAddTrack(s){this.sendRequest({$case:"addTrack",addTrack:AddTrackRequest.fromPartial(s)})}sendUpdateTrackSettings(s){this.sendRequest({$case:"trackSetting",trackSetting:s})}sendUpdateSubscription(s){this.sendRequest({$case:"subscription",subscription:s})}sendSyncState(s){this.sendRequest({$case:"syncState",syncState:s})}sendUpdateVideoLayers(s,d){this.sendRequest({$case:"updateLayers",updateLayers:{trackSid:s,layers:d}})}sendUpdateSubscriptionPermissions(s,d){this.sendRequest({$case:"subscriptionPermission",subscriptionPermission:{allParticipants:s,trackPermissions:d}})}sendSimulateScenario(s){this.sendRequest({$case:"simulate",simulate:s})}sendPing(){this.sendRequest({$case:"ping",ping:Date.now()}),this.sendRequest({$case:"pingReq",pingReq:{timestamp:Date.now(),rtt:this.rtt}})}async sendLeave(){await this.sendRequest({$case:"leave",leave:{canReconnect:!1,reason:DisconnectReason.CLIENT_INITIATED}})}async sendRequest(s){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!d&&!canPassThroughQueue(s)&&this.isReconnecting){this.queuedRequests.push(async()=>{await this.sendRequest(s,!0)});return}if(d||await this.requestQueue.flush(),this.signalLatency&&await sleep(this.signalLatency),!this.ws||this.ws.readyState!==this.ws.OPEN){livekitLogger.error("cannot send signal request before connected, type: ".concat(s==null?void 0:s.$case));return}const l={message:s};try{this.useJSON?this.ws.send(JSON.stringify(SignalRequest.toJSON(l))):this.ws.send(SignalRequest.encode(l).finish())}catch(p){livekitLogger.error("error sending signal message",{error:p})}}handleSignalResponse(s){var d,c;const l=s.message;if(l==null){livekitLogger.debug("received unsupported message");return}if(l.$case==="answer"){const p=fromProtoSessionDescription(l.answer);this.onAnswer&&this.onAnswer(p)}else if(l.$case==="offer"){const p=fromProtoSessionDescription(l.offer);this.onOffer&&this.onOffer(p)}else if(l.$case==="trickle"){const p=JSON.parse(l.trickle.candidateInit);this.onTrickle&&this.onTrickle(p,l.trickle.target)}else l.$case==="update"?this.onParticipantUpdate&&this.onParticipantUpdate((d=l.update.participants)!==null&&d!==void 0?d:[]):l.$case==="trackPublished"?this.onLocalTrackPublished&&this.onLocalTrackPublished(l.trackPublished):l.$case==="speakersChanged"?this.onSpeakersChanged&&this.onSpeakersChanged((c=l.speakersChanged.speakers)!==null&&c!==void 0?c:[]):l.$case==="leave"?this.onLeave&&this.onLeave(l.leave):l.$case==="mute"?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(l.mute.sid,l.mute.muted):l.$case==="roomUpdate"?this.onRoomUpdate&&l.roomUpdate.room&&this.onRoomUpdate(l.roomUpdate.room):l.$case==="connectionQuality"?this.onConnectionQuality&&this.onConnectionQuality(l.connectionQuality):l.$case==="streamStateUpdate"?this.onStreamStateUpdate&&this.onStreamStateUpdate(l.streamStateUpdate):l.$case==="subscribedQualityUpdate"?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(l.subscribedQualityUpdate):l.$case==="subscriptionPermissionUpdate"?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(l.subscriptionPermissionUpdate):l.$case==="refreshToken"?this.onTokenRefresh&&this.onTokenRefresh(l.refreshToken):l.$case==="trackUnpublished"?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(l.trackUnpublished):l.$case==="pong"?this.resetPingTimeout():l.$case==="pongResp"?(this.rtt=Date.now()-l.pongResp.lastPingTimestamp,this.resetPingTimeout()):livekitLogger.debug("unsupported message",l)}setReconnected(){for(;this.queuedRequests.length>0;){const s=this.queuedRequests.shift();s&&this.requestQueue.run(s)}this.isReconnecting=!1}handleWSError(s){livekitLogger.error("websocket error",s)}resetPingTimeout(){if(this.clearPingTimeout(),!this.pingTimeoutDuration){livekitLogger.warn("ping timeout duration not set");return}this.pingTimeout=CriticalTimers.setTimeout(()=>{livekitLogger.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-this.pingTimeoutDuration*1e3).toUTCString())),this.onClose&&this.onClose("ping timeout")},this.pingTimeoutDuration*1e3)}clearPingTimeout(){this.pingTimeout&&CriticalTimers.clearTimeout(this.pingTimeout)}startPingInterval(){if(this.clearPingInterval(),this.resetPingTimeout(),!this.pingIntervalDuration){livekitLogger.warn("ping interval duration not set");return}livekitLogger.debug("start ping interval"),this.pingInterval=CriticalTimers.setInterval(()=>{this.sendPing()},this.pingIntervalDuration*1e3)}clearPingInterval(){livekitLogger.debug("clearing ping interval"),this.clearPingTimeout(),this.pingInterval&&CriticalTimers.clearInterval(this.pingInterval)}}function fromProtoSessionDescription(a){const s={type:"offer",sdp:a.sdp};switch(a.type){case"answer":case"offer":case"pranswer":case"rollback":s.type=a.type;break}return s}function toProtoSessionDescription(a){return{sdp:a.sdp,type:a.type}}function createConnectionParams(a,s,d){var c;const l=new URLSearchParams;return l.set("access_token",a),d.reconnect&&(l.set("reconnect","1"),d.sid&&l.set("sid",d.sid)),l.set("auto_subscribe",d.autoSubscribe?"1":"0"),l.set("sdk","js"),l.set("version",s.version),l.set("protocol",s.protocol.toString()),s.deviceModel&&l.set("device_model",s.deviceModel),s.os&&l.set("os",s.os),s.osVersion&&l.set("os_version",s.osVersion),s.browser&&l.set("browser",s.browser),s.browserVersion&&l.set("browser_version",s.browserVersion),d.publishOnly!==void 0&&l.set("publish",d.publishOnly),d.adaptiveStream&&l.set("adaptive_stream","1"),d.reconnectReason&&l.set("reconnect_reason",d.reconnectReason.toString()),!((c=navigator.connection)===null||c===void 0)&&c.type&&l.set("network",navigator.connection.type),"?".concat(l.toString())}const publishDefaults={audioBitrate:AudioPresets.music.maxBitrate,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:ScreenSharePresets.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:"vp8",backupCodec:{codec:"vp8",encoding:VideoPresets.h540.encoding}},audioDefaults={autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0},videoDefaults={resolution:VideoPresets.h720.resolution},roomOptionDefaults={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new DefaultReconnectPolicy,expWebAudioMix:!1},roomConnectOptionDefaults={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3};var parser$1={},grammarExports={},grammar$2={get exports(){return grammarExports},set exports(a){grammarExports=a}},grammar$1=grammar$2.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(a){return a.encoding?"rtpmap:%d %s/%s/%s":a.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(a){return a.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(a){return a.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(a){return"extmap:%d"+(a.direction?"/%s":"%v")+(a["encrypt-uri"]?" %s":"%v")+" %s"+(a.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(a){return a.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(a){var s="candidate:%s %d %s %d %s %d typ %s";return s+=a.raddr!=null?" raddr %s rport %d":"%v%v",s+=a.tcptype!=null?" tcptype %s":"%v",a.generation!=null&&(s+=" generation %d"),s+=a["network-id"]!=null?" network-id %d":"%v",s+=a["network-cost"]!=null?" network-cost %d":"%v",s}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(a){var s="ssrc:%d";return a.attribute!=null&&(s+=" %s",a.value!=null&&(s+=":%s")),s}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(a){return a.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(a){return a.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(a){return"imageattr:%s %s %s"+(a.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(a){return"simulcast:%s %s"+(a.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(a){return"ts-refclk:%s"+(a.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(a){var s="mediaclk:";return s+=a.id!=null?"id=%s %s":"%v%s",s+=a.mediaClockValue!=null?"=%s":"",s+=a.rateNumerator!=null?" rate=%s":"",s+=a.rateDenominator!=null?"/%s":"",s}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(grammar$1).forEach(function(a){var s=grammar$1[a];s.forEach(function(d){d.reg||(d.reg=/(.*)/),d.format||(d.format="%s")})}),function(a){var s=function(v){return String(Number(v))===v?Number(v):v},d=function(v,S,b,_){if(_&&!b)S[_]=s(v[1]);else for(var I=0;I<b.length;I+=1)v[I+1]!=null&&(S[b[I]]=s(v[I+1]))},c=function(v,S,b){var _=v.name&&v.names;v.push&&!S[v.push]?S[v.push]=[]:_&&!S[v.name]&&(S[v.name]={});var I=v.push?{}:_?S[v.name]:S;d(b.match(v.reg),I,v.names,v.name),v.push&&S[v.push].push(I)},l=grammarExports,p=RegExp.prototype.test.bind(/^([a-z])=(.*)/);a.parse=function(v){var S={},b=[],_=S;return v.split(/(\r\n|\r|\n)/).filter(p).forEach(function(I){var T=I[0],k=I.slice(2);T==="m"&&(b.push({rtp:[],fmtp:[]}),_=b[b.length-1]);for(var w=0;w<(l[T]||[]).length;w+=1){var P=l[T][w];if(P.reg.test(k))return c(P,_,k)}}),S.media=b,S};var h=function(v,S){var b=S.split(/=(.+)/,2);return b.length===2?v[b[0]]=s(b[1]):b.length===1&&S.length>1&&(v[b[0]]=void 0),v};a.parseParams=function(v){return v.split(/;\s?/).reduce(h,{})},a.parseFmtpConfig=a.parseParams,a.parsePayloads=function(v){return v.toString().split(" ").map(Number)},a.parseRemoteCandidates=function(v){for(var S=[],b=v.split(" ").map(s),_=0;_<b.length;_+=3)S.push({component:b[_],ip:b[_+1],port:b[_+2]});return S},a.parseImageAttributes=function(v){return v.split(" ").map(function(S){return S.substring(1,S.length-1).split(",").reduce(h,{})})},a.parseSimulcastStreamList=function(v){return v.split(";").map(function(S){return S.split(",").map(function(b){var _,I=!1;return b[0]!=="~"?_=s(b):(_=s(b.substring(1,b.length)),I=!0),{scid:_,paused:I}})})}}(parser$1);var grammar=grammarExports,formatRegExp=/%[sdv%]/g,format=function(a){var s=1,d=arguments,c=d.length;return a.replace(formatRegExp,function(l){if(s>=c)return l;var p=d[s];switch(s+=1,l){case"%%":return"%";case"%s":return String(p);case"%d":return Number(p);case"%v":return""}})},makeLine=function(a,s,d){var c=s.format instanceof Function?s.format(s.push?d:d[s.name]):s.format,l=[a+"="+c];if(s.names)for(var p=0;p<s.names.length;p+=1){var h=s.names[p];s.name?l.push(d[s.name][h]):l.push(d[s.names[p]])}else l.push(d[s.name]);return format.apply(null,l)},defaultOuterOrder=["v","o","s","i","u","e","p","c","b","t","r","z","a"],defaultInnerOrder=["i","c","b","a"],writer$1=function(a,s){s=s||{},a.version==null&&(a.version=0),a.name==null&&(a.name=" "),a.media.forEach(function(p){p.payloads==null&&(p.payloads="")});var d=s.outerOrder||defaultOuterOrder,c=s.innerOrder||defaultInnerOrder,l=[];return d.forEach(function(p){grammar[p].forEach(function(h){h.name in a&&a[h.name]!=null?l.push(makeLine(p,h,a)):h.push in a&&a[h.push]!=null&&a[h.push].forEach(function(v){l.push(makeLine(p,h,v))})})}),a.media.forEach(function(p){l.push(makeLine("m",grammar.m[0],p)),c.forEach(function(h){grammar[h].forEach(function(v){v.name in p&&p[v.name]!=null?l.push(makeLine(h,v,p)):v.push in p&&p[v.push]!=null&&p[v.push].forEach(function(S){l.push(makeLine(h,v,S))})})})}),l.join(`\r
`)+`\r
`},parser=parser$1,writer=writer$1,write=writer,parse$1=parser.parse;parser.parseParams,parser.parseFmtpConfig,parser.parsePayloads,parser.parseRemoteCandidates,parser.parseImageAttributes,parser.parseSimulcastStreamList;const PCEvents={NegotiationStarted:"negotiationStarted",NegotiationComplete:"negotiationComplete"};class PCTransport extends eventsExports{constructor(s){super(),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=r(d=>{this.emit(PCEvents.NegotiationStarted);try{this.createAndSendOffer()}catch(c){if(d)d(c);else throw c}},100),this.pc=new RTCPeerConnection(s)}get isICEConnected(){return this.pc.iceConnectionState==="connected"||this.pc.iceConnectionState==="completed"}async addIceCandidate(s){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(s);this.pendingCandidates.push(s)}async setRemoteDescription(s){if(s.type==="offer"){let{stereoMids:d,nackMids:c}=extractStereoAndNackAudioFromOffer(s);this.remoteStereoMids=d,this.remoteNackMids=c}await this.pc.setRemoteDescription(s),this.pendingCandidates.forEach(d=>{this.pc.addIceCandidate(d)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate?(this.renegotiate=!1,this.createAndSendOffer()):s.type==="answer"&&this.emit(PCEvents.NegotiationComplete)}async createAndSendOffer(s){var d;if(this.onOffer===void 0)return;if(s!=null&&s.iceRestart&&(livekitLogger.debug("restarting ICE"),this.restartingIce=!0),this.pc.signalingState==="have-local-offer"){const p=this.pc.remoteDescription;if((s==null?void 0:s.iceRestart)&&p)await this.pc.setRemoteDescription(p);else{this.renegotiate=!0;return}}else if(this.pc.signalingState==="closed"){livekitLogger.warn("could not createOffer with closed peer connection");return}livekitLogger.debug("starting to negotiate");const c=await this.pc.createOffer(s),l=parse$1((d=c.sdp)!==null&&d!==void 0?d:"");l.media.forEach(p=>{p.type==="audio"?ensureAudioNackAndStereo(p,[],[]):p.type==="video"&&this.trackBitrates.some(h=>{if(!p.msid||!p.msid.includes(h.sid))return!1;let v=0;return p.rtp.some(S=>S.codec.toUpperCase()===h.codec.toUpperCase()?(v=S.payload,!0):!1),v>0&&(p.fmtp.some(S=>S.payload===v?(S.config.includes("x-google-max-bitrate")||(S.config+=";x-google-max-bitrate=".concat(h.maxbr)),!0):!1)||p.fmtp.push({payload:v,config:"x-google-max-bitrate=".concat(h.maxbr)})),!0})}),this.trackBitrates=[],await this.setMungedLocalDescription(c,write(l)),this.onOffer(c)}async createAndSetAnswer(){var s;const d=await this.pc.createAnswer(),c=parse$1((s=d.sdp)!==null&&s!==void 0?s:"");return c.media.forEach(l=>{l.type==="audio"&&ensureAudioNackAndStereo(l,this.remoteStereoMids,this.remoteNackMids)}),await this.setMungedLocalDescription(d,write(c)),d}setTrackCodecBitrate(s,d,c){this.trackBitrates.push({sid:s,codec:d,maxbr:c})}close(){this.pc.onconnectionstatechange=null,this.pc.oniceconnectionstatechange=null,this.pc.close()}async setMungedLocalDescription(s,d){const c=s.sdp;s.sdp=d;try{livekitLogger.debug("setting munged local description"),await this.pc.setLocalDescription(s);return}catch(l){livekitLogger.warn("not able to set ".concat(s.type,", falling back to unmodified sdp"),{error:l}),s.sdp=c}try{await this.pc.setLocalDescription(s)}catch(l){let p="unknown error";throw l instanceof Error?p=l.message:typeof l=="string"&&(p=l),new NegotiationError(p)}}}function ensureAudioNackAndStereo(a,s,d){let c=0;a.rtp.some(l=>l.codec==="opus"?(c=l.payload,!0):!1),c>0&&(a.rtcpFb||(a.rtcpFb=[]),d.includes(a.mid)&&!a.rtcpFb.some(l=>l.payload===c&&l.type==="nack")&&a.rtcpFb.push({payload:c,type:"nack"}),s.includes(a.mid)&&a.fmtp.some(l=>l.payload===c?(l.config.includes("stereo=1")||(l.config+=";stereo=1"),!0):!1))}function extractStereoAndNackAudioFromOffer(a){var s;const d=[],c=[],l=parse$1((s=a.sdp)!==null&&s!==void 0?s:"");let p=0;return l.media.forEach(h=>{var v;h.type==="audio"&&(h.rtp.some(S=>S.codec==="opus"?(p=S.payload,!0):!1),!((v=h.rtcpFb)===null||v===void 0)&&v.some(S=>S.payload===p&&S.type==="nack")&&c.push(h.mid),h.fmtp.some(S=>S.payload===p?(S.config.includes("sprop-stereo=1")&&d.push(h.mid),!0):!1))}),{stereoMids:d,nackMids:c}}const lossyDataChannel="_lossy",reliableDataChannel="_reliable",minReconnectWait=2*1e3,leaveReconnect="leave-reconnect";var PCState;(function(a){a[a.New=0]="New",a[a.Connected=1]="Connected",a[a.Disconnected=2]="Disconnected",a[a.Reconnecting=3]="Reconnecting",a[a.Closed=4]="Closed"})(PCState||(PCState={}));class RTCEngine extends eventsExports.EventEmitter{get isClosed(){return this._isClosed}constructor(s){super(),this.options=s,this.rtcConfig={},this.peerConnectionTimeout=roomConnectOptionDefaults.peerConnectionTimeout,this.subscriberPrimary=!1,this.pcState=PCState.New,this._isClosed=!0,this.pendingTrackResolvers={},this.hasPublished=!1,this.reconnectAttempts=0,this.reconnectStart=0,this.fullReconnectOnNext=!1,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.handleDataChannel=async d=>{let{channel:c}=d;if(!!c){if(c.label===reliableDataChannel)this.reliableDCSub=c;else if(c.label===lossyDataChannel)this.lossyDCSub=c;else return;livekitLogger.debug("on data channel ".concat(c.id,", ").concat(c.label)),c.onmessage=this.handleDataMessage}},this.handleDataMessage=async d=>{var c,l;let p;if(d.data instanceof ArrayBuffer)p=d.data;else if(d.data instanceof Blob)p=await d.data.arrayBuffer();else{livekitLogger.error("unsupported data type",d.data);return}const h=DataPacket.decode(new Uint8Array(p));((c=h.value)===null||c===void 0?void 0:c.$case)==="speaker"?this.emit(EngineEvent.ActiveSpeakersUpdate,h.value.speaker.speakers):((l=h.value)===null||l===void 0?void 0:l.$case)==="user"&&this.emit(EngineEvent.DataPacketReceived,h.value.user,h.kind)},this.handleDataError=d=>{const l=d.currentTarget.maxRetransmits===0?"lossy":"reliable";if(d instanceof ErrorEvent){const{error:p}=d.error;livekitLogger.error("DataChannel error on ".concat(l,": ").concat(d.message),p)}else livekitLogger.error("Unknown DataChannel Error on ".concat(l),d)},this.handleDisconnect=(d,c)=>{if(this._isClosed)return;livekitLogger.warn("".concat(d," disconnected")),this.reconnectAttempts===0&&(this.reconnectStart=Date.now());const l=v=>{livekitLogger.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(v,"ms. giving up")),this.emit(EngineEvent.Disconnected),this.close()},p=Date.now()-this.reconnectStart;let h=this.getNextRetryDelay({elapsedMs:p,retryCount:this.reconnectAttempts});if(h===null){l(p);return}d===leaveReconnect&&(h=0),livekitLogger.debug("reconnecting in ".concat(h,"ms")),this.clearReconnectTimeout(),this.reconnectTimeout=CriticalTimers.setTimeout(()=>this.attemptReconnect(c),h)},this.handleBrowserOnLine=()=>{this.client.isReconnecting&&(this.clearReconnectTimeout(),this.attemptReconnect(ReconnectReason.RR_SIGNAL_DISCONNECTED))},this.client=new SignalClient,this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.registerOnLineListener(),this.closingLock=new Mutex}async join(s,d,c,l){this.url=s,this.token=d,this.signalOpts=c;try{this.joinAttempts+=1;const p=await this.client.join(s,d,c,l);return this._isClosed=!1,this.subscriberPrimary=p.subscriberPrimary,this.publisher||this.configure(p),this.subscriberPrimary||this.negotiate(),this.clientConfiguration=p.clientConfiguration,p}catch(p){if(p instanceof ConnectionError&&p.reason===1&&(livekitLogger.warn("Couldn't connect to server, attempt ".concat(this.joinAttempts," of ").concat(this.maxJoinAttempts)),this.joinAttempts<this.maxJoinAttempts))return this.join(s,d,c,l);throw p}}async close(){const s=await this.closingLock.lock();if(this.isClosed){s();return}try{this._isClosed=!0,this.emit(EngineEvent.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),this.publisher&&this.publisher.pc.signalingState!=="closed"&&(this.publisher.pc.getSenders().forEach(d=>{var c,l;try{!((c=this.publisher)===null||c===void 0)&&c.pc.removeTrack&&((l=this.publisher)===null||l===void 0||l.pc.removeTrack(d))}catch(p){livekitLogger.warn("could not removeTrack",{error:p})}}),this.publisher.close(),this.publisher=void 0),this.subscriber&&(this.subscriber.close(),this.subscriber=void 0),await this.client.close()}finally{s()}}addTrack(s){if(this.pendingTrackResolvers[s.cid])throw new TrackInvalidError("a track with the same ID has already been published");return new Promise((d,c)=>{const l=setTimeout(()=>{delete this.pendingTrackResolvers[s.cid],c(new ConnectionError("publication of local track timed out, no response from server"))},1e4);this.pendingTrackResolvers[s.cid]={resolve:p=>{clearTimeout(l),d(p)},reject:()=>{clearTimeout(l),c(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(s)})}removeTrack(s){var d;if(s.track&&this.pendingTrackResolvers[s.track.id]){const{reject:c}=this.pendingTrackResolvers[s.track.id];c&&c(),delete this.pendingTrackResolvers[s.track.id]}try{return(d=this.publisher)===null||d===void 0||d.pc.removeTrack(s),!0}catch(c){livekitLogger.warn("failed to remove track",{error:c,method:"removeTrack"})}return!1}updateMuteStatus(s,d){this.client.sendMuteTrack(s,d)}get dataSubscriberReadyState(){var s;return(s=this.reliableDCSub)===null||s===void 0?void 0:s.readyState}async getConnectedServerAddress(){if(this.primaryPC!==void 0)return getConnectedAddress(this.primaryPC)}configure(s){var d;if(this.publisher||this.subscriber)return;this.participantSid=(d=s.participant)===null||d===void 0?void 0:d.sid;const c=this.makeRTCConfiguration(s);this.publisher=new PCTransport(c),this.subscriber=new PCTransport(c),this.emit(EngineEvent.TransportsCreated,this.publisher,this.subscriber),this.publisher.pc.onicecandidate=v=>{!v.candidate||(livekitLogger.trace("adding ICE candidate for peer",v.candidate),this.client.sendIceCandidate(v.candidate,SignalTarget.PUBLISHER))},this.subscriber.pc.onicecandidate=v=>{!v.candidate||this.client.sendIceCandidate(v.candidate,SignalTarget.SUBSCRIBER)},this.publisher.onOffer=v=>{this.client.sendOffer(v)};let l=this.publisher.pc,p=this.subscriber.pc,h=s.subscriberPrimary;h&&(l=this.subscriber.pc,p=this.publisher.pc,this.subscriber.pc.ondatachannel=this.handleDataChannel),this.primaryPC=l,l.onconnectionstatechange=async()=>{if(livekitLogger.debug("primary PC state changed ".concat(l.connectionState)),l.connectionState==="connected"){const v=this.pcState===PCState.New;this.pcState=PCState.Connected,v&&this.emit(EngineEvent.Connected,s)}else l.connectionState==="failed"&&this.pcState===PCState.Connected&&(this.pcState=PCState.Disconnected,this.handleDisconnect("primary peerconnection",h?ReconnectReason.RR_SUBSCRIBER_FAILED:ReconnectReason.RR_PUBLISHER_FAILED))},p.onconnectionstatechange=async()=>{livekitLogger.debug("secondary PC state changed ".concat(p.connectionState)),p.connectionState==="failed"&&this.handleDisconnect("secondary peerconnection",h?ReconnectReason.RR_PUBLISHER_FAILED:ReconnectReason.RR_SUBSCRIBER_FAILED)},this.subscriber.pc.ontrack=v=>{this.emit(EngineEvent.MediaTrackAdded,v.track,v.streams[0],v.receiver)},this.createDataChannels(),this.client.onAnswer=async v=>{!this.publisher||(livekitLogger.debug("received server answer",{RTCSdpType:v.type,signalingState:this.publisher.pc.signalingState}),await this.publisher.setRemoteDescription(v))},this.client.onTrickle=(v,S)=>{!this.publisher||!this.subscriber||(livekitLogger.trace("got ICE candidate from peer",{candidate:v,target:S}),S===SignalTarget.PUBLISHER?this.publisher.addIceCandidate(v):this.subscriber.addIceCandidate(v))},this.client.onOffer=async v=>{if(!this.subscriber)return;livekitLogger.debug("received server offer",{RTCSdpType:v.type,signalingState:this.subscriber.pc.signalingState}),await this.subscriber.setRemoteDescription(v);const S=await this.subscriber.createAndSetAnswer();this.client.sendAnswer(S)},this.client.onLocalTrackPublished=v=>{livekitLogger.debug("received trackPublishedResponse",v);const{resolve:S}=this.pendingTrackResolvers[v.cid];if(!S){livekitLogger.error("missing track resolver for ".concat(v.cid));return}delete this.pendingTrackResolvers[v.cid],S(v.track)},this.client.onTokenRefresh=v=>{this.token=v},this.client.onClose=()=>{this.handleDisconnect("signal",ReconnectReason.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=v=>{v!=null&&v.canReconnect?(this.fullReconnectOnNext=!0,this.primaryPC=void 0,this.handleDisconnect(leaveReconnect)):(this.emit(EngineEvent.Disconnected,v==null?void 0:v.reason),this.close()),livekitLogger.trace("leave request",{leave:v})}}makeRTCConfiguration(s){const d=_objectSpread2({},this.rtcConfig);if(s.iceServers&&!d.iceServers){const c=[];s.iceServers.forEach(l=>{const p={urls:l.urls};l.username&&(p.username=l.username),l.credential&&(p.credential=l.credential),c.push(p)}),d.iceServers=c}return s.clientConfiguration&&s.clientConfiguration.forceRelay===ClientConfigSetting.ENABLED&&(d.iceTransportPolicy="relay"),d.sdpSemantics="unified-plan",d.continualGatheringPolicy="gather_continually",d}createDataChannels(){!this.publisher||(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.publisher.pc.createDataChannel(lossyDataChannel,{ordered:!0,maxRetransmits:0}),this.reliableDC=this.publisher.pc.createDataChannel(reliableDataChannel,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError)}setPreferredCodec(s,d,c){if(!("getCapabilities"in RTCRtpSender))return;const l=RTCRtpSender.getCapabilities(d);if(!l)return;livekitLogger.debug("get capabilities",l);const p=[],h=[],v=[];l.codecs.forEach(S=>{const b=S.mimeType.toLowerCase();if(b==="audio/opus"){p.push(S);return}if(!(b==="video/".concat(c))){v.push(S);return}if(c==="h264"){S.sdpFmtpLine&&S.sdpFmtpLine.includes("profile-level-id=42e01f")?p.push(S):h.push(S);return}p.push(S)}),supportsSetCodecPreferences(s)&&s.setCodecPreferences(p.concat(h,v))}async createSender(s,d,c){if(supportsTransceiver())return this.createTransceiverRTCRtpSender(s,d,c);if(supportsAddTrack())return livekitLogger.debug("using add-track fallback"),this.createRTCRtpSender(s.mediaStreamTrack);throw new UnexpectedConnectionState("Required webRTC APIs not supported on this device")}async createSimulcastSender(s,d,c,l){if(supportsTransceiver())return this.createSimulcastTransceiverSender(s,d,c,l);if(supportsAddTrack())return livekitLogger.debug("using add-track fallback"),this.createRTCRtpSender(s.mediaStreamTrack);throw new UnexpectedConnectionState("Cannot stream on this device")}async createTransceiverRTCRtpSender(s,d,c){if(!this.publisher)throw new UnexpectedConnectionState("publisher is closed");const l={direction:"sendonly"};c&&(l.sendEncodings=c);const p=await this.publisher.pc.addTransceiver(s.mediaStreamTrack,l);return s.kind===Track.Kind.Video&&d.videoCodec&&(this.setPreferredCodec(p,s.kind,d.videoCodec),s.codec=d.videoCodec),p.sender}async createSimulcastTransceiverSender(s,d,c,l){if(!this.publisher)throw new UnexpectedConnectionState("publisher is closed");const p={direction:"sendonly"};l&&(p.sendEncodings=l);const h=await this.publisher.pc.addTransceiver(d.mediaStreamTrack,p);if(!!c.videoCodec)return this.setPreferredCodec(h,s.kind,c.videoCodec),s.setSimulcastTrackSender(c.videoCodec,h.sender),h.sender}async createRTCRtpSender(s){if(!this.publisher)throw new UnexpectedConnectionState("publisher is closed");return this.publisher.pc.addTrack(s)}async attemptReconnect(s){var d,c,l;if(!this._isClosed&&!this.attemptingReconnect){(((d=this.clientConfiguration)===null||d===void 0?void 0:d.resumeConnection)===ClientConfigSetting.DISABLED||((l=(c=this.primaryPC)===null||c===void 0?void 0:c.signalingState)!==null&&l!==void 0?l:"closed")==="closed")&&(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?await this.restartConnection():await this.resumeConnection(s),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(p){this.reconnectAttempts+=1;let h=!0;p instanceof UnexpectedConnectionState?(livekitLogger.debug("received unrecoverable error",{error:p}),h=!1):p instanceof SignalReconnectError||(this.fullReconnectOnNext=!0),h?this.handleDisconnect("reconnect",ReconnectReason.RR_UNKOWN):(livekitLogger.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up")),this.emit(EngineEvent.Disconnected),this.close())}finally{this.attemptingReconnect=!1}}}getNextRetryDelay(s){try{return this.reconnectPolicy.nextRetryDelayInMs(s)}catch(d){livekitLogger.warn("encountered error in reconnect policy",{error:d})}return null}async restartConnection(){var s,d;if(!this.url||!this.token)throw new UnexpectedConnectionState("could not reconnect, url or token not saved");livekitLogger.info("reconnecting, attempt: ".concat(this.reconnectAttempts)),this.emit(EngineEvent.Restarting),this.client.isConnected&&await this.client.sendLeave(),await this.client.close(),this.primaryPC=void 0,(s=this.publisher)===null||s===void 0||s.close(),this.publisher=void 0,(d=this.subscriber)===null||d===void 0||d.close(),this.subscriber=void 0;let c;try{if(!this.signalOpts)throw livekitLogger.warn("attempted connection restart, without signal options present"),new SignalReconnectError;c=await this.join(this.url,this.token,this.signalOpts)}catch{throw new SignalReconnectError}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");await this.waitForPCConnected(),this.client.setReconnected(),this.emit(EngineEvent.Restarted,c)}async resumeConnection(s){var d;if(!this.url||!this.token)throw new UnexpectedConnectionState("could not reconnect, url or token not saved");if(!this.publisher||!this.subscriber)throw new UnexpectedConnectionState("publisher and subscriber connections unset");livekitLogger.info("resuming signal connection, attempt ".concat(this.reconnectAttempts)),this.emit(EngineEvent.Resuming);try{const c=await this.client.reconnect(this.url,this.token,this.participantSid,s);if(c){const l=this.makeRTCConfiguration(c);this.publisher.pc.setConfiguration(l),this.subscriber.pc.setConfiguration(l)}}catch(c){let l="";throw c instanceof Error&&(l=c.message),new SignalReconnectError(l)}if(this.emit(EngineEvent.SignalResumed),this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");this.subscriber.restartingIce=!0,this.hasPublished&&await this.publisher.createAndSendOffer({iceRestart:!0}),await this.waitForPCConnected(),this.client.setReconnected(),((d=this.reliableDC)===null||d===void 0?void 0:d.readyState)==="open"&&this.reliableDC.id===null&&this.createDataChannels(),this.emit(EngineEvent.Resumed)}async waitForPCConnected(){var s;const d=Date.now();let c=d;for(this.pcState=PCState.Reconnecting,livekitLogger.debug("waiting for peer connection to reconnect");c-d<this.peerConnectionTimeout&&this.primaryPC!==void 0;){if(c-d>minReconnectWait&&((s=this.primaryPC)===null||s===void 0?void 0:s.connectionState)==="connected"&&(this.pcState=PCState.Connected),this.pcState===PCState.Connected)return;await sleep(100),c=Date.now()}throw new ConnectionError("could not establish PC connection")}async sendDataPacket(s,d){const c=DataPacket.encode(s).finish();await this.ensurePublisherConnected(d),d===DataPacket_Kind.LOSSY&&this.lossyDC?this.lossyDC.send(c):d===DataPacket_Kind.RELIABLE&&this.reliableDC&&this.reliableDC.send(c)}async ensureDataTransportConnected(s){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscriberPrimary;var c,l,p;const h=d?this.subscriber:this.publisher,v=d?"Subscriber":"Publisher";if(!h)throw new ConnectionError("".concat(v," connection not set"));!d&&!(!((c=this.publisher)===null||c===void 0)&&c.isICEConnected)&&((l=this.publisher)===null||l===void 0?void 0:l.pc.iceConnectionState)!=="checking"&&this.negotiate();const S=this.dataChannelForKind(s,d);if((S==null?void 0:S.readyState)==="open")return;const b=new Date().getTime()+this.peerConnectionTimeout;for(;new Date().getTime()<b;){if(h.isICEConnected&&((p=this.dataChannelForKind(s,d))===null||p===void 0?void 0:p.readyState)==="open")return;await sleep(50)}throw new ConnectionError("could not establish ".concat(v," connection, state: ").concat(h.pc.iceConnectionState))}async ensurePublisherConnected(s){await this.ensureDataTransportConnected(s,!1)}negotiate(){return new Promise((s,d)=>{if(!this.publisher){d(new NegotiationError("publisher is not defined"));return}this.hasPublished=!0;const c=()=>{livekitLogger.debug("engine disconnected while negotiation was ongoing"),p(),s()};this.on(EngineEvent.Closing,c);const l=setTimeout(()=>{d("negotiation timed out"),this.handleDisconnect("negotiation",ReconnectReason.RR_SIGNAL_DISCONNECTED)},this.peerConnectionTimeout),p=()=>{clearTimeout(l),this.off(EngineEvent.Closing,c)};this.publisher.once(PCEvents.NegotiationStarted,()=>{var h;(h=this.publisher)===null||h===void 0||h.once(PCEvents.NegotiationComplete,()=>{p(),s()})}),this.publisher.negotiate(h=>{p(),d(h),h instanceof NegotiationError&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",ReconnectReason.RR_UNKOWN)})})}dataChannelForKind(s,d){if(d){if(s===DataPacket_Kind.LOSSY)return this.lossyDCSub;if(s===DataPacket_Kind.RELIABLE)return this.reliableDCSub}else{if(s===DataPacket_Kind.LOSSY)return this.lossyDC;if(s===DataPacket_Kind.RELIABLE)return this.reliableDC}}failNext(){this.shouldFailNext=!0}clearReconnectTimeout(){this.reconnectTimeout&&CriticalTimers.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){isWeb()&&window.addEventListener("online",this.handleBrowserOnLine)}deregisterOnLineListener(){isWeb()&&window.removeEventListener("online",this.handleBrowserOnLine)}}async function getConnectedAddress(a){var s;let d="";const c=new Map,l=new Map;if((await a.getStats()).forEach(v=>{switch(v.type){case"transport":d=v.selectedCandidatePairId;break;case"candidate-pair":d===""&&v.selected&&(d=v.id),c.set(v.id,v);break;case"remote-candidate":l.set(v.id,"".concat(v.address,":").concat(v.port));break}}),d==="")return;const h=(s=c.get(d))===null||s===void 0?void 0:s.remoteCandidateId;if(h!==void 0)return l.get(h)}class SignalReconnectError extends Error{}var ConnectionState;(function(a){a.Disconnected="disconnected",a.Connecting="connecting",a.Connected="connected",a.Reconnecting="reconnecting"})(ConnectionState||(ConnectionState={}));class Room extends eventsExports.EventEmitter{constructor(s){var d;super(),d=this,this.state=ConnectionState.Disconnected,this.activeSpeakers=[],this.sid="",this.name="",this.metadata=void 0,this._isRecording=!1,this.audioEnabled=!0,this.connect=async(c,l,p)=>{const h=await this.disconnectLock.lock();if(this.state===ConnectionState.Connected)return livekitLogger.info("already connected to room ".concat(this.name)),h(),Promise.resolve();if(this.connectFuture)return h(),this.connectFuture.promise;this.setAndEmitConnectionState(ConnectionState.Connecting);const v=async(S,b)=>{var _,I;(!this.abortController||this.abortController.signal.aborted)&&(this.abortController=new AbortController),h(),this.state===ConnectionState.Reconnecting?(livekitLogger.info("Reconnection attempt replaced by new connection attempt"),this.recreateEngine()):this.maybeCreateEngine(),this.acquireAudioContext(),this.connOptions=_objectSpread2(_objectSpread2({},roomConnectOptionDefaults),p),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const w=await this.engine.join(c,l,{autoSubscribe:this.connOptions.autoSubscribe,publishOnly:this.connOptions.publishOnly,adaptiveStream:typeof this.options.adaptiveStream=="object"?!0:this.options.adaptiveStream,maxRetries:this.connOptions.maxRetries},this.abortController.signal);let P=w.serverInfo;if(P||(P={version:w.serverVersion,region:w.serverRegion}),livekitLogger.debug("connected to Livekit Server ".concat(Object.entries(P).map(U=>{let[E,D]=U;return"".concat(E,": ").concat(D)}).join(", "))),!w.serverVersion)throw new UnsupportedServer("unknown server version");w.serverVersion==="0.15.1"&&this.options.dynacast&&(livekitLogger.debug("disabling dynacast due to server version"),this.options.dynacast=!1);const $=w.participant;this.localParticipant.sid=$.sid,this.localParticipant.identity=$.identity,this.localParticipant.updateInfo($),this.setupLocalParticipantEvents(),w.otherParticipants.forEach(U=>{U.sid!==this.localParticipant.sid&&U.identity!==this.localParticipant.identity?this.getOrCreateParticipant(U.sid,U):livekitLogger.warn("received info to create local participant as remote participant",{info:U,localParticipant:this.localParticipant})}),this.name=w.room.name,this.sid=w.room.sid,this.metadata=w.room.metadata,this._isRecording!==w.room.activeRecording&&(this._isRecording=w.room.activeRecording,this.emit(RoomEvent.RecordingStatusChanged,w.room.activeRecording)),this.emit(RoomEvent.SignalConnected)}catch(w){this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish);const P=new ConnectionError("could not establish signal connection");w instanceof Error&&(P.message="".concat(P.message,": ").concat(w.message)),w instanceof ConnectionError&&(P.reason=w.reason,P.status=w.status),livekitLogger.debug("error trying to establish signal connection",{error:w}),b(P);return}const T=CriticalTimers.setTimeout(()=>{this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),b(new ConnectionError("could not connect PeerConnection after timeout"))},this.connOptions.peerConnectionTimeout),k=()=>{livekitLogger.warn("closing engine"),CriticalTimers.clearTimeout(T),this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),b(new ConnectionError("room connection has been cancelled"))};!((_=this.abortController)===null||_===void 0)&&_.signal.aborted&&k(),(I=this.abortController)===null||I===void 0||I.signal.addEventListener("abort",k),this.engine.once(EngineEvent.Connected,()=>{var w,P;CriticalTimers.clearTimeout(T),(w=this.abortController)===null||w===void 0||w.signal.removeEventListener("abort",k),isWeb()&&(window.addEventListener("beforeunload",this.onBeforeUnload),(P=navigator.mediaDevices)===null||P===void 0||P.addEventListener("devicechange",this.handleDeviceChange)),this.setAndEmitConnectionState(ConnectionState.Connected),this.emit(RoomEvent.Connected),S()})};return this.connectFuture=new Future(v,()=>{this.clearConnectionFutures()}),this.connectFuture.promise},this.disconnect=async function(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;var l,p,h,v;const S=await d.disconnectLock.lock();try{if(d.state===ConnectionState.Disconnected){livekitLogger.debug("already disconnected");return}livekitLogger.info("disconnect from room",{identity:d.localParticipant.identity}),(d.state===ConnectionState.Connecting||d.state===ConnectionState.Reconnecting)&&(livekitLogger.warn("abort connection attempt"),(l=d.abortController)===null||l===void 0||l.abort(),(h=(p=d.connectFuture)===null||p===void 0?void 0:p.reject)===null||h===void 0||h.call(p,new ConnectionError("Client initiated disconnect")),d.connectFuture=void 0),!((v=d.engine)===null||v===void 0)&&v.client.isConnected&&await d.engine.client.sendLeave(),d.engine&&await d.engine.close(),d.handleDisconnect(c,DisconnectReason.CLIENT_INITIATED),d.engine=void 0}finally{S()}},this.onBeforeUnload=async()=>{await this.disconnect()},this.handleRestarting=()=>{for(const c of this.participants.values())this.handleParticipantDisconnected(c.sid,c);this.setAndEmitConnectionState(ConnectionState.Reconnecting)&&this.emit(RoomEvent.Reconnecting)},this.handleRestarted=async c=>{livekitLogger.debug("reconnected to server",{region:c.serverRegion});try{c.participant&&(this.localParticipant.sid=c.participant.sid,this.handleParticipantUpdates([c.participant])),this.handleParticipantUpdates(c.otherParticipants);const l=[];this.localParticipant.tracks.forEach(p=>{p.track&&l.push(p)}),await Promise.all(l.map(async p=>{const h=p.track;this.localParticipant.unpublishTrack(h,!1),h.isMuted||((h instanceof LocalAudioTrack||h instanceof LocalVideoTrack)&&!h.isUserProvided&&(livekitLogger.debug("restarting existing track",{track:p.trackSid}),await h.restartTrack()),livekitLogger.debug("publishing new track",{track:p.trackSid}),await this.localParticipant.publishTrack(h,p.options))}))}catch(l){livekitLogger.error("error trying to re-publish tracks after reconnection",{error:l})}finally{this.setAndEmitConnectionState(ConnectionState.Connected),this.emit(RoomEvent.Reconnected)}},this.handleParticipantUpdates=c=>{c.forEach(l=>{if(l.identity===this.localParticipant.identity){this.localParticipant.updateInfo(l);return}const p=this.identityToSid.get(l.identity);p&&p!==l.sid&&this.handleParticipantDisconnected(p,this.participants.get(p));let h=this.participants.get(l.sid);const v=!h;l.state===ParticipantInfo_State.DISCONNECTED?this.handleParticipantDisconnected(l.sid,h):(h=this.getOrCreateParticipant(l.sid,l),v||h.updateInfo(l))})},this.handleActiveSpeakersUpdate=c=>{const l=[],p={};c.forEach(h=>{if(p[h.sid]=!0,h.sid===this.localParticipant.sid)this.localParticipant.audioLevel=h.level,this.localParticipant.setIsSpeaking(!0),l.push(this.localParticipant);else{const v=this.participants.get(h.sid);v&&(v.audioLevel=h.level,v.setIsSpeaking(!0),l.push(v))}}),p[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.participants.forEach(h=>{p[h.sid]||(h.audioLevel=0,h.setIsSpeaking(!1))}),this.activeSpeakers=l,this.emitWhenConnected(RoomEvent.ActiveSpeakersChanged,l)},this.handleSpeakersChanged=c=>{const l=new Map;this.activeSpeakers.forEach(h=>{l.set(h.sid,h)}),c.forEach(h=>{let v=this.participants.get(h.sid);h.sid===this.localParticipant.sid&&(v=this.localParticipant),v&&(v.audioLevel=h.level,v.setIsSpeaking(h.active),h.active?l.set(h.sid,v):l.delete(h.sid))});const p=Array.from(l.values());p.sort((h,v)=>v.audioLevel-h.audioLevel),this.activeSpeakers=p,this.emitWhenConnected(RoomEvent.ActiveSpeakersChanged,p)},this.handleStreamStateUpdate=c=>{c.streamStates.forEach(l=>{const p=this.participants.get(l.participantSid);if(!p)return;const h=p.getTrackPublication(l.trackSid);!h||!h.track||(h.track.streamState=Track.streamStateFromProto(l.state),p.emit(ParticipantEvent.TrackStreamStateChanged,h,h.track.streamState),this.emitWhenConnected(RoomEvent.TrackStreamStateChanged,h,h.track.streamState,p))})},this.handleSubscriptionPermissionUpdate=c=>{const l=this.participants.get(c.participantSid);if(!l)return;const p=l.getTrackPublication(c.trackSid);!p||p.setAllowed(c.allowed)},this.handleDataPacket=(c,l)=>{const p=this.participants.get(c.participantSid);this.emit(RoomEvent.DataReceived,c.payload,p,l,c.topic),p==null||p.emit(ParticipantEvent.DataReceived,c.payload,l)},this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(RoomEvent.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=c=>{livekitLogger.warn("could not playback audio",c),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(RoomEvent.AudioPlaybackStatusChanged,!1))},this.handleDeviceChange=async()=>{this.emit(RoomEvent.MediaDevicesChanged)},this.handleRoomUpdate=c=>{this._isRecording!==c.activeRecording&&(this._isRecording=c.activeRecording,this.emit(RoomEvent.RecordingStatusChanged,c.activeRecording)),this.metadata!==c.metadata&&(this.metadata=c.metadata,this.emitWhenConnected(RoomEvent.RoomMetadataChanged,c.metadata))},this.handleConnectionQualityUpdate=c=>{c.updates.forEach(l=>{if(l.participantSid===this.localParticipant.sid){this.localParticipant.setConnectionQuality(l.quality);return}const p=this.participants.get(l.participantSid);p&&p.setConnectionQuality(l.quality)})},this.onLocalParticipantMetadataChanged=c=>{this.emit(RoomEvent.ParticipantMetadataChanged,c,this.localParticipant)},this.onLocalTrackMuted=c=>{this.emit(RoomEvent.TrackMuted,c,this.localParticipant)},this.onLocalTrackUnmuted=c=>{this.emit(RoomEvent.TrackUnmuted,c,this.localParticipant)},this.onLocalTrackPublished=c=>{this.emit(RoomEvent.LocalTrackPublished,c,this.localParticipant)},this.onLocalTrackUnpublished=c=>{this.emit(RoomEvent.LocalTrackUnpublished,c,this.localParticipant)},this.onLocalConnectionQualityChanged=c=>{this.emit(RoomEvent.ConnectionQualityChanged,c,this.localParticipant)},this.onMediaDevicesError=c=>{this.emit(RoomEvent.MediaDevicesError,c)},this.onLocalParticipantPermissionsChanged=c=>{this.emit(RoomEvent.ParticipantPermissionsChanged,c,this.localParticipant)},this.setMaxListeners(100),this.participants=new Map,this.identityToSid=new Map,this.options=_objectSpread2(_objectSpread2({},roomOptionDefaults),s),this.options.audioCaptureDefaults=_objectSpread2(_objectSpread2({},audioDefaults),s==null?void 0:s.audioCaptureDefaults),this.options.videoCaptureDefaults=_objectSpread2(_objectSpread2({},videoDefaults),s==null?void 0:s.videoCaptureDefaults),this.options.publishDefaults=_objectSpread2(_objectSpread2({},publishDefaults),s==null?void 0:s.publishDefaults),this.maybeCreateEngine(),this.disconnectLock=new Mutex,this.localParticipant=new LocalParticipant("","",this.engine,this.options)}maybeCreateEngine(){this.engine||(this.engine=new RTCEngine(this.options),this.engine.client.onParticipantUpdate=this.handleParticipantUpdates,this.engine.client.onRoomUpdate=this.handleRoomUpdate,this.engine.client.onSpeakersChanged=this.handleSpeakersChanged,this.engine.client.onStreamStateUpdate=this.handleStreamStateUpdate,this.engine.client.onSubscriptionPermissionUpdate=this.handleSubscriptionPermissionUpdate,this.engine.client.onConnectionQuality=this.handleConnectionQualityUpdate,this.engine.on(EngineEvent.MediaTrackAdded,(s,d,c)=>{this.onTrackAdded(s,d,c)}).on(EngineEvent.Disconnected,s=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,s)}).on(EngineEvent.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(EngineEvent.DataPacketReceived,this.handleDataPacket).on(EngineEvent.Resuming,()=>{this.setAndEmitConnectionState(ConnectionState.Reconnecting)&&this.emit(RoomEvent.Reconnecting)}).on(EngineEvent.Resumed,()=>{this.setAndEmitConnectionState(ConnectionState.Connected),this.emit(RoomEvent.Reconnected),this.updateSubscriptions()}).on(EngineEvent.SignalResumed,()=>{this.state===ConnectionState.Reconnecting&&this.sendSyncState()}).on(EngineEvent.Restarting,this.handleRestarting).on(EngineEvent.Restarted,this.handleRestarted),this.localParticipant&&this.localParticipant.setupEngine(this.engine))}static getLocalDevices(s){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return DeviceManager.getInstance().getDevices(s,d)}async prepareConnection(s){await fetch("http".concat(s.substring(2)),{method:"HEAD"})}getParticipantByIdentity(s){if(this.localParticipant.identity===s)return this.localParticipant;const d=this.identityToSid.get(s);if(d)return this.participants.get(d)}clearConnectionFutures(){this.connectFuture=void 0}get isRecording(){return this._isRecording}async simulateScenario(s){let d=()=>{},c;switch(s){case"signal-reconnect":await this.engine.client.close(),this.engine.client.onClose&&this.engine.client.onClose("simulate disconnect");break;case"speaker":c=SimulateScenario.fromPartial({scenario:{$case:"speakerUpdate",speakerUpdate:3}});break;case"node-failure":c=SimulateScenario.fromPartial({scenario:{$case:"nodeFailure",nodeFailure:!0}});break;case"server-leave":c=SimulateScenario.fromPartial({scenario:{$case:"serverLeave",serverLeave:!0}});break;case"migration":c=SimulateScenario.fromPartial({scenario:{$case:"migration",migration:!0}});break;case"resume-reconnect":this.engine.failNext(),await this.engine.client.close(),this.engine.client.onClose&&this.engine.client.onClose("simulate resume-reconnect");break;case"force-tcp":case"force-tls":c=SimulateScenario.fromPartial({scenario:{$case:"switchCandidateProtocol",switchCandidateProtocol:s==="force-tls"?2:1}}),d=async()=>{const l=this.engine.client.onLeave;l&&l({reason:DisconnectReason.CLIENT_INITIATED,canReconnect:!0})};break}c&&(this.engine.client.sendSimulateScenario(c),d())}async startAudio(){await this.acquireAudioContext();const s=[];this.participants.forEach(d=>{d.audioTracks.forEach(c=>{c.track&&c.track.attachedElements.forEach(l=>{s.push(l)})})});try{await Promise.all(s.map(d=>(d.muted=!1,d.play()))),this.handleAudioPlaybackStarted()}catch(d){throw this.handleAudioPlaybackFailed(d),d}}get canPlaybackAudio(){return this.audioEnabled}getActiveAudioOutputDevice(){var s,d;return(d=(s=this.options.audioOutput)===null||s===void 0?void 0:s.deviceId)!==null&&d!==void 0?d:""}async switchActiveDevice(s,d){let c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;var l,p;const h=c?{exact:d}:d;if(s==="audioinput"){const v=this.options.audioCaptureDefaults.deviceId;this.options.audioCaptureDefaults.deviceId=h;const S=Array.from(this.localParticipant.audioTracks.values()).filter(b=>b.source===Track.Source.Microphone);try{await Promise.all(S.map(b=>{var _;return(_=b.audioTrack)===null||_===void 0?void 0:_.setDeviceId(h)}))}catch(b){throw this.options.audioCaptureDefaults.deviceId=v,b}}else if(s==="videoinput"){const v=this.options.videoCaptureDefaults.deviceId;this.options.videoCaptureDefaults.deviceId=h;const S=Array.from(this.localParticipant.videoTracks.values()).filter(b=>b.source===Track.Source.Camera);try{await Promise.all(S.map(b=>{var _;return(_=b.videoTrack)===null||_===void 0?void 0:_.setDeviceId(h)}))}catch(b){throw this.options.videoCaptureDefaults.deviceId=v,b}}else if(s==="audiooutput"){if(!supportsSetSinkId())throw new Error("cannot switch audio output, setSinkId not supported");(l=(p=this.options).audioOutput)!==null&&l!==void 0||(p.audioOutput={});const v=this.options.audioOutput.deviceId;this.options.audioOutput.deviceId=d;try{await Promise.all(Array.from(this.participants.values()).map(S=>S.setAudioOutput({deviceId:d})))}catch(S){throw this.options.audioOutput.deviceId=v,S}}}setupLocalParticipantEvents(){this.localParticipant.on(ParticipantEvent.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(ParticipantEvent.TrackMuted,this.onLocalTrackMuted).on(ParticipantEvent.TrackUnmuted,this.onLocalTrackUnmuted).on(ParticipantEvent.LocalTrackPublished,this.onLocalTrackPublished).on(ParticipantEvent.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(ParticipantEvent.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(ParticipantEvent.MediaDevicesError,this.onMediaDevicesError).on(ParticipantEvent.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var s;(s=this.engine)===null||s===void 0||s.close(),this.engine=void 0,this.participants.clear(),this.maybeCreateEngine()}onTrackAdded(s,d,c){if(this.state===ConnectionState.Connecting||this.state===ConnectionState.Reconnecting){const b=()=>{this.onTrackAdded(s,d,c),_()},_=()=>{this.off(RoomEvent.Reconnected,b),this.off(RoomEvent.Connected,b),this.off(RoomEvent.Disconnected,_)};this.once(RoomEvent.Reconnected,b),this.once(RoomEvent.Connected,b),this.once(RoomEvent.Disconnected,_);return}if(this.state===ConnectionState.Disconnected){livekitLogger.warn("skipping incoming track after Room disconnected");return}const l=unpackStreamId(d.id),p=l[0];let h=l[1];if((!h||h==="")&&(h=s.id),p===this.localParticipant.sid){livekitLogger.warn("tried to create RemoteParticipant for local participant");return}const v=this.getOrCreateParticipant(p);let S;this.options.adaptiveStream&&(typeof this.options.adaptiveStream=="object"?S=this.options.adaptiveStream:S={}),v.addSubscribedMediaTrack(s,h,d,c,S)}handleDisconnect(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,d=arguments.length>1?arguments[1]:void 0;var c;this.state!==ConnectionState.Disconnected&&(this.participants.forEach(l=>{l.tracks.forEach(p=>{l.unpublishTrack(p.trackSid)})}),this.localParticipant.tracks.forEach(l=>{var p,h;l.track&&this.localParticipant.unpublishTrack(l.track,s),s&&((p=l.track)===null||p===void 0||p.detach(),(h=l.track)===null||h===void 0||h.stop())}),this.localParticipant.off(ParticipantEvent.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(ParticipantEvent.TrackMuted,this.onLocalTrackMuted).off(ParticipantEvent.TrackUnmuted,this.onLocalTrackUnmuted).off(ParticipantEvent.LocalTrackPublished,this.onLocalTrackPublished).off(ParticipantEvent.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(ParticipantEvent.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(ParticipantEvent.MediaDevicesError,this.onMediaDevicesError).off(ParticipantEvent.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.tracks.clear(),this.localParticipant.videoTracks.clear(),this.localParticipant.audioTracks.clear(),this.participants.clear(),this.activeSpeakers=[],this.audioContext&&typeof this.options.expWebAudioMix=="boolean"&&(this.audioContext.close(),this.audioContext=void 0),isWeb()&&(window.removeEventListener("beforeunload",this.onBeforeUnload),(c=navigator.mediaDevices)===null||c===void 0||c.removeEventListener("devicechange",this.handleDeviceChange)),this.setAndEmitConnectionState(ConnectionState.Disconnected),this.emit(RoomEvent.Disconnected,d))}handleParticipantDisconnected(s,d){this.participants.delete(s),d&&(this.identityToSid.delete(d.identity),d.tracks.forEach(c=>{d.unpublishTrack(c.trackSid,!0)}),this.emit(RoomEvent.ParticipantDisconnected,d))}async acquireAudioContext(){var s,d;typeof this.options.expWebAudioMix!="boolean"&&this.options.expWebAudioMix.audioContext?(this.audioContext=this.options.expWebAudioMix.audioContext,await this.audioContext.resume()):this.audioContext=(s=getNewAudioContext())!==null&&s!==void 0?s:void 0,this.options.expWebAudioMix&&this.participants.forEach(l=>l.setAudioContext(this.audioContext));const c=((d=this.audioContext)===null||d===void 0?void 0:d.state)==="running";c!==this.canPlaybackAudio&&(this.audioEnabled=c,this.emit(RoomEvent.AudioPlaybackStatusChanged,c))}createParticipant(s,d){let c;return d?c=RemoteParticipant.fromParticipantInfo(this.engine.client,d):c=new RemoteParticipant(this.engine.client,s,"",void 0,void 0),this.options.expWebAudioMix&&c.setAudioContext(this.audioContext),c}getOrCreateParticipant(s,d){if(this.participants.has(s))return this.participants.get(s);const c=this.createParticipant(s,d);return this.participants.set(s,c),d&&(this.identityToSid.set(d.identity,d.sid),this.emitWhenConnected(RoomEvent.ParticipantConnected,c)),c.on(ParticipantEvent.TrackPublished,l=>{this.emitWhenConnected(RoomEvent.TrackPublished,l,c)}).on(ParticipantEvent.TrackSubscribed,(l,p)=>{l.kind===Track.Kind.Audio&&(l.on(TrackEvent.AudioPlaybackStarted,this.handleAudioPlaybackStarted),l.on(TrackEvent.AudioPlaybackFailed,this.handleAudioPlaybackFailed)),this.emit(RoomEvent.TrackSubscribed,l,p,c)}).on(ParticipantEvent.TrackUnpublished,l=>{this.emit(RoomEvent.TrackUnpublished,l,c)}).on(ParticipantEvent.TrackUnsubscribed,(l,p)=>{this.emit(RoomEvent.TrackUnsubscribed,l,p,c)}).on(ParticipantEvent.TrackSubscriptionFailed,l=>{this.emit(RoomEvent.TrackSubscriptionFailed,l,c)}).on(ParticipantEvent.TrackMuted,l=>{this.emitWhenConnected(RoomEvent.TrackMuted,l,c)}).on(ParticipantEvent.TrackUnmuted,l=>{this.emitWhenConnected(RoomEvent.TrackUnmuted,l,c)}).on(ParticipantEvent.ParticipantMetadataChanged,l=>{this.emitWhenConnected(RoomEvent.ParticipantMetadataChanged,l,c)}).on(ParticipantEvent.ConnectionQualityChanged,l=>{this.emitWhenConnected(RoomEvent.ConnectionQualityChanged,l,c)}).on(ParticipantEvent.ParticipantPermissionsChanged,l=>{this.emitWhenConnected(RoomEvent.ParticipantPermissionsChanged,l,c)}).on(ParticipantEvent.TrackSubscriptionStatusChanged,(l,p)=>{this.emitWhenConnected(RoomEvent.TrackSubscriptionStatusChanged,l,p,c)}).on(ParticipantEvent.TrackSubscriptionPermissionChanged,(l,p)=>{this.emitWhenConnected(RoomEvent.TrackSubscriptionPermissionChanged,l,p,c)}),d&&c.updateInfo(d),c}sendSyncState(){var s,d;if(this.engine.subscriber===void 0||this.engine.subscriber.pc.localDescription===null)return;const c=this.engine.subscriber.pc.localDescription,l=this.engine.subscriber.pc.remoteDescription,p=(d=(s=this.connOptions)===null||s===void 0?void 0:s.autoSubscribe)!==null&&d!==void 0?d:!0,h=new Array;this.participants.forEach(v=>{v.tracks.forEach(S=>{S.isDesired!==p&&h.push(S.trackSid)})}),this.engine.client.sendSyncState({answer:toProtoSessionDescription({sdp:c.sdp,type:c.type}),offer:l?toProtoSessionDescription({sdp:l.sdp,type:l.type}):void 0,subscription:{trackSids:h,subscribe:!p,participantTracks:[]},publishTracks:this.localParticipant.publishedTracksInfo(),dataChannels:this.localParticipant.dataChannelsInfo()})}updateSubscriptions(){for(const s of this.participants.values())for(const d of s.videoTracks.values())d.isSubscribed&&d instanceof RemoteTrackPublication&&d.emitTrackUpdate()}setAndEmitConnectionState(s){return s===this.state?!1:(this.state=s,this.emit(RoomEvent.ConnectionStateChanged,this.state),!0)}emitWhenConnected(s){if(this.state===ConnectionState.Connected){for(var d=arguments.length,c=new Array(d>1?d-1:0),l=1;l<d;l++)c[l-1]=arguments[l];return this.emit(s,...c)}return!1}async simulateParticipants(s){var d,c;const l=_objectSpread2({audio:!0,video:!0,useRealTracks:!1},s.publish),p=_objectSpread2({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},s.participants);if(this.handleDisconnect(),this.name="simulated-room",this.localParticipant.updateInfo(ParticipantInfo.fromPartial({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(RoomEvent.SignalConnected),this.emit(RoomEvent.Connected),this.setAndEmitConnectionState(ConnectionState.Connected),l.video){const h=new LocalTrackPublication(Track.Kind.Video,TrackInfo.fromPartial({source:TrackSource.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:TrackType.AUDIO,name:"video-dummy"}),new LocalVideoTrack(l.useRealTracks?(await navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:createDummyVideoStreamTrack((d=160*p.aspectRatios[0])!==null&&d!==void 0?d:1,160,!0,!0)));this.localParticipant.addTrackPublication(h),this.localParticipant.emit(ParticipantEvent.LocalTrackPublished,h)}if(l.audio){const h=new LocalTrackPublication(Track.Kind.Audio,TrackInfo.fromPartial({source:TrackSource.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:TrackType.AUDIO}),new LocalAudioTrack(l.useRealTracks?(await navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:getEmptyAudioStreamTrack()));this.localParticipant.addTrackPublication(h),this.localParticipant.emit(ParticipantEvent.LocalTrackPublished,h)}for(let h=0;h<p.count-1;h+=1){let v=ParticipantInfo.fromPartial({sid:Math.floor(Math.random()*1e4).toString(),identity:"simulated-".concat(h),state:ParticipantInfo_State.ACTIVE,tracks:[],joinedAt:Date.now()});const S=this.getOrCreateParticipant(v.identity,v);if(p.video){const b=createDummyVideoStreamTrack((c=160*p.aspectRatios[h%p.aspectRatios.length])!==null&&c!==void 0?c:1,160,!1,!0),_=TrackInfo.fromPartial({source:TrackSource.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:TrackType.AUDIO});S.addSubscribedMediaTrack(b,_.sid,new MediaStream([b])),v.tracks=[...v.tracks,_]}if(p.audio){const b=getEmptyAudioStreamTrack(),_=TrackInfo.fromPartial({source:TrackSource.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:TrackType.AUDIO});S.addSubscribedMediaTrack(b,_.sid,new MediaStream([b])),v.tracks=[...v.tracks,_]}S.updateInfo(v)}}emit(s){for(var d=arguments.length,c=new Array(d>1?d-1:0),l=1;l<d;l++)c[l-1]=arguments[l];return s!==RoomEvent.ActiveSpeakersChanged&&livekitLogger.debug("room event ".concat(s),{event:s,args:c}),super.emit(s,...c)}}var CheckStatus;(function(a){a[a.IDLE=0]="IDLE",a[a.RUNNING=1]="RUNNING",a[a.SKIPPED=2]="SKIPPED",a[a.SUCCESS=3]="SUCCESS",a[a.FAILED=4]="FAILED"})(CheckStatus||(CheckStatus={}));class Checker extends eventsExports.EventEmitter{constructor(s,d){let c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.status=CheckStatus.IDLE,this.logs=[],this.errorsAsWarnings=!1,this.url=s,this.token=d,this.name=this.constructor.name,this.room=new Room(c.roomOptions),this.connectOptions=c.connectOptions,c.errorsAsWarnings&&(this.errorsAsWarnings=c.errorsAsWarnings)}async run(s){if(this.status!==CheckStatus.IDLE)throw Error("check is running already");this.setStatus(CheckStatus.RUNNING),this.appendMessage("".concat(this.name," started."));try{await this.perform()}catch(d){d instanceof Error&&(this.errorsAsWarnings?this.appendWarning(d.message):this.appendError(d.message))}return await this.disconnect(),await new Promise(d=>setTimeout(d,500)),this.status!==CheckStatus.SKIPPED&&this.setStatus(this.isSuccess()?CheckStatus.SUCCESS:CheckStatus.FAILED),s&&s(),this.getInfo()}isSuccess(){return!this.logs.some(s=>s.level==="error")}async connect(){return this.room.state===ConnectionState.Connected?this.room:(await this.room.connect(this.url,this.token),this.room)}async disconnect(){this.room&&this.room.state!==ConnectionState.Disconnected&&(await this.room.disconnect(),await new Promise(s=>setTimeout(s,500)))}skip(){this.setStatus(CheckStatus.SKIPPED)}appendMessage(s){this.logs.push({level:"info",message:s}),this.emit("update",this.getInfo())}appendWarning(s){this.logs.push({level:"warning",message:s}),this.emit("update",this.getInfo())}appendError(s){this.logs.push({level:"error",message:s}),this.emit("update",this.getInfo())}setStatus(s){this.status=s,this.emit("update",this.getInfo())}get engine(){var s;return(s=this.room)===null||s===void 0?void 0:s.engine}getInfo(){return{logs:this.logs,name:this.name,status:this.status,description:this.description}}}const Rendering=lib$2.LiveApiModel.Rendering,VideoRendering=lib$2.LiveApiModel.VideoRendering,AudioRendering=lib$2.LiveApiModel.AudioRendering,RenderingQuality=lib$2.LiveApiModel.RenderingQuality,Encoding=lib$2.LiveApiModel.Encoding,VideoEncoding=lib$2.LiveApiModel.VideoEncoding,AudioEncoding=lib$2.LiveApiModel.AudioEncoding,ProjectBroadcastPhase=lib$2.LiveApiModel.ProjectBroadcastPhase,Role=lib$2.LiveApiModel.Role,DestinationAddress=lib$2.LiveApiModel.DestinationAddress,VideoCodec=lib$2.LiveApiModel.VideoCodec,AudioCodec=lib$2.LiveApiModel.AudioCodec,VideoCodecRateControl=lib$2.LiveApiModel.VideoCodecRateControl,VideoCodecProfile=lib$2.LiveApiModel.VideoCodecProfile;var types$1=Object.freeze(Object.defineProperty({__proto__:null,Rendering,VideoRendering,AudioRendering,RenderingQuality,Encoding,Role,DestinationAddress,VideoEncoding,AudioEncoding,VideoCodec,AudioCodec,VideoCodecRateControl,VideoCodecProfile,ProjectBroadcastPhase},Symbol.toStringTag,{value:"Module"})),Permission=(a=>(a[a.ReadProject=0]="ReadProject",a[a.UpdateProject=1]="UpdateProject",a[a.JoinRoom=2]="JoinRoom",a[a.InviteGuests=3]="InviteGuests",a[a.ManageGuests=4]="ManageGuests",a[a.ManageBroadcast=5]="ManageBroadcast",a[a.ManageSelf=6]="ManageSelf",a))(Permission||{});const permissions={[Role.ROLE_HOST]:[0,1,2,3,4,5],[Role.ROLE_COHOST]:[0,1,2,3,4,5],[Role.ROLE_CONTRIBUTOR]:[0,1,2,3],[Role.ROLE_GUEST]:[0,2,6],[Role.ROLE_VIEWER]:[0,2],[Role.ROLE_IMPERSONATE]:[0,1,3,4,5]},hasPermission=(a,s)=>{var d;return a?Boolean((d=permissions[a])==null?void 0:d.find(c=>c===s)):!1};var DataType=(a=>(a.ChatMessage="ChatMessage",a.ParticipantMetadataUpdate="ParticipantMetadataUpdate",a))(DataType||{}),SpecialEvent=(a=>(a.Chat="Chat",a))(SpecialEvent||{});const decoder$1=new TextDecoder,encoder$1=new TextEncoder;class RoomsManager{constructor(){this.rooms=new Map,this.addRoom=this.addRoom.bind(this),this.ensureRoom=this.ensureRoom.bind(this),this.removeRoom=this.removeRoom.bind(this)}addRoom(s,d,c){const l=new RoomContext(s,d,c,this);return this.rooms.set(d,l),l}ensureRoom(s,d,c){return this.rooms.get(d)?(this.rooms.get(d).token=c,this.rooms.get(d)):this.addRoom(s,d,c)}async removeRoom(s){const d=this.rooms.get(s);if(!Room)throw new Error("room not found!");if(d.isConnecting)throw new Error("Cannot remove room: Room is in connecting state");d.livekitRoom&&await d.livekitRoom.disconnect(!0),this.rooms.delete(s)}}class RoomContext{constructor(s,d,c,l){let p=CoreContext.logLevel.toLowerCase();setLogLevel(p),this.livekitRoom=new Room({dynacast:!0,videoCaptureDefaults:{resolution:VideoPresets.h720.resolution}}),this._baseUrl=s,this._connectListeners=[],this._roomEventListenerRegistry={},this._jwt=c,Object.values(RoomEvent).forEach(h=>{this._roomEventListenerRegistry[h]=new Set}),this._localParticipantEventListenerRegistry={},Object.values(ParticipantEvent).forEach(h=>{this._localParticipantEventListenerRegistry[h]=new Set}),this._specialEventListenerRegistry={},this._manager=l,this._chatHistory=[],this.roomName=d,this.audioTracks=[],this.participants=[],this.guestParticipantMetadata=[],this.isConnecting=!1,this.subscribeToRoomEvent(RoomEvent.DataReceived,(h,v,S)=>{var I;const b=decoder$1.decode(h);switch(JSON.parse(b).type){case"ChatMessage":return this._appendChat(h,v,S);case"ParticipantMetadataUpdate":{const T=decoder$1.decode(h),k=JSON.parse(T);hasPermission((I=k==null?void 0:k.metadata)==null?void 0:I.participantRole,Permission.ManageSelf)&&this._updateGuestParticipantsStore(k);return}default:return}}),this.connect=this.connect.bind(this),this.subscribeToRoomEvent=this.subscribeToRoomEvent.bind(this),this.subscribeToConnect=this.subscribeToConnect.bind(this),this.subscribeToLocalParticipantEvent=this.subscribeToLocalParticipantEvent.bind(this),this.subscribeToSpecialEvent=this.subscribeToSpecialEvent.bind(this),this.unsubscribeFromRoomEvent=this.unsubscribeFromRoomEvent.bind(this),this.unsubscribeFromSpecialEvent=this.unsubscribeFromSpecialEvent.bind(this),this.unsubscribeFromConnect=this.unsubscribeFromConnect.bind(this),this.unsubscribeFromLocalParticipantEvent=this.unsubscribeFromLocalParticipantEvent.bind(this),this.sendChatMessage=this.sendChatMessage.bind(this),this.kickParticipant=this.kickParticipant.bind(this),this.updateParticipant=this.updateParticipant.bind(this),this.muteTrackAsAdmin=this.muteTrackAsAdmin.bind(this),this._updateParticipants=this._updateParticipants.bind(this),this.subscribeToRoomEvent(RoomEvent.ParticipantConnected,this._updateParticipants),this.subscribeToRoomEvent(RoomEvent.ParticipantDisconnected,this._updateParticipants),this.subscribeToRoomEvent(RoomEvent.TrackSubscribed,this._updateParticipants),this.subscribeToRoomEvent(RoomEvent.TrackUnsubscribed,this._updateParticipants),this.subscribeToRoomEvent(RoomEvent.LocalTrackPublished,this._updateParticipants),this.subscribeToRoomEvent(RoomEvent.LocalTrackUnpublished,this._updateParticipants),this.subscribeToRoomEvent(RoomEvent.Disconnected,()=>{this._updateParticipants()}),this.subscribeToRoomEvent(RoomEvent.ParticipantMetadataChanged,(h,v)=>{if(h!==(v==null?void 0:v.metadata)){const S=JSON.parse(v==null?void 0:v.metadata);if(hasPermission(S==null?void 0:S.participantRole,Permission.ManageSelf)){if(S.hasOwnProperty("isMirrored")){const b={participantId:v==null?void 0:v.identity,metadata:S,type:"ParticipantMetadataUpdate"};this._updateGuestParticipantsStore(b)}return}}})}bindApiClient(s){this._apiClient=s}get isAdmin(){return o(this._jwt).video.roomAdmin}set isAdmin(s){log$1.warn("isAdmin cannot be set")}get token(){return this._jwt}set token(s){this._jwt=s}get url(){return this._baseUrl}set url(s){}get chatHistory(){return this._chatHistory}set chatHistory(s){this._chatHistory=s}_updateGuestParticipantsStore(s){if(!this.guestParticipantMetadata.length)this.guestParticipantMetadata.push(s);else{const d=this.guestParticipantMetadata.findIndex(c=>c.participantId===(s==null?void 0:s.participantId));d>-1?this.guestParticipantMetadata[d]=s:this.guestParticipantMetadata.push(s)}}_updateParticipants(){if(!this.livekitRoom||this.livekitRoom.state===ConnectionState.Disconnected){this.participants=[];return}else{const s=Array.from(this.livekitRoom.participants.values()),d=[this.livekitRoom.localParticipant];d.push(...s),this.guestParticipantMetadata=this.guestParticipantMetadata.filter(c=>d.find(l=>(l==null?void 0:l.identity)===(c==null?void 0:c.participantId))),this.participants=d}}async kickParticipant(s){if(this._admin)this._admin.removeParticipant(this.roomName,s);else throw new Error("no admin permissions")}updateParticipant(s,d){if(this._admin){const c=JSON.stringify(d);this._admin.updateParticipant(this.roomName,s,c)}else throw new Error("no admin permissions")}muteTrackAsAdmin(s,d=!0){if(this._admin){const c=this.participants.find(l=>[...l.audioTracks.values(),...l.videoTracks.values()].find(p=>p.trackSid===s));if(!c){log$1.warn("Could not find participant for track:",{trackSid:s});return}this._admin.mutePublishedTrack(this.roomName,c==null?void 0:c.identity,s,d)}else throw new Error("no admin permissions")}_appendChat(s,d,c){const l=decoder$1.decode(s),p=JSON.parse(l),h=d.identity,v=d.name,S={...p,displayName:v,sender:h};this.chatHistory=[...this.chatHistory,S],this._triggerSpecialEvents("Chat",S)}subscribeToConnect(s){return this._connectListeners.push(s),()=>this.unsubscribeFromConnect(s)}unsubscribeFromConnect(s){this._connectListeners=this._connectListeners.filter(d=>d!==s)}subscribeToSpecialEvent(s,d){return this._specialEventListenerRegistry[s]||(this._specialEventListenerRegistry[s]=new Set),this._specialEventListenerRegistry[s].add(d),()=>{this.unsubscribeFromSpecialEvent(s,d)}}unsubscribeFromSpecialEvent(s,d){this._specialEventListenerRegistry[s]||(this._specialEventListenerRegistry[s]=new Set),this._specialEventListenerRegistry[s].delete(d)}_triggerSpecialEvents(s,...d){this._specialEventListenerRegistry[s]||(this._specialEventListenerRegistry[s]=new Set),this._specialEventListenerRegistry[s].forEach(c=>{c(...d)})}async connect(s={}){var d,c;try{if(this.livekitRoom.state==="connected"||this.isConnecting)return;this.isConnecting=!0,await this.livekitRoom.connect(`wss://${this._baseUrl}`,this._jwt,{...s}),this.isConnecting=!1,Object.values(RoomEvent).forEach(l=>{this.livekitRoom.on(l,(...p)=>{this._roomEventListenerRegistry[l].forEach(h=>{h(...p)})})}),Object.values(ParticipantEvent).forEach(l=>{this.livekitRoom.localParticipant.on(l,(...p)=>{this._localParticipantEventListenerRegistry[l].forEach(h=>{h(...p)})})}),this._updateParticipants(),this._connectListeners.forEach(l=>l(this.livekitRoom)),lib$2.LiveKitUtils.isRoomAdmin(this._jwt)?(log$1.info("Room: Granting admin permissions"),log$1.debug("Livekit server: ",(d=this._apiClient)==null?void 0:d.getLiveKitServer(!0)),this._admin=new dist.RoomServiceClient((c=this._apiClient)==null?void 0:c.getLiveKitServer(!0),void 0,void 0,this._jwt)):log$1.debug("Room: Not an admin")}catch(l){this.isConnecting=!1,log$1.error(l)}}subscribeToLocalParticipantEvent(s,d){return this._localParticipantEventListenerRegistry[s]||(this._localParticipantEventListenerRegistry[s]=new Set),this._localParticipantEventListenerRegistry[s].add(d),()=>{this.unsubscribeFromLocalParticipantEvent(s,d)}}unsubscribeFromLocalParticipantEvent(s,d){this._localParticipantEventListenerRegistry[s]||(this._localParticipantEventListenerRegistry[s]=new Set),this._localParticipantEventListenerRegistry[s].delete(d)}subscribeToRoomEvent(s,d){return this._roomEventListenerRegistry[s]||(this._roomEventListenerRegistry[s]=new Set),this._roomEventListenerRegistry[s].add(d),()=>{this.unsubscribeFromRoomEvent(s,d)}}unsubscribeFromRoomEvent(s,d){this._roomEventListenerRegistry[s]||(this._roomEventListenerRegistry[s]=new Set),this._roomEventListenerRegistry[s].delete(d)}sendChatMessage(s){const{message:d,recipients:c,metadata:l}=s;if(!this.livekitRoom||this.livekitRoom.state!=="connected")return;const p={type:"ChatMessage",recipients:c,metadata:l,content:d,timestamp:Date.now()},h=JSON.stringify(p),v=encoder$1.encode(h);if({...p,sender:this.livekitRoom.localParticipant.identity,displayName:this.livekitRoom.localParticipant.identity},Boolean(c)){const S=c.map(this.livekitRoom.getParticipantByIdentity);return this.livekitRoom.localParticipant.publishData(v,DataPacket_Kind.RELIABLE,S).then(()=>{this._appendChat(v,this.livekitRoom.localParticipant,DataPacket_Kind.RELIABLE)})}else return this.livekitRoom.localParticipant.publishData(v,DataPacket_Kind.RELIABLE).then(()=>{this._appendChat(v,this.livekitRoom.localParticipant,DataPacket_Kind.RELIABLE)})}}const webrtcManager=new RoomsManager;var index$2=Object.freeze(Object.defineProperty({__proto__:null,webrtcManager},Symbol.toStringTag,{value:"Module"}));const encoder=new TextEncoder,decoder=new TextDecoder,simpleRooms=new Map,getRoom=a=>{if(!a)return null;if(simpleRooms.get(a))return simpleRooms.get(a);const s=webrtcManager.rooms.get(a);if(!s)return null;const d=s.livekitRoom,c=d==null?void 0:d.localParticipant;window.__StudioRoom=d,c||log$1.warn("No local participant!");const l={useTracks:new Set,useTrack:new Map,useParticipants:new Set,useParticipant:new Map,useChatHistory:new Set};let p={tracks:[],participants:[],result:{participants:[],tracks:[]},chat:s.chatHistory};const h=()=>{const P=s.participants,$=s.guestParticipantMetadata,U=P.flatMap(D=>D.getTracks().map(F=>({...F,participant:D}))),E={participants:P.map(D=>{const F=$.find(G=>G.participantId===D.identity);if(F){let G=JSON.parse(D.metadata);G={...G,...F.metadata},D.metadata=JSON.stringify(G)}const J=JSON.parse(D.metadata);return{id:D.identity,isSelf:D===c,connectionQuality:D.connectionQuality,displayName:J.displayName||D.name,joinedAt:D.joinedAt,role:J.participantRole,meta:J,trackIds:U.filter(G=>G.participant.sid===D.sid).map(G=>G.trackSid)}}),tracks:U.map(D=>{var J,G,x,Y;const F=JSON.parse((J=D==null?void 0:D.participant)==null?void 0:J.metadata);return{mediaStreamTrack:(G=D.track)==null?void 0:G.mediaStreamTrack,id:D.trackSid,participantId:(x=D.participant)==null?void 0:x.identity,isMuted:(Y=D.track)==null?void 0:Y.isMuted,type:D.source,isExternal:Boolean(F==null?void 0:F[D.trackSid])}})};p={tracks:U,participants:P,result:E,chat:s.chatHistory},l.useTracks.forEach(D=>D(E.tracks)),l.useTrack.forEach((D,F)=>{F(b(D))}),l.useParticipants.forEach(D=>D(E.participants)),l.useParticipant.forEach((D,F)=>{F(_(D))}),l.useChatHistory.forEach(D=>{D(p.chat)})},v=[RoomEvent.ParticipantConnected,RoomEvent.ParticipantDisconnected,RoomEvent.ParticipantMetadataChanged,RoomEvent.Disconnected,RoomEvent.TrackSubscribed,RoomEvent.TrackUnsubscribed,RoomEvent.LocalTrackPublished,RoomEvent.LocalTrackUnpublished,RoomEvent.ConnectionQualityChanged,RoomEvent.TrackMuted,RoomEvent.TrackUnmuted,RoomEvent.TrackStreamStateChanged];s.subscribeToRoomEvent(RoomEvent.DataReceived,(P,$,U)=>{const E=decoder.decode(P);JSON.parse(E).type===DataType.ParticipantMetadataUpdate&&h()}),v.map(P=>s.subscribeToRoomEvent(P,()=>h())).push(s.subscribeToSpecialEvent(SpecialEvent.Chat,h));const b=P=>p.result.tracks.find($=>$.id===P),_=P=>p.result.participants.find($=>$.id===P),I=(P,$)=>{const U=c.getTracks().find(E=>E.trackSid===P);U&&($?U.mute():U.unmute())};let T,k;const w={id:s.roomName,participantId:c.identity,setTrackEnabled:I,setCameraEnabled:(P=!0)=>c.setCameraEnabled(P),setMicrophoneEnabled:(P=!0)=>c.setMicrophoneEnabled(P),setCamera:async(P={})=>{var U;if(T){log$1.warn("Cannot set camera until previous has resolved");return}T=!0;let $;try{const D=c.getTracks().filter(J=>(J==null?void 0:J.source)===Track.Source.Camera).find(J=>!b(J==null?void 0:J.trackSid).isExternal),F=await c.createTracks({video:{deviceId:P.deviceId,resolution:P.resolution||{width:1280,height:720,frameRate:30,aspectRatio:16/9}}});D!=null&&D.isMuted&&F.forEach(J=>{J.mute()}),$=await Promise.all(F.map(J=>c.publishTrack(J))),D&&c.unpublishTrack(D.track)}catch(E){throw E}finally{return T=!1,b((U=$[0])==null?void 0:U.trackSid)}},setMicrophone:async P=>{var U;if(k){log$1.warn("Cannot set microphone until previous has resolved");return}k=!0;let $;try{const D=c.getTracks().filter(J=>J.source===Track.Source.Microphone).find(J=>!b(J==null?void 0:J.trackSid).isExternal),F=await c.createTracks({audio:P||!0});D!=null&&D.isMuted&&F.forEach(J=>{J.mute()}),$=await Promise.all(F.map(J=>c.publishTrack(J))),D&&c.unpublishTrack(D.track)}catch(E){throw E}finally{return k=!1,b((U=$[0])==null?void 0:U.trackSid)}},addMicrophone:async P=>{var F;if(k){log$1.warn("Cannot set microphone until previous has resolved");return}k=!0;const $=await c.createTracks({audio:P||!0}),E=c.getTracks().filter(J=>J.source===Track.Source.Microphone).find(J=>{var x,Y;const G=b(J==null?void 0:J.trackSid);((Y=(x=G==null?void 0:G.mediaStreamTrack)==null?void 0:x.getSettings())==null?void 0:Y.deviceId)===P.deviceId&&(G==null||G.isExternal)});E!=null&&E.isMuted&&$.forEach(J=>{J.mute()});const D=await Promise.all($.map(J=>c.publishTrack(J)));return E&&c.unpublishTrack(E.track),k=!1,b((F=D[0])==null?void 0:F.trackSid)},addCamera:async(P={})=>{var D;const $=await c.createTracks({video:{deviceId:P.deviceId,resolution:P.resolution||{width:1280,height:720,frameRate:30,aspectRatio:1.7777777777777777}}}),U=c.getTracks().find(F=>{var J,G,x;return(F==null?void 0:F.source)===Track.Source.Camera&&((x=(G=(J=F==null?void 0:F.track)==null?void 0:J.mediaStreamTrack)==null?void 0:G.getSettings())==null?void 0:x.deviceId)===P.deviceId});U!=null&&U.isMuted&&$.forEach(F=>{F.mute()});const E=await Promise.all($.map(F=>c.publishTrack(F)));return U&&c.unpublishTrack(U.track),k=!1,b((D=E[0])==null?void 0:D.trackSid)},addScreen:async(P={audio:!1})=>{const $=await c.createScreenTracks(P),U=await Promise.all($.map(F=>c.publishTrack(F))),E=U.find(F=>F.kind==="video"),D=U.find(F=>F.kind==="audio");return{screen:b(E==null?void 0:E.trackSid),audio:b(D==null?void 0:D.trackSid)}},removeTrack:async P=>{const $=p.tracks.find(U=>U.trackSid===P);c.unpublishTrack($.track)},setLocalParticipantMetadata:async(P,$)=>{const U=JSON.stringify($),E=encoder.encode(JSON.stringify({metadata:$,type:DataType.ParticipantMetadataUpdate,participantId:P}));return c.setMetadata(U),await c.publishData(E,DataPacket_Kind.RELIABLE)},setParticipantMetadata:(P,$)=>s.updateParticipant(P,$),kickParticipant:s.kickParticipant,muteTrackAsAdmin:s.muteTrackAsAdmin,sendChatMessage:s.sendChatMessage,getTracks:()=>p.result.tracks,useTracks:P=>(l.useTracks.add(P),P(p.result.tracks),()=>{l.useTracks.delete(P)}),getTrack:b,useTrack:(P,$)=>(l.useTrack.set($,P),$(b(P)),()=>{l.useTrack.delete($)}),getParticipant:_,getParticipants:()=>p.result.participants,useParticipants:P=>(l.useParticipants.add(P),P(p.result.participants),()=>{l.useParticipants.delete(P)}),useParticipant:(P,$)=>(l.useParticipant.set($,P),$(_(P)),()=>{l.useTrack.delete($)}),useChatHistory:P=>(l.useChatHistory.add(P),P(p.chat),()=>{l.useChatHistory.delete(P)}),useActiveSpeakers:P=>{var U,E;const $=D=>{P(D.map(F=>F.identity))};return(U=s.livekitRoom)==null||U.on(RoomEvent.ActiveSpeakersChanged,$),$((E=s.livekitRoom)==null?void 0:E.activeSpeakers),()=>{var D;(D=s.livekitRoom)==null||D.off(RoomEvent.ActiveSpeakersChanged,$)}},sendData:(P,$)=>{const U=encoder.encode(JSON.stringify(P)),E=$==null?void 0:$.map(D=>{var F,J;return(J=(F=s.livekitRoom)==null?void 0:F.getParticipantByIdentity(D))==null?void 0:J.sid}).filter(Boolean);return c.publishData(U,DataPacket_Kind.RELIABLE,E)},onData:P=>{var U;const $=(E,D)=>{const F=JSON.parse(decoder.decode(E));P(F,D==null?void 0:D.identity)};return(U=s.livekitRoom)==null||U.on(RoomEvent.DataReceived,$),()=>{var E;(E=s.livekitRoom)==null||E.off(RoomEvent.DataReceived,$)}},connect:()=>s.connect(),disconnect:()=>{var P;return(P=s.livekitRoom)==null?void 0:P.disconnect()},onDisconnected:P=>{var $;return($=s.livekitRoom)==null||$.on(RoomEvent.Disconnected,P),()=>{var U;(U=s.livekitRoom)==null||U.off(RoomEvent.DataReceived,P)}},setAudioOutput:P=>{var $;return($=s.livekitRoom)==null?void 0:$.switchActiveDevice("audiooutput",P)}};return h(),simpleRooms.set(a,w),w},{state:state$2}=CoreContext,getAccessTokenData=()=>{var a;return((a=CoreContext.clients.accessTokenClaims)==null?void 0:a.user)||{}},getBaseUser=()=>state$2.user?{id:state$2.user.id,props:state$2.user.props,name:state$2.user.name,projects:state$2.projects.map(toBaseProject),sources:state$2.sources.map(toBaseSource)}:null,toBaseProject=a=>{const{compositor:s,videoApi:d,props:c={},role:l}=a,{destinations:p,encoding:h,rendering:v,sources:S}=d.project,b={get:s.get,getRoot:s.getRoot,getParent:s.getParent};Object.defineProperty(b,"nodes",{get(){return s.nodes.filter(T=>!T._deleted)}});const _=a.videoApi.phase,I=a.videoApi.broadcastId||null;return{broadcastPhase:_,role:l,broadcastId:I,isLive:[ProjectBroadcastPhase.PROJECT_BROADCAST_PHASE_RUNNING,ProjectBroadcastPhase.PROJECT_BROADCAST_PHASE_STOPPING].includes(_),scene:b,joinRoom:async(T={})=>CoreContext.Command.joinRoom({projectId:a.id,...T}),subscribe:T=>CoreContext.subscribe((k,w)=>{w.projectId&&(w==null?void 0:w.projectId)===a.id&&T(k,w)}),destinations:p.map(toBaseDestination),sources:S.map(toBaseSource),encoding:h,rendering:v,id:a.id,hostDisplayName:a.props.hostDisplayName,props:c}},toBaseDestination=a=>{var s;return{id:a.destinationId,enabled:a.enabled,address:a.address,props:((s=a.metadata)==null?void 0:s.props)||(a==null?void 0:a.metadata)||{}}},toBaseSource=a=>{var s;return{id:a.sourceId,address:a.address,props:((s=a.metadata)==null?void 0:s.props)||{}}},hydrateProject=async(a,s,d)=>{const c=a.metadata||{},l={collectionId:a.collectionId,projectId:a.projectId,updateMask:[]};hasPermission(s,Permission.ManageBroadcast)&&a.composition.studioSdk.version!==CoreContext.rendererVersion&&(l.composition={studioSdk:{version:CoreContext.rendererVersion}},l.updateMask.push("composition.studioSdk.version")),d&&(l.rendering={video:{width:d.x,height:d.y,framerate:30}},l.updateMask.push("rendering")),l.updateMask.length&&await CoreContext.clients.LiveApi().project.updateProject(l);const h=await layoutToProject(c.layoutId,d);return{id:a.projectId,compositor:h,role:s,videoApi:{project:a,phase:ProjectBroadcastPhase.PROJECT_BROADCAST_PHASE_UNSPECIFIED},layoutApi:{layoutId:c.layoutId},props:(c==null?void 0:c.props)||c}},sceneNodeToLayer=a=>{const{id:s,props:d={},children:c=[]}=a;return{...s?{id:s}:{},type:d.type,data:{...d},children:c.map(l=>l.id)}},nodeToLayer=a=>({id:a.id,type:a.props.type,data:{...a.props},children:a.childIds.map(s=>s)}),layerToNode=a=>({id:String(a.id),props:{type:a.type,...a.data},childIds:a.children.map(s=>String(s))}),layoutToProject=async(a,s)=>{const{layers:d}=await CoreContext.clients.LayoutApi().layer.listLayers({layoutId:a});if(s&&d){const{x:h,y:v}=s,S=d==null?void 0:d.reduce((b,_)=>b?b.data.isRoot?b:_.data.isRoot||!d.some(I=>I.children.includes(_.id))?_:b:_,null);if(S){const b=await CoreContext.clients.LayoutApi().layer.updateLayer({layoutId:S.layoutId,layerId:S.id,layer:{x:h,y:v,data:{...S.data,size:{x:h,y:v}}}}),_=d.findIndex(I=>I.id===b.id);d[_]=b}}const c=d.map(layerToNode),l=c.reduce((h,v)=>h?h.props.isRoot?h:v.props.isRoot||!c.some(S=>S.childIds.includes(v.id))?v:h:v,null),p=l?toSceneTree(c,l.id):null;return CoreContext.compositor.loadProject(p,a)},getUser=()=>{const a=state$2.user;if(!a)throw new Error("User not loaded");return a},getProject=a=>state$2.projects.find(s=>s.id===a),getProjectByLayoutId=a=>state$2.projects.find(s=>s.compositor.id===a),getProjectRoom=a=>{var s;return getRoom((s=getProject(a))==null?void 0:s.roomId)},{connectionId}=CoreContext,latestUpdateVersion={},getNextNodeVersion=a=>(latestUpdateVersion[a]||(latestUpdateVersion[a]=0),++latestUpdateVersion[a]),request=(a,s)=>{const d=s.map(c=>{const[l,p]=c;return{[l]:p}});return log$1.debug("Batch request",d),CoreContext.clients.LayoutApi().layer.batch({layoutId:a,layers:d,requestMetadata:{connectionId,layoutId:a,updateVersions:s.filter(([c])=>c==="update").map(([c,l])=>({[l.id]:getNextNodeVersion(l.id)})).reduce((c,l)=>({...l,...c}),{})}})},compositorAdapter=(a,s)=>({async insert(d={},c,l){const p=nodeToLayer({id:null,props:d,childIds:[]});c?p.type="child":p.type="root",log$1.debug("Insert layer",p);const h=await CoreContext.clients.LayoutApi().layer.createLayer({layoutId:a,layer:{...p,requestMetadata:{connectionId,layoutId:a}}});if(h.code)throw new Error(h.message);const v=await s.get(c);if(c&&!v)throw Error("Parent not found with ID");if(v){const S=nodeToLayer(v),b=insertAt$1(l,h.id,S.children),_={layoutId:a,layerId:S.id,layer:{children:b,requestMetadata:{connectionId,layoutId:a,updateVersion:{[p.id]:getNextNodeVersion(p.id)}}}};await CoreContext.clients.LayoutApi().layer.updateLayer(_)}return String(h.id)},async update(d,c={}){const l=s.get(d),p=nodeToLayer({...l,props:{...l.props,...c}}),h={layoutId:a,layerId:p.id,layer:{...p,requestMetadata:{connectionId,layoutId:a,updateVersions:{[p.id]:getNextNodeVersion(p.id)}}}};log$1.debug("Update layer",h),await CoreContext.clients.LayoutApi().layer.updateLayer(h)},async remove(d){const c=await s.getParent(d);if(c){const l=nodeToLayer(c),p=l.children.filter(v=>v!==d),h={layoutId:a,layerId:l.id,layer:{children:p,requestMetadata:{connectionId,layoutId:a,updateVersions:{[l.id]:getNextNodeVersion(l.id)}}}};await CoreContext.clients.LayoutApi().layer.updateLayer(h)}await CoreContext.clients.LayoutApi().layer.deleteLayer({layoutId:a,layerId:d,payload:{requestMetadata:{connectionId,layoutId:a}}})},async reorder(d,c){const l=s.get(d),p=nodeToLayer({...l,childIds:c});log$1.debug("Reorder layer children",p),await CoreContext.clients.LayoutApi().layer.updateLayer({layoutId:a,layerId:p.id,layer:{children:p.children,requestMetadata:{connectionId,layoutId:a,updateVersions:{[p.id]:getNextNodeVersion(p.id)}}}})},async move(d,c,l){const p=s.get(d),h=s.get(s.getParent(d).id),v=nodeToLayer({...h,childIds:pull$2(h.childIds,p.id)}),S=s.get(c),b=nodeToLayer({...S,childIds:insertAt$1(l,p.id,S.childIds)});log$1.debug("Move layers"),await Promise.all([CoreContext.clients.LayoutApi().layer.updateLayer({layoutId:a,layerId:v.id,layer:{children:v.children,requestMetadata:{connectionId,layoutId:a,updateVersions:{[v.id]:getNextNodeVersion(v.id)}}}}),CoreContext.clients.LayoutApi().layer.updateLayer({layoutId:a,layerId:b.id,layer:{children:b.children,requestMetadata:{connectionId,layoutId:a,updateVersions:{[b.id]:getNextNodeVersion(b.id)}}}})])},async batch(d){const c=d.map(([p,h])=>[p,sceneNodeToLayer(h)]),l=await request(a,c);return log$1.debug("Batch response",l),l}});var config$1=a=>({defaults:{previewTokenDuration:1e3*60*60,guestTokenDuration:1e3*60*60*12,transforms:{RoomParticipant:"LS-Room-Participant",Image:"LS-Image",Banner:"LS-Banner",Text:"LS-Text"}}});const RoomParticipant$1={name:"LS-Room-Participant",sourceType:"RoomParticipant",props:{isMuted:{type:Boolean,required:!1,default:!1},volume:{type:Number,required:!1,default:1}},useSource(a,s){return a.find(d=>isMatch(d.props,s.sourceProps))},create({onUpdate:a,onNewSource:s,onRemove:d},c){const l=document.createElement("div"),p=getProject(CoreContext.state.activeProjectId),h=getProjectRoom(CoreContext.state.activeProjectId);Object.assign(l.style,{position:"relative"});let v,S=c;const b=(T,k)=>{const w=T/k.width;return w>=.5?3:w>.25?2:w>.15?1:0},_=({props:T,source:k})=>{var G,x,Y;const w=React.useRef(),{volume:P=1,isHidden:$=!1}=T||{},[U,E]=React.useState(0),F=(k==null?void 0:k.id)===(h==null?void 0:h.participantId)||((G=k==null?void 0:k.props)==null?void 0:G.participantId)===(h==null?void 0:h.participantId)||(T==null?void 0:T.isMuted),J=!(T!=null&&T.isHidden)&&((x=k==null?void 0:k.props)==null?void 0:x.videoEnabled);return React.useEffect(()=>{!w.current||(w.current.play().catch(N=>{document.addEventListener("click",()=>{var z;return(z=w.current)==null?void 0:z.play()},{once:!0})}),(k==null?void 0:k.value)&&(k==null?void 0:k.value)!==w.current.srcObject?w.current.srcObject=k==null?void 0:k.value:k!=null&&k.value||(w.current.srcObject=null))},[w.current,k==null?void 0:k.value]),React.useEffect(()=>{!T&&w.current&&(w.current.srcObject=null,w.current=null)},[T]),React.useLayoutEffect(()=>{if(!w.current)return;const N=()=>{const Z=w.current;Z&&E(b(Z.clientWidth,{width:p.compositor.getRoot().props.size.x,height:p.compositor.getRoot().props.size.y}))},z=new ResizeObserver(Z=>{N()});return N(),z==null||z.observe(w.current),()=>{w.current&&(z==null||z.unobserve(w.current),w.current.srcObject=null)}},[w.current,p]),React.useEffect(()=>{!w.current||(w.current.volume=P)},[w.current,P]),React__default.default.createElement("div",{style:{position:"relative",display:"flex",height:"100%",width:"100%"}},React__default.default.createElement("div",{style:{background:"#222",position:"absolute",height:"100%",width:"100%",fontSize:"43px",color:"rgba(255,255,255,0.6)",display:"flex",alignItems:"center",justifyContent:"center",opacity:J?"0":"1"}},(k==null?void 0:k.props.displayName)&&React__default.default.createElement("div",{style:{borderRadius:"50%",background:"#555",width:"70px",height:"70px",textTransform:"uppercase",display:"flex",alignItems:"center",justifyContent:"center",lineHeight:"1em"}},(k==null?void 0:k.props.displayName.slice(0,1))||"")),React__default.default.createElement("div",{style:{position:"relative",display:"flex",height:"100%",width:"100%",...Boolean((Y=k==null?void 0:k.props)==null?void 0:Y.mirrored)&&{transform:"scaleX(-1)"}}},React__default.default.createElement("video",{ref:w,autoPlay:!0,muted:F,disablePictureInPicture:!0,playsInline:!0,style:{left:"50%",top:"50%",position:"relative",transform:"translate3d(-50%, -50%, 0)",height:"100%",opacity:J?"1":"0",objectFit:(k==null?void 0:k.props.type)==="screen"?"contain":"cover",background:"rgba(0,0,0,0.6)"}})),(k==null?void 0:k.props.displayName)&&React__default.default.createElement("div",{className:"NameBannerContainer",style:{width:"100%",height:"100%",position:"absolute"}},React__default.default.createElement("div",{className:"NameBanner","data-size":U,style:{padding:"12px 30px",width:"fit-content",height:"fit-content",top:"100%",transform:"translateY(-100%)",left:0}},React__default.default.createElement("div",{className:"NameBanner-body"},k.props.displayName))))},I=()=>ReactDOM__default.default.render(React__default.default.createElement(_,{source:v,props:S}),l);return a(T=>{S=T,I()}),s(T=>{v=T,I()}),d(T=>{S=T,I()}),{root:l}}},Square={name:"LS-Square",props:{color:{default:"green"}},create({onUpdate:a}){const s=document.createElement("div");return a(({color:d})=>{Object.assign(s.style,{width:"100%",height:"100%",background:d||"red"})}),{root:s}}},Image$1={name:"LS-Image",props:{src:{},fit:{}},create({onUpdate:a}){const s=document.createElement("img");return a(({src:d,fit:c})=>{s.setAttribute("src",d),Object.assign(s.style,{width:"100%",height:"100%",objectFit:c})}),{root:s}}},Element={name:"Element",sourceType:"Element",create({onUpdate:a},{tagName:s}){const d=document.createElement(s);return a(({tagName:c,attributes:l={},fields:p={}})=>{c==="img"?(d==null?void 0:d.src)!==l.src&&Object.keys(l).forEach(h=>{d.setAttribute(h,l[h])}):Object.keys(l).forEach(h=>{d.setAttribute(h,l[h])}),Object.keys(p).forEach(h=>{Object.assign(d[h],p[h])})}),{root:d}}},Video={name:"LS-Video",sourceType:"LS-Video",create({onUpdate:a,onEvent:s,onRemove:d}){d(()=>{clearInterval(l)});const c=document.createElement("video");let l;return a(({attributes:p={},fields:h={},sourceProps:v={},id:S})=>{(c.src!==p.src||c.id!==p.id&&p.id)&&(l&&clearInterval(l),Object.keys(p).forEach(b=>{c.setAttribute(b,p[b])}),c.onloadedmetadata=()=>{p.muted?(c.muted=!0,c.play()):c.muted=!1},l=setInterval(()=>{if(c.duration){const b=c.duration-c.currentTime;trigger$1("VideoTimeUpdate",{category:S,id:v==null?void 0:v.id,time:Math.floor(b)})}},1e3),c.loop=Boolean(p.loop),c.onended=()=>{l&&clearInterval(l),trigger$1("VideoEnded",{id:v==null?void 0:v.id,category:S})},Object.keys(h).forEach(b=>{Object.assign(c[b],h[b])}))}),{root:c}}},Banner$1={name:"LS-Banner",sourceType:"Banner",props:{bannerId:{type:String,required:!0}},useSource(a,s){return a.find(d=>d.id===s.bannerId)},create({onUpdate:a,onNewSource:s},d){const c=document.createElement("div");let l,p,h;const v=({currentSource:b,latestSource:_})=>{const[I,T]=React.useState(!1),{headerText:k,bodyText:w}=(_==null?void 0:_.value)||{};return React.useEffect(()=>{window.setTimeout(()=>{T(Boolean(b))}),b||T(!1)},[b]),React__default.default.createElement("div",{className:"BannerContainer",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"flex-end",transition:"200ms ease all",...I?{zIndex:2,opacity:1,transform:"translateX(0)"}:{zIndex:1,opacity:0,transform:"translateX(-200px)"}}},React__default.default.createElement("div",{className:"Banner",style:{padding:10,background:"orange",width:"fit-content",height:"fit-content",maxWidth:"84%",position:"relative"}},k&&React__default.default.createElement("div",{className:"Banner-header",style:{marginBottom:6}},k),w&&React__default.default.createElement("div",{className:"Banner-body"},w)))},S=()=>ReactDOM__default.default.render(React__default.default.createElement(React__default.default.Fragment,null,h&&h.id!==p.id&&React__default.default.createElement(v,{key:h==null?void 0:h.id,currentSource:null,latestSource:h}),React__default.default.createElement(v,{key:p==null?void 0:p.id,currentSource:l,latestSource:p})),c);return a(()=>{S()}),s(b=>{h=l,l=b,l&&(p=l),S()}),{root:c}}};function _extends(){return _extends=Object.assign?Object.assign.bind():function(a){for(var s=1;s<arguments.length;s++){var d=arguments[s];for(var c in d)Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}return a},_extends.apply(this,arguments)}function _objectWithoutPropertiesLoose(a,s){if(a==null)return{};var d={},c=Object.keys(a),l,p;for(p=0;p<c.length;p++)l=c[p],!(s.indexOf(l)>=0)&&(d[l]=a[l]);return d}function _setPrototypeOf(a,s){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(c,l){return c.__proto__=l,c},_setPrototypeOf(a,s)}function _inheritsLoose(a,s){a.prototype=Object.create(s.prototype),a.prototype.constructor=a,_setPrototypeOf(a,s)}function hasClass(a,s){return a.classList?!!s&&a.classList.contains(s):(" "+(a.className.baseVal||a.className)+" ").indexOf(" "+s+" ")!==-1}function addClass(a,s){a.classList?a.classList.add(s):hasClass(a,s)||(typeof a.className=="string"?a.className=a.className+" "+s:a.setAttribute("class",(a.className&&a.className.baseVal||"")+" "+s))}function replaceClassName(a,s){return a.replace(new RegExp("(^|\\s)"+s+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function removeClass$1(a,s){a.classList?a.classList.remove(s):typeof a.className=="string"?a.className=replaceClassName(a.className,s):a.setAttribute("class",replaceClassName(a.className&&a.className.baseVal||"",s))}var config={disabled:!1},TransitionGroupContext=React__default.default.createContext(null),UNMOUNTED="unmounted",EXITED="exited",ENTERING="entering",ENTERED="entered",EXITING="exiting",Transition=function(a){_inheritsLoose(s,a);function s(c,l){var p;p=a.call(this,c,l)||this;var h=l,v=h&&!h.isMounting?c.enter:c.appear,S;return p.appearStatus=null,c.in?v?(S=EXITED,p.appearStatus=ENTERING):S=ENTERED:c.unmountOnExit||c.mountOnEnter?S=UNMOUNTED:S=EXITED,p.state={status:S},p.nextCallback=null,p}s.getDerivedStateFromProps=function(l,p){var h=l.in;return h&&p.status===UNMOUNTED?{status:EXITED}:null};var d=s.prototype;return d.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},d.componentDidUpdate=function(l){var p=null;if(l!==this.props){var h=this.state.status;this.props.in?h!==ENTERING&&h!==ENTERED&&(p=ENTERING):(h===ENTERING||h===ENTERED)&&(p=EXITING)}this.updateStatus(!1,p)},d.componentWillUnmount=function(){this.cancelNextCallback()},d.getTimeouts=function(){var l=this.props.timeout,p,h,v;return p=h=v=l,l!=null&&typeof l!="number"&&(p=l.exit,h=l.enter,v=l.appear!==void 0?l.appear:h),{exit:p,enter:h,appear:v}},d.updateStatus=function(l,p){l===void 0&&(l=!1),p!==null?(this.cancelNextCallback(),p===ENTERING?this.performEnter(l):this.performExit()):this.props.unmountOnExit&&this.state.status===EXITED&&this.setState({status:UNMOUNTED})},d.performEnter=function(l){var p=this,h=this.props.enter,v=this.context?this.context.isMounting:l,S=this.props.nodeRef?[v]:[ReactDOM__default.default.findDOMNode(this),v],b=S[0],_=S[1],I=this.getTimeouts(),T=v?I.appear:I.enter;if(!l&&!h||config.disabled){this.safeSetState({status:ENTERED},function(){p.props.onEntered(b)});return}this.props.onEnter(b,_),this.safeSetState({status:ENTERING},function(){p.props.onEntering(b,_),p.onTransitionEnd(T,function(){p.safeSetState({status:ENTERED},function(){p.props.onEntered(b,_)})})})},d.performExit=function(){var l=this,p=this.props.exit,h=this.getTimeouts(),v=this.props.nodeRef?void 0:ReactDOM__default.default.findDOMNode(this);if(!p||config.disabled){this.safeSetState({status:EXITED},function(){l.props.onExited(v)});return}this.props.onExit(v),this.safeSetState({status:EXITING},function(){l.props.onExiting(v),l.onTransitionEnd(h.exit,function(){l.safeSetState({status:EXITED},function(){l.props.onExited(v)})})})},d.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},d.safeSetState=function(l,p){p=this.setNextCallback(p),this.setState(l,p)},d.setNextCallback=function(l){var p=this,h=!0;return this.nextCallback=function(v){h&&(h=!1,p.nextCallback=null,l(v))},this.nextCallback.cancel=function(){h=!1},this.nextCallback},d.onTransitionEnd=function(l,p){this.setNextCallback(p);var h=this.props.nodeRef?this.props.nodeRef.current:ReactDOM__default.default.findDOMNode(this),v=l==null&&!this.props.addEndListener;if(!h||v){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var S=this.props.nodeRef?[this.nextCallback]:[h,this.nextCallback],b=S[0],_=S[1];this.props.addEndListener(b,_)}l!=null&&setTimeout(this.nextCallback,l)},d.render=function(){var l=this.state.status;if(l===UNMOUNTED)return null;var p=this.props,h=p.children;p.in,p.mountOnEnter,p.unmountOnExit,p.appear,p.enter,p.exit,p.timeout,p.addEndListener,p.onEnter,p.onEntering,p.onEntered,p.onExit,p.onExiting,p.onExited,p.nodeRef;var v=_objectWithoutPropertiesLoose(p,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return React__default.default.createElement(TransitionGroupContext.Provider,{value:null},typeof h=="function"?h(l,v):React__default.default.cloneElement(React__default.default.Children.only(h),v))},s}(React__default.default.Component);Transition.contextType=TransitionGroupContext,Transition.propTypes={};function noop(){}Transition.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:noop,onEntering:noop,onEntered:noop,onExit:noop,onExiting:noop,onExited:noop},Transition.UNMOUNTED=UNMOUNTED,Transition.EXITED=EXITED,Transition.ENTERING=ENTERING,Transition.ENTERED=ENTERED,Transition.EXITING=EXITING;var Transition$1=Transition,_addClass=function a(s,d){return s&&d&&d.split(" ").forEach(function(c){return addClass(s,c)})},removeClass=function a(s,d){return s&&d&&d.split(" ").forEach(function(c){return removeClass$1(s,c)})},CSSTransition=function(a){_inheritsLoose(s,a);function s(){for(var c,l=arguments.length,p=new Array(l),h=0;h<l;h++)p[h]=arguments[h];return c=a.call.apply(a,[this].concat(p))||this,c.appliedClasses={appear:{},enter:{},exit:{}},c.onEnter=function(v,S){var b=c.resolveArguments(v,S),_=b[0],I=b[1];c.removeClasses(_,"exit"),c.addClass(_,I?"appear":"enter","base"),c.props.onEnter&&c.props.onEnter(v,S)},c.onEntering=function(v,S){var b=c.resolveArguments(v,S),_=b[0],I=b[1],T=I?"appear":"enter";c.addClass(_,T,"active"),c.props.onEntering&&c.props.onEntering(v,S)},c.onEntered=function(v,S){var b=c.resolveArguments(v,S),_=b[0],I=b[1],T=I?"appear":"enter";c.removeClasses(_,T),c.addClass(_,T,"done"),c.props.onEntered&&c.props.onEntered(v,S)},c.onExit=function(v){var S=c.resolveArguments(v),b=S[0];c.removeClasses(b,"appear"),c.removeClasses(b,"enter"),c.addClass(b,"exit","base"),c.props.onExit&&c.props.onExit(v)},c.onExiting=function(v){var S=c.resolveArguments(v),b=S[0];c.addClass(b,"exit","active"),c.props.onExiting&&c.props.onExiting(v)},c.onExited=function(v){var S=c.resolveArguments(v),b=S[0];c.removeClasses(b,"exit"),c.addClass(b,"exit","done"),c.props.onExited&&c.props.onExited(v)},c.resolveArguments=function(v,S){return c.props.nodeRef?[c.props.nodeRef.current,v]:[v,S]},c.getClassNames=function(v){var S=c.props.classNames,b=typeof S=="string",_=b&&S?S+"-":"",I=b?""+_+v:S[v],T=b?I+"-active":S[v+"Active"],k=b?I+"-done":S[v+"Done"];return{baseClassName:I,activeClassName:T,doneClassName:k}},c}var d=s.prototype;return d.addClass=function(l,p,h){var v=this.getClassNames(p)[h+"ClassName"],S=this.getClassNames("enter"),b=S.doneClassName;p==="appear"&&h==="done"&&b&&(v+=" "+b),h==="active"&&l&&l.scrollTop,v&&(this.appliedClasses[p][h]=v,_addClass(l,v))},d.removeClasses=function(l,p){var h=this.appliedClasses[p],v=h.base,S=h.active,b=h.done;this.appliedClasses[p]={},v&&removeClass(l,v),S&&removeClass(l,S),b&&removeClass(l,b)},d.render=function(){var l=this.props;l.classNames;var p=_objectWithoutPropertiesLoose(l,["classNames"]);return React__default.default.createElement(Transition$1,_extends({},p,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},s}(React__default.default.Component);CSSTransition.defaultProps={classNames:""},CSSTransition.propTypes={};var CSSTransition$1=CSSTransition,_leaveRenders,_enterRenders;function areChildrenDifferent(a,s){return!(a===s||React__default.default.isValidElement(a)&&React__default.default.isValidElement(s)&&a.key!=null&&a.key===s.key)}var modes={out:"out-in",in:"in-out"},callHook=function a(s,d,c){return function(){var l;s.props[d]&&(l=s.props)[d].apply(l,arguments),c()}},leaveRenders=(_leaveRenders={},_leaveRenders[modes.out]=function(a){var s=a.current,d=a.changeState;return React__default.default.cloneElement(s,{in:!1,onExited:callHook(s,"onExited",function(){d(ENTERING,null)})})},_leaveRenders[modes.in]=function(a){var s=a.current,d=a.changeState,c=a.children;return[s,React__default.default.cloneElement(c,{in:!0,onEntered:callHook(c,"onEntered",function(){d(ENTERING)})})]},_leaveRenders),enterRenders=(_enterRenders={},_enterRenders[modes.out]=function(a){var s=a.children,d=a.changeState;return React__default.default.cloneElement(s,{in:!0,onEntered:callHook(s,"onEntered",function(){d(ENTERED,React__default.default.cloneElement(s,{in:!0}))})})},_enterRenders[modes.in]=function(a){var s=a.current,d=a.children,c=a.changeState;return[React__default.default.cloneElement(s,{in:!1,onExited:callHook(s,"onExited",function(){c(ENTERED,React__default.default.cloneElement(d,{in:!0}))})}),React__default.default.cloneElement(d,{in:!0})]},_enterRenders),SwitchTransition=function(a){_inheritsLoose(s,a);function s(){for(var c,l=arguments.length,p=new Array(l),h=0;h<l;h++)p[h]=arguments[h];return c=a.call.apply(a,[this].concat(p))||this,c.state={status:ENTERED,current:null},c.appeared=!1,c.changeState=function(v,S){S===void 0&&(S=c.state.current),c.setState({status:v,current:S})},c}var d=s.prototype;return d.componentDidMount=function(){this.appeared=!0},s.getDerivedStateFromProps=function(l,p){return l.children==null?{current:null}:p.status===ENTERING&&l.mode===modes.in?{status:ENTERING}:p.current&&areChildrenDifferent(p.current,l.children)?{status:EXITING}:{current:React__default.default.cloneElement(l.children,{in:!0})}},d.render=function(){var l=this.props,p=l.children,h=l.mode,v=this.state,S=v.status,b=v.current,_={children:p,current:b,changeState:this.changeState,status:S},I;switch(S){case ENTERING:I=enterRenders[h](_);break;case EXITING:I=leaveRenders[h](_);break;case ENTERED:I=b}return React__default.default.createElement(TransitionGroupContext.Provider,{value:{isMounting:!this.appeared}},I)},s}(React__default.default.Component);SwitchTransition.propTypes={},SwitchTransition.defaultProps={mode:modes.out};var SwitchTransition$1=SwitchTransition;const Animations={"fade-in":".fade-in{-webkit-animation:fade-in;animation:fade-in}@-webkit-keyframes fade-in{0%{opacity:0}100%{opacity:1}}@keyframes fade-in{0%{opacity:0}100%{opacity:1}}","fade-out":".fade-out{-webkit-animation:fade-out;animation:fade-out}@-webkit-keyframes fade-out{0%{opacity:1}100%{opacity:0}}@keyframes fade-out{0%{opacity:1}100%{opacity:0}}","slide-in-blurred-top":".slide-in-blurred-top{-webkit-animation:slide-in-blurred-top .6s cubic-bezier(.23,1.000,.32,1.000) both;animation:slide-in-blurred-top .6s cubic-bezier(.23,1.000,.32,1.000) both}@-webkit-keyframes slide-in-blurred-top{0%{-webkit-transform:translateY(-1000px) scaleY(2.5) scaleX(.2);transform:translateY(-1000px) scaleY(2.5) scaleX(.2);-webkit-transform-origin:50% 0;transform-origin:50% 0;-webkit-filter:blur(40px);filter:blur(40px);opacity:0}100%{-webkit-transform:translateY(0) scaleY(1) scaleX(1);transform:translateY(0) scaleY(1) scaleX(1);-webkit-transform-origin:50% 50%;transform-origin:50% 50%;-webkit-filter:blur(0);filter:blur(0);opacity:1}}@keyframes slide-in-blurred-top{0%{-webkit-transform:translateY(-1000px) scaleY(2.5) scaleX(.2);transform:translateY(-1000px) scaleY(2.5) scaleX(.2);-webkit-transform-origin:50% 0;transform-origin:50% 0;-webkit-filter:blur(40px);filter:blur(40px);opacity:0}100%{-webkit-transform:translateY(0) scaleY(1) scaleX(1);transform:translateY(0) scaleY(1) scaleX(1);-webkit-transform-origin:50% 50%;transform-origin:50% 50%;-webkit-filter:blur(0);filter:blur(0);opacity:1}}","slide-in-left":".slide-in-left{-webkit-animation:slide-in-left .5s cubic-bezier(.25,.46,.45,.94) both;animation:slide-in-left .5s cubic-bezier(.25,.46,.45,.94) both}@-webkit-keyframes slide-in-left{0%{-webkit-transform:translateX(-1000px);transform:translateX(-1000px);opacity:0}100%{-webkit-transform:translateX(0);transform:translateX(0);opacity:1}}@keyframes slide-in-left{0%{-webkit-transform:translateX(-1000px);transform:translateX(-1000px);opacity:0}100%{-webkit-transform:translateX(0);transform:translateX(0);opacity:1}}","slide-out-left":".slide-out-left{-webkit-animation:slide-out-left .5s cubic-bezier(.55,.085,.68,.53) both;animation:slide-out-left .5s cubic-bezier(.55,.085,.68,.53) both}@-webkit-keyframes slide-out-left{0%{-webkit-transform:translateX(0);transform:translateX(0);opacity:1}100%{-webkit-transform:translateX(-1000px);transform:translateX(-1000px);opacity:0}}@keyframes slide-out-left{0%{-webkit-transform:translateX(0);transform:translateX(0);opacity:1}100%{-webkit-transform:translateX(-1000px);transform:translateX(-1000px);opacity:0}}"},APIKitAnimation=a=>{const{enter:s,exit:d,children:c,tag:l="div",direction:p="normal",duration:h=500,id:v,type:S}=a,b=v?`${S}-${v}`:`${S}-api-kit-animation`;return React__default.default.createElement("div",{style:{height:"100%",width:"100%"}},React__default.default.createElement("style",{dangerouslySetInnerHTML:{__html:renderStyle(S,s,d,h,p)}}),React__default.default.createElement(SwitchTransition$1,{mode:"out-in"},React__default.default.createElement(CSSTransition$1,{key:b,addEndListener:(_,I)=>{_.addEventListener("transitionend",I,!1)},classNames:{enter:`${S}-default-enter`,enterActive:s,exit:`${S}-default-leave`,exitActive:d},timeout:h},React__default.default.createElement("div",{style:{height:"100%",width:"100%"}},c))))},renderStyle=(a,s,d,c,l)=>`
        body {
          margin: 0;
          padding: 0;
        }
        
        ${Animations[s]}
        
        ${Animations[d]}

        .${a}-transition {
          transition: opacity ${c}ms ease-out};
        }

        .${a}-default-enter {
          opacity: 0;
        }

        .${a}-default-enter.${s} {
          animation-direction: ${l};
          animation-duration: ${c/1e3}s;
          animation-fill-mode: both;
          animation-timing-function: ease-out;
        }

        .${a}-default-leave {
          opacity: 1;
        }

        .${a}-default-leave.${d} {
          animation-direction: ${l};
          animation-duration: ${c/1e3}s;
          animation-timing-function: ease-out;
          animation-fill-mode: both;
        }
        `;var APIKitAnimationTypes=(a=>(a.FADE_IN="fade-in",a.FADE_OUT="fade-out",a.SLIDE_IN_BLURRED_TOP="slide-in-blurred-top",a.SLIDE_IN_LEFT="slide-in-left",a.SLIDE_OUT_LEFT="slide-out-left",a))(APIKitAnimationTypes||{});const Logo$1={name:"LS-Logo",sourceType:"Logo",create({onUpdate:a},{sourceProps:s}){const d=document.createElement("div"),l=getProject(CoreContext.state.activeProjectId).compositor.getRoot(),{x:p}=l.props.size,h=(p!=null?p:1280)/1920,v=_=>_*h+"px",S=({source:_})=>{var F;const{src:I,meta:T}=(_==null?void 0:_.sourceProps)||{},{id:k}=_||{},[w,P]=React__default.default.useState(!1);React.useEffect(()=>{P(!1)},[k]);const{offsetX:$=40,offsetY:U=40,height:E=135,width:D=240}=(T==null?void 0:T.style)||{};return React__default.default.createElement(APIKitAnimation,{type:"logo",id:k,enter:APIKitAnimationTypes.FADE_IN,exit:APIKitAnimationTypes.FADE_OUT,duration:400},React__default.default.createElement("div",{style:{opacity:w?1:0,width:"100%",height:"100%"},className:"logo-transition"},I&&React__default.default.createElement("div",{className:"logo wrapper",style:{padding:`${v(U)} ${v($)}`}},React__default.default.createElement("img",{style:{height:"100%",width:"100%",maxHeight:E?v(E):"none",maxWidth:D?v(D):"none",...(F=s==null?void 0:s.meta)==null?void 0:F.style,...T==null?void 0:T.style},src:I,onLoad:()=>P(!0)}))))},b=_=>ReactDOM__default.default.render(React__default.default.createElement(S,{source:_}),d);return a(_=>{b({..._})}),{root:d}}},Iframe=({url:a,allowFullScreen:s,position:d,display:c,height:l,width:p,overflow:h,styles:v,onLoad:S,id:b,frameBorder:_,className:I,name:T,target:k,iframeRef:w,children:P,src:$})=>{const U=Object.assign({src:$||a,target:k||null,style:{position:d||null,display:c||"block",overflow:h||null,...v},name:T||null,className:I||null,id:b||null,onLoad:S||null,height:l||"100%",width:p||"100%",allow:"autoplay"});let E=Object.create(null);for(let D of Object.keys(U))U[D]!=null&&(E[D]=U[D]);for(let D of Object.keys(E.style))E.style[D]==null&&delete E.style[D];if(s)if("allow"in E){const D=E.allow.replace("fullscreen","");E.allow=`fullscreen ${D.trim()}`.trim()}else E.allow="fullscreen";return _>=0&&(E.style.hasOwnProperty("border")||(E.style.border=_)),React__default.default.createElement(React__default.default.Fragment,null,P?React__default.default.createElement("iframe",{ref:w,...E},P):React__default.default.createElement("iframe",{ref:w,...E}))},Overlay={name:"LS-Overlay",sourceType:"Overlay",create({onUpdate:a,onRemove:s},{sourceProps:d}){s(()=>{clearInterval(p)});const c=document.createElement("div"),l=getProject(CoreContext.state.activeProjectId).role;let p;const h=({source:I,setStartAnimation:T})=>{const{src:k,meta:w,height:P,width:$}=(I==null?void 0:I.sourceProps)||{},U=React__default.default.useRef(null);React.useEffect(()=>{U.current&&(U.current.style.removeProperty("transformOrigin"),U.current.style.removeProperty("transform"))},[k]);const E=()=>{if(U.current){const F=getProject(CoreContext.state.activeProjectId).compositor.getRoot(),{x:J,y:G}=F.props.size;let x=U.current.clientWidth,Y=U.current.clientHeight,N;x&&Y?N=Math.min(J/x,G/Y):N=1,U.current.style.willChange="transform",U.current.style.transformOrigin="0 0",U.current.style.transform=`scale(${N}) translateZ(0)`,T(!0)}};return React__default.default.createElement(React__default.default.Fragment,null,React__default.default.createElement(Iframe,{key:I.id,url:k,frameBorder:0,iframeRef:U,height:P,width:$,onLoad:E,styles:{...w==null?void 0:w.style}}))},v=({source:I,setStartAnimation:T})=>{var N;const{src:k,type:w,meta:P,loop:$}=(I==null?void 0:I.sourceProps)||{},{id:U,sourceType:E}=I||{},[D,F]=React__default.default.useState(null),J=React__default.default.useRef(null);console.log("Updated current time",(N=J==null?void 0:J.current)==null?void 0:N.currentTime);const G=React__default.default.useCallback(z=>{J.current=z,F(z?z.id:null)},[]),x=React__default.default.useCallback(()=>{J!=null&&J.current&&J.current.play().catch(()=>{var z;J.current.muted=!0,(z=J.current)==null||z.play()})},[k]),Y=React__default.default.useCallback(()=>{p&&clearInterval(p),hasPermission(l,Permission.UpdateProject)&&trigger$1("VideoEnded",{id:U,category:w})},[k]);return React__default.default.useEffect(()=>{P&&(J==null?void 0:J.current)&&D&&hasPermission(l,Permission.ManageSelf)&&P!=null&&P.time&&(J.current.currentTime=Number(P==null?void 0:P.time))},[P==null?void 0:P.time,D]),React__default.default.useEffect(()=>()=>{p&&clearInterval(p)},[U]),React__default.default.useEffect(()=>{D?J.current&&(J.current.src=k,J.current.play().catch(()=>{J.current.muted=!0,J.current.play()}),hasPermission(l,Permission.UpdateProject)&&(p=setInterval(()=>{if(J.current.duration){const z=J.current.duration-J.current.currentTime;trigger$1("VideoTimeUpdate",{category:E,id:U,time:Math.floor(z)})}},1e3))):p&&clearInterval(p)},[D]),React__default.default.createElement(React__default.default.Fragment,{key:U},k&&React__default.default.createElement("video",{loop:$,id:U,ref:G,style:{...d.meta.style,...P.style},onLoadedData:x,onEnded:Y,onCanPlay:()=>T(!0)}))},S=({source:I,setStartAnimation:T})=>{const{src:k,meta:w}=(I==null?void 0:I.sourceProps)||{},{id:P}=I||{};return React__default.default.createElement(React__default.default.Fragment,{key:P},k&&React__default.default.createElement("img",{style:{...d.meta.style,...w.style},src:k,onLoad:()=>T(!0)}))},b=({source:I})=>{const{type:T}=(I==null?void 0:I.sourceProps)||{},{id:k}=I||{},[w,P]=React__default.default.useState(!1);return React.useEffect(()=>{P(!1)},[k]),React__default.default.createElement(APIKitAnimation,{id:k,type:"overlay",enter:APIKitAnimationTypes.FADE_IN,exit:APIKitAnimationTypes.FADE_OUT,duration:400},React__default.default.createElement("div",{style:{opacity:w?1:0,width:"100%",height:"100%"},className:"overlayContainer overlay-transition"},k&&T==="image"&&React__default.default.createElement(S,{source:I,setStartAnimation:P}),k&&T==="video"&&React__default.default.createElement(v,{source:I,setStartAnimation:P}),k&&T==="custom"&&React__default.default.createElement(h,{source:I,setStartAnimation:P})))},_=I=>ReactDOM__default.default.render(React__default.default.createElement(React__default.default.Fragment,null,React__default.default.createElement(b,{source:I})),c);return a(I=>{_({...I})}),{root:c}}};var functionExpression=/[\s]*([a-z-]+)[\s]*\([\s]*([^\)]+)[\s]*\)[\s]*/i,floatExpression=/^(\-?\d+\.?\d{0,5})/,toFloat=parseFloat;function ensurePercent(a){return typeof a=="number"?a:toFloat(a)*.01}function formatPercent(a){return formatFloat(a*100)+"%"}function formatFloat(a){return floatExpression.exec(a.toString())[1]}function parseCSSFunction(a){var s=functionExpression.exec(a);if(!(!s||!s.length))return[s[1]].concat(s[2].split(","))}function cssFunction(a,s){var d=Array.prototype.join.call(s,", ");return a+"("+d+")"}var math=Math,round=math.round;function roundFloat(a,s){return round(a*s)/s}var _a,RGB="rgb",HSL="hsl",converters=(_a={},_a[RGB+HSL]=RGBtoHSL,_a[HSL+RGB]=HSLtoRGB,_a),maxChannelValues={r:255,g:255,b:255,h:360,s:1,l:1,a:1};function color(a){return parseHexCode(a)||parseColorFunction(a)||rgb(255,0,0)}function rgb(a,s,d,c){return new ColorHelper(RGB,a,s,d,c===void 0?1:ensurePercent(c),c!==void 0)}function convertHelper(a,s,d){var c=s.f,l=s.r,p=s.g,h=s.b,v=s.a,S=d===void 0?s.o:d;return c!==a?converters[c+a](l,p,h,v,S):d===void 0?s:new ColorHelper(c,l,p,h,v,S)}var ColorHelper=function(){function a(s,d,c,l,p,h){var v=this;v.f=s,v.o=h;var S=s===HSL;v.r=clampColor(S?"h":"r",d),v.g=clampColor(S?"s":"g",c),v.b=clampColor(S?"l":"b",l),v.a=clampColor("a",p)}return a.prototype.toString=function(){var s=this,d=s.o,c=s.f,l=s.r,p=s.g,h=s.b,v=s.a,S,b;if(c===RGB)S=d?"rgba":RGB,b=[round(l),round(p),round(h)];else if(c===HSL)S=d?"hsla":HSL,b=[round(l),formatPercent(roundFloat(p,100)),formatPercent(roundFloat(h,100))];else throw new Error("Invalid color format");return d&&b.push(formatFloat(roundFloat(v,1e5))),cssFunction(S,b)},a.prototype.toHexString=function(){var s=convertHelper(RGB,this);return"#"+(toHex(s.r)+toHex(s.g)+toHex(s.b)).toUpperCase()},a.prototype.toHSL=function(){return convertHelper(HSL,this,!1)},a.prototype.toHSLA=function(){return convertHelper(HSL,this,!0)},a.prototype.toRGB=function(){return convertHelper(RGB,this,!1)},a.prototype.toRGBA=function(){return convertHelper(RGB,this,!0)},a.prototype.red=function(){var s=this;return(s.f===RGB?s:s.toRGB()).r},a.prototype.green=function(){var s=this;return(s.f===RGB?s:s.toRGB()).g},a.prototype.blue=function(){var s=this;return(s.f===RGB?s:s.toRGB()).b},a.prototype.hue=function(){var s=this;return(s.f===HSL?s:s.toHSL()).r},a.prototype.saturation=function(){var s=this;return(s.f===HSL?s:s.toHSL()).g},a.prototype.lightness=function(){var s=this;return(s.f===HSL?s:s.toHSL()).b},a.prototype.alpha=function(){return this.a},a.prototype.opacity=function(){return this.a},a.prototype.invert=function(){var s=this,d=convertHelper(RGB,s);return convertHelper(s.f,new a(RGB,255-d.r,255-d.g,255-d.b,s.a,s.o))},a.prototype.lighten=function(s,d){var c=this,l=convertHelper(HSL,c),p=maxChannelValues.l,h=l.b+(d?p-l.b:p)*ensurePercent(s);return convertHelper(c.f,new a(HSL,l.r,l.g,h,c.a,c.o))},a.prototype.darken=function(s,d){var c=this,l=convertHelper(HSL,c),p=l.b-(d?l.b:maxChannelValues.l)*ensurePercent(s);return convertHelper(c.f,new a(HSL,l.r,l.g,p,c.a,c.o))},a.prototype.saturate=function(s,d){var c=this,l=convertHelper(HSL,c),p=maxChannelValues.s,h=l.g+(d?p-l.g:p)*ensurePercent(s);return convertHelper(c.f,new a(HSL,l.r,h,l.b,c.a,c.o))},a.prototype.desaturate=function(s,d){var c=this,l=convertHelper(HSL,c),p=maxChannelValues.s,h=l.g-(d?l.g:p)*ensurePercent(s);return convertHelper(c.f,new a(HSL,l.r,h,l.b,c.a,c.o))},a.prototype.grayscale=function(){return this.desaturate(1)},a.prototype.fade=function(s){var d=this,c=clampColor("a",ensurePercent(s));return convertHelper(d.f,new a(d.f,d.r,d.g,d.b,c,!0))},a.prototype.fadeOut=function(s,d){var c=this,l=1,p=clampColor("a",c.a-(d?c.a:l)*ensurePercent(s));return convertHelper(c.f,new a(c.f,c.r,c.g,c.b,p,!0))},a.prototype.fadeIn=function(s,d){var c=this,l=1,p=clampColor("a",c.a+(d?c.a:l)*ensurePercent(s));return convertHelper(c.f,new a(c.f,c.r,c.g,c.b,p,!0))},a.prototype.mix=function(s,d){var c=this,l=ensureColor(s),p=convertHelper(RGB,c),h=convertHelper(RGB,l),v=d===void 0?.5:d,S=2*v-1,b=Math.abs(p.a-h.a),_=((S*b===-1?S:(S+b)/(1+S*b))+1)/2,I=1-_,T=new a(RGB,round(p.r*_+h.r*I),round(p.g*_+h.g*I),round(p.b*_+h.b*I),p.a*v+h.a*(1-v),c.o||l.o);return convertHelper(this.f,T)},a.prototype.tint=function(s){return rgb(255,255,255).mix(this,s)},a.prototype.shade=function(s){return rgb(0,0,0).mix(this,s)},a.prototype.spin=function(s){var d=this,c=convertHelper(HSL,d);return convertHelper(d.f,new a(HSL,modDegrees(c.r+s),c.g,c.b,d.a,d.o))},a}();function toHex(a){var s=round(a);return(s<16?"0":"")+s.toString(16)}function modDegrees(a){return((a<0?360:0)+a%360)%360}function RGBtoHSL(a,s,d,c,l){var p=a/255,h=s/255,v=d/255,S=Math.min(p,h,v),b=Math.max(p,h,v),_=(S+b)/2,I=b-S,T;b===S?T=0:p===b?T=(h-v)/I:h===b?T=2+(v-p)/I:v===b?T=4+(p-h)/I:T=0,T=Math.min(T*60,360),T<0&&(T+=360);var k;return b===S?k=0:_<=.5?k=I/(b+S):k=I/(2-b-S),new ColorHelper(HSL,T,k,_,c,l)}function HSLtoRGB(a,s,d,c,l){var p=a/360,h=s,v=d;if(h===0){var S=v*255;return new ColorHelper(RGB,S,S,S,c,l)}for(var b=v<.5?v*(1+h):v+h-v*h,_=2*v-b,I=0,T=0,k=0,w=0;w<3;w++){var P=p+.3333333333333333*-(w-1);P<0&&P++,P>1&&P--;var S=void 0;6*P<1?S=_+(b-_)*6*P:2*P<1?S=b:3*P<2?S=_+(b-_)*(2/3-P)*6:S=_,S*=255,w===0?I=S:w===1?T=S:k=S}return new ColorHelper(RGB,I,T,k,c,l)}function clampColor(a,s){var d=0,c=maxChannelValues[a];return s<d?d:s>c?c:s}function ensureColor(a){return a instanceof ColorHelper?a:color(a)}function parseHexCode(a){var s=a.match(/#(([a-f0-9]{6})|([a-f0-9]{3}))$/i);if(!!s){var d=s[1],c=parseInt(d.length===3?d[0]+d[0]+d[1]+d[1]+d[2]+d[2]:d,16),l=c>>16&255,p=c>>8&255,h=c&255;return new ColorHelper(RGB,l,p,h,1,!1)}}function parseColorFunction(a){var s=parseCSSFunction(a);if(!(!s||!(s.length===4||s.length===5))){var d=s[0],c=d==="rgba",l=d==="hsla",p=d===RGB,h=d===HSL,v=l||c,S;if(p||c)S=RGB;else if(h||l)S=HSL;else throw new Error("unsupported color string");var b=toFloat(s[1]),_=p||c?toFloat(s[2]):ensurePercent(s[2]),I=p||c?toFloat(s[3]):ensurePercent(s[3]),T=v?toFloat(s[4]):1;return new ColorHelper(S,b,_,I,T,v)}}const of=color,transparent=color("rgba(0,0,0,0)"),white=color("#ffffff"),black=color("#000000"),weights={primary:{50:"#EAFAF5",100:"#D5F6EB",200:"#ABEDD7",300:"#82E3C3",400:"#58DAAF",500:"#26AD80",600:"#25A77C",700:"#1C7D5D",800:"#12543E"},secondary:{50:"#FBEAEA",100:"#F7D4D4",200:"#EFA9A9",300:"#E77E7E",400:"#FF6F64",500:"#E9554A",600:"#CB362B",700:"#811818",800:"#561010"},neutral:{0:"#ffffff",10:"#f5f5f5",200:"#d9d9d9",300:"#bababa",350:"#999999",400:"#9e9e9e",500:"#808080",600:"#666666",700:"#4d4d4d",800:"#303030",900:"#141414",1e3:"#000000"},warning:{400:"#FFC28A",500:"#FFAE64",600:"#F29540"}},types=Object.keys(weights),weight=a=>s=>{const d=weights[a];if(d[s])return d[s];const c=Object.keys(weights.primary).map(Number),l=c.find(p=>s<=p);return l?d[l]:d[c.slice(c.length-1)[0]]},primary=weight("primary"),neutral=weight("neutral"),secondary=weight("secondary"),warning=weight("warning"),lightstream=color("#26ad80"),twitch=color("#9156ff"),linkedin=color("#2867b2"),youtube=color("#ff0000"),facebook=color("#1877f2"),twitter=color("#1da1f2");var Color=Object.freeze(Object.defineProperty({__proto__:null,color,of,transparent,white,black,types,primary,neutral,secondary,warning,lightstream,twitch,linkedin,youtube,facebook,twitter},Symbol.toStringTag,{value:"Module"}));const YouTube=React__default.default.createElement("svg",{style:{flex:"0 0 100%"},viewBox:"0 0 24 24"},React__default.default.createElement("path",{d:"M19.6465 8.53711C19.4707 7.83398 18.9141 7.27734 18.2402 7.10156C16.9805 6.75 12 6.75 12 6.75C12 6.75 6.99023 6.75 5.73047 7.10156C5.05664 7.27734 4.5 7.83398 4.32422 8.53711C3.97266 9.76758 3.97266 12.4043 3.97266 12.4043C3.97266 12.4043 3.97266 15.0117 4.32422 16.2715C4.5 16.9746 5.05664 17.502 5.73047 17.6777C6.99023 18 12 18 12 18C12 18 16.9805 18 18.2402 17.6777C18.9141 17.502 19.4707 16.9746 19.6465 16.2715C19.998 15.0117 19.998 12.4043 19.998 12.4043C19.998 12.4043 19.998 9.76758 19.6465 8.53711ZM10.3594 14.7773V10.0312L14.5195 12.4043L10.3594 14.7773Z"})),YouTubeDuo=React__default.default.createElement("svg",{style:{flex:"0 0 100%"},viewBox:"0 0 24 24"},React__default.default.createElement("rect",{x:"8",y:"9",width:"9",height:"7",fill:neutral(0)}),React__default.default.createElement("path",{d:"M19.6465 8.53711C19.4707 7.83398 18.9141 7.27734 18.2402 7.10156C16.9805 6.75 12 6.75 12 6.75C12 6.75 6.99023 6.75 5.73047 7.10156C5.05664 7.27734 4.5 7.83398 4.32422 8.53711C3.97266 9.76758 3.97266 12.4043 3.97266 12.4043C3.97266 12.4043 3.97266 15.0117 4.32422 16.2715C4.5 16.9746 5.05664 17.502 5.73047 17.6777C6.99023 18 12 18 12 18C12 18 16.9805 18 18.2402 17.6777C18.9141 17.502 19.4707 16.9746 19.6465 16.2715C19.998 15.0117 19.998 12.4043 19.998 12.4043C19.998 12.4043 19.998 9.76758 19.6465 8.53711ZM10.3594 14.7773V10.0312L14.5195 12.4043L10.3594 14.7773Z"})),Facebook=React__default.default.createElement("svg",{style:{flex:"0 0 100%"},viewBox:"0 0 24 24"},React__default.default.createElement("path",{d:"M15.4863 13.3125L15.8965 10.6172H13.2891V8.85938C13.2891 8.09766 13.6406 7.39453 14.8125 7.39453H16.0137V5.08008C16.0137 5.08008 14.9297 4.875 13.9043 4.875C11.7656 4.875 10.3594 6.19336 10.3594 8.53711V10.6172H7.95703V13.3125H10.3594V19.875H13.2891V13.3125H15.4863Z"})),FacebookCircle=React__default.default.createElement("svg",{style:{flex:"0 0 100%"},viewBox:"0 0 24 24"},React__default.default.createElement("path",{d:"M19.2656 12.375C19.2656 8.36133 16.0137 5.10938 12 5.10938C7.98633 5.10938 4.73438 8.36133 4.73438 12.375C4.73438 16.0078 7.37109 19.0254 10.8574 19.5527V14.4844H9.01172V12.375H10.8574V10.793C10.8574 8.97656 11.9414 7.95117 13.582 7.95117C14.4023 7.95117 15.2227 8.09766 15.2227 8.09766V9.88477H14.3145C13.4062 9.88477 13.1133 10.4414 13.1133 11.0273V12.375H15.1348L14.8125 14.4844H13.1133V19.5527C16.5996 19.0254 19.2656 16.0078 19.2656 12.375Z"})),Twitch=React__default.default.createElement("svg",{style:{flex:"0 0 100%"},viewBox:"0 0 24 24"},React__default.default.createElement("path",{d:"M16.9551 8.92188H15.8125V12.1445H16.9551V8.92188ZM13.8496 8.89258H12.707V12.1152H13.8496V8.89258ZM9.01562 5.875L6.20312 8.57031V18.209H9.60156V20.875L12.4141 18.209H14.6699L19.7676 13.375V5.875H9.01562ZM18.6543 12.8477L16.3691 14.9863H14.1133L12.1504 16.8613V14.9863H9.60156V6.95898H18.6543V12.8477Z"})),TwitchDuo=React__default.default.createElement("svg",{style:{flex:"0 0 100%"},viewBox:"0 0 24 24"},React__default.default.createElement("path",{d:"M19 6.5H9L8.8125 17.5H13.5L19 13V6.5Z",fill:neutral(0)}),React__default.default.createElement("path",{d:"M16.9551 8.92188H15.8125V12.1445H16.9551V8.92188ZM13.8496 8.89258H12.707V12.1152H13.8496V8.89258ZM9.01562 5.875L6.20312 8.57031V18.209H9.60156V20.875L12.4141 18.209H14.6699L19.7676 13.375V5.875H9.01562ZM18.6543 12.8477L16.3691 14.9863H14.1133L12.1504 16.8613V14.9863H9.60156V6.95898H18.6543V12.8477Z"})),Twitter=React__default.default.createElement("svg",{style:{flex:"0 0 100%"},viewBox:"0 0 24 24"},React__default.default.createElement("path",{d:"M20.6681 7.98749C20.6806 8.16248 20.6806 8.33751 20.6806 8.5125C20.6806 13.85 16.6197 20 9.1976 20C6.91098 20 4.78681 19.3375 3 18.1875C3.32489 18.225 3.63723 18.2375 3.97462 18.2375C5.86136 18.2375 7.59821 17.6 8.98518 16.5125C7.21086 16.475 5.72393 15.3125 5.21162 13.7125C5.46155 13.75 5.71143 13.775 5.97386 13.775C6.33621 13.775 6.69859 13.725 7.03594 13.6375C5.18666 13.2625 3.79966 11.6375 3.79966 9.67499V9.62501C4.33693 9.92501 4.96174 10.1125 5.62393 10.1375C4.53685 9.41247 3.82466 8.17498 3.82466 6.77497C3.82466 6.02499 4.02454 5.33749 4.37443 4.73748C6.36117 7.18748 9.34753 8.78745 12.6962 8.96248C12.6337 8.66248 12.5962 8.35001 12.5962 8.03751C12.5962 5.81248 14.3955 4 16.6322 4C17.7942 4 18.8438 4.4875 19.581 5.275C20.4931 5.10001 21.3678 4.76249 22.1425 4.3C21.8426 5.23752 21.2054 6.02502 20.3682 6.52499C21.1804 6.43753 21.9676 6.21248 22.6923 5.90001C22.1426 6.69998 21.4553 7.41245 20.6681 7.98749Z"})),LinkedIn=React__default.default.createElement("svg",{style:{flex:"0 0 100%"},viewBox:"0 0 24 24"},React__default.default.createElement("path",{d:"M19.2 3H4.8C3.81 3 3.009 3.81 3.009 4.8L3 19.2C3 20.19 3.81 21 4.8 21H19.2C20.19 21 21 20.19 21 19.2V4.8C21 3.81 20.19 3 19.2 3ZM8.4 18.3H5.7V10.2H8.4V18.3ZM7.05 8.679C6.15 8.679 5.421 7.95 5.421 7.05C5.421 6.15 6.15 5.421 7.05 5.421C7.95 5.421 8.679 6.15 8.679 7.05C8.679 7.95 7.95 8.679 7.05 8.679ZM18.3 18.3H15.6V13.53C15.6 12.783 14.997 12.18 14.25 12.18C13.503 12.18 12.9 12.783 12.9 13.53V18.3H10.2V10.2H12.9V11.28C13.368 10.524 14.331 10.02 15.15 10.02C16.887 10.02 18.3 11.433 18.3 13.17V18.3Z"})),Lightstream=React__default.default.createElement("svg",{style:{flex:"0 0 100%"},viewBox:"0.144 0 27.712 24"},React__default.default.createElement("path",{d:"M16.0369 12.1232L14 15.6518L11.5642 11.4335L6.27356 10.6176L14 24L20.4627 12.805L16.0369 12.1232Z"}),React__default.default.createElement("path",{d:"M9.74033 8.27418L7.37317 4.17409H20.6268L19.0921 6.83194L24.3827 6.01602L27.8558 0H0.144165L5.31453 8.95665L9.74033 8.27418Z"})),LightstreamWithText=React__default.default.createElement("svg",{style:{flex:"0 0 100%"},viewBox:"0 0 3000 524"},React__default.default.createElement("polygon",{points:"330.56 263.5 299.73 316.91 262.86 253.06 182.78 240.71 299.73 443.27 397.55 273.82 330.56 263.5"}),React__default.default.createElement("polygon",{points:"235.25 205.24 199.42 143.18 400.03 143.18 376.8 183.41 456.88 171.06 509.45 80 90 80 168.26 215.57 235.25 205.24"}),React__default.default.createElement("path",{d:"M646.32,345.72h94.91v13.73H630V167.26h16.36Z"}),React__default.default.createElement("path",{d:"M846.24,359.45H830V167.26h16.23Z"}),React__default.default.createElement("path",{d:"M1091.16,336.61q-8.45,12-26.46,18.74t-40.33,6.73q-22.57,0-40.13-10.82t-27.19-30.62q-9.64-19.8-9.77-45.41V250.95q0-40,20.2-63.16t54.25-23.17q29.69,0,47.78,15.11T1091,221.38h-16.24q-3.56-21.18-17.23-32.11t-35.7-10.92q-26.92,0-42.64,19.15t-15.71,54v22.72q0,21.93,7.46,38.77t21.38,26.09q13.92,9.25,32,9.25,21,0,36-6.6,9.76-4.36,14.52-10.16V282h-51.61V268.24h67.85Z"}),React__default.default.createElement("path",{d:"M1333.71,359.45h-16.37V278.11H1207.53v81.33h-16.23V167.26h16.23v97.12h109.81V167.26h16.37Z"}),React__default.default.createElement("path",{d:"M1563.2,181h-65.87V359.45H1481.1V181h-65.73V167.26H1563.2Z"}),React__default.default.createElement("path",{d:"M1990.75,181h-65.87V359.45h-16.23V181h-65.73V167.26h147.83Z"}),React__default.default.createElement("path",{d:"M2147.65,279.33h-55.84v80.12h-16.36V167.26h62.43q30.75,0,48,14.9t17.29,41.66a52,52,0,0,1-10.83,32.56q-10.82,14.11-29,19.51l48,81.83v1.72h-17.29Zm-55.84-13.73h49.76q20.45,0,32.86-11.63t12.41-30.14q0-20.36-12.93-31.59T2137.61,181h-45.8Z"}),React__default.default.createElement("path",{d:"M2407.62,278.11h-89.88v67.61h103.35v13.73H2301.5V167.26h118.92V181H2317.73v83.39h89.88Z"}),React__default.default.createElement("polygon",{points:"2892.79 183.67 2892.79 183.67 2816.23 326.97 2724.06 154.45 2724.06 189.54 2724.06 359.75 2739.67 359.75 2739.67 218.3 2816.26 359.42 2892.79 218.32 2892.79 359.75 2908.4 359.75 2908.4 189.54 2908.4 154.45 2892.79 183.67"}),React__default.default.createElement("polygon",{points:"2649.77 359.45 2569.47 154.54 2569.47 154.53 2569.46 154.53 2569.46 154.53 2569.46 154.54 2489.16 359.45 2506.19 359.45 2569.46 194.32 2632.74 359.45 2649.77 359.45"}),React__default.default.createElement("path",{d:"M1764.57,287q-6.73-10.56-20.06-18.15a131.55,131.55,0,0,0-21.47-9.18l-7.64,13.49q19.65,6.61,28.32,13.77,11.22,9.3,11.22,25.28,0,16.37-13.6,26.26t-36,9.9c-11.35,0-21.05-1.94-29.35-5.51l-7,12.33a94,94,0,0,0,36.33,6.91q29.7,0,47.85-13.73t18.15-36.43Q1771.3,297.55,1764.57,287Z"}),React__default.default.createElement("path",{d:"M1659.11,250.93c7.28,5.25,18,10.18,32.13,14.79l7.72-13.38q-21-6.41-31.29-14.49Q1655.95,228.61,1656,214q0-15.83,13-25.66t35-9.83c13.12,0,23.78,3.19,32.26,9.21l7.23-12.51c-1.71-1-3.43-2.1-5.3-3q-15.09-7.38-34.18-7.38-28.19,0-46.31,13.76t-18.11,35.77Q1639.62,237,1659.11,250.93Z"}),React__default.default.createElement("path",{d:"M1744.34,268.78a129.23,129.23,0,0,0-21.68-9.32l-7.79,13.49c13.28,4.44,22.87,9.06,28.68,13.88q11.2,9.29,11.2,25.23,0,16.33-13.57,26.21t-36,9.88c-11.8,0-21.85-2-30.34-5.91l-7.08,12.26.2.1a93.63,93.63,0,0,0,37.22,7.25q29.64,0,47.75-13.7t18.11-36.36q0-14.36-6.72-24.9T1744.34,268.78Z"}));var IconMap=Object.freeze(Object.defineProperty({__proto__:null,YouTube,YouTubeDuo,Facebook,FacebookCircle,Twitch,TwitchDuo,Twitter,LinkedIn,Lightstream,LightstreamWithText},Symbol.toStringTag,{value:"Module"}));const nudge=a=>{if(!!(a.nudgeUp||a.nudgeDown||a.nudgeRight||a.nudgeLeft))return{position:"relative",top:a.nudgeDown,left:a.nudgeRight,right:a.nudgeLeft,bottom:a.nudgeUp}},SVGWrapper=({children:a,width:s,height:d,color:c,colorWeight:l=0,marginLeft:p,marginTop:h,marginRight:v,marginBottom:S,className:b,..._})=>(c&&Color[c](l),React__default.default.createElement("div",{className:b,style:{...nudge(_),display:"flex",justifyContent:"center",flexBasis:s||"auto",flexShrink:0,width:s,height:d||s&&"fit-content",marginLeft:p,marginTop:h,marginBottom:S,marginRight:v}},a)),Icon=({name:a,...s})=>React__default.default.createElement(SVGWrapper,{...s},IconMap[a]),dragImageSvg=`
  <svg height="75" width="120" viewBox="0 0 120 75" xmlns="http://www.w3.org/2000/svg" style="">
    <rect width="120" height="75" rx="3" style="
      opacity: 0.4;
      stroke: white;
      stroke-width: 3px;
      stroke-opacity: 0.7;
    "/>
  </svg>`;let dragImage;const loadDragImage=()=>dragImage||(dragImage=new Image,dragImage.src=URL.createObjectURL(new Blob([dragImageSvg],{type:"image/svg+xml"})),dragImage);class ErrorBoundary extends React__default.default.Component{constructor(s){super(s),this.state={error:null}}componentDidCatch(s,d){log$1.warn(s,d)}static getDerivedStateFromError(){return{error:!0}}render(){return this.state.error?null:this.props.children}}const onDrop=async(a,s)=>{s.preventDefault(),s.stopPropagation();const{dropNodeId:d,dropType:c,project:l}=a,p=s.dataTransfer.getData("text/plain");if(log$1.debug("Compositor: Dropping",{dropType:c,dragNodeId:p,dropNodeId:d}),d===p)return;const[h,v,S,b]=await Promise.all([l.compositor.get(p),l.compositor.get(d),l.compositor.getParent(p),l.compositor.getParent(d)]);if(c==="layout")return S.id===d?void 0:CoreContext.Command.moveNode({projectId:l.id,nodeId:h.id,parentId:v.id});if(S.id!==(b==null?void 0:b.id))return CoreContext.Command.swapNodes({projectId:l.id,nodeAId:h.id,nodeBId:v.id});const _=S.children.map(I=>I.id);return CoreContext.Command.reorderNodes({projectId:l.id,parentId:S.id,childIds:swapItems(h.id,v.id,_)})};let foundDropTarget=!1;const ElementTree=a=>{var D,F,J;const s=React.useRef(!1),d=React.useRef(),c=React.useRef(),l=React.useRef(),{project:p,interactive:h=!0,onElementDoubleClick:v,checkIsDragTarget:S,checkIsDropTarget:b}=React.useContext(CompositorContext),{nodeId:_}=a,I=p.compositor.get(_);if(!I)return null;const T=CoreContext.compositor.getElement(I),k=I.props.layout||"Row",w=h&&S(I),P=h&&b(I);let $=P?{onDrop:G=>(foundDropTarget=!0,onDrop({dropType:"layout",dropNodeId:I.id,project:p},G)),onDragOver:G=>{var x;G.preventDefault(),G.stopPropagation(),(x=l.current)==null||x.toggleAttribute("data-layout-drop-target-active",!0)},onDragLeave:G=>{var x;G.preventDefault(),G.stopPropagation(),(x=l.current)==null||x.toggleAttribute("data-layout-drop-target-active",!1)}}:{},U=w?{draggable:!0,ondrop:G=>(foundDropTarget=!0,onDrop({dropType:"transform",dropNodeId:I.id,project:p},G)),ondragstart:G=>{var x;s.current=!0,wrapperEl.toggleAttribute("data-dragging",!0),log$1.debug("Compositor: Dragging",I.id),foundDropTarget=!1,G.dataTransfer.setData("text/plain",I.id),G.dataTransfer.dropEffect="move",G.dataTransfer.setDragImage(dragImage,10,10),(x=l.current)==null||x.toggleAttribute("data-drag-target-active",!0),window.__dragging=!0},ondragend:G=>{var x;s.current=!1,foundDropTarget||(log$1.info("Compositor: No drop target - deleting node",I),CoreContext.Command.deleteNode({nodeId:I.id})),wrapperEl.toggleAttribute("data-dragging",!0),log$1.debug("Compositor: DragEnd",G),(x=l.current)==null||x.toggleAttribute("data-drag-target-active",!1),wrapperEl.querySelectorAll("[data-item]").forEach(Y=>{Y.toggleAttribute("data-drag-target-active",!1),Y.toggleAttribute("data-layout-drop-target-active",!1),Y.toggleAttribute("data-transform-drop-target-active",!1)}),window.__dragging=!1},ondragover:G=>{var x;G.preventDefault(),G.stopPropagation(),!s.current&&((x=l.current)==null||x.toggleAttribute("data-transform-drop-target-active",!0))},ondragleave:G=>{var x;G.preventDefault(),G.stopPropagation(),(x=l.current)==null||x.toggleAttribute("data-transform-drop-target-active",!1)}}:{};React.useEffect(()=>{c.current&&T&&(c.current.appendChild(T.root),Object.assign(c.current.style,{width:"100%",height:"100%",position:"relative",overflow:"hidden"}),Object.assign(T.root.style,{pointerEvents:w?"all":"none",width:"100%",height:"100%",position:"relative",...I.props.style||{}}))},[c.current,T]),React.useEffect(()=>{const G=w?()=>v(I):()=>{};return d.current&&(Object.assign(d.current,U),Object.assign(d.current.style,{pointerEvents:w?"all":"none"}),d.current.addEventListener("dblclick",G)),()=>{var x;(x=d.current)==null||x.removeEventListener("dblclick",G)}},[d.current]);const E={layout:k,...(D=I.props.layoutProps)!=null?D:{}};return React__default.default.createElement("div",{ref:l,"data-id":I.id+"-x","data-item":!0,...w&&{"data-drag-target":!0},...P&&{"data-drop-target":!0},...$,style:{position:"relative",width:((F=I.props.size)==null?void 0:F.x)||"100%",height:((J=I.props.size)==null?void 0:J.y)||"100%",pointerEvents:"none"}},React__default.default.createElement("div",{className:"interactive-overlay",ref:d,style:{height:"100%",width:"100%",position:"absolute",zIndex:2}}),React__default.default.createElement("div",{className:"item-element",style:{display:"flex",flex:"0 0 auto",justifyContent:"center",width:"100%",height:"100%"}},React__default.default.createElement("div",{ref:c}),React__default.default.createElement(ErrorBoundary,null,React__default.default.createElement("ls-layout",{"data-id":I.id+"-x",props:JSON.stringify(E),layout:k},I.children.map(G=>React__default.default.createElement(ElementTree,{key:G.id,nodeId:G.id}))))))},Root=a=>{const{project:s}=React.useContext(CompositorContext),[d,c]=React.useState(null);return React.useEffect(()=>(c(s.compositor.renderTree()),CoreContext.onInternal("NodeChanged",()=>{c(s.compositor.renderTree())})),[]),React.useEffect(()=>{const l=s.compositor.getRoot(),{x:p}=l.props.size,h=()=>{var k,w,P,$,U,E;const{bannerStyle:v=BannerStyle.DEFAULT,primaryColor:S="#ABABAB",showNameBanners:b}=(k=s.props)!=null?k:{},_=(E=(U=(w=s.props)==null?void 0:w.logoPosition)!=null?U:($=(P=s.props)==null?void 0:P.logo)==null?void 0:$.logoPosition)!=null?E:LogoPosition.TopRight;if(!v||!S||!_)return;const I=themes[v](S,b,p/1920),T=themes[_](p/1920);a.setStyle(`${I} ${T}`||"")};return h(),CoreContext.onInternal("ProjectChanged",h)},[s]),d?React__default.default.createElement("div",{onDrop:l=>{foundDropTarget=!0,l.preventDefault()},onDragOver:l=>{l.preventDefault()},onDragLeave:l=>{l.preventDefault()},style:{userSelect:"none",width:`${d.props.size.x+PADDING*2}px`,height:`${d.props.size.y+PADDING*2}px`,margin:PADDING+"px"}},React__default.default.createElement("div",{style:{width:"100%",height:"100%",overflow:"hidden"}},React__default.default.createElement(ElementTree,{nodeId:d.id}))):null};let wrapperEl,customStyleEl;const PADDING=0,render$1=a=>{const{containerEl:s,projectId:d,dragAndDrop:c=!1,dblClickShowcase:l=c,checkDragTarget:p=scenelessProjectDragCheck,checkDropTarget:h=scenelessProjectDropCheck}=a,v=getProject(d);CoreContext.clients.LayoutApi().subscribeToLayout(v.layoutApi.layoutId),loadDragImage();const S=a.onElementDoubleClick||l&&scenelessProjectDoubleClick(v);if(!s||!v)return;if(!s.shadowRoot){s.attachShadow({mode:"open"}),customStyleEl=document.createElement("style");const w=document.createElement("style");w.textContent=getStyle(),wrapperEl=document.createElement("div"),wrapperEl.id="compositor-root",Object.assign(wrapperEl.style,{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",transformOrigin:"center"}),s.shadowRoot.appendChild(w),s.shadowRoot.appendChild(customStyleEl),s.shadowRoot.appendChild(wrapperEl),new ResizeObserver($=>{T()}).observe(s)}const b=v.compositor.getRoot(),{x:_,y:I}=b.props.size,T=()=>{let{width:w,height:P}=s.getBoundingClientRect();const $=w/P,U=_/I;let E;w&&P?U>$?E=w/(_+PADDING*2):E=P/(I+PADDING*2):E=1,wrapperEl.style.willChange="transform",wrapperEl.style.transform=`scale(${E}) translateZ(0)`,window.__scale=E,k()},k=()=>{ReactDOM__default.default.render(React__default.default.createElement(CompositorProvider,{project:v,interactive:c,onElementDoubleClick:S,checkIsDropTarget:h,checkIsDragTarget:p},React__default.default.createElement(Root,{setStyle:w=>{customStyleEl.textContent=w}})),wrapperEl)};T()},scenelessProjectDragCheck=a=>a.props.name==="Participant"||a.props.sourceType==="RoomParticipant",scenelessProjectDropCheck=a=>a.props.name==="Content",scenelessProjectDoubleClick=a=>s=>{var c;const d=a.compositor.nodes.find(l=>l.props.name==="Content");if(d){const l=(c=d.props.layoutProps)==null?void 0:c.showcase;CoreContext.Command.updateNode({nodeId:d.id,props:{layoutProps:{...d.props.layoutProps,showcase:l===s.id?null:s.id}}})}},CompositorContext=React__default.default.createContext({interactive:!1,project:null,checkIsDragTarget:()=>!1,checkIsDropTarget:()=>!1,onElementDoubleClick:()=>{}}),CompositorProvider=({children:a,...s})=>React__default.default.createElement(CompositorContext.Provider,{value:{...s}},a),getStyle=()=>`
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: 'Arial';
}

video {
  width: 100%;
  height: 100%;
  object-fit: contain;
}

.NameBanner {
  top: 100%;
  transform: translateY(-100%);
  left: 0;
  height: 30px;
  background: linear-gradient(90deg, rgba(0, 0, 0, 0.5) 50%, rgba(0, 0, 0, 0) 100%);
  padding: 0px 0px 0px 10px;
  color: rgba(255, 255, 255, 0.9);
  font-weight: bold;
  line-height: 30px;
  width: 100%;
  font-size: 28px;
  position: absolute;
}

ls-layout[layout="Presentation"][props*="\\"cover\\"\\:true"] > :first-child .NameBanner {
  top: 0% !important;
  transform: translateY(0%) !important;
}

[layout="Layered"] > [data-item] {
  transform: scale(1.003) !important;
}
[layout="Layered"] > [data-item]:nth-child(2) {
  transform: scale(1.0015) !important;
}
[layout="Layered"] > [data-item]:nth-child(1) {
  transform: scale(1) !important;
}

.logo {
  position: absolute !important;
}

#compositor-root[data-dragging] {}

[data-drag-target] {}
[data-drag-target]:hover > .interactive-overlay {
  box-shadow: 0 0 0 3px inset rgba(255, 255, 255, 0.5);
  cursor: grab;
}
[data-drop-target] {}
[data-drop-target]:hover {}
[data-drag-target][data-drag-target-active] > .interactive-overlay {
  box-shadow: 0 0 0 3px inset rgba(255, 255, 255, 0.2);
}
[data-drag-target][data-drag-target-active] > .item-element {
  opacity: 0.8;
}
[data-layout-drop-target-active] > .interactive-overlay {
  box-shadow: 0 0 0 3px inset yellow;
}
[data-transform-drop-target-active] > .interactive-overlay {
  box-shadow: 0 0 0 3px inset white;
}
`;var LogoPosition=(a=>(a.TopLeft="top-left",a.TopRight="top-right",a.BottomLeft="bottom-left",a.BottomRight="bottom-right",a))(LogoPosition||{}),BannerStyle=(a=>(a.DEFAULT="default",a.MINIMAL="minimal",a.BUBBLE="bubble",a))(BannerStyle||{}),PlatformType=(a=>(a.TWITCH="twitch",a.YOUTUBE="youtube",a))(PlatformType||{});const themes={["top-left"]:(a=1280/1920)=>`
      .wrapper {
       top:0;
       left:0;
    }`,["top-right"]:(a=1280/1920)=>`
      .wrapper {
       top:0;
       right:0;
    }`,["bottom-left"]:(a=1280/1920)=>`
      .wrapper {
       bottom:0;
       left:0;
    }`,["bottom-right"]:(a=1280/1920)=>`
      .wrapper {
       bottom:0;
       right:0;
    }`,default:(a="#ABABAB",s=!0,d=1280/1920)=>{const c=color(a).lightness()<.6?"#FFF":"#000",l=color(a).lightness()<.6?"#FFF":"#000",p=color(a).lightness()<.6?"#000":"#FFF",h=v=>v*d+"px";return`
      .ChatOverlay {
        background: ${a} !important;
        margin-bottom: ${h(40)} !important;
        transition: 300ms ease all;
        left: 0;

        /* Default Size 4 */
        font-size: ${h(44)} !important;
        padding: ${h(40)} ${h(100)} !important;
        border-radius: ${h(20)} !important;
      }
      
      .ChatOverlay-badge-icon {
          width:${h(32)};
          height: ${h(32)};
          fill: currentcolor;
          color: ${p};
      }

       .ChatOverlay-badge-container {
          background-color:${l};
          display:flex;
          flex-direction:row;
          padding: ${h(6)} ${h(12)} ${h(6)} ${h(6)};
          border-radius: ${h(10)};
          align-items: center;
          border-bottom-left-radius: 0px !important;
          position: relative;
          border: none;
          cursor: pointer;
       }
      
       .ChatOverlay-badge-username {
          color:${p};
          padding:${h(6)};
          font-size:${h(18)};
          font-weight:700;
          text-transform: capitalize; 
       }
       
       .ChatOverlay-badge-container::before {
          content:"";
          width:15px;
          height:15px;
          background-color:${l};
          position: absolute;
          bottom:-14px;
          left:0;
          clip-path:polygon(0 100%, 12% 87%, 26% 73%, 45% 53%, 59% 40%, 71% 28%, 85% 14%, 100% 0, 0 0);
        }
       

       .ChatOverlay-avatar {
          height: ${h(120)};
          width: ${h(120)};
          left:0;
          right:0;
          top:0;
          bottom:0;
          border-radius:50%;
       }

      .Banner, .NameBanner, .ChatOverlay {
        background: ${a} !important;
        margin-bottom: ${h(40)} !important;
        transition: 300ms ease all;
        left: 0;

        /* Default Size 4 */
        font-size: ${h(44)} !important;
        padding: ${h(40)} ${h(100)} !important;
        border-top-right-radius: ${h(20)} !important;
        border-bottom-right-radius: ${h(20)} !important;
      }

      .Banner-body, .NameBanner-body, .ChatOverlay-body {
        color: ${c} !important;
        font-family: 'Roboto' !important;
        font-style: normal !important;
        font-weight: 700 !important;
        line-height: 120% !important;
      }

      .NameBanner {
        transform-origin: 0 100%;
        margin: 0 !important;
        transform: translateX(-100%);
        opacity: 0 !important;
        white-space: nowrap;
        ${s&&`
          opacity: 1 !important;
          transform: translateX(0);
        `}
      }

      .NameBanner[data-size="4"] {
        padding: ${h(40)} ${h(100)} !important;
        font-size: ${h(44)} !important;
        border-top-right-radius: ${h(20)} !important;
        border-bottom-right-radius: ${h(20)} !important;
      }
      .NameBanner[data-size="3"] {
        padding: ${h(12)} ${h(30)} !important;
        font-size: ${h(44)} !important;
        border-top-right-radius: ${h(20)} !important;
        border-bottom-right-radius: ${h(20)} !important;
      }
      .NameBanner[data-size="2"] {
        padding: ${h(12)} ${h(20)} !important;
        font-size: ${h(28)} !important;
        border-top-right-radius: ${h(16)} !important;
        border-bottom-right-radius: ${h(16)} !important;
      }
      .NameBanner[data-size="1"], .NameBanner[data-size="0"] {
        padding: ${h(8)} ${h(8)} !important;
        font-size: ${h(20)} !important;
        border-top-right-radius: ${h(8)} !important;
        border-bottom-right-radius: ${h(8)} !important;
      }
      .NameBanner[data-size="0"] {
        opacity: 0;
        transform: translateX(-100%);
      }
    `},minimal:(a="#ABABAB",s=!0,d=1280/1920)=>{const c="white",l="#fff",p="#000",h=v=>v*d+"px";return`

      .ChatOverlay-badge-icon {
          width:${h(32)};
          height: ${h(32)};
          fill: currentcolor;
          color: ${p};
      }

       .ChatOverlay-badge-container {
          background-color:${l};
          display:flex;
          flex-direction:row;
          padding: ${h(6)} ${h(12)} ${h(6)} ${h(6)};
          align-items: center;
          position: relative;
          border: none;
          cursor: pointer;
       }

       .ChatOverlay-badge-username {
          color:${p};
          padding:${h(6)};
          font-size:${h(18)};
          font-weight:700;
          text-transform: capitalize; 
       }

       .ChatOverlay-avatar {
          height: ${h(120)};
          width: ${h(120)};
          left:0;
          right:0;
          top:0;
          bottom:0;
          border-radius:50%;
       }


    .Banner, .NameBanner, .ChatOverlay {
        background: ${color(a).fade(color(a).alpha()*.7).toString()} !important;
        padding: ${h(40)} ${h(40)} ${h(40)} ${h(60)} !important;
        position: relative !important;
        margin-bottom: ${h(40)} !important;
        transition: 300ms ease all;
        font-size: ${h(34)} !important;
        left: 0;
      }

      .Banner:before, .NameBanner:before, .ChatOverlay:before {
        z-index: 1;
        content: "";
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.6);
        transition: 300ms ease all;
        opacity: ${color(a).alpha()};
      }
      .Banner:after, .NameBanner:after, .ChatOverlay:after {
        z-index: 1;
        content: "";
        position: absolute;
        left: 0;
        top: 0;
        height: 100%;
        transition: 300ms ease all;
        width: ${h(20)};
        background: ${color(a)};
        opacity: ${color(a).alpha()};
      }
      .Banner-body, .NameBanner-body, .ChatOverlay-body {
        color: ${c} !important;
        font-family: 'Roboto' !important;
        font-style: normal !important;
        font-weight: 700 !important;
        line-height: 120% !important;
        position: relative;
        z-index: 2;
      }
      .Banner-header {
        font-size: ${h(90)};
        position: relative;
        z-index: 2;
      }
      .NameBanner {
        transform-origin: 0 100%;
        margin: 0 !important;
        transform: translateX(-100%);
        opacity: 0 !important;
        white-space: nowrap;
        ${s&&`
          opacity: 1 !important;
          transform: translateX(0);
        `}
      }

      .NameBanner[data-size="4"] {
        padding: ${h(40)} ${h(40)} ${h(40)} ${h(40+20)} !important;
        font-size: ${h(34)} !important;
      }
      .NameBanner[data-size="3"] {
        padding: ${h(16)} ${h(40)} ${h(16)} ${h(40+20)} !important;
        font-size: ${h(34)} !important;
      }
      .NameBanner[data-size="2"] {
        padding: ${h(12)} ${h(24)} ${h(12)} ${h(24+20)} !important;
        font-size: ${h(24)} !important;
      }
      .NameBanner[data-size="1"], .NameBanner[data-size="0"] {
        padding: ${h(12)} ${h(16)} ${h(12)} ${h(16+20)} !important;
        font-size: ${h(18)} !important;
      }
      .NameBanner[data-size="0"] {
        opacity: 0 !important;
        transform: translateX(-100%);
      }
    `},bubble:(a="#ABABAB",s=!0,d=1280/1920)=>{const c=color(a).lightness()<.6?"#FFF":"#000",l=color(a).lightness()<.6?"#FFF":"#000",p=color(a).lightness()<.6?"#000":"#FFF",h=v=>v*d+"px";return`
      .ChatOverlay-badge-icon {
          width:${h(32)};
          height: ${h(32)};
          fill: currentcolor;
          color: ${p};
      }


       .ChatOverlay-badge-container {
          background-color:${l};
          display:flex;
          flex-direction:row;
          padding: ${h(6)} ${h(12)} ${h(6)} ${h(6)};
          align-items: center;
          z-index: 1;
          border: none;
          cursor: pointer;
          top: 0;
          margin-bottom: 2px;
          margin-left: -${h(30)};
          border-radius: 30px;
       }

       .ChatOverlay-badge-username {
          color:${p};
          padding:${h(6)};
          font-size:${h(18)};
          font-weight:700;
          text-transform: capitalize; 
       }

       .ChatOverlayAvatar-container {
          height: ${h(120)};
          width: ${h(120)};
          top: 0;
       }
       .ChatOverlay-avatar {
          height: ${h(120)};
          width: ${h(120)};
          left:0;
          right:0;
          top:0;
          bottom:0;
          border-radius:50%;
       }


      .Banner, .ChatOverlay {
        transform: translateX(-50%);
        left: 50%;
        margin-bottom: ${h(40)} !important;
      }

      .Banner, .NameBanner, .ChatOverlay {
        background: ${color(a)} !important;
        color: ${c} !important;
        border-radius: 500px !important;
        transition: 300ms ease all;

        /* Default Style */
        border: 4px solid ${c} !important;
        padding: ${h(40)} ${h(80)} !important;
        font-size: ${h(40)} !important;
      }
      .Banner-body, .NameBanner-body, .ChatOverlay-body {
        color: ${c} !important;
        text-align: center !important;
        font-family: 'Roboto' !important;
        font-style: normal !important;
        font-weight: 700 !important;
        line-height: 120% !important;
      }
      .NameBanner {
        transform-origin: 0% 100%;
        transform: translateX(-100%);
        opacity: 0 !important;
        white-space: nowrap;
        ${s&&`
          opacity: 1 !important;
          transform: translateX(0);
        `}
      }

      ls-layout[layout="Presentation"][props*="\\"cover\\"\\:true"] > :first-child .NameBanner {
        top: 0% !important;
        transform: translateY(0%) !important;
        margin: ${h(20)} ${h(20)};
      }


      .NameBanner[data-size="4"] {
        padding: ${h(40)} ${h(80)} ${h(40)} ${h(80)} !important;
        font-size: ${h(40)} !important;
      }
      .NameBanner[data-size="3"] {
        padding: ${h(12)} ${h(30)} ${h(12)} ${h(30)} !important;
        font-size: ${h(40)} !important;
        margin: -${h(20)} ${h(20)};
      }
      .NameBanner[data-size="2"] {
        padding: ${h(12)} ${h(30)} ${h(12)} ${h(30)} !important;
        font-size: ${h(26)} !important;
        margin: -${h(8)} ${h(8)};
      }
      .NameBanner[data-size="1"], .NameBanner[data-size="0"] {
        padding: ${h(8)} ${h(16)} ${h(8)} ${h(16)} !important;
        font-size: ${h(18)} !important;
        border-width: ${h(2)} !important;
        margin: -${h(16)} ${h(8)};
      }
      .NameBanner[data-size="0"] {
        opacity: 0 !important;
        transform: translateX(-100%);
      }
    `}};var compositor$1=Object.freeze(Object.defineProperty({__proto__:null,render:render$1,CompositorContext,LogoPosition,BannerStyle,PlatformType},Symbol.toStringTag,{value:"Module"}));const iconStyles={twitch:{icon:"Twitch"},youtube:{icon:"YouTube"},facebook:{icon:"Facebook"}},fixLink=a=>!a.startsWith("http:")&&!a.startsWith("https:")?`https://${a}`:a,ChatOverlay={name:"LS-ChatOverlay",sourceType:"ChatOverlay",create({onUpdate:a,onEvent:s},d){const c=document.createElement("div"),l=getProject(CoreContext.state.activeProjectId),p=l.compositor.getRoot(),{x:h}=p.props.size,v=(h!=null?h:1280)/1920,S=P=>P*v+"px";let b;const _=(P,$)=>{const U=P.width/$.width;return P.height/$.height>=.25&&U>=.75?4:U>=.75?1:U>=.5?-2:U>.25?-3:-4};CoreContext.onInternal("ProjectChanged",()=>{var $;const{bannerStyle:P}=($=l.props)!=null?$:{};P&&w({...b,metadata:{...b.metadata,bannerStyle:P}})});const I=React__default.default.memo(P=>{var $,U,E;return(P==null?void 0:P.type)==="emoticon"&&(($=P==null?void 0:P.data)==null?void 0:$.type)==="direct"?React__default.default.createElement("img",{src:(U=P==null?void 0:P.data)==null?void 0:U.url,style:{height:S(36)},alt:P==null?void 0:P.text}):(P==null?void 0:P.type)==="link"?React__default.default.createElement("a",{style:{color:"#FFF",wordBreak:"break-all"},target:"_blank",rel:"noreferrer",href:fixLink((E=P==null?void 0:P.data)==null?void 0:E.url)},P==null?void 0:P.text):React__default.default.createElement("span",null,P==null?void 0:P.text)}),T=P=>{const $={height:`${P.height}`,width:`${P.width}`,background:P.background||"transparent",display:"inline-block",verticalAlign:"middle",borderRadius:"50%",fontSize:`${P.fontSize}`};return React__default.default.createElement("div",{style:{...$,position:"relative",marginRight:P==null?void 0:P.marginRight}},React__default.default.createElement("div",{style:{left:"50%",position:"absolute",top:"50%",transform:"translate(-50%, -50%)"}},P.username.substring(0,2).toUpperCase()))},k=P=>{const{message:$,id:U,username:E,metadata:D}=P||{},[F,J]=React.useState(0),{index:G,platform:x,avatar:Y,bannerStyle:N}=D||{},z=React.useMemo(()=>iconStyles[x],[x]),Z=React.useRef();return React.useLayoutEffect(()=>{if(!Z.current)return;const L=()=>{const H=Z.current;H&&J(_({width:H.clientWidth,height:H.clientHeight},{width:l.compositor.getRoot().props.size.x,height:l.compositor.getRoot().props.size.y}))},V=new ResizeObserver(H=>{L()});return L(),V.observe(Z.current),()=>{Z!=null&&Z.current&&V.unobserve(Z==null?void 0:Z.current)}},[Z.current,l]),React__default.default.createElement(APIKitAnimation,{id:`${U}_${G}`,type:"chatoverlay",enter:APIKitAnimationTypes.SLIDE_IN_LEFT,exit:APIKitAnimationTypes.SLIDE_OUT_LEFT,duration:200},React__default.default.createElement("div",{className:"ChatOverlayContainer",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"flex-end",marginLeft:N!==BannerStyle.BUBBLE?"5%":"0px"}},N!==BannerStyle.BUBBLE?React__default.default.createElement("div",{style:{width:"100%",display:"flex"}},Y?React__default.default.createElement("span",{style:{marginRight:"20px"}},React__default.default.createElement("img",{src:Y,className:"ChatOverlay-avatar"})):React__default.default.createElement(T,{height:S(110),width:S(120),background:primary(500),username:E,marginRight:20,fontSize:S(30)}),React__default.default.createElement("div",{style:{width:"100%"}},E&&React__default.default.createElement("button",{className:"ChatOverlay-badge-container"},(z==null?void 0:z.icon)&&React__default.default.createElement(Icon,{className:"ChatOverlay-badge-icon",name:z==null?void 0:z.icon}),React__default.default.createElement("div",{className:"ChatOverlay-badge-username"},E)),React__default.default.createElement("div",{className:"ChatOverlay",style:{padding:10,background:"orange",width:"fit-content",height:"fit-content",maxWidth:"84%",position:"relative"}},$&&React__default.default.createElement("div",{className:"ChatOverlay-body",style:{gap:10,display:"flex",alignItems:"center",flexWrap:"wrap",verticalAlign:"middle"}},$.map((L,V)=>React__default.default.createElement(I,{key:V,...L})))))):React__default.default.createElement("div",{style:{width:"100%",display:"flex"}},React__default.default.createElement("div",{className:"ChatOverlay",style:{padding:10,background:"orange",width:"fit-content",height:"fit-content",maxWidth:"84%",position:"relative"}},React__default.default.createElement("div",{style:{display:"flex",marginTop:`-${S(160)}`,alignItems:"flex-end",padding:`${S(14)} ${S(0)} ${S(14)} ${S(0)}`,marginLeft:`${F*10}px`}},Y?React__default.default.createElement("div",{className:"ChatOverlayAvatar-container"},React__default.default.createElement("img",{src:Y,className:"ChatOverlay-avatar"})):React__default.default.createElement("div",{className:"ChatOverlayAvatar-container"},React__default.default.createElement(T,{height:S(120),width:S(120),background:primary(500),username:E,fontSize:S(30)})),E&&React__default.default.createElement("button",{className:"ChatOverlay-badge-container"},(z==null?void 0:z.icon)&&React__default.default.createElement(Icon,{className:"ChatOverlay-badge-icon",name:z==null?void 0:z.icon}),React__default.default.createElement("div",{className:"ChatOverlay-badge-username"},E))),$&&React__default.default.createElement("div",{ref:Z,className:"ChatOverlay-body",style:{gap:10,alignItems:"center",flexWrap:"wrap",verticalAlign:"middle"}},$.map((L,V)=>React__default.default.createElement(I,{key:V,...L})))))))},w=P=>ReactDOM__default.default.render(React__default.default.createElement(k,{...P}),c);return a(P=>{var U;const{bannerStyle:$=BannerStyle.DEFAULT}=(U=l.props)!=null?U:{};b={...P,metadata:{...P.metadata,bannerStyle:$}},w(b)}),{root:c}}},Background$1={name:"LS-Background",sourceType:"Background",create({onUpdate:a,onRemove:s},{sourceProps:d}){s(()=>{clearInterval(p)});const c=document.createElement("div"),l=getProject(CoreContext.state.activeProjectId).role;let p;const h=({source:_,setStartAnimation:I})=>{var Y,N;const{src:T,type:k,meta:w,loop:P}=(_==null?void 0:_.sourceProps)||{},{id:$,sourceType:U}=_||{},[E,D]=React__default.default.useState(null),F=React__default.default.useRef(null);console.log("Updated current time",(Y=F==null?void 0:F.current)==null?void 0:Y.currentTime);const J=React__default.default.useCallback(z=>{F.current=z,D(z?z.id:null)},[]),G=React__default.default.useCallback(()=>{F!=null&&F.current&&F.current.play().catch(()=>{var z;F.current.muted=!0,(z=F.current)==null||z.play()})},[T]),x=React__default.default.useCallback(()=>{p&&clearInterval(p),hasPermission(l,Permission.UpdateProject)&&trigger$1("VideoEnded",{id:$,category:k})},[T]);return React__default.default.useEffect(()=>{w&&(F==null?void 0:F.current)&&E&&hasPermission(l,Permission.ManageSelf)&&w!=null&&w.time&&(F.current.currentTime=Number(w==null?void 0:w.time))},[w==null?void 0:w.time,E]),React__default.default.useEffect(()=>()=>{p&&clearInterval(p)},[$]),React__default.default.useEffect(()=>{E?F.current&&(F.current.src=T,F.current.play().catch(()=>{F.current.muted=!0,F.current.play()}),hasPermission(l,Permission.UpdateProject)&&(p=setInterval(()=>{if(F.current.duration){const z=F.current.duration-F.current.currentTime;trigger$1("VideoTimeUpdate",{category:U,id:$,time:Math.floor(z)})}},1e3))):p&&clearInterval(p)},[E]),React__default.default.createElement(React__default.default.Fragment,{key:$},T&&React__default.default.createElement("video",{loop:P,id:$,ref:J,style:{...(N=d==null?void 0:d.meta)==null?void 0:N.style,...w.style},onLoadedData:G,onEnded:x,onCanPlay:()=>I(!0)}))},v=({source:_,setStartAnimation:I})=>{var $;const{src:T,meta:k,type:w}=(_==null?void 0:_.sourceProps)||{},{id:P}=_||{};return React__default.default.createElement(React__default.default.Fragment,{key:P},T&&React__default.default.createElement("img",{style:{...($=d==null?void 0:d.meta)==null?void 0:$.style,...k==null?void 0:k.style},src:T,onLoad:()=>I(!0)}))},S=({source:_})=>{const{type:I}=_.sourceProps,{id:T}=_||{},[k,w]=React__default.default.useState(!1);return React.useEffect(()=>{w(!1)},[T]),React__default.default.createElement(APIKitAnimation,{id:T,type:"background",enter:APIKitAnimationTypes.FADE_IN,exit:APIKitAnimationTypes.FADE_OUT,duration:400},React__default.default.createElement("div",{style:{opacity:k?1:0},className:"backgroundContainer background-transition"},T&&I==="image"&&React__default.default.createElement(v,{source:_,setStartAnimation:w}),T&&I==="video"&&React__default.default.createElement(h,{source:_,setStartAnimation:w})))},b=_=>ReactDOM__default.default.render(React__default.default.createElement(React__default.default.Fragment,null,React__default.default.createElement(S,{source:_})),c);return a(_=>{b({..._})}),{root:c}}},SourceTriggerMap=[{sourceType:"Overlay",trigger:"OverlayMetadataUpdate"},{sourceType:"Background",trigger:"BackgroundMetadataUpdate"}],Video2={name:"LS-Video-2",sourceType:"Video2",props:{id:{type:String,required:!0}},useSource(a,s){return a.find(d=>d.props.type===s.id)},create({onUpdate:a,onNewSource:s,onRemove:d},c){d(()=>{clearInterval(S)});const l=document.createElement("div"),p=getProjectRoom(CoreContext.state.activeProjectId),h=getProject(CoreContext.state.activeProjectId).role;let v,S;const b=({source:I})=>{var z;const T=SourceTriggerMap.find(Z=>Z.sourceType===c.proxySource),{src:k,type:w,meta:P,loop:$}=(I==null?void 0:I.value)||{},{id:U}=I||{},[E,D]=React__default.default.useState(null),F=React__default.default.useRef(null),[J,G]=React__default.default.useState(!1);console.log("Updated current time",(z=F==null?void 0:F.current)==null?void 0:z.currentTime),React__default.default.useEffect(()=>{G(!1)},[U]);const x=React__default.default.useCallback(Z=>{F.current=Z,D(Z?Z.id:null)},[]),Y=React__default.default.useCallback(()=>{F!=null&&F.current&&F.current.play().catch(()=>{var Z;F.current.muted=!0,(Z=F.current)==null||Z.play()})},[k]),N=React__default.default.useCallback(()=>{S&&clearInterval(S),trigger$1("VideoEnded",{id:U,category:w})},[k]);return React__default.default.useEffect(()=>{P&&(F==null?void 0:F.current)&&E&&hasPermission(h,Permission.ManageSelf)&&(F.current.currentTime=Number(P==null?void 0:P.time))},[P==null?void 0:P.time,E]),React__default.default.useEffect(()=>()=>{S&&clearInterval(S)},[U]),React__default.default.useEffect(()=>{if(!E)S&&clearInterval(S);else if(F.current)return F.current.src=k,$&&(F.current.loop=Boolean($)),F.current.play().catch(()=>{F.current.muted=!0,F.current.play()}),S=setInterval(()=>{if(F.current.duration){const Z=F.current.duration-F.current.currentTime;trigger$1("VideoTimeUpdate",{category:w,id:U,time:Math.floor(Z)})}},1e3),p==null?void 0:p.onData((Z,L)=>{var V,H;(V=F==null?void 0:F.current)!=null&&V.currentTime&&Z.type==="UserJoined"&&hasPermission(h,Permission.ManageGuests)&&triggerInternal$1(T.trigger,{projectId:CoreContext.state.activeProjectId,role:h,sourceId:E,doTrigger:!0,metadata:{time:Math.floor((H=F==null?void 0:F.current)==null?void 0:H.currentTime)||0,owner:p==null?void 0:p.participantId,guest:L}})})},[E]),React__default.default.createElement(APIKitAnimation,{id:U,type:"video",enter:APIKitAnimationTypes.FADE_IN,exit:APIKitAnimationTypes.FADE_OUT,duration:400},React__default.default.createElement("div",{style:{opacity:J?1:0,width:"100%",height:"100%"},className:"video-transition"},k&&React__default.default.createElement("video",{id:U,ref:x,style:c.style,...c.props,onLoadedData:Y,onEnded:N,onCanPlayThrough:()=>G(!0)})))},_=()=>ReactDOM__default.default.render(React__default.default.createElement(b,{source:v}),l);return a(()=>{_()}),s(I=>{v=I,_()}),{root:l}}},Image2={name:"LS-Image-2",sourceType:"Image2",props:{id:{type:String,required:!0}},useSource(a,s){return a.find(d=>d.props.type===s.id)},create({onUpdate:a,onNewSource:s},d){const c=document.createElement("div");let l;const p=({source:v})=>{const{src:S,meta:b}=(v==null?void 0:v.value)||{},{id:_}=v||{},[I,T]=React__default.default.useState(!1);return React__default.default.useEffect(()=>{T(!1)},[_]),React__default.default.createElement(APIKitAnimation,{id:_,type:"image",enter:APIKitAnimationTypes.FADE_IN,exit:APIKitAnimationTypes.FADE_OUT,duration:400},React__default.default.createElement("div",{style:{opacity:I?1:0,width:"100%",height:"100%"},className:"image-transition"},S&&React__default.default.createElement("img",{style:{...d==null?void 0:d.style,...b==null?void 0:b.style},src:S,onLoad:()=>T(!0)})))},h=()=>ReactDOM__default.default.render(React__default.default.createElement(p,{source:l}),c);return a(()=>{h()}),s(v=>{l=v,h()}),{root:c}}},RTMPSource={name:"LS-RTMP-Source",sourceType:"RTMP",props:{},useSource(a,s){return a.find(d=>isMatch(d.props,s.sourceProps))},create({onUpdate:a,onNewSource:s,onRemove:d},c){const l=document.createElement("div"),p=getProject(CoreContext.state.activeProjectId);getProjectRoom(CoreContext.state.activeProjectId),Object.assign(l.style,{position:"relative"});let h,v=c;const S=(I,T)=>{const k=I/T.width;return k>=.5?3:k>.25?2:k>.15?1:0},b=({props:I,source:T})=>{var F,J;const k=React.useRef(),{volume:w=1,isHidden:P=!1}=I||{},[$,U]=React.useState(0),E=I==null?void 0:I.isMuted,D=!(I!=null&&I.isHidden)&&((F=T==null?void 0:T.props)==null?void 0:F.videoEnabled);return React.useEffect(()=>{!k.current||(k.current.play().catch(G=>{document.addEventListener("click",()=>{var x;return(x=k.current)==null?void 0:x.play()},{once:!0})}),(T==null?void 0:T.value)&&(T==null?void 0:T.value)!==k.current.srcObject?k.current.srcObject=T==null?void 0:T.value:T!=null&&T.value||(k.current.srcObject=null))},[k.current,T==null?void 0:T.value]),React.useEffect(()=>{!I&&k.current&&(k.current.srcObject=null,k.current=null)},[I]),React.useLayoutEffect(()=>{if(!k.current)return;const G=()=>{const Y=k.current;Y&&U(S(Y.clientWidth,{width:p.compositor.getRoot().props.size.x,height:p.compositor.getRoot().props.size.y}))},x=new ResizeObserver(Y=>{G()});return G(),x==null||x.observe(k.current),()=>{k.current&&(x==null||x.unobserve(k.current),k.current.srcObject=null)}},[k.current,p]),React.useEffect(()=>{!k.current||(k.current.volume=w)},[k.current,w]),React__default.default.createElement("div",{style:{position:"relative",display:"flex",height:"100%",width:"100%"}},React__default.default.createElement("div",{style:{background:"#222",position:"absolute",height:"100%",width:"100%",fontSize:"43px",color:"rgba(255,255,255,0.6)",display:"flex",alignItems:"center",justifyContent:"center",opacity:D?"0":"1"}},Boolean(T)&&React__default.default.createElement("div",{style:{borderRadius:"50%",background:"#555",width:"70px",height:"70px",textTransform:"uppercase",display:"flex",alignItems:"center",justifyContent:"center",lineHeight:"1em"}},"RTMP")),React__default.default.createElement("div",{style:{position:"relative",display:"flex",height:"100%",width:"100%",...Boolean((J=T==null?void 0:T.props)==null?void 0:J.mirrored)&&{transform:"scaleX(-1)"}}},React__default.default.createElement("video",{ref:k,autoPlay:!0,muted:E,disablePictureInPicture:!0,playsInline:!0,style:{left:"50%",top:"50%",position:"relative",transform:"translate3d(-50%, -50%, 0)",height:"100%",opacity:D?"1":"0",objectFit:"cover",background:"rgba(0,0,0,0.6)"}})),Boolean(T==null?void 0:T.props.displayName)&&React__default.default.createElement("div",{className:"NameBannerContainer",style:{width:"100%",height:"100%",position:"absolute"}},React__default.default.createElement("div",{className:"NameBanner","data-size":$,style:{padding:"12px 30px",width:"fit-content",height:"fit-content",top:"100%",transform:"translateY(-100%)",left:0}},React__default.default.createElement("div",{className:"NameBanner-body"},T==null?void 0:T.props.displayName))))},_=()=>ReactDOM__default.default.render(React__default.default.createElement(b,{source:h,props:v}),l);return a(I=>{v=I,_()}),s(I=>{h=I,_()}),d(I=>{v=I,_()}),{root:l}}};var Transforms=Object.freeze(Object.defineProperty({__proto__:null,RoomParticipant:RoomParticipant$1,Square,Image:Image$1,Element,Video,Banner:Banner$1,Logo:Logo$1,Overlay,ChatOverlay,Background:Background$1,Video2,Image2,RTMPSource},Symbol.toStringTag,{value:"Module"}));/*! (c) Andrea Giammarchi - ISC */var self$1={};try{self$1.WeakMap=WeakMap}catch(a){self$1.WeakMap=function(s,d){var c=d.defineProperty,l=d.hasOwnProperty,p=h.prototype;return p.delete=function(S){return this.has(S)&&delete S[this._]},p.get=function(S){return this.has(S)?S[this._]:void 0},p.has=function(S){return l.call(S,this._)},p.set=function(S,b){return c(S,this._,{configurable:!0,value:b}),this},h;function h(S){c(this,"_",{value:"_@ungap/weakmap"+s++}),S&&S.forEach(v,this)}function v(S){this.set(S[0],S[1])}}(Math.random(),Object)}var WeakMap$1=self$1.WeakMap;/*! (c) Andrea Giammarchi - ISC */var UID="-"+Math.random().toFixed(6)+"%",UID_IE=!1;try{(function(a,s,d){return s in a&&(a.innerHTML="<p "+d+'="'+UID+'"></p>',a[s].childNodes[0].getAttribute(d)==UID)})(document.createElement("template"),"content","tabindex")||(UID="_dt: "+UID.slice(1,-1)+";",UID_IE=!0)}catch(a){}var UIDC="<!--"+UID+"-->",COMMENT_NODE=8,ELEMENT_NODE$1=1,TEXT_NODE=3,SHOULD_USE_TEXT_CONTENT=/^(?:plaintext|script|style|textarea|title|xmp)$/i,VOID_ELEMENTS=/^(?:area|base|br|col|embed|hr|img|input|keygen|link|menuitem|meta|param|source|track|wbr)$/i;/*! (c) Andrea Giammarchi - ISC */function domsanitizer(a){return a.join(UIDC).replace(selfClosing,fullClosing).replace(attrSeeker,attrReplacer)}var spaces=" \\f\\n\\r\\t",almostEverything="[^"+spaces+`\\/>"'=]+`,attrName="["+spaces+"]+"+almostEverything,tagName="<([A-Za-z]+[A-Za-z0-9:._-]*)((?:",attrPartials=`(?:\\s*=\\s*(?:'[^']*?'|"[^"]*?"|<[^>]*?>|`+almostEverything.replace("\\/","")+"))?)",attrSeeker=new RegExp(tagName+attrName+attrPartials+"+)(["+spaces+"]*/?>)","g"),selfClosing=new RegExp(tagName+attrName+attrPartials+"*)(["+spaces+"]*/>)","g"),findAttributes=new RegExp("("+attrName+`\\s*=\\s*)(['"]?)`+UIDC+"\\2","gi");function attrReplacer(a,s,d,c){return"<"+s+d.replace(findAttributes,replaceAttributes)+c}function replaceAttributes(a,s,d){return s+(d||'"')+UID+(d||'"')}function fullClosing(a,s,d){return VOID_ELEMENTS.test(s)?a:"<"+s+d+"></"+s+">"}const{isArray}=Array,{indexOf,slice}=[];var umap=a=>({get:s=>a.get(s),set:(s,d)=>(a.set(s,d),d)});const ELEMENT_NODE=1,nodeType=111,remove=({firstChild:a,lastChild:s})=>{const d=document.createRange();return d.setStartAfter(a),d.setEndAfter(s),d.deleteContents(),a},diffable=(a,s)=>a.nodeType===nodeType?1/s<0?s?remove(a):a.lastChild:s?a.valueOf():a.firstChild:a,persistent=a=>{const{childNodes:s}=a,{length:d}=s;if(d<2)return d?s[0]:a;const c=slice.call(s,0),l=c[0],p=c[d-1];return{ELEMENT_NODE,nodeType,firstChild:l,lastChild:p,valueOf(){if(s.length!==d){let h=0;for(;h<d;)a.appendChild(c[h++])}return a}}};/*! (c) Andrea Giammarchi - ISC */var createContent=function(a){var s="fragment",d="template",c="content"in h(d),l=c?function(S){var b=h(d);return b.innerHTML=S,b.content}:function(S){var b=h(s),_=h(d),I=null;if(/^[^\S]*?<(col(?:group)?|t(?:head|body|foot|r|d|h))/i.test(S)){var T=RegExp.$1;_.innerHTML="<table>"+S+"</table>",I=_.querySelectorAll(T)}else _.innerHTML=S,I=_.childNodes;return p(b,I),b};return function(b,_){return(_==="svg"?v:l)(b)};function p(S,b){for(var _=b.length;_--;)S.appendChild(b[0])}function h(S){return S===s?a.createDocumentFragment():a.createElementNS("http://www.w3.org/1999/xhtml",S)}function v(S){var b=h(s),_=h("div");return _.innerHTML='<svg xmlns="http://www.w3.org/2000/svg">'+S+"</svg>",p(b,_.firstChild.childNodes),b}}(document),udomdiff=(a,s,d,c,l)=>{const p=d.length;let h=s.length,v=p,S=0,b=0,_=null;for(;S<h||b<v;)if(h===S){const I=v<p?b?c(d[b-1],-0).nextSibling:c(d[v-b],0):l;for(;b<v;)a.insertBefore(c(d[b++],1),I)}else if(v===b)for(;S<h;)(!_||!_.has(s[S]))&&a.removeChild(c(s[S],-1)),S++;else if(s[S]===d[b])S++,b++;else if(s[h-1]===d[v-1])h--,v--;else if(s[S]===d[v-1]&&d[b]===s[h-1]){const I=c(s[--h],-1).nextSibling;a.insertBefore(c(d[b++],1),c(s[S++],-1).nextSibling),a.insertBefore(c(d[--v],1),I),s[h]=d[v]}else{if(!_){_=new Map;let I=b;for(;I<v;)_.set(d[I],I++)}if(_.has(s[S])){const I=_.get(s[S]);if(b<I&&I<v){let T=S,k=1;for(;++T<h&&T<v&&_.get(s[T])===I+k;)k++;if(k>I-b){const w=c(s[S],0);for(;b<I;)a.insertBefore(c(d[b++],1),w)}else a.replaceChild(c(d[b++],1),c(s[S++],-1))}else S++}else a.removeChild(c(s[S++],-1))}return d};/*! (c) Andrea Giammarchi - ISC */var importNode=function(a,s,d,c,l){var p=l in a,h=a.createDocumentFragment();h[s](a[c]("g")),h[s](a[c](""));var v=p?a[l](h,!0):h[d](!0);return v.childNodes.length<2?function S(b,_){for(var I=b[d](),T=b.childNodes||[],k=T.length,w=0;_&&w<k;w++)I[s](S(T[w],_));return I}:p?a[l]:function(S,b){return S[d](!!b)}}(document,"appendChild","cloneNode","createTextNode","importNode"),trim="".trim||function(){return String(this).replace(/^\s+|\s+/g,"")},normalizeAttributes=UID_IE?function(a,s){var d=s.join(" ");return s.slice.call(a,0).sort(function(c,l){return d.indexOf(c.name)<=d.indexOf(l.name)?-1:1})}:function(a,s){return s.slice.call(a,0)};function find(a,s){for(var d=s.length,c=0;c<d;)a=a.childNodes[s[c++]];return a}function parse(a,s,d,c){for(var l=a.childNodes,p=l.length,h=0;h<p;){var v=l[h];switch(v.nodeType){case ELEMENT_NODE$1:var S=c.concat(h);parseAttributes(v,s,d,S),parse(v,s,d,S);break;case COMMENT_NODE:var b=v.textContent;if(b===UID)d.shift(),s.push(SHOULD_USE_TEXT_CONTENT.test(a.nodeName)?Text(a,c):Any(v,c.concat(h)));else switch(b.slice(0,2)){case"/*":if(b.slice(-2)!=="*/")break;case"\u{1F47B}":a.removeChild(v),h--,p--}break;case TEXT_NODE:SHOULD_USE_TEXT_CONTENT.test(a.nodeName)&&trim.call(v.textContent)===UIDC&&(d.shift(),s.push(Text(a,c)));break}h++}}function parseAttributes(a,s,d,c){for(var l=a.attributes,p=[],h=[],v=normalizeAttributes(l,d),S=v.length,b=0;b<S;){var _=v[b++],I=_.value===UID,T;if(I||1<(T=_.value.split(UIDC)).length){var k=_.name;if(p.indexOf(k)<0){p.push(k);var w=d.shift().replace(I?/^(?:|[\S\s]*?\s)(\S+?)\s*=\s*('|")?$/:new RegExp("^(?:|[\\S\\s]*?\\s)("+k+`)\\s*=\\s*('|")[\\S\\s]*`,"i"),"$1"),P=l[w]||l[w.toLowerCase()];if(I)s.push(Attr(P,c,w,null));else{for(var $=T.length-2;$--;)d.shift();s.push(Attr(P,c,w,T))}}h.push(_)}}S=h.length,b=0;for(var U=0<S&&UID_IE&&!("ownerSVGElement"in a);b<S;){var E=h[b++];U&&(E.value=""),a.removeAttribute(E.name)}var D=a.nodeName;if(/^script$/i.test(D)){var F=document.createElement(D);for(S=l.length,b=0;b<S;)F.setAttributeNode(l[b++].cloneNode(!0));F.textContent=a.textContent,a.parentNode.replaceChild(F,a)}}function Any(a,s){return{type:"any",node:a,path:s}}function Attr(a,s,d,c){return{type:"attr",node:a,path:s,name:d,sparse:c}}function Text(a,s){return{type:"text",node:a,path:s}}var parsed=umap(new WeakMap$1);function createInfo(a,s){var d=(a.convert||domsanitizer)(s),c=a.transform;c&&(d=c(d));var l=createContent(d,a.type);cleanContent(l);var p=[];return parse(l,p,s.slice(0),[]),{content:l,updates:function(h){for(var v=[],S=p.length,b=0,_=0;b<S;){var I=p[b++],T=find(h,I.path);switch(I.type){case"any":v.push({fn:a.any(T,[]),sparse:!1});break;case"attr":var k=I.sparse,w=a.attribute(T,I.name,I.node);k===null?v.push({fn:w,sparse:!1}):(_+=k.length-2,v.push({fn:w,sparse:!0,values:k}));break;case"text":v.push({fn:a.text(T),sparse:!1}),T.textContent="";break}}return S+=_,function(){var P=arguments.length;if(S!==P-1)throw new Error(P-1+" values instead of "+S+`
`+s.join("${value}"));for(var $=1,U=1;$<P;){var E=v[$-U];if(E.sparse){var D=E.values,F=D[0],J=1,G=D.length;for(U+=G-2;J<G;)F+=arguments[$++]+D[J++];E.fn(F)}else E.fn(arguments[$++])}return h}}}}function createDetails(a,s){var d=parsed.get(s)||parsed.set(s,createInfo(a,s));return d.updates(importNode.call(document,d.content,!0))}var empty=[];function domtagger(a){var s=empty,d=cleanContent;return function(c){return s!==c&&(d=createDetails(a,s=c)),d.apply(null,arguments)}}function cleanContent(a){for(var s=a.childNodes,d=s.length;d--;){var c=s[d];c.nodeType!==1&&trim.call(c.textContent).length===0&&a.removeChild(c)}}/*! (c) Andrea Giammarchi - ISC */var hyperStyle=function(){var a=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,s=/([^A-Z])([A-Z]+)/g;return function(v,S){return"ownerSVGElement"in v?c(v,S):p(v.style,!1)};function d(h,v,S){return v+"-"+S.toLowerCase()}function c(h,v){var S;return v?S=v.cloneNode(!0):(h.setAttribute("style","--hyper:style;"),S=h.getAttributeNode("style")),S.value="",h.setAttributeNode(S),p(S,!0)}function l(h){var v,S=[];for(v in h)S.push(v.replace(s,d),":",h[v],";");return S.join("")}function p(h,v){var S,b;return function(_){var I,T,k,w;switch(typeof _){case"object":if(_){if(S==="object"){if(!v&&b!==_)for(T in b)T in _||(h[T]="")}else v?h.value="":h.cssText="";I=v?{}:h;for(T in _)w=_[T],k=typeof w=="number"&&!a.test(T)?w+"px":w,!v&&/^--/.test(T)?I.setProperty(T,k):I[T]=k;S="object",v?h.value=l(b=I):b=_;break}default:b!=_&&(S="string",b=_,v?h.value=_||"":h.cssText=_||"");break}}}}();const aria=a=>s=>{for(const d in s){const c=d==="role"?d:`aria-${d}`,l=s[d];l==null?a.removeAttribute(c):a.setAttribute(c,l)}},attribute=(a,s)=>{let d,c=!0;const l=document.createAttributeNS(null,s);return p=>{d!==p&&(d=p,d==null?c||(a.removeAttributeNode(l),c=!0):(l.value=p,c&&(a.setAttributeNodeNS(l),c=!1)))}},boolean=(a,s,d)=>c=>{d!==!!c&&((d=!!c)?a.setAttribute(s,""):a.removeAttribute(s))},data=({dataset:a})=>s=>{for(const d in s){const c=s[d];c==null?delete a[d]:a[d]=c}},event=(a,s)=>{let d,c=s.slice(2);return!(s in a)&&s.toLowerCase()in a&&(c=c.toLowerCase()),l=>{const p=isArray(l)?l:[l,!1];d!==p[0]&&(d&&a.removeEventListener(c,d,p[1]),(d=p[0])&&a.addEventListener(c,d,p[1]))}},ref=a=>s=>{typeof s=="function"?s(a):s.current=a},setter=(a,s)=>s==="dataset"?data(a):d=>{a[s]=d},hyperProperty=(a,s)=>{let d;return c=>{d!==c&&(d=c,a[s]!==c&&(c==null?(a[s]="",a.removeAttribute(s)):a[s]=c))}},readOnly=/^(?:form|list)$/i,text=(a,s)=>a.ownerDocument.createTextNode(s);function Tagger(a){return this.type=a,domtagger(this)}Tagger.prototype={attribute(a,s,d){const c=this.type==="svg";switch(s){case"class":if(c)return attribute(a,s);s="className";case"props":return setter(a,s);case"aria":return aria(a);case"style":return hyperStyle(a,d,c);case"ref":return ref(a);case".dataset":return data(a);default:return s.slice(0,1)==="."?setter(a,s.slice(1)):s.slice(0,1)==="?"?boolean(a,s.slice(1)):s.slice(0,2)==="on"?event(a,s):s in a&&!(c||readOnly.test(s))?hyperProperty(a,s):attribute(a,s)}},any(a,s){const{type:d}=this;let c=!1,l;const p=h=>{switch(typeof h){case"string":case"number":case"boolean":c?l!==h&&(l=h,s[0].textContent=h):(c=!0,l=h,s=udomdiff(a.parentNode,s,[text(a,h)],diffable,a));break;case"function":p(h(a));break;case"object":case"undefined":if(h==null){c=!1,s=udomdiff(a.parentNode,s,[],diffable,a);break}default:if(c=!1,l=h,isArray(h))if(h.length===0)s.length&&(s=udomdiff(a.parentNode,s,[],diffable,a));else switch(typeof h[0]){case"string":case"number":case"boolean":p(String(h));break;case"function":p(h.map(invoke,a));break;case"object":isArray(h[0])&&(h=h.concat.apply([],h));default:s=udomdiff(a.parentNode,s,h,diffable,a);break}else"ELEMENT_NODE"in h?s=udomdiff(a.parentNode,s,h.nodeType===11?slice.call(h.childNodes):[h],diffable,a):"text"in h?p(String(h.text)):"any"in h?p(h.any):"html"in h?s=udomdiff(a.parentNode,s,slice.call(createContent([].concat(h.html).join(""),d).childNodes),diffable,a):"length"in h&&p(slice.call(h));break}};return p},text(a){let s;const d=c=>{if(s!==c){s=c;const l=typeof c;l==="object"&&c?"text"in c?d(String(c.text)):"any"in c?d(c.any):"html"in c?d([].concat(c.html).join("")):"length"in c&&d(slice.call(c).join("")):l==="function"?d(c(a)):a.textContent=c==null?"":c}};return d}};function invoke(a){return a(this)}const{create:create$1,freeze,keys}=Object;Tagger.prototype;const cache=umap(new WeakMap$1),createRender=a=>({html:outer("html",a),svg:outer("svg",a),render(s,d){const c=typeof d=="function"?d():d,l=cache.get(s)||cache.set(s,createCache()),p=c instanceof LighterHole?unroll(a,l,c):c;return p!==l.wire&&(l.wire=p,s.textContent="",s.appendChild(p.valueOf())),s}}),createCache=()=>({stack:[],entry:null,wire:null}),outer=(a,s)=>{const d=umap(new WeakMap$1),c=p=>function(){return unroll(s,p,l.apply(null,arguments))};return l.for=(p,h)=>{const v=d.get(p)||d.set(p,create$1(null));return v[h]||(v[h]=c(createCache()))},l.node=function(){return unroll(s,createCache(),l.apply(null,arguments)).valueOf()},l;function l(){return new LighterHole(a,tta.apply(null,arguments))}},unroll=(a,s,{type:d,template:c,values:l})=>{const{length:p}=l;unrollValues(a,s,l,p);let{entry:h}=s;if(!h||h.template!==c||h.type!==d){const v=new a(d);s.entry=h={type:d,template:c,tag:v,wire:persistent(v(c,...l))}}else h.tag(c,...l);return h.wire},unrollValues=(a,{stack:s},d,c)=>{for(let l=0;l<c;l++){const p=d[l];p instanceof Hole?d[l]=unroll(a,s[l]||(s[l]=createCache()),p):isArray(p)?unrollValues(a,s[l]||(s[l]=createCache()),p,p.length):s[l]=null}c<s.length&&s.splice(c)};freeze(LighterHole);function LighterHole(a,s){this.type=a,this.template=s.shift(),this.values=s}const Hole=LighterHole,{render,html,svg}=createRender(Tagger);function tta(){let a=[],s=0,{length:d}=arguments;for(;s<d;)a.push(arguments[s++]);return a}const Free={name:"Free",layout:({props:a,children:s,size:d})=>s.reduce((c,l)=>{const{size:p={x:"100%",y:"100%"},position:h={x:0,y:0},opacity:v=1}=l.props;return{...c,[l.id]:{position:{x:h.x,y:h.y},size:{x:p.x,y:p.y},opacity:v}}},{})},Column={name:"Column",layout:({props:a={},children:s,size:d})=>{let{justify:c="center",align:l="center",cover:p=!1,margin:h={},dimensions:v=16/9,reverse:S=!1}=a;const b=p?0:Math.min(d.y/6,12);h={left:b,right:b,top:b,bottom:b,between:b,...h};const _=d.y-h.top-h.bottom,I=d.x-h.left-h.right,T=h.between*((s.length||1)-1),k=Math.min(I,(_-T)/(s.length||1)*v),w=k/v;return html.node`
      <div style=${{height:"100%",width:p?d.x+"px":"auto",display:"flex",flexDirection:S?"column-reverse":"column",justifyContent:c,alignItems:l,paddingLeft:h.left+"px",paddingTop:h.top+"px",paddingBottom:h.bottom+"px",paddingRight:h.right+"px"}}>
      ${s.map((P,$)=>html.node`<div data-node-id=${P.id} .data=${{entryTransition:{delay:400+$*100,offset:{x:0,y:"100%"},scale:{x:.8,y:.8},opacity:0},exitTransition:{offset:{x:0,y:1e3},scale:{x:.8,y:.8},opacity:0},borderRadius:p?0:5}} style=${{display:"flex",width:p?"100%":k+"px",height:p?w+"px":"auto",aspectRatio:v,marginBottom:$===s.length-1?0:h.between+"px",flexGrow:0,flexShrink:1,flexBasis:w+"px"}}></div>`)}
      </div>
    `}},Row={name:"Row",layout:({props:a={},children:s,size:d})=>{let{justify:c="center",align:l="center",cover:p=!1,margin:h={},dimensions:v,maxWidth:S=1,reverse:b=!1}=a;const _=p?0:Math.min(d.y/6,12);h={left:_,right:_,top:_,bottom:_,between:_,...h};const I=d.y-h.top-h.bottom,T=d.x-h.left-h.right,k=h.between*((s.length||1)-1);let w=I,P=Math.min((T-k)/(s.length||1),v?I*v:T,S*d.x);return v&&(w=P/v),html.node`
      <div style=${{height:p?d.y+"px":"auto",width:"100%",display:"flex",flexDirection:b?"row-reverse":"row",justifyContent:c,alignItems:l,paddingLeft:h.left+"px",paddingTop:h.top+"px",paddingBottom:h.bottom+"px",paddingRight:h.right+"px"}}>
          ${s.map(($,U)=>html.node`<div data-node-id=${$.id} .data=${{entryTransition:{delay:400+U*100,offset:{x:0,y:"100%"},scale:{x:.8,y:.8},opacity:0},exitTransition:{offset:{x:0,y:1e3},scale:{x:.8,y:.8},opacity:0},borderRadius:p?0:5}} style=${{display:"flex",height:p?"100%":w+"px",width:P+"px",marginRight:U===s.length-1?0:h.between+"px",flexGrow:0,flexShrink:1,flexBasis:P+"px"}}></div>`)}
      </div>
    `}},toMatrix=(a,s)=>a.reduce((d,c,l)=>(l%s==0?d.push([l]):d[d.length-1].push(l))&&d,[]),Grid={name:"Grid",layout:({props:a={},children:s,size:d})=>{let{dimensions:c,numPerRow:l,margin:p,cover:h=!1,maxWidth:v,between:S}=a;const b=s.length===0||h?0:S||Math.min(d.y/s.length/10,30);p=p!=null?p:b;const _=d.x<d.y;S=typeof S=="number"?S:p;let I=[];l?I=toMatrix(s,l):I=_?getTallGrid(s.length):getWideGrid(s.length);const T=(d.y-(p*2+S*(I.length-1)))/I.length,k=d.x-p*2;return html.node`
    <div style=${{display:"flex",width:"100%",height:"100%",flexDirection:"column",justifyContent:"center",padding:p+"px",gap:S+"px",flexGrow:0}}>${I.map((w,P)=>Row.layout({props:{justify:"center",dimensions:c,cover:h,maxWidth:v||1/(I[0].length||1),margin:{top:0,right:0,left:0,bottom:0,between:S}},children:w.map($=>s[$]),size:{y:T,x:k}}))}</div>`}},Presentation={name:"Presentation",layout:({props:a={},children:s,size:d})=>{let{margin:c,cover:l=!1,barWidth:p=.2,barPosition:h="side",presentationDimensions:v=16/9,viewerDimensions:S=16/9,justifyViewers:b="center",useGrid:_=!1,reverse:I=!1}=a;const T=h==="side"?d.x*p:d.y*p,k=s[0],w=s.filter(J=>J!==k),P=s.length<=1?0:Math.min(d.x/80,30);if(c=c!=null?c:P,!k)return Grid.layout({props:a,children:s,size:d});const $=s[1],U={...d};$&&(h==="side"?(U.x=d.x-T,U.y=U.x/v):(U.y=d.y-T,U.x=U.y*v));let E,D={};_?(E=Grid.layout,D={cover:l,...l?{maxWidth:1}:{margin:c}}):(E=h==="side"?Column.layout:Row.layout,D={margin:{top:c,left:c,bottom:c,right:c,between:c},dimensions:S,justify:b,align:"flex-end"});const F=h==="side"?I?"left":"right":I?"top":"bottom";return html.node`
      <div style=${{display:"flex",flexDirection:(h==="side"?"row":"column")+(I?"-reverse":""),justifyContent:"space-around",alignItems:"center",position:"relative",padding:l?0:c,[`padding-${F}`]:0}}>
        ${s[0]&&html.node`<div style=${{width:U.x,height:U.y,display:"flex",flexGrow:1}}>
            <div data-node-id=${k.id} .data=${{dimensions:v,borderRadius:l?0:5,entryTransition:{delay:0,offset:{x:0,y:1e3},scale:{x:.5,y:.5},opacity:0},exitTransition:{offset:{x:0,y:1e3},scale:{x:2,y:2},opacity:0}}} style=${{width:"100%",height:"100%",...l?{position:"absolute",top:0,left:0,width:_&&$?100-p*100+"%":"100%",height:"100%"}:{}}} />
          </div>`}
        ${html.node`<div style=${{...h==="side"?{maxWidth:p*100+"%",height:"100%"}:{maxHeight:p*100+"%",width:"100%"}}}>${$&&E({props:D,children:w,size:h==="side"?{x:T,y:d.y}:{x:d.x,y:T}})}</div>`}
      </div>
    `}},Layered={name:"Layered",layout:({props:a={},children:s,size:d})=>html.node`<div style=${{width:"100%",height:"100%",position:"relative"}}>
      ${s.map((c,l)=>html.node`<div data-node-id=${c.id} .data=${{zIndex:l+1}} style=${{position:"absolute",inset:"0px"}}></div>`)}
    </div>`},getWideGrid=(a=0)=>{switch(a){case 0:return[[]];case 1:return[[0]];case 2:return[[0,1]];case 3:return[[0,1],[2]];case 4:return[[0,1],[2,3]];case 5:return[[0,1,2],[3,4]];case 6:return[[0,1,2],[3,4,5]];case 7:return[[0,1,2],[3,4,5],[6]];case 8:return[[0,1,2],[3,4,5],[6,7]]}const s=Array(a).fill(null).map((d,c)=>c);return toMatrix(s,Math.round(Math.sqrt(a)))},getTallGrid=(a=0)=>{switch(a){case 0:return[[]];case 1:return[[0]];case 2:return[[0],[1]];case 3:return[[0,1],[2]];case 4:return[[0,1],[2,3]];case 5:return[[0,1],[2,3],[4]];case 6:return[[0,1],[2,3],[4,5]];case 7:return[[0,1],[2,3],[4,5],[6]];case 8:return[[0,1],[2,3],[4,5],[6,7]]}const s=Array(a).fill(null).map((d,c)=>c);return toMatrix(s,Math.ceil(Math.sqrt(s.length))-1)};var Layouts=Object.freeze(Object.defineProperty({__proto__:null,Free,Column,Row,Grid,Presentation,Layered},Symbol.toStringTag,{value:"Module"}));const deviceWatchers=new Set,updateMediaStreamTracks=(a,s)=>{const d={audio:a.getAudioTracks()[0],video:a.getVideoTracks()[0]};d.audio!==s.audio&&(d.audio&&a.removeTrack(d.audio),s.audio&&a.addTrack(s.audio)),d.video!==s.video&&(d.video&&a.removeTrack(d.video),s.video&&a.addTrack(s.video))},getDevicePermissions=async()=>{const a={audio:!0,video:!0};return Promise.all([navigator.mediaDevices.getUserMedia({video:!0}).then(s=>{s.getTracks().forEach(d=>d.stop())}).catch(s=>{s.name==="NotAllowedError"&&(a.video=!1)}),navigator.mediaDevices.getUserMedia({audio:!0}).then(s=>{s.getTracks().forEach(d=>d.stop())}).catch(s=>{s.name==="NotAllowedError"&&(a.audio=!1)})]).then(()=>a)},ensureDevicePermissions=async()=>getDevicePermissions(),watchDevices=a=>(deviceWatchers.size===0&&navigator.mediaDevices.addEventListener("devicechange",reportDevices),deviceWatchers.add(a),reportDevices().catch(()=>{}),()=>{deviceWatchers.delete(a),deviceWatchers.size===0&&navigator.mediaDevices.removeEventListener("devicechange",reportDevices)}),getUserMedia=async(...a)=>{const s=await navigator.mediaDevices.getUserMedia(...a);return reportDevices(),s},deviceWithDefaultLabel=(a,s)=>({deviceId:a.deviceId,groupId:a.groupId,kind:a.kind,label:a.label||s}),reportDevices=async()=>{const a=await navigator.mediaDevices.enumerateDevices(),s=a.filter(l=>l.kind==="videoinput").map((l,p)=>deviceWithDefaultLabel(l,"Camera "+(p+1))),d=a.filter(l=>l.kind==="audioinput").map((l,p)=>deviceWithDefaultLabel(l,"Microphone "+(p+1))),c=a.filter(l=>l.kind==="audiooutput").map((l,p)=>deviceWithDefaultLabel(l,"Speaker "+(p+1)));deviceWatchers.forEach(l=>l({webcams:s,microphones:d,speakers:c}))};var webrtc=Object.freeze(Object.defineProperty({__proto__:null,updateMediaStreamTracks,getDevicePermissions,ensureDevicePermissions,watchDevices,getUserMedia},Symbol.toStringTag,{value:"Module"}));const RoomParticipant={type:"RoomParticipant",valueType:MediaStream,props:{id:{},type:{},videoEnabled:{},audioEnabled:{}},init({addSource:a,removeSource:s,updateSource:d,getSource:c}){CoreContext.on("RoomJoined",({room:l})=>{let p={},h=[],v=[],S={};const b=()=>{h.filter(_=>(_==null?void 0:_.type)==="camera"&&(_==null?void 0:_.isExternal)===!0).forEach(_=>{var I,T,k;if(_.type==="camera"){const w=S[_.id],P=l.getParticipant(_.participantId),$=l.getTrack(_.id);if(c(_==null?void 0:_.id)){const E=l.getTrack((I=P==null?void 0:P.meta[_.id])==null?void 0:I.microphone);updateMediaStreamTracks(w,{video:$==null?void 0:$.mediaStreamTrack,audio:E==null?void 0:E.mediaStreamTrack}),d(_.id,{videoEnabled:Boolean($&&!$.isMuted),audioEnabled:Boolean(E&&!E.isMuted),displayName:((T=P==null?void 0:P.meta[_.id])==null?void 0:T.displayName)||"External Track",mirrored:(k=P==null?void 0:P.meta[_.id])==null?void 0:k.isMirrored,microphone:E,external:_==null?void 0:_.isExternal})}}}),v.forEach(_=>{var D;const I=S[_.id],T=S[_.id+"-screen"],k=_.trackIds.find(F=>{const J=l.getTrack(F);return(J==null?void 0:J.type)==="camera"&&!(J!=null&&J.isExternal)}),w=_.trackIds.find(F=>{const J=l.getTrack(F);return(J==null?void 0:J.type)==="microphone"&&!(J!=null&&J.isExternal)}),P=_.trackIds.find(F=>{const J=l.getTrack(F);return(J==null?void 0:J.type)==="screen_share"}),$=l.getTrack(k),U=l.getTrack(w),E=l.getTrack(P);updateMediaStreamTracks(I,{video:$==null?void 0:$.mediaStreamTrack,audio:U==null?void 0:U.mediaStreamTrack}),updateMediaStreamTracks(T,{video:E==null?void 0:E.mediaStreamTrack}),d(_.id,{videoEnabled:Boolean($&&!$.isMuted),audioEnabled:Boolean(U&&!U.isMuted),displayName:_.displayName,mirrored:(D=_==null?void 0:_.meta)==null?void 0:D.isMirrored,external:$==null?void 0:$.isExternal}),d(_.id+"-screen",{videoEnabled:Boolean(E&&!E.isMuted),displayName:_.meta.screenDisplayName||`${_.displayName}'s Screen`})})};l.useTracks(_=>{const I=_.filter(k=>!h.some(w=>w.id===k.id)&&Boolean(k==null?void 0:k.mediaStreamTrack)),T=h.filter(k=>!_.some(w=>w.id===k.id));h=_.filter(k=>Boolean(k==null?void 0:k.mediaStreamTrack)),I.forEach(k=>{const w=new MediaStream([]);S[k.id]=w;const{id:P,participantId:$,type:U,mediaStreamTrack:E}=l.getTrack(k.id);E&&a({id:P,isActive:!0,value:w,props:{id:P,trackId:P,participantId:$,isMuted:k.isMuted,type:U}})}),T.forEach(k=>{var w;s(k.id),(w=p[k.id])==null||w.call(p)}),b()}),l.useParticipants(_=>{const I=_.filter(k=>!v.some(w=>w.id===k.id)),T=v.filter(k=>!_.some(w=>w.id===k.id));v=_,I.forEach(k=>{var U;const{id:w}=k,P=new MediaStream([]),$=new MediaStream([]);S[w]=P,S[w+"-screen"]=$,a({id:w,isActive:!0,value:P,props:{id:w,type:"camera",displayName:k.displayName||k.id,audioEnabled:!1,videoEnabled:!1,mirrored:(U=k==null?void 0:k.meta)==null?void 0:U.isMirrored}}),a({id:w+"-screen",isActive:!0,value:$,props:{id:w,type:"screen",displayName:k.displayName||k.id,audioEnabled:!1,videoEnabled:!1}})}),b(),T.forEach(k=>{var w;s(k.id),(w=p[k.id])==null||w.call(p)})})})}},Banner={type:"Banner",valueType:Object,props:{},init({addSource:a,removeSource:s,updateSource:d,getSource:c,modifySourceValue:l}){let p=[];const h=(v=[])=>{const S=v.filter(I=>!p.some(T=>T.id===I.id)),b=p.filter(I=>!v.some(T=>T.id===I.id)),_=v.filter(I=>{const T=p.find(k=>k.id===I.id);return!fastDeepEqual(I,T)});S.forEach(I=>a({id:I.id,value:{headerText:I.props.headerText,bodyText:I.props.bodyText},props:I.props})),b.forEach(I=>s(I.id)),_.forEach(I=>{d(I.id,I.props),l(I.id,T=>{T.headerText=I.props.headerText,T.bodyText=I.props.bodyText})}),p=v};CoreContext.on("ActiveProjectChanged",({projectId:v})=>{var b,_;if(p=[],!v)return;const S=getProject(v);h((_=(b=S.props)==null?void 0:b.banners)!=null?_:[])}),CoreContext.on("ProjectChanged",({project:v})=>{var S,b;h((b=(S=v.props)==null?void 0:S.banners)!=null?b:[])})}},Overlays={type:"Overlay",valueType:Object,props:{},init({addSource:a,removeSource:s,updateSource:d,getSource:c,modifySourceValue:l}){let p=[];const h=(v=[])=>{const S=v.filter(I=>!p.some(T=>T.id===I.id)),b=p.filter(I=>!v.some(T=>T.id===I.id)),_=v.filter(I=>{const T=p.find(k=>k.id===I.id);return!fastDeepEqual(I,T)});S.forEach(I=>a({id:I.id,value:{...I.props},props:I.props})),b.forEach(I=>s(I.id)),_.forEach(I=>{d(I.id,I.props),l(I.id,T=>{Object.keys(I.props).forEach(k=>{T[k]=I.props[k]})})}),p=JSON.parse(JSON.stringify(v))};CoreContext.on("ActiveProjectChanged",({projectId:v})=>{if(p=[],!v)return;const S=getProject(v);h(S.props.overlays)}),CoreContext.on("ProjectChanged",({project:v})=>{h(v.props.overlays)})}},Background={type:"Background",valueType:Object,props:{},init({addSource:a,removeSource:s,updateSource:d,getSource:c,modifySourceValue:l}){let p;const h=v=>{if(!v)return;const S=(p==null?void 0:p.id)!==(v==null?void 0:v.id)?v:null,b=fastDeepEqual(v,p)?null:v;S&&(a({id:S==null?void 0:S.id,value:{...S==null?void 0:S.props},props:S==null?void 0:S.props}),s(p==null?void 0:p.id)),b&&(d(b==null?void 0:b.id,b==null?void 0:b.props),l(b==null?void 0:b.id,_=>{Object.keys(b==null?void 0:b.props).forEach(I=>{_[I]=b==null?void 0:b.props[I]})})),p=JSON.parse(JSON.stringify(v))};CoreContext.on("ActiveProjectChanged",({projectId:v})=>{if(p=null,!v)return;const S=getProject(v);h(S.props.background)}),CoreContext.on("ProjectChanged",({project:v})=>{h(v.props.background)})}},Logo={type:"Logo",valueType:Object,props:{},init({addSource:a,removeSource:s,updateSource:d,getSource:c,modifySourceValue:l}){let p;const h=v=>{if(!v){p&&(s(p==null?void 0:p.id),p=null);return}const S=(p==null?void 0:p.id)!==(v==null?void 0:v.id)?v:null,b=fastDeepEqual(v,p)?null:v;S&&(a({id:S==null?void 0:S.id,value:{...S==null?void 0:S.props},props:S==null?void 0:S.props}),s(p==null?void 0:p.id)),b&&(d(b==null?void 0:b.id,b==null?void 0:b.props),l(b==null?void 0:b.id,_=>{Object.keys(b==null?void 0:b.props).forEach(I=>{_[I]=b==null?void 0:b.props[I]})})),p=JSON.parse(JSON.stringify(v))};CoreContext.on("ActiveProjectChanged",({projectId:v})=>{if(p=null,!v)return;const S=getProject(v);h(S.props.logo)}),CoreContext.on("ProjectChanged",({project:v})=>{h(v.props.logo)})}},{state:state$1}=CoreContext,updateUserProps=async a=>{const s=getUser();if(!s)return;const d={...s.props,...a.props},c=await CoreContext.clients.LiveApi().collection.updateCollection({collectionId:s.id,updateMask:["metadata"],metadata:{...s.metadata,props:d}});await triggerInternal$1("UserChanged",c.collection)},createSource=async a=>{const s=getUser().id,{source:d}=await CoreContext.clients.LiveApi().source.createSource({metadata:{},collectionId:s,address:{rtmpPush:{enabled:!0}},preview:{webrtc:{enabled:!0,displayName:a.displayName||"RTMP Source"}}});await triggerInternal$1("SourceAdded",d);const c=await CoreContext.clients.LiveApi().source.addSourceToProject({collectionId:s,projectId:a.projectId,sourceId:d.sourceId});return await triggerInternal$1("ProjectSourceAdded",{projectId:c.project.projectId,source:d}),d},updateSource=async a=>{const s=getUser().id;let d=[],c={};a.metadata&&(d.push("metadata"),c.metadata=a.metadata),a.displayName&&(d.push("preview.webrtc.displayName"),c={...c,preview:{webrtc:{displayName:a.displayName}}});const{source:l}=await CoreContext.clients.LiveApi().source.updateSource({collectionId:s,updateMask:d,sourceId:a.sourceId,...c});return await triggerInternal$1("SourceChanged",l),l},deleteSource=async a=>{const s=getUser().id;await CoreContext.clients.LiveApi().source.removeSourceFromProject({collectionId:s,projectId:a.projectId,sourceId:a.sourceId}),await triggerInternal$1("ProjectSourceRemoved",{projectId:a.projectId,sourceId:a.sourceId});const d=await CoreContext.clients.LiveApi().source.deleteSource({sourceId:a.sourceId,collectionId:s});return await triggerInternal$1("SourceRemoved",a.sourceId),d},createProject$1=async(a={})=>{const{props:s={},size:d,settings:c={}}=a,l=await CoreContext.Request.createProject({settings:c,props:s,size:d});await triggerInternal$1("ProjectAdded",l.project);const p=await hydrateProject(l.project,"ROLE_HOST");return toBaseProject(p)},recreateLayout=async a=>{const{projectId:s,props:d={}}=a,c=getUser().id,l=await CoreContext.clients.LiveApi().project.getProject({collectionId:c,projectId:s,status:!0});if([ProjectBroadcastPhase.PROJECT_BROADCAST_PHASE_RUNNING,ProjectBroadcastPhase.PROJECT_BROADCAST_PHASE_STARTING].includes(l.status.phase))return;const p=l.project.metadata||{},{layoutId:h}=p,{video:v}=l.project.rendering,{type:S}=l.project.metadata.props||{},b=await CoreContext.Request.createLayout({collectionId:c,projectId:s,type:S||"sceneless",settings:{},size:{x:v.width,y:v.height}}),_=await CoreContext.clients.LiveApi().project.updateProject({collectionId:c,projectId:s,updateMask:["metadata"],metadata:{...p,layoutId:b.id}});CoreContext.log.debug("New layout assigned to project:",{layout:b}),await triggerInternal$1("ProjectChanged",{project:_.project}),await CoreContext.clients.LayoutApi().layout.deleteLayout({layoutId:h}),CoreContext.log.debug("Previous layout deleted:",{layoutId:h});const I=await hydrateProject(_.project,"ROLE_HOST");return await I.compositor.update(I.compositor.getRoot().id,d),{project:toBaseProject(I),internalProject:I}},deleteProject$1=async a=>{const{projectId:s}=a;await CoreContext.Request.deleteProject({projectId:s}),await triggerInternal$1("ProjectRemoved",{projectId:s})},updateProjectProps=async a=>{const{projectId:s}=a,d=getUser().id,c=getProject(s),l={...c.props,...a.props},p=await CoreContext.clients.LiveApi().project.updateProject({collectionId:d,projectId:s,updateMask:["metadata"],metadata:{...c.videoApi.project.metadata,props:l}});await triggerInternal$1("ProjectChanged",{project:p.project})},updateProjectMeta=a=>updateProjectProps({projectId:a.projectId,props:a.meta}),updateProjectPropsWithoutTrigger=async a=>{const{projectId:s}=a,d=getUser().id,c=getProject(s),l={...c.props,...a.props};await CoreContext.clients.LiveApi().project.updateProject({collectionId:d,projectId:s,updateMask:["metadata"],metadata:{...c.videoApi.project.metadata,props:l}})},setActiveProject=async a=>{const s=state$1.projects.find(c=>c.id===a.projectId);if(!s){state$1.activeProjectId=null,triggerInternal$1("ActiveProjectChanged",{projectId:null});return}const d=state$1.projects.find(c=>c.id===state$1.activeProjectId);if(s!==d)return d&&(Array.from(webrtcManager.rooms.keys()).map(webrtcManager.removeRoom),await CoreContext.clients.LayoutApi().unsubscribeFromLayout(d.layoutApi.layoutId),await CoreContext.clients.LiveApi().unsubscribeFromProject(d.videoApi.project.collectionId,d.videoApi.project.projectId)),await CoreContext.clients.LayoutApi().subscribeToLayout(s.layoutApi.layoutId),await CoreContext.clients.LiveApi().subscribeToProject(s.videoApi.project.collectionId,s.videoApi.project.projectId),CoreContext.clients.LiveApi().project.getProject({collectionId:s.videoApi.project.collectionId,projectId:s.videoApi.project.projectId,status:!0}).then(c=>{var l,p;triggerInternal$1("ProjectChanged",{project:c.project,phase:(l=c.status)==null?void 0:l.phase,broadcastId:(p=c.status)==null?void 0:p.broadcastId})}),triggerInternal$1("ActiveProjectChanged",{projectId:s.id}),toBaseProject(s)},joinRoom=async a=>{const{projectId:s,displayName:d="Guest"}=a,c=state$1.projects.find(I=>I.id===s);let l=c.sfuToken;if(!l){let{webrtcAccess:I}=await CoreContext.clients.LiveApi().authentication.createWebRtcAccessToken({collectionId:c.videoApi.project.collectionId,projectId:c.videoApi.project.projectId,displayName:d});l=I.accessToken}const h=o(l).video.room,v=new URL(CoreContext.clients.getLiveKitServer()),S=v.host+v.pathname,b=webrtcManager.ensureRoom(S,h,l);b.bindApiClient(CoreContext.clients),await b.connect(),c.sfuToken=l,c.roomId=h;const _=getRoom(h);return trigger$1("RoomJoined",{projectId:c.id,room:_}),_},createNode=async a=>{let{props:s={},parentId:d,index:c,projectId:l=state$1.activeProjectId}=a;const p=getProject(l),h=await p.compositor.insert(s,d,c);return triggerInternal$1("NodeAdded",{projectId:l,nodeId:h}),triggerInternal$1("NodeChanged",{projectId:l,nodeId:d}),p.compositor.get(h)},deleteNode=async a=>{var p;let{nodeId:s,projectId:d=state$1.activeProjectId}=a;const c=getProject(d),l=(p=c.compositor.getParent(s))==null?void 0:p.id;c.compositor.remove(s),triggerInternal$1("NodeRemoved",{projectId:d,nodeId:s}),triggerInternal$1("NodeChanged",{projectId:d,nodeId:l})},updateNode=async a=>{let{nodeId:s,props:d={},projectId:c=state$1.activeProjectId}=a;const l=getProject(c);return delete d.type,delete d.sourceType,l.compositor.update(s,d),triggerInternal$1("NodeChanged",{projectId:c,nodeId:s}),l.compositor.get(s)},setNodeLayout=async a=>{let{nodeId:s,layout:d,projectId:c=state$1.activeProjectId,layoutProps:l={}}=a;getProject(c).compositor.update(s,{layout:d,layoutProps:l}),triggerInternal$1("NodeChanged",{projectId:c,nodeId:s})},moveNode=async a=>{const{nodeId:s,parentId:d,projectId:c=state$1.activeProjectId,index:l}=a;getProject(c).compositor.move(s,d,l),triggerInternal$1("NodeChanged",{projectId:c,nodeId:s})},swapNodes=async a=>{var v,S;const{nodeAId:s,nodeBId:d,projectId:c=state$1.activeProjectId}=a,l=getProject(c),p=(v=l.compositor.getParent(s))==null?void 0:v.id,h=(S=l.compositor.getParent(d))==null?void 0:S.id;l.compositor.swap(s,d),triggerInternal$1("NodeChanged",{projectId:c,nodeId:p}),triggerInternal$1("NodeChanged",{projectId:c,nodeId:h})},reorderNodes=async a=>{const{parentId:s,childIds:d,projectId:c=state$1.activeProjectId}=a;getProject(c).compositor.reorder(s,d),triggerInternal$1("NodeChanged",{projectId:c,nodeId:s})},startBroadcast=async a=>{const{projectId:s=state$1.activeProjectId}=a,d=getProject(s);await CoreContext.clients.LiveApi().project.startProjectBroadcast({collectionId:d.videoApi.project.collectionId,projectId:d.videoApi.project.projectId})},stopBroadcast=async a=>{const{projectId:s=state$1.activeProjectId}=a,d=getProject(s);await CoreContext.clients.LiveApi().project.stopProjectBroadcast({collectionId:d.videoApi.project.collectionId,projectId:d.videoApi.project.projectId})},addDestination=async a=>{var _;const{rtmpUrl:s,rtmpKey:d,enabled:c,projectId:l=state$1.activeProjectId,metadata:p={},props:h={}}=a,v=getProject(l),S={rtmpPush:{key:d,url:s}},b=await((_=CoreContext.clients.LiveApi().destination)==null?void 0:_.createDestination({collectionId:v.videoApi.project.collectionId,projectId:v.videoApi.project.projectId,address:S,enabled:c,metadata:{props:{...p,...h}}}));return await triggerInternal$1("DestinationAdded",b.destination),toBaseDestination(b.destination)},removeDestination=async a=>{var l;const{destinationId:s,projectId:d=state$1.activeProjectId}=a,c=getProject(d);await((l=CoreContext.clients.LiveApi().destination)==null?void 0:l.deleteDestination({collectionId:c.videoApi.project.collectionId,projectId:c.videoApi.project.projectId,destinationId:s})),await triggerInternal$1("DestinationRemoved",{projectId:d,destinationId:s})},updateDestination=async a=>{var S;const{rtmpUrl:s,rtmpKey:d,destinationId:c,projectId:l=state$1.activeProjectId}=a,p=getProject(l),h={key:d,url:s},v=await((S=CoreContext.clients.LiveApi().destination)==null?void 0:S.updateDestination({collectionId:p.videoApi.project.collectionId,projectId:p.videoApi.project.projectId,destinationId:c,updateMask:["address.rtmpPush"],address:{rtmpPush:h}}));await triggerInternal$1("DestinationChanged",v.destination)},updateDestinationProps=async a=>{var v,S;const{projectId:s=state$1.activeProjectId,destinationId:d,props:c={}}=a,l=getProject(s),p=l.videoApi.project.destinations.find(b=>b.destinationId===d);if(!p)return;const h=await((S=CoreContext.clients.LiveApi().destination)==null?void 0:S.updateDestination({collectionId:l.videoApi.project.collectionId,projectId:l.videoApi.project.projectId,destinationId:d,updateMask:["metadata"],metadata:{...p.metadata||{},props:{...((v=p.metadata)==null?void 0:v.props)||{},...c}}}));await triggerInternal$1("DestinationChanged",h.destination)},updateDestinationMeta=a=>updateDestinationProps({projectId:a.projectId,destinationId:a.destinationId,props:a.metadata}),setDestinationEnabled=async a=>{var S;const{enabled:s,destinationId:d,projectId:c=state$1.activeProjectId}=a,l=getProject(c);if(l.videoApi.project.destinations.find(b=>d===b.destinationId).enabled===s)return;const h=await((S=CoreContext.clients.LiveApi().destination)==null?void 0:S.updateDestination({collectionId:l.videoApi.project.collectionId,projectId:l.videoApi.project.projectId,destinationId:d,updateMask:["enabled"],enabled:s}));await triggerInternal$1("DestinationChanged",h.destination),trigger$1(s?"DestinationEnabled":"DestinationDisabled",{projectId:c,destinationId:d})},setDestination=async a=>{var v,S;const{rtmpUrl:s,rtmpKey:d,projectId:c=state$1.activeProjectId}=a,l=getProject(c),p={key:d,url:s},h=!0;if(l.videoApi.project.destinations.length>0){const b=await((v=CoreContext.clients.LiveApi().destination)==null?void 0:v.updateDestination({collectionId:l.videoApi.project.collectionId,projectId:l.videoApi.project.projectId,destinationId:l.videoApi.project.destinations[0].destinationId,updateMask:["address.rtmpPush"],address:{rtmpPush:p}}));await triggerInternal$1("DestinationChanged",b.destination)}else{const b=await((S=CoreContext.clients.LiveApi().destination)==null?void 0:S.createDestination({collectionId:l.videoApi.project.collectionId,projectId:l.videoApi.project.projectId,address:{rtmpPush:p},enabled:h}));await triggerInternal$1("DestinationAdded",b.destination)}trigger$1("DestinationSet",{projectId:c,rtmpUrl:s,rtmpKey:d})};var commands$1=Object.freeze(Object.defineProperty({__proto__:null,updateUserProps,createSource,updateSource,deleteSource,createProject:createProject$1,recreateLayout,deleteProject:deleteProject$1,updateProjectProps,updateProjectMeta,updateProjectPropsWithoutTrigger,setActiveProject,joinRoom,createNode,deleteNode,updateNode,setNodeLayout,moveNode,swapNodes,reorderNodes,startBroadcast,stopBroadcast,addDestination,removeDestination,updateDestination,updateDestinationProps,updateDestinationMeta,setDestinationEnabled,setDestination},Symbol.toStringTag,{value:"Module"}));const useActiveProjectRoom$1=()=>{const[a,s]=React.useState(null);return React.useEffect(()=>useActiveProjectRoom(s),[]),a},useDevices=()=>{const[a,s]=React.useState({webcams:[],microphones:[],speakers:[]});return React.useEffect(()=>watchDevices(s),[]),a},StudioContext=React__default.default.createContext({studio:null,project:null,room:null,webcamId:null,microphoneId:null,setStudio:()=>{},setProject:()=>{},setRoom:()=>{},setWebcamId:()=>{},setMicrophoneId:()=>{},projectCommands:{}}),useStudio=()=>React.useContext(StudioContext);let stored={webcamId:null,microphoneId:null};try{stored.webcamId=localStorage==null?void 0:localStorage.getItem("__LS_webcam"),stored.microphoneId=localStorage==null?void 0:localStorage.getItem("__LS_microphone")}catch{}const StudioProvider=({children:a})=>{const[s,d]=React.useState(),[c,l]=React.useState(),[p,h]=React.useState(),[v,S]=React.useState(stored.webcamId),[b,_]=React.useState(stored.microphoneId),I=React.useMemo(()=>c?commands(c):null,[c]);return React.useEffect(()=>{},[c]),React.useEffect(()=>{!s||(v&&s.setCamera({deviceId:v}).catch(T=>{console.warn(T)}),b&&s.setMicrophone({deviceId:b}).catch(T=>{console.warn(T)}))},[s,v,b]),React__default.default.createElement(StudioContext.Provider,{value:{studio:p,project:c,room:s,webcamId:v,microphoneId:b,setStudio:h,setProject:l,setRoom:d,setWebcamId:T=>{try{localStorage==null||localStorage.setItem("__LS_webcam",T)}catch{}S(T)},setMicrophoneId:T=>{try{localStorage==null||localStorage.setItem("__LS_microphone",T)}catch{}_(T)},projectCommands:I}},a)};var react=Object.freeze(Object.defineProperty({__proto__:null,useActiveProjectRoom:useActiveProjectRoom$1,useDevices,StudioContext,useStudio,StudioProvider},Symbol.toStringTag,{value:"Module"}));const ForegroundLayers=[{name:"ImageIframeOverlayContainer",id:"fg-image-iframe",layout:"Free"},{name:"BannerContainer",id:"fg-banners",layout:"Column",layoutProps:{cover:!0}},{name:"VideoOverlayContainer",id:"fg-video",layout:"Free"},{name:"LogoContainer",layout:"Free",id:"logo"}],defaultStyles={custom:{display:"block"},video:{height:"100%",width:"100%"},image:{height:"100%",width:"100%"},logo:{objectFit:"contain",position:"unset"}},validateEachChildren=(a,s)=>{let d=!0;return a.forEach(c=>{var l,p;((l=c.props)==null?void 0:l.sourceType)&&!s.includes((p=c.props)==null?void 0:p.sourceType)?d=!1:c.children.length>0&&(d=d&&validateEachChildren(c.children,s))}),d},addingCache={camera:new Set,screen:new Set,rtmp:new Set},commands=a=>{var U,E,D,F;const s=a.id,d=a.scene.getRoot(),{Command:c}=CoreContext,l=d.children.find(J=>J.props.id==="bg"),p=d.children.find(J=>J.props.id==="content"),h=d.children.find(J=>J.props.id==="foreground");let v=(U=h==null?void 0:h.children)==null?void 0:U.find(J=>J.props.id==="fg-image-iframe"),S=(E=h==null?void 0:h.children)==null?void 0:E.find(J=>J.props.id==="logo"),b=(D=h==null?void 0:h.children)==null?void 0:D.find(J=>J.props.id==="fg-video");const _=getProject(a.id);let I=(F=h==null?void 0:h.children)==null?void 0:F.find(J=>J.props.id==="fg-banners");const T=async()=>{var J,G;((J=l==null?void 0:l.props)==null?void 0:J.layout)!=="Layered"&&await _.compositor.update(l.id,{name:"Background",id:"bg",layout:"Layered"}),((G=h==null?void 0:h.props)==null?void 0:G.layout)!=="Layered"&&await _.compositor.update(h.id,{id:"foreground",name:"Overlays",layout:"Layered"})},k=async()=>{validateEachChildren(l.children,["Background"])||l.children.forEach(async J=>{await CoreContext.Command.deleteNode({nodeId:J.id})})},w=async()=>{const J=async()=>{var N;if(I)return I.id;{const z=await _.compositor.insert({name:"BannerContainer",id:"fg-banners",layout:"Column",layoutProps:{cover:!0}},h.id);return I=(N=h==null?void 0:h.children)==null?void 0:N.find(Z=>Z.id===z),z}},G=async()=>{var N;if(v)return v.id;{const z=await _.compositor.insert({name:"ImageIframeOverlay",id:"fg-image-iframe",layout:"Free"},h.id);return v=(N=h==null?void 0:h.children)==null?void 0:N.find(Z=>Z.id===z),z}},x=async()=>{var N;if(b)return b.id;{const z=await _.compositor.insert({name:"VideoOverlay",id:"fg-video",layout:"Free"},h.id);return b=(N=h==null?void 0:h.children)==null?void 0:N.find(Z=>Z.id===z),z}},Y=async()=>{var N;if(S)return S.id;{const z=await _.compositor.insert({name:"Logo",layout:"Free",sourceType:"Logo",id:"logo",style:{width:"100%",height:"100%",objectFit:"contain",position:"unset"}},h.id);return S=(N=h==null?void 0:h.children)==null?void 0:N.find(Z=>Z.id===z),z}};try{const N=await Promise.all([J(),G(),x(),Y()]);await _.compositor.reorder(h.id,N)}catch{}},P={getBackground(){return l},getContent(){return p},getForeground(){return h},getLayout(){return p.props.layout},getBanners(){var J;return((J=getProject(a.id).props)==null?void 0:J.banners)||[]},getOverlays(){return getProject(a.id).props.overlays||[]},getParticipants(){return p.children.filter(J=>J.props.sourceType==="RoomParticipant")},getLogo(){var J,G;return(G=(J=S==null?void 0:S.children[0])==null?void 0:J.props)==null?void 0:G.id},async removeLogo(){const[J,...G]=(S==null?void 0:S.children)||[];G.forEach(x=>{CoreContext.Command.deleteNode({nodeId:x.id})}),J&&await CoreContext.Command.deleteNode({nodeId:J.id})},getImageOverlay(){var G,x;const J=(G=v==null?void 0:v.children)==null?void 0:G.find(Y=>{var N,z;return((z=(N=Y==null?void 0:Y.props)==null?void 0:N.sourceProps)==null?void 0:z.type)==="image"});return(x=J==null?void 0:J.props)==null?void 0:x.id},getVideoOverlay(){var G,x;const J=(G=b==null?void 0:b.children)==null?void 0:G.find(Y=>{var N,z;return((z=(N=Y==null?void 0:Y.props)==null?void 0:N.sourceProps)==null?void 0:z.type)==="video"});return(x=J==null?void 0:J.props)==null?void 0:x.id},autoPlayBackgroundVideo(J={muted:!0,autoplay:!0}){const G=l.children.find(x=>x.props.id==="bg-video");!G||CoreContext.Command.updateNode({nodeId:G.id,props:{...G.props,attributes:{...G.props.attributes,...J}}})},autoPlayVideoOverlay(J,G={muted:!0,autoplay:!0}){var Y;const x=(Y=b==null?void 0:b.children)==null?void 0:Y.find(N=>{var z,Z;return((Z=(z=N.props)==null?void 0:z.sourceProps)==null?void 0:Z.id)===J});!x||x.props.sourceProps.type==="video"&&CoreContext.Command.updateNode({nodeId:x.id,props:{...x.props,attributes:{...x.props.attributes,...G}}})},getBackgroundMedia(){var G,x;return(x=(G=l.children.filter(Y=>Y)[0])==null?void 0:G.props)==null?void 0:x.id},getBackgroundImage(){var G;const J=l.children.find(x=>{var Y,N;return((N=(Y=x.props)==null?void 0:Y.sourceProps)==null?void 0:N.type)==="image"});return(G=J==null?void 0:J.props)==null?void 0:G.id},getBackgroundVideo(){var G;const J=l.children.find(x=>{var Y,N;return((N=(Y=x.props)==null?void 0:Y.sourceProps)==null?void 0:N.type)==="video"});return(G=J==null?void 0:J.props)==null?void 0:G.id},async addLogo(J,G){const[x,...Y]=(S==null?void 0:S.children)||[];Y.forEach(N=>{CoreContext.Command.deleteNode({nodeId:N.id})}),x?await CoreContext.Command.updateNode({nodeId:x.id,props:{sourceType:"Logo",id:J,sourceProps:{...G,meta:{style:{...defaultStyles.logo},...G.meta}}}}):await CoreContext.Command.createNode({parentId:S==null?void 0:S.id,props:{sourceType:"Logo",id:J,sourceProps:{...G,meta:{style:{...defaultStyles.logo},...G.meta}}}})},addBanner(J={}){var N;const G=J.meta||{},x={id:generateId(),props:{...J,meta:G}},Y=((N=getProject(s).props)==null?void 0:N.banners)||[];return c.updateProjectProps({projectId:s,props:{banners:[...Y,x]}})},editBanner(J,G={}){const Y=P.getBanners().map(N=>N.id!==J?N:{...N,props:G});return c.updateProjectProps({projectId:s,props:{banners:Y}})},removeBanner(J){var x;const G=P.getBanners();return(x=I==null?void 0:I.children)==null||x.forEach(Y=>{Y.props.bannerId===J&&CoreContext.Command.deleteNode({nodeId:Y.id})}),c.updateProjectProps({projectId:s,props:{banners:G.filter(Y=>Y.id!==J)}})},async setActiveBanner(J){var N,z;const[G,...{}]=(I==null?void 0:I.children)||[];((z=(N=G==null?void 0:G.props)==null?void 0:N.sourceType)==null?void 0:z.toLowerCase())==="chatoverlay"&&await CoreContext.Command.deleteNode({nodeId:G.id});const[x,...Y]=(I==null?void 0:I.children)||[];if(Y.forEach(Z=>{CoreContext.Command.deleteNode({nodeId:Z.id})}),x)CoreContext.Command.updateNode({nodeId:x.id,props:{sourceType:"Banner",bannerId:J}});else return CoreContext.Command.createNode({parentId:I==null?void 0:I.id,props:{sourceType:"Banner",bannerId:J}})},getActiveBanner(){var J,G,x,Y;return(Y=(x=(G=(J=I.children)==null?void 0:J[0])==null?void 0:G.props)==null?void 0:x.bannerId)!=null?Y:null},async addChatOverlay(J,G){var z,Z;const[x,...{}]=(I==null?void 0:I.children)||[];((Z=(z=x==null?void 0:x.props)==null?void 0:z.sourceType)==null?void 0:Z.toLowerCase())==="banner"&&await CoreContext.Command.deleteNode({nodeId:x.id});const[Y,...N]=(I==null?void 0:I.children)||[];N.forEach(L=>{CoreContext.Command.deleteNode({nodeId:L.id})}),Y?await CoreContext.Command.updateNode({nodeId:Y.id,props:{sourceType:"ChatOverlay",chatOverlayId:J,id:J,...G}}):await CoreContext.Command.createNode({parentId:I==null?void 0:I.id,props:{sourceType:"ChatOverlay",chatOverlayId:J,id:J,...G}})},async removeChatOverlay(J){var G;(G=I==null?void 0:I.children)==null||G.forEach(async x=>{x.props.chatOverlayId===J&&await CoreContext.Command.deleteNode({nodeId:x.id})})},getChatOverlay(){var J,G,x,Y,N;return(x=(G=(J=I.children)==null?void 0:J[0])==null?void 0:G.props)!=null&&x.chatOverlayId&&((N=(Y=I.children)==null?void 0:Y[0])==null?void 0:N.props)||null},getCustomOverlay(){var G,x;const J=(G=v==null?void 0:v.children)==null?void 0:G.find(Y=>{var N,z;return((z=(N=Y==null?void 0:Y.props)==null?void 0:N.sourceProps)==null?void 0:z.type)==="custom"});return(x=J==null?void 0:J.props)==null?void 0:x.id},async addImageOverlay(J,G){const[x,...Y]=(v==null?void 0:v.children)||[];Y.forEach(z=>{CoreContext.Command.deleteNode({nodeId:z.id})});const N={...defaultStyles.image,...(b==null?void 0:b.children.length)&&{opacity:0}};x?await CoreContext.Command.updateNode({nodeId:x==null?void 0:x.id,props:{sourceType:"Overlay",id:J,sourceProps:{...G,type:"image",meta:{style:{...N}}}}}):await CoreContext.Command.createNode({parentId:v==null?void 0:v.id,props:{sourceType:"Overlay",id:J,sourceProps:{...G,type:"image",meta:{style:{...N}}}}})},async addVideoOverlay(J,G){const[x,...Y]=(b==null?void 0:b.children)||[];Y.forEach(N=>{CoreContext.Command.deleteNode({nodeId:N.id})}),v.children.forEach(({id:N,props:z})=>{var Z,L;if(((L=(Z=z.sourceProps.meta)==null?void 0:Z.style)==null?void 0:L.opacity)!==0){const V=z.sourceProps.type,H={...defaultStyles[V],opacity:0};CoreContext.Command.updateNode({nodeId:N,props:{...z,sourceProps:{...z.sourceProps,meta:{style:{...H}}}}})}}),x?await CoreContext.Command.updateNode({nodeId:x==null?void 0:x.id,props:{sourceType:"Overlay",id:J,sourceProps:{...G,type:"video",meta:{style:{...defaultStyles.video},...G.meta}}}}):await CoreContext.Command.createNode({parentId:b==null?void 0:b.id,props:{sourceType:"Overlay",id:J,sourceProps:{...G,type:"video",meta:{style:{...defaultStyles.video},...G.meta}}}})},async updateVideoOverlayProps(J,G){var Y,N;const x=((Y=b==null?void 0:b.children)==null?void 0:Y.find(z=>{var Z;return((Z=z==null?void 0:z.props)==null?void 0:Z.id)===J}))||null;!x||await CoreContext.Command.updateNode({nodeId:x==null?void 0:x.id,props:{sourceType:"Overlay",id:J,sourceProps:{...(N=x==null?void 0:x.props)==null?void 0:N.sourceProps,...G,meta:{style:{...defaultStyles.video},...G.meta}}}})},async addCustomOverlay(J,G){const[x,...Y]=(v==null?void 0:v.children)||[];Y.forEach(z=>{CoreContext.Command.deleteNode({nodeId:z.id})});const N={...defaultStyles.custom,...(b==null?void 0:b.children.length)&&{opacity:0}};x?await CoreContext.Command.updateNode({nodeId:x==null?void 0:x.id,props:{sourceType:"Overlay",id:J,sourceProps:{...G,type:"custom",meta:{style:{...N}}}}}):await CoreContext.Command.createNode({parentId:v==null?void 0:v.id,props:{sourceType:"Overlay",id:J,sourceProps:{...G,type:"custom",meta:{style:{...N}}}}})},async removeCustomOverlay(){var x,Y;const[J,...G]=(v==null?void 0:v.children)||[];G.forEach(N=>{CoreContext.Command.deleteNode({nodeId:N.id})}),J&&((Y=(x=J==null?void 0:J.props)==null?void 0:x.sourceProps)==null?void 0:Y.type)==="custom"&&await CoreContext.Command.deleteNode({nodeId:J.id})},async removeImageOverlay(){var x,Y;const[J,...G]=(v==null?void 0:v.children)||[];G.forEach(N=>{CoreContext.Command.deleteNode({nodeId:N.id})}),J&&((Y=(x=J==null?void 0:J.props)==null?void 0:x.sourceProps)==null?void 0:Y.type)==="image"&&await CoreContext.Command.deleteNode({nodeId:J.id})},async removeVideoOverlay(){const[J,...G]=(b==null?void 0:b.children)||[];G.forEach(x=>{CoreContext.Command.deleteNode({nodeId:x.id})}),J&&await CoreContext.Command.deleteNode({nodeId:J.id}),v==null||v.children.forEach(({id:x,props:Y})=>{var N,z;if(((z=(N=Y.sourceProps.meta)==null?void 0:N.style)==null?void 0:z.opacity)===0){const Z=Y.sourceProps.type,L={...defaultStyles[Z],opacity:1};CoreContext.Command.updateNode({nodeId:x,props:{...Y,sourceProps:{...Y.sourceProps,meta:{style:{...L}}}}})}})},setLayout(J,G={}){const x=p.props.layoutProps.showcase;c.setNodeLayout({nodeId:p.id,layout:J,layoutProps:{showcase:x,...G}})},async setBackgroundImage(J,G){const[x,...Y]=(l==null?void 0:l.children)||[];Y.forEach(N=>{CoreContext.Command.deleteNode({nodeId:N.id})}),x?await CoreContext.Command.updateNode({nodeId:x.id,props:{id:J,sourceType:"Background",sourceProps:{...G,type:"image",meta:{style:{...defaultStyles.image},...G==null?void 0:G.meta}}}}):await CoreContext.Command.createNode({parentId:l==null?void 0:l.id,props:{id:J,sourceType:"Background",sourceProps:{...G,type:"image",meta:{style:{...defaultStyles.image},...G==null?void 0:G.meta}}}})},async setBackgroundVideo(J,G){const[x,...Y]=(l==null?void 0:l.children)||[];Y.forEach(N=>{CoreContext.Command.deleteNode({nodeId:N.id})}),x?await CoreContext.Command.updateNode({nodeId:x.id,props:{id:J,sourceType:"Background",sourceProps:{...G,type:"video",meta:{style:{...defaultStyles.video},...G==null?void 0:G.meta}}}}):await CoreContext.Command.createNode({parentId:l==null?void 0:l.id,props:{id:J,sourceType:"Background",sourceProps:{...G,type:"video",meta:{style:{...defaultStyles.video},...G==null?void 0:G.meta}}}})},async updateBackgroundVideoProps(J,G){var Y,N;const x=((Y=l==null?void 0:l.children)==null?void 0:Y.find(z=>{var Z;return((Z=z==null?void 0:z.props)==null?void 0:Z.id)===J}))||null;!x||await CoreContext.Command.updateNode({nodeId:x==null?void 0:x.id,props:{sourceType:"Background",id:J,sourceProps:{...(N=x==null?void 0:x.props)==null?void 0:N.sourceProps,...G,meta:{style:{...defaultStyles.video},...G.meta}}}})},async removeBackgroundImage(){const[J,...G]=(l==null?void 0:l.children)||[];G.forEach(x=>{CoreContext.Command.deleteNode({nodeId:x.id})}),J&&J.props.sourceProps.type==="image"&&await CoreContext.Command.deleteNode({nodeId:J.id})},async removeBackgroundVideo(){const[J,...G]=(l==null?void 0:l.children)||[];G.forEach(x=>{CoreContext.Command.deleteNode({nodeId:x.id})}),J&&J.props.sourceProps.type==="video"&&await CoreContext.Command.deleteNode({nodeId:J.id})},useLayerState(J,G){const x=cloneDeep(d);let Y=findAll(x,V=>V.props.sourceType===J);const N=()=>{G((Y==null?void 0:Y.map(V=>V.props))||{})},z=CoreContext.onInternal("NodeChanged",V=>{const H=Y==null?void 0:Y.find(K=>K.id===V.nodeId);if((Y==null?void 0:Y.length)&&!H)return;const de=Y,X=cloneDeep(d);Y=findAll(X,K=>{var oe;return((oe=K==null?void 0:K.props)==null?void 0:oe.sourceType)===J}),fastDeepEqual(de,Y)||N()}),Z=CoreContext.onInternal("NodeAdded",V=>{var K;if(Y==null?void 0:Y.find(oe=>oe.id===V.nodeId))return;const de=cloneDeep(d);Y=findAll(de,oe=>{var pe;return((pe=oe==null?void 0:oe.props)==null?void 0:pe.sourceType)===J});const X=Y==null?void 0:Y.find(oe=>oe.id===V.nodeId);((K=X==null?void 0:X.props)==null?void 0:K.sourceType)===J&&N()}),L=CoreContext.onInternal("NodeRemoved",V=>{var de;const H=Y==null?void 0:Y.find(X=>X.id===V.nodeId);!H||(Y=Y==null?void 0:Y.filter(X=>X.id!==V.nodeId),((de=H==null?void 0:H.props)==null?void 0:de.sourceType)===J&&N())});return N(),()=>{z(),Z(),L()}},setShowcase(J,G="camera"){var Y;const x=P.getParticipantNode(J,G);return CoreContext.Command.updateNode({nodeId:p.id,props:{layoutProps:{...p.props.layoutProps,showcase:(Y=x==null?void 0:x.id)!=null?Y:null}}})},useShowcase(J){const G=()=>{const x=p.props.layoutProps.showcase,Y=p.children.find(z=>z.id===x);if(!Y)return J({participantId:null,type:null});const{sourceProps:N}=Y.props;return J({participantId:N.id,type:N.type})};return G(),CoreContext.onInternal("NodeChanged",x=>{x.nodeId===p.id&&G()})},async addRTMPSource(J,G={isMuted:!0,isHidden:!1,volume:0}){const x="rtmp";if(addingCache[x].has(J))return;const{isMuted:Y=!1,isHidden:N=!1,volume:z=1}=G;if(p.children.find(V=>{var H,de;return((H=V.props.sourceProps)==null?void 0:H.id)===J&&((de=V.props.sourceProps)==null?void 0:de.type)===x}))return;addingCache[x].add(J),p.children[0];let L=p.children.length;await CoreContext.Command.createNode({props:{name:"RTMP",sourceType:"RTMP",sourceProps:{type:x,id:J},volume:z,isMuted:Y,isHidden:N},parentId:p.id,index:L}).finally(()=>{addingCache[x].delete(J)})},removeRTMPSource(J){const G="rtmp";p.children.filter(x=>{var Y,N;return((Y=x.props.sourceProps)==null?void 0:Y.id)===J&&((N=x.props.sourceProps)==null?void 0:N.type)===G&&x.props.sourceType==="RTMP"}).forEach(x=>{CoreContext.Command.deleteNode({nodeId:x.id})})},async addParticipantTrack(J,G={isMuted:!0,isHidden:!1,volume:0},x="camera"){if(addingCache[x].has(J))return;const{isMuted:Y=!1,isHidden:N=!1,volume:z=1}=G;if(p.children.find(H=>{var de,X;return((de=H.props.sourceProps)==null?void 0:de.id)===J&&((X=H.props.sourceProps)==null?void 0:X.type)===x}))return;addingCache[x].add(J);const L=p.children[0];let V=p.children.length;x==="screen"&&(L==null?void 0:L.props.sourceProps.type)!=="screen"&&(V=0),await CoreContext.Command.createNode({props:{name:"Participant",sourceType:"RoomParticipant",sourceProps:{type:x,id:J},volume:z,isMuted:Y,isHidden:N},parentId:p.id,index:V}).finally(()=>{addingCache[x].delete(J)})},removeParticipantTrack(J,G="camera"){p.children.filter(x=>{var Y,N;return((Y=x.props.sourceProps)==null?void 0:Y.id)===J&&((N=x.props.sourceProps)==null?void 0:N.type)===G&&x.props.sourceType==="RoomParticipant"}).forEach(x=>{CoreContext.Command.deleteNode({nodeId:x.id})})},async addParticipant(J,G={},x="camera"){if(addingCache[x].has(J))return;const{isMuted:Y=!1,isHidden:N=!1,volume:z=1}=G;if(p.children.find(H=>{var de,X;return((de=H.props.sourceProps)==null?void 0:de.id)===J&&((X=H.props.sourceProps)==null?void 0:X.type)===x}))return;addingCache[x].add(J);const L=p.children[0];let V=p.children.length;x==="screen"&&(L==null?void 0:L.props.sourceProps.type)!=="screen"&&(V=0),await CoreContext.Command.createNode({props:{name:"Participant",sourceType:"RoomParticipant",sourceProps:{type:x,id:J},volume:z,isMuted:Y,isHidden:N},parentId:p.id,index:V}).finally(()=>{addingCache[x].delete(J)})},addParticipantScreenshare(J,G={}){return P.addParticipant(J,G,"screen")},removeParticipant(J,G="camera"){p.children.filter(x=>{var Y,N;return((Y=x.props.sourceProps)==null?void 0:Y.id)===J&&((N=x.props.sourceProps)==null?void 0:N.type)===G&&x.props.sourceType==="RoomParticipant"}).forEach(x=>{CoreContext.Command.deleteNode({nodeId:x.id})})},removeParticipantScreenshare(J){return P.removeParticipant(J,"screen")},getParticipantNode(J,G="camera"){return p.children.find(x=>{var Y,N;return((Y=x.props.sourceProps)==null?void 0:Y.id)===J&&((N=x.props.sourceProps)==null?void 0:N.type)===G})},getParticipantState(J,G="camera"){var x;return(x=P.getParticipantNode(J,G))==null?void 0:x.props},useParticipantState(J,G,x="camera"){let Y=P.getParticipantNode(J,x);const N=()=>{G(Y==null?void 0:Y.props)},z=CoreContext.onInternal("NodeChanged",L=>{if(L.nodeId!==p.id)return;const V=Y;Y=P.getParticipantNode(J,x),V!==Y&&N()}),Z=CoreContext.onInternal("NodeChanged",L=>{!Y||L.nodeId!==Y.id||N()});return N(),()=>{z(),Z()}},setParticipantVolume(J,G){const x=P.getParticipantNode(J);!x||CoreContext.Command.updateNode({nodeId:x.id,props:{volume:G}})},setParticipantMuted(J,G){const x=P.getParticipantNode(J);!x||CoreContext.Command.updateNode({nodeId:x.id,props:{isMuted:G}})},setParticipantHidden(J,G){const x=P.getParticipantNode(J);!x||CoreContext.Command.updateNode({nodeId:x.id,props:{isHidden:G}})},pruneParticipants(){const J=getProjectRoom(s);!J||p.children.filter(G=>{var L,V,H;if(G.props.sourceType!=="RoomParticipant")return!1;const x=(L=G.props.sourceProps)==null?void 0:L.type,Y=J.getParticipant((V=G.props.sourceProps)==null?void 0:V.id),N=J.getTrack((H=G.props.sourceProps)==null?void 0:H.id);return!Y&&!N?!0:x==="camera"?!1:!Y.trackIds.map(de=>J.getTrack(de)).filter(Boolean).some(de=>(de.type===Track.Source.Camera||de.type===Track.Source.Microphone?"camera":"screen")===x)}).forEach(G=>{CoreContext.Command.deleteNode({nodeId:G.id})})},getProp(J){return getProject(a.id).props[J]},setProp(J,G){return c.updateProjectProps({projectId:s,props:{[J]:G}})},useProp(J,G){return CoreContext.on("ProjectChanged",x=>{s===x.project.id&&G(x.project.props[J])})},createSource(J){return CoreContext.Command.createSource(J)},deleteSource(J){const G="rtmp";return p.children.filter(x=>{var Y,N;return((Y=x.props.sourceProps)==null?void 0:Y.id)===J.sourceId&&((N=x.props.sourceProps)==null?void 0:N.type)===G&&x.props.sourceType==="RTMP"}).forEach(x=>{CoreContext.Command.deleteNode({nodeId:x.id})}),CoreContext.Command.deleteSource(J)}};return(async()=>{await T(),await k(),await w()})(),P},create=async(a={},s={},d)=>CoreContext.Command.createProject({settings:a,props:s,size:d}),createCompositor=async(a,s,d)=>{const{layout:c,layoutProps:l={}}=d,p=await CoreContext.compositor.createProject({props:{name:"Root",type:"sceneless-project",sourceType:"Element",layout:"Layered",size:s,isRoot:!0,tagName:"div",version:"beta",fields:{style:{background:"black"}}}},a),h=p.getRoot(),v=await Promise.all([p.insert({name:"Background",id:"bg",layout:"Layered"},h.id),p.insert({id:"content",name:"Content",layout:c,layoutProps:l},h.id),p.insert({id:"foreground",name:"Overlays",layout:"Layered"},h.id)]);await p.reorder(h.id,v);const S=h.children.find(I=>I.props.id==="foreground"),b=ForegroundLayers.map(I=>p.insert(I,S.id)),_=await Promise.all(b);return await p.reorder(S.id,_),p};var scenelessProject=Object.freeze(Object.defineProperty({__proto__:null,commands,create,createCompositor},Symbol.toStringTag,{value:"Module"}));const useActiveProjectRoom=a=>{const s=getProject(CoreContext.state.activeProjectId);return a(s?getRoom(s.roomId):null),CoreContext.on("RoomJoined",()=>{const d=getProject(CoreContext.state.activeProjectId);a(d?getRoom(d.roomId):null)})};var callbacks=Object.freeze(Object.defineProperty({__proto__:null,useActiveProjectRoom},Symbol.toStringTag,{value:"Module"})),index$1=Object.freeze(Object.defineProperty({__proto__:null,React:react,ScenelessProject:scenelessProject,Callback:callbacks,Room:webrtc,Compositor:compositor$1},Symbol.toStringTag,{value:"Module"}));const runFilters=(a,s=[])=>s.reduce((d,c)=>c(d),a);var transforms=Object.freeze(Object.defineProperty({__proto__:null,runFilters},Symbol.toStringTag,{value:"Module"}));const createDefault=()=>({root:document.createElement("div")}),init$2=(a={},s,d)=>{const c={},l=a.defaultTransforms||{},p=$=>{asArray($).forEach(U=>{c[U.name]=U})},h={},v={},S={},b=$=>S[$]||[],_=$=>v[$]||[],I=$=>h[$],T=$=>c[$];s.on("SourceChanged",$=>{_($.id).forEach(E=>{const D=s.getNode(E.nodeId);E._onUpdateHandlers.forEach(F=>F(D.props||{}))})}),s.on("AvailableSourcesChanged",({type:$,sources:U})=>{b($).forEach(D=>{k(D.nodeId)})});const k=$=>{var N,z,Z;const U=I($);if(!U)return;const E=T(U.transformName);if(!E.useSource)return;const D=s.getNode($),F=U.proxySource?U.proxySource:U.sourceType,J=d.getSources(F),G=E.useSource(J,D.props),x=U.sourceValue,Y=G==null?void 0:G.value;U.source!==G&&(v[(N=U.source)==null?void 0:N.id]&&(v[(z=U.source)==null?void 0:z.id]=v[(Z=U.source)==null?void 0:Z.id].filter(L=>L.nodeId!==$)),v[G==null?void 0:G.id]=[...v[G==null?void 0:G.id]||[],U]),U.source=G,U.sourceValue=Y,Object.is(x,Y)||U._onNewSourceHandlers.forEach(L=>L(G))},w=$=>{const U=P($),D=runFilters($,[]);return k($.id),U==null||U._onUpdateHandlers.forEach(F=>F($.props||{})),{...D,children:D.children.map(w)}},P=$=>{if(h[$.id])return h[$.id];const{props:U={}}=$,{sourceType:E,proxySource:D}=U;if(!E)return null;let F=l[E],J;if(F?J=c[F]:J=Object.values(c).find(H=>H.sourceType===E),!J)throw new Error("Could not find matching transform for sourceType: "+E);const G=[],x=[],Y=[],N=[],Z={...(J.create||createDefault)({onEvent:(H,de,...X)=>{const K=s.on(H,de,...X);return N.push(K),K},onNewSource:H=>G.push(H),onUpdate:H=>x.push(H),onRemove:H=>Y.push(H)},$.props),proxySource:D,sourceType:E,nodeId:$.id,transformName:J.name,_onNewSourceHandlers:G,_onUpdateHandlers:x,_disposables:N};h[$.id]=Z;const L=D||E;S[L]=[...S[L]||[],Z],J.useSource&&k($.id);const V=[s.on("NodeRemoved",({nodeId:H})=>{if(H===$.id){const de=s.getNode(H),{sourceType:X="Element"}=de.props;V.forEach(oe=>oe==null?void 0:oe()),N.forEach(oe=>oe==null?void 0:oe()),Y.forEach(oe=>oe==null?void 0:oe()),delete h[de.id];const K=D||X;S[K]=S[K].filter(oe=>oe!==h[de.id])}})];return Z};return{transforms:c,nodeElementIndex:h,elementSourceTypeIndex:S,registerTransform:p,getElementsBySourceType:b,getElementByNodeId:I,getTransformByName:T,updateSourceForNode:k,renderTree:w,getElement:P}},TRANSITION_DURATION=300,findLayoutUp=(a,s,d=0)=>{const l=a.parentElement;return l instanceof Layout&&(d=0,!s||s(l))?l:l?d>4?null:findLayoutUp(l,s,d+1):null},TRANSITION_FIELDS="opacity, transform, width, height, left, right, top, bottom, inset",layoutIndex={},parentIdIndex={},childIndex={};let rootLayout,_cid=1;const ignoredAttributes=["style","id","className"];let tickOps={};const tick=()=>{if(nextTick=null,window.__dragging){nextTick=nextTick||requestAnimationFrame(tick);return}const a=new Set,s=new Set,d=new Set;Object.entries(tickOps).forEach(([c,l])=>{l.forEach(([p,h,v])=>{switch(p){case"childInserted":{s.has(v)?s.delete(v):a.add(v);break}case"childRemoved":{a.has(v)?a.delete(v):s.add(v);break}case"childRemoveFinished":{d.add(v);break}}})});try{s.forEach(l=>{var v,S,b;const p=childIndex[l],h=Array.from(((v=p.parentEl)==null?void 0:v.children)||[]);p.nextSiblingEl&&h.includes(p.nextSiblingEl)?(S=p.parentEl)==null||S.insertBefore(p,p.nextSiblingEl):(p.nextSiblingEl=null,(b=p.parentEl)==null||b.append(p)),p.runRemove()}),d.forEach(l=>{const p=childIndex[l];if(p.removed){p.previousSiblingEl&&(p.previousSiblingEl.nextSiblingEl=p.nextSiblingEl),p.nextSiblingEl&&(p.nextSiblingEl.previousSiblingEl=p.previousSiblingEl);return}});const c=window.__scale;Object.entries(tickOps).forEach(([l,p])=>{const h=layoutIndex[l],v=h.getBoundingClientRect(),S={x:v.width/c,y:v.height/c};h.updatePositions({size:S,inserted:a,removed:s})})}catch(c){log$1.warn("Failed to run Layout ops",c)}tickOps={}};let nextTick;const queueOp=a=>{const[s,d]=a,c=tickOps[d]||[];tickOps[d]=[...c,a],nextTick=nextTick||requestAnimationFrame(tick)};class Layout extends HTMLElement{constructor(){super(),this.isFirst=!0,this.isUpdating=!1,this.cid=++_cid}log(...s){var d;log$1.debug(...s,{id:this.dataset.id,parent:(d=this.parentLayout)==null?void 0:d.dataset.id},this)}connectedCallback(){var s;this.parentEl=this.parentElement,this.parentLayout=findLayoutUp(this),this.slotEl=this.closest("[data-layout-child]"),Array.from(this.children).forEach(d=>this.initializeChild(d)),rootLayout||(rootLayout=this),layoutIndex[this.dataset.id]=this,parentIdIndex[this.dataset.id]=(s=this.parentLayout)==null?void 0:s.id,Object.assign(this.style,{width:"100%",height:"100%",position:"absolute",top:"0px",left:"0px",pointerEvents:"none",boxSizing:"border-box"}),this.mutationObserver&&this.mutationObserver.disconnect(),this.mutationObserver=new MutationObserver(d=>{!this.isConnected||d.forEach(c=>{c.type==="attributes"&&!ignoredAttributes.includes(c.attributeName)?queueOp(["attributesChanged",this.dataset.id]):c.type==="childList"&&(c.addedNodes.forEach(l=>{const p=childIndex[l.dataset.id];l.removed||(p?p!==l&&(this.initializeChild(l),l.setAttribute("style",p.getAttribute("style")),l.data=p.data):this.initializeChild(l),queueOp(["childInserted",this.dataset.id,l.dataset.id]))}),c.removedNodes.forEach(l=>{l.removed||queueOp(["childRemoved",this.dataset.id,l.dataset.id])}))})}),this.mutationObserver.observe(this,{childList:!0,attributes:!0}),this.latestSize||queueOp(["attributesChanged",this.dataset.id])}disconnectedCallback(){}adoptedCallback(){}updatePositions(s){if(this.isUpdating)return;this.isUpdating=!0;const{size:d,inserted:c=new Set,removed:l=new Set}=s;this.nodes=Array.from(this.children||[]).filter(S=>!S.removed).map((S,b)=>{const _=getElementAttributes(S);return{id:S.dataset.id,props:_,children:[]}});const p=JSON.parse(this.getAttribute("props")||"{}");this.latestSize=d;const h={id:this.dataset.id,props:p,children:this.nodes,size:d};let v=layoutChildren(h);Promise.all(Object.entries(v).map(async([S,b])=>{var D,F,J,G,x,Y,N,z,Z,L,V;let _=childIndex[S]||this.querySelector(`[data-layout-child][data-id="${S}"]`);const I={..._.data,...b};_.data=I;const{size:T,position:k,zIndex:w=1,opacity:P=1,borderRadius:$=0,entryTransition:U={},exitTransition:E={}}=I;if(_){if(_.removed)return;E&&(_.data.exitTransition=E),U&&(_.data.entryTransition=U),_.data.size=T,_.data.position=k;const H=window.__scale,de=this.getBoundingClientRect(),X=de.width/H,K=X-sizeToNum(k.x,X)-sizeToNum(T.x,X),oe=de.height/H,pe=oe-sizeToNum(k.y,oe)-sizeToNum(T.y,oe);Object.assign(_.style,{position:"absolute",transformOrigin:"50% 50%",transitionDuration:"0ms",transitionDelay:"0ms",transform:"translate3d(0, 0, 0) scaleX(1) scaleY(1)",visibility:"visible",boxSizing:"border-box",overflow:"hidden",borderRadius:$+"px",width:"auto",height:"auto"});let me="0ms",ve=this.isFirst?asDuration(0):asDuration(TRANSITION_DURATION);if(c.has(S))Object.assign(_.style,{transitionProperty:TRANSITION_FIELDS,transitionDuration:"0ms",transitionTimingFunction:(D=U.timingFn)!=null?D:"ease",transform:`translate3d(calc(${asSize((J=(F=U.offset)==null?void 0:F.x)!=null?J:0)}), calc(${asSize((x=(G=U.offset)==null?void 0:G.y)!=null?x:0)}), 0) scaleX(${(N=(Y=U.scale)==null?void 0:Y.x)!=null?N:1}) scaleY(${(Z=(z=U.scale)==null?void 0:z.y)!=null?Z:1})`,opacity:(L=U.opacity)!=null?L:P,left:asSize(k.x)||0,right:asSize(K)||0,top:asSize(k.y)||0,bottom:asSize(pe)||0}),me=asDuration((V=U.delay)!=null?V:0);else if(_.data.rootOffset){const ee=rootLayout.getBoundingClientRect(),ce=this.getBoundingClientRect(),re={x:ce.x/H-ee.x/H,y:ce.y/H-ee.y/H},te=re.x+ce.width/H,se=_.data.rootOffset.x+Number(_.data.size.x),le=re.y+ce.height/H,ue=_.data.rootOffset.y+Number(_.data.size.y);_.data.rootOffset.x-re.x,_.data.rootOffset.y-re.y,te-se,le-ue}_.addEventListener("transitionstart",()=>{_.style.zIndex=String(w+1)}),await new Promise(ee=>window.setTimeout(ee)),Object.assign(_.style,{transitionProperty:TRANSITION_FIELDS,transitionDuration:ve,transitionDelay:me,transform:"translate3d(0, 0, 0) scaleX(1) scaleY(1)",opacity:P,left:asSize(k.x)||0,top:asSize(k.y)||0,width:X?"auto":T.x,right:X?asSize(K)||0:"auto",height:oe?"auto":T.y,bottom:oe?asSize(pe)||0:"auto",zIndex:w});const W=()=>{const ee=rootLayout.getBoundingClientRect(),ce=_.getBoundingClientRect();_.data.rootOffset={x:ce.x/H-ee.x/H,y:ce.y/H-ee.y/H}};W(),_.addEventListener("transitionend",()=>{_.style.zIndex=String(w),W()})}})).then(()=>{this.isUpdating=!1}),this.isFirst=!1,Array.from(this.querySelectorAll("ls-layout")).forEach(S=>{if(!v[S.dataset.id])return;const b=v[S.dataset.id].size;S.updatePositions({size:{x:sizeToNum(b.x,d.x),y:sizeToNum(b.y,d.y)}})})}initializeChild(s){var c;if(!((c=s.dataset)!=null&&c.id))return log$1.warn("Layout: Child requires `data-id` at the time it is added to a Layout");s._remove=s.remove,s.remove=()=>{this.removeChild(s)},s.mutationObserver||(s.mutationObserver=new MutationObserver(l=>{l.forEach(p=>{if(p.type==="attributes"){if(p.attributeName==="style")return;queueOp(["childAttributesChanged",this.dataset.id,s.dataset.id])}})}),s.mutationObserver.observe(s,{childList:!0,attributes:!0}));const d={entryTransition:{delay:0,opacity:0,scale:{x:1,y:1},offset:{x:0,y:0}},exitTransition:{delay:0,opacity:0,scale:{x:1,y:1},offset:{x:0,y:0}},position:{x:0,y:0},size:{x:0,y:0},opacity:0,fit:"cover",borderRadius:0,zIndex:1};s.data=d,s.parentEl=s.parentElement,s.nextSiblingEl=s.nextSibling,s.previousSiblingEl=s.previousSibling,s.previousSiblingEl&&(s.previousSiblingEl.nextSiblingEl=s),s.toggleAttribute("data-layout-child",!0),childIndex[s.dataset.id]=s,s.runRemove=async()=>{var p,h,v,S,b,_,I,T,k,w;s.removed=!0;const l=TRANSITION_DURATION;return await new Promise(P=>window.setTimeout(P)),Object.assign(s.style,{zIndex:0,transitionDelay:asDuration(0),transitionDuration:asDuration(l),transitionProperty:TRANSITION_FIELDS,transitionTimingFunction:(p=d.exitTransition.timingFn)!=null?p:"ease",transform:`translate3d(calc(${asSize((v=(h=d.exitTransition.offset)==null?void 0:h.x)!=null?v:0)}), calc( ${asSize((b=(S=d.exitTransition.offset)==null?void 0:S.y)!=null?b:0)}), 0) scaleX(${(I=(_=d.exitTransition.scale)==null?void 0:_.x)!=null?I:1}) scaleY(${(k=(T=d.exitTransition.scale)==null?void 0:T.y)!=null?k:1})`,opacity:(w=d.exitTransition.opacity)!=null?w:0}),s.removed=!0,s.transition=new Promise(P=>{const $=()=>{s.transition=null,s._remove(),queueOp(["childRemoveFinished",this.dataset.id,s.dataset.id]),clearTimeout(U),P()},U=window.setTimeout($,parseInt(String(l))+600);s.addEventListener("transitionend",$,{once:!0})}),s.transition}}}const ensureLayoutContainer=a=>{const s=document.getElementById("__ls-layout-container");if(s)return Object.assign(s.style,{width:a.x+"px",height:a.y+"px"}),s;const d=document.createElement("div");return d.id="__ls-layout-container",Object.assign(d.style,{position:"fixed",visibility:"hidden",top:0+"px",left:0+"px",zIndex:-1,width:a.x+"px",height:a.y+"px"}),document.body.append(d),d},layoutChildren=({id:a,props:s={},children:d,size:c})=>{const l={props:s,children:d,size:c},p=htmlLayouts[s.layout]?htmlLayouts[s.layout].layout(l):htmlLayouts.Free.layout(l);if(!(p instanceof HTMLElement))return p;const h=Array.from(p.querySelectorAll("[data-node-id]")),v=document.createElement("div");v.style.height=p.style.height=c.y+"px",v.style.width=p.style.width=c.x+"px",v.style.position="absolute",v.style.top="0px",v.style.left="0px",v.style.boxSizing="border-box",v.setAttribute("data-wrapper-id",a),v.append(p);const S=ensureLayoutContainer(c),b=S.querySelector(`[data-wrapper-id="${a}"]`);b?b.replaceWith(v):S.append(v);const _=p.getBoundingClientRect(),I={};return h.forEach(T=>{var U,E,D,F,J,G,x,Y;const k=T.dataset.nodeId;if(!k)return;const w=Number((U=T.dataset.opacity)!=null?U:T.style.opacity||1),P=T.getBoundingClientRect();let $={position:{x:P.x-_.x+"px",y:P.y-_.y+"px"},size:{x:P.width+"px",y:P.height+"px"},opacity:w,zIndex:(E=T.data)==null?void 0:E.zIndex,entryTransition:(F=(D=T.data)==null?void 0:D.entryTransition)!=null?F:{},exitTransition:(G=(J=T.data)==null?void 0:J.exitTransition)!=null?G:{},borderRadius:(Y=(x=T.data)==null?void 0:x.borderRadius)!=null?Y:0};`${s.showcase}-x`===k&&($.position={x:_.x+"px",y:_.y+"px"},$.size={x:_.width+"px",y:_.height+"px"},$.zIndex=10),I[k]=$,positionIndex[T.dataset.nodeId]=$}),I},positionIndex={},htmlLayouts={},registerLayout=a=>{asArray(a).forEach(s=>{htmlLayouts[s.name]=s})},sourceTypes={},init$1=(a={},s)=>{const d={},c={},l=S=>{s.triggerEvent("SourceChanged",S)},p=S=>{s.triggerEvent("AvailableSourcesChanged",{type:S,sources:c[S]})},v={sourceIndex:d,sourceTypeIndex:c,registerSource:S=>{asArray(S).forEach(b=>{var I;const _=T=>{const k=d[T];if(!!k&&k.type!==b.type)throw new Error(`Attempted to modify source of type ${k.type} from ${b.type}`)};(I=b.init)==null||I.call(b,{getSource:T=>v.getSource(T),removeSource:T=>(_(T),v.removeSource(T)),setSourceActive:(T,k)=>(_(T),v.setSourceActive(T,k)),updateSource:(T,k)=>(_(T),v.updateSource(T,k)),modifySourceValue(T,k){return _(T),v.modifySourceValue(T,k)},addSource:T=>v.addSource(b.type,T)}),sourceTypes[b.type]=b})},getSource:S=>d[S],getSources:S=>c[S]||[],useSource:(S,b)=>(b(d[S]),s.on("SourceChanged",_=>{_.id===S&&b(_)})),useSources:(S,b)=>(b(c[S]||[]),s.on("AvailableSourcesChanged",_=>{_.type===S&&b(_.sources)})),addSource:(S,b)=>{if(!b.id)throw new Error('Cannot add source without field "id"');if(d[b.id])return;if(!b.value)throw new Error('Cannot add source with an empty field "value"');if(!sourceTypes[S])throw new Error("Could not find definition for source type: "+S);const{id:I,value:T=null,props:k={},isActive:w=!0}=b;d[I]={id:I,type:S,props:k,value:T,isActive:w},c[S]=[...c[S]||[],d[I]],l(d[I]),p(S)},removeSource:S=>{const b=d[S];!b||(delete d[S],c[b.type]=c[b.type].filter(_=>_.id!==S),p(b.type))},updateSource:(S,b)=>{const _=d[S];_.props={..._.props,...b},l(_),p(_.type)},modifySourceValue:async(S,b)=>{const _=d[S];await b(_.value),l(_)},setSourceActive:(S,b=!0)=>{const _=d[S];_.isActive=b,p(_.type)}};return v};var sources=Object.freeze(Object.defineProperty({__proto__:null,sourceTypes,init:init$1},Symbol.toStringTag,{value:"Module"})),layouts=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));const{forEachDown,insertAt,toDataNode,pull,replaceItem}=Logic;let compositor;const start=a=>{if(compositor)return compositor;const{dbAdapter:s,transformSettings:d={},sourceSettings:c={}}=a,l={},p={};try{customElements.define("ls-layout",Layout)}catch(U){log$1.warn(U)}const h={},v={},S={};let b=0;const _=new Map,I=(U,E)=>{if(typeof U!="function")return;const D=++b;return _.set(D,U),U.nodeId=E,()=>{_.delete(D)}},T=(U,E,D)=>I((F,J)=>{F===U&&E(J)},D),k=(U,E)=>{_.forEach(D=>{D.nodeId?(E==null?void 0:E.nodeId)&&(E==null?void 0:E.nodeId)===D.nodeId&&D(U,E):D(U,E)})},w={projects:p,subscribe:I,on:T,triggerEvent:k,getProject:U=>p[U],getNodeProject:U=>p[h[U]],getNodeParent:U=>S[v[U]],getNode:U=>S[U],createProject:async(U={},E)=>{const{id:D,props:F={},children:J=[]}=U,G=await s(E,{get:()=>null,getParent:()=>null}).insert(F),x={id:G,props:F,children:J};return forEachDown(U,Y=>{}),S[G]=x,compositor.loadProject(x,E)},loadProject:(U,E)=>{if(!U)return;if(E=E||U.id,p[E])return p[E];forEachDown(U,(G,x)=>{S[G.id]=G,v[G.id]=x==null?void 0:x.id,h[G.id]=E});const D={insert:async(G,x,Y=0)=>{if(G.id&&S[G.id])return S[G.id];if(G.children||(G.children=[]),G.props||(G.props={}),x){const N=S[x];if(!N)throw"Parent node not found with ID";N.children=insertAt(Y,G,N.children||[]),v[G.id]=x}return S[G.id]=G,h[G.id]=E,G.id},update:async(G,x={},Y)=>{const N=S[G];if(Y){const z=Y.map(Z=>{const L=S[Z];return v[L.id]=G,L});N.children=z}N.props={...N.props,...x}},remove:async G=>{const x=S[v[G]];x&&(x.children=x.children.filter(N=>N.id!==G));const Y=S[G];forEachDown(Y,N=>{S[N.id]&&(S[N.id]._deleted=!0),k("NodeRemoved",{projectId:F.id,nodeId:N.id})})}},F={id:E,getRoot:()=>U,get(G){return S[G]},getParent(G){return S[v[G]]},renderTree(){return $.renderTree(U)},local:D,insert:async(G={},x,Y=0)=>{const z={id:await J.insert(G,x,Y),props:G,children:[]};return D.insert(z,x,Y)},update:async(G,x)=>(await D.update(G,x),J.update(G,x)),remove:async G=>{await D.remove(G);const x=S[v[G]],Y=x.children.filter(N=>N.id!==G);return J.batch([["delete",{id:G}],["update",{...x,children:Y}]])},reorder:async(G,x)=>{const Y=S[G];return Y.children=x.map(N=>Y.children.find(z=>z.id===N)),J.batch([["update",Y]])},move:async(G,x,Y=0)=>{const N=S[G],z=S[v[G]],Z=S[x];z.children=pull(z.children,N),Z.children=insertAt(Y,N,Z.children),J.batch([["update",Z],["update",z]]),v[G]=x},swap:async(G,x)=>{const Y=S[G],N=S[x],z=S[v[G]],Z=S[v[x]];z.children=replaceItem(L=>L.id===G,N,z.children),Z.children=replaceItem(L=>L.id===x,Y,Z.children),v[G]=Z.id,v[x]=z.id,J.batch([["update",z],["update",Z]])}};Object.defineProperty(F,"nodes",{get(){return Object.values(S).filter(G=>h[G.id]===F.id)}});const J=l[E]||s(E,{get:G=>toDataNode(F.get(G)),getParent:G=>toDataNode(F.getParent(G))});return l[E]=J,p[E]=F,F}},P=init$1(c,w),$=init$2(d,w,P);return compositor={registerLayout,registerTransform:$.registerTransform,registerSource:P.registerSource,getElement:$.getElement,getSource:P.getSource,getSources:P.getSources,useSource:P.useSource,useSources:P.useSources,...w},compositor};var index=Object.freeze(Object.defineProperty({__proto__:null,Transform:transforms,Layout:layouts,Source:sources,start},Symbol.toStringTag,{value:"Module"}));const createProject=async a=>{const s=getUser().id,d=a.type||"sceneless",c=a.size||{x:1280,y:720},l=a.settings||{};let p=await CoreContext.clients.LiveApi().project.createProject({collectionId:s,rendering:{video:{width:c.x,height:c.y,framerate:30}},composition:{studioSdk:{version:CoreContext.rendererVersion}},metadata:{},webrtc:{hosted:{}}});const h=await createLayout({projectId:p.project.projectId,collectionId:p.project.collectionId,settings:l,size:c,type:d}),{displayName:v}=getAccessTokenData(),S={type:d,layoutId:h.id,hostDisplayName:v,props:a.props||{}};let b=await CoreContext.clients.LiveApi().project.updateProject({collectionId:s,projectId:p.project.projectId,updateMask:["metadata"],metadata:S});return p.project=b.project,p.project.metadata=S,p},deleteProject=async a=>{const{projectId:s}=a,d=getProject(s),c=getUser().id;await Promise.all([CoreContext.clients.LiveApi().project.deleteProject({collectionId:c,projectId:s}),CoreContext.clients.LayoutApi().layout.deleteLayout({layoutId:d.layoutApi.layoutId})])},loadUser=async a=>{var h;const s=await loadCollections();let d;const{displayName:c,serviceUserId:l}=getAccessTokenData();s.length===0?d=(await CoreContext.clients.LiveApi().collection.createCollection({metadata:{serviceUserId:l,displayName:c,props:{}}})).collection:d=s[0],await CoreContext.clients.LiveApi().subscribeToCollection(d.collectionId);const p=await Promise.all(d.projects.filter(v=>{var S;return Boolean((S=v.metadata)==null?void 0:S.layoutId)}).map(v=>hydrateProject(v,"ROLE_HOST",a)));return{user:{id:d.collectionId,metadata:d.metadata,props:((h=d.metadata)==null?void 0:h.props)||{},name:c},projects:p,sources:d.sources}},loadCollections=async()=>(await CoreContext.clients.LiveApi().collection.getCollections({})).collections,createLayout=async a=>{const{settings:s,size:d,type:c,projectId:l,collectionId:p}=a,h=await CoreContext.clients.LayoutApi().layout.createLayout({layout:{projectId:l,collectionId:p}});return c==="sceneless"?await createCompositor(h.id,d,s):await CoreContext.compositor.createProject({props:{name:"Root",layout:"Free",...s,isRoot:!0,size:d}},h.id),h};var requests=Object.freeze(Object.defineProperty({__proto__:null,createProject,deleteProject,loadUser,loadCollections,createLayout},Symbol.toStringTag,{value:"Module"}));class EngineWebsocket{constructor(s,d){this.connectSource=s,this.disconnectSource=d,this.ws=null,this.sources=new Set,this.connect=this.connect.bind(this),this.handleMessage=this.handleMessage.bind(this)}connect(){const s=this.handleMessage.bind(this);this.ws=new WebSocket("ws://127.0.0.1:8000"),this.ws.addEventListener("message",s),this.ws.addEventListener("error",d=>{console.error("Unable to connect to websocket",d)}),this.ws.addEventListener("close",()=>{var d,c;(d=this.ws)==null||d.removeEventListener("message",s);try{(c=this.ws)==null||c.close(),this.ws=null}catch{}setTimeout(()=>{this.connect()},1e3)})}handleMessage(s){try{const d=JSON.parse(s.data);if(d.name==="state"){this.sources.clear(),console.info("[Engine]: state",d.payload);for(const c of d.payload.sources)c.connected&&(this.sources.has(c.id)||(this.sources.add(c.id),this.connectSource(c.id)))}else d.name==="source.disconnect"?(console.info("[Engine]: source disconnect",d.payload.id),this.sources.delete(d.payload.id),this.disconnectSource(d.payload.id)):d.name==="source.connect"&&(console.info("[Engine]: source connect",d.payload.id),this.sources.add(d.payload.id),this.connectSource(d.payload.id))}catch(d){console.error("unable to handle message: ",d)}}}function setupEngineWebsocket(a,s){return new EngineWebsocket(a,s)}const lookupDevice=(a,s)=>{const d=a.find(l=>l.label===s&&l.kind==="videoinput"),c=a.find(l=>l.label===`Monitor of ${s}`&&l.kind==="audioinput");if(d&&c)return{videoDevice:d,audioDevice:c};if(d){if(d.label==="Logitech BRIO (046d:085e)"){const l=a.find(p=>p.kind==="audioinput"&&p.label==="Loopback Audio 2 (Virtual)");return{videoDevice:d,audioDevice:l}}if(d.label==="OBS Virtual Camera (m-de:vice)"){const l=a.find(p=>p.kind==="audioinput"&&p.label==="Loopback Audio (Virtual)");return{videoDevice:d,audioDevice:l}}return{videoDevice:d,audioDevice:null}}return null},connectDevice=async a=>{new MediaStream([]);const s=await navigator.mediaDevices.enumerateDevices(),d=lookupDevice(s,a);if(d){const c={video:{width:999999,height:999999,deviceId:{exact:d.videoDevice.deviceId}}};d.audioDevice&&(c.audio={autoGainControl:!1,channelCount:2,echoCancellation:!1,latency:0,noiseSuppression:!1,sampleRate:128e3,sampleSize:16,deviceId:{exact:d.audioDevice.deviceId}});const l=await navigator.mediaDevices.getUserMedia(c);if(l)return l;console.warn(`No stream found for source ${a}.`)}else console.warn(`No device found for source ${a}.`)},RTMP={type:"RTMP",valueType:MediaStream,props:{id:{},type:{},videoEnabled:{},audioEnabled:{}},init({addSource:a,removeSource:s,updateSource:d,getSource:c}){let l,p={},h=[],v=[];const S=b=>{const _=b.filter(T=>!v.some(k=>k.id===T.id)),I=v.filter(T=>!b.some(k=>k.id===T.id));v=b,_.forEach(async T=>{const k=new MediaStream([]);p[T.id]=k;const w=k.getVideoTracks();a({id:`rtmp-${T.id}`,isActive:!0,value:k,props:{id:T.id,isMuted:!1,participantId:T.id,type:"rtmp",videoEnabled:Boolean(w.length),audioEnabled:!0}})}),I.forEach(T=>{s(`rtmp-${T.id}`)})};CoreContext.on("ActiveProjectChanged",({projectId:b})=>{const _=toBaseProject(getProject(b));S(_.sources),_.role===Role.ROLE_RENDERER&&(l||(l=setupEngineWebsocket(async function(T){const k=p[T];toBaseProject(getProject(b));const w=await connectDevice(T);if(c(`rtmp-${T}`)&&w){const $=w.getAudioTracks()[0],U=w.getVideoTracks()[0];updateMediaStreamTracks(k,{video:U,audio:$}),d(`rtmp-${T}`,{videoEnabled:Boolean(U),audioEnabled:Boolean($),mirrored:!1,external:!0})}},async function(T){toBaseProject(getProject(b)).sources.find($=>$.id===T);const w=p[T];(w==null?void 0:w.getTracks()).forEach($=>{p[T].removeTrack($)})}),l.connect()))}),CoreContext.on("RoomJoined",({projectId:b,room:_})=>{if(toBaseProject(getProject(b)).role!==Role.ROLE_RENDERER){const T=()=>{h.filter(k=>(k==null?void 0:k.type)==="screen_share"&&(k==null?void 0:k.isExternal)===!0).forEach(k=>{var w;if(k.type==="screen_share"){const P=p[k.participantId],$=_.getParticipant(k.participantId);if(v.some(U=>U.id===$.id)){const U=_.getTrack(k.id);if(c(`rtmp-${$==null?void 0:$.id}`)){const D=_.getTracks().find(F=>F.participantId===$.id&&F.mediaStreamTrack.kind==="audio");updateMediaStreamTracks(P,{video:U==null?void 0:U.mediaStreamTrack,audio:D==null?void 0:D.mediaStreamTrack}),d(`rtmp-${$==null?void 0:$.id}`,{videoEnabled:Boolean(U&&!U.isMuted),audioEnabled:Boolean(D&&!D.isMuted),mirrored:(w=$==null?void 0:$.meta[k.id])==null?void 0:w.isMirrored,external:k==null?void 0:k.isExternal})}}}})};_.useTracks(k=>{const w=k.filter(U=>v.some(E=>E.id===U.participantId)).filter(U=>["screen_share"].includes(U.type)),P=w.filter(U=>!h.some(E=>E.id===U.id)&&Boolean(U==null?void 0:U.mediaStreamTrack)),$=h.filter(U=>!w.some(E=>E.id===U.id));h=w.filter(U=>Boolean(U==null?void 0:U.mediaStreamTrack)),P.forEach(U=>{if(U.type==="screen_share"&&U.mediaStreamTrack.kind==="video"){const E=p[U.participantId],D=h.find(F=>{var J;return F.participantId===U.participantId&&((J=F.mediaStreamTrack)==null?void 0:J.kind)==="audio"});updateMediaStreamTracks(E,{video:U==null?void 0:U.mediaStreamTrack,audio:D==null?void 0:D.mediaStreamTrack}),d(`rtmp-${U.participantId}`,{videoEnabled:Boolean(U&&!(U!=null&&U.isMuted)),audioEnabled:Boolean(D&&!(D!=null&&D.isMuted))})}}),$.forEach(U=>{p[U.participantId].removeTrack(U.mediaStreamTrack)}),T()})}}),CoreContext.on("ProjectSourceAdded",({source:b,projectId:_})=>{const I=toBaseProject(getProject(_));S(I==null?void 0:I.sources)}),CoreContext.on("ProjectSourceRemoved",({sourceId:b,projectId:_})=>{const I=toBaseProject(getProject(_));S(I==null?void 0:I.sources)})}};var Sources=Object.freeze(Object.defineProperty({__proto__:null,RoomParticipant,Banner,Overlays,Background,Logo,RTMP},Symbol.toStringTag,{value:"Module"}));const{state}=CoreContext;subscribeInternal(async(a,s)=>{var d,c,l,p,h,v,S;switch(a){case"UserChanged":{const{metadata:b}=s;state.user.metadata=b||{},state.user.props=(b==null?void 0:b.props)||{},trigger$1("UserChanged",{user:getBaseUser()});return}case"ActiveProjectChanged":{const{projectId:b}=s;state.activeProjectId=b,trigger$1("ActiveProjectChanged",{projectId:b});return}case"ProjectAdded":{const _=await hydrateProject(s,"ROLE_HOST"),I=toBaseProject(_);state.projects=[...state.projects,_],trigger$1("ProjectAdded",{project:I});return}case"ProjectRemoved":{const{projectId:b}=s;state.projects=state.projects.filter(_=>_.id!==b),trigger$1("ProjectRemoved",{projectId:b});return}case"ProjectChanged":{const{project:b,phase:_,broadcastId:I}=s,T=getProject(b.projectId);if(!T)return;_&&(T.videoApi.phase=_),typeof I!="undefined"&&(T.videoApi.broadcastId=I);const k=(d=b.metadata)==null?void 0:d.layoutId;k!==T.layoutApi.layoutId&&(T.layoutApi.layoutId=(c=b.metadata)==null?void 0:c.layoutId,T.compositor=await layoutToProject(k)),T.videoApi.project=b,T.props=(p=(l=b.metadata)==null?void 0:l.props)!=null?p:{},trigger$1("ProjectChanged",{project:toBaseProject(T)});return}case"DestinationAdded":{const{projectId:b}=s,_=getProject(b);if(!_)return;_.videoApi.project.destinations.push(s),trigger$1("DestinationAdded",{projectId:b,destination:toBaseDestination(s)});return}case"DestinationRemoved":{const{projectId:b,destinationId:_}=s,I=getProject(b);if(!I)return;I.videoApi.project.destinations=I.videoApi.project.destinations.filter(T=>T.destinationId!==_),trigger$1("DestinationRemoved",{projectId:b,destinationId:_});return}case"DestinationChanged":{const b=s,{projectId:_,destinationId:I}=b,T=getProject(_);if(!T)return;const k=T.videoApi.project.destinations.find(w=>w.destinationId===I);if(!k)return;Object.assign(k,b),trigger$1("DestinationChanged",{projectId:_,destination:toBaseDestination(k)});return}case"SourceAdded":{const b=s;trigger$1("SourceAdded",{source:{id:b.sourceId,props:b.metadata,address:b.address}});return}case"SourceRemoved":return;case"SourceUpdated":return;case"ProjectSourceAdded":{const{projectId:b,source:_}=s,I=getProject(b);if(!I)return;I.videoApi.project.sources.push(_),trigger$1("ProjectSourceAdded",{source:{id:_.sourceId,address:_.address,preview:_.preview,props:(h=_.metadata)!=null?h:{}},projectId:b});return}case"ProjectSourceRemoved":{const{projectId:b,sourceId:_}=s,I=getProject(b);if(!I)return;I.videoApi.project.sources=I.videoApi.project.sources.filter(T=>T.sourceId!==_),trigger$1("ProjectSourceRemoved",{sourceId:_,projectId:b})}case"NodeAdded":return;case"NodeRemoved":return;case"NodeUpdated":return;case"BackgroundMetadataUpdate":{const{Command:b}=CoreContext,{projectId:_,metadata:I,sourceId:T,doTrigger:k,role:w}=s;if(w==="ROLE_HOST"||w==="ROLE_COHOST"){const P=getProject(_);if(!P||P.props.background.id!==T)return;let $=(v=P==null?void 0:P.props)==null?void 0:v.background;$&&($={...$,props:{...$.props,meta:{...$.props.meta,...I}}},k?b.updateProjectProps({projectId:_,props:{background:$}}):b.updateProjectPropsWithoutTrigger({projectId:_,props:{background:$}}))}return}case"OverlayMetadataUpdate":{const{Command:b}=CoreContext,{projectId:_,metadata:I,sourceId:T,doTrigger:k,role:w}=s;if(w==="ROLE_HOST"||w==="ROLE_COHOST"){const P=getProject(_);if(!P)return;let $=P.props.overlays.find(U=>U.id===T);if($){$={...$,props:{...$.props,meta:{...$.props.meta,...I}}};const U=P.props.overlays.findIndex(E=>E.id===T);if(U>-1){const E=JSON.parse(JSON.stringify((S=P==null?void 0:P.props)==null?void 0:S.overlays));E.splice(U,1,$),k?b.updateProjectProps({projectId:_,props:{overlays:E}}):b.updateProjectPropsWithoutTrigger({projectId:_,props:{overlays:E}})}}}return}}}),subscribeInternal(()=>log$1.debug({nextState:{...state}}));const BroadcastPhase=lib$2.LiveApiModel.ProjectBroadcastPhase,{trigger,triggerInternal}=CoreContext,EventType=lib$2.LiveApiModel.EventType,EventSubType=lib$2.LiveApiModel.EventSubType,init=async(a={})=>{const s=a.env||"prod",d=a.logLevel||"Warn";log$1.getLogger("livekit").setLevel(d),log$1.setLevel(d),log$1.info("Initializing Studio SDK...");const{layouts:l=[],transforms:p=[],sources:h=[],defaultTransforms:v={},useLatestRenderer:S=!1,guestToken:b,rendererVersion:_}=a,I=new lib$2.ApiStream({sdkVersion:CoreContext.version,env:s,logLevel:d}),T=config$1(),k=start({dbAdapter:compositorAdapter,transformSettings:{defaultTransforms:{...v,...T.defaults.transforms}}});CoreContext.config=T,CoreContext.clients=I,CoreContext.compositor=k,CoreContext.logLevel=d,CoreContext.Request=await Promise.resolve().then(function(){return requests}),CoreContext.Command=await Promise.resolve().then(function(){return commands$1}),CoreContext.rendererVersion=S?"latest-v2":_||CoreContext.version,window.__StudioKit={...CoreContext},k&&(k.registerSource([...Object.values(Sources),...h]),k.registerTransform([...Object.values(Transforms),...p]),k.registerLayout([...Object.values(Layouts),...l]));const w=await I.load(b);let P;w&&await I.LiveApi().project.getProject({...w}).then(U=>hydrateProject(U.project,w.role)).then(async U=>{setAppState({user:{id:w.collectionId,props:{},name:null,metadata:{}},sources:[],projects:[U],activeProjectId:null}),U.isInitial=!0,P=await CoreContext.Command.setActiveProject({projectId:U.id})}),I.LiveApi().on(EventType.EVENT_TYPE_COLLECTION,(U,E)=>{switch(log$1.info("Received: Collection event",E,U),E){case EventSubType.EVENT_SUB_TYPE_UPDATE:{triggerInternal("UserChanged",U.update.collection);return}}}),I.LiveApi().on(EventType.EVENT_TYPE_DESTINATION,(U,E)=>{switch(log$1.info("Received: Destination event",E,U),E){case EventSubType.EVENT_SUB_TYPE_CREATE:{const{destination:D}=U.create;triggerInternal("DestinationAdded",D);return}case EventSubType.EVENT_SUB_TYPE_UPDATE:{const{destination:D}=U.update;triggerInternal("DestinationChanged",D);return}case EventSubType.EVENT_SUB_TYPE_DELETE:{triggerInternal("DestinationRemoved",U.delete);return}}}),I.LiveApi().on(EventType.EVENT_TYPE_SOURCE,(U,E)=>{switch(log$1.info("Received: Source event",E,U),E){case EventSubType.EVENT_SUB_TYPE_CREATE:{triggerInternal("SourceAdded",U.create.source);return}case EventSubType.EVENT_SUB_TYPE_UPDATE:{triggerInternal("SourceChanged",U.update.source);return}case EventSubType.EVENT_SUB_TYPE_DELETE:{triggerInternal("SourceRemoved",U.delete.sourceId);return}case EventSubType.EVENT_SUB_TYPE_ADD:{triggerInternal("ProjectSourceAdded",{projectId:U.add.projectId,source:U.add.source});return}case EventSubType.EVENT_SUB_TYPE_REMOVE:{triggerInternal("ProjectSourceRemoved",{projectId:U.add.projectId,sourceId:U.add.sourceId});return}}}),I.LiveApi().on(EventType.EVENT_TYPE_PROJECT,(U,E)=>{var D;switch(log$1.info("Received: Project event",E,U),E){case EventSubType.EVENT_SUB_TYPE_CREATE:{const F=U.create.project;if(getProject(F.projectId))return;triggerInternal("ProjectAdded",F);return}case EventSubType.EVENT_SUB_TYPE_UPDATE:{const{projectId:F,updateMask:J,project:G}=U.update,x=getProject(G.projectId);if(!x)return;J.includes("metadata")&&trigger("ProjectMetaUpdated",{projectId:F,meta:G.metadata}),triggerInternal("ProjectChanged",{project:G,phase:x.videoApi.phase});return}case EventSubType.EVENT_SUB_TYPE_DELETE:{triggerInternal("ProjectRemoved",{projectId:U.delete.projectId});return}case EventSubType.EVENT_SUB_TYPE_STATE:{const F=getProject((D=U.state)==null?void 0:D.projectId);if(!F)return;let J=U.state.broadcastId;if(U.state.error&&trigger("BroadcastError",{projectId:F.id,broadcastId:U.state.broadcastId,error:U.state.error}),U.state.phase){const G=U.state.phase;G===BroadcastPhase.PROJECT_BROADCAST_PHASE_RUNNING?trigger("BroadcastStarted",{projectId:F.id,broadcastId:U.state.broadcastId}):G===BroadcastPhase.PROJECT_BROADCAST_PHASE_STOPPED&&(J=null,trigger("BroadcastStopped",{projectId:F.id,broadcastId:U.state.broadcastId}))}triggerInternal("ProjectChanged",{project:F.videoApi.project,phase:U.state.phase,broadcastId:J});return}}}),I.LayoutApi().on(lib$2.LayoutApiModel.EventType.EVENT_TYPE_LAYER,(U,E)=>{var D;if(E===lib$2.LayoutApiModel.EventSubType.EVENT_SUB_TYPE_CREATE){log$1.debug("Received: Node Insert",U.create);const{connectionId:F,layoutId:J}=U.create.requestMetadata;if(CoreContext.connectionId===F)return;const G=layerToNode(U.create),x=getProjectByLayoutId(J),Y=[G,...x.compositor.nodes.map(toDataNode$1)],N=toSceneTree(Y,G.id);x.compositor.local.insert(N),triggerInternal("NodeAdded",{projectId:x.id,nodeId:G.id})}else if(E===lib$2.LayoutApiModel.EventSubType.EVENT_SUB_TYPE_UPDATE){log$1.debug("Received: Node Update",U.update);const{connectionId:F,layoutId:J,updateVersions:G={}}=((D=U.update)==null?void 0:D.requestMetadata)||{};if(CoreContext.connectionId===F)return;const x=layerToNode(U.update);if((latestUpdateVersion[x.id]||0)>G[x.id])return log$1.info("Ignoring node update - updateID is less than latest.");latestUpdateVersion[x.id]=G[x.id];const N=getProjectByLayoutId(J);N.compositor.local.update(U.update.id,x.props,x.childIds),triggerInternal("NodeChanged",{projectId:N.id,nodeId:x.id})}else if(E===lib$2.LayoutApiModel.EventSubType.EVENT_SUB_TYPE_DELETE){log$1.debug("Received: Node Delete",U.delete);const{connectionId:F,layoutId:J}=U.delete.requestMetadata;if(CoreContext.connectionId===F)return;const G=getProjectByLayoutId(J);G.compositor.local.remove(U.delete.id),triggerInternal("NodeRemoved",{projectId:G.id,nodeId:U.delete.id})}else if(E===lib$2.LayoutApiModel.EventSubType.EVENT_SUB_TYPE_BATCH){log$1.debug("Received: Node Batch Update",U.batch);const{connectionId:F,layoutId:J,updateVersions:G={}}=U.batch.requestMetadata;if(CoreContext.connectionId===F)return;const x=getProjectByLayoutId(J);U.batch.layers.forEach(Y=>{try{const[N,z]=Object.entries(Y)[0];if(N==="create"){const Z=layerToNode(z);x.compositor.local.insert(Z),triggerInternal("NodeAdded",{projectId:x.id,nodeId:Z.id})}else if(N==="update"){const Z=layerToNode(z);if((latestUpdateVersion[Z.id]||0)>G[Z.id])return log$1.info("Ignoring node update - updateID is less than latest.");latestUpdateVersion[Z.id]=G[Z.id],x.compositor.local.update(Z.id,Z.props,Z.childIds),triggerInternal("NodeChanged",{projectId:x.id,nodeId:Z.id})}else N==="delete"&&(x.compositor.local.remove(z.id),triggerInternal("NodeRemoved",{projectId:x.id,nodeId:z.id}))}catch(N){log$1.warn("Error handling batch item",N,{item:Y})}}),x&&triggerInternal("NodeChanged",{projectId:x.id,nodeId:x.compositor.getRoot().id})}});const $=(U={},E)=>{const{displayName:D,role:F,maxDuration:J=CoreContext.config.defaults.guestTokenDuration,projectId:G=CoreContext.state.activeProjectId}=U,x=getProject(G),Y=D?{direct:{displayName:D}}:{exchange:{maxDuration:J}};return I.LiveApi().authentication.createGuestAccessToken({projectId:G,token:Y,url:E,collectionId:x.videoApi.project.collectionId,maxDuration:J,role:F||lib$2.LiveApiModel.Role.ROLE_GUEST})};return{...omit$1(CoreContext,["clients","config","connectionId","Request","state","trigger"]),createDemoToken:async()=>(console.warn("createDemoToken() is currently unavailable."),""),createPreviewLink:async(U={})=>{const{maxDuration:E,projectId:D=CoreContext.state.activeProjectId}=U,F=getProject(D),J=F.videoApi.project.composition.studioSdk.rendererUrl;return(await I.LiveApi().authentication.createGuestAccessToken({projectId:D,token:{direct:{displayName:"Preview"}},url:J,collectionId:F.videoApi.project.collectionId,maxDuration:E||CoreContext.config.defaults.previewTokenDuration,role:lib$2.LiveApiModel.Role.ROLE_VIEWER})).url},createGuestLink:async(U,E={})=>(await $(E,U)).url,createGuestToken:async(U={})=>(await $(U)).accessToken,initialProject:P,load,render:render$1}},load=async(a,s)=>{let d=getBaseUser();if(d)return log$1.info("Attempted to load user again - returning existing user"),d;if(!a){log$1.warn("Access token required for load()");return}log$1.info("Loading user..."),await CoreContext.clients.load(a);const l=await CoreContext.Request.loadUser(s);return setAppState({user:l.user,sources:l.sources,projects:l.projects,activeProjectId:null}),d=getBaseUser(),trigger("UserLoaded",d),d};exports.Command=commands$1,exports.Compositor=index,exports.Context=context,exports.Events=events$1,exports.Helpers=index$1,exports.Request=requests,exports.Room=index$2,exports.SDK=types$1,exports.init=init,Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
//# sourceMappingURL=index.umd.js.map
