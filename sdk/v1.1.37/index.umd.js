(function(a,s){typeof exports=="object"&&typeof module!="undefined"?s(exports,require("react-dom"),require("react")):typeof define=="function"&&define.amd?define(["exports","react-dom","react"],s):(a=typeof globalThis!="undefined"?globalThis:a||self,s((a["@api"]=a["@api"]||{},a["@api"]["stream/studio-kit"]={}),a.ReactDOM,a.React))})(this,function(exports,ReactDOM,React){"use strict";function _interopDefaultLegacy(a){return a&&typeof a=="object"&&"default"in a?a:{default:a}}function _mergeNamespaces(a,s){return s.forEach(function(d){d&&typeof d!="string"&&!Array.isArray(d)&&Object.keys(d).forEach(function(c){if(c!=="default"&&!(c in a)){var l=Object.getOwnPropertyDescriptor(d,c);Object.defineProperty(a,c,l.get?l:{enumerable:!0,get:function(){return d[c]}})}})}),Object.freeze(Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}))}var ReactDOM__default=_interopDefaultLegacy(ReactDOM),React__default=_interopDefaultLegacy(React);let currentSubId=0;const subscribers=new Map,subscribersInternal=new Map;function createSubscribe(a={}){return function(s){if(typeof s!="function")return;const d=a.internal?subscribersInternal:subscribers,c=++currentSubId;return d.set(c,s),()=>{d.delete(c)}}}function createOn(a={}){return function(s,d){return(a.internal?subscribeInternal:subscribe)((l,h)=>{if(s===l)return d(h)})}}function createTrigger(a={}){const s=a.internal?subscribersInternal:subscribers;return async function(d,...c){let l={type:d,payload:c[0]};const h=Boolean(a.internal)?"Internal":"External";log$1.info(`${h} Event:`,l),await Promise.all(Array.from(s.values()).map(p=>p(l.type,l.payload)))}}const trigger$1=createTrigger(),subscribe=createSubscribe(),on=createOn(),triggerInternal$1=createTrigger({internal:!0}),subscribeInternal=createSubscribe({internal:!0}),onInternal=createOn({internal:!0});var events$2=Object.freeze(Object.defineProperty({__proto__:null,trigger:trigger$1,subscribe,on,triggerInternal:triggerInternal$1,subscribeInternal,onInternal},Symbol.toStringTag,{value:"Module"})),commonjsGlobal=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function getAugmentedNamespace(a){if(a.__esModule)return a;var s=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(a).forEach(function(d){var c=Object.getOwnPropertyDescriptor(a,d);Object.defineProperty(s,d,c.get?c:{enumerable:!0,get:function(){return a[d]}})}),s}var loglevel={exports:{}};(function(a){(function(s,d){a.exports?a.exports=d():s.log=d()})(commonjsGlobal,function(){var s=function(){},d="undefined",c=typeof window!==d&&typeof window.navigator!==d&&/Trident\/|MSIE /.test(window.navigator.userAgent),l=["trace","debug","info","warn","error"];function h(U,F){var j=U[F];if(typeof j.bind=="function")return j.bind(U);try{return Function.prototype.bind.call(j,U)}catch{return function(){return Function.prototype.apply.apply(j,[U,arguments])}}}function p(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function y(U){return U==="debug"&&(U="log"),typeof console===d?!1:U==="trace"&&c?p:console[U]!==void 0?h(console,U):console.log!==void 0?h(console,"log"):s}function _(U,F){for(var j=0;j<l.length;j++){var T=l[j];this[T]=j<U?s:this.methodFactory(T,U,F)}this.log=this.debug}function E(U,F,j){return function(){typeof console!==d&&(_.call(this,F,j),this[U].apply(this,arguments))}}function O(U,F,j){return y(U)||E.apply(this,arguments)}function P(U,F,j){var T=this,D;F=F==null?"WARN":F;var J="loglevel";typeof U=="string"?J+=":"+U:typeof U=="symbol"&&(J=void 0);function ee(M){var K=(l[M]||"silent").toUpperCase();if(!(typeof window===d||!J)){try{window.localStorage[J]=K;return}catch{}try{window.document.cookie=encodeURIComponent(J)+"="+K+";"}catch{}}}function z(){var M;if(!(typeof window===d||!J)){try{M=window.localStorage[J]}catch{}if(typeof M===d)try{var K=window.document.cookie,te=K.indexOf(encodeURIComponent(J)+"=");te!==-1&&(M=/^([^;]+)/.exec(K.slice(te))[1])}catch{}return T.levels[M]===void 0&&(M=void 0),M}}function ne(){if(!(typeof window===d||!J)){try{window.localStorage.removeItem(J);return}catch{}try{window.document.cookie=encodeURIComponent(J)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}T.name=U,T.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},T.methodFactory=j||O,T.getLevel=function(){return D},T.setLevel=function(M,K){if(typeof M=="string"&&T.levels[M.toUpperCase()]!==void 0&&(M=T.levels[M.toUpperCase()]),typeof M=="number"&&M>=0&&M<=T.levels.SILENT){if(D=M,K!==!1&&ee(M),_.call(T,M,U),typeof console===d&&M<T.levels.SILENT)return"No console available for logging"}else throw"log.setLevel() called with invalid level: "+M},T.setDefaultLevel=function(M){F=M,z()||T.setLevel(M,!1)},T.resetLevel=function(){T.setLevel(F,!1),ne()},T.enableAll=function(M){T.setLevel(T.levels.TRACE,M)},T.disableAll=function(M){T.setLevel(T.levels.SILENT,M)};var X=z();X==null&&(X=F),T.setLevel(X,!1)}var C=new P,A={};C.getLogger=function(F){if(typeof F!="symbol"&&typeof F!="string"||F==="")throw new TypeError("You must supply a name when creating a logger.");var j=A[F];return j||(j=A[F]=new P(F,C.getLevel(),C.methodFactory)),j};var q=typeof window!==d?window.log:void 0;return C.noConflict=function(){return typeof window!==d&&window.log===C&&(window.log=q),C},C.getLoggers=function(){return A},C.default=C,C})})(loglevel);var log$1=loglevel.exports;const connectionId$1=(Math.random()*1e20).toString(36),version$4="1.1.37",CoreContext={config:null,clients:null,Request:{},Command:{},on,subscribe,onInternal,subscribeInternal,trigger:trigger$1,triggerInternal:triggerInternal$1,state:{},compositor:{},connectionId:connectionId$1,version:version$4,log:log$1,logLevel:null},setAppState=a=>{Object.keys(a).forEach(s=>{CoreContext.state[s]=a[s]})};var context=Object.freeze(Object.defineProperty({__proto__:null,CoreContext,log:log$1,setAppState,default:CoreContext},Symbol.toStringTag,{value:"Module"})),freeGlobal=typeof global=="object"&&global&&global.Object===Object&&global,freeGlobal$1=freeGlobal,freeSelf=typeof self=="object"&&self&&self.Object===Object&&self,root=freeGlobal$1||freeSelf||Function("return this")(),root$1=root,Symbol$1=root$1.Symbol,Symbol$2=Symbol$1,objectProto$f=Object.prototype,hasOwnProperty$d=objectProto$f.hasOwnProperty,nativeObjectToString$1=objectProto$f.toString,symToStringTag$1=Symbol$2?Symbol$2.toStringTag:void 0;function getRawTag(a){var s=hasOwnProperty$d.call(a,symToStringTag$1),d=a[symToStringTag$1];try{a[symToStringTag$1]=void 0;var c=!0}catch{}var l=nativeObjectToString$1.call(a);return c&&(s?a[symToStringTag$1]=d:delete a[symToStringTag$1]),l}var objectProto$e=Object.prototype,nativeObjectToString=objectProto$e.toString;function objectToString(a){return nativeObjectToString.call(a)}var nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag=Symbol$2?Symbol$2.toStringTag:void 0;function baseGetTag(a){return a==null?a===void 0?undefinedTag:nullTag:symToStringTag&&symToStringTag in Object(a)?getRawTag(a):objectToString(a)}function isObjectLike(a){return a!=null&&typeof a=="object"}var symbolTag$3="[object Symbol]";function isSymbol(a){return typeof a=="symbol"||isObjectLike(a)&&baseGetTag(a)==symbolTag$3}function arrayMap(a,s){for(var d=-1,c=a==null?0:a.length,l=Array(c);++d<c;)l[d]=s(a[d],d,a);return l}var isArray$3=Array.isArray,isArray$4=isArray$3,INFINITY$1=1/0,symbolProto$2=Symbol$2?Symbol$2.prototype:void 0,symbolToString=symbolProto$2?symbolProto$2.toString:void 0;function baseToString(a){if(typeof a=="string")return a;if(isArray$4(a))return arrayMap(a,baseToString)+"";if(isSymbol(a))return symbolToString?symbolToString.call(a):"";var s=a+"";return s=="0"&&1/a==-INFINITY$1?"-0":s}var reWhitespace=/\s/;function trimmedEndIndex(a){for(var s=a.length;s--&&reWhitespace.test(a.charAt(s)););return s}var reTrimStart=/^\s+/;function baseTrim(a){return a&&a.slice(0,trimmedEndIndex(a)+1).replace(reTrimStart,"")}function isObject$5(a){var s=typeof a;return a!=null&&(s=="object"||s=="function")}var NAN=0/0,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;function toNumber(a){if(typeof a=="number")return a;if(isSymbol(a))return NAN;if(isObject$5(a)){var s=typeof a.valueOf=="function"?a.valueOf():a;a=isObject$5(s)?s+"":s}if(typeof a!="string")return a===0?a:+a;a=baseTrim(a);var d=reIsBinary.test(a);return d||reIsOctal.test(a)?freeParseInt(a.slice(2),d?2:8):reIsBadHex.test(a)?NAN:+a}function identity$1(a){return a}var asyncTag="[object AsyncFunction]",funcTag$2="[object Function]",genTag$1="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction$3(a){if(!isObject$5(a))return!1;var s=baseGetTag(a);return s==funcTag$2||s==genTag$1||s==asyncTag||s==proxyTag}var coreJsData=root$1["__core-js_shared__"],coreJsData$1=coreJsData,maskSrcKey=function(){var a=/[^.]+$/.exec(coreJsData$1&&coreJsData$1.keys&&coreJsData$1.keys.IE_PROTO||"");return a?"Symbol(src)_1."+a:""}();function isMasked(a){return!!maskSrcKey&&maskSrcKey in a}var funcProto$2=Function.prototype,funcToString$2=funcProto$2.toString;function toSource(a){if(a!=null){try{return funcToString$2.call(a)}catch{}try{return a+""}catch{}}return""}var reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto$1=Function.prototype,objectProto$d=Object.prototype,funcToString$1=funcProto$1.toString,hasOwnProperty$c=objectProto$d.hasOwnProperty,reIsNative=RegExp("^"+funcToString$1.call(hasOwnProperty$c).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(a){if(!isObject$5(a)||isMasked(a))return!1;var s=isFunction$3(a)?reIsNative:reIsHostCtor;return s.test(toSource(a))}function getValue(a,s){return a==null?void 0:a[s]}function getNative(a,s){var d=getValue(a,s);return baseIsNative(d)?d:void 0}var WeakMap$2=getNative(root$1,"WeakMap"),WeakMap$3=WeakMap$2,objectCreate$1=Object.create,baseCreate=function(){function a(){}return function(s){if(!isObject$5(s))return{};if(objectCreate$1)return objectCreate$1(s);a.prototype=s;var d=new a;return a.prototype=void 0,d}}(),baseCreate$1=baseCreate;function apply(a,s,d){switch(d.length){case 0:return a.call(s);case 1:return a.call(s,d[0]);case 2:return a.call(s,d[0],d[1]);case 3:return a.call(s,d[0],d[1],d[2])}return a.apply(s,d)}function copyArray(a,s){var d=-1,c=a.length;for(s||(s=Array(c));++d<c;)s[d]=a[d];return s}var HOT_COUNT=800,HOT_SPAN=16,nativeNow=Date.now;function shortOut(a){var s=0,d=0;return function(){var c=nativeNow(),l=HOT_SPAN-(c-d);if(d=c,l>0){if(++s>=HOT_COUNT)return arguments[0]}else s=0;return a.apply(void 0,arguments)}}function constant(a){return function(){return a}}var defineProperty$1=function(){try{var a=getNative(Object,"defineProperty");return a({},"",{}),a}catch{}}(),defineProperty$2=defineProperty$1,baseSetToString=defineProperty$2?function(a,s){return defineProperty$2(a,"toString",{configurable:!0,enumerable:!1,value:constant(s),writable:!0})}:identity$1,baseSetToString$1=baseSetToString,setToString=shortOut(baseSetToString$1),setToString$1=setToString;function arrayEach(a,s){for(var d=-1,c=a==null?0:a.length;++d<c&&s(a[d],d,a)!==!1;);return a}function baseFindIndex(a,s,d,c){for(var l=a.length,h=d+(c?1:-1);c?h--:++h<l;)if(s(a[h],h,a))return h;return-1}function baseIsNaN(a){return a!==a}function strictIndexOf(a,s,d){for(var c=d-1,l=a.length;++c<l;)if(a[c]===s)return c;return-1}function baseIndexOf(a,s,d){return s===s?strictIndexOf(a,s,d):baseFindIndex(a,baseIsNaN,d)}var MAX_SAFE_INTEGER$1=9007199254740991,reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex(a,s){var d=typeof a;return s=s==null?MAX_SAFE_INTEGER$1:s,!!s&&(d=="number"||d!="symbol"&&reIsUint.test(a))&&a>-1&&a%1==0&&a<s}function baseAssignValue(a,s,d){s=="__proto__"&&defineProperty$2?defineProperty$2(a,s,{configurable:!0,enumerable:!0,value:d,writable:!0}):a[s]=d}function eq(a,s){return a===s||a!==a&&s!==s}var objectProto$c=Object.prototype,hasOwnProperty$b=objectProto$c.hasOwnProperty;function assignValue(a,s,d){var c=a[s];(!(hasOwnProperty$b.call(a,s)&&eq(c,d))||d===void 0&&!(s in a))&&baseAssignValue(a,s,d)}function copyObject(a,s,d,c){var l=!d;d||(d={});for(var h=-1,p=s.length;++h<p;){var y=s[h],_=c?c(d[y],a[y],y,d,a):void 0;_===void 0&&(_=a[y]),l?baseAssignValue(d,y,_):assignValue(d,y,_)}return d}var nativeMax$1=Math.max;function overRest(a,s,d){return s=nativeMax$1(s===void 0?a.length-1:s,0),function(){for(var c=arguments,l=-1,h=nativeMax$1(c.length-s,0),p=Array(h);++l<h;)p[l]=c[s+l];l=-1;for(var y=Array(s+1);++l<s;)y[l]=c[l];return y[s]=d(p),apply(a,this,y)}}function baseRest(a,s){return setToString$1(overRest(a,s,identity$1),a+"")}var MAX_SAFE_INTEGER=9007199254740991;function isLength(a){return typeof a=="number"&&a>-1&&a%1==0&&a<=MAX_SAFE_INTEGER}function isArrayLike$1(a){return a!=null&&isLength(a.length)&&!isFunction$3(a)}function isIterateeCall(a,s,d){if(!isObject$5(d))return!1;var c=typeof s;return(c=="number"?isArrayLike$1(d)&&isIndex(s,d.length):c=="string"&&s in d)?eq(d[s],a):!1}var objectProto$b=Object.prototype;function isPrototype(a){var s=a&&a.constructor,d=typeof s=="function"&&s.prototype||objectProto$b;return a===d}function baseTimes(a,s){for(var d=-1,c=Array(a);++d<a;)c[d]=s(d);return c}var argsTag$3="[object Arguments]";function baseIsArguments(a){return isObjectLike(a)&&baseGetTag(a)==argsTag$3}var objectProto$a=Object.prototype,hasOwnProperty$a=objectProto$a.hasOwnProperty,propertyIsEnumerable$1=objectProto$a.propertyIsEnumerable,isArguments=baseIsArguments(function(){return arguments}())?baseIsArguments:function(a){return isObjectLike(a)&&hasOwnProperty$a.call(a,"callee")&&!propertyIsEnumerable$1.call(a,"callee")},isArguments$1=isArguments;function stubFalse(){return!1}var freeExports$2=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule$2=freeExports$2&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports$2=freeModule$2&&freeModule$2.exports===freeExports$2,Buffer$2=moduleExports$2?root$1.Buffer:void 0,nativeIsBuffer=Buffer$2?Buffer$2.isBuffer:void 0,isBuffer$1=nativeIsBuffer||stubFalse,isBuffer$2=isBuffer$1,argsTag$2="[object Arguments]",arrayTag$2="[object Array]",boolTag$3="[object Boolean]",dateTag$3="[object Date]",errorTag$2="[object Error]",funcTag$1="[object Function]",mapTag$5="[object Map]",numberTag$3="[object Number]",objectTag$4="[object Object]",regexpTag$3="[object RegExp]",setTag$5="[object Set]",stringTag$3="[object String]",weakMapTag$2="[object WeakMap]",arrayBufferTag$3="[object ArrayBuffer]",dataViewTag$4="[object DataView]",float32Tag$2="[object Float32Array]",float64Tag$2="[object Float64Array]",int8Tag$2="[object Int8Array]",int16Tag$2="[object Int16Array]",int32Tag$2="[object Int32Array]",uint8Tag$2="[object Uint8Array]",uint8ClampedTag$2="[object Uint8ClampedArray]",uint16Tag$2="[object Uint16Array]",uint32Tag$2="[object Uint32Array]",typedArrayTags={};typedArrayTags[float32Tag$2]=typedArrayTags[float64Tag$2]=typedArrayTags[int8Tag$2]=typedArrayTags[int16Tag$2]=typedArrayTags[int32Tag$2]=typedArrayTags[uint8Tag$2]=typedArrayTags[uint8ClampedTag$2]=typedArrayTags[uint16Tag$2]=typedArrayTags[uint32Tag$2]=!0,typedArrayTags[argsTag$2]=typedArrayTags[arrayTag$2]=typedArrayTags[arrayBufferTag$3]=typedArrayTags[boolTag$3]=typedArrayTags[dataViewTag$4]=typedArrayTags[dateTag$3]=typedArrayTags[errorTag$2]=typedArrayTags[funcTag$1]=typedArrayTags[mapTag$5]=typedArrayTags[numberTag$3]=typedArrayTags[objectTag$4]=typedArrayTags[regexpTag$3]=typedArrayTags[setTag$5]=typedArrayTags[stringTag$3]=typedArrayTags[weakMapTag$2]=!1;function baseIsTypedArray(a){return isObjectLike(a)&&isLength(a.length)&&!!typedArrayTags[baseGetTag(a)]}function baseUnary(a){return function(s){return a(s)}}var freeExports$1=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule$1=freeExports$1&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports$1=freeModule$1&&freeModule$1.exports===freeExports$1,freeProcess=moduleExports$1&&freeGlobal$1.process,nodeUtil=function(){try{var a=freeModule$1&&freeModule$1.require&&freeModule$1.require("util").types;return a||freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch{}}(),nodeUtil$1=nodeUtil,nodeIsTypedArray=nodeUtil$1&&nodeUtil$1.isTypedArray,isTypedArray=nodeIsTypedArray?baseUnary(nodeIsTypedArray):baseIsTypedArray,isTypedArray$1=isTypedArray,objectProto$9=Object.prototype,hasOwnProperty$9=objectProto$9.hasOwnProperty;function arrayLikeKeys(a,s){var d=isArray$4(a),c=!d&&isArguments$1(a),l=!d&&!c&&isBuffer$2(a),h=!d&&!c&&!l&&isTypedArray$1(a),p=d||c||l||h,y=p?baseTimes(a.length,String):[],_=y.length;for(var E in a)(s||hasOwnProperty$9.call(a,E))&&!(p&&(E=="length"||l&&(E=="offset"||E=="parent")||h&&(E=="buffer"||E=="byteLength"||E=="byteOffset")||isIndex(E,_)))&&y.push(E);return y}function overArg(a,s){return function(d){return a(s(d))}}var nativeKeys=overArg(Object.keys,Object),nativeKeys$1=nativeKeys,objectProto$8=Object.prototype,hasOwnProperty$8=objectProto$8.hasOwnProperty;function baseKeys(a){if(!isPrototype(a))return nativeKeys$1(a);var s=[];for(var d in Object(a))hasOwnProperty$8.call(a,d)&&d!="constructor"&&s.push(d);return s}function keys$1(a){return isArrayLike$1(a)?arrayLikeKeys(a):baseKeys(a)}function nativeKeysIn(a){var s=[];if(a!=null)for(var d in Object(a))s.push(d);return s}var objectProto$7=Object.prototype,hasOwnProperty$7=objectProto$7.hasOwnProperty;function baseKeysIn(a){if(!isObject$5(a))return nativeKeysIn(a);var s=isPrototype(a),d=[];for(var c in a)c=="constructor"&&(s||!hasOwnProperty$7.call(a,c))||d.push(c);return d}function keysIn(a){return isArrayLike$1(a)?arrayLikeKeys(a,!0):baseKeysIn(a)}var reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;function isKey(a,s){if(isArray$4(a))return!1;var d=typeof a;return d=="number"||d=="symbol"||d=="boolean"||a==null||isSymbol(a)?!0:reIsPlainProp.test(a)||!reIsDeepProp.test(a)||s!=null&&a in Object(s)}var nativeCreate=getNative(Object,"create"),nativeCreate$1=nativeCreate;function hashClear(){this.__data__=nativeCreate$1?nativeCreate$1(null):{},this.size=0}function hashDelete(a){var s=this.has(a)&&delete this.__data__[a];return this.size-=s?1:0,s}var HASH_UNDEFINED$2="__lodash_hash_undefined__",objectProto$6=Object.prototype,hasOwnProperty$6=objectProto$6.hasOwnProperty;function hashGet(a){var s=this.__data__;if(nativeCreate$1){var d=s[a];return d===HASH_UNDEFINED$2?void 0:d}return hasOwnProperty$6.call(s,a)?s[a]:void 0}var objectProto$5=Object.prototype,hasOwnProperty$5=objectProto$5.hasOwnProperty;function hashHas(a){var s=this.__data__;return nativeCreate$1?s[a]!==void 0:hasOwnProperty$5.call(s,a)}var HASH_UNDEFINED$1="__lodash_hash_undefined__";function hashSet(a,s){var d=this.__data__;return this.size+=this.has(a)?0:1,d[a]=nativeCreate$1&&s===void 0?HASH_UNDEFINED$1:s,this}function Hash(a){var s=-1,d=a==null?0:a.length;for(this.clear();++s<d;){var c=a[s];this.set(c[0],c[1])}}Hash.prototype.clear=hashClear,Hash.prototype.delete=hashDelete,Hash.prototype.get=hashGet,Hash.prototype.has=hashHas,Hash.prototype.set=hashSet;function listCacheClear(){this.__data__=[],this.size=0}function assocIndexOf(a,s){for(var d=a.length;d--;)if(eq(a[d][0],s))return d;return-1}var arrayProto$1=Array.prototype,splice$1=arrayProto$1.splice;function listCacheDelete(a){var s=this.__data__,d=assocIndexOf(s,a);if(d<0)return!1;var c=s.length-1;return d==c?s.pop():splice$1.call(s,d,1),--this.size,!0}function listCacheGet(a){var s=this.__data__,d=assocIndexOf(s,a);return d<0?void 0:s[d][1]}function listCacheHas(a){return assocIndexOf(this.__data__,a)>-1}function listCacheSet(a,s){var d=this.__data__,c=assocIndexOf(d,a);return c<0?(++this.size,d.push([a,s])):d[c][1]=s,this}function ListCache(a){var s=-1,d=a==null?0:a.length;for(this.clear();++s<d;){var c=a[s];this.set(c[0],c[1])}}ListCache.prototype.clear=listCacheClear,ListCache.prototype.delete=listCacheDelete,ListCache.prototype.get=listCacheGet,ListCache.prototype.has=listCacheHas,ListCache.prototype.set=listCacheSet;var Map$1=getNative(root$1,"Map"),Map$2=Map$1;function mapCacheClear(){this.size=0,this.__data__={hash:new Hash,map:new(Map$2||ListCache),string:new Hash}}function isKeyable(a){var s=typeof a;return s=="string"||s=="number"||s=="symbol"||s=="boolean"?a!=="__proto__":a===null}function getMapData(a,s){var d=a.__data__;return isKeyable(s)?d[typeof s=="string"?"string":"hash"]:d.map}function mapCacheDelete(a){var s=getMapData(this,a).delete(a);return this.size-=s?1:0,s}function mapCacheGet(a){return getMapData(this,a).get(a)}function mapCacheHas(a){return getMapData(this,a).has(a)}function mapCacheSet(a,s){var d=getMapData(this,a),c=d.size;return d.set(a,s),this.size+=d.size==c?0:1,this}function MapCache(a){var s=-1,d=a==null?0:a.length;for(this.clear();++s<d;){var c=a[s];this.set(c[0],c[1])}}MapCache.prototype.clear=mapCacheClear,MapCache.prototype.delete=mapCacheDelete,MapCache.prototype.get=mapCacheGet,MapCache.prototype.has=mapCacheHas,MapCache.prototype.set=mapCacheSet;var FUNC_ERROR_TEXT$1="Expected a function";function memoize(a,s){if(typeof a!="function"||s!=null&&typeof s!="function")throw new TypeError(FUNC_ERROR_TEXT$1);var d=function(){var c=arguments,l=s?s.apply(this,c):c[0],h=d.cache;if(h.has(l))return h.get(l);var p=a.apply(this,c);return d.cache=h.set(l,p)||h,p};return d.cache=new(memoize.Cache||MapCache),d}memoize.Cache=MapCache;var MAX_MEMOIZE_SIZE=500;function memoizeCapped(a){var s=memoize(a,function(c){return d.size===MAX_MEMOIZE_SIZE&&d.clear(),c}),d=s.cache;return s}var rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=memoizeCapped(function(a){var s=[];return a.charCodeAt(0)===46&&s.push(""),a.replace(rePropName,function(d,c,l,h){s.push(l?h.replace(reEscapeChar,"$1"):c||d)}),s}),stringToPath$1=stringToPath;function toString$1(a){return a==null?"":baseToString(a)}function castPath(a,s){return isArray$4(a)?a:isKey(a,s)?[a]:stringToPath$1(toString$1(a))}var INFINITY=1/0;function toKey(a){if(typeof a=="string"||isSymbol(a))return a;var s=a+"";return s=="0"&&1/a==-INFINITY?"-0":s}function baseGet(a,s){s=castPath(s,a);for(var d=0,c=s.length;a!=null&&d<c;)a=a[toKey(s[d++])];return d&&d==c?a:void 0}function get(a,s,d){var c=a==null?void 0:baseGet(a,s);return c===void 0?d:c}function arrayPush(a,s){for(var d=-1,c=s.length,l=a.length;++d<c;)a[l+d]=s[d];return a}var spreadableSymbol=Symbol$2?Symbol$2.isConcatSpreadable:void 0;function isFlattenable(a){return isArray$4(a)||isArguments$1(a)||!!(spreadableSymbol&&a&&a[spreadableSymbol])}function baseFlatten(a,s,d,c,l){var h=-1,p=a.length;for(d||(d=isFlattenable),l||(l=[]);++h<p;){var y=a[h];s>0&&d(y)?s>1?baseFlatten(y,s-1,d,c,l):arrayPush(l,y):c||(l[l.length]=y)}return l}function flatten(a){var s=a==null?0:a.length;return s?baseFlatten(a,1):[]}function flatRest(a){return setToString$1(overRest(a,void 0,flatten),a+"")}var getPrototype=overArg(Object.getPrototypeOf,Object),getPrototype$1=getPrototype,objectTag$3="[object Object]",funcProto=Function.prototype,objectProto$4=Object.prototype,funcToString=funcProto.toString,hasOwnProperty$4=objectProto$4.hasOwnProperty,objectCtorString=funcToString.call(Object);function isPlainObject$1(a){if(!isObjectLike(a)||baseGetTag(a)!=objectTag$3)return!1;var s=getPrototype$1(a);if(s===null)return!0;var d=hasOwnProperty$4.call(s,"constructor")&&s.constructor;return typeof d=="function"&&d instanceof d&&funcToString.call(d)==objectCtorString}function baseSlice(a,s,d){var c=-1,l=a.length;s<0&&(s=-s>l?0:l+s),d=d>l?l:d,d<0&&(d+=l),l=s>d?0:d-s>>>0,s>>>=0;for(var h=Array(l);++c<l;)h[c]=a[c+s];return h}function castSlice(a,s,d){var c=a.length;return d=d===void 0?c:d,!s&&d>=c?a:baseSlice(a,s,d)}var rsAstralRange$2="\\ud800-\\udfff",rsComboMarksRange$3="\\u0300-\\u036f",reComboHalfMarksRange$3="\\ufe20-\\ufe2f",rsComboSymbolsRange$3="\\u20d0-\\u20ff",rsComboRange$3=rsComboMarksRange$3+reComboHalfMarksRange$3+rsComboSymbolsRange$3,rsVarRange$2="\\ufe0e\\ufe0f",rsZWJ$2="\\u200d",reHasUnicode=RegExp("["+rsZWJ$2+rsAstralRange$2+rsComboRange$3+rsVarRange$2+"]");function hasUnicode(a){return reHasUnicode.test(a)}function asciiToArray(a){return a.split("")}var rsAstralRange$1="\\ud800-\\udfff",rsComboMarksRange$2="\\u0300-\\u036f",reComboHalfMarksRange$2="\\ufe20-\\ufe2f",rsComboSymbolsRange$2="\\u20d0-\\u20ff",rsComboRange$2=rsComboMarksRange$2+reComboHalfMarksRange$2+rsComboSymbolsRange$2,rsVarRange$1="\\ufe0e\\ufe0f",rsAstral="["+rsAstralRange$1+"]",rsCombo$2="["+rsComboRange$2+"]",rsFitz$1="\\ud83c[\\udffb-\\udfff]",rsModifier$1="(?:"+rsCombo$2+"|"+rsFitz$1+")",rsNonAstral$1="[^"+rsAstralRange$1+"]",rsRegional$1="(?:\\ud83c[\\udde6-\\uddff]){2}",rsSurrPair$1="[\\ud800-\\udbff][\\udc00-\\udfff]",rsZWJ$1="\\u200d",reOptMod$1=rsModifier$1+"?",rsOptVar$1="["+rsVarRange$1+"]?",rsOptJoin$1="(?:"+rsZWJ$1+"(?:"+[rsNonAstral$1,rsRegional$1,rsSurrPair$1].join("|")+")"+rsOptVar$1+reOptMod$1+")*",rsSeq$1=rsOptVar$1+reOptMod$1+rsOptJoin$1,rsSymbol="(?:"+[rsNonAstral$1+rsCombo$2+"?",rsCombo$2,rsRegional$1,rsSurrPair$1,rsAstral].join("|")+")",reUnicode=RegExp(rsFitz$1+"(?="+rsFitz$1+")|"+rsSymbol+rsSeq$1,"g");function unicodeToArray(a){return a.match(reUnicode)||[]}function stringToArray(a){return hasUnicode(a)?unicodeToArray(a):asciiToArray(a)}function createCaseFirst(a){return function(s){s=toString$1(s);var d=hasUnicode(s)?stringToArray(s):void 0,c=d?d[0]:s.charAt(0),l=d?castSlice(d,1).join(""):s.slice(1);return c[a]()+l}}var upperFirst=createCaseFirst("toUpperCase"),upperFirst$1=upperFirst;function capitalize(a){return upperFirst$1(toString$1(a).toLowerCase())}function arrayReduce(a,s,d,c){var l=-1,h=a==null?0:a.length;for(c&&h&&(d=a[++l]);++l<h;)d=s(d,a[l],l,a);return d}function basePropertyOf(a){return function(s){return a==null?void 0:a[s]}}var deburredLetters={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},deburrLetter=basePropertyOf(deburredLetters),deburrLetter$1=deburrLetter,reLatin=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,rsComboMarksRange$1="\\u0300-\\u036f",reComboHalfMarksRange$1="\\ufe20-\\ufe2f",rsComboSymbolsRange$1="\\u20d0-\\u20ff",rsComboRange$1=rsComboMarksRange$1+reComboHalfMarksRange$1+rsComboSymbolsRange$1,rsCombo$1="["+rsComboRange$1+"]",reComboMark=RegExp(rsCombo$1,"g");function deburr(a){return a=toString$1(a),a&&a.replace(reLatin,deburrLetter$1).replace(reComboMark,"")}var reAsciiWord=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function asciiWords(a){return a.match(reAsciiWord)||[]}var reHasUnicodeWord=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function hasUnicodeWord(a){return reHasUnicodeWord.test(a)}var rsAstralRange="\\ud800-\\udfff",rsComboMarksRange="\\u0300-\\u036f",reComboHalfMarksRange="\\ufe20-\\ufe2f",rsComboSymbolsRange="\\u20d0-\\u20ff",rsComboRange=rsComboMarksRange+reComboHalfMarksRange+rsComboSymbolsRange,rsDingbatRange="\\u2700-\\u27bf",rsLowerRange="a-z\\xdf-\\xf6\\xf8-\\xff",rsMathOpRange="\\xac\\xb1\\xd7\\xf7",rsNonCharRange="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",rsPunctuationRange="\\u2000-\\u206f",rsSpaceRange=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",rsUpperRange="A-Z\\xc0-\\xd6\\xd8-\\xde",rsVarRange="\\ufe0e\\ufe0f",rsBreakRange=rsMathOpRange+rsNonCharRange+rsPunctuationRange+rsSpaceRange,rsApos$1="['\u2019]",rsBreak="["+rsBreakRange+"]",rsCombo="["+rsComboRange+"]",rsDigits="\\d+",rsDingbat="["+rsDingbatRange+"]",rsLower="["+rsLowerRange+"]",rsMisc="[^"+rsAstralRange+rsBreakRange+rsDigits+rsDingbatRange+rsLowerRange+rsUpperRange+"]",rsFitz="\\ud83c[\\udffb-\\udfff]",rsModifier="(?:"+rsCombo+"|"+rsFitz+")",rsNonAstral="[^"+rsAstralRange+"]",rsRegional="(?:\\ud83c[\\udde6-\\uddff]){2}",rsSurrPair="[\\ud800-\\udbff][\\udc00-\\udfff]",rsUpper="["+rsUpperRange+"]",rsZWJ="\\u200d",rsMiscLower="(?:"+rsLower+"|"+rsMisc+")",rsMiscUpper="(?:"+rsUpper+"|"+rsMisc+")",rsOptContrLower="(?:"+rsApos$1+"(?:d|ll|m|re|s|t|ve))?",rsOptContrUpper="(?:"+rsApos$1+"(?:D|LL|M|RE|S|T|VE))?",reOptMod=rsModifier+"?",rsOptVar="["+rsVarRange+"]?",rsOptJoin="(?:"+rsZWJ+"(?:"+[rsNonAstral,rsRegional,rsSurrPair].join("|")+")"+rsOptVar+reOptMod+")*",rsOrdLower="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",rsOrdUpper="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",rsSeq=rsOptVar+reOptMod+rsOptJoin,rsEmoji="(?:"+[rsDingbat,rsRegional,rsSurrPair].join("|")+")"+rsSeq,reUnicodeWord=RegExp([rsUpper+"?"+rsLower+"+"+rsOptContrLower+"(?="+[rsBreak,rsUpper,"$"].join("|")+")",rsMiscUpper+"+"+rsOptContrUpper+"(?="+[rsBreak,rsUpper+rsMiscLower,"$"].join("|")+")",rsUpper+"?"+rsMiscLower+"+"+rsOptContrLower,rsUpper+"+"+rsOptContrUpper,rsOrdUpper,rsOrdLower,rsDigits,rsEmoji].join("|"),"g");function unicodeWords(a){return a.match(reUnicodeWord)||[]}function words(a,s,d){return a=toString$1(a),s=d?void 0:s,s===void 0?hasUnicodeWord(a)?unicodeWords(a):asciiWords(a):a.match(s)||[]}var rsApos="['\u2019]",reApos=RegExp(rsApos,"g");function createCompounder(a){return function(s){return arrayReduce(words(deburr(s).replace(reApos,"")),a,"")}}var camelCase$2=createCompounder(function(a,s,d){return s=s.toLowerCase(),a+(d?capitalize(s):s)}),camelCase$3=camelCase$2;function stackClear(){this.__data__=new ListCache,this.size=0}function stackDelete(a){var s=this.__data__,d=s.delete(a);return this.size=s.size,d}function stackGet(a){return this.__data__.get(a)}function stackHas(a){return this.__data__.has(a)}var LARGE_ARRAY_SIZE=200;function stackSet(a,s){var d=this.__data__;if(d instanceof ListCache){var c=d.__data__;if(!Map$2||c.length<LARGE_ARRAY_SIZE-1)return c.push([a,s]),this.size=++d.size,this;d=this.__data__=new MapCache(c)}return d.set(a,s),this.size=d.size,this}function Stack(a){var s=this.__data__=new ListCache(a);this.size=s.size}Stack.prototype.clear=stackClear,Stack.prototype.delete=stackDelete,Stack.prototype.get=stackGet,Stack.prototype.has=stackHas,Stack.prototype.set=stackSet;function baseAssign(a,s){return a&&copyObject(s,keys$1(s),a)}function baseAssignIn(a,s){return a&&copyObject(s,keysIn(s),a)}var freeExports=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports=freeModule&&freeModule.exports===freeExports,Buffer$1=moduleExports?root$1.Buffer:void 0,allocUnsafe=Buffer$1?Buffer$1.allocUnsafe:void 0;function cloneBuffer(a,s){if(s)return a.slice();var d=a.length,c=allocUnsafe?allocUnsafe(d):new a.constructor(d);return a.copy(c),c}function arrayFilter(a,s){for(var d=-1,c=a==null?0:a.length,l=0,h=[];++d<c;){var p=a[d];s(p,d,a)&&(h[l++]=p)}return h}function stubArray(){return[]}var objectProto$3=Object.prototype,propertyIsEnumerable=objectProto$3.propertyIsEnumerable,nativeGetSymbols$1=Object.getOwnPropertySymbols,getSymbols=nativeGetSymbols$1?function(a){return a==null?[]:(a=Object(a),arrayFilter(nativeGetSymbols$1(a),function(s){return propertyIsEnumerable.call(a,s)}))}:stubArray,getSymbols$1=getSymbols;function copySymbols(a,s){return copyObject(a,getSymbols$1(a),s)}var nativeGetSymbols=Object.getOwnPropertySymbols,getSymbolsIn=nativeGetSymbols?function(a){for(var s=[];a;)arrayPush(s,getSymbols$1(a)),a=getPrototype$1(a);return s}:stubArray,getSymbolsIn$1=getSymbolsIn;function copySymbolsIn(a,s){return copyObject(a,getSymbolsIn$1(a),s)}function baseGetAllKeys(a,s,d){var c=s(a);return isArray$4(a)?c:arrayPush(c,d(a))}function getAllKeys(a){return baseGetAllKeys(a,keys$1,getSymbols$1)}function getAllKeysIn(a){return baseGetAllKeys(a,keysIn,getSymbolsIn$1)}var DataView$1=getNative(root$1,"DataView"),DataView$2=DataView$1,Promise$1=getNative(root$1,"Promise"),Promise$2=Promise$1,Set$1=getNative(root$1,"Set"),Set$2=Set$1,mapTag$4="[object Map]",objectTag$2="[object Object]",promiseTag="[object Promise]",setTag$4="[object Set]",weakMapTag$1="[object WeakMap]",dataViewTag$3="[object DataView]",dataViewCtorString=toSource(DataView$2),mapCtorString=toSource(Map$2),promiseCtorString=toSource(Promise$2),setCtorString=toSource(Set$2),weakMapCtorString=toSource(WeakMap$3),getTag=baseGetTag;(DataView$2&&getTag(new DataView$2(new ArrayBuffer(1)))!=dataViewTag$3||Map$2&&getTag(new Map$2)!=mapTag$4||Promise$2&&getTag(Promise$2.resolve())!=promiseTag||Set$2&&getTag(new Set$2)!=setTag$4||WeakMap$3&&getTag(new WeakMap$3)!=weakMapTag$1)&&(getTag=function(a){var s=baseGetTag(a),d=s==objectTag$2?a.constructor:void 0,c=d?toSource(d):"";if(c)switch(c){case dataViewCtorString:return dataViewTag$3;case mapCtorString:return mapTag$4;case promiseCtorString:return promiseTag;case setCtorString:return setTag$4;case weakMapCtorString:return weakMapTag$1}return s});var getTag$1=getTag,objectProto$2=Object.prototype,hasOwnProperty$3=objectProto$2.hasOwnProperty;function initCloneArray(a){var s=a.length,d=new a.constructor(s);return s&&typeof a[0]=="string"&&hasOwnProperty$3.call(a,"index")&&(d.index=a.index,d.input=a.input),d}var Uint8Array$1=root$1.Uint8Array,Uint8Array$2=Uint8Array$1;function cloneArrayBuffer(a){var s=new a.constructor(a.byteLength);return new Uint8Array$2(s).set(new Uint8Array$2(a)),s}function cloneDataView(a,s){var d=s?cloneArrayBuffer(a.buffer):a.buffer;return new a.constructor(d,a.byteOffset,a.byteLength)}var reFlags=/\w*$/;function cloneRegExp(a){var s=new a.constructor(a.source,reFlags.exec(a));return s.lastIndex=a.lastIndex,s}var symbolProto$1=Symbol$2?Symbol$2.prototype:void 0,symbolValueOf$1=symbolProto$1?symbolProto$1.valueOf:void 0;function cloneSymbol(a){return symbolValueOf$1?Object(symbolValueOf$1.call(a)):{}}function cloneTypedArray(a,s){var d=s?cloneArrayBuffer(a.buffer):a.buffer;return new a.constructor(d,a.byteOffset,a.length)}var boolTag$2="[object Boolean]",dateTag$2="[object Date]",mapTag$3="[object Map]",numberTag$2="[object Number]",regexpTag$2="[object RegExp]",setTag$3="[object Set]",stringTag$2="[object String]",symbolTag$2="[object Symbol]",arrayBufferTag$2="[object ArrayBuffer]",dataViewTag$2="[object DataView]",float32Tag$1="[object Float32Array]",float64Tag$1="[object Float64Array]",int8Tag$1="[object Int8Array]",int16Tag$1="[object Int16Array]",int32Tag$1="[object Int32Array]",uint8Tag$1="[object Uint8Array]",uint8ClampedTag$1="[object Uint8ClampedArray]",uint16Tag$1="[object Uint16Array]",uint32Tag$1="[object Uint32Array]";function initCloneByTag(a,s,d){var c=a.constructor;switch(s){case arrayBufferTag$2:return cloneArrayBuffer(a);case boolTag$2:case dateTag$2:return new c(+a);case dataViewTag$2:return cloneDataView(a,d);case float32Tag$1:case float64Tag$1:case int8Tag$1:case int16Tag$1:case int32Tag$1:case uint8Tag$1:case uint8ClampedTag$1:case uint16Tag$1:case uint32Tag$1:return cloneTypedArray(a,d);case mapTag$3:return new c;case numberTag$2:case stringTag$2:return new c(a);case regexpTag$2:return cloneRegExp(a);case setTag$3:return new c;case symbolTag$2:return cloneSymbol(a)}}function initCloneObject(a){return typeof a.constructor=="function"&&!isPrototype(a)?baseCreate$1(getPrototype$1(a)):{}}var mapTag$2="[object Map]";function baseIsMap(a){return isObjectLike(a)&&getTag$1(a)==mapTag$2}var nodeIsMap=nodeUtil$1&&nodeUtil$1.isMap,isMap=nodeIsMap?baseUnary(nodeIsMap):baseIsMap,isMap$1=isMap,setTag$2="[object Set]";function baseIsSet(a){return isObjectLike(a)&&getTag$1(a)==setTag$2}var nodeIsSet=nodeUtil$1&&nodeUtil$1.isSet,isSet$1=nodeIsSet?baseUnary(nodeIsSet):baseIsSet,isSet$2=isSet$1,CLONE_DEEP_FLAG$2=1,CLONE_FLAT_FLAG$1=2,CLONE_SYMBOLS_FLAG$2=4,argsTag$1="[object Arguments]",arrayTag$1="[object Array]",boolTag$1="[object Boolean]",dateTag$1="[object Date]",errorTag$1="[object Error]",funcTag="[object Function]",genTag="[object GeneratorFunction]",mapTag$1="[object Map]",numberTag$1="[object Number]",objectTag$1="[object Object]",regexpTag$1="[object RegExp]",setTag$1="[object Set]",stringTag$1="[object String]",symbolTag$1="[object Symbol]",weakMapTag="[object WeakMap]",arrayBufferTag$1="[object ArrayBuffer]",dataViewTag$1="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",cloneableTags={};cloneableTags[argsTag$1]=cloneableTags[arrayTag$1]=cloneableTags[arrayBufferTag$1]=cloneableTags[dataViewTag$1]=cloneableTags[boolTag$1]=cloneableTags[dateTag$1]=cloneableTags[float32Tag]=cloneableTags[float64Tag]=cloneableTags[int8Tag]=cloneableTags[int16Tag]=cloneableTags[int32Tag]=cloneableTags[mapTag$1]=cloneableTags[numberTag$1]=cloneableTags[objectTag$1]=cloneableTags[regexpTag$1]=cloneableTags[setTag$1]=cloneableTags[stringTag$1]=cloneableTags[symbolTag$1]=cloneableTags[uint8Tag]=cloneableTags[uint8ClampedTag]=cloneableTags[uint16Tag]=cloneableTags[uint32Tag]=!0,cloneableTags[errorTag$1]=cloneableTags[funcTag]=cloneableTags[weakMapTag]=!1;function baseClone(a,s,d,c,l,h){var p,y=s&CLONE_DEEP_FLAG$2,_=s&CLONE_FLAT_FLAG$1,E=s&CLONE_SYMBOLS_FLAG$2;if(d&&(p=l?d(a,c,l,h):d(a)),p!==void 0)return p;if(!isObject$5(a))return a;var O=isArray$4(a);if(O){if(p=initCloneArray(a),!y)return copyArray(a,p)}else{var P=getTag$1(a),C=P==funcTag||P==genTag;if(isBuffer$2(a))return cloneBuffer(a,y);if(P==objectTag$1||P==argsTag$1||C&&!l){if(p=_||C?{}:initCloneObject(a),!y)return _?copySymbolsIn(a,baseAssignIn(p,a)):copySymbols(a,baseAssign(p,a))}else{if(!cloneableTags[P])return l?a:{};p=initCloneByTag(a,P,y)}}h||(h=new Stack);var A=h.get(a);if(A)return A;h.set(a,p),isSet$2(a)?a.forEach(function(F){p.add(baseClone(F,s,d,F,a,h))}):isMap$1(a)&&a.forEach(function(F,j){p.set(j,baseClone(F,s,d,j,a,h))});var q=E?_?getAllKeysIn:getAllKeys:_?keysIn:keys$1,U=O?void 0:q(a);return arrayEach(U||a,function(F,j){U&&(j=F,F=a[j]),assignValue(p,j,baseClone(F,s,d,j,a,h))}),p}var CLONE_DEEP_FLAG$1=1,CLONE_SYMBOLS_FLAG$1=4;function cloneDeep(a){return baseClone(a,CLONE_DEEP_FLAG$1|CLONE_SYMBOLS_FLAG$1)}var HASH_UNDEFINED="__lodash_hash_undefined__";function setCacheAdd(a){return this.__data__.set(a,HASH_UNDEFINED),this}function setCacheHas(a){return this.__data__.has(a)}function SetCache(a){var s=-1,d=a==null?0:a.length;for(this.__data__=new MapCache;++s<d;)this.add(a[s])}SetCache.prototype.add=SetCache.prototype.push=setCacheAdd,SetCache.prototype.has=setCacheHas;function arraySome(a,s){for(var d=-1,c=a==null?0:a.length;++d<c;)if(s(a[d],d,a))return!0;return!1}function cacheHas(a,s){return a.has(s)}var COMPARE_PARTIAL_FLAG$5=1,COMPARE_UNORDERED_FLAG$3=2;function equalArrays(a,s,d,c,l,h){var p=d&COMPARE_PARTIAL_FLAG$5,y=a.length,_=s.length;if(y!=_&&!(p&&_>y))return!1;var E=h.get(a),O=h.get(s);if(E&&O)return E==s&&O==a;var P=-1,C=!0,A=d&COMPARE_UNORDERED_FLAG$3?new SetCache:void 0;for(h.set(a,s),h.set(s,a);++P<y;){var q=a[P],U=s[P];if(c)var F=p?c(U,q,P,s,a,h):c(q,U,P,a,s,h);if(F!==void 0){if(F)continue;C=!1;break}if(A){if(!arraySome(s,function(j,T){if(!cacheHas(A,T)&&(q===j||l(q,j,d,c,h)))return A.push(T)})){C=!1;break}}else if(!(q===U||l(q,U,d,c,h))){C=!1;break}}return h.delete(a),h.delete(s),C}function mapToArray(a){var s=-1,d=Array(a.size);return a.forEach(function(c,l){d[++s]=[l,c]}),d}function setToArray(a){var s=-1,d=Array(a.size);return a.forEach(function(c){d[++s]=c}),d}var COMPARE_PARTIAL_FLAG$4=1,COMPARE_UNORDERED_FLAG$2=2,boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",mapTag="[object Map]",numberTag="[object Number]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",symbolTag="[object Symbol]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",symbolProto=Symbol$2?Symbol$2.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0;function equalByTag(a,s,d,c,l,h,p){switch(d){case dataViewTag:if(a.byteLength!=s.byteLength||a.byteOffset!=s.byteOffset)return!1;a=a.buffer,s=s.buffer;case arrayBufferTag:return!(a.byteLength!=s.byteLength||!h(new Uint8Array$2(a),new Uint8Array$2(s)));case boolTag:case dateTag:case numberTag:return eq(+a,+s);case errorTag:return a.name==s.name&&a.message==s.message;case regexpTag:case stringTag:return a==s+"";case mapTag:var y=mapToArray;case setTag:var _=c&COMPARE_PARTIAL_FLAG$4;if(y||(y=setToArray),a.size!=s.size&&!_)return!1;var E=p.get(a);if(E)return E==s;c|=COMPARE_UNORDERED_FLAG$2,p.set(a,s);var O=equalArrays(y(a),y(s),c,l,h,p);return p.delete(a),O;case symbolTag:if(symbolValueOf)return symbolValueOf.call(a)==symbolValueOf.call(s)}return!1}var COMPARE_PARTIAL_FLAG$3=1,objectProto$1=Object.prototype,hasOwnProperty$2=objectProto$1.hasOwnProperty;function equalObjects(a,s,d,c,l,h){var p=d&COMPARE_PARTIAL_FLAG$3,y=getAllKeys(a),_=y.length,E=getAllKeys(s),O=E.length;if(_!=O&&!p)return!1;for(var P=_;P--;){var C=y[P];if(!(p?C in s:hasOwnProperty$2.call(s,C)))return!1}var A=h.get(a),q=h.get(s);if(A&&q)return A==s&&q==a;var U=!0;h.set(a,s),h.set(s,a);for(var F=p;++P<_;){C=y[P];var j=a[C],T=s[C];if(c)var D=p?c(T,j,C,s,a,h):c(j,T,C,a,s,h);if(!(D===void 0?j===T||l(j,T,d,c,h):D)){U=!1;break}F||(F=C=="constructor")}if(U&&!F){var J=a.constructor,ee=s.constructor;J!=ee&&"constructor"in a&&"constructor"in s&&!(typeof J=="function"&&J instanceof J&&typeof ee=="function"&&ee instanceof ee)&&(U=!1)}return h.delete(a),h.delete(s),U}var COMPARE_PARTIAL_FLAG$2=1,argsTag="[object Arguments]",arrayTag="[object Array]",objectTag="[object Object]",objectProto=Object.prototype,hasOwnProperty$1=objectProto.hasOwnProperty;function baseIsEqualDeep(a,s,d,c,l,h){var p=isArray$4(a),y=isArray$4(s),_=p?arrayTag:getTag$1(a),E=y?arrayTag:getTag$1(s);_=_==argsTag?objectTag:_,E=E==argsTag?objectTag:E;var O=_==objectTag,P=E==objectTag,C=_==E;if(C&&isBuffer$2(a)){if(!isBuffer$2(s))return!1;p=!0,O=!1}if(C&&!O)return h||(h=new Stack),p||isTypedArray$1(a)?equalArrays(a,s,d,c,l,h):equalByTag(a,s,_,d,c,l,h);if(!(d&COMPARE_PARTIAL_FLAG$2)){var A=O&&hasOwnProperty$1.call(a,"__wrapped__"),q=P&&hasOwnProperty$1.call(s,"__wrapped__");if(A||q){var U=A?a.value():a,F=q?s.value():s;return h||(h=new Stack),l(U,F,d,c,h)}}return C?(h||(h=new Stack),equalObjects(a,s,d,c,l,h)):!1}function baseIsEqual(a,s,d,c,l){return a===s?!0:a==null||s==null||!isObjectLike(a)&&!isObjectLike(s)?a!==a&&s!==s:baseIsEqualDeep(a,s,d,c,baseIsEqual,l)}var COMPARE_PARTIAL_FLAG$1=1,COMPARE_UNORDERED_FLAG$1=2;function baseIsMatch(a,s,d,c){var l=d.length,h=l,p=!c;if(a==null)return!h;for(a=Object(a);l--;){var y=d[l];if(p&&y[2]?y[1]!==a[y[0]]:!(y[0]in a))return!1}for(;++l<h;){y=d[l];var _=y[0],E=a[_],O=y[1];if(p&&y[2]){if(E===void 0&&!(_ in a))return!1}else{var P=new Stack;if(c)var C=c(E,O,_,a,s,P);if(!(C===void 0?baseIsEqual(O,E,COMPARE_PARTIAL_FLAG$1|COMPARE_UNORDERED_FLAG$1,c,P):C))return!1}}return!0}function isStrictComparable(a){return a===a&&!isObject$5(a)}function getMatchData(a){for(var s=keys$1(a),d=s.length;d--;){var c=s[d],l=a[c];s[d]=[c,l,isStrictComparable(l)]}return s}function matchesStrictComparable(a,s){return function(d){return d==null?!1:d[a]===s&&(s!==void 0||a in Object(d))}}function baseMatches(a){var s=getMatchData(a);return s.length==1&&s[0][2]?matchesStrictComparable(s[0][0],s[0][1]):function(d){return d===a||baseIsMatch(d,a,s)}}function baseHasIn(a,s){return a!=null&&s in Object(a)}function hasPath(a,s,d){s=castPath(s,a);for(var c=-1,l=s.length,h=!1;++c<l;){var p=toKey(s[c]);if(!(h=a!=null&&d(a,p)))break;a=a[p]}return h||++c!=l?h:(l=a==null?0:a.length,!!l&&isLength(l)&&isIndex(p,l)&&(isArray$4(a)||isArguments$1(a)))}function hasIn(a,s){return a!=null&&hasPath(a,s,baseHasIn)}var COMPARE_PARTIAL_FLAG=1,COMPARE_UNORDERED_FLAG=2;function baseMatchesProperty(a,s){return isKey(a)&&isStrictComparable(s)?matchesStrictComparable(toKey(a),s):function(d){var c=get(d,a);return c===void 0&&c===s?hasIn(d,a):baseIsEqual(s,c,COMPARE_PARTIAL_FLAG|COMPARE_UNORDERED_FLAG)}}function baseProperty(a){return function(s){return s==null?void 0:s[a]}}function basePropertyDeep(a){return function(s){return baseGet(s,a)}}function property(a){return isKey(a)?baseProperty(toKey(a)):basePropertyDeep(a)}function baseIteratee(a){return typeof a=="function"?a:a==null?identity$1:typeof a=="object"?isArray$4(a)?baseMatchesProperty(a[0],a[1]):baseMatches(a):property(a)}function createBaseFor(a){return function(s,d,c){for(var l=-1,h=Object(s),p=c(s),y=p.length;y--;){var _=p[a?y:++l];if(d(h[_],_,h)===!1)break}return s}}var baseFor=createBaseFor(),baseFor$1=baseFor;function baseForOwn(a,s){return a&&baseFor$1(a,s,keys$1)}function createBaseEach(a,s){return function(d,c){if(d==null)return d;if(!isArrayLike$1(d))return a(d,c);for(var l=d.length,h=s?l:-1,p=Object(d);(s?h--:++h<l)&&c(p[h],h,p)!==!1;);return d}}var baseEach=createBaseEach(baseForOwn),baseEach$1=baseEach,now=function(){return root$1.Date.now()},now$1=now,FUNC_ERROR_TEXT="Expected a function",nativeMax=Math.max,nativeMin=Math.min;function debounce$1(a,s,d){var c,l,h,p,y,_,E=0,O=!1,P=!1,C=!0;if(typeof a!="function")throw new TypeError(FUNC_ERROR_TEXT);s=toNumber(s)||0,isObject$5(d)&&(O=!!d.leading,P="maxWait"in d,h=P?nativeMax(toNumber(d.maxWait)||0,s):h,C="trailing"in d?!!d.trailing:C);function A(z){var ne=c,X=l;return c=l=void 0,E=z,p=a.apply(X,ne),p}function q(z){return E=z,y=setTimeout(j,s),O?A(z):p}function U(z){var ne=z-_,X=z-E,M=s-ne;return P?nativeMin(M,h-X):M}function F(z){var ne=z-_,X=z-E;return _===void 0||ne>=s||ne<0||P&&X>=h}function j(){var z=now$1();if(F(z))return T(z);y=setTimeout(j,U(z))}function T(z){return y=void 0,C&&c?A(z):(c=l=void 0,p)}function D(){y!==void 0&&clearTimeout(y),E=0,c=_=l=y=void 0}function J(){return y===void 0?p:T(now$1())}function ee(){var z=now$1(),ne=F(z);if(c=arguments,l=this,_=z,ne){if(y===void 0)return q(_);if(P)return clearTimeout(y),y=setTimeout(j,s),A(_)}return y===void 0&&(y=setTimeout(j,s)),p}return ee.cancel=D,ee.flush=J,ee}function last$1(a){var s=a==null?0:a.length;return s?a[s-1]:void 0}function arrayEvery(a,s){for(var d=-1,c=a==null?0:a.length;++d<c;)if(!s(a[d],d,a))return!1;return!0}function baseEvery(a,s){var d=!0;return baseEach$1(a,function(c,l,h){return d=!!s(c,l,h),d}),d}function every$1(a,s,d){var c=isArray$4(a)?arrayEvery:baseEvery;return d&&isIterateeCall(a,s,d)&&(s=void 0),c(a,baseIteratee(s))}function baseMap(a,s){var d=-1,c=isArrayLike$1(a)?Array(a.length):[];return baseEach$1(a,function(l,h,p){c[++d]=s(l,h,p)}),c}function parent(a,s){return s.length<2?a:baseGet(a,baseSlice(s,0,-1))}function isEqual(a,s){return baseIsEqual(a,s)}function isMatch(a,s){return a===s||baseIsMatch(a,s,getMatchData(s))}var kebabCase=createCompounder(function(a,s,d){return a+(d?"-":"")+s.toLowerCase()}),kebabCase$1=kebabCase;function baseUnset(a,s){return s=castPath(s,a),a=parent(a,s),a==null||delete a[toKey(last$1(s))]}function customOmitClone(a){return isPlainObject$1(a)?void 0:a}var CLONE_DEEP_FLAG=1,CLONE_FLAT_FLAG=2,CLONE_SYMBOLS_FLAG=4,omit=flatRest(function(a,s){var d={};if(a==null)return d;var c=!1;s=arrayMap(s,function(h){return h=castPath(h,a),c||(c=h.length>1),h}),copyObject(a,getAllKeysIn(a),d),c&&(d=baseClone(d,CLONE_DEEP_FLAG|CLONE_FLAT_FLAG|CLONE_SYMBOLS_FLAG,customOmitClone));for(var l=s.length;l--;)baseUnset(d,s[l]);return d}),omit$1=omit;function baseSet(a,s,d,c){if(!isObject$5(a))return a;s=castPath(s,a);for(var l=-1,h=s.length,p=h-1,y=a;y!=null&&++l<h;){var _=toKey(s[l]),E=d;if(_==="__proto__"||_==="constructor"||_==="prototype")return a;if(l!=p){var O=y[_];E=c?c(O,_,y):void 0,E===void 0&&(E=isObject$5(O)?O:isIndex(s[l+1])?[]:{})}assignValue(y,_,E),y=y[_]}return a}function basePickBy(a,s,d){for(var c=-1,l=s.length,h={};++c<l;){var p=s[c],y=baseGet(a,p);d(y,p)&&baseSet(h,castPath(p,a),y)}return h}function baseSortBy(a,s){var d=a.length;for(a.sort(s);d--;)a[d]=a[d].value;return a}function compareAscending(a,s){if(a!==s){var d=a!==void 0,c=a===null,l=a===a,h=isSymbol(a),p=s!==void 0,y=s===null,_=s===s,E=isSymbol(s);if(!y&&!E&&!h&&a>s||h&&p&&_&&!y&&!E||c&&p&&_||!d&&_||!l)return 1;if(!c&&!h&&!E&&a<s||E&&d&&l&&!c&&!h||y&&d&&l||!p&&l||!_)return-1}return 0}function compareMultiple(a,s,d){for(var c=-1,l=a.criteria,h=s.criteria,p=l.length,y=d.length;++c<p;){var _=compareAscending(l[c],h[c]);if(_){if(c>=y)return _;var E=d[c];return _*(E=="desc"?-1:1)}}return a.index-s.index}function baseOrderBy(a,s,d){s.length?s=arrayMap(s,function(h){return isArray$4(h)?function(p){return baseGet(p,h.length===1?h[0]:h)}:h}):s=[identity$1];var c=-1;s=arrayMap(s,baseUnary(baseIteratee));var l=baseMap(a,function(h,p,y){var _=arrayMap(s,function(E){return E(h)});return{criteria:_,index:++c,value:h}});return baseSortBy(l,function(h,p){return compareMultiple(h,p,d)})}function basePick(a,s){return basePickBy(a,s,function(d,c){return hasIn(a,c)})}var pick=flatRest(function(a,s){return a==null?{}:basePick(a,s)}),pick$1=pick;function baseIndexOfWith(a,s,d,c){for(var l=d-1,h=a.length;++l<h;)if(c(a[l],s))return l;return-1}var arrayProto=Array.prototype,splice=arrayProto.splice;function basePullAll(a,s,d,c){var l=c?baseIndexOfWith:baseIndexOf,h=-1,p=s.length,y=a;for(a===s&&(s=copyArray(s)),d&&(y=arrayMap(a,baseUnary(d)));++h<p;)for(var _=0,E=s[h],O=d?d(E):E;(_=l(y,O,_,c))>-1;)y!==a&&splice.call(y,_,1),splice.call(a,_,1);return a}function pullAll(a,s){return a&&a.length&&s&&s.length?basePullAll(a,s):a}var pull$1=baseRest(pullAll),pull$2=pull$1,sortBy=baseRest(function(a,s){if(a==null)return[];var d=s.length;return d>1&&isIterateeCall(a,s[0],s[1])?s=[]:d>2&&isIterateeCall(s[0],s[1],s[2])&&(s=[s[0]]),baseOrderBy(a,baseFlatten(s,1),[])}),sortBy$1=sortBy,fastDeepEqual=function a(s,d){if(s===d)return!0;if(s&&d&&typeof s=="object"&&typeof d=="object"){if(s.constructor!==d.constructor)return!1;var c,l,h;if(Array.isArray(s)){if(c=s.length,c!=d.length)return!1;for(l=c;l--!==0;)if(!a(s[l],d[l]))return!1;return!0}if(s.constructor===RegExp)return s.source===d.source&&s.flags===d.flags;if(s.valueOf!==Object.prototype.valueOf)return s.valueOf()===d.valueOf();if(s.toString!==Object.prototype.toString)return s.toString()===d.toString();if(h=Object.keys(s),c=h.length,c!==Object.keys(d).length)return!1;for(l=c;l--!==0;)if(!Object.prototype.hasOwnProperty.call(d,h[l]))return!1;for(l=c;l--!==0;){var p=h[l];if(!a(s[p],d[p]))return!1}return!0}return s!==s&&d!==d};const generateId=()=>(Math.random()*1e20).toString(36),insertAt$1=(a=0,s,d,c=!1)=>[...d.slice(0,a),...[s].flat(),...d.slice(c?a+1:a)],replaceItem$1=(a,s,d)=>{a=typeof a=="function"?a:l=>l===a;const c=d.findIndex(a);return c<0?d:insertAt$1(c,s,d,!0)},swapIndex=(a,s,d)=>{if(!d[a]||!d[s])return d;d=[...d];const c=d[a];return d[a]=d[s],d[s]=c,d},swapItems=(a,s,d)=>{const c=d.findIndex(h=>h===a),l=d.findIndex(h=>h===s);return c<0||l<0?d:swapIndex(c,l,d)},toDataNode$1=a=>a?{id:a.id,props:a.props,childIds:(a.children||[]).map(s=>s.id)}:null,toSceneNode=a=>({id:a.id,props:a.props,children:[]}),toSceneTree=(a,s)=>{const d=a.find(l=>l.id===s);if(!d)return null;const c=d.childIds;return{id:d.id,props:d.props,children:c.map(l=>toSceneTree(a,l)).filter(Boolean)}},forEachDown$1=(a,s)=>{s(a),(a.children||[]).forEach(c=>forEachDown$1(c,(l,h)=>{s(l,h||a)}))},mapDown=(a,s)=>{const d=s(a);return{...d,children:((d==null?void 0:d.children)||(a==null?void 0:a.children)||[]).map(c=>mapDown(c,s))}},mapDownAsync=async(a,s)=>{var c;const d=(c=a==null?void 0:a.children)!=null?c:[];return{...await s(a),children:await Promise.all(d.map(l=>mapDownAsync(l,s)))}},getElementAttributes=a=>Object.values(a.attributes).reduce((s,d)=>({...s,[d.name]:d.value}),{}),asArray=a=>isArray$4(a)?a:[a],sizeToNum=(a,s)=>typeof a=="number"?a:typeof a=="string"?a.indexOf("%")>-1?parseFloat(a)/100*s:parseFloat(a):0,asSize=a=>typeof a=="number"?a+"px":typeof a=="string"?a.indexOf("%")>-1?parseFloat(a)+"%":a:"0px",asDuration=a=>typeof a=="string"?a:typeof a=="number"?a+"ms":"0ms",values=a=>Array.from(a.values());var Logic=Object.freeze(Object.defineProperty({__proto__:null,deepEqual:fastDeepEqual,generateId,insertAt:insertAt$1,replaceItem:replaceItem$1,swapIndex,swapItems,toDataNode:toDataNode$1,toSceneNode,toSceneTree,forEachDown:forEachDown$1,mapDown,mapDownAsync,getElementAttributes,asArray,sizeToNum,asSize,asDuration,values,pick:pick$1,pull:pull$2,omit:omit$1,isEqual,cloneDeep,sortBy:sortBy$1,debounce:debounce$1,camelCase:camelCase$3,kebabCase:kebabCase$1,isArray:isArray$4,every:every$1},Symbol.toStringTag,{value:"Module"})),lib$2={};function e(a){this.message=a}e.prototype=new Error,e.prototype.name="InvalidCharacterError";var r$1=typeof window!="undefined"&&window.atob&&window.atob.bind(window)||function(a){var s=String(a).replace(/=+$/,"");if(s.length%4==1)throw new e("'atob' failed: The string to be decoded is not correctly encoded.");for(var d,c,l=0,h=0,p="";c=s.charAt(h++);~c&&(d=l%4?64*d+c:c,l++%4)?p+=String.fromCharCode(255&d>>(-2*l&6)):0)c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c);return p};function t(a){var s=a.replace(/-/g,"+").replace(/_/g,"/");switch(s.length%4){case 0:break;case 2:s+="==";break;case 3:s+="=";break;default:throw"Illegal base64url string!"}try{return function(d){return decodeURIComponent(r$1(d).replace(/(.)/g,function(c,l){var h=l.charCodeAt(0).toString(16).toUpperCase();return h.length<2&&(h="0"+h),"%"+h}))}(s)}catch{return r$1(s)}}function n(a){this.message=a}function o(a,s){if(typeof a!="string")throw new n("Invalid token specified");var d=(s=s||{}).header===!0?0:1;try{return JSON.parse(t(a.split(".")[d]))}catch(c){throw new n("Invalid token specified: "+c.message)}}n.prototype=new Error,n.prototype.name="InvalidTokenError";var jwtDecode_esm=Object.freeze(Object.defineProperty({__proto__:null,default:o,InvalidTokenError:n},Symbol.toStringTag,{value:"Module"})),require$$0$2=getAugmentedNamespace(jwtDecode_esm),getRandomValues,rnds8=new Uint8Array(16);function rng(){if(!getRandomValues&&(getRandomValues=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!getRandomValues))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return getRandomValues(rnds8)}var REGEX=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function validate$1(a){return typeof a=="string"&&REGEX.test(a)}for(var byteToHex=[],i=0;i<256;++i)byteToHex.push((i+256).toString(16).substr(1));function stringify(a){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,d=(byteToHex[a[s+0]]+byteToHex[a[s+1]]+byteToHex[a[s+2]]+byteToHex[a[s+3]]+"-"+byteToHex[a[s+4]]+byteToHex[a[s+5]]+"-"+byteToHex[a[s+6]]+byteToHex[a[s+7]]+"-"+byteToHex[a[s+8]]+byteToHex[a[s+9]]+"-"+byteToHex[a[s+10]]+byteToHex[a[s+11]]+byteToHex[a[s+12]]+byteToHex[a[s+13]]+byteToHex[a[s+14]]+byteToHex[a[s+15]]).toLowerCase();if(!validate$1(d))throw TypeError("Stringified UUID is invalid");return d}var _nodeId,_clockseq,_lastMSecs=0,_lastNSecs=0;function v1(a,s,d){var c=s&&d||0,l=s||new Array(16);a=a||{};var h=a.node||_nodeId,p=a.clockseq!==void 0?a.clockseq:_clockseq;if(h==null||p==null){var y=a.random||(a.rng||rng)();h==null&&(h=_nodeId=[y[0]|1,y[1],y[2],y[3],y[4],y[5]]),p==null&&(p=_clockseq=(y[6]<<8|y[7])&16383)}var _=a.msecs!==void 0?a.msecs:Date.now(),E=a.nsecs!==void 0?a.nsecs:_lastNSecs+1,O=_-_lastMSecs+(E-_lastNSecs)/1e4;if(O<0&&a.clockseq===void 0&&(p=p+1&16383),(O<0||_>_lastMSecs)&&a.nsecs===void 0&&(E=0),E>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");_lastMSecs=_,_lastNSecs=E,_clockseq=p,_+=122192928e5;var P=((_&268435455)*1e4+E)%4294967296;l[c++]=P>>>24&255,l[c++]=P>>>16&255,l[c++]=P>>>8&255,l[c++]=P&255;var C=_/4294967296*1e4&268435455;l[c++]=C>>>8&255,l[c++]=C&255,l[c++]=C>>>24&15|16,l[c++]=C>>>16&255,l[c++]=p>>>8|128,l[c++]=p&255;for(var A=0;A<6;++A)l[c+A]=h[A];return s||stringify(l)}function parse$1(a){if(!validate$1(a))throw TypeError("Invalid UUID");var s,d=new Uint8Array(16);return d[0]=(s=parseInt(a.slice(0,8),16))>>>24,d[1]=s>>>16&255,d[2]=s>>>8&255,d[3]=s&255,d[4]=(s=parseInt(a.slice(9,13),16))>>>8,d[5]=s&255,d[6]=(s=parseInt(a.slice(14,18),16))>>>8,d[7]=s&255,d[8]=(s=parseInt(a.slice(19,23),16))>>>8,d[9]=s&255,d[10]=(s=parseInt(a.slice(24,36),16))/1099511627776&255,d[11]=s/4294967296&255,d[12]=s>>>24&255,d[13]=s>>>16&255,d[14]=s>>>8&255,d[15]=s&255,d}function stringToBytes(a){a=unescape(encodeURIComponent(a));for(var s=[],d=0;d<a.length;++d)s.push(a.charCodeAt(d));return s}var DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",URL$1="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function v35(a,s,d){function c(l,h,p,y){if(typeof l=="string"&&(l=stringToBytes(l)),typeof h=="string"&&(h=parse$1(h)),h.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var _=new Uint8Array(16+l.length);if(_.set(h),_.set(l,h.length),_=d(_),_[6]=_[6]&15|s,_[8]=_[8]&63|128,p){y=y||0;for(var E=0;E<16;++E)p[y+E]=_[E];return p}return stringify(_)}try{c.name=a}catch{}return c.DNS=DNS,c.URL=URL$1,c}function md5(a){if(typeof a=="string"){var s=unescape(encodeURIComponent(a));a=new Uint8Array(s.length);for(var d=0;d<s.length;++d)a[d]=s.charCodeAt(d)}return md5ToHexEncodedArray(wordsToMd5(bytesToWords(a),a.length*8))}function md5ToHexEncodedArray(a){for(var s=[],d=a.length*32,c="0123456789abcdef",l=0;l<d;l+=8){var h=a[l>>5]>>>l%32&255,p=parseInt(c.charAt(h>>>4&15)+c.charAt(h&15),16);s.push(p)}return s}function getOutputLength(a){return(a+64>>>9<<4)+14+1}function wordsToMd5(a,s){a[s>>5]|=128<<s%32,a[getOutputLength(s)-1]=s;for(var d=1732584193,c=-271733879,l=-1732584194,h=271733878,p=0;p<a.length;p+=16){var y=d,_=c,E=l,O=h;d=md5ff(d,c,l,h,a[p],7,-680876936),h=md5ff(h,d,c,l,a[p+1],12,-389564586),l=md5ff(l,h,d,c,a[p+2],17,606105819),c=md5ff(c,l,h,d,a[p+3],22,-1044525330),d=md5ff(d,c,l,h,a[p+4],7,-176418897),h=md5ff(h,d,c,l,a[p+5],12,1200080426),l=md5ff(l,h,d,c,a[p+6],17,-1473231341),c=md5ff(c,l,h,d,a[p+7],22,-45705983),d=md5ff(d,c,l,h,a[p+8],7,1770035416),h=md5ff(h,d,c,l,a[p+9],12,-1958414417),l=md5ff(l,h,d,c,a[p+10],17,-42063),c=md5ff(c,l,h,d,a[p+11],22,-1990404162),d=md5ff(d,c,l,h,a[p+12],7,1804603682),h=md5ff(h,d,c,l,a[p+13],12,-40341101),l=md5ff(l,h,d,c,a[p+14],17,-1502002290),c=md5ff(c,l,h,d,a[p+15],22,1236535329),d=md5gg(d,c,l,h,a[p+1],5,-165796510),h=md5gg(h,d,c,l,a[p+6],9,-1069501632),l=md5gg(l,h,d,c,a[p+11],14,643717713),c=md5gg(c,l,h,d,a[p],20,-373897302),d=md5gg(d,c,l,h,a[p+5],5,-701558691),h=md5gg(h,d,c,l,a[p+10],9,38016083),l=md5gg(l,h,d,c,a[p+15],14,-660478335),c=md5gg(c,l,h,d,a[p+4],20,-405537848),d=md5gg(d,c,l,h,a[p+9],5,568446438),h=md5gg(h,d,c,l,a[p+14],9,-1019803690),l=md5gg(l,h,d,c,a[p+3],14,-187363961),c=md5gg(c,l,h,d,a[p+8],20,1163531501),d=md5gg(d,c,l,h,a[p+13],5,-1444681467),h=md5gg(h,d,c,l,a[p+2],9,-51403784),l=md5gg(l,h,d,c,a[p+7],14,1735328473),c=md5gg(c,l,h,d,a[p+12],20,-1926607734),d=md5hh(d,c,l,h,a[p+5],4,-378558),h=md5hh(h,d,c,l,a[p+8],11,-2022574463),l=md5hh(l,h,d,c,a[p+11],16,1839030562),c=md5hh(c,l,h,d,a[p+14],23,-35309556),d=md5hh(d,c,l,h,a[p+1],4,-1530992060),h=md5hh(h,d,c,l,a[p+4],11,1272893353),l=md5hh(l,h,d,c,a[p+7],16,-155497632),c=md5hh(c,l,h,d,a[p+10],23,-1094730640),d=md5hh(d,c,l,h,a[p+13],4,681279174),h=md5hh(h,d,c,l,a[p],11,-358537222),l=md5hh(l,h,d,c,a[p+3],16,-722521979),c=md5hh(c,l,h,d,a[p+6],23,76029189),d=md5hh(d,c,l,h,a[p+9],4,-640364487),h=md5hh(h,d,c,l,a[p+12],11,-421815835),l=md5hh(l,h,d,c,a[p+15],16,530742520),c=md5hh(c,l,h,d,a[p+2],23,-995338651),d=md5ii(d,c,l,h,a[p],6,-198630844),h=md5ii(h,d,c,l,a[p+7],10,1126891415),l=md5ii(l,h,d,c,a[p+14],15,-1416354905),c=md5ii(c,l,h,d,a[p+5],21,-57434055),d=md5ii(d,c,l,h,a[p+12],6,1700485571),h=md5ii(h,d,c,l,a[p+3],10,-1894986606),l=md5ii(l,h,d,c,a[p+10],15,-1051523),c=md5ii(c,l,h,d,a[p+1],21,-2054922799),d=md5ii(d,c,l,h,a[p+8],6,1873313359),h=md5ii(h,d,c,l,a[p+15],10,-30611744),l=md5ii(l,h,d,c,a[p+6],15,-1560198380),c=md5ii(c,l,h,d,a[p+13],21,1309151649),d=md5ii(d,c,l,h,a[p+4],6,-145523070),h=md5ii(h,d,c,l,a[p+11],10,-1120210379),l=md5ii(l,h,d,c,a[p+2],15,718787259),c=md5ii(c,l,h,d,a[p+9],21,-343485551),d=safeAdd(d,y),c=safeAdd(c,_),l=safeAdd(l,E),h=safeAdd(h,O)}return[d,c,l,h]}function bytesToWords(a){if(a.length===0)return[];for(var s=a.length*8,d=new Uint32Array(getOutputLength(s)),c=0;c<s;c+=8)d[c>>5]|=(a[c/8]&255)<<c%32;return d}function safeAdd(a,s){var d=(a&65535)+(s&65535),c=(a>>16)+(s>>16)+(d>>16);return c<<16|d&65535}function bitRotateLeft(a,s){return a<<s|a>>>32-s}function md5cmn(a,s,d,c,l,h){return safeAdd(bitRotateLeft(safeAdd(safeAdd(s,a),safeAdd(c,h)),l),d)}function md5ff(a,s,d,c,l,h,p){return md5cmn(s&d|~s&c,a,s,l,h,p)}function md5gg(a,s,d,c,l,h,p){return md5cmn(s&c|d&~c,a,s,l,h,p)}function md5hh(a,s,d,c,l,h,p){return md5cmn(s^d^c,a,s,l,h,p)}function md5ii(a,s,d,c,l,h,p){return md5cmn(d^(s|~c),a,s,l,h,p)}var v3=v35("v3",48,md5),v3$1=v3;function v4(a,s,d){a=a||{};var c=a.random||(a.rng||rng)();if(c[6]=c[6]&15|64,c[8]=c[8]&63|128,s){d=d||0;for(var l=0;l<16;++l)s[d+l]=c[l];return s}return stringify(c)}function f(a,s,d,c){switch(a){case 0:return s&d^~s&c;case 1:return s^d^c;case 2:return s&d^s&c^d&c;case 3:return s^d^c}}function ROTL(a,s){return a<<s|a>>>32-s}function sha1(a){var s=[1518500249,1859775393,2400959708,3395469782],d=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof a=="string"){var c=unescape(encodeURIComponent(a));a=[];for(var l=0;l<c.length;++l)a.push(c.charCodeAt(l))}else Array.isArray(a)||(a=Array.prototype.slice.call(a));a.push(128);for(var h=a.length/4+2,p=Math.ceil(h/16),y=new Array(p),_=0;_<p;++_){for(var E=new Uint32Array(16),O=0;O<16;++O)E[O]=a[_*64+O*4]<<24|a[_*64+O*4+1]<<16|a[_*64+O*4+2]<<8|a[_*64+O*4+3];y[_]=E}y[p-1][14]=(a.length-1)*8/Math.pow(2,32),y[p-1][14]=Math.floor(y[p-1][14]),y[p-1][15]=(a.length-1)*8&4294967295;for(var P=0;P<p;++P){for(var C=new Uint32Array(80),A=0;A<16;++A)C[A]=y[P][A];for(var q=16;q<80;++q)C[q]=ROTL(C[q-3]^C[q-8]^C[q-14]^C[q-16],1);for(var U=d[0],F=d[1],j=d[2],T=d[3],D=d[4],J=0;J<80;++J){var ee=Math.floor(J/20),z=ROTL(U,5)+f(ee,F,j,T)+D+s[ee]+C[J]>>>0;D=T,T=j,j=ROTL(F,30)>>>0,F=U,U=z}d[0]=d[0]+U>>>0,d[1]=d[1]+F>>>0,d[2]=d[2]+j>>>0,d[3]=d[3]+T>>>0,d[4]=d[4]+D>>>0}return[d[0]>>24&255,d[0]>>16&255,d[0]>>8&255,d[0]&255,d[1]>>24&255,d[1]>>16&255,d[1]>>8&255,d[1]&255,d[2]>>24&255,d[2]>>16&255,d[2]>>8&255,d[2]&255,d[3]>>24&255,d[3]>>16&255,d[3]>>8&255,d[3]&255,d[4]>>24&255,d[4]>>16&255,d[4]>>8&255,d[4]&255]}var v5=v35("v5",80,sha1),v5$1=v5,nil="00000000-0000-0000-0000-000000000000";function version$3(a){if(!validate$1(a))throw TypeError("Invalid UUID");return parseInt(a.substr(14,1),16)}var esmBrowser=Object.freeze(Object.defineProperty({__proto__:null,v1,v3:v3$1,v4,v5:v5$1,NIL:nil,version:version$3,validate:validate$1,stringify,parse:parse$1},Symbol.toStringTag,{value:"Module"})),require$$1$2=getAugmentedNamespace(esmBrowser);class EnhancedMap$1 extends Map{computeIfAbsent(s,d){if(this.has(s))return this.get(s);const c=d(s);return this.set(s,c),c}computeIfPresent(s,d){const c=this.get(s);if(c===void 0)return;const l=d(s,c);return l!==void 0?this.set(s,l):this.delete(s),l}compute(s,d){const c=this.get(s),l=d(s,c);return l?this.set(s,l):this.delete(s),l}}var InternalLogLevel$1;(function(a){a[a.Trace=0]="Trace",a[a.Debug=1]="Debug",a[a.Info=2]="Info",a[a.Warn=3]="Warn",a[a.Error=4]="Error"})(InternalLogLevel$1||(InternalLogLevel$1={}));function getInternalLogger$1(a){return provider$1.getLogger(a)}const INTERNAL_LOGGING_SETTINGS$1={setInternalLogLevel:a=>provider$1.changeLogLevel(a),setOutput:a=>provider$1.changeOutput(a),reset:()=>provider$1.reset()};class InternalLoggerImpl$1{constructor(s,d,c){this._name=s,this._level=d,this._fnOutput=c}trace(s){this.log(InternalLogLevel$1.Trace,s)}debug(s){this.log(InternalLogLevel$1.Debug,s)}error(s,d){this.log(InternalLogLevel$1.Error,s,d)}info(s){this.log(InternalLogLevel$1.Info,s)}warn(s,d){this.log(InternalLogLevel$1.Warn,s,d)}setLevel(s){this._level=s}setOutput(s){this._fnOutput=s}log(s,d,c){this._level>s||this._fnOutput(`${InternalLogLevel$1[this._level].toString()} <INTERNAL LOGGER> ${this._name} ${d()}${c?`
`+c.stack:""}`)}}class InternalProviderImpl$1{constructor(){this._loggers=new EnhancedMap$1,this._logLevel=InternalLogLevel$1.Error,this._fnOutput=InternalProviderImpl$1.logConsole}getLogger(s){return this._loggers.computeIfAbsent(s,d=>new InternalLoggerImpl$1(d,this._logLevel,this._fnOutput))}changeLogLevel(s){this._logLevel=s,this._loggers.forEach(d=>d.setLevel(s))}changeOutput(s){this._fnOutput=s,this._loggers.forEach(d=>d.setOutput(this._fnOutput))}reset(){this.changeLogLevel(InternalLogLevel$1.Error),this._fnOutput=InternalProviderImpl$1.logConsole,this._loggers.forEach(s=>s.setOutput(this._fnOutput))}static logConsole(s){console&&console.log&&console.log(s)}}const provider$1=new InternalProviderImpl$1;var InternalLogger$1=Object.freeze({__proto__:null,get InternalLogLevel(){return InternalLogLevel$1},getInternalLogger:getInternalLogger$1,INTERNAL_LOGGING_SETTINGS:INTERNAL_LOGGING_SETTINGS$1}),LogLevel$1;(function(a){a[a.Trace=0]="Trace",a[a.Debug=1]="Debug",a[a.Info=2]="Info",a[a.Warn=3]="Warn",a[a.Error=4]="Error",a[a.Fatal=5]="Fatal"})(LogLevel$1||(LogLevel$1={})),function(a){function s(d){switch(d.toLowerCase()){case"trace":return a.Trace;case"debug":return a.Debug;case"info":return a.Info;case"warn":return a.Warn;case"error":return a.Error;case"fatal":return a.Fatal;default:return}}a.toLogLevel=s}(LogLevel$1||(LogLevel$1={}));class CoreLoggerImpl$1{constructor(s){this._runtime=s}get id(){return this._runtime.id}get logLevel(){return this._runtime.level}get runtimeSettings(){return Object.assign({},this._runtime)}set runtimeSettings(s){this._runtime=s}trace(s,...d){this.logMessage(LogLevel$1.Trace,s,d)}debug(s,...d){this.logMessage(LogLevel$1.Debug,s,d)}info(s,...d){this.logMessage(LogLevel$1.Info,s,d)}warn(s,...d){this.logMessage(LogLevel$1.Warn,s,d)}error(s,...d){this.logMessage(LogLevel$1.Error,s,d)}fatal(s,...d){this.logMessage(LogLevel$1.Fatal,s,d)}logMessage(s,d,c){if(this._runtime.level>s)return;const l=Date.now(),h=typeof d=="string"?d:d(),p=CoreLoggerImpl$1.getErrorAndArgs(c);switch(this._runtime.channel.type){case"RawLogChannel":this._runtime.channel.write({message:h,exception:p.error,args:p.args,timeInMillis:l,level:s,logNames:this._runtime.name},this._runtime.argumentFormatter);return;case"LogChannel":this._runtime.channel.write(this.createLogMessage(h,s,p,l));break}}formatArgValue(s){try{return this._runtime.argumentFormatter(s)}catch{return`>>ARG CONVERT FAILED: '${s!==void 0?s.toString():"undefined"}'<<`}}createLogMessage(s,d,c,l){let h;const p=c.error,y=c.args;p&&(h=`${p.name}: ${p.message}`,p.stack&&(h+=`@
${p.stack}`));const _=this._runtime.dateFormatter(l);let E=LogLevel$1[d].toUpperCase();E.length<5&&(E+=" ");const O=typeof this._runtime.name=="string"?this._runtime.name:this._runtime.name.join(", "),P=typeof y!="undefined"&&y.length>0?" ["+y.map(A=>this.formatArgValue(A)).join(", ")+"]":"";return{message:_+" "+E+" ["+O+"] "+s+P,error:h}}static getErrorAndArgs(s){if(s.length===0)return{};let d,c;const l=s[0];if(l instanceof Error)return d=l,c=s.length>1?s.slice(1):void 0,{error:d,args:c};if(typeof l=="function"){const h=l();return h instanceof Error?(d=h,c=s.length>1?s.slice(1):void 0,{error:d,args:c}):s.length===1?Array.isArray(h)?{args:h.length>0?h:void 0}:{args:h}:Array.isArray(h)?{args:[...h,...s.slice(1)]}:{args:[h,...s.slice(1)]}}return{args:s}}}function padStart$1(a,s,d=" "){return padInternal$1(a,s,"start",d)}function padEnd$1(a,s,d=" "){return padInternal$1(a,s,"end",d)}function maxLengthStringValueInArray$1(a){return a.map(s=>s.length).reduce((s,d)=>d>s?d:s,0)}function padInternal$1(a,s,d,c=" "){if(s<=a.length)return a;if(c.length>1)throw new Error(`Fill char must be one char exactly, it is: ${c.length}`);const l=s-a.length;let h="";for(let p=0;p<l;p++)h+=c;return d==="start"?h+a:a+h}function formatArgument$1(a){return a===void 0?"undefined":JSON.stringify(a)}function formatDate$1(a){const s=new Date(a),d=s.getFullYear(),c=padStart$1((s.getMonth()+1).toString(),2,"0"),l=padStart$1(s.getDate().toString(),2,"0"),h=padStart$1(s.getHours().toString(),2,"0"),p=padStart$1(s.getMinutes().toString(),2,"0"),y=padStart$1(s.getSeconds().toString(),2,"0"),_=padStart$1(s.getMilliseconds().toString(),2,"0");return`${d}-${c}-${l} ${h}:${p}:${y},${_}`}class ConsoleLogChannel$1{constructor(){this.type="LogChannel"}write(s){console&&console.log&&console.log(s.message+(s.error?`
${s.error}`:""))}}var DefaultChannels$1;(function(a){function s(){return new ConsoleLogChannel$1}a.createConsoleChannel=s})(DefaultChannels$1||(DefaultChannels$1={}));class LogProviderImpl$1{constructor(s,d){this._log=getInternalLogger$1("core.impl.LogProviderImpl"),this._name=s,this._settings=d,this._loggers=new EnhancedMap$1,this._idToKeyMap=new EnhancedMap$1,this._globalRuntimeSettings={level:d.level,channel:d.channel},this._nextLoggerId=1,this._log.trace(()=>`Created LogProviderImpl with settings: ${JSON.stringify(this._settings)}`)}get runtimeSettings(){return Object.assign(Object.assign({},this._settings),{level:this._globalRuntimeSettings.level,channel:this._globalRuntimeSettings.channel})}getLogger(s){return this.getOrCreateLogger(s)}updateLoggerRuntime(s,d){this._log.debug(()=>`Updating logger ${s.id} runtime settings using: '${JSON.stringify(d)}'`);const c=this._idToKeyMap.get(s.id);return c===void 0?(this._log.warn(()=>`Cannot update logger with id: ${s.id}, it was not found.`),!1):(this._loggers.computeIfPresent(c,(l,h)=>(h.runtimeSettings=LogProviderImpl$1.mergeRuntimeSettingsIntoLogRuntime(h.runtimeSettings,d),h)),!0)}updateRuntimeSettings(s){this._log.debug(()=>`Updating global runtime settings and updating existing loggers runtime settings using: '${JSON.stringify(s)}'`),this._globalRuntimeSettings={level:s.level!==void 0?s.level:this._globalRuntimeSettings.level,channel:s.channel!==void 0?s.channel:this._globalRuntimeSettings.channel},this._loggers.forEach(d=>d.runtimeSettings=LogProviderImpl$1.mergeRuntimeSettingsIntoLogRuntime(d.runtimeSettings,s))}clear(){this._loggers.clear(),this._idToKeyMap.clear(),this._globalRuntimeSettings=Object.assign({},this._settings),this._nextLoggerId=1}getOrCreateLogger(s){const d=LogProviderImpl$1.createKey(s),c=this._loggers.computeIfAbsent(d,()=>{const l={level:this._globalRuntimeSettings.level,channel:this._globalRuntimeSettings.channel,id:this.nextLoggerId(),name:s,argumentFormatter:this._settings.argumentFormatter,dateFormatter:this._settings.dateFormatter};return new CoreLoggerImpl$1(l)});return this._idToKeyMap.computeIfAbsent(c.id,()=>d),c}nextLoggerId(){const s=this._name+"_"+this._nextLoggerId;return this._nextLoggerId++,s}static mergeRuntimeSettingsIntoLogRuntime(s,d){return Object.assign(Object.assign({},s),{level:d.level!==void 0?d.level:s.level,channel:d.channel!==void 0?d.channel:s.channel})}static createKey(s){return typeof s=="string"?s:s.join(",")}}function createLogProvider$1(a,s){return new LogProviderImpl$1(a,s)}var index$4=Object.freeze({__proto__:null,EnhancedMap:EnhancedMap$1,padStart:padStart$1,padEnd:padEnd$1,maxLengthStringValueInArray:maxLengthStringValueInArray$1});class ArrayLogChannel{constructor(){this._buffer=[],this.type="LogChannel"}write(s){this._buffer.push(s)}get logMessages(){return this._buffer}get messages(){return this._buffer.map(s=>s.message)}}class ArrayRawLogChannel{constructor(){this._buffer=[],this.type="RawLogChannel"}write(s,d){this._buffer.push(s)}get messages(){return this._buffer.map(s=>s.message)}get errors(){return this._buffer.map(s=>s.exception)}get size(){return this._buffer.length}get rawMessages(){return this._buffer}clear(){this._buffer=[]}}class TestControlMessage{constructor(){this._messages=[],this.write=this.write.bind(this)}get messages(){return this._messages}write(s){this._messages.push(s)}clear(){this._messages=[]}}var TestClasses=Object.freeze({__proto__:null,ArrayLogChannel,ArrayRawLogChannel,TestControlMessage}),typescriptLogging_esm=Object.freeze(Object.defineProperty({__proto__:null,$internal:InternalLogger$1,$test:TestClasses,get DefaultChannels(){return DefaultChannels$1},get LogLevel(){return LogLevel$1},createLogProvider:createLogProvider$1,formatArgument:formatArgument$1,formatDate:formatDate$1,util:index$4},Symbol.toStringTag,{value:"Module"})),require$$2$1=getAugmentedNamespace(typescriptLogging_esm),layoutapi={},lib$1={},lib={},Metadata={};Object.defineProperty(Metadata,"__esModule",{value:!0}),Metadata.Metadata=void 0,Metadata.Metadata=function(s){const d=new Map,c={set(l,h){if(l=normalizeKey(l),Array.isArray(h))if(h.length===0)d.delete(l);else{for(const p of h)validate(l,p);d.set(l,l.endsWith("-bin")?h:[h.join(", ")])}else validate(l,h),d.set(l,[h]);return c},append(l,h){l=normalizeKey(l),validate(l,h);let p=d.get(l);return p==null&&(p=[],d.set(l,p)),p.push(h),l.endsWith("-bin")||d.set(l,[p.join(", ")]),c},delete(l){l=normalizeKey(l),d.delete(l)},get(l){var h;return l=normalizeKey(l),(h=d.get(l))===null||h===void 0?void 0:h[0]},getAll(l){var h;return l=normalizeKey(l),(h=d.get(l))!==null&&h!==void 0?h:[]},has(l){return l=normalizeKey(l),d.has(l)},[Symbol.iterator](){return d[Symbol.iterator]()}};if(s!=null){const l=isIterable$1(s)?s:Object.entries(s);for(const[h,p]of l)c.set(h,p)}return c};function normalizeKey(a){return a.toLowerCase()}function validate(a,s){if(!/^[0-9a-z_.-]+$/.test(a))throw new Error(`Metadata key '${a}' contains illegal characters`);if(a.endsWith("-bin")){if(!(s instanceof Uint8Array))throw new Error(`Metadata key '${a}' ends with '-bin', thus it must have binary value`)}else{if(typeof s!="string")throw new Error(`Metadata key '${a}' doesn't end with '-bin', thus it must have string value`);if(!/^[ -~]*$/.test(s))throw new Error(`Metadata value '${s}' of key '${a}' contains illegal characters`)}}function isIterable$1(a){return Symbol.iterator in a}var Status={};(function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.Status=void 0,function(s){s[s.OK=0]="OK",s[s.CANCELLED=1]="CANCELLED",s[s.UNKNOWN=2]="UNKNOWN",s[s.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",s[s.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",s[s.NOT_FOUND=5]="NOT_FOUND",s[s.ALREADY_EXISTS=6]="ALREADY_EXISTS",s[s.PERMISSION_DENIED=7]="PERMISSION_DENIED",s[s.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",s[s.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",s[s.ABORTED=10]="ABORTED",s[s.OUT_OF_RANGE=11]="OUT_OF_RANGE",s[s.UNIMPLEMENTED=12]="UNIMPLEMENTED",s[s.INTERNAL=13]="INTERNAL",s[s.UNAVAILABLE=14]="UNAVAILABLE",s[s.DATA_LOSS=15]="DATA_LOSS",s[s.UNAUTHENTICATED=16]="UNAUTHENTICATED"}(a.Status||(a.Status={}))})(Status);var MethodDescriptor={};Object.defineProperty(MethodDescriptor,"__esModule",{value:!0});var CallOptions={};Object.defineProperty(CallOptions,"__esModule",{value:!0});var ClientMiddleware={};Object.defineProperty(ClientMiddleware,"__esModule",{value:!0});var composeClientMiddleware$1={};Object.defineProperty(composeClientMiddleware$1,"__esModule",{value:!0}),composeClientMiddleware$1.composeClientMiddleware=void 0;function composeClientMiddleware(a,s){return(d,c)=>s({...d,next:(l,h)=>a({...d,request:l},h)},c)}composeClientMiddleware$1.composeClientMiddleware=composeClientMiddleware;var ClientError$1={},cjs={},helpers={};helpers.__esModule=void 0,helpers.__esModule=!0;var objectSetPrototypeOfIsDefined=typeof Object.setPrototypeOf=="function",objectGetPrototypeOfIsDefined=typeof Object.getPrototypeOf=="function",objectDefinePropertyIsDefined=typeof Object.defineProperty=="function",objectCreateIsDefined=typeof Object.create=="function",objectHasOwnPropertyIsDefined=typeof Object.prototype.hasOwnProperty=="function",setPrototypeOf=function(s,d){objectSetPrototypeOfIsDefined?Object.setPrototypeOf(s,d):s.__proto__=d};helpers.setPrototypeOf=setPrototypeOf;var getPrototypeOf=function(s){return objectGetPrototypeOfIsDefined?Object.getPrototypeOf(s):s.__proto__||s.prototype};helpers.getPrototypeOf=getPrototypeOf;var ie8ObjectDefinePropertyBug=!1,defineProperty=function a(s,d,c){if(objectDefinePropertyIsDefined&&!ie8ObjectDefinePropertyBug)try{Object.defineProperty(s,d,c)}catch{ie8ObjectDefinePropertyBug=!0,a(s,d,c)}else s[d]=c.value};helpers.defineProperty=defineProperty;var hasOwnProperty=function(s,d){return objectHasOwnPropertyIsDefined?s.hasOwnProperty(s,d):s[d]===void 0};helpers.hasOwnProperty=hasOwnProperty;var objectCreate=function(s,d){if(objectCreateIsDefined)return Object.create(s,d);var c=function(){};c.prototype=s;var l=new c;if(typeof d=="undefined")return l;if(typeof d=="null")throw new Error("PropertyDescriptors must not be null.");if(typeof d=="object")for(var h in d)hasOwnProperty(d,h)&&(l[h]=d[h].value);return l};helpers.objectCreate=objectCreate,function(a){a.__esModule=void 0,a.__esModule=!0;var s=helpers,d=s.setPrototypeOf,c=s.getPrototypeOf,l=s.defineProperty,h=s.objectCreate,p=new Error().toString()==="[object Error]",y="";function _(E){var O=this.constructor,P=O.name||function(){var F=O.toString().match(/^function\s*([^\s(]+)/);return F===null?y||"Error":F[1]}(),C=P==="Error",A=C?y:P,q=Error.apply(this,arguments);if(d(q,c(this)),!(q instanceof O)||!(q instanceof _)){var q=this;Error.apply(this,arguments),l(q,"message",{configurable:!0,enumerable:!1,value:E,writable:!0})}if(l(q,"name",{configurable:!0,enumerable:!1,value:A,writable:!0}),Error.captureStackTrace&&Error.captureStackTrace(q,C?_:O),q.stack===void 0){var U=new Error(E);U.name=q.name,q.stack=U.stack}return p&&l(q,"toString",{configurable:!0,enumerable:!1,value:function(){return(this.name||"Error")+(typeof this.message=="undefined"?"":": "+this.message)},writable:!0}),q}y=_.name||"ExtendableError",_.prototype=h(Error.prototype,{constructor:{value:Error,enumerable:!1,writable:!0,configurable:!0}}),a.ExtendableError=_,a.default=a.ExtendableError}(cjs),Object.defineProperty(ClientError$1,"__esModule",{value:!0}),ClientError$1.ClientError=void 0;const ts_error_1$1=cjs,Status_1$1=Status;class ClientError extends ts_error_1$1.ExtendableError{constructor(s,d,c){super(`${s} ${Status_1$1.Status[d]}: ${c}`),this.path=s,this.code=d,this.details=c,this.name="ClientError",Object.defineProperty(this,"@@nice-grpc",{value:!0}),Object.defineProperty(this,"@@nice-grpc:ClientError",{value:!0})}static[Symbol.hasInstance](s){return this!==ClientError?this.prototype.isPrototypeOf(s):typeof s=="object"&&s!==null&&(s.constructor===ClientError||s["@@nice-grpc:ClientError"]===!0||s.name==="ClientError"&&s["@@nice-grpc"]===!0)}}ClientError$1.ClientError=ClientError;var CallContext={};Object.defineProperty(CallContext,"__esModule",{value:!0});var ServerMiddleware={};Object.defineProperty(ServerMiddleware,"__esModule",{value:!0});var composeServerMiddleware$1={};Object.defineProperty(composeServerMiddleware$1,"__esModule",{value:!0}),composeServerMiddleware$1.composeServerMiddleware=void 0;function composeServerMiddleware(a,s){return(d,c)=>a({...d,next:(l,h)=>s({...d,request:l},h)},c)}composeServerMiddleware$1.composeServerMiddleware=composeServerMiddleware;var ServerError$1={};Object.defineProperty(ServerError$1,"__esModule",{value:!0}),ServerError$1.ServerError=void 0;const ts_error_1=cjs,Status_1=Status;class ServerError extends ts_error_1.ExtendableError{constructor(s,d){super(`${Status_1.Status[s]}: ${d}`),this.code=s,this.details=d,this.name="ServerError",Object.defineProperty(this,"@@nice-grpc",{value:!0}),Object.defineProperty(this,"@@nice-grpc:ServerError",{value:!0})}static[Symbol.hasInstance](s){return this!==ServerError?this.prototype.isPrototypeOf(s):typeof s=="object"&&s!==null&&(s.constructor===ServerError||s["@@nice-grpc:ServerError"]===!0||s.name==="ServerError"&&s["@@nice-grpc"]===!0)}}ServerError$1.ServerError=ServerError,function(a){var s=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(c,l,h,p){p===void 0&&(p=h);var y=Object.getOwnPropertyDescriptor(l,h);(!y||("get"in y?!l.__esModule:y.writable||y.configurable))&&(y={enumerable:!0,get:function(){return l[h]}}),Object.defineProperty(c,p,y)}:function(c,l,h,p){p===void 0&&(p=h),c[p]=l[h]}),d=commonjsGlobal&&commonjsGlobal.__exportStar||function(c,l){for(var h in c)h!=="default"&&!Object.prototype.hasOwnProperty.call(l,h)&&s(l,c,h)};Object.defineProperty(a,"__esModule",{value:!0}),d(Metadata,a),d(Status,a),d(MethodDescriptor,a),d(CallOptions,a),d(ClientMiddleware,a),d(composeClientMiddleware$1,a),d(ClientError$1,a),d(CallContext,a),d(ServerMiddleware,a),d(composeServerMiddleware$1,a),d(ServerError$1,a)}(lib);var serviceDefinitions={},grpcWeb={};Object.defineProperty(grpcWeb,"__esModule",{value:!0}),grpcWeb.isGrpcWebServiceDefinition=grpcWeb.fromGrpcWebServiceDefinition=void 0;function fromGrpcWebServiceDefinition(a){const s={};for(const[d,c]of Object.entries(a)){if(d==="serviceName")continue;const l=c;s[uncapitalize(d)]={path:`/${a.serviceName}/${d}`,requestStream:l.requestStream,responseStream:l.responseStream,requestDeserialize:l.requestType.deserializeBinary,requestSerialize:h=>h.serializeBinary(),responseDeserialize:l.responseType.deserializeBinary,responseSerialize:h=>h.serializeBinary(),options:{}}}return s}grpcWeb.fromGrpcWebServiceDefinition=fromGrpcWebServiceDefinition;function isGrpcWebServiceDefinition(a){return"prototype"in a}grpcWeb.isGrpcWebServiceDefinition=isGrpcWebServiceDefinition;function uncapitalize(a){return a.length===0?a:a[0].toLowerCase()+a.slice(1)}var tsProto={};Object.defineProperty(tsProto,"__esModule",{value:!0}),tsProto.isTsProtoServiceDefinition=tsProto.fromTsProtoServiceDefinition=void 0;function fromTsProtoServiceDefinition(a){const s={};for(const[d,c]of Object.entries(a.methods)){const l=c.requestType.encode,h=c.requestType.fromPartial,p=c.responseType.encode,y=c.responseType.fromPartial;s[d]={path:`/${a.fullName}/${c.name}`,requestStream:c.requestStream,responseStream:c.responseStream,requestDeserialize:c.requestType.decode,requestSerialize:h!=null?_=>l(h(_)).finish():_=>l(_).finish(),responseDeserialize:c.responseType.decode,responseSerialize:y!=null?_=>p(y(_)).finish():_=>p(_).finish(),options:c.options}}return s}tsProto.fromTsProtoServiceDefinition=fromTsProtoServiceDefinition;function isTsProtoServiceDefinition(a){return"name"in a&&"fullName"in a&&"methods"in a}tsProto.isTsProtoServiceDefinition=isTsProtoServiceDefinition,Object.defineProperty(serviceDefinitions,"__esModule",{value:!0}),serviceDefinitions.toGrpcWebMethodDefinition=serviceDefinitions.normalizeServiceDefinition=void 0;const grpc_web_1$5=grpcWeb,ts_proto_1=tsProto;function normalizeServiceDefinition(a){return(0,grpc_web_1$5.isGrpcWebServiceDefinition)(a)?(0,grpc_web_1$5.fromGrpcWebServiceDefinition)(a):(0,ts_proto_1.isTsProtoServiceDefinition)(a)?(0,ts_proto_1.fromTsProtoServiceDefinition)(a):a}serviceDefinitions.normalizeServiceDefinition=normalizeServiceDefinition;function toGrpcWebMethodDefinition(a){const[,s,d]=a.path.split("/");return{service:{serviceName:s},methodName:d,requestStream:a.requestStream,responseStream:a.responseStream,requestType:class{constructor(){throw new Error("Unexpected instantiation")}static deserializeBinary(c){return a.requestDeserialize(c)}},responseType:class{constructor(){throw new Error("Unexpected instantiation")}static deserializeBinary(c){return a.responseDeserialize(c)}}}}serviceDefinitions.toGrpcWebMethodDefinition=toGrpcWebMethodDefinition;var channel={};Object.defineProperty(channel,"__esModule",{value:!0}),channel.createChannel=void 0;function createChannel(a,s){return{address:a,transport:s}}channel.createChannel=createChannel;var ClientFactory={},createBidiStreamingMethod$1={},grpcWebClient_umd={exports:{}};(function(a,s){(function(d,c){a.exports=c()})(commonjsGlobal,function(){return d={418:function(l,h){(function(p,y){for(var _ in y)p[_]=y[_]})(h,function(p){var y={};function _(E){if(y[E])return y[E].exports;var O=y[E]={i:E,l:!1,exports:{}};return p[E].call(O.exports,O,O.exports,_),O.l=!0,O.exports}return _.m=p,_.c=y,_.i=function(E){return E},_.d=function(E,O,P){_.o(E,O)||Object.defineProperty(E,O,{configurable:!1,enumerable:!0,get:P})},_.n=function(E){var O=E&&E.__esModule?function(){return E.default}:function(){return E};return _.d(O,"a",O),O},_.o=function(E,O){return Object.prototype.hasOwnProperty.call(E,O)},_.p="",_(_.s=1)}([function(p,y,_){Object.defineProperty(y,"__esModule",{value:!0});var E=_(3),O=function(){function P(C,A){C===void 0&&(C={}),A===void 0&&(A={splitValues:!1});var q,U=this;this.headersMap={},C&&(typeof Headers!="undefined"&&C instanceof Headers?E.getHeaderKeys(C).forEach(function(F){E.getHeaderValues(C,F).forEach(function(j){A.splitValues?U.append(F,E.splitHeaderValue(j)):U.append(F,j)})}):typeof(q=C)=="object"&&typeof q.headersMap=="object"&&typeof q.forEach=="function"?C.forEach(function(F,j){U.append(F,j)}):typeof Map!="undefined"&&C instanceof Map?C.forEach(function(F,j){U.append(j,F)}):typeof C=="string"?this.appendFromString(C):typeof C=="object"&&Object.getOwnPropertyNames(C).forEach(function(F){var j=C[F];Array.isArray(j)?j.forEach(function(T){U.append(F,T)}):U.append(F,j)}))}return P.prototype.appendFromString=function(C){for(var A=C.split(`\r
`),q=0;q<A.length;q++){var U=A[q],F=U.indexOf(":");if(F>0){var j=U.substring(0,F).trim(),T=U.substring(F+1).trim();this.append(j,T)}}},P.prototype.delete=function(C,A){var q=E.normalizeName(C);if(A===void 0)delete this.headersMap[q];else{var U=this.headersMap[q];if(U){var F=U.indexOf(A);F>=0&&U.splice(F,1),U.length===0&&delete this.headersMap[q]}}},P.prototype.append=function(C,A){var q=this,U=E.normalizeName(C);Array.isArray(this.headersMap[U])||(this.headersMap[U]=[]),Array.isArray(A)?A.forEach(function(F){q.headersMap[U].push(E.normalizeValue(F))}):this.headersMap[U].push(E.normalizeValue(A))},P.prototype.set=function(C,A){var q=E.normalizeName(C);if(Array.isArray(A)){var U=[];A.forEach(function(F){U.push(E.normalizeValue(F))}),this.headersMap[q]=U}else this.headersMap[q]=[E.normalizeValue(A)]},P.prototype.has=function(C,A){var q=this.headersMap[E.normalizeName(C)];if(!Array.isArray(q))return!1;if(A!==void 0){var U=E.normalizeValue(A);return q.indexOf(U)>=0}return!0},P.prototype.get=function(C){var A=this.headersMap[E.normalizeName(C)];return A!==void 0?A.concat():[]},P.prototype.forEach=function(C){var A=this;Object.getOwnPropertyNames(this.headersMap).forEach(function(q){C(q,A.headersMap[q])},this)},P.prototype.toHeaders=function(){if(typeof Headers!="undefined"){var C=new Headers;return this.forEach(function(A,q){q.forEach(function(U){C.append(A,U)})}),C}throw new Error("Headers class is not defined")},P}();y.BrowserHeaders=O},function(p,y,_){Object.defineProperty(y,"__esModule",{value:!0});var E=_(0);y.BrowserHeaders=E.BrowserHeaders},function(p,y,_){Object.defineProperty(y,"__esModule",{value:!0}),y.iterateHeaders=function(E,O){for(var P=E[Symbol.iterator](),C=P.next();!C.done;)O(C.value[0]),C=P.next()},y.iterateHeadersKeys=function(E,O){for(var P=E.keys(),C=P.next();!C.done;)O(C.value),C=P.next()}},function(p,y,_){Object.defineProperty(y,"__esModule",{value:!0});var E=_(2);y.normalizeName=function(O){if(typeof O!="string"&&(O=String(O)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(O))throw new TypeError("Invalid character in header field name");return O.toLowerCase()},y.normalizeValue=function(O){return typeof O!="string"&&(O=String(O)),O},y.getHeaderValues=function(O,P){var C=O;if(C instanceof Headers&&C.getAll)return C.getAll(P);var A=C.get(P);return A&&typeof A=="string"?[A]:A},y.getHeaderKeys=function(O){var P=O,C={},A=[];return P.keys?E.iterateHeadersKeys(P,function(q){C[q]||(C[q]=!0,A.push(q))}):P.forEach?P.forEach(function(q,U){C[U]||(C[U]=!0,A.push(U))}):E.iterateHeaders(P,function(q){var U=q[0];C[U]||(C[U]=!0,A.push(U))}),A},y.splitHeaderValue=function(O){var P=[];return O.split(", ").forEach(function(C){C.split(",").forEach(function(A){P.push(A)})}),P}}]))},617:function(l,h,p){Object.defineProperty(h,"__esModule",{value:!0}),h.ChunkParser=h.ChunkType=h.encodeASCII=h.decodeASCII=void 0;var y,_=p(65);function E(F){return(j=F)===9||j===10||j===13||F>=32&&F<=126;var j}function O(F){for(var j=0;j!==F.length;++j)if(!E(F[j]))throw new Error("Metadata is not valid (printable) ASCII");return String.fromCharCode.apply(String,Array.prototype.slice.call(F))}function P(F){return(128&F.getUint8(0))==128}function C(F){return F.getUint32(1,!1)}function A(F,j,T){return F.byteLength-j>=T}function q(F,j,T){if(F.slice)return F.slice(j,T);var D=F.length;T!==void 0&&(D=T);for(var J=new Uint8Array(D-j),ee=0,z=j;z<D;z++)J[ee++]=F[z];return J}h.decodeASCII=O,h.encodeASCII=function(F){for(var j=new Uint8Array(F.length),T=0;T!==F.length;++T){var D=F.charCodeAt(T);if(!E(D))throw new Error("Metadata contains invalid ASCII");j[T]=D}return j},function(F){F[F.MESSAGE=1]="MESSAGE",F[F.TRAILERS=2]="TRAILERS"}(y=h.ChunkType||(h.ChunkType={}));var U=function(){function F(){this.buffer=null,this.position=0}return F.prototype.parse=function(j,T){if(j.length===0&&T)return[];var D,J=[];if(this.buffer==null)this.buffer=j,this.position=0;else if(this.position===this.buffer.byteLength)this.buffer=j,this.position=0;else{var ee=this.buffer.byteLength-this.position,z=new Uint8Array(ee+j.byteLength),ne=q(this.buffer,this.position);z.set(ne,0);var X=new Uint8Array(j);z.set(X,ee),this.buffer=z,this.position=0}for(;;){if(!A(this.buffer,this.position,5))return J;var M=q(this.buffer,this.position,this.position+5),K=new DataView(M.buffer,M.byteOffset,M.byteLength),te=C(K);if(!A(this.buffer,this.position,5+te))return J;var L=q(this.buffer,this.position+5,this.position+5+te);if(this.position+=5+te,P(K))return J.push({chunkType:y.TRAILERS,trailers:(D=L,new _.Metadata(O(D)))}),J;J.push({chunkType:y.MESSAGE,data:L})}},F}();h.ChunkParser=U},8:function(l,h){var p;Object.defineProperty(h,"__esModule",{value:!0}),h.httpStatusToCode=h.Code=void 0,function(y){y[y.OK=0]="OK",y[y.Canceled=1]="Canceled",y[y.Unknown=2]="Unknown",y[y.InvalidArgument=3]="InvalidArgument",y[y.DeadlineExceeded=4]="DeadlineExceeded",y[y.NotFound=5]="NotFound",y[y.AlreadyExists=6]="AlreadyExists",y[y.PermissionDenied=7]="PermissionDenied",y[y.ResourceExhausted=8]="ResourceExhausted",y[y.FailedPrecondition=9]="FailedPrecondition",y[y.Aborted=10]="Aborted",y[y.OutOfRange=11]="OutOfRange",y[y.Unimplemented=12]="Unimplemented",y[y.Internal=13]="Internal",y[y.Unavailable=14]="Unavailable",y[y.DataLoss=15]="DataLoss",y[y.Unauthenticated=16]="Unauthenticated"}(p=h.Code||(h.Code={})),h.httpStatusToCode=function(y){switch(y){case 0:return p.Internal;case 200:return p.OK;case 400:return p.InvalidArgument;case 401:return p.Unauthenticated;case 403:return p.PermissionDenied;case 404:return p.NotFound;case 409:return p.Aborted;case 412:return p.FailedPrecondition;case 429:return p.ResourceExhausted;case 499:return p.Canceled;case 500:return p.Unknown;case 501:return p.Unimplemented;case 503:return p.Unavailable;case 504:return p.DeadlineExceeded;default:return p.Unknown}}},934:function(l,h,p){Object.defineProperty(h,"__esModule",{value:!0}),h.client=void 0;var y=p(65),_=p(617),E=p(8),O=p(346),P=p(57),C=p(882);h.client=function(U,F){return new A(U,F)};var A=function(){function U(F,j){this.started=!1,this.sentFirstMessage=!1,this.completed=!1,this.closed=!1,this.finishedSending=!1,this.onHeadersCallbacks=[],this.onMessageCallbacks=[],this.onEndCallbacks=[],this.parser=new _.ChunkParser,this.methodDefinition=F,this.props=j,this.createTransport()}return U.prototype.createTransport=function(){var F=this.props.host+"/"+this.methodDefinition.service.serviceName+"/"+this.methodDefinition.methodName,j={methodDefinition:this.methodDefinition,debug:this.props.debug||!1,url:F,onHeaders:this.onTransportHeaders.bind(this),onChunk:this.onTransportChunk.bind(this),onEnd:this.onTransportEnd.bind(this)};this.props.transport?this.transport=this.props.transport(j):this.transport=P.makeDefaultTransport(j)},U.prototype.onTransportHeaders=function(F,j){if(this.props.debug&&O.debug("onHeaders",F,j),this.closed)this.props.debug&&O.debug("grpc.onHeaders received after request was closed - ignoring");else if(j!==0){this.responseHeaders=F,this.props.debug&&O.debug("onHeaders.responseHeaders",JSON.stringify(this.responseHeaders,null,2));var T=q(F);this.props.debug&&O.debug("onHeaders.gRPCStatus",T);var D=T&&T>=0?T:E.httpStatusToCode(j);this.props.debug&&O.debug("onHeaders.code",D);var J=F.get("grpc-message")||[];if(this.props.debug&&O.debug("onHeaders.gRPCMessage",J),this.rawOnHeaders(F),D!==E.Code.OK){var ee=this.decodeGRPCStatus(J[0]);this.rawOnError(D,ee,F)}}},U.prototype.onTransportChunk=function(F){var j=this;if(this.closed)this.props.debug&&O.debug("grpc.onChunk received after request was closed - ignoring");else{var T=[];try{T=this.parser.parse(F)}catch(D){return this.props.debug&&O.debug("onChunk.parsing error",D,D.message),void this.rawOnError(E.Code.Internal,"parsing error: "+D.message)}T.forEach(function(D){if(D.chunkType===_.ChunkType.MESSAGE){var J=j.methodDefinition.responseType.deserializeBinary(D.data);j.rawOnMessage(J)}else D.chunkType===_.ChunkType.TRAILERS&&(j.responseHeaders?(j.responseTrailers=new y.Metadata(D.trailers),j.props.debug&&O.debug("onChunk.trailers",j.responseTrailers)):(j.responseHeaders=new y.Metadata(D.trailers),j.rawOnHeaders(j.responseHeaders)))})}},U.prototype.onTransportEnd=function(){if(this.props.debug&&O.debug("grpc.onEnd"),this.closed)this.props.debug&&O.debug("grpc.onEnd received after request was closed - ignoring");else if(this.responseTrailers!==void 0){var F=q(this.responseTrailers);if(F!==null){var j=this.responseTrailers.get("grpc-message"),T=this.decodeGRPCStatus(j[0]);this.rawOnEnd(F,T,this.responseTrailers)}else this.rawOnError(E.Code.Internal,"Response closed without grpc-status (Trailers provided)")}else{if(this.responseHeaders===void 0)return void this.rawOnError(E.Code.Unknown,"Response closed without headers");var D=q(this.responseHeaders),J=this.responseHeaders.get("grpc-message");if(this.props.debug&&O.debug("grpc.headers only response ",D,J),D===null)return void this.rawOnEnd(E.Code.Unknown,"Response closed without grpc-status (Headers only)",this.responseHeaders);var ee=this.decodeGRPCStatus(J[0]);this.rawOnEnd(D,ee,this.responseHeaders)}},U.prototype.decodeGRPCStatus=function(F){if(!F)return"";try{return decodeURIComponent(F)}catch{return F}},U.prototype.rawOnEnd=function(F,j,T){var D=this;this.props.debug&&O.debug("rawOnEnd",F,j,T),this.completed||(this.completed=!0,this.onEndCallbacks.forEach(function(J){if(!D.closed)try{J(F,j,T)}catch(ee){setTimeout(function(){throw ee},0)}}))},U.prototype.rawOnHeaders=function(F){this.props.debug&&O.debug("rawOnHeaders",F),this.completed||this.onHeadersCallbacks.forEach(function(j){try{j(F)}catch(T){setTimeout(function(){throw T},0)}})},U.prototype.rawOnError=function(F,j,T){var D=this;T===void 0&&(T=new y.Metadata),this.props.debug&&O.debug("rawOnError",F,j),this.completed||(this.completed=!0,this.onEndCallbacks.forEach(function(J){if(!D.closed)try{J(F,j,T)}catch(ee){setTimeout(function(){throw ee},0)}}))},U.prototype.rawOnMessage=function(F){var j=this;this.props.debug&&O.debug("rawOnMessage",F.toObject()),this.completed||this.closed||this.onMessageCallbacks.forEach(function(T){if(!j.closed)try{T(F)}catch(D){setTimeout(function(){throw D},0)}})},U.prototype.onHeaders=function(F){this.onHeadersCallbacks.push(F)},U.prototype.onMessage=function(F){this.onMessageCallbacks.push(F)},U.prototype.onEnd=function(F){this.onEndCallbacks.push(F)},U.prototype.start=function(F){if(this.started)throw new Error("Client already started - cannot .start()");this.started=!0;var j=new y.Metadata(F||{});j.set("content-type","application/grpc-web+proto"),j.set("x-grpc-web","1"),this.transport.start(j)},U.prototype.send=function(F){if(!this.started)throw new Error("Client not started - .start() must be called before .send()");if(this.closed)throw new Error("Client already closed - cannot .send()");if(this.finishedSending)throw new Error("Client already finished sending - cannot .send()");if(!this.methodDefinition.requestStream&&this.sentFirstMessage)throw new Error("Message already sent for non-client-streaming method - cannot .send()");this.sentFirstMessage=!0;var j=C.frameRequest(F);this.transport.sendMessage(j)},U.prototype.finishSend=function(){if(!this.started)throw new Error("Client not started - .finishSend() must be called before .close()");if(this.closed)throw new Error("Client already closed - cannot .send()");if(this.finishedSending)throw new Error("Client already finished sending - cannot .finishSend()");this.finishedSending=!0,this.transport.finishSend()},U.prototype.close=function(){if(!this.started)throw new Error("Client not started - .start() must be called before .close()");if(this.closed)throw new Error("Client already closed - cannot .close()");this.closed=!0,this.props.debug&&O.debug("request.abort aborting request"),this.transport.cancel()},U}();function q(U){var F=U.get("grpc-status")||[];if(F.length>0)try{var j=F[0];return parseInt(j,10)}catch{return null}return null}},346:function(l,h){Object.defineProperty(h,"__esModule",{value:!0}),h.debug=void 0,h.debug=function(){for(var p=[],y=0;y<arguments.length;y++)p[y]=arguments[y];console.debug?console.debug.apply(null,p):console.log.apply(null,p)}},607:function(l,h,p){Object.defineProperty(h,"__esModule",{value:!0}),h.grpc=void 0;var y,_=p(418),E=p(57),O=p(229),P=p(540),C=p(210),A=p(859),q=p(8),U=p(938),F=p(35),j=p(934);(y=h.grpc||(h.grpc={})).setDefaultTransport=E.setDefaultTransportFactory,y.CrossBrowserHttpTransport=A.CrossBrowserHttpTransport,y.FetchReadableStreamTransport=O.FetchReadableStreamTransport,y.XhrTransport=C.XhrTransport,y.WebsocketTransport=P.WebsocketTransport,y.Code=q.Code,y.Metadata=_.BrowserHeaders,y.client=function(T,D){return j.client(T,D)},y.invoke=U.invoke,y.unary=F.unary},938:function(l,h,p){Object.defineProperty(h,"__esModule",{value:!0}),h.invoke=void 0;var y=p(934);h.invoke=function(_,E){if(_.requestStream)throw new Error(".invoke cannot be used with client-streaming methods. Use .client instead.");var O=y.client(_,{host:E.host,transport:E.transport,debug:E.debug});return E.onHeaders&&O.onHeaders(E.onHeaders),E.onMessage&&O.onMessage(E.onMessage),E.onEnd&&O.onEnd(E.onEnd),O.start(E.metadata),O.send(E.request),O.finishSend(),{close:function(){O.close()}}}},65:function(l,h,p){Object.defineProperty(h,"__esModule",{value:!0}),h.Metadata=void 0;var y=p(418);Object.defineProperty(h,"Metadata",{enumerable:!0,get:function(){return y.BrowserHeaders}})},57:function(l,h,p){Object.defineProperty(h,"__esModule",{value:!0}),h.makeDefaultTransport=h.setDefaultTransportFactory=void 0;var y=p(859),_=function(E){return y.CrossBrowserHttpTransport({withCredentials:!1})(E)};h.setDefaultTransportFactory=function(E){_=E},h.makeDefaultTransport=function(E){return _(E)}},229:function(l,h,p){var y=this&&this.__assign||function(){return(y=Object.assign||function(P){for(var C,A=1,q=arguments.length;A<q;A++)for(var U in C=arguments[A])Object.prototype.hasOwnProperty.call(C,U)&&(P[U]=C[U]);return P}).apply(this,arguments)};Object.defineProperty(h,"__esModule",{value:!0}),h.detectFetchSupport=h.FetchReadableStreamTransport=void 0;var _=p(65),E=p(346);h.FetchReadableStreamTransport=function(P){return function(C){return function(A,q){return A.debug&&E.debug("fetchRequest",A),new O(A,q)}(C,P)}};var O=function(){function P(C,A){this.cancelled=!1,this.controller=self.AbortController&&new AbortController,this.options=C,this.init=A}return P.prototype.pump=function(C,A){var q=this;if(this.reader=C,this.cancelled)return this.options.debug&&E.debug("Fetch.pump.cancel at first pump"),void this.reader.cancel().catch(function(U){q.options.debug&&E.debug("Fetch.pump.reader.cancel exception",U)});this.reader.read().then(function(U){if(U.done)return q.options.onEnd(),A;q.options.onChunk(U.value),q.pump(q.reader,A)}).catch(function(U){q.cancelled?q.options.debug&&E.debug("Fetch.catch - request cancelled"):(q.cancelled=!0,q.options.debug&&E.debug("Fetch.catch",U.message),q.options.onEnd(U))})},P.prototype.send=function(C){var A=this;fetch(this.options.url,y(y({},this.init),{headers:this.metadata.toHeaders(),method:"POST",body:C,signal:this.controller&&this.controller.signal})).then(function(q){if(A.options.debug&&E.debug("Fetch.response",q),A.options.onHeaders(new _.Metadata(q.headers),q.status),!q.body)return q;A.pump(q.body.getReader(),q)}).catch(function(q){A.cancelled?A.options.debug&&E.debug("Fetch.catch - request cancelled"):(A.cancelled=!0,A.options.debug&&E.debug("Fetch.catch",q.message),A.options.onEnd(q))})},P.prototype.sendMessage=function(C){this.send(C)},P.prototype.finishSend=function(){},P.prototype.start=function(C){this.metadata=C},P.prototype.cancel=function(){var C=this;this.cancelled?this.options.debug&&E.debug("Fetch.cancel already cancelled"):(this.cancelled=!0,this.controller?(this.options.debug&&E.debug("Fetch.cancel.controller.abort"),this.controller.abort()):this.options.debug&&E.debug("Fetch.cancel.missing abort controller"),this.reader?(this.options.debug&&E.debug("Fetch.cancel.reader.cancel"),this.reader.cancel().catch(function(A){C.options.debug&&E.debug("Fetch.cancel.reader.cancel exception",A)})):this.options.debug&&E.debug("Fetch.cancel before reader"))},P}();h.detectFetchSupport=function(){return typeof Response!="undefined"&&Response.prototype.hasOwnProperty("body")&&typeof Headers=="function"}},859:function(l,h,p){Object.defineProperty(h,"__esModule",{value:!0}),h.CrossBrowserHttpTransport=void 0;var y=p(229),_=p(210);h.CrossBrowserHttpTransport=function(E){if(y.detectFetchSupport()){var O={credentials:E.withCredentials?"include":"same-origin"};return y.FetchReadableStreamTransport(O)}return _.XhrTransport({withCredentials:E.withCredentials})}},210:function(l,h,p){var y,_=this&&this.__extends||(y=function(F,j){return(y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(T,D){T.__proto__=D}||function(T,D){for(var J in D)Object.prototype.hasOwnProperty.call(D,J)&&(T[J]=D[J])})(F,j)},function(F,j){function T(){this.constructor=F}y(F,j),F.prototype=j===null?Object.create(j):(T.prototype=j.prototype,new T)});Object.defineProperty(h,"__esModule",{value:!0}),h.stringToArrayBuffer=h.MozChunkedArrayBufferXHR=h.XHR=h.XhrTransport=void 0;var E=p(65),O=p(346),P=p(849);h.XhrTransport=function(F){return function(j){if(P.detectMozXHRSupport())return new A(j,F);if(P.detectXHROverrideMimeTypeSupport())return new C(j,F);throw new Error("This environment's XHR implementation cannot support binary transfer.")}};var C=function(){function F(j,T){this.options=j,this.init=T}return F.prototype.onProgressEvent=function(){this.options.debug&&O.debug("XHR.onProgressEvent.length: ",this.xhr.response.length);var j=this.xhr.response.substr(this.index);this.index=this.xhr.response.length;var T=U(j);this.options.onChunk(T)},F.prototype.onLoadEvent=function(){this.options.debug&&O.debug("XHR.onLoadEvent"),this.options.onEnd()},F.prototype.onStateChange=function(){this.options.debug&&O.debug("XHR.onStateChange",this.xhr.readyState),this.xhr.readyState===XMLHttpRequest.HEADERS_RECEIVED&&this.options.onHeaders(new E.Metadata(this.xhr.getAllResponseHeaders()),this.xhr.status)},F.prototype.sendMessage=function(j){this.xhr.send(j)},F.prototype.finishSend=function(){},F.prototype.start=function(j){var T=this;this.metadata=j;var D=new XMLHttpRequest;this.xhr=D,D.open("POST",this.options.url),this.configureXhr(),this.metadata.forEach(function(J,ee){D.setRequestHeader(J,ee.join(", "))}),D.withCredentials=Boolean(this.init.withCredentials),D.addEventListener("readystatechange",this.onStateChange.bind(this)),D.addEventListener("progress",this.onProgressEvent.bind(this)),D.addEventListener("loadend",this.onLoadEvent.bind(this)),D.addEventListener("error",function(J){T.options.debug&&O.debug("XHR.error",J),T.options.onEnd(J.error)})},F.prototype.configureXhr=function(){this.xhr.responseType="text",this.xhr.overrideMimeType("text/plain; charset=x-user-defined")},F.prototype.cancel=function(){this.options.debug&&O.debug("XHR.abort"),this.xhr.abort()},F}();h.XHR=C;var A=function(F){function j(){return F!==null&&F.apply(this,arguments)||this}return _(j,F),j.prototype.configureXhr=function(){this.options.debug&&O.debug("MozXHR.configureXhr: setting responseType to 'moz-chunked-arraybuffer'"),this.xhr.responseType="moz-chunked-arraybuffer"},j.prototype.onProgressEvent=function(){var T=this.xhr.response;this.options.debug&&O.debug("MozXHR.onProgressEvent: ",new Uint8Array(T)),this.options.onChunk(new Uint8Array(T))},j}(C);function q(F,j){var T=F.charCodeAt(j);if(T>=55296&&T<=56319){var D=F.charCodeAt(j+1);D>=56320&&D<=57343&&(T=65536+(T-55296<<10)+(D-56320))}return T}function U(F){for(var j=new Uint8Array(F.length),T=0,D=0;D<F.length;D++){var J=String.prototype.codePointAt?F.codePointAt(D):q(F,D);j[T++]=255&J}return j}h.MozChunkedArrayBufferXHR=A,h.stringToArrayBuffer=U},849:function(l,h){var p;function y(){if(p!==void 0)return p;if(XMLHttpRequest){p=new XMLHttpRequest;try{p.open("GET","https://localhost")}catch{}}return p}function _(E){var O=y();if(!O)return!1;try{return O.responseType=E,O.responseType===E}catch{}return!1}Object.defineProperty(h,"__esModule",{value:!0}),h.detectXHROverrideMimeTypeSupport=h.detectMozXHRSupport=h.xhrSupportsResponseType=void 0,h.xhrSupportsResponseType=_,h.detectMozXHRSupport=function(){return typeof XMLHttpRequest!="undefined"&&_("moz-chunked-arraybuffer")},h.detectXHROverrideMimeTypeSupport=function(){return typeof XMLHttpRequest!="undefined"&&XMLHttpRequest.prototype.hasOwnProperty("overrideMimeType")}},540:function(l,h,p){Object.defineProperty(h,"__esModule",{value:!0}),h.WebsocketTransport=void 0;var y,_=p(346),E=p(617);(function(P){P[P.FINISH_SEND=1]="FINISH_SEND"})(y||(y={}));var O=new Uint8Array([1]);h.WebsocketTransport=function(){return function(P){return function(C){C.debug&&_.debug("websocketRequest",C);var A,q=function(j){if(j.substr(0,8)==="https://")return"wss://"+j.substr(8);if(j.substr(0,7)==="http://")return"ws://"+j.substr(7);throw new Error("Websocket transport constructed with non-https:// or http:// host.")}(C.url),U=[];function F(j){if(j===y.FINISH_SEND)A.send(O);else{var T=j,D=new Int8Array(T.byteLength+1);D.set(new Uint8Array([0])),D.set(T,1),A.send(D)}}return{sendMessage:function(j){A&&A.readyState!==A.CONNECTING?F(j):U.push(j)},finishSend:function(){A&&A.readyState!==A.CONNECTING?F(y.FINISH_SEND):U.push(y.FINISH_SEND)},start:function(j){(A=new WebSocket(q,["grpc-websockets"])).binaryType="arraybuffer",A.onopen=function(){var T;C.debug&&_.debug("websocketRequest.onopen"),A.send((T="",j.forEach(function(D,J){T+=D+": "+J.join(", ")+`\r
`}),E.encodeASCII(T))),U.forEach(function(D){F(D)})},A.onclose=function(T){C.debug&&_.debug("websocketRequest.onclose",T),C.onEnd()},A.onerror=function(T){C.debug&&_.debug("websocketRequest.onerror",T)},A.onmessage=function(T){C.onChunk(new Uint8Array(T.data))}},cancel:function(){C.debug&&_.debug("websocket.abort"),A.close()}}}(P)}}},35:function(l,h,p){Object.defineProperty(h,"__esModule",{value:!0}),h.unary=void 0;var y=p(65),_=p(934);h.unary=function(E,O){if(E.responseStream)throw new Error(".unary cannot be used with server-streaming methods. Use .invoke or .client instead.");if(E.requestStream)throw new Error(".unary cannot be used with client-streaming methods. Use .client instead.");var P=null,C=null,A=_.client(E,{host:O.host,transport:O.transport,debug:O.debug});return A.onHeaders(function(q){P=q}),A.onMessage(function(q){C=q}),A.onEnd(function(q,U,F){O.onEnd({status:q,statusMessage:U,headers:P||new y.Metadata,message:C,trailers:F})}),A.start(O.metadata),A.send(O.request),A.finishSend(),{close:function(){A.close()}}}},882:function(l,h){Object.defineProperty(h,"__esModule",{value:!0}),h.frameRequest=void 0,h.frameRequest=function(p){var y=p.serializeBinary(),_=new ArrayBuffer(y.byteLength+5);return new DataView(_,1,4).setUint32(0,y.length,!1),new Uint8Array(_,5).set(y),new Uint8Array(_)}}},c={},function l(h){if(c[h])return c[h].exports;var p=c[h]={exports:{}};return d[h].call(p.exports,p,p.exports,l),p.exports}(607);var d,c})})(grpcWebClient_umd);class AbortError extends Error{constructor(){super("The operation has been aborted"),this.message="The operation has been aborted",this.name="AbortError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,this.constructor)}}function isAbortError(a){return typeof a=="object"&&a!==null&&a.name==="AbortError"}function throwIfAborted(a){if(a.aborted)throw new AbortError}function rethrowAbortError(a){if(isAbortError(a))throw a}function catchAbortError(a){if(!isAbortError(a))throw a}function execute(a,s){return new Promise((d,c)=>{if(a.aborted){c(new AbortError);return}let l,h=!1;function p(){h||(h=!0,l!=null&&l())}const y=s(_=>{d(_),p()},_=>{c(_),p()});if(!h){const _=()=>{const E=y();E==null?c(new AbortError):E.then(()=>{c(new AbortError)},O=>{c(O)}),p()};a.addEventListener("abort",_),l=()=>{a.removeEventListener("abort",_)}}})}function abortable(a,s){if(a.aborted){const d=()=>{};s.then(d,d)}return execute(a,(d,c)=>(s.then(d,c),()=>{}))}function delay$1(a,s){return execute(a,d=>{const c=typeof s=="number"?s:s.getTime()-Date.now(),l=setTimeout(d,c);return()=>{clearTimeout(l)}})}function forever(a){return execute(a,()=>()=>{})}function waitForEvent(a,s,d,c){return execute(a,l=>{let h,p=!1;return h=listen(s,d,(..._)=>{l(_.length>1?_:_[0]),p=!0,h!=null&&h()},c),p&&h(),()=>{p=!0,h!=null&&h()}})}function listen(a,s,d,c){if(isEventTarget(a))return a.addEventListener(s,d,c),()=>a.removeEventListener(s,d,c);if(isJQueryStyleEventEmitter(a))return a.on(s,d),()=>a.off(s,d);if(isNodeStyleEventEmitter(a))return a.addListener(s,d),()=>a.removeListener(s,d);throw new Error("Invalid event target")}function isNodeStyleEventEmitter(a){return isFunction$2(a.addListener)&&isFunction$2(a.removeListener)}function isJQueryStyleEventEmitter(a){return isFunction$2(a.on)&&isFunction$2(a.off)}function isEventTarget(a){return isFunction$2(a.addEventListener)&&isFunction$2(a.removeEventListener)}const isFunction$2=a=>typeof a=="function";var browser$3={exports:{}};const _global=typeof self!="undefined"?self:typeof window!="undefined"?window:void 0;if(!_global)throw new Error("Unable to find global scope. Are you sure this is running in the browser?");if(!_global.AbortController)throw new Error('Could not find "AbortController" in the global scope. You need to polyfill it first');browser$3.exports=_global.AbortController,browser$3.exports.default=_global.AbortController;var AbortController$1=browser$3.exports;function all(a,s){return new Promise((d,c)=>{if(a.aborted){c(new AbortError);return}const l=new AbortController$1,h=s(l.signal);if(h.length===0){d([]);return}const p=()=>{l.abort()};a.addEventListener("abort",p);let y;const _=new Array(h.length);let E=0;function O(){E+=1,E===h.length&&(a.removeEventListener("abort",p),y!=null?c(y.reason):d(_))}for(const[P,C]of h.entries())C.then(A=>{_[P]=A,O()},A=>{l.abort(),(y==null||!isAbortError(A)&&isAbortError(y.reason))&&(y={reason:A}),O()})})}function race$2(a,s){return new Promise((d,c)=>{if(a.aborted){c(new AbortError);return}const l=new AbortController$1,h=s(l.signal),p=()=>{l.abort()};a.addEventListener("abort",p);let y=0;function _(O){l.abort(),y+=1,y===h.length&&(a.removeEventListener("abort",p),O.status==="fulfilled"?d(O.value):c(O.reason))}let E;for(const O of h)O.then(P=>{E==null&&(E={status:"fulfilled",value:P}),_(E)},P=>{(E==null||!isAbortError(P)&&(E.status==="fulfilled"||isAbortError(E.reason)))&&(E={status:"rejected",reason:P}),_(E)})})}async function retry$1(a,s,d={}){const{baseMs:c=1e3,maxDelayMs:l=15e3,onError:h,maxAttempts:p=1/0}=d;let y=0;const _=()=>{y=-1};for(;;)try{return await s(a,y,_)}catch(E){if(rethrowAbortError(E),y>=p)throw E;let O;if(y===-1)O=0;else{const P=Math.min(l,Math.pow(2,y)*c);O=Math.round(P*(1+Math.random())/2)}h&&h(E,y,O),O!==0&&await delay$1(a,O),y+=1}}function spawn(a,s){if(a.aborted)return Promise.reject(new AbortError);const d=[],c=new AbortController$1,l=c.signal,h=()=>{c.abort()};a.addEventListener("abort",h);const p=()=>{a.removeEventListener("abort",h)},y=new Set,_=()=>{for(const P of y)P.abort()};l.addEventListener("abort",_);const E=()=>{l.removeEventListener("abort",_)};let O=new Promise((P,C)=>{let A,q;U(F=>s(F,{defer(j){d.push(j)},fork:U})).join().then(F=>{c.abort(),A={value:F}},F=>{c.abort(),(!isAbortError(F)||q==null)&&(q={error:F})});function U(F){if(l.aborted)return{abort(){},async join(){throw new AbortError}};const j=new AbortController$1,T=j.signal,D=F(T),J={abort(){j.abort()},join:()=>D};return y.add(J),D.catch(catchAbortError).catch(ee=>{q={error:ee},c.abort()}).finally(()=>{y.delete(J),y.size===0&&(q!=null?C(q.error):P(A.value))}),J}});return O=O.finally(()=>{p(),E();let P=Promise.resolve();for(let C=d.length-1;C>=0;C--)P=P.finally(d[C]);return P}),O}function run(a){const s=new AbortController$1,d=a(s.signal).catch(catchAbortError);return()=>(s.abort(),d)}var es=Object.freeze(Object.defineProperty({__proto__:null,abortable,AbortError,isAbortError,throwIfAborted,rethrowAbortError,catchAbortError,delay:delay$1,execute,forever,waitForEvent,all,race:race$2,retry:retry$1,spawn,run},Symbol.toStringTag,{value:"Module"})),require$$1$1=getAugmentedNamespace(es),AsyncSink$1={};Object.defineProperty(AsyncSink$1,"__esModule",{value:!0}),AsyncSink$1.AsyncSink=void 0;const ARRAY_VALUE="value",ARRAY_ERROR="error";class AsyncSink{constructor(){this._ended=!1,this._values=[],this._resolvers=[]}[Symbol.asyncIterator](){return this}write(s){this._push({type:ARRAY_VALUE,value:s})}error(s){this._push({type:ARRAY_ERROR,error:s})}_push(s){if(this._ended)throw new Error("AsyncSink already ended");if(this._resolvers.length>0){const{resolve:d,reject:c}=this._resolvers.shift();s.type===ARRAY_ERROR?c(s.error):d({done:!1,value:s.value})}else this._values.push(s)}next(){if(this._values.length>0){const{type:s,value:d,error:c}=this._values.shift();return s===ARRAY_ERROR?Promise.reject(c):Promise.resolve({done:!1,value:d})}return this._ended?Promise.resolve({done:!0}):new Promise((s,d)=>{this._resolvers.push({resolve:s,reject:d})})}end(){for(;this._resolvers.length>0;)this._resolvers.shift().resolve({done:!0});this._ended=!0}}AsyncSink$1.AsyncSink=AsyncSink;var isAsyncIterable$1={};Object.defineProperty(isAsyncIterable$1,"__esModule",{value:!0}),isAsyncIterable$1.isAsyncIterable=void 0;function isAsyncIterable(a){return a!=null&&Symbol.asyncIterator in a}isAsyncIterable$1.isAsyncIterable=isAsyncIterable;var convertMetadata={},base64$2={exports:{}};(function(a,s){(function(d,c){a.exports=c()})(typeof self!="undefined"?self:typeof window!="undefined"?window:commonjsGlobal,function(){var d="3.7.2",c=d,l=typeof atob=="function",h=typeof btoa=="function",p=typeof Buffer=="function",y=typeof TextDecoder=="function"?new TextDecoder:void 0,_=typeof TextEncoder=="function"?new TextEncoder:void 0,E="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",O=Array.prototype.slice.call(E),P=function($){var Z={};return $.forEach(function(le,de){return Z[le]=de}),Z}(O),C=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,A=String.fromCharCode.bind(String),q=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):function($,Z){return Z===void 0&&(Z=function(le){return le}),new Uint8Array(Array.prototype.slice.call($,0).map(Z))},U=function($){return $.replace(/=/g,"").replace(/[+\/]/g,function(Z){return Z=="+"?"-":"_"})},F=function($){return $.replace(/[^A-Za-z0-9\+\/]/g,"")},j=function($){for(var Z,le,de,he,ge="",Pe=$.length%3,Te=0;Te<$.length;){if((le=$.charCodeAt(Te++))>255||(de=$.charCodeAt(Te++))>255||(he=$.charCodeAt(Te++))>255)throw new TypeError("invalid character found");Z=le<<16|de<<8|he,ge+=O[Z>>18&63]+O[Z>>12&63]+O[Z>>6&63]+O[Z&63]}return Pe?ge.slice(0,Pe-3)+"===".substring(Pe):ge},T=h?function($){return btoa($)}:p?function($){return Buffer.from($,"binary").toString("base64")}:j,D=p?function($){return Buffer.from($).toString("base64")}:function($){for(var Z=4096,le=[],de=0,he=$.length;de<he;de+=Z)le.push(A.apply(null,$.subarray(de,de+Z)));return T(le.join(""))},J=function($,Z){return Z===void 0&&(Z=!1),Z?U(D($)):D($)},ee=function($){if($.length<2){var Z=$.charCodeAt(0);return Z<128?$:Z<2048?A(192|Z>>>6)+A(128|Z&63):A(224|Z>>>12&15)+A(128|Z>>>6&63)+A(128|Z&63)}else{var Z=65536+($.charCodeAt(0)-55296)*1024+($.charCodeAt(1)-56320);return A(240|Z>>>18&7)+A(128|Z>>>12&63)+A(128|Z>>>6&63)+A(128|Z&63)}},z=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,ne=function($){return $.replace(z,ee)},X=p?function($){return Buffer.from($,"utf8").toString("base64")}:_?function($){return D(_.encode($))}:function($){return T(ne($))},M=function($,Z){return Z===void 0&&(Z=!1),Z?U(X($)):X($)},K=function($){return M($,!0)},te=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,L=function($){switch($.length){case 4:var Z=(7&$.charCodeAt(0))<<18|(63&$.charCodeAt(1))<<12|(63&$.charCodeAt(2))<<6|63&$.charCodeAt(3),le=Z-65536;return A((le>>>10)+55296)+A((le&1023)+56320);case 3:return A((15&$.charCodeAt(0))<<12|(63&$.charCodeAt(1))<<6|63&$.charCodeAt(2));default:return A((31&$.charCodeAt(0))<<6|63&$.charCodeAt(1))}},G=function($){return $.replace(te,L)},W=function($){if($=$.replace(/\s+/g,""),!C.test($))throw new TypeError("malformed base64.");$+="==".slice(2-($.length&3));for(var Z,le="",de,he,ge=0;ge<$.length;)Z=P[$.charAt(ge++)]<<18|P[$.charAt(ge++)]<<12|(de=P[$.charAt(ge++)])<<6|(he=P[$.charAt(ge++)]),le+=de===64?A(Z>>16&255):he===64?A(Z>>16&255,Z>>8&255):A(Z>>16&255,Z>>8&255,Z&255);return le},ie=l?function($){return atob(F($))}:p?function($){return Buffer.from($,"base64").toString("binary")}:W,x=p?function($){return q(Buffer.from($,"base64"))}:function($){return q(ie($),function(Z){return Z.charCodeAt(0)})},Y=function($){return x(fe($))},oe=p?function($){return Buffer.from($,"base64").toString("utf8")}:y?function($){return y.decode(x($))}:function($){return G(ie($))},fe=function($){return F($.replace(/[-_]/g,function(Z){return Z=="-"?"+":"/"}))},pe=function($){return oe(fe($))},me=function($){if(typeof $!="string")return!1;var Z=$.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(Z)||!/[^\s0-9a-zA-Z\-_]/.test(Z)},v=function($){return{value:$,enumerable:!1,writable:!0,configurable:!0}},g=function(){var $=function(Z,le){return Object.defineProperty(String.prototype,Z,v(le))};$("fromBase64",function(){return pe(this)}),$("toBase64",function(Z){return M(this,Z)}),$("toBase64URI",function(){return M(this,!0)}),$("toBase64URL",function(){return M(this,!0)}),$("toUint8Array",function(){return Y(this)})},w=function(){var $=function(Z,le){return Object.defineProperty(Uint8Array.prototype,Z,v(le))};$("toBase64",function(Z){return J(this,Z)}),$("toBase64URI",function(){return J(this,!0)}),$("toBase64URL",function(){return J(this,!0)})},ae=function(){g(),w()},I={version:d,VERSION:c,atob:ie,atobPolyfill:W,btoa:T,btoaPolyfill:j,fromBase64:pe,toBase64:M,encode:M,encodeURI:K,encodeURL:K,utob:ne,btou:G,decode:pe,isValid:me,fromUint8Array:J,toUint8Array:Y,extendString:g,extendUint8Array:w,extendBuiltins:ae};return I.Base64={},Object.keys(I).forEach(function($){return I.Base64[$]=I[$]}),I})})(base64$2),Object.defineProperty(convertMetadata,"__esModule",{value:!0}),convertMetadata.convertMetadataFromGrpcWeb=convertMetadata.convertMetadataToGrpcWeb=void 0;const grpc_web_1$4=grpcWebClient_umd.exports,nice_grpc_common_1$5=lib,js_base64_1=base64$2.exports;function convertMetadataToGrpcWeb(a){const s=new grpc_web_1$4.grpc.Metadata;for(const[d,c]of a)for(const l of c)s.append(d,typeof l=="string"?l:js_base64_1.Base64.fromUint8Array(l));return s}convertMetadata.convertMetadataToGrpcWeb=convertMetadataToGrpcWeb;function convertMetadataFromGrpcWeb(a){const s=(0,nice_grpc_common_1$5.Metadata)();for(const[d,c]of Object.entries(a.headersMap))s.set(d,d.endsWith("-bin")?c.map(l=>js_base64_1.Base64.toUint8Array(l)):c);return s}convertMetadata.convertMetadataFromGrpcWeb=convertMetadataFromGrpcWeb;var __importDefault$l=commonjsGlobal&&commonjsGlobal.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(createBidiStreamingMethod$1,"__esModule",{value:!0}),createBidiStreamingMethod$1.createBidiStreamingMethod=void 0;const nice_grpc_common_1$4=lib,grpc_web_1$3=grpcWebClient_umd.exports,abort_controller_x_1$4=require$$1$1,node_abort_controller_1$3=__importDefault$l(browser$3.exports),AsyncSink_1$1=AsyncSink$1,service_definitions_1$4=serviceDefinitions,isAsyncIterable_1$3=isAsyncIterable$1,convertMetadata_1$3=convertMetadata;function createBidiStreamingMethod(a,s,d,c){const l=(0,service_definitions_1$4.toGrpcWebMethodDefinition)(a),h={path:a.path,requestStream:a.requestStream,responseStream:a.responseStream,options:a.options};async function*p(_,E){if(!(0,isAsyncIterable_1$3.isAsyncIterable)(_))throw new Error("A middleware passed invalid request to next(): expected a single message for bidirectional streaming method");const{metadata:O=(0,nice_grpc_common_1$4.Metadata)(),signal:P=new node_abort_controller_1$3.default().signal,onHeader:C,onTrailer:A}=E,q=new node_abort_controller_1$3.default,U=new AsyncSink_1$1.AsyncSink,F=grpc_web_1$3.grpc.client(l,{host:s.address,transport:s.transport});F.onHeaders(D=>{C==null||C((0,convertMetadata_1$3.convertMetadataFromGrpcWeb)(D))}),F.onMessage(D=>{U.write(D)}),F.onEnd((D,J,ee)=>{A==null||A((0,convertMetadata_1$3.convertMetadataFromGrpcWeb)(ee)),D===grpc_web_1$3.grpc.Code.OK?U.end():U.error(new nice_grpc_common_1$4.ClientError(a.path,+D,J))}),F.start((0,convertMetadata_1$3.convertMetadataToGrpcWeb)(O));let j;pipeRequest$1(q.signal,_,F,a).then(()=>{F.finishSend()},D=>{(0,abort_controller_x_1$4.isAbortError)(D)||(j=D,F.close(),U.end())});const T=()=>{U.error(new abort_controller_x_1$4.AbortError),q.abort(),F.close()};P.addEventListener("abort",T);try{yield*U}finally{if(q.abort(),P.removeEventListener("abort",T),(0,abort_controller_x_1$4.throwIfAborted)(P),j)throw j}}const y=d==null?p:(_,E)=>d({method:h,requestStream:!0,request:_,responseStream:!0,next:p},E);return(_,E)=>{const P=y(_,{...c,...E})[Symbol.asyncIterator]();return{[Symbol.asyncIterator](){return{async next(){const C=await P.next();return C.done&&C.value!=null?await P.throw(new Error("A middleware returned a message, but expected to return void for bidirectional streaming method")):C},return(){return P.return()},throw(C){return P.throw(C)}}}}}}createBidiStreamingMethod$1.createBidiStreamingMethod=createBidiStreamingMethod;async function pipeRequest$1(a,s,d,c){for await(const l of s)(0,abort_controller_x_1$4.throwIfAborted)(a),d.send({serializeBinary:()=>c.requestSerialize(l)})}var createClientStreamingMethod$1={},__importDefault$k=commonjsGlobal&&commonjsGlobal.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(createClientStreamingMethod$1,"__esModule",{value:!0}),createClientStreamingMethod$1.createClientStreamingMethod=void 0;const nice_grpc_common_1$3=lib,grpc_web_1$2=grpcWebClient_umd.exports,abort_controller_x_1$3=require$$1$1,node_abort_controller_1$2=__importDefault$k(browser$3.exports),service_definitions_1$3=serviceDefinitions,isAsyncIterable_1$2=isAsyncIterable$1,convertMetadata_1$2=convertMetadata;function createClientStreamingMethod(a,s,d,c){const l=(0,service_definitions_1$3.toGrpcWebMethodDefinition)(a),h={path:a.path,requestStream:a.requestStream,responseStream:a.responseStream,options:a.options};async function*p(_,E){if(!(0,isAsyncIterable_1$2.isAsyncIterable)(_))throw new Error("A middleware passed invalid request to next(): expected a single message for client streaming method");const{metadata:O=(0,nice_grpc_common_1$3.Metadata)(),signal:P=new node_abort_controller_1$2.default().signal,onHeader:C,onTrailer:A}=E;return await(0,abort_controller_x_1$3.execute)(P,(q,U)=>{const F=new node_abort_controller_1$2.default;let j;const T=grpc_web_1$2.grpc.client(l,{host:s.address,transport:s.transport});return T.onHeaders(D=>{C==null||C((0,convertMetadata_1$2.convertMetadataFromGrpcWeb)(D))}),T.onMessage(D=>{j=D}),T.onEnd((D,J,ee)=>{A==null||A((0,convertMetadata_1$2.convertMetadataFromGrpcWeb)(ee)),F.abort(),D===grpc_web_1$2.grpc.Code.OK?q(j):U(new nice_grpc_common_1$3.ClientError(a.path,+D,J))}),T.start((0,convertMetadata_1$2.convertMetadataToGrpcWeb)(O)),pipeRequest(F.signal,_,T,a).then(()=>{T.finishSend()},D=>{(0,abort_controller_x_1$3.isAbortError)(D)||(U(D),T.close())}),()=>{F.abort(),T.close()}})}const y=d==null?p:(_,E)=>d({method:h,requestStream:!0,request:_,responseStream:!1,next:p},E);return async(_,E)=>{const P=y(_,{...c,...E})[Symbol.asyncIterator]();let C=await P.next();for(;;){if(!C.done){C=await P.throw(new Error("A middleware yielded a message, but expected to only return a message for client streaming method"));continue}if(C.value==null){C=await P.throw(new Error("A middleware returned void, but expected to return a message for client streaming method"));continue}return C.value}}}createClientStreamingMethod$1.createClientStreamingMethod=createClientStreamingMethod;async function pipeRequest(a,s,d,c){for await(const l of s)(0,abort_controller_x_1$3.throwIfAborted)(a),d.send({serializeBinary:()=>c.requestSerialize(l)})}var createServerStreamingMethod$1={},__importDefault$j=commonjsGlobal&&commonjsGlobal.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(createServerStreamingMethod$1,"__esModule",{value:!0}),createServerStreamingMethod$1.createServerStreamingMethod=void 0;const grpc_web_1$1=grpcWebClient_umd.exports,abort_controller_x_1$2=require$$1$1,AsyncSink_1=AsyncSink$1,nice_grpc_common_1$2=lib,node_abort_controller_1$1=__importDefault$j(browser$3.exports),service_definitions_1$2=serviceDefinitions,convertMetadata_1$1=convertMetadata,isAsyncIterable_1$1=isAsyncIterable$1;function createServerStreamingMethod(a,s,d,c){const l=(0,service_definitions_1$2.toGrpcWebMethodDefinition)(a),h={path:a.path,requestStream:a.requestStream,responseStream:a.responseStream,options:a.options};async function*p(_,E){if((0,isAsyncIterable_1$1.isAsyncIterable)(_))throw new Error("A middleware passed invalid request to next(): expected a single message for server streaming method");const{metadata:O=(0,nice_grpc_common_1$2.Metadata)(),signal:P=new node_abort_controller_1$1.default().signal,onHeader:C,onTrailer:A}=E,q=new AsyncSink_1.AsyncSink,U=grpc_web_1$1.grpc.client(l,{host:s.address,transport:s.transport});U.onHeaders(j=>{C==null||C((0,convertMetadata_1$1.convertMetadataFromGrpcWeb)(j))}),U.onMessage(j=>{q.write(j)}),U.onEnd((j,T,D)=>{A==null||A((0,convertMetadata_1$1.convertMetadataFromGrpcWeb)(D)),j===grpc_web_1$1.grpc.Code.OK?q.end():q.error(new nice_grpc_common_1$2.ClientError(a.path,+j,T))}),U.start((0,convertMetadata_1$1.convertMetadataToGrpcWeb)(O)),U.send({serializeBinary:()=>a.requestSerialize(_)}),U.finishSend();const F=()=>{q.error(new abort_controller_x_1$2.AbortError),U.close()};P.addEventListener("abort",F);try{yield*q}finally{P.removeEventListener("abort",F),(0,abort_controller_x_1$2.throwIfAborted)(P)}}const y=d==null?p:(_,E)=>d({method:h,requestStream:!1,request:_,responseStream:!0,next:p},E);return(_,E)=>{const P=y(_,{...c,...E})[Symbol.asyncIterator]();return{[Symbol.asyncIterator](){return{async next(){const C=await P.next();return C.done&&C.value!=null?await P.throw(new Error("A middleware returned a message, but expected to return void for server streaming method")):C},return(){return P.return()},throw(C){return P.throw(C)}}}}}}createServerStreamingMethod$1.createServerStreamingMethod=createServerStreamingMethod;var createUnaryMethod$1={},__importDefault$i=commonjsGlobal&&commonjsGlobal.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(createUnaryMethod$1,"__esModule",{value:!0}),createUnaryMethod$1.createUnaryMethod=void 0;const nice_grpc_common_1$1=lib,grpc_web_1=grpcWebClient_umd.exports,abort_controller_x_1$1=require$$1$1,node_abort_controller_1=__importDefault$i(browser$3.exports),service_definitions_1$1=serviceDefinitions,isAsyncIterable_1=isAsyncIterable$1,convertMetadata_1=convertMetadata;function createUnaryMethod(a,s,d,c){const l=(0,service_definitions_1$1.toGrpcWebMethodDefinition)(a),h={path:a.path,requestStream:a.requestStream,responseStream:a.responseStream,options:a.options};async function*p(_,E){if((0,isAsyncIterable_1.isAsyncIterable)(_))throw new Error("A middleware passed invalid request to next(): expected a single message for unary method");const{metadata:O=(0,nice_grpc_common_1$1.Metadata)(),signal:P=new node_abort_controller_1.default().signal,onHeader:C,onTrailer:A}=E;return await(0,abort_controller_x_1$1.execute)(P,(q,U)=>{let F;const j=grpc_web_1.grpc.client(l,{host:s.address,transport:s.transport});return j.onHeaders(T=>{C==null||C((0,convertMetadata_1.convertMetadataFromGrpcWeb)(T))}),j.onMessage(T=>{F=T}),j.onEnd((T,D,J)=>{A==null||A((0,convertMetadata_1.convertMetadataFromGrpcWeb)(J)),T===grpc_web_1.grpc.Code.OK?q(F):U(new nice_grpc_common_1$1.ClientError(a.path,+T,D))}),j.start((0,convertMetadata_1.convertMetadataToGrpcWeb)(O)),j.send({serializeBinary:()=>a.requestSerialize(_)}),j.finishSend(),()=>{j.close()}})}const y=d==null?p:(_,E)=>d({method:h,requestStream:!1,request:_,responseStream:!1,next:p},E);return async(_,E)=>{const P=y(_,{...c,...E})[Symbol.asyncIterator]();let C=await P.next();for(;;){if(!C.done){C=await P.throw(new Error("A middleware yielded a message, but expected to only return a message for unary method"));continue}if(C.value==null){C=await P.throw(new Error("A middleware returned void, but expected to return a message for unary method"));continue}return C.value}}}createUnaryMethod$1.createUnaryMethod=createUnaryMethod,Object.defineProperty(ClientFactory,"__esModule",{value:!0}),ClientFactory.createClient=ClientFactory.createClientFactory=void 0;const nice_grpc_common_1=lib,service_definitions_1=serviceDefinitions,createBidiStreamingMethod_1=createBidiStreamingMethod$1,createClientStreamingMethod_1=createClientStreamingMethod$1,createServerStreamingMethod_1=createServerStreamingMethod$1,createUnaryMethod_1=createUnaryMethod$1;function createClientFactory(){return createClientFactoryWithMiddleware()}ClientFactory.createClientFactory=createClientFactory;function createClient(a,s,d){return createClientFactory().create(a,s,d)}ClientFactory.createClient=createClient;function createClientFactoryWithMiddleware(a){return{use(s){return createClientFactoryWithMiddleware(a==null?s:(0,nice_grpc_common_1.composeClientMiddleware)(a,s))},create(s,d,c={}){const l={},h=Object.entries((0,service_definitions_1.normalizeServiceDefinition)(s));for(const[p,y]of h){const _={...c["*"],...c[p]};y.requestStream?y.responseStream?l[p]=(0,createBidiStreamingMethod_1.createBidiStreamingMethod)(y,d,a,_):l[p]=(0,createClientStreamingMethod_1.createClientStreamingMethod)(y,d,a,_):y.responseStream?l[p]=(0,createServerStreamingMethod_1.createServerStreamingMethod)(y,d,a,_):l[p]=(0,createUnaryMethod_1.createUnaryMethod)(y,d,a,_)}return l}}}var Client={};Object.defineProperty(Client,"__esModule",{value:!0}),function(a){var s=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(l,h,p,y){y===void 0&&(y=p);var _=Object.getOwnPropertyDescriptor(h,p);(!_||("get"in _?!h.__esModule:_.writable||_.configurable))&&(_={enumerable:!0,get:function(){return h[p]}}),Object.defineProperty(l,y,_)}:function(l,h,p,y){y===void 0&&(y=p),l[y]=h[p]}),d=commonjsGlobal&&commonjsGlobal.__exportStar||function(l,h){for(var p in l)p!=="default"&&!Object.prototype.hasOwnProperty.call(h,p)&&s(h,l,p)};Object.defineProperty(a,"__esModule",{value:!0}),a.Status=a.Metadata=a.composeClientMiddleware=a.ClientError=void 0;var c=lib;Object.defineProperty(a,"ClientError",{enumerable:!0,get:function(){return c.ClientError}}),Object.defineProperty(a,"composeClientMiddleware",{enumerable:!0,get:function(){return c.composeClientMiddleware}}),Object.defineProperty(a,"Metadata",{enumerable:!0,get:function(){return c.Metadata}}),Object.defineProperty(a,"Status",{enumerable:!0,get:function(){return c.Status}}),d(serviceDefinitions,a),d(channel,a),d(ClientFactory,a),d(Client,a)}(lib$1);var dist$3={},api$3={},umd={exports:{}};(function(a,s){var d=function(c){Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;/**
 * @license
 * Copyright 2009 The Closure Library Authors
 * Copyright 2020 Daniel Wirtz / The long.js Authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * SPDX-License-Identifier: Apache-2.0
 */var l=null;try{l=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function h(x,Y,oe){this.low=x|0,this.high=Y|0,this.unsigned=!!oe}h.prototype.__isLong__,Object.defineProperty(h.prototype,"__isLong__",{value:!0});function p(x){return(x&&x.__isLong__)===!0}function y(x){var Y=Math.clz32(x&-x);return x?31-Y:Y}h.isLong=p;var _={},E={};function O(x,Y){var oe,fe,pe;return Y?(x>>>=0,(pe=0<=x&&x<256)&&(fe=E[x],fe)?fe:(oe=C(x,0,!0),pe&&(E[x]=oe),oe)):(x|=0,(pe=-128<=x&&x<128)&&(fe=_[x],fe)?fe:(oe=C(x,x<0?-1:0,!1),pe&&(_[x]=oe),oe))}h.fromInt=O;function P(x,Y){if(isNaN(x))return Y?ne:z;if(Y){if(x<0)return ne;if(x>=D)return L}else{if(x<=-J)return G;if(x+1>=J)return te}return x<0?P(-x,Y).neg():C(x%T|0,x/T|0,Y)}h.fromNumber=P;function C(x,Y,oe){return new h(x,Y,oe)}h.fromBits=C;var A=Math.pow;function q(x,Y,oe){if(x.length===0)throw Error("empty string");if(typeof Y=="number"?(oe=Y,Y=!1):Y=!!Y,x==="NaN"||x==="Infinity"||x==="+Infinity"||x==="-Infinity")return Y?ne:z;if(oe=oe||10,oe<2||36<oe)throw RangeError("radix");var fe;if((fe=x.indexOf("-"))>0)throw Error("interior hyphen");if(fe===0)return q(x.substring(1),Y,oe).neg();for(var pe=P(A(oe,8)),me=z,v=0;v<x.length;v+=8){var g=Math.min(8,x.length-v),w=parseInt(x.substring(v,v+g),oe);if(g<8){var ae=P(A(oe,g));me=me.mul(ae).add(P(w))}else me=me.mul(pe),me=me.add(P(w))}return me.unsigned=Y,me}h.fromString=q;function U(x,Y){return typeof x=="number"?P(x,Y):typeof x=="string"?q(x,Y):C(x.low,x.high,typeof Y=="boolean"?Y:x.unsigned)}h.fromValue=U;var F=1<<16,j=1<<24,T=F*F,D=T*T,J=D/2,ee=O(j),z=O(0);h.ZERO=z;var ne=O(0,!0);h.UZERO=ne;var X=O(1);h.ONE=X;var M=O(1,!0);h.UONE=M;var K=O(-1);h.NEG_ONE=K;var te=C(-1,2147483647,!1);h.MAX_VALUE=te;var L=C(-1,-1,!0);h.MAX_UNSIGNED_VALUE=L;var G=C(0,-2147483648,!1);h.MIN_VALUE=G;var W=h.prototype;W.toInt=function(){return this.unsigned?this.low>>>0:this.low},W.toNumber=function(){return this.unsigned?(this.high>>>0)*T+(this.low>>>0):this.high*T+(this.low>>>0)},W.toString=function(Y){if(Y=Y||10,Y<2||36<Y)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(G)){var oe=P(Y),fe=this.div(oe),pe=fe.mul(oe).sub(this);return fe.toString(Y)+pe.toInt().toString(Y)}else return"-"+this.neg().toString(Y);for(var me=P(A(Y,6),this.unsigned),v=this,g="";;){var w=v.div(me),ae=v.sub(w.mul(me)).toInt()>>>0,I=ae.toString(Y);if(v=w,v.isZero())return I+g;for(;I.length<6;)I="0"+I;g=""+I+g}},W.getHighBits=function(){return this.high},W.getHighBitsUnsigned=function(){return this.high>>>0},W.getLowBits=function(){return this.low},W.getLowBitsUnsigned=function(){return this.low>>>0},W.getNumBitsAbs=function(){if(this.isNegative())return this.eq(G)?64:this.neg().getNumBitsAbs();for(var Y=this.high!=0?this.high:this.low,oe=31;oe>0&&(Y&1<<oe)==0;oe--);return this.high!=0?oe+33:oe+1},W.isZero=function(){return this.high===0&&this.low===0},W.eqz=W.isZero,W.isNegative=function(){return!this.unsigned&&this.high<0},W.isPositive=function(){return this.unsigned||this.high>=0},W.isOdd=function(){return(this.low&1)===1},W.isEven=function(){return(this.low&1)===0},W.equals=function(Y){return p(Y)||(Y=U(Y)),this.unsigned!==Y.unsigned&&this.high>>>31===1&&Y.high>>>31===1?!1:this.high===Y.high&&this.low===Y.low},W.eq=W.equals,W.notEquals=function(Y){return!this.eq(Y)},W.neq=W.notEquals,W.ne=W.notEquals,W.lessThan=function(Y){return this.comp(Y)<0},W.lt=W.lessThan,W.lessThanOrEqual=function(Y){return this.comp(Y)<=0},W.lte=W.lessThanOrEqual,W.le=W.lessThanOrEqual,W.greaterThan=function(Y){return this.comp(Y)>0},W.gt=W.greaterThan,W.greaterThanOrEqual=function(Y){return this.comp(Y)>=0},W.gte=W.greaterThanOrEqual,W.ge=W.greaterThanOrEqual,W.compare=function(Y){if(p(Y)||(Y=U(Y)),this.eq(Y))return 0;var oe=this.isNegative(),fe=Y.isNegative();return oe&&!fe?-1:!oe&&fe?1:this.unsigned?Y.high>>>0>this.high>>>0||Y.high===this.high&&Y.low>>>0>this.low>>>0?-1:1:this.sub(Y).isNegative()?-1:1},W.comp=W.compare,W.negate=function(){return!this.unsigned&&this.eq(G)?G:this.not().add(X)},W.neg=W.negate,W.add=function(Y){p(Y)||(Y=U(Y));var oe=this.high>>>16,fe=this.high&65535,pe=this.low>>>16,me=this.low&65535,v=Y.high>>>16,g=Y.high&65535,w=Y.low>>>16,ae=Y.low&65535,I=0,$=0,Z=0,le=0;return le+=me+ae,Z+=le>>>16,le&=65535,Z+=pe+w,$+=Z>>>16,Z&=65535,$+=fe+g,I+=$>>>16,$&=65535,I+=oe+v,I&=65535,C(Z<<16|le,I<<16|$,this.unsigned)},W.subtract=function(Y){return p(Y)||(Y=U(Y)),this.add(Y.neg())},W.sub=W.subtract,W.multiply=function(Y){if(this.isZero())return this;if(p(Y)||(Y=U(Y)),l){var oe=l.mul(this.low,this.high,Y.low,Y.high);return C(oe,l.get_high(),this.unsigned)}if(Y.isZero())return this.unsigned?ne:z;if(this.eq(G))return Y.isOdd()?G:z;if(Y.eq(G))return this.isOdd()?G:z;if(this.isNegative())return Y.isNegative()?this.neg().mul(Y.neg()):this.neg().mul(Y).neg();if(Y.isNegative())return this.mul(Y.neg()).neg();if(this.lt(ee)&&Y.lt(ee))return P(this.toNumber()*Y.toNumber(),this.unsigned);var fe=this.high>>>16,pe=this.high&65535,me=this.low>>>16,v=this.low&65535,g=Y.high>>>16,w=Y.high&65535,ae=Y.low>>>16,I=Y.low&65535,$=0,Z=0,le=0,de=0;return de+=v*I,le+=de>>>16,de&=65535,le+=me*I,Z+=le>>>16,le&=65535,le+=v*ae,Z+=le>>>16,le&=65535,Z+=pe*I,$+=Z>>>16,Z&=65535,Z+=me*ae,$+=Z>>>16,Z&=65535,Z+=v*w,$+=Z>>>16,Z&=65535,$+=fe*I+pe*ae+me*w+v*g,$&=65535,C(le<<16|de,$<<16|Z,this.unsigned)},W.mul=W.multiply,W.divide=function(Y){if(p(Y)||(Y=U(Y)),Y.isZero())throw Error("division by zero");if(l){if(!this.unsigned&&this.high===-2147483648&&Y.low===-1&&Y.high===-1)return this;var oe=(this.unsigned?l.div_u:l.div_s)(this.low,this.high,Y.low,Y.high);return C(oe,l.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?ne:z;var fe,pe,me;if(this.unsigned){if(Y.unsigned||(Y=Y.toUnsigned()),Y.gt(this))return ne;if(Y.gt(this.shru(1)))return M;me=ne}else{if(this.eq(G)){if(Y.eq(X)||Y.eq(K))return G;if(Y.eq(G))return X;var v=this.shr(1);return fe=v.div(Y).shl(1),fe.eq(z)?Y.isNegative()?X:K:(pe=this.sub(Y.mul(fe)),me=fe.add(pe.div(Y)),me)}else if(Y.eq(G))return this.unsigned?ne:z;if(this.isNegative())return Y.isNegative()?this.neg().div(Y.neg()):this.neg().div(Y).neg();if(Y.isNegative())return this.div(Y.neg()).neg();me=z}for(pe=this;pe.gte(Y);){fe=Math.max(1,Math.floor(pe.toNumber()/Y.toNumber()));for(var g=Math.ceil(Math.log(fe)/Math.LN2),w=g<=48?1:A(2,g-48),ae=P(fe),I=ae.mul(Y);I.isNegative()||I.gt(pe);)fe-=w,ae=P(fe,this.unsigned),I=ae.mul(Y);ae.isZero()&&(ae=X),me=me.add(ae),pe=pe.sub(I)}return me},W.div=W.divide,W.modulo=function(Y){if(p(Y)||(Y=U(Y)),l){var oe=(this.unsigned?l.rem_u:l.rem_s)(this.low,this.high,Y.low,Y.high);return C(oe,l.get_high(),this.unsigned)}return this.sub(this.div(Y).mul(Y))},W.mod=W.modulo,W.rem=W.modulo,W.not=function(){return C(~this.low,~this.high,this.unsigned)},W.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},W.clz=W.countLeadingZeros,W.countTrailingZeros=function(){return this.low?y(this.low):y(this.high)+32},W.ctz=W.countTrailingZeros,W.and=function(Y){return p(Y)||(Y=U(Y)),C(this.low&Y.low,this.high&Y.high,this.unsigned)},W.or=function(Y){return p(Y)||(Y=U(Y)),C(this.low|Y.low,this.high|Y.high,this.unsigned)},W.xor=function(Y){return p(Y)||(Y=U(Y)),C(this.low^Y.low,this.high^Y.high,this.unsigned)},W.shiftLeft=function(Y){return p(Y)&&(Y=Y.toInt()),(Y&=63)===0?this:Y<32?C(this.low<<Y,this.high<<Y|this.low>>>32-Y,this.unsigned):C(0,this.low<<Y-32,this.unsigned)},W.shl=W.shiftLeft,W.shiftRight=function(Y){return p(Y)&&(Y=Y.toInt()),(Y&=63)===0?this:Y<32?C(this.low>>>Y|this.high<<32-Y,this.high>>Y,this.unsigned):C(this.high>>Y-32,this.high>=0?0:-1,this.unsigned)},W.shr=W.shiftRight,W.shiftRightUnsigned=function(Y){return p(Y)&&(Y=Y.toInt()),(Y&=63)===0?this:Y<32?C(this.low>>>Y|this.high<<32-Y,this.high>>>Y,this.unsigned):Y===32?C(this.high,0,this.unsigned):C(this.high>>>Y-32,0,this.unsigned)},W.shru=W.shiftRightUnsigned,W.shr_u=W.shiftRightUnsigned,W.rotateLeft=function(Y){var oe;return p(Y)&&(Y=Y.toInt()),(Y&=63)===0?this:Y===32?C(this.high,this.low,this.unsigned):Y<32?(oe=32-Y,C(this.low<<Y|this.high>>>oe,this.high<<Y|this.low>>>oe,this.unsigned)):(Y-=32,oe=32-Y,C(this.high<<Y|this.low>>>oe,this.low<<Y|this.high>>>oe,this.unsigned))},W.rotl=W.rotateLeft,W.rotateRight=function(Y){var oe;return p(Y)&&(Y=Y.toInt()),(Y&=63)===0?this:Y===32?C(this.high,this.low,this.unsigned):Y<32?(oe=32-Y,C(this.high<<oe|this.low>>>Y,this.low<<oe|this.high>>>Y,this.unsigned)):(Y-=32,oe=32-Y,C(this.low<<oe|this.high>>>Y,this.high<<oe|this.low>>>Y,this.unsigned))},W.rotr=W.rotateRight,W.toSigned=function(){return this.unsigned?C(this.low,this.high,!1):this},W.toUnsigned=function(){return this.unsigned?this:C(this.low,this.high,!0)},W.toBytes=function(Y){return Y?this.toBytesLE():this.toBytesBE()},W.toBytesLE=function(){var Y=this.high,oe=this.low;return[oe&255,oe>>>8&255,oe>>>16&255,oe>>>24,Y&255,Y>>>8&255,Y>>>16&255,Y>>>24]},W.toBytesBE=function(){var Y=this.high,oe=this.low;return[Y>>>24,Y>>>16&255,Y>>>8&255,Y&255,oe>>>24,oe>>>16&255,oe>>>8&255,oe&255]},h.fromBytes=function(Y,oe,fe){return fe?h.fromBytesLE(Y,oe):h.fromBytesBE(Y,oe)},h.fromBytesLE=function(Y,oe){return new h(Y[0]|Y[1]<<8|Y[2]<<16|Y[3]<<24,Y[4]|Y[5]<<8|Y[6]<<16|Y[7]<<24,oe)},h.fromBytesBE=function(Y,oe){return new h(Y[4]<<24|Y[5]<<16|Y[6]<<8|Y[7],Y[0]<<24|Y[1]<<16|Y[2]<<8|Y[3],oe)};var ie=h;return c.default=ie,"default"in c?c.default:c}({});a.exports=d})(umd);var indexMinimal={},minimal$1={},aspromise=asPromise;function asPromise(a,s){for(var d=new Array(arguments.length-1),c=0,l=2,h=!0;l<arguments.length;)d[c++]=arguments[l++];return new Promise(function(y,_){d[c]=function(O){if(h)if(h=!1,O)_(O);else{for(var P=new Array(arguments.length-1),C=0;C<P.length;)P[C++]=arguments[C];y.apply(null,P)}};try{a.apply(s||null,d)}catch(E){h&&(h=!1,_(E))}})}var base64$1={};(function(a){var s=a;s.length=function(y){var _=y.length;if(!_)return 0;for(var E=0;--_%4>1&&y.charAt(_)==="=";)++E;return Math.ceil(y.length*3)/4-E};for(var d=new Array(64),c=new Array(123),l=0;l<64;)c[d[l]=l<26?l+65:l<52?l+71:l<62?l-4:l-59|43]=l++;s.encode=function(y,_,E){for(var O=null,P=[],C=0,A=0,q;_<E;){var U=y[_++];switch(A){case 0:P[C++]=d[U>>2],q=(U&3)<<4,A=1;break;case 1:P[C++]=d[q|U>>4],q=(U&15)<<2,A=2;break;case 2:P[C++]=d[q|U>>6],P[C++]=d[U&63],A=0;break}C>8191&&((O||(O=[])).push(String.fromCharCode.apply(String,P)),C=0)}return A&&(P[C++]=d[q],P[C++]=61,A===1&&(P[C++]=61)),O?(C&&O.push(String.fromCharCode.apply(String,P.slice(0,C))),O.join("")):String.fromCharCode.apply(String,P.slice(0,C))};var h="invalid encoding";s.decode=function(y,_,E){for(var O=E,P=0,C,A=0;A<y.length;){var q=y.charCodeAt(A++);if(q===61&&P>1)break;if((q=c[q])===void 0)throw Error(h);switch(P){case 0:C=q,P=1;break;case 1:_[E++]=C<<2|(q&48)>>4,C=q,P=2;break;case 2:_[E++]=(C&15)<<4|(q&60)>>2,C=q,P=3;break;case 3:_[E++]=(C&3)<<6|q,P=0;break}}if(P===1)throw Error(h);return E-O},s.test=function(y){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(y)}})(base64$1);var eventemitter=EventEmitter$1;function EventEmitter$1(){this._listeners={}}EventEmitter$1.prototype.on=function(s,d,c){return(this._listeners[s]||(this._listeners[s]=[])).push({fn:d,ctx:c||this}),this},EventEmitter$1.prototype.off=function(s,d){if(s===void 0)this._listeners={};else if(d===void 0)this._listeners[s]=[];else for(var c=this._listeners[s],l=0;l<c.length;)c[l].fn===d?c.splice(l,1):++l;return this},EventEmitter$1.prototype.emit=function(s){var d=this._listeners[s];if(d){for(var c=[],l=1;l<arguments.length;)c.push(arguments[l++]);for(l=0;l<d.length;)d[l].fn.apply(d[l++].ctx,c)}return this};var float=factory(factory);function factory(a){return typeof Float32Array!="undefined"?function(){var s=new Float32Array([-0]),d=new Uint8Array(s.buffer),c=d[3]===128;function l(_,E,O){s[0]=_,E[O]=d[0],E[O+1]=d[1],E[O+2]=d[2],E[O+3]=d[3]}function h(_,E,O){s[0]=_,E[O]=d[3],E[O+1]=d[2],E[O+2]=d[1],E[O+3]=d[0]}a.writeFloatLE=c?l:h,a.writeFloatBE=c?h:l;function p(_,E){return d[0]=_[E],d[1]=_[E+1],d[2]=_[E+2],d[3]=_[E+3],s[0]}function y(_,E){return d[3]=_[E],d[2]=_[E+1],d[1]=_[E+2],d[0]=_[E+3],s[0]}a.readFloatLE=c?p:y,a.readFloatBE=c?y:p}():function(){function s(c,l,h,p){var y=l<0?1:0;if(y&&(l=-l),l===0)c(1/l>0?0:2147483648,h,p);else if(isNaN(l))c(2143289344,h,p);else if(l>34028234663852886e22)c((y<<31|2139095040)>>>0,h,p);else if(l<11754943508222875e-54)c((y<<31|Math.round(l/1401298464324817e-60))>>>0,h,p);else{var _=Math.floor(Math.log(l)/Math.LN2),E=Math.round(l*Math.pow(2,-_)*8388608)&8388607;c((y<<31|_+127<<23|E)>>>0,h,p)}}a.writeFloatLE=s.bind(null,writeUintLE),a.writeFloatBE=s.bind(null,writeUintBE);function d(c,l,h){var p=c(l,h),y=(p>>31)*2+1,_=p>>>23&255,E=p&8388607;return _===255?E?NaN:y*(1/0):_===0?y*1401298464324817e-60*E:y*Math.pow(2,_-150)*(E+8388608)}a.readFloatLE=d.bind(null,readUintLE),a.readFloatBE=d.bind(null,readUintBE)}(),typeof Float64Array!="undefined"?function(){var s=new Float64Array([-0]),d=new Uint8Array(s.buffer),c=d[7]===128;function l(_,E,O){s[0]=_,E[O]=d[0],E[O+1]=d[1],E[O+2]=d[2],E[O+3]=d[3],E[O+4]=d[4],E[O+5]=d[5],E[O+6]=d[6],E[O+7]=d[7]}function h(_,E,O){s[0]=_,E[O]=d[7],E[O+1]=d[6],E[O+2]=d[5],E[O+3]=d[4],E[O+4]=d[3],E[O+5]=d[2],E[O+6]=d[1],E[O+7]=d[0]}a.writeDoubleLE=c?l:h,a.writeDoubleBE=c?h:l;function p(_,E){return d[0]=_[E],d[1]=_[E+1],d[2]=_[E+2],d[3]=_[E+3],d[4]=_[E+4],d[5]=_[E+5],d[6]=_[E+6],d[7]=_[E+7],s[0]}function y(_,E){return d[7]=_[E],d[6]=_[E+1],d[5]=_[E+2],d[4]=_[E+3],d[3]=_[E+4],d[2]=_[E+5],d[1]=_[E+6],d[0]=_[E+7],s[0]}a.readDoubleLE=c?p:y,a.readDoubleBE=c?y:p}():function(){function s(c,l,h,p,y,_){var E=p<0?1:0;if(E&&(p=-p),p===0)c(0,y,_+l),c(1/p>0?0:2147483648,y,_+h);else if(isNaN(p))c(0,y,_+l),c(2146959360,y,_+h);else if(p>17976931348623157e292)c(0,y,_+l),c((E<<31|2146435072)>>>0,y,_+h);else{var O;if(p<22250738585072014e-324)O=p/5e-324,c(O>>>0,y,_+l),c((E<<31|O/4294967296)>>>0,y,_+h);else{var P=Math.floor(Math.log(p)/Math.LN2);P===1024&&(P=1023),O=p*Math.pow(2,-P),c(O*4503599627370496>>>0,y,_+l),c((E<<31|P+1023<<20|O*1048576&1048575)>>>0,y,_+h)}}}a.writeDoubleLE=s.bind(null,writeUintLE,0,4),a.writeDoubleBE=s.bind(null,writeUintBE,4,0);function d(c,l,h,p,y){var _=c(p,y+l),E=c(p,y+h),O=(E>>31)*2+1,P=E>>>20&2047,C=4294967296*(E&1048575)+_;return P===2047?C?NaN:O*(1/0):P===0?O*5e-324*C:O*Math.pow(2,P-1075)*(C+4503599627370496)}a.readDoubleLE=d.bind(null,readUintLE,0,4),a.readDoubleBE=d.bind(null,readUintBE,4,0)}(),a}function writeUintLE(a,s,d){s[d]=a&255,s[d+1]=a>>>8&255,s[d+2]=a>>>16&255,s[d+3]=a>>>24}function writeUintBE(a,s,d){s[d]=a>>>24,s[d+1]=a>>>16&255,s[d+2]=a>>>8&255,s[d+3]=a&255}function readUintLE(a,s){return(a[s]|a[s+1]<<8|a[s+2]<<16|a[s+3]<<24)>>>0}function readUintBE(a,s){return(a[s]<<24|a[s+1]<<16|a[s+2]<<8|a[s+3])>>>0}var inquire_1=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(a){}return null}var utf8$2={};(function(a){var s=a;s.length=function(c){for(var l=0,h=0,p=0;p<c.length;++p)h=c.charCodeAt(p),h<128?l+=1:h<2048?l+=2:(h&64512)===55296&&(c.charCodeAt(p+1)&64512)===56320?(++p,l+=4):l+=3;return l},s.read=function(c,l,h){var p=h-l;if(p<1)return"";for(var y=null,_=[],E=0,O;l<h;)O=c[l++],O<128?_[E++]=O:O>191&&O<224?_[E++]=(O&31)<<6|c[l++]&63:O>239&&O<365?(O=((O&7)<<18|(c[l++]&63)<<12|(c[l++]&63)<<6|c[l++]&63)-65536,_[E++]=55296+(O>>10),_[E++]=56320+(O&1023)):_[E++]=(O&15)<<12|(c[l++]&63)<<6|c[l++]&63,E>8191&&((y||(y=[])).push(String.fromCharCode.apply(String,_)),E=0);return y?(E&&y.push(String.fromCharCode.apply(String,_.slice(0,E))),y.join("")):String.fromCharCode.apply(String,_.slice(0,E))},s.write=function(c,l,h){for(var p=h,y,_,E=0;E<c.length;++E)y=c.charCodeAt(E),y<128?l[h++]=y:y<2048?(l[h++]=y>>6|192,l[h++]=y&63|128):(y&64512)===55296&&((_=c.charCodeAt(E+1))&64512)===56320?(y=65536+((y&1023)<<10)+(_&1023),++E,l[h++]=y>>18|240,l[h++]=y>>12&63|128,l[h++]=y>>6&63|128,l[h++]=y&63|128):(l[h++]=y>>12|224,l[h++]=y>>6&63|128,l[h++]=y&63|128);return h-p}})(utf8$2);var pool_1=pool;function pool(a,s,d){var c=d||8192,l=c>>>1,h=null,p=c;return function(_){if(_<1||_>l)return a(_);p+_>c&&(h=a(c),p=0);var E=s.call(h,p,p+=_);return p&7&&(p=(p|7)+1),E}}var longbits=LongBits$2,util$5=minimal$1;function LongBits$2(a,s){this.lo=a>>>0,this.hi=s>>>0}var zero=LongBits$2.zero=new LongBits$2(0,0);zero.toNumber=function(){return 0},zero.zzEncode=zero.zzDecode=function(){return this},zero.length=function(){return 1};var zeroHash=LongBits$2.zeroHash="\0\0\0\0\0\0\0\0";LongBits$2.fromNumber=function a(s){if(s===0)return zero;var d=s<0;d&&(s=-s);var c=s>>>0,l=(s-c)/4294967296>>>0;return d&&(l=~l>>>0,c=~c>>>0,++c>4294967295&&(c=0,++l>4294967295&&(l=0))),new LongBits$2(c,l)},LongBits$2.from=function a(s){if(typeof s=="number")return LongBits$2.fromNumber(s);if(util$5.isString(s))if(util$5.Long)s=util$5.Long.fromString(s);else return LongBits$2.fromNumber(parseInt(s,10));return s.low||s.high?new LongBits$2(s.low>>>0,s.high>>>0):zero},LongBits$2.prototype.toNumber=function a(s){if(!s&&this.hi>>>31){var d=~this.lo+1>>>0,c=~this.hi>>>0;return d||(c=c+1>>>0),-(d+c*4294967296)}return this.lo+this.hi*4294967296},LongBits$2.prototype.toLong=function a(s){return util$5.Long?new util$5.Long(this.lo|0,this.hi|0,Boolean(s)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(s)}};var charCodeAt=String.prototype.charCodeAt;LongBits$2.fromHash=function a(s){return s===zeroHash?zero:new LongBits$2((charCodeAt.call(s,0)|charCodeAt.call(s,1)<<8|charCodeAt.call(s,2)<<16|charCodeAt.call(s,3)<<24)>>>0,(charCodeAt.call(s,4)|charCodeAt.call(s,5)<<8|charCodeAt.call(s,6)<<16|charCodeAt.call(s,7)<<24)>>>0)},LongBits$2.prototype.toHash=function a(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},LongBits$2.prototype.zzEncode=function a(){var s=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^s)>>>0,this.lo=(this.lo<<1^s)>>>0,this},LongBits$2.prototype.zzDecode=function a(){var s=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^s)>>>0,this.hi=(this.hi>>>1^s)>>>0,this},LongBits$2.prototype.length=function a(){var s=this.lo,d=(this.lo>>>28|this.hi<<4)>>>0,c=this.hi>>>24;return c===0?d===0?s<16384?s<128?1:2:s<2097152?3:4:d<16384?d<128?5:6:d<2097152?7:8:c<128?9:10},function(a){var s=a;s.asPromise=aspromise,s.base64=base64$1,s.EventEmitter=eventemitter,s.float=float,s.inquire=inquire_1,s.utf8=utf8$2,s.pool=pool_1,s.LongBits=longbits,s.isNode=Boolean(typeof commonjsGlobal!="undefined"&&commonjsGlobal&&commonjsGlobal.process&&commonjsGlobal.process.versions&&commonjsGlobal.process.versions.node),s.global=s.isNode&&commonjsGlobal||typeof window!="undefined"&&window||typeof self!="undefined"&&self||commonjsGlobal,s.emptyArray=Object.freeze?Object.freeze([]):[],s.emptyObject=Object.freeze?Object.freeze({}):{},s.isInteger=Number.isInteger||function(h){return typeof h=="number"&&isFinite(h)&&Math.floor(h)===h},s.isString=function(h){return typeof h=="string"||h instanceof String},s.isObject=function(h){return h&&typeof h=="object"},s.isset=s.isSet=function(h,p){var y=h[p];return y!=null&&h.hasOwnProperty(p)?typeof y!="object"||(Array.isArray(y)?y.length:Object.keys(y).length)>0:!1},s.Buffer=function(){try{var l=s.inquire("buffer").Buffer;return l.prototype.utf8Write?l:null}catch{return null}}(),s._Buffer_from=null,s._Buffer_allocUnsafe=null,s.newBuffer=function(h){return typeof h=="number"?s.Buffer?s._Buffer_allocUnsafe(h):new s.Array(h):s.Buffer?s._Buffer_from(h):typeof Uint8Array=="undefined"?h:new Uint8Array(h)},s.Array=typeof Uint8Array!="undefined"?Uint8Array:Array,s.Long=s.global.dcodeIO&&s.global.dcodeIO.Long||s.global.Long||s.inquire("long"),s.key2Re=/^true|false|0|1$/,s.key32Re=/^-?(?:0|[1-9][0-9]*)$/,s.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,s.longToHash=function(h){return h?s.LongBits.from(h).toHash():s.LongBits.zeroHash},s.longFromHash=function(h,p){var y=s.LongBits.fromHash(h);return s.Long?s.Long.fromBits(y.lo,y.hi,p):y.toNumber(Boolean(p))};function d(l,h,p){for(var y=Object.keys(h),_=0;_<y.length;++_)(l[y[_]]===void 0||!p)&&(l[y[_]]=h[y[_]]);return l}s.merge=d,s.lcFirst=function(h){return h.charAt(0).toLowerCase()+h.substring(1)};function c(l){function h(p,y){if(!(this instanceof h))return new h(p,y);Object.defineProperty(this,"message",{get:function(){return p}}),Error.captureStackTrace?Error.captureStackTrace(this,h):Object.defineProperty(this,"stack",{value:new Error().stack||""}),y&&d(this,y)}return(h.prototype=Object.create(Error.prototype)).constructor=h,Object.defineProperty(h.prototype,"name",{get:function(){return l}}),h.prototype.toString=function(){return this.name+": "+this.message},h}s.newError=c,s.ProtocolError=c("ProtocolError"),s.oneOfGetter=function(h){for(var p={},y=0;y<h.length;++y)p[h[y]]=1;return function(){for(var _=Object.keys(this),E=_.length-1;E>-1;--E)if(p[_[E]]===1&&this[_[E]]!==void 0&&this[_[E]]!==null)return _[E]}},s.oneOfSetter=function(h){return function(p){for(var y=0;y<h.length;++y)h[y]!==p&&delete this[h[y]]}},s.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},s._configure=function(){var l=s.Buffer;if(!l){s._Buffer_from=s._Buffer_allocUnsafe=null;return}s._Buffer_from=l.from!==Uint8Array.from&&l.from||function(p,y){return new l(p,y)},s._Buffer_allocUnsafe=l.allocUnsafe||function(p){return new l(p)}}}(minimal$1);var writer=Writer$1,util$4=minimal$1,BufferWriter$1,LongBits$1=util$4.LongBits,base64=util$4.base64,utf8$1=util$4.utf8;function Op(a,s,d){this.fn=a,this.len=s,this.next=void 0,this.val=d}function noop$2(){}function State(a){this.head=a.head,this.tail=a.tail,this.len=a.len,this.next=a.states}function Writer$1(){this.len=0,this.head=new Op(noop$2,0,0),this.tail=this.head,this.states=null}var create$4=function a(){return util$4.Buffer?function(){return(Writer$1.create=function(){return new BufferWriter$1})()}:function(){return new Writer$1}};Writer$1.create=create$4(),Writer$1.alloc=function a(s){return new util$4.Array(s)},util$4.Array!==Array&&(Writer$1.alloc=util$4.pool(Writer$1.alloc,util$4.Array.prototype.subarray)),Writer$1.prototype._push=function a(s,d,c){return this.tail=this.tail.next=new Op(s,d,c),this.len+=d,this};function writeByte(a,s,d){s[d]=a&255}function writeVarint32(a,s,d){for(;a>127;)s[d++]=a&127|128,a>>>=7;s[d]=a}function VarintOp(a,s){this.len=a,this.next=void 0,this.val=s}VarintOp.prototype=Object.create(Op.prototype),VarintOp.prototype.fn=writeVarint32,Writer$1.prototype.uint32=function a(s){return this.len+=(this.tail=this.tail.next=new VarintOp((s=s>>>0)<128?1:s<16384?2:s<2097152?3:s<268435456?4:5,s)).len,this},Writer$1.prototype.int32=function a(s){return s<0?this._push(writeVarint64,10,LongBits$1.fromNumber(s)):this.uint32(s)},Writer$1.prototype.sint32=function a(s){return this.uint32((s<<1^s>>31)>>>0)};function writeVarint64(a,s,d){for(;a.hi;)s[d++]=a.lo&127|128,a.lo=(a.lo>>>7|a.hi<<25)>>>0,a.hi>>>=7;for(;a.lo>127;)s[d++]=a.lo&127|128,a.lo=a.lo>>>7;s[d++]=a.lo}Writer$1.prototype.uint64=function a(s){var d=LongBits$1.from(s);return this._push(writeVarint64,d.length(),d)},Writer$1.prototype.int64=Writer$1.prototype.uint64,Writer$1.prototype.sint64=function a(s){var d=LongBits$1.from(s).zzEncode();return this._push(writeVarint64,d.length(),d)},Writer$1.prototype.bool=function a(s){return this._push(writeByte,1,s?1:0)};function writeFixed32(a,s,d){s[d]=a&255,s[d+1]=a>>>8&255,s[d+2]=a>>>16&255,s[d+3]=a>>>24}Writer$1.prototype.fixed32=function a(s){return this._push(writeFixed32,4,s>>>0)},Writer$1.prototype.sfixed32=Writer$1.prototype.fixed32,Writer$1.prototype.fixed64=function a(s){var d=LongBits$1.from(s);return this._push(writeFixed32,4,d.lo)._push(writeFixed32,4,d.hi)},Writer$1.prototype.sfixed64=Writer$1.prototype.fixed64,Writer$1.prototype.float=function a(s){return this._push(util$4.float.writeFloatLE,4,s)},Writer$1.prototype.double=function a(s){return this._push(util$4.float.writeDoubleLE,8,s)};var writeBytes=util$4.Array.prototype.set?function a(s,d,c){d.set(s,c)}:function a(s,d,c){for(var l=0;l<s.length;++l)d[c+l]=s[l]};Writer$1.prototype.bytes=function a(s){var d=s.length>>>0;if(!d)return this._push(writeByte,1,0);if(util$4.isString(s)){var c=Writer$1.alloc(d=base64.length(s));base64.decode(s,c,0),s=c}return this.uint32(d)._push(writeBytes,d,s)},Writer$1.prototype.string=function a(s){var d=utf8$1.length(s);return d?this.uint32(d)._push(utf8$1.write,d,s):this._push(writeByte,1,0)},Writer$1.prototype.fork=function a(){return this.states=new State(this),this.head=this.tail=new Op(noop$2,0,0),this.len=0,this},Writer$1.prototype.reset=function a(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Op(noop$2,0,0),this.len=0),this},Writer$1.prototype.ldelim=function a(){var s=this.head,d=this.tail,c=this.len;return this.reset().uint32(c),c&&(this.tail.next=s.next,this.tail=d,this.len+=c),this},Writer$1.prototype.finish=function a(){for(var s=this.head.next,d=this.constructor.alloc(this.len),c=0;s;)s.fn(s.val,d,c),c+=s.len,s=s.next;return d},Writer$1._configure=function(a){BufferWriter$1=a,Writer$1.create=create$4(),BufferWriter$1._configure()};var writer_buffer=BufferWriter,Writer=writer;(BufferWriter.prototype=Object.create(Writer.prototype)).constructor=BufferWriter;var util$3=minimal$1;function BufferWriter(){Writer.call(this)}BufferWriter._configure=function(){BufferWriter.alloc=util$3._Buffer_allocUnsafe,BufferWriter.writeBytesBuffer=util$3.Buffer&&util$3.Buffer.prototype instanceof Uint8Array&&util$3.Buffer.prototype.set.name==="set"?function(s,d,c){d.set(s,c)}:function(s,d,c){if(s.copy)s.copy(d,c,0,s.length);else for(var l=0;l<s.length;)d[c++]=s[l++]}},BufferWriter.prototype.bytes=function a(s){util$3.isString(s)&&(s=util$3._Buffer_from(s,"base64"));var d=s.length>>>0;return this.uint32(d),d&&this._push(BufferWriter.writeBytesBuffer,d,s),this};function writeStringBuffer(a,s,d){a.length<40?util$3.utf8.write(a,s,d):s.utf8Write?s.utf8Write(a,d):s.write(a,d)}BufferWriter.prototype.string=function a(s){var d=util$3.Buffer.byteLength(s);return this.uint32(d),d&&this._push(writeStringBuffer,d,s),this},BufferWriter._configure();var reader=Reader$1,util$2=minimal$1,BufferReader$1,LongBits=util$2.LongBits,utf8=util$2.utf8;function indexOutOfRange(a,s){return RangeError("index out of range: "+a.pos+" + "+(s||1)+" > "+a.len)}function Reader$1(a){this.buf=a,this.pos=0,this.len=a.length}var create_array=typeof Uint8Array!="undefined"?function a(s){if(s instanceof Uint8Array||Array.isArray(s))return new Reader$1(s);throw Error("illegal buffer")}:function a(s){if(Array.isArray(s))return new Reader$1(s);throw Error("illegal buffer")},create$3=function a(){return util$2.Buffer?function(d){return(Reader$1.create=function(l){return util$2.Buffer.isBuffer(l)?new BufferReader$1(l):create_array(l)})(d)}:create_array};Reader$1.create=create$3(),Reader$1.prototype._slice=util$2.Array.prototype.subarray||util$2.Array.prototype.slice,Reader$1.prototype.uint32=function a(){var s=4294967295;return function(){if(s=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(s=(s|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(s=(s|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(s=(s|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(s=(s|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return s;if((this.pos+=5)>this.len)throw this.pos=this.len,indexOutOfRange(this,10);return s}}(),Reader$1.prototype.int32=function a(){return this.uint32()|0},Reader$1.prototype.sint32=function a(){var s=this.uint32();return s>>>1^-(s&1)|0};function readLongVarint(){var a=new LongBits(0,0),s=0;if(this.len-this.pos>4){for(;s<4;++s)if(a.lo=(a.lo|(this.buf[this.pos]&127)<<s*7)>>>0,this.buf[this.pos++]<128)return a;if(a.lo=(a.lo|(this.buf[this.pos]&127)<<28)>>>0,a.hi=(a.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return a;s=0}else{for(;s<3;++s){if(this.pos>=this.len)throw indexOutOfRange(this);if(a.lo=(a.lo|(this.buf[this.pos]&127)<<s*7)>>>0,this.buf[this.pos++]<128)return a}return a.lo=(a.lo|(this.buf[this.pos++]&127)<<s*7)>>>0,a}if(this.len-this.pos>4){for(;s<5;++s)if(a.hi=(a.hi|(this.buf[this.pos]&127)<<s*7+3)>>>0,this.buf[this.pos++]<128)return a}else for(;s<5;++s){if(this.pos>=this.len)throw indexOutOfRange(this);if(a.hi=(a.hi|(this.buf[this.pos]&127)<<s*7+3)>>>0,this.buf[this.pos++]<128)return a}throw Error("invalid varint encoding")}Reader$1.prototype.bool=function a(){return this.uint32()!==0};function readFixed32_end(a,s){return(a[s-4]|a[s-3]<<8|a[s-2]<<16|a[s-1]<<24)>>>0}Reader$1.prototype.fixed32=function a(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)},Reader$1.prototype.sfixed32=function a(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)|0};function readFixed64(){if(this.pos+8>this.len)throw indexOutOfRange(this,8);return new LongBits(readFixed32_end(this.buf,this.pos+=4),readFixed32_end(this.buf,this.pos+=4))}Reader$1.prototype.float=function a(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);var s=util$2.float.readFloatLE(this.buf,this.pos);return this.pos+=4,s},Reader$1.prototype.double=function a(){if(this.pos+8>this.len)throw indexOutOfRange(this,4);var s=util$2.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,s},Reader$1.prototype.bytes=function a(){var s=this.uint32(),d=this.pos,c=this.pos+s;if(c>this.len)throw indexOutOfRange(this,s);return this.pos+=s,Array.isArray(this.buf)?this.buf.slice(d,c):d===c?new this.buf.constructor(0):this._slice.call(this.buf,d,c)},Reader$1.prototype.string=function a(){var s=this.bytes();return utf8.read(s,0,s.length)},Reader$1.prototype.skip=function a(s){if(typeof s=="number"){if(this.pos+s>this.len)throw indexOutOfRange(this,s);this.pos+=s}else do if(this.pos>=this.len)throw indexOutOfRange(this);while(this.buf[this.pos++]&128);return this},Reader$1.prototype.skipType=function(a){switch(a){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(a=this.uint32()&7)!==4;)this.skipType(a);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+a+" at offset "+this.pos)}return this},Reader$1._configure=function(a){BufferReader$1=a,Reader$1.create=create$3(),BufferReader$1._configure();var s=util$2.Long?"toLong":"toNumber";util$2.merge(Reader$1.prototype,{int64:function(){return readLongVarint.call(this)[s](!1)},uint64:function(){return readLongVarint.call(this)[s](!0)},sint64:function(){return readLongVarint.call(this).zzDecode()[s](!1)},fixed64:function(){return readFixed64.call(this)[s](!0)},sfixed64:function(){return readFixed64.call(this)[s](!1)}})};var reader_buffer=BufferReader,Reader=reader;(BufferReader.prototype=Object.create(Reader.prototype)).constructor=BufferReader;var util$1=minimal$1;function BufferReader(a){Reader.call(this,a)}BufferReader._configure=function(){util$1.Buffer&&(BufferReader.prototype._slice=util$1.Buffer.prototype.slice)},BufferReader.prototype.string=function a(){var s=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+s,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+s,this.len))},BufferReader._configure();var rpc={},service=Service,util=minimal$1;(Service.prototype=Object.create(util.EventEmitter.prototype)).constructor=Service;function Service(a,s,d){if(typeof a!="function")throw TypeError("rpcImpl must be a function");util.EventEmitter.call(this),this.rpcImpl=a,this.requestDelimited=Boolean(s),this.responseDelimited=Boolean(d)}Service.prototype.rpcCall=function a(s,d,c,l,h){if(!l)throw TypeError("request must be specified");var p=this;if(!h)return util.asPromise(a,p,s,d,c,l);if(!p.rpcImpl){setTimeout(function(){h(Error("already ended"))},0);return}try{return p.rpcImpl(s,d[p.requestDelimited?"encodeDelimited":"encode"](l).finish(),function(_,E){if(_)return p.emit("error",_,s),h(_);if(E===null){p.end(!0);return}if(!(E instanceof c))try{E=c[p.responseDelimited?"decodeDelimited":"decode"](E)}catch(O){return p.emit("error",O,s),h(O)}return p.emit("data",E,s),h(null,E)})}catch(y){p.emit("error",y,s),setTimeout(function(){h(y)},0);return}},Service.prototype.end=function a(s){return this.rpcImpl&&(s||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this},function(a){var s=a;s.Service=service}(rpc);var roots={};(function(a){var s=a;s.build="minimal",s.Writer=writer,s.BufferWriter=writer_buffer,s.Reader=reader,s.BufferReader=reader_buffer,s.util=minimal$1,s.rpc=rpc,s.roots=roots,s.configure=d;function d(){s.util._configure(),s.Writer._configure(s.BufferWriter),s.Reader._configure(s.BufferReader)}d()})(indexMinimal);var minimal=indexMinimal,struct$2={};(function(a){var s=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(T,D,J,ee){ee===void 0&&(ee=J),Object.defineProperty(T,ee,{enumerable:!0,get:function(){return D[J]}})}:function(T,D,J,ee){ee===void 0&&(ee=J),T[ee]=D[J]}),d=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(T,D){Object.defineProperty(T,"default",{enumerable:!0,value:D})}:function(T,D){T.default=D}),c=commonjsGlobal&&commonjsGlobal.__importStar||function(T){if(T&&T.__esModule)return T;var D={};if(T!=null)for(var J in T)J!=="default"&&Object.hasOwnProperty.call(T,J)&&s(D,T,J);return d(D,T),D},l=commonjsGlobal&&commonjsGlobal.__importDefault||function(T){return T&&T.__esModule?T:{default:T}};Object.defineProperty(a,"__esModule",{value:!0}),a.ListValue=a.Value=a.Struct_FieldsEntry=a.Struct=a.nullValueToNumber=a.nullValueToJSON=a.nullValueFromJSON=a.NullValue=a.protobufPackage=void 0;const h=l(umd.exports),p=c(minimal);a.protobufPackage="google.protobuf";var y;(function(T){T.NULL_VALUE="NULL_VALUE"})(y=a.NullValue||(a.NullValue={}));function _(T){switch(T){case 0:case"NULL_VALUE":return y.NULL_VALUE;default:throw new U.Error("Unrecognized enum value "+T+" for enum NullValue")}}a.nullValueFromJSON=_;function E(T){switch(T){case y.NULL_VALUE:return"NULL_VALUE";default:return"UNKNOWN"}}a.nullValueToJSON=E;function O(T){switch(T){case y.NULL_VALUE:return 0;default:return 0}}a.nullValueToNumber=O;function P(){return{fields:{}}}a.Struct={encode(T,D=p.Writer.create()){return Object.entries(T.fields).forEach(([J,ee])=>{ee!==void 0&&a.Struct_FieldsEntry.encode({key:J,value:ee},D.uint32(10).fork()).ldelim()}),D},decode(T,D){const J=T instanceof p.Reader?T:new p.Reader(T);let ee=D===void 0?J.len:J.pos+D;const z=P();for(;J.pos<ee;){const ne=J.uint32();switch(ne>>>3){case 1:const X=a.Struct_FieldsEntry.decode(J,J.uint32());X.value!==void 0&&(z.fields[X.key]=X.value);break;default:J.skipType(ne&7);break}}return z},fromJSON(T){return{fields:F(T.fields)?Object.entries(T.fields).reduce((D,[J,ee])=>(D[J]=ee,D),{}):{}}},toJSON(T){const D={};return D.fields={},T.fields&&Object.entries(T.fields).forEach(([J,ee])=>{D.fields[J]=ee}),D},fromPartial(T){var D;const J=P();return J.fields=Object.entries((D=T.fields)!==null&&D!==void 0?D:{}).reduce((ee,[z,ne])=>(ne!==void 0&&(ee[z]=ne),ee),{}),J},wrap(T){const D=P();return T!==void 0&&Object.keys(T).forEach(J=>{D.fields[J]=T[J]}),D},unwrap(T){const D={};return Object.keys(T.fields).forEach(J=>{D[J]=T.fields[J]}),D}};function C(){return{key:"",value:void 0}}a.Struct_FieldsEntry={encode(T,D=p.Writer.create()){return T.key!==""&&D.uint32(10).string(T.key),T.value!==void 0&&a.Value.encode(a.Value.wrap(T.value),D.uint32(18).fork()).ldelim(),D},decode(T,D){const J=T instanceof p.Reader?T:new p.Reader(T);let ee=D===void 0?J.len:J.pos+D;const z=C();for(;J.pos<ee;){const ne=J.uint32();switch(ne>>>3){case 1:z.key=J.string();break;case 2:z.value=a.Value.unwrap(a.Value.decode(J,J.uint32()));break;default:J.skipType(ne&7);break}}return z},fromJSON(T){return{key:j(T.key)?String(T.key):"",value:j(T==null?void 0:T.value)?T.value:void 0}},toJSON(T){const D={};return T.key!==void 0&&(D.key=T.key),T.value!==void 0&&(D.value=T.value),D},fromPartial(T){var D,J;const ee=C();return ee.key=(D=T.key)!==null&&D!==void 0?D:"",ee.value=(J=T.value)!==null&&J!==void 0?J:void 0,ee}};function A(){return{nullValue:void 0,numberValue:void 0,stringValue:void 0,boolValue:void 0,structValue:void 0,listValue:void 0}}a.Value={encode(T,D=p.Writer.create()){return T.nullValue!==void 0&&D.uint32(8).int32(O(T.nullValue)),T.numberValue!==void 0&&D.uint32(17).double(T.numberValue),T.stringValue!==void 0&&D.uint32(26).string(T.stringValue),T.boolValue!==void 0&&D.uint32(32).bool(T.boolValue),T.structValue!==void 0&&a.Struct.encode(a.Struct.wrap(T.structValue),D.uint32(42).fork()).ldelim(),T.listValue!==void 0&&a.ListValue.encode(a.ListValue.wrap(T.listValue),D.uint32(50).fork()).ldelim(),D},decode(T,D){const J=T instanceof p.Reader?T:new p.Reader(T);let ee=D===void 0?J.len:J.pos+D;const z=A();for(;J.pos<ee;){const ne=J.uint32();switch(ne>>>3){case 1:z.nullValue=_(J.int32());break;case 2:z.numberValue=J.double();break;case 3:z.stringValue=J.string();break;case 4:z.boolValue=J.bool();break;case 5:z.structValue=a.Struct.unwrap(a.Struct.decode(J,J.uint32()));break;case 6:z.listValue=a.ListValue.unwrap(a.ListValue.decode(J,J.uint32()));break;default:J.skipType(ne&7);break}}return z},fromJSON(T){return{nullValue:j(T.nullValue)?_(T.nullValue):void 0,numberValue:j(T.numberValue)?Number(T.numberValue):void 0,stringValue:j(T.stringValue)?String(T.stringValue):void 0,boolValue:j(T.boolValue)?Boolean(T.boolValue):void 0,structValue:F(T.structValue)?T.structValue:void 0,listValue:Array.isArray(T.listValue)?[...T.listValue]:void 0}},toJSON(T){const D={};return T.nullValue!==void 0&&(D.nullValue=T.nullValue!==void 0?E(T.nullValue):void 0),T.numberValue!==void 0&&(D.numberValue=T.numberValue),T.stringValue!==void 0&&(D.stringValue=T.stringValue),T.boolValue!==void 0&&(D.boolValue=T.boolValue),T.structValue!==void 0&&(D.structValue=T.structValue),T.listValue!==void 0&&(D.listValue=T.listValue),D},fromPartial(T){var D,J,ee,z,ne,X;const M=A();return M.nullValue=(D=T.nullValue)!==null&&D!==void 0?D:void 0,M.numberValue=(J=T.numberValue)!==null&&J!==void 0?J:void 0,M.stringValue=(ee=T.stringValue)!==null&&ee!==void 0?ee:void 0,M.boolValue=(z=T.boolValue)!==null&&z!==void 0?z:void 0,M.structValue=(ne=T.structValue)!==null&&ne!==void 0?ne:void 0,M.listValue=(X=T.listValue)!==null&&X!==void 0?X:void 0,M},wrap(T){const D=A();if(T===null)D.nullValue=y.NULL_VALUE;else if(typeof T=="boolean")D.boolValue=T;else if(typeof T=="number")D.numberValue=T;else if(typeof T=="string")D.stringValue=T;else if(Array.isArray(T))D.listValue=T;else if(typeof T=="object")D.structValue=T;else if(typeof T!="undefined")throw new Error("Unsupported any value type: "+typeof T);return D},unwrap(T){if((T==null?void 0:T.stringValue)!==void 0)return T.stringValue;if((T==null?void 0:T.numberValue)!==void 0)return T.numberValue;if((T==null?void 0:T.boolValue)!==void 0)return T.boolValue;if((T==null?void 0:T.structValue)!==void 0)return T.structValue;if((T==null?void 0:T.listValue)!==void 0)return T.listValue;if((T==null?void 0:T.nullValue)!==void 0)return null}};function q(){return{values:[]}}a.ListValue={encode(T,D=p.Writer.create()){for(const J of T.values)a.Value.encode(a.Value.wrap(J),D.uint32(10).fork()).ldelim();return D},decode(T,D){const J=T instanceof p.Reader?T:new p.Reader(T);let ee=D===void 0?J.len:J.pos+D;const z=q();for(;J.pos<ee;){const ne=J.uint32();switch(ne>>>3){case 1:z.values.push(a.Value.unwrap(a.Value.decode(J,J.uint32())));break;default:J.skipType(ne&7);break}}return z},fromJSON(T){return{values:Array.isArray(T==null?void 0:T.values)?[...T.values]:[]}},toJSON(T){const D={};return T.values?D.values=T.values.map(J=>J):D.values=[],D},fromPartial(T){var D;const J=q();return J.values=((D=T.values)===null||D===void 0?void 0:D.map(ee=>ee))||[],J},wrap(T){const D=q();return D.values=T!=null?T:[],D},unwrap(T){return T.values}};var U=(()=>{if(typeof U!="undefined")return U;if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof commonjsGlobal!="undefined")return commonjsGlobal;throw"Unable to locate global object"})();p.util.Long!==h.default&&(p.util.Long=h.default,p.configure());function F(T){return typeof T=="object"&&T!==null}function j(T){return T!=null}})(struct$2),function(a){var s=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(b,N,V,se){se===void 0&&(se=V),Object.defineProperty(b,se,{enumerable:!0,get:function(){return N[V]}})}:function(b,N,V,se){se===void 0&&(se=V),b[se]=N[V]}),d=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(b,N){Object.defineProperty(b,"default",{enumerable:!0,value:N})}:function(b,N){b.default=N}),c=commonjsGlobal&&commonjsGlobal.__importStar||function(b){if(b&&b.__esModule)return b;var N={};if(b!=null)for(var V in b)V!=="default"&&Object.hasOwnProperty.call(b,V)&&s(N,b,V);return d(N,b),N},l=commonjsGlobal&&commonjsGlobal.__importDefault||function(b){return b&&b.__esModule?b:{default:b}};Object.defineProperty(a,"__esModule",{value:!0}),a.LayoutServiceDefinition=a.LayoutServiceClientImpl=a.LayerServiceDefinition=a.LayerServiceClientImpl=a.Event=a.LayerEvent=a.LayoutEvent=a.BatchLayerRequest_BatchItem=a.BatchLayerRequest=a.BatchDeleteLayerRequest=a.DeleteLayerPayload=a.UpdateLayerRequest=a.GetLayerRequest=a.CreateLayerRequest=a.ListLayersResponse=a.ListLayersRequest=a.PartialLayerWithID=a.PartialLayer=a.LayerAnimation=a.DeleteLayoutResponse=a.DeleteLayoutRequest=a.DeleteLayoutPayload=a.UpdateLayoutRequest=a.GetLayoutRequest=a.CreateLayoutRequest=a.ListLayoutsResponse=a.ListLayoutsRequest=a.PartialLayout=a.BatchLayerResponse_BatchLayerItem=a.BatchLayerResponse=a.DeleteLayerResponse=a.DeleteLayerRequest=a.Layer=a.Layout=a.Transition_TransitionStinger=a.Transition_TransitionStingerCut=a.Transition_TransitionSwipe=a.Transition_TransitionCrossfade=a.Transition_TransitionFadeToColor=a.Transition_TransitionCut=a.Transition_TransitionMediaType=a.Transition=a.transition_TransitionSwipeTypeToNumber=a.transition_TransitionSwipeTypeToJSON=a.transition_TransitionSwipeTypeFromJSON=a.Transition_TransitionSwipeType=a.transition_TransitionDirectionToNumber=a.transition_TransitionDirectionToJSON=a.transition_TransitionDirectionFromJSON=a.Transition_TransitionDirection=a.eventTypeToNumber=a.eventTypeToJSON=a.eventTypeFromJSON=a.EventType=a.eventSubTypeToNumber=a.eventSubTypeToJSON=a.eventSubTypeFromJSON=a.EventSubType=a.requestAnimationModeToNumber=a.requestAnimationModeToJSON=a.requestAnimationModeFromJSON=a.RequestAnimationMode=a.layoutTypeToNumber=a.layoutTypeToJSON=a.layoutTypeFromJSON=a.LayoutType=a.protobufPackage=void 0;const h=l(umd.exports),p=c(minimal),y=struct$2;a.protobufPackage="apis.layout.v2";var _;(function(b){b.LAYOUT_TYPE_UNSPECIFIED="LAYOUT_TYPE_UNSPECIFIED",b.LAYOUT_TYPE_SCENELESS="LAYOUT_TYPE_SCENELESS",b.LAYOUT_TYPE_SCENE="LAYOUT_TYPE_SCENE"})(_=a.LayoutType||(a.LayoutType={}));function E(b){switch(b){case 0:case"LAYOUT_TYPE_UNSPECIFIED":return _.LAYOUT_TYPE_UNSPECIFIED;case 1:case"LAYOUT_TYPE_SCENELESS":return _.LAYOUT_TYPE_SCENELESS;case 2:case"LAYOUT_TYPE_SCENE":return _.LAYOUT_TYPE_SCENE;default:throw new tt.Error("Unrecognized enum value "+b+" for enum LayoutType")}}a.layoutTypeFromJSON=E;function O(b){switch(b){case _.LAYOUT_TYPE_UNSPECIFIED:return"LAYOUT_TYPE_UNSPECIFIED";case _.LAYOUT_TYPE_SCENELESS:return"LAYOUT_TYPE_SCENELESS";case _.LAYOUT_TYPE_SCENE:return"LAYOUT_TYPE_SCENE";default:return"UNKNOWN"}}a.layoutTypeToJSON=O;function P(b){switch(b){case _.LAYOUT_TYPE_UNSPECIFIED:return 0;case _.LAYOUT_TYPE_SCENELESS:return 1;case _.LAYOUT_TYPE_SCENE:return 2;default:return 0}}a.layoutTypeToNumber=P;var C;(function(b){b.REQUEST_ANIMATION_MODE_UNSPECIFIED="REQUEST_ANIMATION_MODE_UNSPECIFIED",b.REQUEST_ANIMATION_MODE_PARALLEL="REQUEST_ANIMATION_MODE_PARALLEL",b.REQUEST_ANIMATION_MODE_SERIES="REQUEST_ANIMATION_MODE_SERIES"})(C=a.RequestAnimationMode||(a.RequestAnimationMode={}));function A(b){switch(b){case 0:case"REQUEST_ANIMATION_MODE_UNSPECIFIED":return C.REQUEST_ANIMATION_MODE_UNSPECIFIED;case 1:case"REQUEST_ANIMATION_MODE_PARALLEL":return C.REQUEST_ANIMATION_MODE_PARALLEL;case 2:case"REQUEST_ANIMATION_MODE_SERIES":return C.REQUEST_ANIMATION_MODE_SERIES;default:throw new tt.Error("Unrecognized enum value "+b+" for enum RequestAnimationMode")}}a.requestAnimationModeFromJSON=A;function q(b){switch(b){case C.REQUEST_ANIMATION_MODE_UNSPECIFIED:return"REQUEST_ANIMATION_MODE_UNSPECIFIED";case C.REQUEST_ANIMATION_MODE_PARALLEL:return"REQUEST_ANIMATION_MODE_PARALLEL";case C.REQUEST_ANIMATION_MODE_SERIES:return"REQUEST_ANIMATION_MODE_SERIES";default:return"UNKNOWN"}}a.requestAnimationModeToJSON=q;function U(b){switch(b){case C.REQUEST_ANIMATION_MODE_UNSPECIFIED:return 0;case C.REQUEST_ANIMATION_MODE_PARALLEL:return 1;case C.REQUEST_ANIMATION_MODE_SERIES:return 2;default:return 0}}a.requestAnimationModeToNumber=U;var F;(function(b){b.EVENT_SUB_TYPE_UNSPECIFIED="EVENT_SUB_TYPE_UNSPECIFIED",b.EVENT_SUB_TYPE_CREATE="EVENT_SUB_TYPE_CREATE",b.EVENT_SUB_TYPE_UPDATE="EVENT_SUB_TYPE_UPDATE",b.EVENT_SUB_TYPE_DELETE="EVENT_SUB_TYPE_DELETE",b.EVENT_SUB_TYPE_BATCH="EVENT_SUB_TYPE_BATCH"})(F=a.EventSubType||(a.EventSubType={}));function j(b){switch(b){case 0:case"EVENT_SUB_TYPE_UNSPECIFIED":return F.EVENT_SUB_TYPE_UNSPECIFIED;case 1:case"EVENT_SUB_TYPE_CREATE":return F.EVENT_SUB_TYPE_CREATE;case 2:case"EVENT_SUB_TYPE_UPDATE":return F.EVENT_SUB_TYPE_UPDATE;case 3:case"EVENT_SUB_TYPE_DELETE":return F.EVENT_SUB_TYPE_DELETE;case 4:case"EVENT_SUB_TYPE_BATCH":return F.EVENT_SUB_TYPE_BATCH;default:throw new tt.Error("Unrecognized enum value "+b+" for enum EventSubType")}}a.eventSubTypeFromJSON=j;function T(b){switch(b){case F.EVENT_SUB_TYPE_UNSPECIFIED:return"EVENT_SUB_TYPE_UNSPECIFIED";case F.EVENT_SUB_TYPE_CREATE:return"EVENT_SUB_TYPE_CREATE";case F.EVENT_SUB_TYPE_UPDATE:return"EVENT_SUB_TYPE_UPDATE";case F.EVENT_SUB_TYPE_DELETE:return"EVENT_SUB_TYPE_DELETE";case F.EVENT_SUB_TYPE_BATCH:return"EVENT_SUB_TYPE_BATCH";default:return"UNKNOWN"}}a.eventSubTypeToJSON=T;function D(b){switch(b){case F.EVENT_SUB_TYPE_UNSPECIFIED:return 0;case F.EVENT_SUB_TYPE_CREATE:return 1;case F.EVENT_SUB_TYPE_UPDATE:return 2;case F.EVENT_SUB_TYPE_DELETE:return 3;case F.EVENT_SUB_TYPE_BATCH:return 4;default:return 0}}a.eventSubTypeToNumber=D;var J;(function(b){b.EVENT_TYPE_UNSPECIFIED="EVENT_TYPE_UNSPECIFIED",b.EVENT_TYPE_LAYOUT="EVENT_TYPE_LAYOUT",b.EVENT_TYPE_LAYER="EVENT_TYPE_LAYER"})(J=a.EventType||(a.EventType={}));function ee(b){switch(b){case 0:case"EVENT_TYPE_UNSPECIFIED":return J.EVENT_TYPE_UNSPECIFIED;case 1:case"EVENT_TYPE_LAYOUT":return J.EVENT_TYPE_LAYOUT;case 2:case"EVENT_TYPE_LAYER":return J.EVENT_TYPE_LAYER;default:throw new tt.Error("Unrecognized enum value "+b+" for enum EventType")}}a.eventTypeFromJSON=ee;function z(b){switch(b){case J.EVENT_TYPE_UNSPECIFIED:return"EVENT_TYPE_UNSPECIFIED";case J.EVENT_TYPE_LAYOUT:return"EVENT_TYPE_LAYOUT";case J.EVENT_TYPE_LAYER:return"EVENT_TYPE_LAYER";default:return"UNKNOWN"}}a.eventTypeToJSON=z;function ne(b){switch(b){case J.EVENT_TYPE_UNSPECIFIED:return 0;case J.EVENT_TYPE_LAYOUT:return 1;case J.EVENT_TYPE_LAYER:return 2;default:return 0}}a.eventTypeToNumber=ne;var X;(function(b){b.TRANSITION_DIRECTION_UNSPECIFIED="TRANSITION_DIRECTION_UNSPECIFIED",b.TRANSITION_DIRECTION_LEFT="TRANSITION_DIRECTION_LEFT",b.TRANSITION_DIRECTION_RIGHT="TRANSITION_DIRECTION_RIGHT",b.TRANSITION_DIRECTION_UP="TRANSITION_DIRECTION_UP",b.TRANSITION_DIRECTION_DOWN="TRANSITION_DIRECTION_DOWN"})(X=a.Transition_TransitionDirection||(a.Transition_TransitionDirection={}));function M(b){switch(b){case 0:case"TRANSITION_DIRECTION_UNSPECIFIED":return X.TRANSITION_DIRECTION_UNSPECIFIED;case 1:case"TRANSITION_DIRECTION_LEFT":return X.TRANSITION_DIRECTION_LEFT;case 2:case"TRANSITION_DIRECTION_RIGHT":return X.TRANSITION_DIRECTION_RIGHT;case 3:case"TRANSITION_DIRECTION_UP":return X.TRANSITION_DIRECTION_UP;case 4:case"TRANSITION_DIRECTION_DOWN":return X.TRANSITION_DIRECTION_DOWN;default:throw new tt.Error("Unrecognized enum value "+b+" for enum Transition_TransitionDirection")}}a.transition_TransitionDirectionFromJSON=M;function K(b){switch(b){case X.TRANSITION_DIRECTION_UNSPECIFIED:return"TRANSITION_DIRECTION_UNSPECIFIED";case X.TRANSITION_DIRECTION_LEFT:return"TRANSITION_DIRECTION_LEFT";case X.TRANSITION_DIRECTION_RIGHT:return"TRANSITION_DIRECTION_RIGHT";case X.TRANSITION_DIRECTION_UP:return"TRANSITION_DIRECTION_UP";case X.TRANSITION_DIRECTION_DOWN:return"TRANSITION_DIRECTION_DOWN";default:return"UNKNOWN"}}a.transition_TransitionDirectionToJSON=K;function te(b){switch(b){case X.TRANSITION_DIRECTION_UNSPECIFIED:return 0;case X.TRANSITION_DIRECTION_LEFT:return 1;case X.TRANSITION_DIRECTION_RIGHT:return 2;case X.TRANSITION_DIRECTION_UP:return 3;case X.TRANSITION_DIRECTION_DOWN:return 4;default:return 0}}a.transition_TransitionDirectionToNumber=te;var L;(function(b){b.TRANSITION_SWIPE_TYPE_UNSPECIFIED="TRANSITION_SWIPE_TYPE_UNSPECIFIED",b.TRANSITION_SWIPE_TYPE_COMBINED="TRANSITION_SWIPE_TYPE_COMBINED",b.TRANSITION_SWIPE_TYPE_SOURCE="TRANSITION_SWIPE_TYPE_SOURCE",b.TRANSITION_SWIPE_TYPE_DESTINATION="TRANSITION_SWIPE_TYPE_DESTINATION"})(L=a.Transition_TransitionSwipeType||(a.Transition_TransitionSwipeType={}));function G(b){switch(b){case 0:case"TRANSITION_SWIPE_TYPE_UNSPECIFIED":return L.TRANSITION_SWIPE_TYPE_UNSPECIFIED;case 1:case"TRANSITION_SWIPE_TYPE_COMBINED":return L.TRANSITION_SWIPE_TYPE_COMBINED;case 2:case"TRANSITION_SWIPE_TYPE_SOURCE":return L.TRANSITION_SWIPE_TYPE_SOURCE;case 3:case"TRANSITION_SWIPE_TYPE_DESTINATION":return L.TRANSITION_SWIPE_TYPE_DESTINATION;default:throw new tt.Error("Unrecognized enum value "+b+" for enum Transition_TransitionSwipeType")}}a.transition_TransitionSwipeTypeFromJSON=G;function W(b){switch(b){case L.TRANSITION_SWIPE_TYPE_UNSPECIFIED:return"TRANSITION_SWIPE_TYPE_UNSPECIFIED";case L.TRANSITION_SWIPE_TYPE_COMBINED:return"TRANSITION_SWIPE_TYPE_COMBINED";case L.TRANSITION_SWIPE_TYPE_SOURCE:return"TRANSITION_SWIPE_TYPE_SOURCE";case L.TRANSITION_SWIPE_TYPE_DESTINATION:return"TRANSITION_SWIPE_TYPE_DESTINATION";default:return"UNKNOWN"}}a.transition_TransitionSwipeTypeToJSON=W;function ie(b){switch(b){case L.TRANSITION_SWIPE_TYPE_UNSPECIFIED:return 0;case L.TRANSITION_SWIPE_TYPE_COMBINED:return 1;case L.TRANSITION_SWIPE_TYPE_SOURCE:return 2;case L.TRANSITION_SWIPE_TYPE_DESTINATION:return 3;default:return 0}}a.transition_TransitionSwipeTypeToNumber=ie;function x(){return{fromLayoutIds:[],cut:void 0,crossfade:void 0,fadeToColor:void 0,swipe:void 0,stinger:void 0}}a.Transition={encode(b,N=p.Writer.create()){for(const V of b.fromLayoutIds)N.uint32(10).string(V);return b.cut!==void 0&&a.Transition_TransitionCut.encode(b.cut,N.uint32(82).fork()).ldelim(),b.crossfade!==void 0&&a.Transition_TransitionCrossfade.encode(b.crossfade,N.uint32(90).fork()).ldelim(),b.fadeToColor!==void 0&&a.Transition_TransitionFadeToColor.encode(b.fadeToColor,N.uint32(98).fork()).ldelim(),b.swipe!==void 0&&a.Transition_TransitionSwipe.encode(b.swipe,N.uint32(106).fork()).ldelim(),b.stinger!==void 0&&a.Transition_TransitionStinger.encode(b.stinger,N.uint32(114).fork()).ldelim(),N},decode(b,N){const V=b instanceof p.Reader?b:new p.Reader(b);let se=N===void 0?V.len:V.pos+N;const re=x();for(;V.pos<se;){const ue=V.uint32();switch(ue>>>3){case 1:re.fromLayoutIds.push(V.string());break;case 10:re.cut=a.Transition_TransitionCut.decode(V,V.uint32());break;case 11:re.crossfade=a.Transition_TransitionCrossfade.decode(V,V.uint32());break;case 12:re.fadeToColor=a.Transition_TransitionFadeToColor.decode(V,V.uint32());break;case 13:re.swipe=a.Transition_TransitionSwipe.decode(V,V.uint32());break;case 14:re.stinger=a.Transition_TransitionStinger.decode(V,V.uint32());break;default:V.skipType(ue&7);break}}return re},fromJSON(b){return{fromLayoutIds:Array.isArray(b==null?void 0:b.fromLayoutIds)?b.fromLayoutIds.map(N=>String(N)):[],cut:ce(b.cut)?a.Transition_TransitionCut.fromJSON(b.cut):void 0,crossfade:ce(b.crossfade)?a.Transition_TransitionCrossfade.fromJSON(b.crossfade):void 0,fadeToColor:ce(b.fadeToColor)?a.Transition_TransitionFadeToColor.fromJSON(b.fadeToColor):void 0,swipe:ce(b.swipe)?a.Transition_TransitionSwipe.fromJSON(b.swipe):void 0,stinger:ce(b.stinger)?a.Transition_TransitionStinger.fromJSON(b.stinger):void 0}},toJSON(b){const N={};return b.fromLayoutIds?N.fromLayoutIds=b.fromLayoutIds.map(V=>V):N.fromLayoutIds=[],b.cut!==void 0&&(N.cut=b.cut?a.Transition_TransitionCut.toJSON(b.cut):void 0),b.crossfade!==void 0&&(N.crossfade=b.crossfade?a.Transition_TransitionCrossfade.toJSON(b.crossfade):void 0),b.fadeToColor!==void 0&&(N.fadeToColor=b.fadeToColor?a.Transition_TransitionFadeToColor.toJSON(b.fadeToColor):void 0),b.swipe!==void 0&&(N.swipe=b.swipe?a.Transition_TransitionSwipe.toJSON(b.swipe):void 0),b.stinger!==void 0&&(N.stinger=b.stinger?a.Transition_TransitionStinger.toJSON(b.stinger):void 0),N},fromPartial(b){var N;const V=x();return V.fromLayoutIds=((N=b.fromLayoutIds)===null||N===void 0?void 0:N.map(se=>se))||[],V.cut=b.cut!==void 0&&b.cut!==null?a.Transition_TransitionCut.fromPartial(b.cut):void 0,V.crossfade=b.crossfade!==void 0&&b.crossfade!==null?a.Transition_TransitionCrossfade.fromPartial(b.crossfade):void 0,V.fadeToColor=b.fadeToColor!==void 0&&b.fadeToColor!==null?a.Transition_TransitionFadeToColor.fromPartial(b.fadeToColor):void 0,V.swipe=b.swipe!==void 0&&b.swipe!==null?a.Transition_TransitionSwipe.fromPartial(b.swipe):void 0,V.stinger=b.stinger!==void 0&&b.stinger!==null?a.Transition_TransitionStinger.fromPartial(b.stinger):void 0,V}};function Y(){return{url:"",volume:0}}a.Transition_TransitionMediaType={encode(b,N=p.Writer.create()){return b.url!==""&&N.uint32(10).string(b.url),b.volume!==0&&N.uint32(17).double(b.volume),N},decode(b,N){const V=b instanceof p.Reader?b:new p.Reader(b);let se=N===void 0?V.len:V.pos+N;const re=Y();for(;V.pos<se;){const ue=V.uint32();switch(ue>>>3){case 1:re.url=V.string();break;case 2:re.volume=V.double();break;default:V.skipType(ue&7);break}}return re},fromJSON(b){return{url:ce(b.url)?String(b.url):"",volume:ce(b.volume)?Number(b.volume):0}},toJSON(b){const N={};return b.url!==void 0&&(N.url=b.url),b.volume!==void 0&&(N.volume=b.volume),N},fromPartial(b){var N,V;const se=Y();return se.url=(N=b.url)!==null&&N!==void 0?N:"",se.volume=(V=b.volume)!==null&&V!==void 0?V:0,se}};function oe(){return{}}a.Transition_TransitionCut={encode(b,N=p.Writer.create()){return N},decode(b,N){const V=b instanceof p.Reader?b:new p.Reader(b);let se=N===void 0?V.len:V.pos+N;const re=oe();for(;V.pos<se;){const ue=V.uint32();switch(ue>>>3){default:V.skipType(ue&7);break}}return re},fromJSON(b){return{}},toJSON(b){return{}},fromPartial(b){return oe()}};function fe(){return{durationMs:0,backgroundColor:""}}a.Transition_TransitionFadeToColor={encode(b,N=p.Writer.create()){return b.durationMs!==0&&N.uint32(8).int32(b.durationMs),b.backgroundColor!==""&&N.uint32(18).string(b.backgroundColor),N},decode(b,N){const V=b instanceof p.Reader?b:new p.Reader(b);let se=N===void 0?V.len:V.pos+N;const re=fe();for(;V.pos<se;){const ue=V.uint32();switch(ue>>>3){case 1:re.durationMs=V.int32();break;case 2:re.backgroundColor=V.string();break;default:V.skipType(ue&7);break}}return re},fromJSON(b){return{durationMs:ce(b.durationMs)?Number(b.durationMs):0,backgroundColor:ce(b.backgroundColor)?String(b.backgroundColor):""}},toJSON(b){const N={};return b.durationMs!==void 0&&(N.durationMs=Math.round(b.durationMs)),b.backgroundColor!==void 0&&(N.backgroundColor=b.backgroundColor),N},fromPartial(b){var N,V;const se=fe();return se.durationMs=(N=b.durationMs)!==null&&N!==void 0?N:0,se.backgroundColor=(V=b.backgroundColor)!==null&&V!==void 0?V:"",se}};function pe(){return{durationMs:0}}a.Transition_TransitionCrossfade={encode(b,N=p.Writer.create()){return b.durationMs!==0&&N.uint32(8).int32(b.durationMs),N},decode(b,N){const V=b instanceof p.Reader?b:new p.Reader(b);let se=N===void 0?V.len:V.pos+N;const re=pe();for(;V.pos<se;){const ue=V.uint32();switch(ue>>>3){case 1:re.durationMs=V.int32();break;default:V.skipType(ue&7);break}}return re},fromJSON(b){return{durationMs:ce(b.durationMs)?Number(b.durationMs):0}},toJSON(b){const N={};return b.durationMs!==void 0&&(N.durationMs=Math.round(b.durationMs)),N},fromPartial(b){var N;const V=pe();return V.durationMs=(N=b.durationMs)!==null&&N!==void 0?N:0,V}};function me(){return{durationMs:0,direction:X.TRANSITION_DIRECTION_UNSPECIFIED,combinedAnimation:L.TRANSITION_SWIPE_TYPE_UNSPECIFIED}}a.Transition_TransitionSwipe={encode(b,N=p.Writer.create()){return b.durationMs!==0&&N.uint32(8).int32(b.durationMs),b.direction!==X.TRANSITION_DIRECTION_UNSPECIFIED&&N.uint32(16).int32(te(b.direction)),b.combinedAnimation!==L.TRANSITION_SWIPE_TYPE_UNSPECIFIED&&N.uint32(24).int32(ie(b.combinedAnimation)),N},decode(b,N){const V=b instanceof p.Reader?b:new p.Reader(b);let se=N===void 0?V.len:V.pos+N;const re=me();for(;V.pos<se;){const ue=V.uint32();switch(ue>>>3){case 1:re.durationMs=V.int32();break;case 2:re.direction=M(V.int32());break;case 3:re.combinedAnimation=G(V.int32());break;default:V.skipType(ue&7);break}}return re},fromJSON(b){return{durationMs:ce(b.durationMs)?Number(b.durationMs):0,direction:ce(b.direction)?M(b.direction):X.TRANSITION_DIRECTION_UNSPECIFIED,combinedAnimation:ce(b.combinedAnimation)?G(b.combinedAnimation):L.TRANSITION_SWIPE_TYPE_UNSPECIFIED}},toJSON(b){const N={};return b.durationMs!==void 0&&(N.durationMs=Math.round(b.durationMs)),b.direction!==void 0&&(N.direction=K(b.direction)),b.combinedAnimation!==void 0&&(N.combinedAnimation=W(b.combinedAnimation)),N},fromPartial(b){var N,V,se;const re=me();return re.durationMs=(N=b.durationMs)!==null&&N!==void 0?N:0,re.direction=(V=b.direction)!==null&&V!==void 0?V:X.TRANSITION_DIRECTION_UNSPECIFIED,re.combinedAnimation=(se=b.combinedAnimation)!==null&&se!==void 0?se:L.TRANSITION_SWIPE_TYPE_UNSPECIFIED,re}};function v(){return{cutPointMs:0,media:void 0}}a.Transition_TransitionStingerCut={encode(b,N=p.Writer.create()){return b.cutPointMs!==0&&N.uint32(8).int32(b.cutPointMs),b.media!==void 0&&a.Transition_TransitionMediaType.encode(b.media,N.uint32(18).fork()).ldelim(),N},decode(b,N){const V=b instanceof p.Reader?b:new p.Reader(b);let se=N===void 0?V.len:V.pos+N;const re=v();for(;V.pos<se;){const ue=V.uint32();switch(ue>>>3){case 1:re.cutPointMs=V.int32();break;case 2:re.media=a.Transition_TransitionMediaType.decode(V,V.uint32());break;default:V.skipType(ue&7);break}}return re},fromJSON(b){return{cutPointMs:ce(b.cutPointMs)?Number(b.cutPointMs):0,media:ce(b.media)?a.Transition_TransitionMediaType.fromJSON(b.media):void 0}},toJSON(b){const N={};return b.cutPointMs!==void 0&&(N.cutPointMs=Math.round(b.cutPointMs)),b.media!==void 0&&(N.media=b.media?a.Transition_TransitionMediaType.toJSON(b.media):void 0),N},fromPartial(b){var N;const V=v();return V.cutPointMs=(N=b.cutPointMs)!==null&&N!==void 0?N:0,V.media=b.media!==void 0&&b.media!==null?a.Transition_TransitionMediaType.fromPartial(b.media):void 0,V}};function g(){return{cut:void 0}}a.Transition_TransitionStinger={encode(b,N=p.Writer.create()){return b.cut!==void 0&&a.Transition_TransitionStingerCut.encode(b.cut,N.uint32(10).fork()).ldelim(),N},decode(b,N){const V=b instanceof p.Reader?b:new p.Reader(b);let se=N===void 0?V.len:V.pos+N;const re=g();for(;V.pos<se;){const ue=V.uint32();switch(ue>>>3){case 1:re.cut=a.Transition_TransitionStingerCut.decode(V,V.uint32());break;default:V.skipType(ue&7);break}}return re},fromJSON(b){return{cut:ce(b.cut)?a.Transition_TransitionStingerCut.fromJSON(b.cut):void 0}},toJSON(b){const N={};return b.cut!==void 0&&(N.cut=b.cut?a.Transition_TransitionStingerCut.toJSON(b.cut):void 0),N},fromPartial(b){const N=g();return N.cut=b.cut!==void 0&&b.cut!==null?a.Transition_TransitionStingerCut.fromPartial(b.cut):void 0,N}};function w(){return{id:"",width:0,height:0,metadata:void 0,projectId:void 0,collectionId:void 0,type:void 0,transitions:[],requestMetadata:void 0}}a.Layout={encode(b,N=p.Writer.create()){b.id!==""&&N.uint32(10).string(b.id),b.width!==0&&N.uint32(16).int32(b.width),b.height!==0&&N.uint32(24).int32(b.height),b.metadata!==void 0&&y.Value.encode(y.Value.wrap(b.metadata),N.uint32(50).fork()).ldelim(),b.projectId!==void 0&&N.uint32(58).string(b.projectId),b.collectionId!==void 0&&N.uint32(66).string(b.collectionId),b.type!==void 0&&N.uint32(72).int32(P(b.type));for(const V of b.transitions)a.Transition.encode(V,N.uint32(82).fork()).ldelim();return b.requestMetadata!==void 0&&y.Value.encode(y.Value.wrap(b.requestMetadata),N.uint32(810).fork()).ldelim(),N},decode(b,N){const V=b instanceof p.Reader?b:new p.Reader(b);let se=N===void 0?V.len:V.pos+N;const re=w();for(;V.pos<se;){const ue=V.uint32();switch(ue>>>3){case 1:re.id=V.string();break;case 2:re.width=V.int32();break;case 3:re.height=V.int32();break;case 6:re.metadata=y.Value.unwrap(y.Value.decode(V,V.uint32()));break;case 7:re.projectId=V.string();break;case 8:re.collectionId=V.string();break;case 9:re.type=E(V.int32());break;case 10:re.transitions.push(a.Transition.decode(V,V.uint32()));break;case 101:re.requestMetadata=y.Value.unwrap(y.Value.decode(V,V.uint32()));break;default:V.skipType(ue&7);break}}return re},fromJSON(b){return{id:ce(b.id)?String(b.id):"",width:ce(b.width)?Number(b.width):0,height:ce(b.height)?Number(b.height):0,metadata:ce(b==null?void 0:b.metadata)?b.metadata:void 0,projectId:ce(b.projectId)?String(b.projectId):void 0,collectionId:ce(b.collectionId)?String(b.collectionId):void 0,type:ce(b.type)?E(b.type):void 0,transitions:Array.isArray(b==null?void 0:b.transitions)?b.transitions.map(N=>a.Transition.fromJSON(N)):[],requestMetadata:ce(b==null?void 0:b.requestMetadata)?b.requestMetadata:void 0}},toJSON(b){const N={};return b.id!==void 0&&(N.id=b.id),b.width!==void 0&&(N.width=Math.round(b.width)),b.height!==void 0&&(N.height=Math.round(b.height)),b.metadata!==void 0&&(N.metadata=b.metadata),b.projectId!==void 0&&(N.projectId=b.projectId),b.collectionId!==void 0&&(N.collectionId=b.collectionId),b.type!==void 0&&(N.type=b.type!==void 0?O(b.type):void 0),b.transitions?N.transitions=b.transitions.map(V=>V?a.Transition.toJSON(V):void 0):N.transitions=[],b.requestMetadata!==void 0&&(N.requestMetadata=b.requestMetadata),N},fromPartial(b){var N,V,se,re,ue,we,Be,Je,De;const Le=w();return Le.id=(N=b.id)!==null&&N!==void 0?N:"",Le.width=(V=b.width)!==null&&V!==void 0?V:0,Le.height=(se=b.height)!==null&&se!==void 0?se:0,Le.metadata=(re=b.metadata)!==null&&re!==void 0?re:void 0,Le.projectId=(ue=b.projectId)!==null&&ue!==void 0?ue:void 0,Le.collectionId=(we=b.collectionId)!==null&&we!==void 0?we:void 0,Le.type=(Be=b.type)!==null&&Be!==void 0?Be:void 0,Le.transitions=((Je=b.transitions)===null||Je===void 0?void 0:Je.map(He=>a.Transition.fromPartial(He)))||[],Le.requestMetadata=(De=b.requestMetadata)!==null&&De!==void 0?De:void 0,Le}};function ae(){return{type:"",data:void 0,x:void 0,y:void 0,width:void 0,height:void 0,rotation:0,opacity:0,scale:0,hidden:!1,children:void 0,metadata:void 0,id:"",layoutId:"",requestMetadata:void 0,requestAnimation:[]}}a.Layer={encode(b,N=p.Writer.create()){b.type!==""&&N.uint32(10).string(b.type),b.data!==void 0&&y.Struct.encode(y.Struct.wrap(b.data),N.uint32(18).fork()).ldelim(),b.x!==void 0&&y.Value.encode(y.Value.wrap(b.x),N.uint32(26).fork()).ldelim(),b.y!==void 0&&y.Value.encode(y.Value.wrap(b.y),N.uint32(34).fork()).ldelim(),b.width!==void 0&&y.Value.encode(y.Value.wrap(b.width),N.uint32(42).fork()).ldelim(),b.height!==void 0&&y.Value.encode(y.Value.wrap(b.height),N.uint32(50).fork()).ldelim(),b.rotation!==0&&N.uint32(57).double(b.rotation),b.opacity!==0&&N.uint32(65).double(b.opacity),b.scale!==0&&N.uint32(73).double(b.scale),b.hidden===!0&&N.uint32(80).bool(b.hidden),b.children!==void 0&&y.ListValue.encode(y.ListValue.wrap(b.children),N.uint32(98).fork()).ldelim(),b.metadata!==void 0&&y.Value.encode(y.Value.wrap(b.metadata),N.uint32(114).fork()).ldelim(),b.id!==""&&N.uint32(802).string(b.id),b.layoutId!==""&&N.uint32(818).string(b.layoutId),b.requestMetadata!==void 0&&y.Value.encode(y.Value.wrap(b.requestMetadata),N.uint32(810).fork()).ldelim();for(const V of b.requestAnimation)a.LayerAnimation.encode(V,N.uint32(826).fork()).ldelim();return N},decode(b,N){const V=b instanceof p.Reader?b:new p.Reader(b);let se=N===void 0?V.len:V.pos+N;const re=ae();for(;V.pos<se;){const ue=V.uint32();switch(ue>>>3){case 1:re.type=V.string();break;case 2:re.data=y.Struct.unwrap(y.Struct.decode(V,V.uint32()));break;case 3:re.x=y.Value.unwrap(y.Value.decode(V,V.uint32()));break;case 4:re.y=y.Value.unwrap(y.Value.decode(V,V.uint32()));break;case 5:re.width=y.Value.unwrap(y.Value.decode(V,V.uint32()));break;case 6:re.height=y.Value.unwrap(y.Value.decode(V,V.uint32()));break;case 7:re.rotation=V.double();break;case 8:re.opacity=V.double();break;case 9:re.scale=V.double();break;case 10:re.hidden=V.bool();break;case 12:re.children=y.ListValue.unwrap(y.ListValue.decode(V,V.uint32()));break;case 14:re.metadata=y.Value.unwrap(y.Value.decode(V,V.uint32()));break;case 100:re.id=V.string();break;case 102:re.layoutId=V.string();break;case 101:re.requestMetadata=y.Value.unwrap(y.Value.decode(V,V.uint32()));break;case 103:re.requestAnimation.push(a.LayerAnimation.decode(V,V.uint32()));break;default:V.skipType(ue&7);break}}return re},fromJSON(b){return{type:ce(b.type)?String(b.type):"",data:at(b.data)?b.data:void 0,x:ce(b==null?void 0:b.x)?b.x:void 0,y:ce(b==null?void 0:b.y)?b.y:void 0,width:ce(b==null?void 0:b.width)?b.width:void 0,height:ce(b==null?void 0:b.height)?b.height:void 0,rotation:ce(b.rotation)?Number(b.rotation):0,opacity:ce(b.opacity)?Number(b.opacity):0,scale:ce(b.scale)?Number(b.scale):0,hidden:ce(b.hidden)?Boolean(b.hidden):!1,children:Array.isArray(b.children)?[...b.children]:void 0,metadata:ce(b==null?void 0:b.metadata)?b.metadata:void 0,id:ce(b.id)?String(b.id):"",layoutId:ce(b.layoutId)?String(b.layoutId):"",requestMetadata:ce(b==null?void 0:b.requestMetadata)?b.requestMetadata:void 0,requestAnimation:Array.isArray(b==null?void 0:b.requestAnimation)?b.requestAnimation.map(N=>a.LayerAnimation.fromJSON(N)):[]}},toJSON(b){const N={};return b.type!==void 0&&(N.type=b.type),b.data!==void 0&&(N.data=b.data),b.x!==void 0&&(N.x=b.x),b.y!==void 0&&(N.y=b.y),b.width!==void 0&&(N.width=b.width),b.height!==void 0&&(N.height=b.height),b.rotation!==void 0&&(N.rotation=b.rotation),b.opacity!==void 0&&(N.opacity=b.opacity),b.scale!==void 0&&(N.scale=b.scale),b.hidden!==void 0&&(N.hidden=b.hidden),b.children!==void 0&&(N.children=b.children),b.metadata!==void 0&&(N.metadata=b.metadata),b.id!==void 0&&(N.id=b.id),b.layoutId!==void 0&&(N.layoutId=b.layoutId),b.requestMetadata!==void 0&&(N.requestMetadata=b.requestMetadata),b.requestAnimation?N.requestAnimation=b.requestAnimation.map(V=>V?a.LayerAnimation.toJSON(V):void 0):N.requestAnimation=[],N},fromPartial(b){var N,V,se,re,ue,we,Be,Je,De,Le,He,je,Ye,ze,xe,$e;const Ie=ae();return Ie.type=(N=b.type)!==null&&N!==void 0?N:"",Ie.data=(V=b.data)!==null&&V!==void 0?V:void 0,Ie.x=(se=b.x)!==null&&se!==void 0?se:void 0,Ie.y=(re=b.y)!==null&&re!==void 0?re:void 0,Ie.width=(ue=b.width)!==null&&ue!==void 0?ue:void 0,Ie.height=(we=b.height)!==null&&we!==void 0?we:void 0,Ie.rotation=(Be=b.rotation)!==null&&Be!==void 0?Be:0,Ie.opacity=(Je=b.opacity)!==null&&Je!==void 0?Je:0,Ie.scale=(De=b.scale)!==null&&De!==void 0?De:0,Ie.hidden=(Le=b.hidden)!==null&&Le!==void 0?Le:!1,Ie.children=(He=b.children)!==null&&He!==void 0?He:void 0,Ie.metadata=(je=b.metadata)!==null&&je!==void 0?je:void 0,Ie.id=(Ye=b.id)!==null&&Ye!==void 0?Ye:"",Ie.layoutId=(ze=b.layoutId)!==null&&ze!==void 0?ze:"",Ie.requestMetadata=(xe=b.requestMetadata)!==null&&xe!==void 0?xe:void 0,Ie.requestAnimation=(($e=b.requestAnimation)===null||$e===void 0?void 0:$e.map(it=>a.LayerAnimation.fromPartial(it)))||[],Ie}};function I(){return{layoutId:"",layerId:"",payload:void 0}}a.DeleteLayerRequest={encode(b,N=p.Writer.create()){return b.layoutId!==""&&N.uint32(10).string(b.layoutId),b.layerId!==""&&N.uint32(18).string(b.layerId),b.payload!==void 0&&a.DeleteLayerPayload.encode(b.payload,N.uint32(26).fork()).ldelim(),N},decode(b,N){const V=b instanceof p.Reader?b:new p.Reader(b);let se=N===void 0?V.len:V.pos+N;const re=I();for(;V.pos<se;){const ue=V.uint32();switch(ue>>>3){case 1:re.layoutId=V.string();break;case 2:re.layerId=V.string();break;case 3:re.payload=a.DeleteLayerPayload.decode(V,V.uint32());break;default:V.skipType(ue&7);break}}return re},fromJSON(b){return{layoutId:ce(b.layoutId)?String(b.layoutId):"",layerId:ce(b.layerId)?String(b.layerId):"",payload:ce(b.payload)?a.DeleteLayerPayload.fromJSON(b.payload):void 0}},toJSON(b){const N={};return b.layoutId!==void 0&&(N.layoutId=b.layoutId),b.layerId!==void 0&&(N.layerId=b.layerId),b.payload!==void 0&&(N.payload=b.payload?a.DeleteLayerPayload.toJSON(b.payload):void 0),N},fromPartial(b){var N,V;const se=I();return se.layoutId=(N=b.layoutId)!==null&&N!==void 0?N:"",se.layerId=(V=b.layerId)!==null&&V!==void 0?V:"",se.payload=b.payload!==void 0&&b.payload!==null?a.DeleteLayerPayload.fromPartial(b.payload):void 0,se}};function $(){return{id:"",layoutId:"",requestMetadata:void 0}}a.DeleteLayerResponse={encode(b,N=p.Writer.create()){return b.id!==""&&N.uint32(10).string(b.id),b.layoutId!==""&&N.uint32(18).string(b.layoutId),b.requestMetadata!==void 0&&y.Value.encode(y.Value.wrap(b.requestMetadata),N.uint32(802).fork()).ldelim(),N},decode(b,N){const V=b instanceof p.Reader?b:new p.Reader(b);let se=N===void 0?V.len:V.pos+N;const re=$();for(;V.pos<se;){const ue=V.uint32();switch(ue>>>3){case 1:re.id=V.string();break;case 2:re.layoutId=V.string();break;case 100:re.requestMetadata=y.Value.unwrap(y.Value.decode(V,V.uint32()));break;default:V.skipType(ue&7);break}}return re},fromJSON(b){return{id:ce(b.id)?String(b.id):"",layoutId:ce(b.layoutId)?String(b.layoutId):"",requestMetadata:ce(b==null?void 0:b.requestMetadata)?b.requestMetadata:void 0}},toJSON(b){const N={};return b.id!==void 0&&(N.id=b.id),b.layoutId!==void 0&&(N.layoutId=b.layoutId),b.requestMetadata!==void 0&&(N.requestMetadata=b.requestMetadata),N},fromPartial(b){var N,V,se;const re=$();return re.id=(N=b.id)!==null&&N!==void 0?N:"",re.layoutId=(V=b.layoutId)!==null&&V!==void 0?V:"",re.requestMetadata=(se=b.requestMetadata)!==null&&se!==void 0?se:void 0,re}};function Z(){return{layers:[],layoutId:"",requestMetadata:void 0,requestAnimationMode:C.REQUEST_ANIMATION_MODE_UNSPECIFIED}}a.BatchLayerResponse={encode(b,N=p.Writer.create()){for(const V of b.layers)a.BatchLayerResponse_BatchLayerItem.encode(V,N.uint32(18).fork()).ldelim();return b.layoutId!==""&&N.uint32(26).string(b.layoutId),b.requestMetadata!==void 0&&y.Value.encode(y.Value.wrap(b.requestMetadata),N.uint32(802).fork()).ldelim(),b.requestAnimationMode!==C.REQUEST_ANIMATION_MODE_UNSPECIFIED&&N.uint32(808).int32(U(b.requestAnimationMode)),N},decode(b,N){const V=b instanceof p.Reader?b:new p.Reader(b);let se=N===void 0?V.len:V.pos+N;const re=Z();for(;V.pos<se;){const ue=V.uint32();switch(ue>>>3){case 2:re.layers.push(a.BatchLayerResponse_BatchLayerItem.decode(V,V.uint32()));break;case 3:re.layoutId=V.string();break;case 100:re.requestMetadata=y.Value.unwrap(y.Value.decode(V,V.uint32()));break;case 101:re.requestAnimationMode=A(V.int32());break;default:V.skipType(ue&7);break}}return re},fromJSON(b){return{layers:Array.isArray(b==null?void 0:b.layers)?b.layers.map(N=>a.BatchLayerResponse_BatchLayerItem.fromJSON(N)):[],layoutId:ce(b.layoutId)?String(b.layoutId):"",requestMetadata:ce(b==null?void 0:b.requestMetadata)?b.requestMetadata:void 0,requestAnimationMode:ce(b.requestAnimationMode)?A(b.requestAnimationMode):C.REQUEST_ANIMATION_MODE_UNSPECIFIED}},toJSON(b){const N={};return b.layers?N.layers=b.layers.map(V=>V?a.BatchLayerResponse_BatchLayerItem.toJSON(V):void 0):N.layers=[],b.layoutId!==void 0&&(N.layoutId=b.layoutId),b.requestMetadata!==void 0&&(N.requestMetadata=b.requestMetadata),b.requestAnimationMode!==void 0&&(N.requestAnimationMode=q(b.requestAnimationMode)),N},fromPartial(b){var N,V,se,re;const ue=Z();return ue.layers=((N=b.layers)===null||N===void 0?void 0:N.map(we=>a.BatchLayerResponse_BatchLayerItem.fromPartial(we)))||[],ue.layoutId=(V=b.layoutId)!==null&&V!==void 0?V:"",ue.requestMetadata=(se=b.requestMetadata)!==null&&se!==void 0?se:void 0,ue.requestAnimationMode=(re=b.requestAnimationMode)!==null&&re!==void 0?re:C.REQUEST_ANIMATION_MODE_UNSPECIFIED,ue}};function le(){return{create:void 0,update:void 0,delete:void 0}}a.BatchLayerResponse_BatchLayerItem={encode(b,N=p.Writer.create()){return b.create!==void 0&&a.Layer.encode(b.create,N.uint32(10).fork()).ldelim(),b.update!==void 0&&a.Layer.encode(b.update,N.uint32(18).fork()).ldelim(),b.delete!==void 0&&a.DeleteLayerResponse.encode(b.delete,N.uint32(26).fork()).ldelim(),N},decode(b,N){const V=b instanceof p.Reader?b:new p.Reader(b);let se=N===void 0?V.len:V.pos+N;const re=le();for(;V.pos<se;){const ue=V.uint32();switch(ue>>>3){case 1:re.create=a.Layer.decode(V,V.uint32());break;case 2:re.update=a.Layer.decode(V,V.uint32());break;case 3:re.delete=a.DeleteLayerResponse.decode(V,V.uint32());break;default:V.skipType(ue&7);break}}return re},fromJSON(b){return{create:ce(b.create)?a.Layer.fromJSON(b.create):void 0,update:ce(b.update)?a.Layer.fromJSON(b.update):void 0,delete:ce(b.delete)?a.DeleteLayerResponse.fromJSON(b.delete):void 0}},toJSON(b){const N={};return b.create!==void 0&&(N.create=b.create?a.Layer.toJSON(b.create):void 0),b.update!==void 0&&(N.update=b.update?a.Layer.toJSON(b.update):void 0),b.delete!==void 0&&(N.delete=b.delete?a.DeleteLayerResponse.toJSON(b.delete):void 0),N},fromPartial(b){const N=le();return N.create=b.create!==void 0&&b.create!==null?a.Layer.fromPartial(b.create):void 0,N.update=b.update!==void 0&&b.update!==null?a.Layer.fromPartial(b.update):void 0,N.delete=b.delete!==void 0&&b.delete!==null?a.DeleteLayerResponse.fromPartial(b.delete):void 0,N}};function de(){return{width:void 0,height:void 0,metadata:void 0,projectId:void 0,collectionId:void 0,type:void 0,transitions:[],requestMetadata:void 0}}a.PartialLayout={encode(b,N=p.Writer.create()){b.width!==void 0&&N.uint32(16).int32(b.width),b.height!==void 0&&N.uint32(24).int32(b.height),b.metadata!==void 0&&y.Value.encode(y.Value.wrap(b.metadata),N.uint32(50).fork()).ldelim(),b.projectId!==void 0&&N.uint32(58).string(b.projectId),b.collectionId!==void 0&&N.uint32(66).string(b.collectionId),b.type!==void 0&&N.uint32(72).int32(P(b.type));for(const V of b.transitions)a.Transition.encode(V,N.uint32(82).fork()).ldelim();return b.requestMetadata!==void 0&&y.Value.encode(y.Value.wrap(b.requestMetadata),N.uint32(810).fork()).ldelim(),N},decode(b,N){const V=b instanceof p.Reader?b:new p.Reader(b);let se=N===void 0?V.len:V.pos+N;const re=de();for(;V.pos<se;){const ue=V.uint32();switch(ue>>>3){case 2:re.width=V.int32();break;case 3:re.height=V.int32();break;case 6:re.metadata=y.Value.unwrap(y.Value.decode(V,V.uint32()));break;case 7:re.projectId=V.string();break;case 8:re.collectionId=V.string();break;case 9:re.type=E(V.int32());break;case 10:re.transitions.push(a.Transition.decode(V,V.uint32()));break;case 101:re.requestMetadata=y.Value.unwrap(y.Value.decode(V,V.uint32()));break;default:V.skipType(ue&7);break}}return re},fromJSON(b){return{width:ce(b.width)?Number(b.width):void 0,height:ce(b.height)?Number(b.height):void 0,metadata:ce(b==null?void 0:b.metadata)?b.metadata:void 0,projectId:ce(b.projectId)?String(b.projectId):void 0,collectionId:ce(b.collectionId)?String(b.collectionId):void 0,type:ce(b.type)?E(b.type):void 0,transitions:Array.isArray(b==null?void 0:b.transitions)?b.transitions.map(N=>a.Transition.fromJSON(N)):[],requestMetadata:ce(b==null?void 0:b.requestMetadata)?b.requestMetadata:void 0}},toJSON(b){const N={};return b.width!==void 0&&(N.width=Math.round(b.width)),b.height!==void 0&&(N.height=Math.round(b.height)),b.metadata!==void 0&&(N.metadata=b.metadata),b.projectId!==void 0&&(N.projectId=b.projectId),b.collectionId!==void 0&&(N.collectionId=b.collectionId),b.type!==void 0&&(N.type=b.type!==void 0?O(b.type):void 0),b.transitions?N.transitions=b.transitions.map(V=>V?a.Transition.toJSON(V):void 0):N.transitions=[],b.requestMetadata!==void 0&&(N.requestMetadata=b.requestMetadata),N},fromPartial(b){var N,V,se,re,ue,we,Be,Je;const De=de();return De.width=(N=b.width)!==null&&N!==void 0?N:void 0,De.height=(V=b.height)!==null&&V!==void 0?V:void 0,De.metadata=(se=b.metadata)!==null&&se!==void 0?se:void 0,De.projectId=(re=b.projectId)!==null&&re!==void 0?re:void 0,De.collectionId=(ue=b.collectionId)!==null&&ue!==void 0?ue:void 0,De.type=(we=b.type)!==null&&we!==void 0?we:void 0,De.transitions=((Be=b.transitions)===null||Be===void 0?void 0:Be.map(Le=>a.Transition.fromPartial(Le)))||[],De.requestMetadata=(Je=b.requestMetadata)!==null&&Je!==void 0?Je:void 0,De}};function he(){return{projectId:void 0,collectionId:void 0,type:void 0}}a.ListLayoutsRequest={encode(b,N=p.Writer.create()){return b.projectId!==void 0&&N.uint32(10).string(b.projectId),b.collectionId!==void 0&&N.uint32(18).string(b.collectionId),b.type!==void 0&&N.uint32(24).int32(P(b.type)),N},decode(b,N){const V=b instanceof p.Reader?b:new p.Reader(b);let se=N===void 0?V.len:V.pos+N;const re=he();for(;V.pos<se;){const ue=V.uint32();switch(ue>>>3){case 1:re.projectId=V.string();break;case 2:re.collectionId=V.string();break;case 3:re.type=E(V.int32());break;default:V.skipType(ue&7);break}}return re},fromJSON(b){return{projectId:ce(b.projectId)?String(b.projectId):void 0,collectionId:ce(b.collectionId)?String(b.collectionId):void 0,type:ce(b.type)?E(b.type):void 0}},toJSON(b){const N={};return b.projectId!==void 0&&(N.projectId=b.projectId),b.collectionId!==void 0&&(N.collectionId=b.collectionId),b.type!==void 0&&(N.type=b.type!==void 0?O(b.type):void 0),N},fromPartial(b){var N,V,se;const re=he();return re.projectId=(N=b.projectId)!==null&&N!==void 0?N:void 0,re.collectionId=(V=b.collectionId)!==null&&V!==void 0?V:void 0,re.type=(se=b.type)!==null&&se!==void 0?se:void 0,re}};function ge(){return{layouts:[]}}a.ListLayoutsResponse={encode(b,N=p.Writer.create()){for(const V of b.layouts)a.Layout.encode(V,N.uint32(10).fork()).ldelim();return N},decode(b,N){const V=b instanceof p.Reader?b:new p.Reader(b);let se=N===void 0?V.len:V.pos+N;const re=ge();for(;V.pos<se;){const ue=V.uint32();switch(ue>>>3){case 1:re.layouts.push(a.Layout.decode(V,V.uint32()));break;default:V.skipType(ue&7);break}}return re},fromJSON(b){return{layouts:Array.isArray(b==null?void 0:b.layouts)?b.layouts.map(N=>a.Layout.fromJSON(N)):[]}},toJSON(b){const N={};return b.layouts?N.layouts=b.layouts.map(V=>V?a.Layout.toJSON(V):void 0):N.layouts=[],N},fromPartial(b){var N;const V=ge();return V.layouts=((N=b.layouts)===null||N===void 0?void 0:N.map(se=>a.Layout.fromPartial(se)))||[],V}};function Pe(){return{layout:void 0}}a.CreateLayoutRequest={encode(b,N=p.Writer.create()){return b.layout!==void 0&&a.PartialLayout.encode(b.layout,N.uint32(18).fork()).ldelim(),N},decode(b,N){const V=b instanceof p.Reader?b:new p.Reader(b);let se=N===void 0?V.len:V.pos+N;const re=Pe();for(;V.pos<se;){const ue=V.uint32();switch(ue>>>3){case 2:re.layout=a.PartialLayout.decode(V,V.uint32());break;default:V.skipType(ue&7);break}}return re},fromJSON(b){return{layout:ce(b.layout)?a.PartialLayout.fromJSON(b.layout):void 0}},toJSON(b){const N={};return b.layout!==void 0&&(N.layout=b.layout?a.PartialLayout.toJSON(b.layout):void 0),N},fromPartial(b){const N=Pe();return N.layout=b.layout!==void 0&&b.layout!==null?a.PartialLayout.fromPartial(b.layout):void 0,N}};function Te(){return{layoutId:""}}a.GetLayoutRequest={encode(b,N=p.Writer.create()){return b.layoutId!==""&&N.uint32(10).string(b.layoutId),N},decode(b,N){const V=b instanceof p.Reader?b:new p.Reader(b);let se=N===void 0?V.len:V.pos+N;const re=Te();for(;V.pos<se;){const ue=V.uint32();switch(ue>>>3){case 1:re.layoutId=V.string();break;default:V.skipType(ue&7);break}}return re},fromJSON(b){return{layoutId:ce(b.layoutId)?String(b.layoutId):""}},toJSON(b){const N={};return b.layoutId!==void 0&&(N.layoutId=b.layoutId),N},fromPartial(b){var N;const V=Te();return V.layoutId=(N=b.layoutId)!==null&&N!==void 0?N:"",V}};function _e(){return{layoutId:"",layout:void 0}}a.UpdateLayoutRequest={encode(b,N=p.Writer.create()){return b.layoutId!==""&&N.uint32(10).string(b.layoutId),b.layout!==void 0&&a.PartialLayout.encode(b.layout,N.uint32(26).fork()).ldelim(),N},decode(b,N){const V=b instanceof p.Reader?b:new p.Reader(b);let se=N===void 0?V.len:V.pos+N;const re=_e();for(;V.pos<se;){const ue=V.uint32();switch(ue>>>3){case 1:re.layoutId=V.string();break;case 3:re.layout=a.PartialLayout.decode(V,V.uint32());break;default:V.skipType(ue&7);break}}return re},fromJSON(b){return{layoutId:ce(b.layoutId)?String(b.layoutId):"",layout:ce(b.layout)?a.PartialLayout.fromJSON(b.layout):void 0}},toJSON(b){const N={};return b.layoutId!==void 0&&(N.layoutId=b.layoutId),b.layout!==void 0&&(N.layout=b.layout?a.PartialLayout.toJSON(b.layout):void 0),N},fromPartial(b){var N;const V=_e();return V.layoutId=(N=b.layoutId)!==null&&N!==void 0?N:"",V.layout=b.layout!==void 0&&b.layout!==null?a.PartialLayout.fromPartial(b.layout):void 0,V}};function Ne(){return{requestMetadata:void 0}}a.DeleteLayoutPayload={encode(b,N=p.Writer.create()){return b.requestMetadata!==void 0&&y.Value.encode(y.Value.wrap(b.requestMetadata),N.uint32(802).fork()).ldelim(),N},decode(b,N){const V=b instanceof p.Reader?b:new p.Reader(b);let se=N===void 0?V.len:V.pos+N;const re=Ne();for(;V.pos<se;){const ue=V.uint32();switch(ue>>>3){case 100:re.requestMetadata=y.Value.unwrap(y.Value.decode(V,V.uint32()));break;default:V.skipType(ue&7);break}}return re},fromJSON(b){return{requestMetadata:ce(b==null?void 0:b.requestMetadata)?b.requestMetadata:void 0}},toJSON(b){const N={};return b.requestMetadata!==void 0&&(N.requestMetadata=b.requestMetadata),N},fromPartial(b){var N;const V=Ne();return V.requestMetadata=(N=b.requestMetadata)!==null&&N!==void 0?N:void 0,V}};function We(){return{layoutId:"",payload:void 0}}a.DeleteLayoutRequest={encode(b,N=p.Writer.create()){return b.layoutId!==""&&N.uint32(10).string(b.layoutId),b.payload!==void 0&&a.DeleteLayoutPayload.encode(b.payload,N.uint32(18).fork()).ldelim(),N},decode(b,N){const V=b instanceof p.Reader?b:new p.Reader(b);let se=N===void 0?V.len:V.pos+N;const re=We();for(;V.pos<se;){const ue=V.uint32();switch(ue>>>3){case 1:re.layoutId=V.string();break;case 2:re.payload=a.DeleteLayoutPayload.decode(V,V.uint32());break;default:V.skipType(ue&7);break}}return re},fromJSON(b){return{layoutId:ce(b.layoutId)?String(b.layoutId):"",payload:ce(b.payload)?a.DeleteLayoutPayload.fromJSON(b.payload):void 0}},toJSON(b){const N={};return b.layoutId!==void 0&&(N.layoutId=b.layoutId),b.payload!==void 0&&(N.payload=b.payload?a.DeleteLayoutPayload.toJSON(b.payload):void 0),N},fromPartial(b){var N;const V=We();return V.layoutId=(N=b.layoutId)!==null&&N!==void 0?N:"",V.payload=b.payload!==void 0&&b.payload!==null?a.DeleteLayoutPayload.fromPartial(b.payload):void 0,V}};function ye(){return{id:"",requestMetadata:void 0}}a.DeleteLayoutResponse={encode(b,N=p.Writer.create()){return b.id!==""&&N.uint32(18).string(b.id),b.requestMetadata!==void 0&&y.Value.encode(y.Value.wrap(b.requestMetadata),N.uint32(802).fork()).ldelim(),N},decode(b,N){const V=b instanceof p.Reader?b:new p.Reader(b);let se=N===void 0?V.len:V.pos+N;const re=ye();for(;V.pos<se;){const ue=V.uint32();switch(ue>>>3){case 2:re.id=V.string();break;case 100:re.requestMetadata=y.Value.unwrap(y.Value.decode(V,V.uint32()));break;default:V.skipType(ue&7);break}}return re},fromJSON(b){return{id:ce(b.id)?String(b.id):"",requestMetadata:ce(b==null?void 0:b.requestMetadata)?b.requestMetadata:void 0}},toJSON(b){const N={};return b.id!==void 0&&(N.id=b.id),b.requestMetadata!==void 0&&(N.requestMetadata=b.requestMetadata),N},fromPartial(b){var N,V;const se=ye();return se.id=(N=b.id)!==null&&N!==void 0?N:"",se.requestMetadata=(V=b.requestMetadata)!==null&&V!==void 0?V:void 0,se}};function qe(){return{properties:[],durationMs:0,delayMs:void 0,easingMode:void 0}}a.LayerAnimation={encode(b,N=p.Writer.create()){for(const V of b.properties)N.uint32(10).string(V);return b.durationMs!==0&&N.uint32(16).int32(b.durationMs),b.delayMs!==void 0&&N.uint32(32).int32(b.delayMs),b.easingMode!==void 0&&N.uint32(42).string(b.easingMode),N},decode(b,N){const V=b instanceof p.Reader?b:new p.Reader(b);let se=N===void 0?V.len:V.pos+N;const re=qe();for(;V.pos<se;){const ue=V.uint32();switch(ue>>>3){case 1:re.properties.push(V.string());break;case 2:re.durationMs=V.int32();break;case 4:re.delayMs=V.int32();break;case 5:re.easingMode=V.string();break;default:V.skipType(ue&7);break}}return re},fromJSON(b){return{properties:Array.isArray(b==null?void 0:b.properties)?b.properties.map(N=>String(N)):[],durationMs:ce(b.durationMs)?Number(b.durationMs):0,delayMs:ce(b.delayMs)?Number(b.delayMs):void 0,easingMode:ce(b.easingMode)?String(b.easingMode):void 0}},toJSON(b){const N={};return b.properties?N.properties=b.properties.map(V=>V):N.properties=[],b.durationMs!==void 0&&(N.durationMs=Math.round(b.durationMs)),b.delayMs!==void 0&&(N.delayMs=Math.round(b.delayMs)),b.easingMode!==void 0&&(N.easingMode=b.easingMode),N},fromPartial(b){var N,V,se,re;const ue=qe();return ue.properties=((N=b.properties)===null||N===void 0?void 0:N.map(we=>we))||[],ue.durationMs=(V=b.durationMs)!==null&&V!==void 0?V:0,ue.delayMs=(se=b.delayMs)!==null&&se!==void 0?se:void 0,ue.easingMode=(re=b.easingMode)!==null&&re!==void 0?re:void 0,ue}};function Ke(){return{type:void 0,data:void 0,x:void 0,y:void 0,width:void 0,height:void 0,rotation:void 0,opacity:void 0,scale:void 0,hidden:void 0,children:void 0,parentId:void 0,metadata:void 0,requestMetadata:void 0,requestAnimation:[]}}a.PartialLayer={encode(b,N=p.Writer.create()){b.type!==void 0&&N.uint32(10).string(b.type),b.data!==void 0&&y.Struct.encode(y.Struct.wrap(b.data),N.uint32(18).fork()).ldelim(),b.x!==void 0&&y.Value.encode(y.Value.wrap(b.x),N.uint32(26).fork()).ldelim(),b.y!==void 0&&y.Value.encode(y.Value.wrap(b.y),N.uint32(34).fork()).ldelim(),b.width!==void 0&&y.Value.encode(y.Value.wrap(b.width),N.uint32(42).fork()).ldelim(),b.height!==void 0&&y.Value.encode(y.Value.wrap(b.height),N.uint32(50).fork()).ldelim(),b.rotation!==void 0&&N.uint32(57).double(b.rotation),b.opacity!==void 0&&N.uint32(65).double(b.opacity),b.scale!==void 0&&N.uint32(73).double(b.scale),b.hidden!==void 0&&N.uint32(80).bool(b.hidden),b.children!==void 0&&y.ListValue.encode(y.ListValue.wrap(b.children),N.uint32(98).fork()).ldelim(),b.parentId!==void 0&&N.uint32(106).string(b.parentId),b.metadata!==void 0&&y.Value.encode(y.Value.wrap(b.metadata),N.uint32(114).fork()).ldelim(),b.requestMetadata!==void 0&&y.Value.encode(y.Value.wrap(b.requestMetadata),N.uint32(802).fork()).ldelim();for(const V of b.requestAnimation)a.LayerAnimation.encode(V,N.uint32(826).fork()).ldelim();return N},decode(b,N){const V=b instanceof p.Reader?b:new p.Reader(b);let se=N===void 0?V.len:V.pos+N;const re=Ke();for(;V.pos<se;){const ue=V.uint32();switch(ue>>>3){case 1:re.type=V.string();break;case 2:re.data=y.Struct.unwrap(y.Struct.decode(V,V.uint32()));break;case 3:re.x=y.Value.unwrap(y.Value.decode(V,V.uint32()));break;case 4:re.y=y.Value.unwrap(y.Value.decode(V,V.uint32()));break;case 5:re.width=y.Value.unwrap(y.Value.decode(V,V.uint32()));break;case 6:re.height=y.Value.unwrap(y.Value.decode(V,V.uint32()));break;case 7:re.rotation=V.double();break;case 8:re.opacity=V.double();break;case 9:re.scale=V.double();break;case 10:re.hidden=V.bool();break;case 12:re.children=y.ListValue.unwrap(y.ListValue.decode(V,V.uint32()));break;case 13:re.parentId=V.string();break;case 14:re.metadata=y.Value.unwrap(y.Value.decode(V,V.uint32()));break;case 100:re.requestMetadata=y.Value.unwrap(y.Value.decode(V,V.uint32()));break;case 103:re.requestAnimation.push(a.LayerAnimation.decode(V,V.uint32()));break;default:V.skipType(ue&7);break}}return re},fromJSON(b){return{type:ce(b.type)?String(b.type):void 0,data:at(b.data)?b.data:void 0,x:ce(b==null?void 0:b.x)?b.x:void 0,y:ce(b==null?void 0:b.y)?b.y:void 0,width:ce(b==null?void 0:b.width)?b.width:void 0,height:ce(b==null?void 0:b.height)?b.height:void 0,rotation:ce(b.rotation)?Number(b.rotation):void 0,opacity:ce(b.opacity)?Number(b.opacity):void 0,scale:ce(b.scale)?Number(b.scale):void 0,hidden:ce(b.hidden)?Boolean(b.hidden):void 0,children:Array.isArray(b.children)?[...b.children]:void 0,parentId:ce(b.parentId)?String(b.parentId):void 0,metadata:ce(b==null?void 0:b.metadata)?b.metadata:void 0,requestMetadata:ce(b==null?void 0:b.requestMetadata)?b.requestMetadata:void 0,requestAnimation:Array.isArray(b==null?void 0:b.requestAnimation)?b.requestAnimation.map(N=>a.LayerAnimation.fromJSON(N)):[]}},toJSON(b){const N={};return b.type!==void 0&&(N.type=b.type),b.data!==void 0&&(N.data=b.data),b.x!==void 0&&(N.x=b.x),b.y!==void 0&&(N.y=b.y),b.width!==void 0&&(N.width=b.width),b.height!==void 0&&(N.height=b.height),b.rotation!==void 0&&(N.rotation=b.rotation),b.opacity!==void 0&&(N.opacity=b.opacity),b.scale!==void 0&&(N.scale=b.scale),b.hidden!==void 0&&(N.hidden=b.hidden),b.children!==void 0&&(N.children=b.children),b.parentId!==void 0&&(N.parentId=b.parentId),b.metadata!==void 0&&(N.metadata=b.metadata),b.requestMetadata!==void 0&&(N.requestMetadata=b.requestMetadata),b.requestAnimation?N.requestAnimation=b.requestAnimation.map(V=>V?a.LayerAnimation.toJSON(V):void 0):N.requestAnimation=[],N},fromPartial(b){var N,V,se,re,ue,we,Be,Je,De,Le,He,je,Ye,ze,xe;const $e=Ke();return $e.type=(N=b.type)!==null&&N!==void 0?N:void 0,$e.data=(V=b.data)!==null&&V!==void 0?V:void 0,$e.x=(se=b.x)!==null&&se!==void 0?se:void 0,$e.y=(re=b.y)!==null&&re!==void 0?re:void 0,$e.width=(ue=b.width)!==null&&ue!==void 0?ue:void 0,$e.height=(we=b.height)!==null&&we!==void 0?we:void 0,$e.rotation=(Be=b.rotation)!==null&&Be!==void 0?Be:void 0,$e.opacity=(Je=b.opacity)!==null&&Je!==void 0?Je:void 0,$e.scale=(De=b.scale)!==null&&De!==void 0?De:void 0,$e.hidden=(Le=b.hidden)!==null&&Le!==void 0?Le:void 0,$e.children=(He=b.children)!==null&&He!==void 0?He:void 0,$e.parentId=(je=b.parentId)!==null&&je!==void 0?je:void 0,$e.metadata=(Ye=b.metadata)!==null&&Ye!==void 0?Ye:void 0,$e.requestMetadata=(ze=b.requestMetadata)!==null&&ze!==void 0?ze:void 0,$e.requestAnimation=((xe=b.requestAnimation)===null||xe===void 0?void 0:xe.map(Ie=>a.LayerAnimation.fromPartial(Ie)))||[],$e}};function et(){return{id:"",type:void 0,data:void 0,x:void 0,y:void 0,width:void 0,height:void 0,rotation:void 0,opacity:void 0,scale:void 0,hidden:void 0,children:void 0,parentId:void 0,metadata:void 0,requestMetadata:void 0,requestAnimation:[]}}a.PartialLayerWithID={encode(b,N=p.Writer.create()){b.id!==""&&N.uint32(8002).string(b.id),b.type!==void 0&&N.uint32(10).string(b.type),b.data!==void 0&&y.Struct.encode(y.Struct.wrap(b.data),N.uint32(18).fork()).ldelim(),b.x!==void 0&&y.Value.encode(y.Value.wrap(b.x),N.uint32(26).fork()).ldelim(),b.y!==void 0&&y.Value.encode(y.Value.wrap(b.y),N.uint32(34).fork()).ldelim(),b.width!==void 0&&y.Value.encode(y.Value.wrap(b.width),N.uint32(42).fork()).ldelim(),b.height!==void 0&&y.Value.encode(y.Value.wrap(b.height),N.uint32(50).fork()).ldelim(),b.rotation!==void 0&&N.uint32(57).double(b.rotation),b.opacity!==void 0&&N.uint32(65).double(b.opacity),b.scale!==void 0&&N.uint32(73).double(b.scale),b.hidden!==void 0&&N.uint32(80).bool(b.hidden),b.children!==void 0&&y.ListValue.encode(y.ListValue.wrap(b.children),N.uint32(98).fork()).ldelim(),b.parentId!==void 0&&N.uint32(106).string(b.parentId),b.metadata!==void 0&&y.Value.encode(y.Value.wrap(b.metadata),N.uint32(114).fork()).ldelim(),b.requestMetadata!==void 0&&y.Value.encode(y.Value.wrap(b.requestMetadata),N.uint32(802).fork()).ldelim();for(const V of b.requestAnimation)a.LayerAnimation.encode(V,N.uint32(826).fork()).ldelim();return N},decode(b,N){const V=b instanceof p.Reader?b:new p.Reader(b);let se=N===void 0?V.len:V.pos+N;const re=et();for(;V.pos<se;){const ue=V.uint32();switch(ue>>>3){case 1e3:re.id=V.string();break;case 1:re.type=V.string();break;case 2:re.data=y.Struct.unwrap(y.Struct.decode(V,V.uint32()));break;case 3:re.x=y.Value.unwrap(y.Value.decode(V,V.uint32()));break;case 4:re.y=y.Value.unwrap(y.Value.decode(V,V.uint32()));break;case 5:re.width=y.Value.unwrap(y.Value.decode(V,V.uint32()));break;case 6:re.height=y.Value.unwrap(y.Value.decode(V,V.uint32()));break;case 7:re.rotation=V.double();break;case 8:re.opacity=V.double();break;case 9:re.scale=V.double();break;case 10:re.hidden=V.bool();break;case 12:re.children=y.ListValue.unwrap(y.ListValue.decode(V,V.uint32()));break;case 13:re.parentId=V.string();break;case 14:re.metadata=y.Value.unwrap(y.Value.decode(V,V.uint32()));break;case 100:re.requestMetadata=y.Value.unwrap(y.Value.decode(V,V.uint32()));break;case 103:re.requestAnimation.push(a.LayerAnimation.decode(V,V.uint32()));break;default:V.skipType(ue&7);break}}return re},fromJSON(b){return{id:ce(b.id)?String(b.id):"",type:ce(b.type)?String(b.type):void 0,data:at(b.data)?b.data:void 0,x:ce(b==null?void 0:b.x)?b.x:void 0,y:ce(b==null?void 0:b.y)?b.y:void 0,width:ce(b==null?void 0:b.width)?b.width:void 0,height:ce(b==null?void 0:b.height)?b.height:void 0,rotation:ce(b.rotation)?Number(b.rotation):void 0,opacity:ce(b.opacity)?Number(b.opacity):void 0,scale:ce(b.scale)?Number(b.scale):void 0,hidden:ce(b.hidden)?Boolean(b.hidden):void 0,children:Array.isArray(b.children)?[...b.children]:void 0,parentId:ce(b.parentId)?String(b.parentId):void 0,metadata:ce(b==null?void 0:b.metadata)?b.metadata:void 0,requestMetadata:ce(b==null?void 0:b.requestMetadata)?b.requestMetadata:void 0,requestAnimation:Array.isArray(b==null?void 0:b.requestAnimation)?b.requestAnimation.map(N=>a.LayerAnimation.fromJSON(N)):[]}},toJSON(b){const N={};return b.id!==void 0&&(N.id=b.id),b.type!==void 0&&(N.type=b.type),b.data!==void 0&&(N.data=b.data),b.x!==void 0&&(N.x=b.x),b.y!==void 0&&(N.y=b.y),b.width!==void 0&&(N.width=b.width),b.height!==void 0&&(N.height=b.height),b.rotation!==void 0&&(N.rotation=b.rotation),b.opacity!==void 0&&(N.opacity=b.opacity),b.scale!==void 0&&(N.scale=b.scale),b.hidden!==void 0&&(N.hidden=b.hidden),b.children!==void 0&&(N.children=b.children),b.parentId!==void 0&&(N.parentId=b.parentId),b.metadata!==void 0&&(N.metadata=b.metadata),b.requestMetadata!==void 0&&(N.requestMetadata=b.requestMetadata),b.requestAnimation?N.requestAnimation=b.requestAnimation.map(V=>V?a.LayerAnimation.toJSON(V):void 0):N.requestAnimation=[],N},fromPartial(b){var N,V,se,re,ue,we,Be,Je,De,Le,He,je,Ye,ze,xe,$e;const Ie=et();return Ie.id=(N=b.id)!==null&&N!==void 0?N:"",Ie.type=(V=b.type)!==null&&V!==void 0?V:void 0,Ie.data=(se=b.data)!==null&&se!==void 0?se:void 0,Ie.x=(re=b.x)!==null&&re!==void 0?re:void 0,Ie.y=(ue=b.y)!==null&&ue!==void 0?ue:void 0,Ie.width=(we=b.width)!==null&&we!==void 0?we:void 0,Ie.height=(Be=b.height)!==null&&Be!==void 0?Be:void 0,Ie.rotation=(Je=b.rotation)!==null&&Je!==void 0?Je:void 0,Ie.opacity=(De=b.opacity)!==null&&De!==void 0?De:void 0,Ie.scale=(Le=b.scale)!==null&&Le!==void 0?Le:void 0,Ie.hidden=(He=b.hidden)!==null&&He!==void 0?He:void 0,Ie.children=(je=b.children)!==null&&je!==void 0?je:void 0,Ie.parentId=(Ye=b.parentId)!==null&&Ye!==void 0?Ye:void 0,Ie.metadata=(ze=b.metadata)!==null&&ze!==void 0?ze:void 0,Ie.requestMetadata=(xe=b.requestMetadata)!==null&&xe!==void 0?xe:void 0,Ie.requestAnimation=(($e=b.requestAnimation)===null||$e===void 0?void 0:$e.map(it=>a.LayerAnimation.fromPartial(it)))||[],Ie}};function ve(){return{layoutId:""}}a.ListLayersRequest={encode(b,N=p.Writer.create()){return b.layoutId!==""&&N.uint32(10).string(b.layoutId),N},decode(b,N){const V=b instanceof p.Reader?b:new p.Reader(b);let se=N===void 0?V.len:V.pos+N;const re=ve();for(;V.pos<se;){const ue=V.uint32();switch(ue>>>3){case 1:re.layoutId=V.string();break;default:V.skipType(ue&7);break}}return re},fromJSON(b){return{layoutId:ce(b.layoutId)?String(b.layoutId):""}},toJSON(b){const N={};return b.layoutId!==void 0&&(N.layoutId=b.layoutId),N},fromPartial(b){var N;const V=ve();return V.layoutId=(N=b.layoutId)!==null&&N!==void 0?N:"",V}};function Oe(){return{layers:[]}}a.ListLayersResponse={encode(b,N=p.Writer.create()){for(const V of b.layers)a.Layer.encode(V,N.uint32(10).fork()).ldelim();return N},decode(b,N){const V=b instanceof p.Reader?b:new p.Reader(b);let se=N===void 0?V.len:V.pos+N;const re=Oe();for(;V.pos<se;){const ue=V.uint32();switch(ue>>>3){case 1:re.layers.push(a.Layer.decode(V,V.uint32()));break;default:V.skipType(ue&7);break}}return re},fromJSON(b){return{layers:Array.isArray(b==null?void 0:b.layers)?b.layers.map(N=>a.Layer.fromJSON(N)):[]}},toJSON(b){const N={};return b.layers?N.layers=b.layers.map(V=>V?a.Layer.toJSON(V):void 0):N.layers=[],N},fromPartial(b){var N;const V=Oe();return V.layers=((N=b.layers)===null||N===void 0?void 0:N.map(se=>a.Layer.fromPartial(se)))||[],V}};function Ee(){return{layoutId:"",layer:void 0}}a.CreateLayerRequest={encode(b,N=p.Writer.create()){return b.layoutId!==""&&N.uint32(10).string(b.layoutId),b.layer!==void 0&&a.PartialLayer.encode(b.layer,N.uint32(18).fork()).ldelim(),N},decode(b,N){const V=b instanceof p.Reader?b:new p.Reader(b);let se=N===void 0?V.len:V.pos+N;const re=Ee();for(;V.pos<se;){const ue=V.uint32();switch(ue>>>3){case 1:re.layoutId=V.string();break;case 2:re.layer=a.PartialLayer.decode(V,V.uint32());break;default:V.skipType(ue&7);break}}return re},fromJSON(b){return{layoutId:ce(b.layoutId)?String(b.layoutId):"",layer:ce(b.layer)?a.PartialLayer.fromJSON(b.layer):void 0}},toJSON(b){const N={};return b.layoutId!==void 0&&(N.layoutId=b.layoutId),b.layer!==void 0&&(N.layer=b.layer?a.PartialLayer.toJSON(b.layer):void 0),N},fromPartial(b){var N;const V=Ee();return V.layoutId=(N=b.layoutId)!==null&&N!==void 0?N:"",V.layer=b.layer!==void 0&&b.layer!==null?a.PartialLayer.fromPartial(b.layer):void 0,V}};function Ae(){return{layoutId:"",layerId:""}}a.GetLayerRequest={encode(b,N=p.Writer.create()){return b.layoutId!==""&&N.uint32(10).string(b.layoutId),b.layerId!==""&&N.uint32(18).string(b.layerId),N},decode(b,N){const V=b instanceof p.Reader?b:new p.Reader(b);let se=N===void 0?V.len:V.pos+N;const re=Ae();for(;V.pos<se;){const ue=V.uint32();switch(ue>>>3){case 1:re.layoutId=V.string();break;case 2:re.layerId=V.string();break;default:V.skipType(ue&7);break}}return re},fromJSON(b){return{layoutId:ce(b.layoutId)?String(b.layoutId):"",layerId:ce(b.layerId)?String(b.layerId):""}},toJSON(b){const N={};return b.layoutId!==void 0&&(N.layoutId=b.layoutId),b.layerId!==void 0&&(N.layerId=b.layerId),N},fromPartial(b){var N,V;const se=Ae();return se.layoutId=(N=b.layoutId)!==null&&N!==void 0?N:"",se.layerId=(V=b.layerId)!==null&&V!==void 0?V:"",se}};function be(){return{layoutId:"",layerId:"",layer:void 0}}a.UpdateLayerRequest={encode(b,N=p.Writer.create()){return b.layoutId!==""&&N.uint32(10).string(b.layoutId),b.layerId!==""&&N.uint32(18).string(b.layerId),b.layer!==void 0&&a.PartialLayer.encode(b.layer,N.uint32(26).fork()).ldelim(),N},decode(b,N){const V=b instanceof p.Reader?b:new p.Reader(b);let se=N===void 0?V.len:V.pos+N;const re=be();for(;V.pos<se;){const ue=V.uint32();switch(ue>>>3){case 1:re.layoutId=V.string();break;case 2:re.layerId=V.string();break;case 3:re.layer=a.PartialLayer.decode(V,V.uint32());break;default:V.skipType(ue&7);break}}return re},fromJSON(b){return{layoutId:ce(b.layoutId)?String(b.layoutId):"",layerId:ce(b.layerId)?String(b.layerId):"",layer:ce(b.layer)?a.PartialLayer.fromJSON(b.layer):void 0}},toJSON(b){const N={};return b.layoutId!==void 0&&(N.layoutId=b.layoutId),b.layerId!==void 0&&(N.layerId=b.layerId),b.layer!==void 0&&(N.layer=b.layer?a.PartialLayer.toJSON(b.layer):void 0),N},fromPartial(b){var N,V;const se=be();return se.layoutId=(N=b.layoutId)!==null&&N!==void 0?N:"",se.layerId=(V=b.layerId)!==null&&V!==void 0?V:"",se.layer=b.layer!==void 0&&b.layer!==null?a.PartialLayer.fromPartial(b.layer):void 0,se}};function Qe(){return{requestMetadata:void 0}}a.DeleteLayerPayload={encode(b,N=p.Writer.create()){return b.requestMetadata!==void 0&&y.Value.encode(y.Value.wrap(b.requestMetadata),N.uint32(802).fork()).ldelim(),N},decode(b,N){const V=b instanceof p.Reader?b:new p.Reader(b);let se=N===void 0?V.len:V.pos+N;const re=Qe();for(;V.pos<se;){const ue=V.uint32();switch(ue>>>3){case 100:re.requestMetadata=y.Value.unwrap(y.Value.decode(V,V.uint32()));break;default:V.skipType(ue&7);break}}return re},fromJSON(b){return{requestMetadata:ce(b==null?void 0:b.requestMetadata)?b.requestMetadata:void 0}},toJSON(b){const N={};return b.requestMetadata!==void 0&&(N.requestMetadata=b.requestMetadata),N},fromPartial(b){var N;const V=Qe();return V.requestMetadata=(N=b.requestMetadata)!==null&&N!==void 0?N:void 0,V}};function Re(){return{id:"",requestMetadata:void 0}}a.BatchDeleteLayerRequest={encode(b,N=p.Writer.create()){return b.id!==""&&N.uint32(10).string(b.id),b.requestMetadata!==void 0&&y.Value.encode(y.Value.wrap(b.requestMetadata),N.uint32(802).fork()).ldelim(),N},decode(b,N){const V=b instanceof p.Reader?b:new p.Reader(b);let se=N===void 0?V.len:V.pos+N;const re=Re();for(;V.pos<se;){const ue=V.uint32();switch(ue>>>3){case 1:re.id=V.string();break;case 100:re.requestMetadata=y.Value.unwrap(y.Value.decode(V,V.uint32()));break;default:V.skipType(ue&7);break}}return re},fromJSON(b){return{id:ce(b.id)?String(b.id):"",requestMetadata:ce(b==null?void 0:b.requestMetadata)?b.requestMetadata:void 0}},toJSON(b){const N={};return b.id!==void 0&&(N.id=b.id),b.requestMetadata!==void 0&&(N.requestMetadata=b.requestMetadata),N},fromPartial(b){var N,V;const se=Re();return se.id=(N=b.id)!==null&&N!==void 0?N:"",se.requestMetadata=(V=b.requestMetadata)!==null&&V!==void 0?V:void 0,se}};function Xe(){return{layoutId:"",layers:[],requestMetadata:void 0,requestAnimationMode:void 0}}a.BatchLayerRequest={encode(b,N=p.Writer.create()){b.layoutId!==""&&N.uint32(10).string(b.layoutId);for(const V of b.layers)a.BatchLayerRequest_BatchItem.encode(V,N.uint32(18).fork()).ldelim();return b.requestMetadata!==void 0&&y.Value.encode(y.Value.wrap(b.requestMetadata),N.uint32(802).fork()).ldelim(),b.requestAnimationMode!==void 0&&N.uint32(808).int32(U(b.requestAnimationMode)),N},decode(b,N){const V=b instanceof p.Reader?b:new p.Reader(b);let se=N===void 0?V.len:V.pos+N;const re=Xe();for(;V.pos<se;){const ue=V.uint32();switch(ue>>>3){case 1:re.layoutId=V.string();break;case 2:re.layers.push(a.BatchLayerRequest_BatchItem.decode(V,V.uint32()));break;case 100:re.requestMetadata=y.Value.unwrap(y.Value.decode(V,V.uint32()));break;case 101:re.requestAnimationMode=A(V.int32());break;default:V.skipType(ue&7);break}}return re},fromJSON(b){return{layoutId:ce(b.layoutId)?String(b.layoutId):"",layers:Array.isArray(b==null?void 0:b.layers)?b.layers.map(N=>a.BatchLayerRequest_BatchItem.fromJSON(N)):[],requestMetadata:ce(b==null?void 0:b.requestMetadata)?b.requestMetadata:void 0,requestAnimationMode:ce(b.requestAnimationMode)?A(b.requestAnimationMode):void 0}},toJSON(b){const N={};return b.layoutId!==void 0&&(N.layoutId=b.layoutId),b.layers?N.layers=b.layers.map(V=>V?a.BatchLayerRequest_BatchItem.toJSON(V):void 0):N.layers=[],b.requestMetadata!==void 0&&(N.requestMetadata=b.requestMetadata),b.requestAnimationMode!==void 0&&(N.requestAnimationMode=b.requestAnimationMode!==void 0?q(b.requestAnimationMode):void 0),N},fromPartial(b){var N,V,se,re;const ue=Xe();return ue.layoutId=(N=b.layoutId)!==null&&N!==void 0?N:"",ue.layers=((V=b.layers)===null||V===void 0?void 0:V.map(we=>a.BatchLayerRequest_BatchItem.fromPartial(we)))||[],ue.requestMetadata=(se=b.requestMetadata)!==null&&se!==void 0?se:void 0,ue.requestAnimationMode=(re=b.requestAnimationMode)!==null&&re!==void 0?re:void 0,ue}};function Me(){return{create:void 0,update:void 0,delete:void 0}}a.BatchLayerRequest_BatchItem={encode(b,N=p.Writer.create()){return b.create!==void 0&&a.PartialLayer.encode(b.create,N.uint32(10).fork()).ldelim(),b.update!==void 0&&a.PartialLayerWithID.encode(b.update,N.uint32(18).fork()).ldelim(),b.delete!==void 0&&a.BatchDeleteLayerRequest.encode(b.delete,N.uint32(26).fork()).ldelim(),N},decode(b,N){const V=b instanceof p.Reader?b:new p.Reader(b);let se=N===void 0?V.len:V.pos+N;const re=Me();for(;V.pos<se;){const ue=V.uint32();switch(ue>>>3){case 1:re.create=a.PartialLayer.decode(V,V.uint32());break;case 2:re.update=a.PartialLayerWithID.decode(V,V.uint32());break;case 3:re.delete=a.BatchDeleteLayerRequest.decode(V,V.uint32());break;default:V.skipType(ue&7);break}}return re},fromJSON(b){return{create:ce(b.create)?a.PartialLayer.fromJSON(b.create):void 0,update:ce(b.update)?a.PartialLayerWithID.fromJSON(b.update):void 0,delete:ce(b.delete)?a.BatchDeleteLayerRequest.fromJSON(b.delete):void 0}},toJSON(b){const N={};return b.create!==void 0&&(N.create=b.create?a.PartialLayer.toJSON(b.create):void 0),b.update!==void 0&&(N.update=b.update?a.PartialLayerWithID.toJSON(b.update):void 0),b.delete!==void 0&&(N.delete=b.delete?a.BatchDeleteLayerRequest.toJSON(b.delete):void 0),N},fromPartial(b){const N=Me();return N.create=b.create!==void 0&&b.create!==null?a.PartialLayer.fromPartial(b.create):void 0,N.update=b.update!==void 0&&b.update!==null?a.PartialLayerWithID.fromPartial(b.update):void 0,N.delete=b.delete!==void 0&&b.delete!==null?a.BatchDeleteLayerRequest.fromPartial(b.delete):void 0,N}};function Ze(){return{create:void 0,update:void 0,delete:void 0}}a.LayoutEvent={encode(b,N=p.Writer.create()){return b.create!==void 0&&a.Layout.encode(b.create,N.uint32(10).fork()).ldelim(),b.update!==void 0&&a.Layout.encode(b.update,N.uint32(18).fork()).ldelim(),b.delete!==void 0&&a.DeleteLayoutResponse.encode(b.delete,N.uint32(26).fork()).ldelim(),N},decode(b,N){const V=b instanceof p.Reader?b:new p.Reader(b);let se=N===void 0?V.len:V.pos+N;const re=Ze();for(;V.pos<se;){const ue=V.uint32();switch(ue>>>3){case 1:re.create=a.Layout.decode(V,V.uint32());break;case 2:re.update=a.Layout.decode(V,V.uint32());break;case 3:re.delete=a.DeleteLayoutResponse.decode(V,V.uint32());break;default:V.skipType(ue&7);break}}return re},fromJSON(b){return{create:ce(b.create)?a.Layout.fromJSON(b.create):void 0,update:ce(b.update)?a.Layout.fromJSON(b.update):void 0,delete:ce(b.delete)?a.DeleteLayoutResponse.fromJSON(b.delete):void 0}},toJSON(b){const N={};return b.create!==void 0&&(N.create=b.create?a.Layout.toJSON(b.create):void 0),b.update!==void 0&&(N.update=b.update?a.Layout.toJSON(b.update):void 0),b.delete!==void 0&&(N.delete=b.delete?a.DeleteLayoutResponse.toJSON(b.delete):void 0),N},fromPartial(b){const N=Ze();return N.create=b.create!==void 0&&b.create!==null?a.Layout.fromPartial(b.create):void 0,N.update=b.update!==void 0&&b.update!==null?a.Layout.fromPartial(b.update):void 0,N.delete=b.delete!==void 0&&b.delete!==null?a.DeleteLayoutResponse.fromPartial(b.delete):void 0,N}};function nt(){return{create:void 0,update:void 0,delete:void 0,batch:void 0}}a.LayerEvent={encode(b,N=p.Writer.create()){return b.create!==void 0&&a.Layer.encode(b.create,N.uint32(10).fork()).ldelim(),b.update!==void 0&&a.Layer.encode(b.update,N.uint32(18).fork()).ldelim(),b.delete!==void 0&&a.DeleteLayerResponse.encode(b.delete,N.uint32(26).fork()).ldelim(),b.batch!==void 0&&a.BatchLayerResponse.encode(b.batch,N.uint32(34).fork()).ldelim(),N},decode(b,N){const V=b instanceof p.Reader?b:new p.Reader(b);let se=N===void 0?V.len:V.pos+N;const re=nt();for(;V.pos<se;){const ue=V.uint32();switch(ue>>>3){case 1:re.create=a.Layer.decode(V,V.uint32());break;case 2:re.update=a.Layer.decode(V,V.uint32());break;case 3:re.delete=a.DeleteLayerResponse.decode(V,V.uint32());break;case 4:re.batch=a.BatchLayerResponse.decode(V,V.uint32());break;default:V.skipType(ue&7);break}}return re},fromJSON(b){return{create:ce(b.create)?a.Layer.fromJSON(b.create):void 0,update:ce(b.update)?a.Layer.fromJSON(b.update):void 0,delete:ce(b.delete)?a.DeleteLayerResponse.fromJSON(b.delete):void 0,batch:ce(b.batch)?a.BatchLayerResponse.fromJSON(b.batch):void 0}},toJSON(b){const N={};return b.create!==void 0&&(N.create=b.create?a.Layer.toJSON(b.create):void 0),b.update!==void 0&&(N.update=b.update?a.Layer.toJSON(b.update):void 0),b.delete!==void 0&&(N.delete=b.delete?a.DeleteLayerResponse.toJSON(b.delete):void 0),b.batch!==void 0&&(N.batch=b.batch?a.BatchLayerResponse.toJSON(b.batch):void 0),N},fromPartial(b){const N=nt();return N.create=b.create!==void 0&&b.create!==null?a.Layer.fromPartial(b.create):void 0,N.update=b.update!==void 0&&b.update!==null?a.Layer.fromPartial(b.update):void 0,N.delete=b.delete!==void 0&&b.delete!==null?a.DeleteLayerResponse.fromPartial(b.delete):void 0,N.batch=b.batch!==void 0&&b.batch!==null?a.BatchLayerResponse.fromPartial(b.batch):void 0,N}};function rt(){return{layout:void 0,layer:void 0}}a.Event={encode(b,N=p.Writer.create()){return b.layout!==void 0&&a.LayoutEvent.encode(b.layout,N.uint32(10).fork()).ldelim(),b.layer!==void 0&&a.LayerEvent.encode(b.layer,N.uint32(18).fork()).ldelim(),N},decode(b,N){const V=b instanceof p.Reader?b:new p.Reader(b);let se=N===void 0?V.len:V.pos+N;const re=rt();for(;V.pos<se;){const ue=V.uint32();switch(ue>>>3){case 1:re.layout=a.LayoutEvent.decode(V,V.uint32());break;case 2:re.layer=a.LayerEvent.decode(V,V.uint32());break;default:V.skipType(ue&7);break}}return re},fromJSON(b){return{layout:ce(b.layout)?a.LayoutEvent.fromJSON(b.layout):void 0,layer:ce(b.layer)?a.LayerEvent.fromJSON(b.layer):void 0}},toJSON(b){const N={};return b.layout!==void 0&&(N.layout=b.layout?a.LayoutEvent.toJSON(b.layout):void 0),b.layer!==void 0&&(N.layer=b.layer?a.LayerEvent.toJSON(b.layer):void 0),N},fromPartial(b){const N=rt();return N.layout=b.layout!==void 0&&b.layout!==null?a.LayoutEvent.fromPartial(b.layout):void 0,N.layer=b.layer!==void 0&&b.layer!==null?a.LayerEvent.fromPartial(b.layer):void 0,N}};class Ue{constructor(N){this.rpc=N,this.ListLayers=this.ListLayers.bind(this),this.CreateLayer=this.CreateLayer.bind(this),this.GetLayer=this.GetLayer.bind(this),this.UpdateLayer=this.UpdateLayer.bind(this),this.DeleteLayer=this.DeleteLayer.bind(this),this.Batch=this.Batch.bind(this)}ListLayers(N){const V=a.ListLayersRequest.encode(N).finish();return this.rpc.request("apis.layout.v2.LayerService","ListLayers",V).then(re=>a.ListLayersResponse.decode(new p.Reader(re)))}CreateLayer(N){const V=a.CreateLayerRequest.encode(N).finish();return this.rpc.request("apis.layout.v2.LayerService","CreateLayer",V).then(re=>a.Layer.decode(new p.Reader(re)))}GetLayer(N){const V=a.GetLayerRequest.encode(N).finish();return this.rpc.request("apis.layout.v2.LayerService","GetLayer",V).then(re=>a.Layer.decode(new p.Reader(re)))}UpdateLayer(N){const V=a.UpdateLayerRequest.encode(N).finish();return this.rpc.request("apis.layout.v2.LayerService","UpdateLayer",V).then(re=>a.Layer.decode(new p.Reader(re)))}DeleteLayer(N){const V=a.DeleteLayerRequest.encode(N).finish();return this.rpc.request("apis.layout.v2.LayerService","DeleteLayer",V).then(re=>a.DeleteLayerResponse.decode(new p.Reader(re)))}Batch(N){const V=a.BatchLayerRequest.encode(N).finish();return this.rpc.request("apis.layout.v2.LayerService","Batch",V).then(re=>a.BatchLayerResponse.decode(new p.Reader(re)))}}a.LayerServiceClientImpl=Ue,a.LayerServiceDefinition={name:"LayerService",fullName:"apis.layout.v2.LayerService",methods:{listLayers:{name:"ListLayers",requestType:a.ListLayersRequest,requestStream:!1,responseType:a.ListLayersResponse,responseStream:!1,options:{}},createLayer:{name:"CreateLayer",requestType:a.CreateLayerRequest,requestStream:!1,responseType:a.Layer,responseStream:!1,options:{}},getLayer:{name:"GetLayer",requestType:a.GetLayerRequest,requestStream:!1,responseType:a.Layer,responseStream:!1,options:{}},updateLayer:{name:"UpdateLayer",requestType:a.UpdateLayerRequest,requestStream:!1,responseType:a.Layer,responseStream:!1,options:{}},deleteLayer:{name:"DeleteLayer",requestType:a.DeleteLayerRequest,requestStream:!1,responseType:a.DeleteLayerResponse,responseStream:!1,options:{}},batch:{name:"Batch",requestType:a.BatchLayerRequest,requestStream:!1,responseType:a.BatchLayerResponse,responseStream:!1,options:{}}}};class ot{constructor(N){this.rpc=N,this.ListLayouts=this.ListLayouts.bind(this),this.CreateLayout=this.CreateLayout.bind(this),this.GetLayout=this.GetLayout.bind(this),this.UpdateLayout=this.UpdateLayout.bind(this),this.DeleteLayout=this.DeleteLayout.bind(this)}ListLayouts(N){const V=a.ListLayoutsRequest.encode(N).finish();return this.rpc.request("apis.layout.v2.LayoutService","ListLayouts",V).then(re=>a.ListLayoutsResponse.decode(new p.Reader(re)))}CreateLayout(N){const V=a.CreateLayoutRequest.encode(N).finish();return this.rpc.request("apis.layout.v2.LayoutService","CreateLayout",V).then(re=>a.Layout.decode(new p.Reader(re)))}GetLayout(N){const V=a.GetLayoutRequest.encode(N).finish();return this.rpc.request("apis.layout.v2.LayoutService","GetLayout",V).then(re=>a.Layout.decode(new p.Reader(re)))}UpdateLayout(N){const V=a.UpdateLayoutRequest.encode(N).finish();return this.rpc.request("apis.layout.v2.LayoutService","UpdateLayout",V).then(re=>a.Layout.decode(new p.Reader(re)))}DeleteLayout(N){const V=a.DeleteLayoutRequest.encode(N).finish();return this.rpc.request("apis.layout.v2.LayoutService","DeleteLayout",V).then(re=>a.DeleteLayoutResponse.decode(new p.Reader(re)))}}a.LayoutServiceClientImpl=ot,a.LayoutServiceDefinition={name:"LayoutService",fullName:"apis.layout.v2.LayoutService",methods:{listLayouts:{name:"ListLayouts",requestType:a.ListLayoutsRequest,requestStream:!1,responseType:a.ListLayoutsResponse,responseStream:!1,options:{}},createLayout:{name:"CreateLayout",requestType:a.CreateLayoutRequest,requestStream:!1,responseType:a.Layout,responseStream:!1,options:{}},getLayout:{name:"GetLayout",requestType:a.GetLayoutRequest,requestStream:!1,responseType:a.Layout,responseStream:!1,options:{}},updateLayout:{name:"UpdateLayout",requestType:a.UpdateLayoutRequest,requestStream:!1,responseType:a.Layout,responseStream:!1,options:{}},deleteLayout:{name:"DeleteLayout",requestType:a.DeleteLayoutRequest,requestStream:!1,responseType:a.DeleteLayoutResponse,responseStream:!1,options:{}}}};var tt=(()=>{if(typeof tt!="undefined")return tt;if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof commonjsGlobal!="undefined")return commonjsGlobal;throw"Unable to locate global object"})();p.util.Long!==h.default&&(p.util.Long=h.default,p.configure());function at(b){return typeof b=="object"&&b!==null}function ce(b){return b!=null}}(api$3),function(a){var s=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(l,h,p,y){y===void 0&&(y=p),Object.defineProperty(l,y,{enumerable:!0,get:function(){return h[p]}})}:function(l,h,p,y){y===void 0&&(y=p),l[y]=h[p]}),d=commonjsGlobal&&commonjsGlobal.__exportStar||function(l,h){for(var p in l)p!=="default"&&!h.hasOwnProperty(p)&&s(h,l,p)};Object.defineProperty(a,"__esModule",{value:!0}),a.layoutApiEventMap=void 0;const c=api$3;d(api$3,a),a.layoutApiEventMap={[c.EventType.EVENT_TYPE_LAYOUT]:"layout",[c.EventType.EVENT_TYPE_LAYER]:"layer",[c.EventType.EVENT_TYPE_UNSPECIFIED]:"unspecified"}}(dist$3);var api$2={},browser$2=!1,__viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$3=getAugmentedNamespace(__viteBrowserExternal$1),logger$1={};class EnhancedMap extends Map{computeIfAbsent(s,d){if(this.has(s))return this.get(s);const c=d(s);return this.set(s,c),c}computeIfPresent(s,d){const c=this.get(s);if(c===void 0)return;const l=d(s,c);return l!==void 0?this.set(s,l):this.delete(s),l}compute(s,d){const c=this.get(s),l=d(s,c);return l?this.set(s,l):this.delete(s),l}}var InternalLogLevel;(function(a){a[a.Trace=0]="Trace",a[a.Debug=1]="Debug",a[a.Info=2]="Info",a[a.Warn=3]="Warn",a[a.Error=4]="Error"})(InternalLogLevel||(InternalLogLevel={}));function getInternalLogger(a){return provider.getLogger(a)}const INTERNAL_LOGGING_SETTINGS={setInternalLogLevel:a=>provider.changeLogLevel(a),setOutput:a=>provider.changeOutput(a),reset:()=>provider.reset()};class InternalLoggerImpl{constructor(s,d,c){this._name=s,this._level=d,this._fnOutput=c}trace(s){this.log(InternalLogLevel.Trace,s)}debug(s){this.log(InternalLogLevel.Debug,s)}error(s,d){this.log(InternalLogLevel.Error,s,d)}info(s){this.log(InternalLogLevel.Info,s)}warn(s,d){this.log(InternalLogLevel.Warn,s,d)}setLevel(s){this._level=s}setOutput(s){this._fnOutput=s}log(s,d,c){this._level>s||this._fnOutput(`${InternalLogLevel[this._level].toString()} <INTERNAL LOGGER> ${this._name} ${d()}${c?`
`+c.stack:""}`)}}class InternalProviderImpl{constructor(){this._loggers=new EnhancedMap,this._logLevel=InternalLogLevel.Error,this._fnOutput=InternalProviderImpl.logConsole}getLogger(s){return this._loggers.computeIfAbsent(s,d=>new InternalLoggerImpl(d,this._logLevel,this._fnOutput))}changeLogLevel(s){this._logLevel=s,this._loggers.forEach(d=>d.setLevel(s))}changeOutput(s){this._fnOutput=s,this._loggers.forEach(d=>d.setOutput(this._fnOutput))}reset(){this.changeLogLevel(InternalLogLevel.Error),this._fnOutput=InternalProviderImpl.logConsole,this._loggers.forEach(s=>s.setOutput(this._fnOutput))}static logConsole(s){console&&console.log&&console.log(s)}}const provider=new InternalProviderImpl;var InternalLogger=Object.freeze({__proto__:null,get InternalLogLevel(){return InternalLogLevel},getInternalLogger,INTERNAL_LOGGING_SETTINGS}),LogLevel;(function(a){a[a.Trace=0]="Trace",a[a.Debug=1]="Debug",a[a.Info=2]="Info",a[a.Warn=3]="Warn",a[a.Error=4]="Error",a[a.Fatal=5]="Fatal"})(LogLevel||(LogLevel={})),function(a){function s(d){switch(d.toLowerCase()){case"trace":return a.Trace;case"debug":return a.Debug;case"info":return a.Info;case"warn":return a.Warn;case"error":return a.Error;case"fatal":return a.Fatal;default:return}}a.toLogLevel=s}(LogLevel||(LogLevel={}));class CoreLoggerImpl{constructor(s){this._runtime=s}get id(){return this._runtime.id}get logLevel(){return this._runtime.level}get runtimeSettings(){return Object.assign({},this._runtime)}set runtimeSettings(s){this._runtime=s}trace(s,...d){this.logMessage(LogLevel.Trace,s,d)}debug(s,...d){this.logMessage(LogLevel.Debug,s,d)}info(s,...d){this.logMessage(LogLevel.Info,s,d)}warn(s,...d){this.logMessage(LogLevel.Warn,s,d)}error(s,...d){this.logMessage(LogLevel.Error,s,d)}fatal(s,...d){this.logMessage(LogLevel.Fatal,s,d)}logMessage(s,d,c){if(this._runtime.level>s)return;const l=Date.now(),h=typeof d=="string"?d:d(),p=CoreLoggerImpl.getErrorAndArgs(c);switch(this._runtime.channel.type){case"RawLogChannel":this._runtime.channel.write({message:h,exception:p.error,args:p.args,timeInMillis:l,level:s,logNames:this._runtime.name},this._runtime.argumentFormatter);return;case"LogChannel":this._runtime.channel.write(this.createLogMessage(h,s,p,l));break}}formatArgValue(s){try{return this._runtime.argumentFormatter(s)}catch{return`>>ARG CONVERT FAILED: '${s!==void 0?s.toString():"undefined"}'<<`}}createLogMessage(s,d,c,l){let h;const p=c.error,y=c.args;p&&(h=`${p.name}: ${p.message}`,p.stack&&(h+=`@
${p.stack}`));const _=this._runtime.dateFormatter(l);let E=LogLevel[d].toUpperCase();E.length<5&&(E+=" ");const O=typeof this._runtime.name=="string"?this._runtime.name:this._runtime.name.join(", "),P=typeof y!="undefined"&&y.length>0?" ["+y.map(A=>this.formatArgValue(A)).join(", ")+"]":"";return{message:_+" "+E+" ["+O+"] "+s+P,error:h}}static getErrorAndArgs(s){if(s.length===0)return{};let d,c;const l=s[0];if(l instanceof Error)return d=l,c=s.length>1?s.slice(1):void 0,{error:d,args:c};if(typeof l=="function"){const h=l();return h instanceof Error?(d=h,c=s.length>1?s.slice(1):void 0,{error:d,args:c}):s.length===1?Array.isArray(h)?{args:h.length>0?h:void 0}:{args:h}:Array.isArray(h)?{args:[...h,...s.slice(1)]}:{args:[h,...s.slice(1)]}}return{args:s}}}function padStart(a,s,d=" "){return padInternal(a,s,"start",d)}function padEnd(a,s,d=" "){return padInternal(a,s,"end",d)}function maxLengthStringValueInArray(a){return a.map(s=>s.length).reduce((s,d)=>d>s?d:s,0)}function padInternal(a,s,d,c=" "){if(s<=a.length)return a;if(c.length>1)throw new Error(`Fill char must be one char exactly, it is: ${c.length}`);const l=s-a.length;let h="";for(let p=0;p<l;p++)h+=c;return d==="start"?h+a:a+h}function formatArgument(a){return a===void 0?"undefined":JSON.stringify(a)}function formatDate(a){const s=new Date(a),d=s.getFullYear(),c=padStart((s.getMonth()+1).toString(),2,"0"),l=padStart(s.getDate().toString(),2,"0"),h=padStart(s.getHours().toString(),2,"0"),p=padStart(s.getMinutes().toString(),2,"0"),y=padStart(s.getSeconds().toString(),2,"0"),_=padStart(s.getMilliseconds().toString(),2,"0");return`${d}-${c}-${l} ${h}:${p}:${y},${_}`}class ConsoleLogChannel{constructor(){this.type="LogChannel"}write(s){console&&console.log&&console.log(s.message+(s.error?`
${s.error}`:""))}}var DefaultChannels;(function(a){function s(){return new ConsoleLogChannel}a.createConsoleChannel=s})(DefaultChannels||(DefaultChannels={}));class LogProviderImpl{constructor(s,d){this._log=getInternalLogger("core.impl.LogProviderImpl"),this._name=s,this._settings=d,this._loggers=new EnhancedMap,this._idToKeyMap=new EnhancedMap,this._globalRuntimeSettings={level:d.level,channel:d.channel},this._nextLoggerId=1,this._log.trace(()=>`Created LogProviderImpl with settings: ${JSON.stringify(this._settings)}`)}get runtimeSettings(){return Object.assign(Object.assign({},this._settings),{level:this._globalRuntimeSettings.level,channel:this._globalRuntimeSettings.channel})}getLogger(s){return this.getOrCreateLogger(s)}updateLoggerRuntime(s,d){this._log.debug(()=>`Updating logger ${s.id} runtime settings using: '${JSON.stringify(d)}'`);const c=this._idToKeyMap.get(s.id);return c===void 0?(this._log.warn(()=>`Cannot update logger with id: ${s.id}, it was not found.`),!1):(this._loggers.computeIfPresent(c,(l,h)=>(h.runtimeSettings=LogProviderImpl.mergeRuntimeSettingsIntoLogRuntime(h.runtimeSettings,d),h)),!0)}updateRuntimeSettings(s){this._log.debug(()=>`Updating global runtime settings and updating existing loggers runtime settings using: '${JSON.stringify(s)}'`),this._globalRuntimeSettings={level:s.level!==void 0?s.level:this._globalRuntimeSettings.level,channel:s.channel!==void 0?s.channel:this._globalRuntimeSettings.channel},this._loggers.forEach(d=>d.runtimeSettings=LogProviderImpl.mergeRuntimeSettingsIntoLogRuntime(d.runtimeSettings,s))}clear(){this._loggers.clear(),this._idToKeyMap.clear(),this._globalRuntimeSettings=Object.assign({},this._settings),this._nextLoggerId=1}getOrCreateLogger(s){const d=LogProviderImpl.createKey(s),c=this._loggers.computeIfAbsent(d,()=>{const l={level:this._globalRuntimeSettings.level,channel:this._globalRuntimeSettings.channel,id:this.nextLoggerId(),name:s,argumentFormatter:this._settings.argumentFormatter,dateFormatter:this._settings.dateFormatter};return new CoreLoggerImpl(l)});return this._idToKeyMap.computeIfAbsent(c.id,()=>d),c}nextLoggerId(){const s=this._name+"_"+this._nextLoggerId;return this._nextLoggerId++,s}static mergeRuntimeSettingsIntoLogRuntime(s,d){return Object.assign(Object.assign({},s),{level:d.level!==void 0?d.level:s.level,channel:d.channel!==void 0?d.channel:s.channel})}static createKey(s){return typeof s=="string"?s:s.join(",")}}function createLogProvider(a,s){return new LogProviderImpl(a,s)}var index$3=Object.freeze({__proto__:null,EnhancedMap,padStart,padEnd,maxLengthStringValueInArray});class CategoryImpl{constructor(s,d,c,l){this._children=[],this._logger=s,this._name=d,this._parent=c,this._fnGetOrCreateChildCategory=l}get name(){return this._name}get parent(){return this._parent}get path(){const s=[];let d=this;for(;d!==void 0;)s.push(d.name),d=d.parent;return s.reverse()}get children(){return[...this._children]}addChild(s){if(s.parent!==this)throw new Error(`Cannot add child '${s.name}', expected parent '${this._name} but got ${s.parent?s.parent.name:"undefined"}'`);this._children.push(s)}getChildCategory(s){const d=this._children.find(c=>c.name===s);return d!==void 0?d:this._fnGetOrCreateChildCategory(s,this)}get id(){return this._logger.id}get logLevel(){return this._logger.logLevel}get runtimeSettings(){return this._logger.runtimeSettings}get logger(){return this._logger}trace(s,...d){this._logger.trace(s,...d)}debug(s,...d){this._logger.debug(s,...d)}info(s,...d){this._logger.info(s,...d)}warn(s,...d){this._logger.warn(s,...d)}error(s,...d){this._logger.error(s,...d)}fatal(s,...d){this._logger.fatal(s,...d)}}const CATEGORY_PATH_SEPARATOR="#";class CategoryProviderImpl{constructor(s,d){this._name=s,this._initialConfig=d,this._categoryStorage=new CategoryStorage(s,d)}get name(){return this._name}get config(){return this._initialConfig}get runtimeConfig(){return this._categoryStorage.getCurrentRuntimeConfig()}getCategory(s,d){return this._categoryStorage.getOrCreateCategory(s,d)}updateRuntimeSettingsCategory(s,d){this._categoryStorage.updateRuntimeSettingsCategory(s,d)}updateRuntimeSettings(s){this._categoryStorage.updateRuntimeSettings(s)}getRegisteredCategories(){return this._categoryStorage.getRegisteredCategories()}getCategoryByPath(s){return this._categoryStorage.getCategoryByPath(s)}}class CategoryStorage{constructor(s,d){this._categoriesById=new Map,this._categoriesByPath=new Map,this._categoryProviderName=s,this._allowSameCategoryName=d.allowSameCategoryName,this._logProvider=createLogProvider(s,Object.assign({},d)),this.getOrCreateCategory=this.getOrCreateCategory.bind(this)}getOrCreateCategory(s,d){if(s.indexOf(CATEGORY_PATH_SEPARATOR)!==-1)throw new Error(`Cannot create category '${s}', name cannot contain a '${CATEGORY_PATH_SEPARATOR}'.`);const c=d!==void 0?this.getParentCategory(d):void 0;return c===void 0?this.getOrCreateRootCategory(s):this.getOrCreateChildCategory(s,c)}updateRuntimeSettingsCategory(s,d){if(!s.id.startsWith(this._categoryProviderName))throw new Error(`Category '${s.name}' with LogId '${s.id}' is from a different CategoryProvider, cannot mix categories between providers.`);const c=this._categoriesById.get(s.id);c!==void 0&&(this._logProvider.updateLoggerRuntime(c.logger,{level:d.level}),!(d.disableRecursion!==void 0&&d.disableRecursion)&&c.children.forEach(l=>this.updateRuntimeSettingsCategory(l,d)))}updateRuntimeSettings(s){this._logProvider.updateRuntimeSettings(s)}getCurrentRuntimeConfig(){return Object.assign(Object.assign({},this._logProvider.runtimeSettings),{allowSameCategoryName:this._allowSameCategoryName})}getRegisteredCategories(){return[...this._categoriesById.values()]}getCategoryByPath(s){return this._categoriesByPath.get(s)}getParentCategory(s){let d;if(CategoryStorage.isLogId(s)){if(d=this._categoriesById.get(s),d===void 0)throw new Error(`Parent category was not found by LogId '${s}'. Are you sure you passed in the correct argument?`)}else if(d=this._categoriesById.get(s.id),d===void 0)throw new Error(`Parent category '${s.name}' was not found by it's LogId '${s.id}'. Are you sure you passed in the correct parent category?`);return d}getOrCreateRootCategory(s){const d=this._categoriesByPath.get(s);if(d){if(!this._allowSameCategoryName)throw new Error(`Category '${s} already exists, config flag allowSameCategoryName=false - therefore matching version 1 behavior (hence this Error)`);return d}const c=this._logProvider.getLogger(s),l=new CategoryImpl(c,s,void 0,this.getOrCreateCategory);return this._categoriesById.set(l.id,l),this._categoriesByPath.set(s,l),l}getOrCreateChildCategory(s,d){if(!d.id.startsWith(this._categoryProviderName))throw new Error(`Parent category '${d.name}' with LogId '${d.id}' is from a different CategoryProvider, cannot mix categories between providers.`);const c=[...d.path,s].join(CATEGORY_PATH_SEPARATOR),l=this._categoriesByPath.get(c);if(l){if(!this._allowSameCategoryName)throw new Error(`Child category '${s} already exists for parent category ${d.name}, config flag allowSameCategoryName=false - therefore matching version 1 behavior (hence this Error)`);return l}const h=this._logProvider.getLogger(c);this._logProvider.updateLoggerRuntime(h,{level:d.logger.runtimeSettings.level,channel:d.logger.runtimeSettings.channel});const p=new CategoryImpl(h,s,d,this.getOrCreateCategory);return this._categoriesById.set(p.id,p),this._categoriesByPath.set(p.path.join(CATEGORY_PATH_SEPARATOR),p),d.addChild(p),p}static isLogId(s){return typeof s=="string"}}class CategoryControlProviderImpl{constructor(s,d){this._provider=s,this._messageChannel=d,this._originalLogLevels=CategoryControlProviderImpl.loadCurrentGroupLogLevels(s)}get name(){return this._provider.name}showSettings(){let s=`Available categories (CategoryProvider '${this._provider.name}'):
`;const d=this.createCategoryInfoHierarchy(),c=d.size.toString().length,l=index$3.maxLengthStringValueInArray([...d.values()].map(p=>p.category.name+" ".repeat(p.depth))),h=[...d.values()].map((p,y)=>CategoryControlProviderImpl.createSettingLineCategory(p,y,c,l));s+=h.join(`
`)+(h.length>0?`
`:""),this._messageChannel(s)}help(){const s=`You can use the following commands (CategoryProvider ${this._provider.name}):
  showSettings()
    Shows the current configuration settings.
  update(level: CategoryControlProviderLogLevel, categoryId?: number | string, noRecurse?: boolean)
    Change the log level for a category (by default recursively).
      @param level      The log level to set - must be one of 'trace', 'debug', 'info', 'warn', 'error' or 'fatal'
      @param categoryId The category id or path of a category (e.g. root#child1) to update. Use showSettings() for id and/or name.
                        When omitted, it applies the level to all categories recursively.
  reset()
    Resets the log levels of the config groups back to when this control provider was created.
  save()
    Saves the current log levels for all categories of this provider. Use restore() to load last saved state.
  restore()
    Restore stored saved state, if any. Log levels will be set according to the saved state.
  help()
    Shows this help.
`;this._messageChannel(s)}reset(){const s=new Map(this._provider.getRegisteredCategories().map(d=>[d.id,d]));this._originalLogLevels.forEach((d,c)=>{const l=s.get(c);l!==void 0&&this._provider.updateRuntimeSettingsCategory(l,{level:d,disableRecursion:!0}),s.delete(c)}),s.forEach(d=>{d.parent!==void 0&&this._provider.updateRuntimeSettingsCategory(d,{level:d.parent.logLevel,disableRecursion:!0})}),this._originalLogLevels=CategoryControlProviderImpl.loadCurrentGroupLogLevels(this._provider),this._messageChannel("Successfully reset log levels back to original state (from when this CategoryControlProvider was created).")}save(){if(!localStorage){this._messageChannel("Cannot save state, localStorage is not available.");return}const s=this._provider.getRegisteredCategories().filter(c=>c.parent===void 0).map(c=>CategoryControlProviderImpl.createCategorySaveData(c)),d={name:this._provider.name,rootCategories:s};localStorage.setItem(this.createKey(),JSON.stringify(d)),this._messageChannel(`Successfully saved state for CategoryControlProvider '${this._provider.name}'.`)}restore(s){const d=s!==void 0?s:!0;if(!localStorage){d&&this._messageChannel(`Will not attempt to restore state for CategoryControlProvider '${this._provider.name}', localStorage is not available.`);return}const c=this.createKey(),l=localStorage.getItem(c);if(l===null){d&&this._messageChannel(`Cannot restore state for CategoryControlProvider '${this._provider.name}', no data available.`);return}try{const h=JSON.parse(l);if(this._provider.name!==h.name){d&&this._messageChannel(`Cannot restore state for CategoryControlProvider '${this._provider.name}', data is not for provider - found name '${h.name}'.`);return}this.restoreBySaveData(h,d),this._messageChannel(`Successfully restored state for CategoryControlProvider '${this._provider.name}'`),this._originalLogLevels=CategoryControlProviderImpl.loadCurrentGroupLogLevels(this._provider)}catch{localStorage.removeItem(c),this._messageChannel(`Cannot restore state for CategoryControlProvider '${this._provider.name}', data is not valid. Invalid data removed from localStorage.`)}}update(s,d,c){typeof d=="undefined"?this.updateAll(s):typeof d=="number"?this.updateByIndex(s,d,c!==void 0?c:!1):this.updateByPath(s,d,c!==void 0?c:!1)}updateAll(s){const d=LogLevel.toLogLevel(s);this._provider.getRegisteredCategories().filter(c=>c.parent===void 0).forEach(c=>this._provider.updateRuntimeSettingsCategory(c,{level:d})),this._messageChannel(`Updated all categories to use log level '${s.toLowerCase()}'`)}updateByPath(s,d,c){const l=this._provider.getCategoryByPath(d);if(l===void 0){this._messageChannel(`Failed to find a provider by path '${d}', please make sure to separate the parts by a ${CATEGORY_PATH_SEPARATOR}.`);return}this._provider.updateRuntimeSettingsCategory(l,{level:LogLevel.toLogLevel(s),disableRecursion:c}),this._messageChannel(`Successfully updated category '${l.name}' with path '${d}' to log level '${s.toLowerCase()}'${c?"":" and recursively applied to children (if any)"}.`)}updateByIndex(s,d,c){if(d<0){this._messageChannel(`Cannot update category by index '${d}', it is negative.`);return}const l=this.createCategoryInfoHierarchy();if(d>=l.size){this._messageChannel(`Cannot update category by index '${d}', it is outside of the range of available categories, use showSettings() to see the indices.`);return}const h=[...l.values()][d].category;this._provider.updateRuntimeSettingsCategory(h,{level:LogLevel.toLogLevel(s),disableRecursion:c}),this._messageChannel(`Successfully updated category '${h.name}' by index '${d}' to log level '${s.toLowerCase()}'${c?"":" and recursively applied to children (if any)"}.`)}restoreBySaveData(s,d){const c=(l,h)=>{const p=h.length>0?h+CATEGORY_PATH_SEPARATOR+l.name:l.name,y=this._provider.getCategoryByPath(p);if(y!==void 0){const _=LogLevel.toLogLevel(l.level);_!==void 0?this._provider.updateRuntimeSettingsCategory(y,{level:_,disableRecursion:!0}):d&&this._messageChannel(`CategoryControlProvider '${this._provider.name}' - cannot restore log level for category path '${p}', log level is invalid.`);for(const E of l.children)c(E,p)}else d&&this._messageChannel(`CategoryControlProvider '${this._provider.name}' - failed to find a Category by path '${p}', will not restore category (and children)`)};for(const l of s.rootCategories)c(l,"")}createKey(){return`CategoryProvider-${this._provider.name}`}createCategoryInfoHierarchy(){const s=new Map;return this._provider.getRegisteredCategories().filter(c=>c.parent===void 0).forEach(c=>CategoryControlProviderImpl.addCategoryInfoHierarchy(c,0,s)),s}static createCategorySaveData(s){return{name:s.name,level:LogLevel[s.logLevel],children:s.children.map(d=>this.createCategorySaveData(d))}}static loadCurrentGroupLogLevels(s){return new Map(s.getRegisteredCategories().map(d=>[d.id,d.logLevel]))}static createSettingLineCategory(s,d,c,l){const p=" ".repeat(s.depth)+s.category.name;return`  [${index$3.padStart(d.toString(),c)}, ${index$3.padEnd(p,l)} (level=${index$3.padEnd(s.logLevel,5)})]`}static addCategoryInfoHierarchy(s,d,c){c.set(s.id,{category:s,logLevel:LogLevel[s.logLevel],depth:d}),s.children.forEach(l=>this.addCategoryInfoHierarchy(l,d+1,c))}}function categoryConfigDebug(a){return`CategoryConfig=level: ${LogLevel[a.level].toString()}, allowSameCategoryName=${a.allowSameCategoryName}`}class CategoryProviderService{constructor(){this._log=InternalLogger.getInternalLogger("category.impl.CategoryProviderService"),this._providers=new index$3.EnhancedMap}createLogProvider(s,d){const c=this._providers.compute(s,(l,h)=>{if(h)throw new Error(`CategoryProvider with name '${s}' already exists, cannot create another.`);const p=mergeWithDefaults(d);return this._log.debug(()=>`Creating new CategoryProvider with name '${s}', using config settings '${categoryConfigDebug(p)}'.`),new CategoryProviderImpl(s,p)});if(c)return c;throw new Error("No CategoryProvider? This is a bug.")}getCategoryControl(s){const d=s||(c=>{if(console&&console.log)console.log(c);else throw new Error("Cannot use console (it is not present), please specify a custom function to write to.")});return{help:()=>d(CategoryProviderService.help()),showSettings:()=>d(this.showSettings()),getProvider:c=>this.getCategoryControlProviderByIdOrName(c,d)}}clear(){this._providers.clear()}showSettings(){let s=`Available CategoryProviders:
`;const d=this._providers.size.toString().length,c=index$3.maxLengthStringValueInArray([...this._providers.keys()]),l=[...this._providers.entries()].map((h,p)=>{const y=h[0];return`  [${index$3.padStart(p.toString(),d)}, ${index$3.padEnd(y,c)}]`});return s+=l.join(`
`)+(l.length>0?`
`:""),s}getCategoryControlProviderByIdOrName(s,d){if(typeof s=="string"){const l=this._providers.get(s);if(l===void 0)throw new Error(`Provider with name '${s}' does not exist.`);return new CategoryControlProviderImpl(l,d)}const c=[...this._providers.values()];if(s<0||s>=c.length)throw new Error(`Provider with index '${s}' does not exist (outside of range).`);return new CategoryControlProviderImpl(c[s],d)}static help(){return`You can use the following commands:
  showSettings()
    Shows the current configuration settings.
  getProvider: (id: number | string): CategoryControlProvider
    Get access to a CategoryControlProvider to change log levels.
      @param id The id (use showSettings to see) or name of the provider
  help()
    Shows this help.
`}}const CATEGORY_PROVIDER_SERVICE=new CategoryProviderService,CATEGORY_LOG_CONTROL=a=>CATEGORY_PROVIDER_SERVICE.getCategoryControl(a);function mergeWithDefaults(a){const s={channel:DefaultChannels.createConsoleChannel(),allowSameCategoryName:!0,level:LogLevel.Error,dateFormatter:formatDate,argumentFormatter:formatArgument};return a?{channel:a.channel?a.channel:s.channel,allowSameCategoryName:a.allowSameCategoryName!==void 0?a.allowSameCategoryName:s.allowSameCategoryName,level:a.level?a.level:s.level,dateFormatter:a.dateFormatter?a.dateFormatter:s.dateFormatter,argumentFormatter:a.argumentFormatter?a.argumentFormatter:s.argumentFormatter}:s}var CategoryProvider;(function(a){function s(c,l){return CATEGORY_PROVIDER_SERVICE.createLogProvider(c,l)}a.createProvider=s;function d(){CATEGORY_PROVIDER_SERVICE.clear()}a.clear=d})(CategoryProvider||(CategoryProvider={}));var typescriptLoggingCategory_esm=Object.freeze(Object.defineProperty({__proto__:null,CATEGORY_LOG_CONTROL,get CategoryProvider(){return CategoryProvider}},Symbol.toStringTag,{value:"Module"})),require$$1=getAugmentedNamespace(typescriptLoggingCategory_esm);Object.defineProperty(logger$1,"__esModule",{value:!0}),logger$1.logger=void 0;const typescript_logging_1=require$$2$1,typescript_logging_category_style_1=require$$1;logger$1.logger=typescript_logging_category_style_1.CategoryProvider.createProvider("ApiStream",{allowSameCategoryName:!0,level:typescript_logging_1.LogLevel.Warn});var version$2="1.0.19",__createBinding$5=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(a,s,d,c){c===void 0&&(c=d);var l=Object.getOwnPropertyDescriptor(s,d);(!l||("get"in l?!s.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return s[d]}}),Object.defineProperty(a,c,l)}:function(a,s,d,c){c===void 0&&(c=d),a[c]=s[d]}),__setModuleDefault$5=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(a,s){Object.defineProperty(a,"default",{enumerable:!0,value:s})}:function(a,s){a.default=s}),__importStar$5=commonjsGlobal&&commonjsGlobal.__importStar||function(a){if(a&&a.__esModule)return a;var s={};if(a!=null)for(var d in a)d!=="default"&&Object.prototype.hasOwnProperty.call(a,d)&&__createBinding$5(s,a,d);return __setModuleDefault$5(s,a),s},__importDefault$h=commonjsGlobal&&commonjsGlobal.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(api$2,"__esModule",{value:!0}),api$2.ApiClient=void 0;const NiceGrpc$1=__importStar$5(lib$1),abort_controller_x_1=require$$1$1,detect_node_1=__importDefault$h(browser$2),NodeTransport=__importStar$5(require$$3),logger_1$8=logger$1,clientVersion$1=version$2;class ApiClient{constructor(s,d,c,l,h,p){this.sessionId=s,this.sdkVersion=c,this.version=clientVersion$1,this.apiLogCallback=h,this.eventLogCallback=p,this.log=logger_1$8.logger.getCategory(l),this.channel=NiceGrpc$1.createChannel(d,detect_node_1.default?NodeTransport.NodeHttpTransport():void 0),this.clientFactory=NiceGrpc$1.createClientFactory().use(this.logMiddleware.bind(this))}async*logMiddleware(s,d){const{path:c}=s.method;try{const l=yield*s.next(s.request,d);if(this.log.debug(`-> ${c}: ok`),this.log.trace(`${JSON.stringify(s.request)} -> ${c}: ${JSON.stringify(l)}`),this.apiLogCallback){let h=c.split("/"),p=h[1].split("."),y=p[p.length-1],_=p[p.length-2],E=p[p.length-3],O=h[2];this.apiLogCallback(E,y,O,s.request,l)}return l}catch(l){throw this.log.trace(`${JSON.stringify(s.request)} -> ${c}`),l instanceof NiceGrpc$1.ClientError?this.log.warn(`-> ${c}: error: ${NiceGrpc$1.Status[l.code]}: ${l.details}`):(0,abort_controller_x_1.isAbortError)(l)?this.log.warn(`-> ${c}: cancel`):this.log.warn(`-> ${c}: error: ${l==null?void 0:l.stack}`),l}}setAccessToken(s){(this.accessToken==null||this.accessToken!=s)&&(this.log.debug("access token refreshed"),this.accessToken=s,this.setup())}makeGrpcMetadata(){let s=NiceGrpc$1.Metadata({Authorization:`Bearer ${this.accessToken}`,Version:this.version,SessionId:this.sessionId});return this.sdkVersion!=null&&s.set("SdkVersion",this.sdkVersion),s}setup(){let s={metadata:this.makeGrpcMetadata()};this._setup(s)}_setup(s){}}api$2.ApiClient=ApiClient;var decorator={};Object.defineProperty(decorator,"__esModule",{value:!0}),decorator.RequiresSdkAuthentication=void 0;function RequiresSdkAuthentication(){return function(a,s){let d;Object.defineProperty(a,s,{get:()=>{if(!d)throw new Error("Please authenticate ApiStream by calling apiStream.load( accessToken )");return d},set:c=>{d=c}})}}decorator.RequiresSdkAuthentication=RequiresSdkAuthentication;var __createBinding$4=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(a,s,d,c){c===void 0&&(c=d);var l=Object.getOwnPropertyDescriptor(s,d);(!l||("get"in l?!s.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return s[d]}}),Object.defineProperty(a,c,l)}:function(a,s,d,c){c===void 0&&(c=d),a[c]=s[d]}),__setModuleDefault$4=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(a,s){Object.defineProperty(a,"default",{enumerable:!0,value:s})}:function(a,s){a.default=s}),__decorate=commonjsGlobal&&commonjsGlobal.__decorate||function(a,s,d,c){var l=arguments.length,h=l<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,d):c,p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(a,s,d,c);else for(var y=a.length-1;y>=0;y--)(p=a[y])&&(h=(l<3?p(h):l>3?p(s,d,h):p(s,d))||h);return l>3&&h&&Object.defineProperty(s,d,h),h},__importStar$4=commonjsGlobal&&commonjsGlobal.__importStar||function(a){if(a&&a.__esModule)return a;var s={};if(a!=null)for(var d in a)d!=="default"&&Object.prototype.hasOwnProperty.call(a,d)&&__createBinding$4(s,a,d);return __setModuleDefault$4(s,a),s},__metadata=commonjsGlobal&&commonjsGlobal.__metadata||function(a,s){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(a,s)};Object.defineProperty(layoutapi,"__esModule",{value:!0}),layoutapi.LayoutApi=void 0,__importStar$4(lib$1);const LayoutApiModel=__importStar$4(dist$3),api_1$1=api$2,decorator_1=decorator,LOG_CATEGORY$1="LayoutApi";class LayoutApi extends api_1$1.ApiClient{constructor(s,d,c,l,h){super(s,c,l,LOG_CATEGORY$1,h),this.handlers={},this.eventApi=d,this.eventApi.on("event",{name:`${LayoutApi.LAYOUTAPI_EVENT_PREFIX}:*`,ignoreSessionEvents:!0},p=>{var y;const[,_]=p.name.split(`${LayoutApi.LAYOUTAPI_EVENT_PREFIX}:`),[E,O]=_.split(":"),P=p.payload;for(const C of(y=this.handlers[E])!==null&&y!==void 0?y:[])C(Object.values(P).find(A=>!!A),O)})}_setup(s){this.layer=this.clientFactory.create(LayoutApiModel.LayerServiceDefinition,this.channel,{"*":s}),this.layout=this.clientFactory.create(LayoutApiModel.LayoutServiceDefinition,this.channel,{"*":s})}async subscribeToLayout(s){await Promise.all([this.eventApi.subscribe(`${LayoutApi.LAYOUTAPI_EVENT_PREFIX}:${LayoutApiModel.EventType.EVENT_TYPE_LAYER}:*`,{target:{layoutId:s}}),this.eventApi.subscribe(`${LayoutApi.LAYOUTAPI_EVENT_PREFIX}:${LayoutApiModel.EventType.EVENT_TYPE_LAYOUT}:*`,{target:{layoutId:s}})])}async unsubscribeFromLayout(s){await Promise.all([this.eventApi.unsubscribe(`${LayoutApi.LAYOUTAPI_EVENT_PREFIX}:${LayoutApiModel.EventType.EVENT_TYPE_LAYER}:*`,{target:{layoutId:s}}),this.eventApi.unsubscribe(`${LayoutApi.LAYOUTAPI_EVENT_PREFIX}:${LayoutApiModel.EventType.EVENT_TYPE_LAYOUT}:*`,{target:{layoutId:s}})])}async subscribeToLayoutsInProject(s,d){await Promise.all([this.eventApi.subscribe(`${LayoutApi.LAYOUTAPI_EVENT_PREFIX}:${LayoutApiModel.EventType.EVENT_TYPE_LAYER}:*`,{target:{collectionId:s,projectId:d}}),this.eventApi.subscribe(`${LayoutApi.LAYOUTAPI_EVENT_PREFIX}:${LayoutApiModel.EventType.EVENT_TYPE_LAYOUT}:*`,{target:{collectionId:s,projectId:d}})])}async unsubscribeFromLayoutsInProject(s,d){await Promise.all([this.eventApi.unsubscribe(`${LayoutApi.LAYOUTAPI_EVENT_PREFIX}:${LayoutApiModel.EventType.EVENT_TYPE_LAYER}:*`,{target:{collectionId:s,projectId:d}}),this.eventApi.unsubscribe(`${LayoutApi.LAYOUTAPI_EVENT_PREFIX}:${LayoutApiModel.EventType.EVENT_TYPE_LAYOUT}:*`,{target:{collectionId:s,projectId:d}})])}on(s,d){var c;this.handlers[s]=(c=this.handlers[s])!==null&&c!==void 0?c:[],this.handlers[s].push(d)}off(s,d){this.handlers[s]=this.handlers[s].filter(c=>c!==d)}}LayoutApi.LAYOUTAPI_EVENT_PREFIX="apistream:layout",__decorate([(0,decorator_1.RequiresSdkAuthentication)(),__metadata("design:type",Object)],LayoutApi.prototype,"layout",void 0),__decorate([(0,decorator_1.RequiresSdkAuthentication)(),__metadata("design:type",Object)],LayoutApi.prototype,"layer",void 0),layoutapi.LayoutApi=LayoutApi;var liveapi={},api$1={},timestamp$1={},__createBinding$3=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(a,s,d,c){c===void 0&&(c=d);var l=Object.getOwnPropertyDescriptor(s,d);(!l||("get"in l?!s.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return s[d]}}),Object.defineProperty(a,c,l)}:function(a,s,d,c){c===void 0&&(c=d),a[c]=s[d]}),__setModuleDefault$3=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(a,s){Object.defineProperty(a,"default",{enumerable:!0,value:s})}:function(a,s){a.default=s}),__importStar$3=commonjsGlobal&&commonjsGlobal.__importStar||function(a){if(a&&a.__esModule)return a;var s={};if(a!=null)for(var d in a)d!=="default"&&Object.prototype.hasOwnProperty.call(a,d)&&__createBinding$3(s,a,d);return __setModuleDefault$3(s,a),s},__importDefault$g=commonjsGlobal&&commonjsGlobal.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(timestamp$1,"__esModule",{value:!0}),timestamp$1.Timestamp=timestamp$1.protobufPackage=void 0;const long_1$1=__importDefault$g(umd.exports),_m0$1=__importStar$3(minimal);timestamp$1.protobufPackage="google.protobuf";function createBaseTimestamp(){return{seconds:0,nanos:0}}timestamp$1.Timestamp={encode(a,s=_m0$1.Writer.create()){return a.seconds!==0&&s.uint32(8).int64(a.seconds),a.nanos!==0&&s.uint32(16).int32(a.nanos),s},decode(a,s){const d=a instanceof _m0$1.Reader?a:new _m0$1.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseTimestamp();for(;d.pos<c;){const h=d.uint32();switch(h>>>3){case 1:l.seconds=longToNumber(d.int64());break;case 2:l.nanos=d.int32();break;default:d.skipType(h&7);break}}return l},fromJSON(a){return{seconds:isSet(a.seconds)?Number(a.seconds):0,nanos:isSet(a.nanos)?Number(a.nanos):0}},toJSON(a){const s={};return a.seconds!==void 0&&(s.seconds=Math.round(a.seconds)),a.nanos!==void 0&&(s.nanos=Math.round(a.nanos)),s},fromPartial(a){var s,d;const c=createBaseTimestamp();return c.seconds=(s=a.seconds)!==null&&s!==void 0?s:0,c.nanos=(d=a.nanos)!==null&&d!==void 0?d:0,c}};var globalThis$1=(()=>{if(typeof globalThis$1!="undefined")return globalThis$1;if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof commonjsGlobal!="undefined")return commonjsGlobal;throw"Unable to locate global object"})();function longToNumber(a){if(a.gt(Number.MAX_SAFE_INTEGER))throw new globalThis$1.Error("Value is larger than Number.MAX_SAFE_INTEGER");return a.toNumber()}_m0$1.util.Long!==long_1$1.default&&(_m0$1.util.Long=long_1$1.default,_m0$1.configure());function isSet(a){return a!=null}var struct$1={};(function(a){var s=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(T,D,J,ee){ee===void 0&&(ee=J);var z=Object.getOwnPropertyDescriptor(D,J);(!z||("get"in z?!D.__esModule:z.writable||z.configurable))&&(z={enumerable:!0,get:function(){return D[J]}}),Object.defineProperty(T,ee,z)}:function(T,D,J,ee){ee===void 0&&(ee=J),T[ee]=D[J]}),d=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(T,D){Object.defineProperty(T,"default",{enumerable:!0,value:D})}:function(T,D){T.default=D}),c=commonjsGlobal&&commonjsGlobal.__importStar||function(T){if(T&&T.__esModule)return T;var D={};if(T!=null)for(var J in T)J!=="default"&&Object.prototype.hasOwnProperty.call(T,J)&&s(D,T,J);return d(D,T),D},l=commonjsGlobal&&commonjsGlobal.__importDefault||function(T){return T&&T.__esModule?T:{default:T}};Object.defineProperty(a,"__esModule",{value:!0}),a.ListValue=a.Value=a.Struct_FieldsEntry=a.Struct=a.nullValueToNumber=a.nullValueToJSON=a.nullValueFromJSON=a.NullValue=a.protobufPackage=void 0;const h=l(umd.exports),p=c(minimal);a.protobufPackage="google.protobuf";var y;(function(T){T.NULL_VALUE="NULL_VALUE"})(y=a.NullValue||(a.NullValue={}));function _(T){switch(T){case 0:case"NULL_VALUE":return y.NULL_VALUE;default:throw new U.Error("Unrecognized enum value "+T+" for enum NullValue")}}a.nullValueFromJSON=_;function E(T){switch(T){case y.NULL_VALUE:return"NULL_VALUE";default:return"UNKNOWN"}}a.nullValueToJSON=E;function O(T){switch(T){case y.NULL_VALUE:return 0;default:return 0}}a.nullValueToNumber=O;function P(){return{fields:{}}}a.Struct={encode(T,D=p.Writer.create()){return Object.entries(T.fields).forEach(([J,ee])=>{ee!==void 0&&a.Struct_FieldsEntry.encode({key:J,value:ee},D.uint32(10).fork()).ldelim()}),D},decode(T,D){const J=T instanceof p.Reader?T:new p.Reader(T);let ee=D===void 0?J.len:J.pos+D;const z=P();for(;J.pos<ee;){const ne=J.uint32();switch(ne>>>3){case 1:const X=a.Struct_FieldsEntry.decode(J,J.uint32());X.value!==void 0&&(z.fields[X.key]=X.value);break;default:J.skipType(ne&7);break}}return z},fromJSON(T){return{fields:F(T.fields)?Object.entries(T.fields).reduce((D,[J,ee])=>(D[J]=ee,D),{}):{}}},toJSON(T){const D={};return D.fields={},T.fields&&Object.entries(T.fields).forEach(([J,ee])=>{D.fields[J]=ee}),D},fromPartial(T){var D;const J=P();return J.fields=Object.entries((D=T.fields)!==null&&D!==void 0?D:{}).reduce((ee,[z,ne])=>(ne!==void 0&&(ee[z]=ne),ee),{}),J},wrap(T){const D=P();return T!==void 0&&Object.keys(T).forEach(J=>{D.fields[J]=T[J]}),D},unwrap(T){const D={};return Object.keys(T.fields).forEach(J=>{D[J]=T.fields[J]}),D}};function C(){return{key:"",value:void 0}}a.Struct_FieldsEntry={encode(T,D=p.Writer.create()){return T.key!==""&&D.uint32(10).string(T.key),T.value!==void 0&&a.Value.encode(a.Value.wrap(T.value),D.uint32(18).fork()).ldelim(),D},decode(T,D){const J=T instanceof p.Reader?T:new p.Reader(T);let ee=D===void 0?J.len:J.pos+D;const z=C();for(;J.pos<ee;){const ne=J.uint32();switch(ne>>>3){case 1:z.key=J.string();break;case 2:z.value=a.Value.unwrap(a.Value.decode(J,J.uint32()));break;default:J.skipType(ne&7);break}}return z},fromJSON(T){return{key:j(T.key)?String(T.key):"",value:j(T==null?void 0:T.value)?T.value:void 0}},toJSON(T){const D={};return T.key!==void 0&&(D.key=T.key),T.value!==void 0&&(D.value=T.value),D},fromPartial(T){var D,J;const ee=C();return ee.key=(D=T.key)!==null&&D!==void 0?D:"",ee.value=(J=T.value)!==null&&J!==void 0?J:void 0,ee}};function A(){return{nullValue:void 0,numberValue:void 0,stringValue:void 0,boolValue:void 0,structValue:void 0,listValue:void 0}}a.Value={encode(T,D=p.Writer.create()){return T.nullValue!==void 0&&D.uint32(8).int32(O(T.nullValue)),T.numberValue!==void 0&&D.uint32(17).double(T.numberValue),T.stringValue!==void 0&&D.uint32(26).string(T.stringValue),T.boolValue!==void 0&&D.uint32(32).bool(T.boolValue),T.structValue!==void 0&&a.Struct.encode(a.Struct.wrap(T.structValue),D.uint32(42).fork()).ldelim(),T.listValue!==void 0&&a.ListValue.encode(a.ListValue.wrap(T.listValue),D.uint32(50).fork()).ldelim(),D},decode(T,D){const J=T instanceof p.Reader?T:new p.Reader(T);let ee=D===void 0?J.len:J.pos+D;const z=A();for(;J.pos<ee;){const ne=J.uint32();switch(ne>>>3){case 1:z.nullValue=_(J.int32());break;case 2:z.numberValue=J.double();break;case 3:z.stringValue=J.string();break;case 4:z.boolValue=J.bool();break;case 5:z.structValue=a.Struct.unwrap(a.Struct.decode(J,J.uint32()));break;case 6:z.listValue=a.ListValue.unwrap(a.ListValue.decode(J,J.uint32()));break;default:J.skipType(ne&7);break}}return z},fromJSON(T){return{nullValue:j(T.nullValue)?_(T.nullValue):void 0,numberValue:j(T.numberValue)?Number(T.numberValue):void 0,stringValue:j(T.stringValue)?String(T.stringValue):void 0,boolValue:j(T.boolValue)?Boolean(T.boolValue):void 0,structValue:F(T.structValue)?T.structValue:void 0,listValue:Array.isArray(T.listValue)?[...T.listValue]:void 0}},toJSON(T){const D={};return T.nullValue!==void 0&&(D.nullValue=T.nullValue!==void 0?E(T.nullValue):void 0),T.numberValue!==void 0&&(D.numberValue=T.numberValue),T.stringValue!==void 0&&(D.stringValue=T.stringValue),T.boolValue!==void 0&&(D.boolValue=T.boolValue),T.structValue!==void 0&&(D.structValue=T.structValue),T.listValue!==void 0&&(D.listValue=T.listValue),D},fromPartial(T){var D,J,ee,z,ne,X;const M=A();return M.nullValue=(D=T.nullValue)!==null&&D!==void 0?D:void 0,M.numberValue=(J=T.numberValue)!==null&&J!==void 0?J:void 0,M.stringValue=(ee=T.stringValue)!==null&&ee!==void 0?ee:void 0,M.boolValue=(z=T.boolValue)!==null&&z!==void 0?z:void 0,M.structValue=(ne=T.structValue)!==null&&ne!==void 0?ne:void 0,M.listValue=(X=T.listValue)!==null&&X!==void 0?X:void 0,M},wrap(T){const D=A();if(T===null)D.nullValue=y.NULL_VALUE;else if(typeof T=="boolean")D.boolValue=T;else if(typeof T=="number")D.numberValue=T;else if(typeof T=="string")D.stringValue=T;else if(Array.isArray(T))D.listValue=T;else if(typeof T=="object")D.structValue=T;else if(typeof T!="undefined")throw new Error("Unsupported any value type: "+typeof T);return D},unwrap(T){if((T==null?void 0:T.stringValue)!==void 0)return T.stringValue;if((T==null?void 0:T.numberValue)!==void 0)return T.numberValue;if((T==null?void 0:T.boolValue)!==void 0)return T.boolValue;if((T==null?void 0:T.structValue)!==void 0)return T.structValue;if((T==null?void 0:T.listValue)!==void 0)return T.listValue;if((T==null?void 0:T.nullValue)!==void 0)return null}};function q(){return{values:[]}}a.ListValue={encode(T,D=p.Writer.create()){for(const J of T.values)a.Value.encode(a.Value.wrap(J),D.uint32(10).fork()).ldelim();return D},decode(T,D){const J=T instanceof p.Reader?T:new p.Reader(T);let ee=D===void 0?J.len:J.pos+D;const z=q();for(;J.pos<ee;){const ne=J.uint32();switch(ne>>>3){case 1:z.values.push(a.Value.unwrap(a.Value.decode(J,J.uint32())));break;default:J.skipType(ne&7);break}}return z},fromJSON(T){return{values:Array.isArray(T==null?void 0:T.values)?[...T.values]:[]}},toJSON(T){const D={};return T.values?D.values=T.values.map(J=>J):D.values=[],D},fromPartial(T){var D;const J=q();return J.values=((D=T.values)===null||D===void 0?void 0:D.map(ee=>ee))||[],J},wrap(T){const D=q();return D.values=T!=null?T:[],D},unwrap(T){return T.values}};var U=(()=>{if(typeof U!="undefined")return U;if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof commonjsGlobal!="undefined")return commonjsGlobal;throw"Unable to locate global object"})();p.util.Long!==h.default&&(p.util.Long=h.default,p.configure());function F(T){return typeof T=="object"&&T!==null}function j(T){return T!=null}})(struct$1);var field_mask={},__createBinding$2=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(a,s,d,c){c===void 0&&(c=d);var l=Object.getOwnPropertyDescriptor(s,d);(!l||("get"in l?!s.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return s[d]}}),Object.defineProperty(a,c,l)}:function(a,s,d,c){c===void 0&&(c=d),a[c]=s[d]}),__setModuleDefault$2=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(a,s){Object.defineProperty(a,"default",{enumerable:!0,value:s})}:function(a,s){a.default=s}),__importStar$2=commonjsGlobal&&commonjsGlobal.__importStar||function(a){if(a&&a.__esModule)return a;var s={};if(a!=null)for(var d in a)d!=="default"&&Object.prototype.hasOwnProperty.call(a,d)&&__createBinding$2(s,a,d);return __setModuleDefault$2(s,a),s},__importDefault$f=commonjsGlobal&&commonjsGlobal.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(field_mask,"__esModule",{value:!0}),field_mask.FieldMask=field_mask.protobufPackage=void 0;const long_1=__importDefault$f(umd.exports),_m0=__importStar$2(minimal);field_mask.protobufPackage="google.protobuf";function createBaseFieldMask(){return{paths:[]}}field_mask.FieldMask={encode(a,s=_m0.Writer.create()){for(const d of a.paths)s.uint32(10).string(d);return s},decode(a,s){const d=a instanceof _m0.Reader?a:new _m0.Reader(a);let c=s===void 0?d.len:d.pos+s;const l=createBaseFieldMask();for(;d.pos<c;){const h=d.uint32();switch(h>>>3){case 1:l.paths.push(d.string());break;default:d.skipType(h&7);break}}return l},fromJSON(a){return{paths:typeof a=="string"?a.split(",").filter(Boolean):Array.isArray(a==null?void 0:a.paths)?a.paths.map(String):[]}},toJSON(a){return a.paths.join(",")},fromPartial(a){var s;const d=createBaseFieldMask();return d.paths=((s=a.paths)===null||s===void 0?void 0:s.map(c=>c))||[],d},wrap(a){return{paths:a}},unwrap(a){return a.paths}},_m0.util.Long!==long_1.default&&(_m0.util.Long=long_1.default,_m0.configure()),function(a){var s=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(u,m,S,B){B===void 0&&(B=S);var k=Object.getOwnPropertyDescriptor(m,S);(!k||("get"in k?!m.__esModule:k.writable||k.configurable))&&(k={enumerable:!0,get:function(){return m[S]}}),Object.defineProperty(u,B,k)}:function(u,m,S,B){B===void 0&&(B=S),u[B]=m[S]}),d=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(u,m){Object.defineProperty(u,"default",{enumerable:!0,value:m})}:function(u,m){u.default=m}),c=commonjsGlobal&&commonjsGlobal.__importStar||function(u){if(u&&u.__esModule)return u;var m={};if(u!=null)for(var S in u)S!=="default"&&Object.prototype.hasOwnProperty.call(u,S)&&s(m,u,S);return d(m,u),m},l=commonjsGlobal&&commonjsGlobal.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(a,"__esModule",{value:!0}),a.Role=a.regionToNumber=a.regionToJSON=a.regionFromJSON=a.Region=a.sourceTriggerActionToNumber=a.sourceTriggerActionToJSON=a.sourceTriggerActionFromJSON=a.SourceTriggerAction=a.s3ACLToNumber=a.s3ACLToJSON=a.s3ACLFromJSON=a.S3ACL=a.projectBroadcastPhaseToNumber=a.projectBroadcastPhaseToJSON=a.projectBroadcastPhaseFromJSON=a.ProjectBroadcastPhase=a.videoCodecRateControlModeToNumber=a.videoCodecRateControlModeToJSON=a.videoCodecRateControlModeFromJSON=a.VideoCodecRateControlMode=a.audioCodecToNumber=a.audioCodecToJSON=a.audioCodecFromJSON=a.AudioCodec=a.videoCodecProfileToNumber=a.videoCodecProfileToJSON=a.videoCodecProfileFromJSON=a.VideoCodecProfile=a.videoCodecToNumber=a.videoCodecToJSON=a.videoCodecFromJSON=a.VideoCodec=a.renderingQualityToNumber=a.renderingQualityToJSON=a.renderingQualityFromJSON=a.RenderingQuality=a.audioChannelLayoutToNumber=a.audioChannelLayoutToJSON=a.audioChannelLayoutFromJSON=a.AudioChannelLayout=a.videoColorSpaceToNumber=a.videoColorSpaceToJSON=a.videoColorSpaceFromJSON=a.VideoColorSpace=a.imageFormatToNumber=a.imageFormatToJSON=a.imageFormatFromJSON=a.ImageFormat=a.protobufPackage=void 0,a.HostedWebRtc=a.Composition=a.ExternalComposition=a.SceneComposition=a.StudioSdkComposition=a.PreviewAddress=a.PreviewWebRtcAddress=a.PreviewHlsPullAddress=a.ProjectTrigger=a.WebRtcTrigger=a.SourceTrigger=a.DestinationAddress=a.S3StorageAddress=a.ObjectStoragePackaging=a.HlsPackaging=a.HlsLifecycle=a.HlsLifecycleVod=a.HlsLifecycleLive=a.DestinationAgoraPushAddress=a.DestinationRtmpPushAddress=a.SourceAddress=a.RtmpPullAddress=a.SrtPushAddress=a.SourceRtmpPushAddress=a.Encoding=a.AudioEncoding=a.VideoEncoding=a.VideoCodecRateControl=a.Rendering=a.AudioRendering=a.VideoRendering=a.eventTypeToNumber=a.eventTypeToJSON=a.eventTypeFromJSON=a.EventType=a.eventSubTypeToNumber=a.eventSubTypeToJSON=a.eventSubTypeFromJSON=a.EventSubType=a.connectStateToNumber=a.connectStateToJSON=a.connectStateFromJSON=a.ConnectState=a.projectBroadcastErrorToNumber=a.projectBroadcastErrorToJSON=a.projectBroadcastErrorFromJSON=a.ProjectBroadcastError=a.roleToNumber=a.roleToJSON=a.roleFromJSON=void 0,a.DeleteSourceResponse=a.DeleteSourceRequest=a.CreateSourceResponse=a.CreateSourceRequest=a.UpdateDestinationResponse=a.UpdateDestinationRequest=a.DeleteDestinationResponse=a.DeleteDestinationRequest=a.GetDestinationResponse=a.GetDestinationRequest=a.CreateDestinationResponse=a.CreateDestinationRequest=a.StopProjectWebRtcResponse=a.StopProjectWebRtcRequest=a.StartProjectWebRtcResponse=a.StartProjectWebRtcRequest=a.GetProjectBroadcastStatusResponse=a.GetProjectBroadcastStatusRequest=a.GetProjectBroadcastSnapshotResponse=a.GetProjectBroadcastSnapshotRequest=a.GetProjectResponse=a.GetProjectRequest=a.StopProjectBroadcastResponse=a.StopProjectBroadcastRequest=a.StartProjectBroadcastResponse=a.StartProjectBroadcastRequest=a.DeleteProjectResponse=a.DeleteProjectRequest=a.UpdateProjectResponse=a.UpdateProjectRequest=a.CreateProjectResponse=a.CreateProjectRequest=a.GetCollectionsResponse=a.GetCollectionsRequest=a.DeleteCollectionResponse=a.DeleteCollectionRequest=a.UpdateCollectionResponse=a.UpdateCollectionRequest=a.GetCollectionResponse=a.GetCollectionRequest=a.CreateCollectionResponse=a.CreateCollectionRequest=a.Collection=a.Project=a.Destination=a.Source=a.ProjectBroadcastStatus=a.LatLong=a.WebRtcAccess=a.WebRtc=void 0,a.DestinationEvent=a.CollectionEvent=a.SourceStateEvent=a.SourceRemoveEvent=a.SourceAddEvent=a.SourceUpdateEvent=a.SourceDeleteEvent=a.SourceCreateEvent=a.CollectionUpdateEvent=a.CollectionDeleteEvent=a.CollectionCreateEvent=a.ProjectBroadcastStateEvent=a.ProjectUpdateEvent=a.ProjectDeleteEvent=a.ProjectCreateEvent=a.DestinationStateEvent=a.DestinationUpdateEvent=a.DestinationDeleteEvent=a.DestinationCreateEvent=a.GetTestTokenResponse=a.GetTestTokenRequest=a.GetJsonWebKeySetResponse=a.GetJsonWebKeySetRequest=a.JsonWebKey=a.GuestCodeRedirectResponse=a.GuestCodeRedirectRequest=a.GuestCode=a.RefreshAccessTokenResponse=a.RefreshAccessTokenRequest=a.CreateWebRtcAccessTokenResponse=a.CreateWebRtcAccessTokenRequest=a.CreateGuestAccessTokenResponse=a.CreateGuestAccessTokenRequest=a.GuestAccessToken=a.GuestAccessTokenExchange=a.GuestAccessTokenDirect=a.CreateAccessTokenResponse=a.CreateAccessTokenRequest=a.RemoveSourceFromProjectResponse=a.RemoveSourceFromProjectRequest=a.UpdateSourceResponse=a.UpdateSourceRequest=a.GetSourcesResponse=a.GetSourcesRequest=a.GetSourceResponse=a.GetSourceRequest=a.UpdateSourceInProjectResponse=a.UpdateSourceInProjectRequest=a.AddSourceToProjectResponse=a.AddSourceToProjectRequest=void 0,a.PublicAuthenticationServiceDefinition=a.PublicAuthenticationServiceClientImpl=a.AuthenticationServiceDefinition=a.AuthenticationServiceClientImpl=a.BackendAuthenticationServiceDefinition=a.BackendAuthenticationServiceClientImpl=a.SourceServiceDefinition=a.SourceServiceClientImpl=a.DestinationServiceDefinition=a.DestinationServiceClientImpl=a.ProjectServiceDefinition=a.ProjectServiceClientImpl=a.CollectionServiceDefinition=a.CollectionServiceClientImpl=a.LiveEvent=a.SourceEvent=a.ProjectEvent=void 0;const h=l(umd.exports),p=c(minimal),y=timestamp$1,_=struct$1,E=field_mask;a.protobufPackage="live.v21";var O;(function(u){u.IMAGE_FORMAT_UNSPECIFIED="IMAGE_FORMAT_UNSPECIFIED",u.IMAGE_FORMAT_JPEG="IMAGE_FORMAT_JPEG"})(O=a.ImageFormat||(a.ImageFormat={}));function P(u){switch(u){case 0:case"IMAGE_FORMAT_UNSPECIFIED":return O.IMAGE_FORMAT_UNSPECIFIED;case 1:case"IMAGE_FORMAT_JPEG":return O.IMAGE_FORMAT_JPEG;default:throw new Ve.Error("Unrecognized enum value "+u+" for enum ImageFormat")}}a.imageFormatFromJSON=P;function C(u){switch(u){case O.IMAGE_FORMAT_UNSPECIFIED:return"IMAGE_FORMAT_UNSPECIFIED";case O.IMAGE_FORMAT_JPEG:return"IMAGE_FORMAT_JPEG";default:return"UNKNOWN"}}a.imageFormatToJSON=C;function A(u){switch(u){case O.IMAGE_FORMAT_UNSPECIFIED:return 0;case O.IMAGE_FORMAT_JPEG:return 1;default:return 0}}a.imageFormatToNumber=A;var q;(function(u){u.VIDEO_COLOR_SPACE_UNSPECIFIED="VIDEO_COLOR_SPACE_UNSPECIFIED",u.VIDEO_COLOR_SPACE_YUV420="VIDEO_COLOR_SPACE_YUV420"})(q=a.VideoColorSpace||(a.VideoColorSpace={}));function U(u){switch(u){case 0:case"VIDEO_COLOR_SPACE_UNSPECIFIED":return q.VIDEO_COLOR_SPACE_UNSPECIFIED;case 1:case"VIDEO_COLOR_SPACE_YUV420":return q.VIDEO_COLOR_SPACE_YUV420;default:throw new Ve.Error("Unrecognized enum value "+u+" for enum VideoColorSpace")}}a.videoColorSpaceFromJSON=U;function F(u){switch(u){case q.VIDEO_COLOR_SPACE_UNSPECIFIED:return"VIDEO_COLOR_SPACE_UNSPECIFIED";case q.VIDEO_COLOR_SPACE_YUV420:return"VIDEO_COLOR_SPACE_YUV420";default:return"UNKNOWN"}}a.videoColorSpaceToJSON=F;function j(u){switch(u){case q.VIDEO_COLOR_SPACE_UNSPECIFIED:return 0;case q.VIDEO_COLOR_SPACE_YUV420:return 1;default:return 0}}a.videoColorSpaceToNumber=j;var T;(function(u){u.AUDIO_CHANNEL_LAYOUT_UNSPECIFIED="AUDIO_CHANNEL_LAYOUT_UNSPECIFIED",u.AUDIO_CHANNEL_LAYOUT_STEREO="AUDIO_CHANNEL_LAYOUT_STEREO"})(T=a.AudioChannelLayout||(a.AudioChannelLayout={}));function D(u){switch(u){case 0:case"AUDIO_CHANNEL_LAYOUT_UNSPECIFIED":return T.AUDIO_CHANNEL_LAYOUT_UNSPECIFIED;case 1:case"AUDIO_CHANNEL_LAYOUT_STEREO":return T.AUDIO_CHANNEL_LAYOUT_STEREO;default:throw new Ve.Error("Unrecognized enum value "+u+" for enum AudioChannelLayout")}}a.audioChannelLayoutFromJSON=D;function J(u){switch(u){case T.AUDIO_CHANNEL_LAYOUT_UNSPECIFIED:return"AUDIO_CHANNEL_LAYOUT_UNSPECIFIED";case T.AUDIO_CHANNEL_LAYOUT_STEREO:return"AUDIO_CHANNEL_LAYOUT_STEREO";default:return"UNKNOWN"}}a.audioChannelLayoutToJSON=J;function ee(u){switch(u){case T.AUDIO_CHANNEL_LAYOUT_UNSPECIFIED:return 0;case T.AUDIO_CHANNEL_LAYOUT_STEREO:return 1;default:return 0}}a.audioChannelLayoutToNumber=ee;var z;(function(u){u.RENDERING_QUALITY_UNSPECIFIED="RENDERING_QUALITY_UNSPECIFIED",u.RENDERING_QUALITY_STANDARD="RENDERING_QUALITY_STANDARD",u.RENDERING_QUALITY_HIGH="RENDERING_QUALITY_HIGH"})(z=a.RenderingQuality||(a.RenderingQuality={}));function ne(u){switch(u){case 0:case"RENDERING_QUALITY_UNSPECIFIED":return z.RENDERING_QUALITY_UNSPECIFIED;case 1:case"RENDERING_QUALITY_STANDARD":return z.RENDERING_QUALITY_STANDARD;case 2:case"RENDERING_QUALITY_HIGH":return z.RENDERING_QUALITY_HIGH;default:throw new Ve.Error("Unrecognized enum value "+u+" for enum RenderingQuality")}}a.renderingQualityFromJSON=ne;function X(u){switch(u){case z.RENDERING_QUALITY_UNSPECIFIED:return"RENDERING_QUALITY_UNSPECIFIED";case z.RENDERING_QUALITY_STANDARD:return"RENDERING_QUALITY_STANDARD";case z.RENDERING_QUALITY_HIGH:return"RENDERING_QUALITY_HIGH";default:return"UNKNOWN"}}a.renderingQualityToJSON=X;function M(u){switch(u){case z.RENDERING_QUALITY_UNSPECIFIED:return 0;case z.RENDERING_QUALITY_STANDARD:return 1;case z.RENDERING_QUALITY_HIGH:return 2;default:return 0}}a.renderingQualityToNumber=M;var K;(function(u){u.VIDEO_CODEC_UNSPECIFIED="VIDEO_CODEC_UNSPECIFIED",u.VIDEO_CODEC_H264="VIDEO_CODEC_H264"})(K=a.VideoCodec||(a.VideoCodec={}));function te(u){switch(u){case 0:case"VIDEO_CODEC_UNSPECIFIED":return K.VIDEO_CODEC_UNSPECIFIED;case 1:case"VIDEO_CODEC_H264":return K.VIDEO_CODEC_H264;default:throw new Ve.Error("Unrecognized enum value "+u+" for enum VideoCodec")}}a.videoCodecFromJSON=te;function L(u){switch(u){case K.VIDEO_CODEC_UNSPECIFIED:return"VIDEO_CODEC_UNSPECIFIED";case K.VIDEO_CODEC_H264:return"VIDEO_CODEC_H264";default:return"UNKNOWN"}}a.videoCodecToJSON=L;function G(u){switch(u){case K.VIDEO_CODEC_UNSPECIFIED:return 0;case K.VIDEO_CODEC_H264:return 1;default:return 0}}a.videoCodecToNumber=G;var W;(function(u){u.VIDEO_CODEC_PROFILE_UNSPECIFIED="VIDEO_CODEC_PROFILE_UNSPECIFIED",u.VIDEO_CODEC_PROFILE_BASELINE="VIDEO_CODEC_PROFILE_BASELINE",u.VIDEO_CODEC_PROFILE_MAIN="VIDEO_CODEC_PROFILE_MAIN",u.VIDEO_CODEC_PROFILE_HIGH="VIDEO_CODEC_PROFILE_HIGH"})(W=a.VideoCodecProfile||(a.VideoCodecProfile={}));function ie(u){switch(u){case 0:case"VIDEO_CODEC_PROFILE_UNSPECIFIED":return W.VIDEO_CODEC_PROFILE_UNSPECIFIED;case 2:case"VIDEO_CODEC_PROFILE_BASELINE":return W.VIDEO_CODEC_PROFILE_BASELINE;case 3:case"VIDEO_CODEC_PROFILE_MAIN":return W.VIDEO_CODEC_PROFILE_MAIN;case 4:case"VIDEO_CODEC_PROFILE_HIGH":return W.VIDEO_CODEC_PROFILE_HIGH;default:throw new Ve.Error("Unrecognized enum value "+u+" for enum VideoCodecProfile")}}a.videoCodecProfileFromJSON=ie;function x(u){switch(u){case W.VIDEO_CODEC_PROFILE_UNSPECIFIED:return"VIDEO_CODEC_PROFILE_UNSPECIFIED";case W.VIDEO_CODEC_PROFILE_BASELINE:return"VIDEO_CODEC_PROFILE_BASELINE";case W.VIDEO_CODEC_PROFILE_MAIN:return"VIDEO_CODEC_PROFILE_MAIN";case W.VIDEO_CODEC_PROFILE_HIGH:return"VIDEO_CODEC_PROFILE_HIGH";default:return"UNKNOWN"}}a.videoCodecProfileToJSON=x;function Y(u){switch(u){case W.VIDEO_CODEC_PROFILE_UNSPECIFIED:return 0;case W.VIDEO_CODEC_PROFILE_BASELINE:return 2;case W.VIDEO_CODEC_PROFILE_MAIN:return 3;case W.VIDEO_CODEC_PROFILE_HIGH:return 4;default:return 0}}a.videoCodecProfileToNumber=Y;var oe;(function(u){u.AUDIO_CODEC_UNSPECIFIED="AUDIO_CODEC_UNSPECIFIED",u.AUDIO_CODEC_AAC="AUDIO_CODEC_AAC"})(oe=a.AudioCodec||(a.AudioCodec={}));function fe(u){switch(u){case 0:case"AUDIO_CODEC_UNSPECIFIED":return oe.AUDIO_CODEC_UNSPECIFIED;case 1:case"AUDIO_CODEC_AAC":return oe.AUDIO_CODEC_AAC;default:throw new Ve.Error("Unrecognized enum value "+u+" for enum AudioCodec")}}a.audioCodecFromJSON=fe;function pe(u){switch(u){case oe.AUDIO_CODEC_UNSPECIFIED:return"AUDIO_CODEC_UNSPECIFIED";case oe.AUDIO_CODEC_AAC:return"AUDIO_CODEC_AAC";default:return"UNKNOWN"}}a.audioCodecToJSON=pe;function me(u){switch(u){case oe.AUDIO_CODEC_UNSPECIFIED:return 0;case oe.AUDIO_CODEC_AAC:return 1;default:return 0}}a.audioCodecToNumber=me;var v;(function(u){u.VIDEO_CODEC_RATE_CONTROL_MODE_UNSPECIFIED="VIDEO_CODEC_RATE_CONTROL_MODE_UNSPECIFIED",u.VIDEO_CODEC_RATE_CONTROL_MODE_CBR="VIDEO_CODEC_RATE_CONTROL_MODE_CBR"})(v=a.VideoCodecRateControlMode||(a.VideoCodecRateControlMode={}));function g(u){switch(u){case 0:case"VIDEO_CODEC_RATE_CONTROL_MODE_UNSPECIFIED":return v.VIDEO_CODEC_RATE_CONTROL_MODE_UNSPECIFIED;case 1:case"VIDEO_CODEC_RATE_CONTROL_MODE_CBR":return v.VIDEO_CODEC_RATE_CONTROL_MODE_CBR;default:throw new Ve.Error("Unrecognized enum value "+u+" for enum VideoCodecRateControlMode")}}a.videoCodecRateControlModeFromJSON=g;function w(u){switch(u){case v.VIDEO_CODEC_RATE_CONTROL_MODE_UNSPECIFIED:return"VIDEO_CODEC_RATE_CONTROL_MODE_UNSPECIFIED";case v.VIDEO_CODEC_RATE_CONTROL_MODE_CBR:return"VIDEO_CODEC_RATE_CONTROL_MODE_CBR";default:return"UNKNOWN"}}a.videoCodecRateControlModeToJSON=w;function ae(u){switch(u){case v.VIDEO_CODEC_RATE_CONTROL_MODE_UNSPECIFIED:return 0;case v.VIDEO_CODEC_RATE_CONTROL_MODE_CBR:return 1;default:return 0}}a.videoCodecRateControlModeToNumber=ae;var I;(function(u){u.PROJECT_BROADCAST_PHASE_UNSPECIFIED="PROJECT_BROADCAST_PHASE_UNSPECIFIED",u.PROJECT_BROADCAST_PHASE_NOT_RUNNING="PROJECT_BROADCAST_PHASE_NOT_RUNNING",u.PROJECT_BROADCAST_PHASE_WAITING="PROJECT_BROADCAST_PHASE_WAITING",u.PROJECT_BROADCAST_PHASE_STARTING="PROJECT_BROADCAST_PHASE_STARTING",u.PROJECT_BROADCAST_PHASE_RUNNING="PROJECT_BROADCAST_PHASE_RUNNING",u.PROJECT_BROADCAST_PHASE_STOPPING="PROJECT_BROADCAST_PHASE_STOPPING",u.PROJECT_BROADCAST_PHASE_STOPPED="PROJECT_BROADCAST_PHASE_STOPPED",u.PROJECT_BROADCAST_PHASE_ARCHIVED="PROJECT_BROADCAST_PHASE_ARCHIVED"})(I=a.ProjectBroadcastPhase||(a.ProjectBroadcastPhase={}));function $(u){switch(u){case 0:case"PROJECT_BROADCAST_PHASE_UNSPECIFIED":return I.PROJECT_BROADCAST_PHASE_UNSPECIFIED;case 1:case"PROJECT_BROADCAST_PHASE_NOT_RUNNING":return I.PROJECT_BROADCAST_PHASE_NOT_RUNNING;case 2:case"PROJECT_BROADCAST_PHASE_WAITING":return I.PROJECT_BROADCAST_PHASE_WAITING;case 3:case"PROJECT_BROADCAST_PHASE_STARTING":return I.PROJECT_BROADCAST_PHASE_STARTING;case 4:case"PROJECT_BROADCAST_PHASE_RUNNING":return I.PROJECT_BROADCAST_PHASE_RUNNING;case 5:case"PROJECT_BROADCAST_PHASE_STOPPING":return I.PROJECT_BROADCAST_PHASE_STOPPING;case 6:case"PROJECT_BROADCAST_PHASE_STOPPED":return I.PROJECT_BROADCAST_PHASE_STOPPED;case 7:case"PROJECT_BROADCAST_PHASE_ARCHIVED":return I.PROJECT_BROADCAST_PHASE_ARCHIVED;default:throw new Ve.Error("Unrecognized enum value "+u+" for enum ProjectBroadcastPhase")}}a.projectBroadcastPhaseFromJSON=$;function Z(u){switch(u){case I.PROJECT_BROADCAST_PHASE_UNSPECIFIED:return"PROJECT_BROADCAST_PHASE_UNSPECIFIED";case I.PROJECT_BROADCAST_PHASE_NOT_RUNNING:return"PROJECT_BROADCAST_PHASE_NOT_RUNNING";case I.PROJECT_BROADCAST_PHASE_WAITING:return"PROJECT_BROADCAST_PHASE_WAITING";case I.PROJECT_BROADCAST_PHASE_STARTING:return"PROJECT_BROADCAST_PHASE_STARTING";case I.PROJECT_BROADCAST_PHASE_RUNNING:return"PROJECT_BROADCAST_PHASE_RUNNING";case I.PROJECT_BROADCAST_PHASE_STOPPING:return"PROJECT_BROADCAST_PHASE_STOPPING";case I.PROJECT_BROADCAST_PHASE_STOPPED:return"PROJECT_BROADCAST_PHASE_STOPPED";case I.PROJECT_BROADCAST_PHASE_ARCHIVED:return"PROJECT_BROADCAST_PHASE_ARCHIVED";default:return"UNKNOWN"}}a.projectBroadcastPhaseToJSON=Z;function le(u){switch(u){case I.PROJECT_BROADCAST_PHASE_UNSPECIFIED:return 0;case I.PROJECT_BROADCAST_PHASE_NOT_RUNNING:return 1;case I.PROJECT_BROADCAST_PHASE_WAITING:return 2;case I.PROJECT_BROADCAST_PHASE_STARTING:return 3;case I.PROJECT_BROADCAST_PHASE_RUNNING:return 4;case I.PROJECT_BROADCAST_PHASE_STOPPING:return 5;case I.PROJECT_BROADCAST_PHASE_STOPPED:return 6;case I.PROJECT_BROADCAST_PHASE_ARCHIVED:return 7;default:return 0}}a.projectBroadcastPhaseToNumber=le;var de;(function(u){u.S3ACL_UNSPECIFIED="S3ACL_UNSPECIFIED",u.S3ACL_PRIVATE="S3ACL_PRIVATE",u.S3ACL_PUBLIC_READ="S3ACL_PUBLIC_READ",u.S3ACL_PUBLIC_READ_WRITE="S3ACL_PUBLIC_READ_WRITE",u.S3ACL_AUTHENTICATED_READ="S3ACL_AUTHENTICATED_READ",u.S3ACL_BUCKET_OWNER_READ="S3ACL_BUCKET_OWNER_READ",u.S3ACL_BUCKET_OWNER_FULL_CONTROL="S3ACL_BUCKET_OWNER_FULL_CONTROL"})(de=a.S3ACL||(a.S3ACL={}));function he(u){switch(u){case 0:case"S3ACL_UNSPECIFIED":return de.S3ACL_UNSPECIFIED;case 1:case"S3ACL_PRIVATE":return de.S3ACL_PRIVATE;case 2:case"S3ACL_PUBLIC_READ":return de.S3ACL_PUBLIC_READ;case 3:case"S3ACL_PUBLIC_READ_WRITE":return de.S3ACL_PUBLIC_READ_WRITE;case 4:case"S3ACL_AUTHENTICATED_READ":return de.S3ACL_AUTHENTICATED_READ;case 5:case"S3ACL_BUCKET_OWNER_READ":return de.S3ACL_BUCKET_OWNER_READ;case 6:case"S3ACL_BUCKET_OWNER_FULL_CONTROL":return de.S3ACL_BUCKET_OWNER_FULL_CONTROL;default:throw new Ve.Error("Unrecognized enum value "+u+" for enum S3ACL")}}a.s3ACLFromJSON=he;function ge(u){switch(u){case de.S3ACL_UNSPECIFIED:return"S3ACL_UNSPECIFIED";case de.S3ACL_PRIVATE:return"S3ACL_PRIVATE";case de.S3ACL_PUBLIC_READ:return"S3ACL_PUBLIC_READ";case de.S3ACL_PUBLIC_READ_WRITE:return"S3ACL_PUBLIC_READ_WRITE";case de.S3ACL_AUTHENTICATED_READ:return"S3ACL_AUTHENTICATED_READ";case de.S3ACL_BUCKET_OWNER_READ:return"S3ACL_BUCKET_OWNER_READ";case de.S3ACL_BUCKET_OWNER_FULL_CONTROL:return"S3ACL_BUCKET_OWNER_FULL_CONTROL";default:return"UNKNOWN"}}a.s3ACLToJSON=ge;function Pe(u){switch(u){case de.S3ACL_UNSPECIFIED:return 0;case de.S3ACL_PRIVATE:return 1;case de.S3ACL_PUBLIC_READ:return 2;case de.S3ACL_PUBLIC_READ_WRITE:return 3;case de.S3ACL_AUTHENTICATED_READ:return 4;case de.S3ACL_BUCKET_OWNER_READ:return 5;case de.S3ACL_BUCKET_OWNER_FULL_CONTROL:return 6;default:return 0}}a.s3ACLToNumber=Pe;var Te;(function(u){u.SOURCE_TRIGGER_ACTION_UNSPECIFIED="SOURCE_TRIGGER_ACTION_UNSPECIFIED",u.SOURCE_TRIGGER_ACTION_IGNORE="SOURCE_TRIGGER_ACTION_IGNORE",u.SOURCE_TRIGGER_ACTION_OR="SOURCE_TRIGGER_ACTION_OR"})(Te=a.SourceTriggerAction||(a.SourceTriggerAction={}));function _e(u){switch(u){case 0:case"SOURCE_TRIGGER_ACTION_UNSPECIFIED":return Te.SOURCE_TRIGGER_ACTION_UNSPECIFIED;case 1:case"SOURCE_TRIGGER_ACTION_IGNORE":return Te.SOURCE_TRIGGER_ACTION_IGNORE;case 3:case"SOURCE_TRIGGER_ACTION_OR":return Te.SOURCE_TRIGGER_ACTION_OR;default:throw new Ve.Error("Unrecognized enum value "+u+" for enum SourceTriggerAction")}}a.sourceTriggerActionFromJSON=_e;function Ne(u){switch(u){case Te.SOURCE_TRIGGER_ACTION_UNSPECIFIED:return"SOURCE_TRIGGER_ACTION_UNSPECIFIED";case Te.SOURCE_TRIGGER_ACTION_IGNORE:return"SOURCE_TRIGGER_ACTION_IGNORE";case Te.SOURCE_TRIGGER_ACTION_OR:return"SOURCE_TRIGGER_ACTION_OR";default:return"UNKNOWN"}}a.sourceTriggerActionToJSON=Ne;function We(u){switch(u){case Te.SOURCE_TRIGGER_ACTION_UNSPECIFIED:return 0;case Te.SOURCE_TRIGGER_ACTION_IGNORE:return 1;case Te.SOURCE_TRIGGER_ACTION_OR:return 3;default:return 0}}a.sourceTriggerActionToNumber=We;var ye;(function(u){u.REGION_UNSPECIFIED="REGION_UNSPECIFIED",u.REGION_US_EAST_1="REGION_US_EAST_1",u.REGION_US_EAST_2="REGION_US_EAST_2",u.REGION_US_WEST_1="REGION_US_WEST_1",u.REGION_US_WEST_2="REGION_US_WEST_2",u.REGION_US_CENTRAL_1="REGION_US_CENTRAL_1",u.REGION_AP_SOUTHEAST_1="REGION_AP_SOUTHEAST_1",u.REGION_CA_EAST_1="REGION_CA_EAST_1",u.REGION_EU_CENTRAL_1="REGION_EU_CENTRAL_1",u.REGION_EU_WEST_1="REGION_EU_WEST_1"})(ye=a.Region||(a.Region={}));function qe(u){switch(u){case 0:case"REGION_UNSPECIFIED":return ye.REGION_UNSPECIFIED;case 1:case"REGION_US_EAST_1":return ye.REGION_US_EAST_1;case 2:case"REGION_US_EAST_2":return ye.REGION_US_EAST_2;case 3:case"REGION_US_WEST_1":return ye.REGION_US_WEST_1;case 4:case"REGION_US_WEST_2":return ye.REGION_US_WEST_2;case 5:case"REGION_US_CENTRAL_1":return ye.REGION_US_CENTRAL_1;case 10:case"REGION_AP_SOUTHEAST_1":return ye.REGION_AP_SOUTHEAST_1;case 20:case"REGION_CA_EAST_1":return ye.REGION_CA_EAST_1;case 30:case"REGION_EU_CENTRAL_1":return ye.REGION_EU_CENTRAL_1;case 31:case"REGION_EU_WEST_1":return ye.REGION_EU_WEST_1;default:throw new Ve.Error("Unrecognized enum value "+u+" for enum Region")}}a.regionFromJSON=qe;function Ke(u){switch(u){case ye.REGION_UNSPECIFIED:return"REGION_UNSPECIFIED";case ye.REGION_US_EAST_1:return"REGION_US_EAST_1";case ye.REGION_US_EAST_2:return"REGION_US_EAST_2";case ye.REGION_US_WEST_1:return"REGION_US_WEST_1";case ye.REGION_US_WEST_2:return"REGION_US_WEST_2";case ye.REGION_US_CENTRAL_1:return"REGION_US_CENTRAL_1";case ye.REGION_AP_SOUTHEAST_1:return"REGION_AP_SOUTHEAST_1";case ye.REGION_CA_EAST_1:return"REGION_CA_EAST_1";case ye.REGION_EU_CENTRAL_1:return"REGION_EU_CENTRAL_1";case ye.REGION_EU_WEST_1:return"REGION_EU_WEST_1";default:return"UNKNOWN"}}a.regionToJSON=Ke;function et(u){switch(u){case ye.REGION_UNSPECIFIED:return 0;case ye.REGION_US_EAST_1:return 1;case ye.REGION_US_EAST_2:return 2;case ye.REGION_US_WEST_1:return 3;case ye.REGION_US_WEST_2:return 4;case ye.REGION_US_CENTRAL_1:return 5;case ye.REGION_AP_SOUTHEAST_1:return 10;case ye.REGION_CA_EAST_1:return 20;case ye.REGION_EU_CENTRAL_1:return 30;case ye.REGION_EU_WEST_1:return 31;default:return 0}}a.regionToNumber=et;var ve;(function(u){u.ROLE_UNSPECIFIED="ROLE_UNSPECIFIED",u.ROLE_HOST="ROLE_HOST",u.ROLE_COHOST="ROLE_COHOST",u.ROLE_CONTRIBUTOR="ROLE_CONTRIBUTOR",u.ROLE_GUEST="ROLE_GUEST",u.ROLE_VIEWER="ROLE_VIEWER",u.ROLE_RENDERER="ROLE_RENDERER",u.ROLE_PLATFORM="ROLE_PLATFORM",u.ROLE_IMPERSONATE="ROLE_IMPERSONATE"})(ve=a.Role||(a.Role={}));function Oe(u){switch(u){case 0:case"ROLE_UNSPECIFIED":return ve.ROLE_UNSPECIFIED;case 1:case"ROLE_HOST":return ve.ROLE_HOST;case 2:case"ROLE_COHOST":return ve.ROLE_COHOST;case 3:case"ROLE_CONTRIBUTOR":return ve.ROLE_CONTRIBUTOR;case 4:case"ROLE_GUEST":return ve.ROLE_GUEST;case 5:case"ROLE_VIEWER":return ve.ROLE_VIEWER;case 6:case"ROLE_RENDERER":return ve.ROLE_RENDERER;case 7:case"ROLE_PLATFORM":return ve.ROLE_PLATFORM;case 8:case"ROLE_IMPERSONATE":return ve.ROLE_IMPERSONATE;default:throw new Ve.Error("Unrecognized enum value "+u+" for enum Role")}}a.roleFromJSON=Oe;function Ee(u){switch(u){case ve.ROLE_UNSPECIFIED:return"ROLE_UNSPECIFIED";case ve.ROLE_HOST:return"ROLE_HOST";case ve.ROLE_COHOST:return"ROLE_COHOST";case ve.ROLE_CONTRIBUTOR:return"ROLE_CONTRIBUTOR";case ve.ROLE_GUEST:return"ROLE_GUEST";case ve.ROLE_VIEWER:return"ROLE_VIEWER";case ve.ROLE_RENDERER:return"ROLE_RENDERER";case ve.ROLE_PLATFORM:return"ROLE_PLATFORM";case ve.ROLE_IMPERSONATE:return"ROLE_IMPERSONATE";default:return"UNKNOWN"}}a.roleToJSON=Ee;function Ae(u){switch(u){case ve.ROLE_UNSPECIFIED:return 0;case ve.ROLE_HOST:return 1;case ve.ROLE_COHOST:return 2;case ve.ROLE_CONTRIBUTOR:return 3;case ve.ROLE_GUEST:return 4;case ve.ROLE_VIEWER:return 5;case ve.ROLE_RENDERER:return 6;case ve.ROLE_PLATFORM:return 7;case ve.ROLE_IMPERSONATE:return 8;default:return 0}}a.roleToNumber=Ae;var be;(function(u){u.PROJECT_BROADCAST_ERROR_UNSPECIFIED="PROJECT_BROADCAST_ERROR_UNSPECIFIED",u.PROJECT_BROADCAST_ERROR_INTERNAL="PROJECT_BROADCAST_ERROR_INTERNAL",u.PROJECT_BROADCAST_ERROR_DURATION_EXCEEDED="PROJECT_BROADCAST_ERROR_DURATION_EXCEEDED"})(be=a.ProjectBroadcastError||(a.ProjectBroadcastError={}));function Qe(u){switch(u){case 0:case"PROJECT_BROADCAST_ERROR_UNSPECIFIED":return be.PROJECT_BROADCAST_ERROR_UNSPECIFIED;case 1:case"PROJECT_BROADCAST_ERROR_INTERNAL":return be.PROJECT_BROADCAST_ERROR_INTERNAL;case 2:case"PROJECT_BROADCAST_ERROR_DURATION_EXCEEDED":return be.PROJECT_BROADCAST_ERROR_DURATION_EXCEEDED;default:throw new Ve.Error("Unrecognized enum value "+u+" for enum ProjectBroadcastError")}}a.projectBroadcastErrorFromJSON=Qe;function Re(u){switch(u){case be.PROJECT_BROADCAST_ERROR_UNSPECIFIED:return"PROJECT_BROADCAST_ERROR_UNSPECIFIED";case be.PROJECT_BROADCAST_ERROR_INTERNAL:return"PROJECT_BROADCAST_ERROR_INTERNAL";case be.PROJECT_BROADCAST_ERROR_DURATION_EXCEEDED:return"PROJECT_BROADCAST_ERROR_DURATION_EXCEEDED";default:return"UNKNOWN"}}a.projectBroadcastErrorToJSON=Re;function Xe(u){switch(u){case be.PROJECT_BROADCAST_ERROR_UNSPECIFIED:return 0;case be.PROJECT_BROADCAST_ERROR_INTERNAL:return 1;case be.PROJECT_BROADCAST_ERROR_DURATION_EXCEEDED:return 2;default:return 0}}a.projectBroadcastErrorToNumber=Xe;var Me;(function(u){u.CONNECT_STATE_UNSPECIFIED="CONNECT_STATE_UNSPECIFIED",u.CONNECT_STATE_CONNECTED="CONNECT_STATE_CONNECTED",u.CONNECT_STATE_DISCONNECTED="CONNECT_STATE_DISCONNECTED"})(Me=a.ConnectState||(a.ConnectState={}));function Ze(u){switch(u){case 0:case"CONNECT_STATE_UNSPECIFIED":return Me.CONNECT_STATE_UNSPECIFIED;case 1:case"CONNECT_STATE_CONNECTED":return Me.CONNECT_STATE_CONNECTED;case 2:case"CONNECT_STATE_DISCONNECTED":return Me.CONNECT_STATE_DISCONNECTED;default:throw new Ve.Error("Unrecognized enum value "+u+" for enum ConnectState")}}a.connectStateFromJSON=Ze;function nt(u){switch(u){case Me.CONNECT_STATE_UNSPECIFIED:return"CONNECT_STATE_UNSPECIFIED";case Me.CONNECT_STATE_CONNECTED:return"CONNECT_STATE_CONNECTED";case Me.CONNECT_STATE_DISCONNECTED:return"CONNECT_STATE_DISCONNECTED";default:return"UNKNOWN"}}a.connectStateToJSON=nt;function rt(u){switch(u){case Me.CONNECT_STATE_UNSPECIFIED:return 0;case Me.CONNECT_STATE_CONNECTED:return 1;case Me.CONNECT_STATE_DISCONNECTED:return 2;default:return 0}}a.connectStateToNumber=rt;var Ue;(function(u){u.EVENT_SUB_TYPE_UNSPECIFIED="EVENT_SUB_TYPE_UNSPECIFIED",u.EVENT_SUB_TYPE_CREATE="EVENT_SUB_TYPE_CREATE",u.EVENT_SUB_TYPE_UPDATE="EVENT_SUB_TYPE_UPDATE",u.EVENT_SUB_TYPE_DELETE="EVENT_SUB_TYPE_DELETE",u.EVENT_SUB_TYPE_ADD="EVENT_SUB_TYPE_ADD",u.EVENT_SUB_TYPE_REMOVE="EVENT_SUB_TYPE_REMOVE",u.EVENT_SUB_TYPE_STATE="EVENT_SUB_TYPE_STATE"})(Ue=a.EventSubType||(a.EventSubType={}));function ot(u){switch(u){case 0:case"EVENT_SUB_TYPE_UNSPECIFIED":return Ue.EVENT_SUB_TYPE_UNSPECIFIED;case 1:case"EVENT_SUB_TYPE_CREATE":return Ue.EVENT_SUB_TYPE_CREATE;case 2:case"EVENT_SUB_TYPE_UPDATE":return Ue.EVENT_SUB_TYPE_UPDATE;case 3:case"EVENT_SUB_TYPE_DELETE":return Ue.EVENT_SUB_TYPE_DELETE;case 4:case"EVENT_SUB_TYPE_ADD":return Ue.EVENT_SUB_TYPE_ADD;case 5:case"EVENT_SUB_TYPE_REMOVE":return Ue.EVENT_SUB_TYPE_REMOVE;case 6:case"EVENT_SUB_TYPE_STATE":return Ue.EVENT_SUB_TYPE_STATE;default:throw new Ve.Error("Unrecognized enum value "+u+" for enum EventSubType")}}a.eventSubTypeFromJSON=ot;function tt(u){switch(u){case Ue.EVENT_SUB_TYPE_UNSPECIFIED:return"EVENT_SUB_TYPE_UNSPECIFIED";case Ue.EVENT_SUB_TYPE_CREATE:return"EVENT_SUB_TYPE_CREATE";case Ue.EVENT_SUB_TYPE_UPDATE:return"EVENT_SUB_TYPE_UPDATE";case Ue.EVENT_SUB_TYPE_DELETE:return"EVENT_SUB_TYPE_DELETE";case Ue.EVENT_SUB_TYPE_ADD:return"EVENT_SUB_TYPE_ADD";case Ue.EVENT_SUB_TYPE_REMOVE:return"EVENT_SUB_TYPE_REMOVE";case Ue.EVENT_SUB_TYPE_STATE:return"EVENT_SUB_TYPE_STATE";default:return"UNKNOWN"}}a.eventSubTypeToJSON=tt;function at(u){switch(u){case Ue.EVENT_SUB_TYPE_UNSPECIFIED:return 0;case Ue.EVENT_SUB_TYPE_CREATE:return 1;case Ue.EVENT_SUB_TYPE_UPDATE:return 2;case Ue.EVENT_SUB_TYPE_DELETE:return 3;case Ue.EVENT_SUB_TYPE_ADD:return 4;case Ue.EVENT_SUB_TYPE_REMOVE:return 5;case Ue.EVENT_SUB_TYPE_STATE:return 6;default:return 0}}a.eventSubTypeToNumber=at;var ce;(function(u){u.EVENT_TYPE_UNSPECIFIED="EVENT_TYPE_UNSPECIFIED",u.EVENT_TYPE_COLLECTION="EVENT_TYPE_COLLECTION",u.EVENT_TYPE_PROJECT="EVENT_TYPE_PROJECT",u.EVENT_TYPE_SOURCE="EVENT_TYPE_SOURCE",u.EVENT_TYPE_DESTINATION="EVENT_TYPE_DESTINATION"})(ce=a.EventType||(a.EventType={}));function b(u){switch(u){case 0:case"EVENT_TYPE_UNSPECIFIED":return ce.EVENT_TYPE_UNSPECIFIED;case 1:case"EVENT_TYPE_COLLECTION":return ce.EVENT_TYPE_COLLECTION;case 2:case"EVENT_TYPE_PROJECT":return ce.EVENT_TYPE_PROJECT;case 4:case"EVENT_TYPE_SOURCE":return ce.EVENT_TYPE_SOURCE;case 5:case"EVENT_TYPE_DESTINATION":return ce.EVENT_TYPE_DESTINATION;default:throw new Ve.Error("Unrecognized enum value "+u+" for enum EventType")}}a.eventTypeFromJSON=b;function N(u){switch(u){case ce.EVENT_TYPE_UNSPECIFIED:return"EVENT_TYPE_UNSPECIFIED";case ce.EVENT_TYPE_COLLECTION:return"EVENT_TYPE_COLLECTION";case ce.EVENT_TYPE_PROJECT:return"EVENT_TYPE_PROJECT";case ce.EVENT_TYPE_SOURCE:return"EVENT_TYPE_SOURCE";case ce.EVENT_TYPE_DESTINATION:return"EVENT_TYPE_DESTINATION";default:return"UNKNOWN"}}a.eventTypeToJSON=N;function V(u){switch(u){case ce.EVENT_TYPE_UNSPECIFIED:return 0;case ce.EVENT_TYPE_COLLECTION:return 1;case ce.EVENT_TYPE_PROJECT:return 2;case ce.EVENT_TYPE_SOURCE:return 4;case ce.EVENT_TYPE_DESTINATION:return 5;default:return 0}}a.eventTypeToNumber=V;function se(){return{height:void 0,width:void 0,framerate:void 0,colorSpace:void 0}}a.VideoRendering={encode(u,m=p.Writer.create()){return u.height!==void 0&&m.uint32(8).uint32(u.height),u.width!==void 0&&m.uint32(16).uint32(u.width),u.framerate!==void 0&&m.uint32(29).float(u.framerate),u.colorSpace!==void 0&&m.uint32(32).int32(j(u.colorSpace)),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=se();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.height=S.uint32();break;case 2:k.width=S.uint32();break;case 3:k.framerate=S.float();break;case 4:k.colorSpace=U(S.int32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{height:Q(u.height)?Number(u.height):void 0,width:Q(u.width)?Number(u.width):void 0,framerate:Q(u.framerate)?Number(u.framerate):void 0,colorSpace:Q(u.colorSpace)?U(u.colorSpace):void 0}},toJSON(u){const m={};return u.height!==void 0&&(m.height=Math.round(u.height)),u.width!==void 0&&(m.width=Math.round(u.width)),u.framerate!==void 0&&(m.framerate=u.framerate),u.colorSpace!==void 0&&(m.colorSpace=u.colorSpace!==void 0?F(u.colorSpace):void 0),m},fromPartial(u){var m,S,B,k;const H=se();return H.height=(m=u.height)!==null&&m!==void 0?m:void 0,H.width=(S=u.width)!==null&&S!==void 0?S:void 0,H.framerate=(B=u.framerate)!==null&&B!==void 0?B:void 0,H.colorSpace=(k=u.colorSpace)!==null&&k!==void 0?k:void 0,H}};function re(){return{channelLayout:void 0}}a.AudioRendering={encode(u,m=p.Writer.create()){return u.channelLayout!==void 0&&m.uint32(8).int32(ee(u.channelLayout)),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=re();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.channelLayout=D(S.int32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{channelLayout:Q(u.channelLayout)?D(u.channelLayout):void 0}},toJSON(u){const m={};return u.channelLayout!==void 0&&(m.channelLayout=u.channelLayout!==void 0?J(u.channelLayout):void 0),m},fromPartial(u){var m;const S=re();return S.channelLayout=(m=u.channelLayout)!==null&&m!==void 0?m:void 0,S}};function ue(){return{video:void 0,audio:void 0,quality:void 0,targetLatency:void 0,complexity:void 0}}a.Rendering={encode(u,m=p.Writer.create()){return u.video!==void 0&&a.VideoRendering.encode(u.video,m.uint32(10).fork()).ldelim(),u.audio!==void 0&&a.AudioRendering.encode(u.audio,m.uint32(18).fork()).ldelim(),u.quality!==void 0&&m.uint32(24).int32(M(u.quality)),u.targetLatency!==void 0&&m.uint32(32).uint32(u.targetLatency),u.complexity!==void 0&&m.uint32(40).int32(u.complexity),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=ue();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.video=a.VideoRendering.decode(S,S.uint32());break;case 2:k.audio=a.AudioRendering.decode(S,S.uint32());break;case 3:k.quality=ne(S.int32());break;case 4:k.targetLatency=S.uint32();break;case 5:k.complexity=S.int32();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{video:Q(u.video)?a.VideoRendering.fromJSON(u.video):void 0,audio:Q(u.audio)?a.AudioRendering.fromJSON(u.audio):void 0,quality:Q(u.quality)?ne(u.quality):void 0,targetLatency:Q(u.targetLatency)?Number(u.targetLatency):void 0,complexity:Q(u.complexity)?Number(u.complexity):void 0}},toJSON(u){const m={};return u.video!==void 0&&(m.video=u.video?a.VideoRendering.toJSON(u.video):void 0),u.audio!==void 0&&(m.audio=u.audio?a.AudioRendering.toJSON(u.audio):void 0),u.quality!==void 0&&(m.quality=u.quality!==void 0?X(u.quality):void 0),u.targetLatency!==void 0&&(m.targetLatency=Math.round(u.targetLatency)),u.complexity!==void 0&&(m.complexity=Math.round(u.complexity)),m},fromPartial(u){var m,S,B;const k=ue();return k.video=u.video!==void 0&&u.video!==null?a.VideoRendering.fromPartial(u.video):void 0,k.audio=u.audio!==void 0&&u.audio!==null?a.AudioRendering.fromPartial(u.audio):void 0,k.quality=(m=u.quality)!==null&&m!==void 0?m:void 0,k.targetLatency=(S=u.targetLatency)!==null&&S!==void 0?S:void 0,k.complexity=(B=u.complexity)!==null&&B!==void 0?B:void 0,k}};function we(){return{mode:void 0,targetBitrate:void 0,maxKeyFrameInterval:void 0}}a.VideoCodecRateControl={encode(u,m=p.Writer.create()){return u.mode!==void 0&&m.uint32(8).int32(ae(u.mode)),u.targetBitrate!==void 0&&m.uint32(16).uint32(u.targetBitrate),u.maxKeyFrameInterval!==void 0&&m.uint32(24).uint32(u.maxKeyFrameInterval),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=we();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.mode=g(S.int32());break;case 2:k.targetBitrate=S.uint32();break;case 3:k.maxKeyFrameInterval=S.uint32();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{mode:Q(u.mode)?g(u.mode):void 0,targetBitrate:Q(u.targetBitrate)?Number(u.targetBitrate):void 0,maxKeyFrameInterval:Q(u.maxKeyFrameInterval)?Number(u.maxKeyFrameInterval):void 0}},toJSON(u){const m={};return u.mode!==void 0&&(m.mode=u.mode!==void 0?w(u.mode):void 0),u.targetBitrate!==void 0&&(m.targetBitrate=Math.round(u.targetBitrate)),u.maxKeyFrameInterval!==void 0&&(m.maxKeyFrameInterval=Math.round(u.maxKeyFrameInterval)),m},fromPartial(u){var m,S,B;const k=we();return k.mode=(m=u.mode)!==null&&m!==void 0?m:void 0,k.targetBitrate=(S=u.targetBitrate)!==null&&S!==void 0?S:void 0,k.maxKeyFrameInterval=(B=u.maxKeyFrameInterval)!==null&&B!==void 0?B:void 0,k}};function Be(){return{codec:void 0,rateControl:void 0,profile:void 0}}a.VideoEncoding={encode(u,m=p.Writer.create()){return u.codec!==void 0&&m.uint32(8).int32(G(u.codec)),u.rateControl!==void 0&&a.VideoCodecRateControl.encode(u.rateControl,m.uint32(18).fork()).ldelim(),u.profile!==void 0&&m.uint32(32).int32(Y(u.profile)),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Be();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.codec=te(S.int32());break;case 2:k.rateControl=a.VideoCodecRateControl.decode(S,S.uint32());break;case 4:k.profile=ie(S.int32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{codec:Q(u.codec)?te(u.codec):void 0,rateControl:Q(u.rateControl)?a.VideoCodecRateControl.fromJSON(u.rateControl):void 0,profile:Q(u.profile)?ie(u.profile):void 0}},toJSON(u){const m={};return u.codec!==void 0&&(m.codec=u.codec!==void 0?L(u.codec):void 0),u.rateControl!==void 0&&(m.rateControl=u.rateControl?a.VideoCodecRateControl.toJSON(u.rateControl):void 0),u.profile!==void 0&&(m.profile=u.profile!==void 0?x(u.profile):void 0),m},fromPartial(u){var m,S;const B=Be();return B.codec=(m=u.codec)!==null&&m!==void 0?m:void 0,B.rateControl=u.rateControl!==void 0&&u.rateControl!==null?a.VideoCodecRateControl.fromPartial(u.rateControl):void 0,B.profile=(S=u.profile)!==null&&S!==void 0?S:void 0,B}};function Je(){return{codec:void 0}}a.AudioEncoding={encode(u,m=p.Writer.create()){return u.codec!==void 0&&m.uint32(8).int32(me(u.codec)),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Je();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.codec=fe(S.int32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{codec:Q(u.codec)?fe(u.codec):void 0}},toJSON(u){const m={};return u.codec!==void 0&&(m.codec=u.codec!==void 0?pe(u.codec):void 0),m},fromPartial(u){var m;const S=Je();return S.codec=(m=u.codec)!==null&&m!==void 0?m:void 0,S}};function De(){return{video:void 0,audio:void 0}}a.Encoding={encode(u,m=p.Writer.create()){return u.video!==void 0&&a.VideoEncoding.encode(u.video,m.uint32(10).fork()).ldelim(),u.audio!==void 0&&a.AudioEncoding.encode(u.audio,m.uint32(18).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=De();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.video=a.VideoEncoding.decode(S,S.uint32());break;case 2:k.audio=a.AudioEncoding.decode(S,S.uint32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{video:Q(u.video)?a.VideoEncoding.fromJSON(u.video):void 0,audio:Q(u.audio)?a.AudioEncoding.fromJSON(u.audio):void 0}},toJSON(u){const m={};return u.video!==void 0&&(m.video=u.video?a.VideoEncoding.toJSON(u.video):void 0),u.audio!==void 0&&(m.audio=u.audio?a.AudioEncoding.toJSON(u.audio):void 0),m},fromPartial(u){const m=De();return m.video=u.video!==void 0&&u.video!==null?a.VideoEncoding.fromPartial(u.video):void 0,m.audio=u.audio!==void 0&&u.audio!==null?a.AudioEncoding.fromPartial(u.audio):void 0,m}};function Le(){return{enabled:void 0,key:void 0,url:void 0,baseUrl:void 0}}a.SourceRtmpPushAddress={encode(u,m=p.Writer.create()){return u.enabled!==void 0&&m.uint32(8).bool(u.enabled),u.key!==void 0&&m.uint32(18).string(u.key),u.url!==void 0&&m.uint32(26).string(u.url),u.baseUrl!==void 0&&m.uint32(34).string(u.baseUrl),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Le();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.enabled=S.bool();break;case 2:k.key=S.string();break;case 3:k.url=S.string();break;case 4:k.baseUrl=S.string();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{enabled:Q(u.enabled)?Boolean(u.enabled):void 0,key:Q(u.key)?String(u.key):void 0,url:Q(u.url)?String(u.url):void 0,baseUrl:Q(u.baseUrl)?String(u.baseUrl):void 0}},toJSON(u){const m={};return u.enabled!==void 0&&(m.enabled=u.enabled),u.key!==void 0&&(m.key=u.key),u.url!==void 0&&(m.url=u.url),u.baseUrl!==void 0&&(m.baseUrl=u.baseUrl),m},fromPartial(u){var m,S,B,k;const H=Le();return H.enabled=(m=u.enabled)!==null&&m!==void 0?m:void 0,H.key=(S=u.key)!==null&&S!==void 0?S:void 0,H.url=(B=u.url)!==null&&B!==void 0?B:void 0,H.baseUrl=(k=u.baseUrl)!==null&&k!==void 0?k:void 0,H}};function He(){return{enabled:void 0,streamId:void 0,url:void 0,baseUrl:void 0}}a.SrtPushAddress={encode(u,m=p.Writer.create()){return u.enabled!==void 0&&m.uint32(8).bool(u.enabled),u.streamId!==void 0&&m.uint32(18).string(u.streamId),u.url!==void 0&&m.uint32(26).string(u.url),u.baseUrl!==void 0&&m.uint32(34).string(u.baseUrl),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=He();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.enabled=S.bool();break;case 2:k.streamId=S.string();break;case 3:k.url=S.string();break;case 4:k.baseUrl=S.string();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{enabled:Q(u.enabled)?Boolean(u.enabled):void 0,streamId:Q(u.streamId)?String(u.streamId):void 0,url:Q(u.url)?String(u.url):void 0,baseUrl:Q(u.baseUrl)?String(u.baseUrl):void 0}},toJSON(u){const m={};return u.enabled!==void 0&&(m.enabled=u.enabled),u.streamId!==void 0&&(m.streamId=u.streamId),u.url!==void 0&&(m.url=u.url),u.baseUrl!==void 0&&(m.baseUrl=u.baseUrl),m},fromPartial(u){var m,S,B,k;const H=He();return H.enabled=(m=u.enabled)!==null&&m!==void 0?m:void 0,H.streamId=(S=u.streamId)!==null&&S!==void 0?S:void 0,H.url=(B=u.url)!==null&&B!==void 0?B:void 0,H.baseUrl=(k=u.baseUrl)!==null&&k!==void 0?k:void 0,H}};function je(){return{url:""}}a.RtmpPullAddress={encode(u,m=p.Writer.create()){return u.url!==""&&m.uint32(10).string(u.url),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=je();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.url=S.string();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{url:Q(u.url)?String(u.url):""}},toJSON(u){const m={};return u.url!==void 0&&(m.url=u.url),m},fromPartial(u){var m;const S=je();return S.url=(m=u.url)!==null&&m!==void 0?m:"",S}};function Ye(){return{rtmpPush:void 0,srtPush:void 0,rtmpPull:void 0}}a.SourceAddress={encode(u,m=p.Writer.create()){return u.rtmpPush!==void 0&&a.SourceRtmpPushAddress.encode(u.rtmpPush,m.uint32(10).fork()).ldelim(),u.srtPush!==void 0&&a.SrtPushAddress.encode(u.srtPush,m.uint32(18).fork()).ldelim(),u.rtmpPull!==void 0&&a.RtmpPullAddress.encode(u.rtmpPull,m.uint32(26).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Ye();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.rtmpPush=a.SourceRtmpPushAddress.decode(S,S.uint32());break;case 2:k.srtPush=a.SrtPushAddress.decode(S,S.uint32());break;case 3:k.rtmpPull=a.RtmpPullAddress.decode(S,S.uint32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{rtmpPush:Q(u.rtmpPush)?a.SourceRtmpPushAddress.fromJSON(u.rtmpPush):void 0,srtPush:Q(u.srtPush)?a.SrtPushAddress.fromJSON(u.srtPush):void 0,rtmpPull:Q(u.rtmpPull)?a.RtmpPullAddress.fromJSON(u.rtmpPull):void 0}},toJSON(u){const m={};return u.rtmpPush!==void 0&&(m.rtmpPush=u.rtmpPush?a.SourceRtmpPushAddress.toJSON(u.rtmpPush):void 0),u.srtPush!==void 0&&(m.srtPush=u.srtPush?a.SrtPushAddress.toJSON(u.srtPush):void 0),u.rtmpPull!==void 0&&(m.rtmpPull=u.rtmpPull?a.RtmpPullAddress.toJSON(u.rtmpPull):void 0),m},fromPartial(u){const m=Ye();return m.rtmpPush=u.rtmpPush!==void 0&&u.rtmpPush!==null?a.SourceRtmpPushAddress.fromPartial(u.rtmpPush):void 0,m.srtPush=u.srtPush!==void 0&&u.srtPush!==null?a.SrtPushAddress.fromPartial(u.srtPush):void 0,m.rtmpPull=u.rtmpPull!==void 0&&u.rtmpPull!==null?a.RtmpPullAddress.fromPartial(u.rtmpPull):void 0,m}};function ze(){return{key:void 0,url:""}}a.DestinationRtmpPushAddress={encode(u,m=p.Writer.create()){return u.key!==void 0&&m.uint32(10).string(u.key),u.url!==""&&m.uint32(18).string(u.url),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=ze();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.key=S.string();break;case 2:k.url=S.string();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{key:Q(u.key)?String(u.key):void 0,url:Q(u.url)?String(u.url):""}},toJSON(u){const m={};return u.key!==void 0&&(m.key=u.key),u.url!==void 0&&(m.url=u.url),m},fromPartial(u){var m,S;const B=ze();return B.key=(m=u.key)!==null&&m!==void 0?m:void 0,B.url=(S=u.url)!==null&&S!==void 0?S:"",B}};function xe(){return{appId:"",channelId:"",userId:""}}a.DestinationAgoraPushAddress={encode(u,m=p.Writer.create()){return u.appId!==""&&m.uint32(10).string(u.appId),u.channelId!==""&&m.uint32(18).string(u.channelId),u.userId!==""&&m.uint32(26).string(u.userId),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=xe();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.appId=S.string();break;case 2:k.channelId=S.string();break;case 3:k.userId=S.string();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{appId:Q(u.appId)?String(u.appId):"",channelId:Q(u.channelId)?String(u.channelId):"",userId:Q(u.userId)?String(u.userId):""}},toJSON(u){const m={};return u.appId!==void 0&&(m.appId=u.appId),u.channelId!==void 0&&(m.channelId=u.channelId),u.userId!==void 0&&(m.userId=u.userId),m},fromPartial(u){var m,S,B;const k=xe();return k.appId=(m=u.appId)!==null&&m!==void 0?m:"",k.channelId=(S=u.channelId)!==null&&S!==void 0?S:"",k.userId=(B=u.userId)!==null&&B!==void 0?B:"",k}};function $e(){return{playlistCount:void 0,fileCount:void 0}}a.HlsLifecycleLive={encode(u,m=p.Writer.create()){return u.playlistCount!==void 0&&m.uint32(8).int32(u.playlistCount),u.fileCount!==void 0&&m.uint32(16).int32(u.fileCount),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=$e();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.playlistCount=S.int32();break;case 2:k.fileCount=S.int32();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{playlistCount:Q(u.playlistCount)?Number(u.playlistCount):void 0,fileCount:Q(u.fileCount)?Number(u.fileCount):void 0}},toJSON(u){const m={};return u.playlistCount!==void 0&&(m.playlistCount=Math.round(u.playlistCount)),u.fileCount!==void 0&&(m.fileCount=Math.round(u.fileCount)),m},fromPartial(u){var m,S;const B=$e();return B.playlistCount=(m=u.playlistCount)!==null&&m!==void 0?m:void 0,B.fileCount=(S=u.fileCount)!==null&&S!==void 0?S:void 0,B}};function Ie(){return{maxDuration:void 0}}a.HlsLifecycleVod={encode(u,m=p.Writer.create()){return u.maxDuration!==void 0&&m.uint32(8).int32(u.maxDuration),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Ie();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.maxDuration=S.int32();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{maxDuration:Q(u.maxDuration)?Number(u.maxDuration):void 0}},toJSON(u){const m={};return u.maxDuration!==void 0&&(m.maxDuration=Math.round(u.maxDuration)),m},fromPartial(u){var m;const S=Ie();return S.maxDuration=(m=u.maxDuration)!==null&&m!==void 0?m:void 0,S}};function it(){return{vod:void 0,live:void 0}}a.HlsLifecycle={encode(u,m=p.Writer.create()){return u.vod!==void 0&&a.HlsLifecycleVod.encode(u.vod,m.uint32(10).fork()).ldelim(),u.live!==void 0&&a.HlsLifecycleLive.encode(u.live,m.uint32(18).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=it();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.vod=a.HlsLifecycleVod.decode(S,S.uint32());break;case 2:k.live=a.HlsLifecycleLive.decode(S,S.uint32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{vod:Q(u.vod)?a.HlsLifecycleVod.fromJSON(u.vod):void 0,live:Q(u.live)?a.HlsLifecycleLive.fromJSON(u.live):void 0}},toJSON(u){const m={};return u.vod!==void 0&&(m.vod=u.vod?a.HlsLifecycleVod.toJSON(u.vod):void 0),u.live!==void 0&&(m.live=u.live?a.HlsLifecycleLive.toJSON(u.live):void 0),m},fromPartial(u){const m=it();return m.vod=u.vod!==void 0&&u.vod!==null?a.HlsLifecycleVod.fromPartial(u.vod):void 0,m.live=u.live!==void 0&&u.live!==null?a.HlsLifecycleLive.fromPartial(u.live):void 0,m}};function ut(){return{lifecycle:void 0,segmentDuration:void 0}}a.HlsPackaging={encode(u,m=p.Writer.create()){return u.lifecycle!==void 0&&a.HlsLifecycle.encode(u.lifecycle,m.uint32(10).fork()).ldelim(),u.segmentDuration!==void 0&&m.uint32(16).int32(u.segmentDuration),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=ut();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.lifecycle=a.HlsLifecycle.decode(S,S.uint32());break;case 2:k.segmentDuration=S.int32();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{lifecycle:Q(u.lifecycle)?a.HlsLifecycle.fromJSON(u.lifecycle):void 0,segmentDuration:Q(u.segmentDuration)?Number(u.segmentDuration):void 0}},toJSON(u){const m={};return u.lifecycle!==void 0&&(m.lifecycle=u.lifecycle?a.HlsLifecycle.toJSON(u.lifecycle):void 0),u.segmentDuration!==void 0&&(m.segmentDuration=Math.round(u.segmentDuration)),m},fromPartial(u){var m;const S=ut();return S.lifecycle=u.lifecycle!==void 0&&u.lifecycle!==null?a.HlsLifecycle.fromPartial(u.lifecycle):void 0,S.segmentDuration=(m=u.segmentDuration)!==null&&m!==void 0?m:void 0,S}};function ct(){return{hls:void 0}}a.ObjectStoragePackaging={encode(u,m=p.Writer.create()){return u.hls!==void 0&&a.HlsPackaging.encode(u.hls,m.uint32(10).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=ct();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.hls=a.HlsPackaging.decode(S,S.uint32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{hls:Q(u.hls)?a.HlsPackaging.fromJSON(u.hls):void 0}},toJSON(u){const m={};return u.hls!==void 0&&(m.hls=u.hls?a.HlsPackaging.toJSON(u.hls):void 0),m},fromPartial(u){const m=ct();return m.hls=u.hls!==void 0&&u.hls!==null?a.HlsPackaging.fromPartial(u.hls):void 0,m}};function lt(){return{region:"",bucket:"",prefix:void 0,accessKey:"",secretKey:"",token:void 0,tokenDuration:void 0,acl:void 0,endpoint:void 0,packaging:void 0}}a.S3StorageAddress={encode(u,m=p.Writer.create()){return u.region!==""&&m.uint32(10).string(u.region),u.bucket!==""&&m.uint32(18).string(u.bucket),u.prefix!==void 0&&m.uint32(26).string(u.prefix),u.accessKey!==""&&m.uint32(34).string(u.accessKey),u.secretKey!==""&&m.uint32(42).string(u.secretKey),u.token!==void 0&&m.uint32(50).string(u.token),u.tokenDuration!==void 0&&m.uint32(56).int32(u.tokenDuration),u.acl!==void 0&&m.uint32(64).int32(Pe(u.acl)),u.endpoint!==void 0&&m.uint32(74).string(u.endpoint),u.packaging!==void 0&&a.ObjectStoragePackaging.encode(u.packaging,m.uint32(82).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=lt();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.region=S.string();break;case 2:k.bucket=S.string();break;case 3:k.prefix=S.string();break;case 4:k.accessKey=S.string();break;case 5:k.secretKey=S.string();break;case 6:k.token=S.string();break;case 7:k.tokenDuration=S.int32();break;case 8:k.acl=he(S.int32());break;case 9:k.endpoint=S.string();break;case 10:k.packaging=a.ObjectStoragePackaging.decode(S,S.uint32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{region:Q(u.region)?String(u.region):"",bucket:Q(u.bucket)?String(u.bucket):"",prefix:Q(u.prefix)?String(u.prefix):void 0,accessKey:Q(u.accessKey)?String(u.accessKey):"",secretKey:Q(u.secretKey)?String(u.secretKey):"",token:Q(u.token)?String(u.token):void 0,tokenDuration:Q(u.tokenDuration)?Number(u.tokenDuration):void 0,acl:Q(u.acl)?he(u.acl):void 0,endpoint:Q(u.endpoint)?String(u.endpoint):void 0,packaging:Q(u.packaging)?a.ObjectStoragePackaging.fromJSON(u.packaging):void 0}},toJSON(u){const m={};return u.region!==void 0&&(m.region=u.region),u.bucket!==void 0&&(m.bucket=u.bucket),u.prefix!==void 0&&(m.prefix=u.prefix),u.accessKey!==void 0&&(m.accessKey=u.accessKey),u.secretKey!==void 0&&(m.secretKey=u.secretKey),u.token!==void 0&&(m.token=u.token),u.tokenDuration!==void 0&&(m.tokenDuration=Math.round(u.tokenDuration)),u.acl!==void 0&&(m.acl=u.acl!==void 0?ge(u.acl):void 0),u.endpoint!==void 0&&(m.endpoint=u.endpoint),u.packaging!==void 0&&(m.packaging=u.packaging?a.ObjectStoragePackaging.toJSON(u.packaging):void 0),m},fromPartial(u){var m,S,B,k,H,Se,ke,Ge,Fe;const Ce=lt();return Ce.region=(m=u.region)!==null&&m!==void 0?m:"",Ce.bucket=(S=u.bucket)!==null&&S!==void 0?S:"",Ce.prefix=(B=u.prefix)!==null&&B!==void 0?B:void 0,Ce.accessKey=(k=u.accessKey)!==null&&k!==void 0?k:"",Ce.secretKey=(H=u.secretKey)!==null&&H!==void 0?H:"",Ce.token=(Se=u.token)!==null&&Se!==void 0?Se:void 0,Ce.tokenDuration=(ke=u.tokenDuration)!==null&&ke!==void 0?ke:void 0,Ce.acl=(Ge=u.acl)!==null&&Ge!==void 0?Ge:void 0,Ce.endpoint=(Fe=u.endpoint)!==null&&Fe!==void 0?Fe:void 0,Ce.packaging=u.packaging!==void 0&&u.packaging!==null?a.ObjectStoragePackaging.fromPartial(u.packaging):void 0,Ce}};function ft(){return{rtmpPush:void 0,agora:void 0,s3Storage:void 0}}a.DestinationAddress={encode(u,m=p.Writer.create()){return u.rtmpPush!==void 0&&a.DestinationRtmpPushAddress.encode(u.rtmpPush,m.uint32(10).fork()).ldelim(),u.agora!==void 0&&a.DestinationAgoraPushAddress.encode(u.agora,m.uint32(18).fork()).ldelim(),u.s3Storage!==void 0&&a.S3StorageAddress.encode(u.s3Storage,m.uint32(26).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=ft();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.rtmpPush=a.DestinationRtmpPushAddress.decode(S,S.uint32());break;case 2:k.agora=a.DestinationAgoraPushAddress.decode(S,S.uint32());break;case 3:k.s3Storage=a.S3StorageAddress.decode(S,S.uint32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{rtmpPush:Q(u.rtmpPush)?a.DestinationRtmpPushAddress.fromJSON(u.rtmpPush):void 0,agora:Q(u.agora)?a.DestinationAgoraPushAddress.fromJSON(u.agora):void 0,s3Storage:Q(u.s3Storage)?a.S3StorageAddress.fromJSON(u.s3Storage):void 0}},toJSON(u){const m={};return u.rtmpPush!==void 0&&(m.rtmpPush=u.rtmpPush?a.DestinationRtmpPushAddress.toJSON(u.rtmpPush):void 0),u.agora!==void 0&&(m.agora=u.agora?a.DestinationAgoraPushAddress.toJSON(u.agora):void 0),u.s3Storage!==void 0&&(m.s3Storage=u.s3Storage?a.S3StorageAddress.toJSON(u.s3Storage):void 0),m},fromPartial(u){const m=ft();return m.rtmpPush=u.rtmpPush!==void 0&&u.rtmpPush!==null?a.DestinationRtmpPushAddress.fromPartial(u.rtmpPush):void 0,m.agora=u.agora!==void 0&&u.agora!==null?a.DestinationAgoraPushAddress.fromPartial(u.agora):void 0,m.s3Storage=u.s3Storage!==void 0&&u.s3Storage!==null?a.S3StorageAddress.fromPartial(u.s3Storage):void 0,m}};function pt(){return{sourceId:"",start:void 0,stop:void 0}}a.SourceTrigger={encode(u,m=p.Writer.create()){return u.sourceId!==""&&m.uint32(10).string(u.sourceId),u.start!==void 0&&m.uint32(16).int32(We(u.start)),u.stop!==void 0&&m.uint32(24).int32(We(u.stop)),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=pt();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.sourceId=S.string();break;case 2:k.start=_e(S.int32());break;case 3:k.stop=_e(S.int32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{sourceId:Q(u.sourceId)?String(u.sourceId):"",start:Q(u.start)?_e(u.start):void 0,stop:Q(u.stop)?_e(u.stop):void 0}},toJSON(u){const m={};return u.sourceId!==void 0&&(m.sourceId=u.sourceId),u.start!==void 0&&(m.start=u.start!==void 0?Ne(u.start):void 0),u.stop!==void 0&&(m.stop=u.stop!==void 0?Ne(u.stop):void 0),m},fromPartial(u){var m,S,B;const k=pt();return k.sourceId=(m=u.sourceId)!==null&&m!==void 0?m:"",k.start=(S=u.start)!==null&&S!==void 0?S:void 0,k.stop=(B=u.stop)!==null&&B!==void 0?B:void 0,k}};function ht(){return{stop:void 0}}a.WebRtcTrigger={encode(u,m=p.Writer.create()){return u.stop!==void 0&&m.uint32(24).int32(We(u.stop)),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=ht();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 3:k.stop=_e(S.int32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{stop:Q(u.stop)?_e(u.stop):void 0}},toJSON(u){const m={};return u.stop!==void 0&&(m.stop=u.stop!==void 0?Ne(u.stop):void 0),m},fromPartial(u){var m;const S=ht();return S.stop=(m=u.stop)!==null&&m!==void 0?m:void 0,S}};function mt(){return{source:void 0}}a.ProjectTrigger={encode(u,m=p.Writer.create()){return u.source!==void 0&&a.SourceTrigger.encode(u.source,m.uint32(10).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=mt();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.source=a.SourceTrigger.decode(S,S.uint32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{source:Q(u.source)?a.SourceTrigger.fromJSON(u.source):void 0}},toJSON(u){const m={};return u.source!==void 0&&(m.source=u.source?a.SourceTrigger.toJSON(u.source):void 0),m},fromPartial(u){const m=mt();return m.source=u.source!==void 0&&u.source!==null?a.SourceTrigger.fromPartial(u.source):void 0,m}};function vt(){return{enabled:void 0,url:void 0}}a.PreviewHlsPullAddress={encode(u,m=p.Writer.create()){return u.enabled!==void 0&&m.uint32(8).bool(u.enabled),u.url!==void 0&&m.uint32(18).string(u.url),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=vt();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.enabled=S.bool();break;case 2:k.url=S.string();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{enabled:Q(u.enabled)?Boolean(u.enabled):void 0,url:Q(u.url)?String(u.url):void 0}},toJSON(u){const m={};return u.enabled!==void 0&&(m.enabled=u.enabled),u.url!==void 0&&(m.url=u.url),m},fromPartial(u){var m,S;const B=vt();return B.enabled=(m=u.enabled)!==null&&m!==void 0?m:void 0,B.url=(S=u.url)!==null&&S!==void 0?S:void 0,B}};function St(){return{enabled:void 0,displayName:void 0,participantId:void 0}}a.PreviewWebRtcAddress={encode(u,m=p.Writer.create()){return u.enabled!==void 0&&m.uint32(8).bool(u.enabled),u.displayName!==void 0&&m.uint32(18).string(u.displayName),u.participantId!==void 0&&m.uint32(26).string(u.participantId),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=St();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.enabled=S.bool();break;case 2:k.displayName=S.string();break;case 3:k.participantId=S.string();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{enabled:Q(u.enabled)?Boolean(u.enabled):void 0,displayName:Q(u.displayName)?String(u.displayName):void 0,participantId:Q(u.participantId)?String(u.participantId):void 0}},toJSON(u){const m={};return u.enabled!==void 0&&(m.enabled=u.enabled),u.displayName!==void 0&&(m.displayName=u.displayName),u.participantId!==void 0&&(m.participantId=u.participantId),m},fromPartial(u){var m,S,B;const k=St();return k.enabled=(m=u.enabled)!==null&&m!==void 0?m:void 0,k.displayName=(S=u.displayName)!==null&&S!==void 0?S:void 0,k.participantId=(B=u.participantId)!==null&&B!==void 0?B:void 0,k}};function yt(){return{webrtc:void 0}}a.PreviewAddress={encode(u,m=p.Writer.create()){return u.webrtc!==void 0&&a.PreviewWebRtcAddress.encode(u.webrtc,m.uint32(18).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=yt();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 2:k.webrtc=a.PreviewWebRtcAddress.decode(S,S.uint32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{webrtc:Q(u.webrtc)?a.PreviewWebRtcAddress.fromJSON(u.webrtc):void 0}},toJSON(u){const m={};return u.webrtc!==void 0&&(m.webrtc=u.webrtc?a.PreviewWebRtcAddress.toJSON(u.webrtc):void 0),m},fromPartial(u){const m=yt();return m.webrtc=u.webrtc!==void 0&&u.webrtc!==null?a.PreviewWebRtcAddress.fromPartial(u.webrtc):void 0,m}};function bt(){return{rendererUrl:void 0,version:void 0}}a.StudioSdkComposition={encode(u,m=p.Writer.create()){return u.rendererUrl!==void 0&&m.uint32(10).string(u.rendererUrl),u.version!==void 0&&m.uint32(18).string(u.version),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=bt();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.rendererUrl=S.string();break;case 2:k.version=S.string();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{rendererUrl:Q(u.rendererUrl)?String(u.rendererUrl):void 0,version:Q(u.version)?String(u.version):void 0}},toJSON(u){const m={};return u.rendererUrl!==void 0&&(m.rendererUrl=u.rendererUrl),u.version!==void 0&&(m.version=u.version),m},fromPartial(u){var m,S;const B=bt();return B.rendererUrl=(m=u.rendererUrl)!==null&&m!==void 0?m:void 0,B.version=(S=u.version)!==null&&S!==void 0?S:void 0,B}};function _t(){return{rendererUrl:void 0,selectedLayoutId:void 0,debug:void 0}}a.SceneComposition={encode(u,m=p.Writer.create()){return u.rendererUrl!==void 0&&m.uint32(10).string(u.rendererUrl),u.selectedLayoutId!==void 0&&m.uint32(18).string(u.selectedLayoutId),u.debug!==void 0&&m.uint32(24).bool(u.debug),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=_t();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.rendererUrl=S.string();break;case 2:k.selectedLayoutId=S.string();break;case 3:k.debug=S.bool();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{rendererUrl:Q(u.rendererUrl)?String(u.rendererUrl):void 0,selectedLayoutId:Q(u.selectedLayoutId)?String(u.selectedLayoutId):void 0,debug:Q(u.debug)?Boolean(u.debug):void 0}},toJSON(u){const m={};return u.rendererUrl!==void 0&&(m.rendererUrl=u.rendererUrl),u.selectedLayoutId!==void 0&&(m.selectedLayoutId=u.selectedLayoutId),u.debug!==void 0&&(m.debug=u.debug),m},fromPartial(u){var m,S,B;const k=_t();return k.rendererUrl=(m=u.rendererUrl)!==null&&m!==void 0?m:void 0,k.selectedLayoutId=(S=u.selectedLayoutId)!==null&&S!==void 0?S:void 0,k.debug=(B=u.debug)!==null&&B!==void 0?B:void 0,k}};function gt(){return{url:""}}a.ExternalComposition={encode(u,m=p.Writer.create()){return u.url!==""&&m.uint32(10).string(u.url),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=gt();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.url=S.string();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{url:Q(u.url)?String(u.url):""}},toJSON(u){const m={};return u.url!==void 0&&(m.url=u.url),m},fromPartial(u){var m;const S=gt();return S.url=(m=u.url)!==null&&m!==void 0?m:"",S}};function Et(){return{external:void 0,studioSdk:void 0,scene:void 0}}a.Composition={encode(u,m=p.Writer.create()){return u.external!==void 0&&a.ExternalComposition.encode(u.external,m.uint32(10).fork()).ldelim(),u.studioSdk!==void 0&&a.StudioSdkComposition.encode(u.studioSdk,m.uint32(18).fork()).ldelim(),u.scene!==void 0&&a.SceneComposition.encode(u.scene,m.uint32(34).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Et();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.external=a.ExternalComposition.decode(S,S.uint32());break;case 2:k.studioSdk=a.StudioSdkComposition.decode(S,S.uint32());break;case 4:k.scene=a.SceneComposition.decode(S,S.uint32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{external:Q(u.external)?a.ExternalComposition.fromJSON(u.external):void 0,studioSdk:Q(u.studioSdk)?a.StudioSdkComposition.fromJSON(u.studioSdk):void 0,scene:Q(u.scene)?a.SceneComposition.fromJSON(u.scene):void 0}},toJSON(u){const m={};return u.external!==void 0&&(m.external=u.external?a.ExternalComposition.toJSON(u.external):void 0),u.studioSdk!==void 0&&(m.studioSdk=u.studioSdk?a.StudioSdkComposition.toJSON(u.studioSdk):void 0),u.scene!==void 0&&(m.scene=u.scene?a.SceneComposition.toJSON(u.scene):void 0),m},fromPartial(u){const m=Et();return m.external=u.external!==void 0&&u.external!==null?a.ExternalComposition.fromPartial(u.external):void 0,m.studioSdk=u.studioSdk!==void 0&&u.studioSdk!==null?a.StudioSdkComposition.fromPartial(u.studioSdk):void 0,m.scene=u.scene!==void 0&&u.scene!==null?a.SceneComposition.fromPartial(u.scene):void 0,m}};function Tt(){return{enabled:void 0}}a.HostedWebRtc={encode(u,m=p.Writer.create()){return u.enabled!==void 0&&m.uint32(8).bool(u.enabled),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Tt();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.enabled=S.bool();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{enabled:Q(u.enabled)?Boolean(u.enabled):void 0}},toJSON(u){const m={};return u.enabled!==void 0&&(m.enabled=u.enabled),m},fromPartial(u){var m;const S=Tt();return S.enabled=(m=u.enabled)!==null&&m!==void 0?m:void 0,S}};function It(){return{hosted:void 0}}a.WebRtc={encode(u,m=p.Writer.create()){return u.hosted!==void 0&&a.HostedWebRtc.encode(u.hosted,m.uint32(10).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=It();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.hosted=a.HostedWebRtc.decode(S,S.uint32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{hosted:Q(u.hosted)?a.HostedWebRtc.fromJSON(u.hosted):void 0}},toJSON(u){const m={};return u.hosted!==void 0&&(m.hosted=u.hosted?a.HostedWebRtc.toJSON(u.hosted):void 0),m},fromPartial(u){const m=It();return m.hosted=u.hosted!==void 0&&u.hosted!==null?a.HostedWebRtc.fromPartial(u.hosted):void 0,m}};function Ot(){return{accessToken:"",participantId:void 0}}a.WebRtcAccess={encode(u,m=p.Writer.create()){return u.accessToken!==""&&m.uint32(10).string(u.accessToken),u.participantId!==void 0&&m.uint32(26).string(u.participantId),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Ot();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.accessToken=S.string();break;case 3:k.participantId=S.string();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{accessToken:Q(u.accessToken)?String(u.accessToken):"",participantId:Q(u.participantId)?String(u.participantId):void 0}},toJSON(u){const m={};return u.accessToken!==void 0&&(m.accessToken=u.accessToken),u.participantId!==void 0&&(m.participantId=u.participantId),m},fromPartial(u){var m,S;const B=Ot();return B.accessToken=(m=u.accessToken)!==null&&m!==void 0?m:"",B.participantId=(S=u.participantId)!==null&&S!==void 0?S:void 0,B}};function kt(){return{latitude:0,longitude:0}}a.LatLong={encode(u,m=p.Writer.create()){return u.latitude!==0&&m.uint32(9).double(u.latitude),u.longitude!==0&&m.uint32(17).double(u.longitude),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=kt();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.latitude=S.double();break;case 2:k.longitude=S.double();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{latitude:Q(u.latitude)?Number(u.latitude):0,longitude:Q(u.longitude)?Number(u.longitude):0}},toJSON(u){const m={};return u.latitude!==void 0&&(m.latitude=u.latitude),u.longitude!==void 0&&(m.longitude=u.longitude),m},fromPartial(u){var m,S;const B=kt();return B.latitude=(m=u.latitude)!==null&&m!==void 0?m:0,B.longitude=(S=u.longitude)!==null&&S!==void 0?S:0,B}};function Rt(){return{collectionId:"",projectId:"",broadcastId:void 0,duration:void 0,start:void 0,stop:void 0,phase:I.PROJECT_BROADCAST_PHASE_UNSPECIFIED,region:void 0,datacenter:void 0}}a.ProjectBroadcastStatus={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.broadcastId!==void 0&&m.uint32(26).string(u.broadcastId),u.duration!==void 0&&m.uint32(32).uint32(u.duration),u.start!==void 0&&y.Timestamp.encode(st(u.start),m.uint32(42).fork()).ldelim(),u.stop!==void 0&&y.Timestamp.encode(st(u.stop),m.uint32(50).fork()).ldelim(),u.phase!==I.PROJECT_BROADCAST_PHASE_UNSPECIFIED&&m.uint32(56).int32(le(u.phase)),u.region!==void 0&&m.uint32(64).int32(et(u.region)),u.datacenter!==void 0&&m.uint32(74).string(u.datacenter),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Rt();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.projectId=S.string();break;case 3:k.broadcastId=S.string();break;case 4:k.duration=S.uint32();break;case 5:k.start=dt(y.Timestamp.decode(S,S.uint32()));break;case 6:k.stop=dt(y.Timestamp.decode(S,S.uint32()));break;case 7:k.phase=$(S.int32());break;case 8:k.region=qe(S.int32());break;case 9:k.datacenter=S.string();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",broadcastId:Q(u.broadcastId)?String(u.broadcastId):void 0,duration:Q(u.duration)?Number(u.duration):void 0,start:Q(u.start)?String(u.start):void 0,stop:Q(u.stop)?String(u.stop):void 0,phase:Q(u.phase)?$(u.phase):I.PROJECT_BROADCAST_PHASE_UNSPECIFIED,region:Q(u.region)?qe(u.region):void 0,datacenter:Q(u.datacenter)?String(u.datacenter):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.broadcastId!==void 0&&(m.broadcastId=u.broadcastId),u.duration!==void 0&&(m.duration=Math.round(u.duration)),u.start!==void 0&&(m.start=u.start),u.stop!==void 0&&(m.stop=u.stop),u.phase!==void 0&&(m.phase=Z(u.phase)),u.region!==void 0&&(m.region=u.region!==void 0?Ke(u.region):void 0),u.datacenter!==void 0&&(m.datacenter=u.datacenter),m},fromPartial(u){var m,S,B,k,H,Se,ke,Ge,Fe;const Ce=Rt();return Ce.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",Ce.projectId=(S=u.projectId)!==null&&S!==void 0?S:"",Ce.broadcastId=(B=u.broadcastId)!==null&&B!==void 0?B:void 0,Ce.duration=(k=u.duration)!==null&&k!==void 0?k:void 0,Ce.start=(H=u.start)!==null&&H!==void 0?H:void 0,Ce.stop=(Se=u.stop)!==null&&Se!==void 0?Se:void 0,Ce.phase=(ke=u.phase)!==null&&ke!==void 0?ke:I.PROJECT_BROADCAST_PHASE_UNSPECIFIED,Ce.region=(Ge=u.region)!==null&&Ge!==void 0?Ge:void 0,Ce.datacenter=(Fe=u.datacenter)!==null&&Fe!==void 0?Fe:void 0,Ce}};function Ct(){return{collectionId:"",sourceId:"",metadata:void 0,preview:void 0,address:void 0}}a.Source={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.sourceId!==""&&m.uint32(18).string(u.sourceId),u.metadata!==void 0&&_.Value.encode(_.Value.wrap(u.metadata),m.uint32(26).fork()).ldelim(),u.preview!==void 0&&a.PreviewAddress.encode(u.preview,m.uint32(34).fork()).ldelim(),u.address!==void 0&&a.SourceAddress.encode(u.address,m.uint32(50).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Ct();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.sourceId=S.string();break;case 3:k.metadata=_.Value.unwrap(_.Value.decode(S,S.uint32()));break;case 4:k.preview=a.PreviewAddress.decode(S,S.uint32());break;case 6:k.address=a.SourceAddress.decode(S,S.uint32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",sourceId:Q(u.sourceId)?String(u.sourceId):"",metadata:Q(u==null?void 0:u.metadata)?u.metadata:void 0,preview:Q(u.preview)?a.PreviewAddress.fromJSON(u.preview):void 0,address:Q(u.address)?a.SourceAddress.fromJSON(u.address):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.sourceId!==void 0&&(m.sourceId=u.sourceId),u.metadata!==void 0&&(m.metadata=u.metadata),u.preview!==void 0&&(m.preview=u.preview?a.PreviewAddress.toJSON(u.preview):void 0),u.address!==void 0&&(m.address=u.address?a.SourceAddress.toJSON(u.address):void 0),m},fromPartial(u){var m,S,B;const k=Ct();return k.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",k.sourceId=(S=u.sourceId)!==null&&S!==void 0?S:"",k.metadata=(B=u.metadata)!==null&&B!==void 0?B:void 0,k.preview=u.preview!==void 0&&u.preview!==null?a.PreviewAddress.fromPartial(u.preview):void 0,k.address=u.address!==void 0&&u.address!==null?a.SourceAddress.fromPartial(u.address):void 0,k}};function Pt(){return{collectionId:"",projectId:"",destinationId:"",metadata:void 0,enabled:void 0,address:void 0,timeout:void 0}}a.Destination={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.destinationId!==""&&m.uint32(26).string(u.destinationId),u.metadata!==void 0&&_.Value.encode(_.Value.wrap(u.metadata),m.uint32(34).fork()).ldelim(),u.enabled!==void 0&&m.uint32(40).bool(u.enabled),u.address!==void 0&&a.DestinationAddress.encode(u.address,m.uint32(50).fork()).ldelim(),u.timeout!==void 0&&m.uint32(56).uint32(u.timeout),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Pt();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.projectId=S.string();break;case 3:k.destinationId=S.string();break;case 4:k.metadata=_.Value.unwrap(_.Value.decode(S,S.uint32()));break;case 5:k.enabled=S.bool();break;case 6:k.address=a.DestinationAddress.decode(S,S.uint32());break;case 7:k.timeout=S.uint32();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",destinationId:Q(u.destinationId)?String(u.destinationId):"",metadata:Q(u==null?void 0:u.metadata)?u.metadata:void 0,enabled:Q(u.enabled)?Boolean(u.enabled):void 0,address:Q(u.address)?a.DestinationAddress.fromJSON(u.address):void 0,timeout:Q(u.timeout)?Number(u.timeout):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.destinationId!==void 0&&(m.destinationId=u.destinationId),u.metadata!==void 0&&(m.metadata=u.metadata),u.enabled!==void 0&&(m.enabled=u.enabled),u.address!==void 0&&(m.address=u.address?a.DestinationAddress.toJSON(u.address):void 0),u.timeout!==void 0&&(m.timeout=Math.round(u.timeout)),m},fromPartial(u){var m,S,B,k,H,Se;const ke=Pt();return ke.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",ke.projectId=(S=u.projectId)!==null&&S!==void 0?S:"",ke.destinationId=(B=u.destinationId)!==null&&B!==void 0?B:"",ke.metadata=(k=u.metadata)!==null&&k!==void 0?k:void 0,ke.enabled=(H=u.enabled)!==null&&H!==void 0?H:void 0,ke.address=u.address!==void 0&&u.address!==null?a.DestinationAddress.fromPartial(u.address):void 0,ke.timeout=(Se=u.timeout)!==null&&Se!==void 0?Se:void 0,ke}};function Nt(){return{collectionId:"",projectId:"",metadata:void 0,rendering:void 0,encoding:void 0,sources:[],destinations:[],composition:void 0,maxDuration:void 0,webrtc:void 0,triggers:[],location:void 0,guestCodes:[]}}a.Project={encode(u,m=p.Writer.create()){u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.metadata!==void 0&&_.Value.encode(_.Value.wrap(u.metadata),m.uint32(26).fork()).ldelim(),u.rendering!==void 0&&a.Rendering.encode(u.rendering,m.uint32(34).fork()).ldelim(),u.encoding!==void 0&&a.Encoding.encode(u.encoding,m.uint32(42).fork()).ldelim();for(const S of u.sources)a.Source.encode(S,m.uint32(50).fork()).ldelim();for(const S of u.destinations)a.Destination.encode(S,m.uint32(58).fork()).ldelim();u.composition!==void 0&&a.Composition.encode(u.composition,m.uint32(66).fork()).ldelim(),u.maxDuration!==void 0&&m.uint32(72).uint32(u.maxDuration),u.webrtc!==void 0&&a.WebRtc.encode(u.webrtc,m.uint32(82).fork()).ldelim();for(const S of u.triggers)a.ProjectTrigger.encode(S,m.uint32(90).fork()).ldelim();u.location!==void 0&&a.LatLong.encode(u.location,m.uint32(98).fork()).ldelim();for(const S of u.guestCodes)a.GuestCode.encode(S,m.uint32(106).fork()).ldelim();return m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Nt();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.projectId=S.string();break;case 3:k.metadata=_.Value.unwrap(_.Value.decode(S,S.uint32()));break;case 4:k.rendering=a.Rendering.decode(S,S.uint32());break;case 5:k.encoding=a.Encoding.decode(S,S.uint32());break;case 6:k.sources.push(a.Source.decode(S,S.uint32()));break;case 7:k.destinations.push(a.Destination.decode(S,S.uint32()));break;case 8:k.composition=a.Composition.decode(S,S.uint32());break;case 9:k.maxDuration=S.uint32();break;case 10:k.webrtc=a.WebRtc.decode(S,S.uint32());break;case 11:k.triggers.push(a.ProjectTrigger.decode(S,S.uint32()));break;case 12:k.location=a.LatLong.decode(S,S.uint32());break;case 13:k.guestCodes.push(a.GuestCode.decode(S,S.uint32()));break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",metadata:Q(u==null?void 0:u.metadata)?u.metadata:void 0,rendering:Q(u.rendering)?a.Rendering.fromJSON(u.rendering):void 0,encoding:Q(u.encoding)?a.Encoding.fromJSON(u.encoding):void 0,sources:Array.isArray(u==null?void 0:u.sources)?u.sources.map(m=>a.Source.fromJSON(m)):[],destinations:Array.isArray(u==null?void 0:u.destinations)?u.destinations.map(m=>a.Destination.fromJSON(m)):[],composition:Q(u.composition)?a.Composition.fromJSON(u.composition):void 0,maxDuration:Q(u.maxDuration)?Number(u.maxDuration):void 0,webrtc:Q(u.webrtc)?a.WebRtc.fromJSON(u.webrtc):void 0,triggers:Array.isArray(u==null?void 0:u.triggers)?u.triggers.map(m=>a.ProjectTrigger.fromJSON(m)):[],location:Q(u.location)?a.LatLong.fromJSON(u.location):void 0,guestCodes:Array.isArray(u==null?void 0:u.guestCodes)?u.guestCodes.map(m=>a.GuestCode.fromJSON(m)):[]}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.metadata!==void 0&&(m.metadata=u.metadata),u.rendering!==void 0&&(m.rendering=u.rendering?a.Rendering.toJSON(u.rendering):void 0),u.encoding!==void 0&&(m.encoding=u.encoding?a.Encoding.toJSON(u.encoding):void 0),u.sources?m.sources=u.sources.map(S=>S?a.Source.toJSON(S):void 0):m.sources=[],u.destinations?m.destinations=u.destinations.map(S=>S?a.Destination.toJSON(S):void 0):m.destinations=[],u.composition!==void 0&&(m.composition=u.composition?a.Composition.toJSON(u.composition):void 0),u.maxDuration!==void 0&&(m.maxDuration=Math.round(u.maxDuration)),u.webrtc!==void 0&&(m.webrtc=u.webrtc?a.WebRtc.toJSON(u.webrtc):void 0),u.triggers?m.triggers=u.triggers.map(S=>S?a.ProjectTrigger.toJSON(S):void 0):m.triggers=[],u.location!==void 0&&(m.location=u.location?a.LatLong.toJSON(u.location):void 0),u.guestCodes?m.guestCodes=u.guestCodes.map(S=>S?a.GuestCode.toJSON(S):void 0):m.guestCodes=[],m},fromPartial(u){var m,S,B,k,H,Se,ke,Ge;const Fe=Nt();return Fe.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",Fe.projectId=(S=u.projectId)!==null&&S!==void 0?S:"",Fe.metadata=(B=u.metadata)!==null&&B!==void 0?B:void 0,Fe.rendering=u.rendering!==void 0&&u.rendering!==null?a.Rendering.fromPartial(u.rendering):void 0,Fe.encoding=u.encoding!==void 0&&u.encoding!==null?a.Encoding.fromPartial(u.encoding):void 0,Fe.sources=((k=u.sources)===null||k===void 0?void 0:k.map(Ce=>a.Source.fromPartial(Ce)))||[],Fe.destinations=((H=u.destinations)===null||H===void 0?void 0:H.map(Ce=>a.Destination.fromPartial(Ce)))||[],Fe.composition=u.composition!==void 0&&u.composition!==null?a.Composition.fromPartial(u.composition):void 0,Fe.maxDuration=(Se=u.maxDuration)!==null&&Se!==void 0?Se:void 0,Fe.webrtc=u.webrtc!==void 0&&u.webrtc!==null?a.WebRtc.fromPartial(u.webrtc):void 0,Fe.triggers=((ke=u.triggers)===null||ke===void 0?void 0:ke.map(Ce=>a.ProjectTrigger.fromPartial(Ce)))||[],Fe.location=u.location!==void 0&&u.location!==null?a.LatLong.fromPartial(u.location):void 0,Fe.guestCodes=((Ge=u.guestCodes)===null||Ge===void 0?void 0:Ge.map(Ce=>a.GuestCode.fromPartial(Ce)))||[],Fe}};function At(){return{collectionId:"",metadata:void 0,projects:[],sources:[]}}a.Collection={encode(u,m=p.Writer.create()){u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.metadata!==void 0&&_.Value.encode(_.Value.wrap(u.metadata),m.uint32(18).fork()).ldelim();for(const S of u.projects)a.Project.encode(S,m.uint32(26).fork()).ldelim();for(const S of u.sources)a.Source.encode(S,m.uint32(34).fork()).ldelim();return m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=At();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.metadata=_.Value.unwrap(_.Value.decode(S,S.uint32()));break;case 3:k.projects.push(a.Project.decode(S,S.uint32()));break;case 4:k.sources.push(a.Source.decode(S,S.uint32()));break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",metadata:Q(u==null?void 0:u.metadata)?u.metadata:void 0,projects:Array.isArray(u==null?void 0:u.projects)?u.projects.map(m=>a.Project.fromJSON(m)):[],sources:Array.isArray(u==null?void 0:u.sources)?u.sources.map(m=>a.Source.fromJSON(m)):[]}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.metadata!==void 0&&(m.metadata=u.metadata),u.projects?m.projects=u.projects.map(S=>S?a.Project.toJSON(S):void 0):m.projects=[],u.sources?m.sources=u.sources.map(S=>S?a.Source.toJSON(S):void 0):m.sources=[],m},fromPartial(u){var m,S,B,k;const H=At();return H.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",H.metadata=(S=u.metadata)!==null&&S!==void 0?S:void 0,H.projects=((B=u.projects)===null||B===void 0?void 0:B.map(Se=>a.Project.fromPartial(Se)))||[],H.sources=((k=u.sources)===null||k===void 0?void 0:k.map(Se=>a.Source.fromPartial(Se)))||[],H}};function wt(){return{metadata:void 0}}a.CreateCollectionRequest={encode(u,m=p.Writer.create()){return u.metadata!==void 0&&_.Value.encode(_.Value.wrap(u.metadata),m.uint32(10).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=wt();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.metadata=_.Value.unwrap(_.Value.decode(S,S.uint32()));break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{metadata:Q(u==null?void 0:u.metadata)?u.metadata:void 0}},toJSON(u){const m={};return u.metadata!==void 0&&(m.metadata=u.metadata),m},fromPartial(u){var m;const S=wt();return S.metadata=(m=u.metadata)!==null&&m!==void 0?m:void 0,S}};function Dt(){return{collection:void 0}}a.CreateCollectionResponse={encode(u,m=p.Writer.create()){return u.collection!==void 0&&a.Collection.encode(u.collection,m.uint32(10).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Dt();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collection=a.Collection.decode(S,S.uint32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collection:Q(u.collection)?a.Collection.fromJSON(u.collection):void 0}},toJSON(u){const m={};return u.collection!==void 0&&(m.collection=u.collection?a.Collection.toJSON(u.collection):void 0),m},fromPartial(u){const m=Dt();return m.collection=u.collection!==void 0&&u.collection!==null?a.Collection.fromPartial(u.collection):void 0,m}};function Lt(){return{collectionId:"",populateProjects:void 0,populateSources:void 0}}a.GetCollectionRequest={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.populateProjects!==void 0&&m.uint32(16).bool(u.populateProjects),u.populateSources!==void 0&&m.uint32(24).bool(u.populateSources),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Lt();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.populateProjects=S.bool();break;case 3:k.populateSources=S.bool();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",populateProjects:Q(u.populateProjects)?Boolean(u.populateProjects):void 0,populateSources:Q(u.populateSources)?Boolean(u.populateSources):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.populateProjects!==void 0&&(m.populateProjects=u.populateProjects),u.populateSources!==void 0&&(m.populateSources=u.populateSources),m},fromPartial(u){var m,S,B;const k=Lt();return k.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",k.populateProjects=(S=u.populateProjects)!==null&&S!==void 0?S:void 0,k.populateSources=(B=u.populateSources)!==null&&B!==void 0?B:void 0,k}};function $t(){return{collection:void 0}}a.GetCollectionResponse={encode(u,m=p.Writer.create()){return u.collection!==void 0&&a.Collection.encode(u.collection,m.uint32(10).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=$t();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collection=a.Collection.decode(S,S.uint32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collection:Q(u.collection)?a.Collection.fromJSON(u.collection):void 0}},toJSON(u){const m={};return u.collection!==void 0&&(m.collection=u.collection?a.Collection.toJSON(u.collection):void 0),m},fromPartial(u){const m=$t();return m.collection=u.collection!==void 0&&u.collection!==null?a.Collection.fromPartial(u.collection):void 0,m}};function Mt(){return{collectionId:"",updateMask:void 0,metadata:void 0}}a.UpdateCollectionRequest={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.updateMask!==void 0&&E.FieldMask.encode(E.FieldMask.wrap(u.updateMask),m.uint32(18).fork()).ldelim(),u.metadata!==void 0&&_.Value.encode(_.Value.wrap(u.metadata),m.uint32(26).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Mt();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.updateMask=E.FieldMask.unwrap(E.FieldMask.decode(S,S.uint32()));break;case 3:k.metadata=_.Value.unwrap(_.Value.decode(S,S.uint32()));break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",updateMask:Q(u.updateMask)?E.FieldMask.unwrap(E.FieldMask.fromJSON(u.updateMask)):void 0,metadata:Q(u==null?void 0:u.metadata)?u.metadata:void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.updateMask!==void 0&&(m.updateMask=E.FieldMask.toJSON(E.FieldMask.wrap(u.updateMask))),u.metadata!==void 0&&(m.metadata=u.metadata),m},fromPartial(u){var m,S,B;const k=Mt();return k.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",k.updateMask=(S=u.updateMask)!==null&&S!==void 0?S:void 0,k.metadata=(B=u.metadata)!==null&&B!==void 0?B:void 0,k}};function Ut(){return{collection:void 0}}a.UpdateCollectionResponse={encode(u,m=p.Writer.create()){return u.collection!==void 0&&a.Collection.encode(u.collection,m.uint32(10).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Ut();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collection=a.Collection.decode(S,S.uint32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collection:Q(u.collection)?a.Collection.fromJSON(u.collection):void 0}},toJSON(u){const m={};return u.collection!==void 0&&(m.collection=u.collection?a.Collection.toJSON(u.collection):void 0),m},fromPartial(u){const m=Ut();return m.collection=u.collection!==void 0&&u.collection!==null?a.Collection.fromPartial(u.collection):void 0,m}};function Vt(){return{collectionId:"",force:void 0}}a.DeleteCollectionRequest={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.force!==void 0&&m.uint32(16).bool(u.force),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Vt();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.force=S.bool();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",force:Q(u.force)?Boolean(u.force):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.force!==void 0&&(m.force=u.force),m},fromPartial(u){var m,S;const B=Vt();return B.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",B.force=(S=u.force)!==null&&S!==void 0?S:void 0,B}};function Bt(){return{sourcesDeleted:0,projectsDeleted:0,projectIdsStopped:[]}}a.DeleteCollectionResponse={encode(u,m=p.Writer.create()){u.sourcesDeleted!==0&&m.uint32(8).uint32(u.sourcesDeleted),u.projectsDeleted!==0&&m.uint32(16).uint32(u.projectsDeleted);for(const S of u.projectIdsStopped)m.uint32(26).string(S);return m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Bt();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.sourcesDeleted=S.uint32();break;case 2:k.projectsDeleted=S.uint32();break;case 3:k.projectIdsStopped.push(S.string());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{sourcesDeleted:Q(u.sourcesDeleted)?Number(u.sourcesDeleted):0,projectsDeleted:Q(u.projectsDeleted)?Number(u.projectsDeleted):0,projectIdsStopped:Array.isArray(u==null?void 0:u.projectIdsStopped)?u.projectIdsStopped.map(m=>String(m)):[]}},toJSON(u){const m={};return u.sourcesDeleted!==void 0&&(m.sourcesDeleted=Math.round(u.sourcesDeleted)),u.projectsDeleted!==void 0&&(m.projectsDeleted=Math.round(u.projectsDeleted)),u.projectIdsStopped?m.projectIdsStopped=u.projectIdsStopped.map(S=>S):m.projectIdsStopped=[],m},fromPartial(u){var m,S,B;const k=Bt();return k.sourcesDeleted=(m=u.sourcesDeleted)!==null&&m!==void 0?m:0,k.projectsDeleted=(S=u.projectsDeleted)!==null&&S!==void 0?S:0,k.projectIdsStopped=((B=u.projectIdsStopped)===null||B===void 0?void 0:B.map(H=>H))||[],k}};function Jt(){return{}}a.GetCollectionsRequest={encode(u,m=p.Writer.create()){return m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Jt();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){default:S.skipType(H&7);break}}return k},fromJSON(u){return{}},toJSON(u){return{}},fromPartial(u){return Jt()}};function Ft(){return{collections:[]}}a.GetCollectionsResponse={encode(u,m=p.Writer.create()){for(const S of u.collections)a.Collection.encode(S,m.uint32(10).fork()).ldelim();return m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Ft();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collections.push(a.Collection.decode(S,S.uint32()));break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collections:Array.isArray(u==null?void 0:u.collections)?u.collections.map(m=>a.Collection.fromJSON(m)):[]}},toJSON(u){const m={};return u.collections?m.collections=u.collections.map(S=>S?a.Collection.toJSON(S):void 0):m.collections=[],m},fromPartial(u){var m;const S=Ft();return S.collections=((m=u.collections)===null||m===void 0?void 0:m.map(B=>a.Collection.fromPartial(B)))||[],S}};function Gt(){return{collectionId:"",metadata:void 0,rendering:void 0,encoding:void 0,composition:void 0,maxDuration:void 0,webrtc:void 0,location:void 0}}a.CreateProjectRequest={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.metadata!==void 0&&_.Value.encode(_.Value.wrap(u.metadata),m.uint32(18).fork()).ldelim(),u.rendering!==void 0&&a.Rendering.encode(u.rendering,m.uint32(26).fork()).ldelim(),u.encoding!==void 0&&a.Encoding.encode(u.encoding,m.uint32(34).fork()).ldelim(),u.composition!==void 0&&a.Composition.encode(u.composition,m.uint32(42).fork()).ldelim(),u.maxDuration!==void 0&&m.uint32(48).uint32(u.maxDuration),u.webrtc!==void 0&&a.WebRtc.encode(u.webrtc,m.uint32(58).fork()).ldelim(),u.location!==void 0&&a.LatLong.encode(u.location,m.uint32(74).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Gt();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.metadata=_.Value.unwrap(_.Value.decode(S,S.uint32()));break;case 3:k.rendering=a.Rendering.decode(S,S.uint32());break;case 4:k.encoding=a.Encoding.decode(S,S.uint32());break;case 5:k.composition=a.Composition.decode(S,S.uint32());break;case 6:k.maxDuration=S.uint32();break;case 7:k.webrtc=a.WebRtc.decode(S,S.uint32());break;case 9:k.location=a.LatLong.decode(S,S.uint32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",metadata:Q(u==null?void 0:u.metadata)?u.metadata:void 0,rendering:Q(u.rendering)?a.Rendering.fromJSON(u.rendering):void 0,encoding:Q(u.encoding)?a.Encoding.fromJSON(u.encoding):void 0,composition:Q(u.composition)?a.Composition.fromJSON(u.composition):void 0,maxDuration:Q(u.maxDuration)?Number(u.maxDuration):void 0,webrtc:Q(u.webrtc)?a.WebRtc.fromJSON(u.webrtc):void 0,location:Q(u.location)?a.LatLong.fromJSON(u.location):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.metadata!==void 0&&(m.metadata=u.metadata),u.rendering!==void 0&&(m.rendering=u.rendering?a.Rendering.toJSON(u.rendering):void 0),u.encoding!==void 0&&(m.encoding=u.encoding?a.Encoding.toJSON(u.encoding):void 0),u.composition!==void 0&&(m.composition=u.composition?a.Composition.toJSON(u.composition):void 0),u.maxDuration!==void 0&&(m.maxDuration=Math.round(u.maxDuration)),u.webrtc!==void 0&&(m.webrtc=u.webrtc?a.WebRtc.toJSON(u.webrtc):void 0),u.location!==void 0&&(m.location=u.location?a.LatLong.toJSON(u.location):void 0),m},fromPartial(u){var m,S,B;const k=Gt();return k.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",k.metadata=(S=u.metadata)!==null&&S!==void 0?S:void 0,k.rendering=u.rendering!==void 0&&u.rendering!==null?a.Rendering.fromPartial(u.rendering):void 0,k.encoding=u.encoding!==void 0&&u.encoding!==null?a.Encoding.fromPartial(u.encoding):void 0,k.composition=u.composition!==void 0&&u.composition!==null?a.Composition.fromPartial(u.composition):void 0,k.maxDuration=(B=u.maxDuration)!==null&&B!==void 0?B:void 0,k.webrtc=u.webrtc!==void 0&&u.webrtc!==null?a.WebRtc.fromPartial(u.webrtc):void 0,k.location=u.location!==void 0&&u.location!==null?a.LatLong.fromPartial(u.location):void 0,k}};function qt(){return{project:void 0}}a.CreateProjectResponse={encode(u,m=p.Writer.create()){return u.project!==void 0&&a.Project.encode(u.project,m.uint32(10).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=qt();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.project=a.Project.decode(S,S.uint32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{project:Q(u.project)?a.Project.fromJSON(u.project):void 0}},toJSON(u){const m={};return u.project!==void 0&&(m.project=u.project?a.Project.toJSON(u.project):void 0),m},fromPartial(u){const m=qt();return m.project=u.project!==void 0&&u.project!==null?a.Project.fromPartial(u.project):void 0,m}};function Wt(){return{collectionId:"",projectId:"",updateMask:void 0,metadata:void 0,rendering:void 0,encoding:void 0,composition:void 0,maxDuration:void 0,webrtc:void 0,location:void 0}}a.UpdateProjectRequest={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.updateMask!==void 0&&E.FieldMask.encode(E.FieldMask.wrap(u.updateMask),m.uint32(26).fork()).ldelim(),u.metadata!==void 0&&_.Value.encode(_.Value.wrap(u.metadata),m.uint32(34).fork()).ldelim(),u.rendering!==void 0&&a.Rendering.encode(u.rendering,m.uint32(42).fork()).ldelim(),u.encoding!==void 0&&a.Encoding.encode(u.encoding,m.uint32(50).fork()).ldelim(),u.composition!==void 0&&a.Composition.encode(u.composition,m.uint32(58).fork()).ldelim(),u.maxDuration!==void 0&&m.uint32(64).uint32(u.maxDuration),u.webrtc!==void 0&&a.WebRtc.encode(u.webrtc,m.uint32(74).fork()).ldelim(),u.location!==void 0&&a.LatLong.encode(u.location,m.uint32(82).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Wt();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.projectId=S.string();break;case 3:k.updateMask=E.FieldMask.unwrap(E.FieldMask.decode(S,S.uint32()));break;case 4:k.metadata=_.Value.unwrap(_.Value.decode(S,S.uint32()));break;case 5:k.rendering=a.Rendering.decode(S,S.uint32());break;case 6:k.encoding=a.Encoding.decode(S,S.uint32());break;case 7:k.composition=a.Composition.decode(S,S.uint32());break;case 8:k.maxDuration=S.uint32();break;case 9:k.webrtc=a.WebRtc.decode(S,S.uint32());break;case 10:k.location=a.LatLong.decode(S,S.uint32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",updateMask:Q(u.updateMask)?E.FieldMask.unwrap(E.FieldMask.fromJSON(u.updateMask)):void 0,metadata:Q(u==null?void 0:u.metadata)?u.metadata:void 0,rendering:Q(u.rendering)?a.Rendering.fromJSON(u.rendering):void 0,encoding:Q(u.encoding)?a.Encoding.fromJSON(u.encoding):void 0,composition:Q(u.composition)?a.Composition.fromJSON(u.composition):void 0,maxDuration:Q(u.maxDuration)?Number(u.maxDuration):void 0,webrtc:Q(u.webrtc)?a.WebRtc.fromJSON(u.webrtc):void 0,location:Q(u.location)?a.LatLong.fromJSON(u.location):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.updateMask!==void 0&&(m.updateMask=E.FieldMask.toJSON(E.FieldMask.wrap(u.updateMask))),u.metadata!==void 0&&(m.metadata=u.metadata),u.rendering!==void 0&&(m.rendering=u.rendering?a.Rendering.toJSON(u.rendering):void 0),u.encoding!==void 0&&(m.encoding=u.encoding?a.Encoding.toJSON(u.encoding):void 0),u.composition!==void 0&&(m.composition=u.composition?a.Composition.toJSON(u.composition):void 0),u.maxDuration!==void 0&&(m.maxDuration=Math.round(u.maxDuration)),u.webrtc!==void 0&&(m.webrtc=u.webrtc?a.WebRtc.toJSON(u.webrtc):void 0),u.location!==void 0&&(m.location=u.location?a.LatLong.toJSON(u.location):void 0),m},fromPartial(u){var m,S,B,k,H;const Se=Wt();return Se.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",Se.projectId=(S=u.projectId)!==null&&S!==void 0?S:"",Se.updateMask=(B=u.updateMask)!==null&&B!==void 0?B:void 0,Se.metadata=(k=u.metadata)!==null&&k!==void 0?k:void 0,Se.rendering=u.rendering!==void 0&&u.rendering!==null?a.Rendering.fromPartial(u.rendering):void 0,Se.encoding=u.encoding!==void 0&&u.encoding!==null?a.Encoding.fromPartial(u.encoding):void 0,Se.composition=u.composition!==void 0&&u.composition!==null?a.Composition.fromPartial(u.composition):void 0,Se.maxDuration=(H=u.maxDuration)!==null&&H!==void 0?H:void 0,Se.webrtc=u.webrtc!==void 0&&u.webrtc!==null?a.WebRtc.fromPartial(u.webrtc):void 0,Se.location=u.location!==void 0&&u.location!==null?a.LatLong.fromPartial(u.location):void 0,Se}};function Ht(){return{project:void 0,broadcastUpdated:!1}}a.UpdateProjectResponse={encode(u,m=p.Writer.create()){return u.project!==void 0&&a.Project.encode(u.project,m.uint32(10).fork()).ldelim(),u.broadcastUpdated===!0&&m.uint32(16).bool(u.broadcastUpdated),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Ht();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.project=a.Project.decode(S,S.uint32());break;case 2:k.broadcastUpdated=S.bool();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{project:Q(u.project)?a.Project.fromJSON(u.project):void 0,broadcastUpdated:Q(u.broadcastUpdated)?Boolean(u.broadcastUpdated):!1}},toJSON(u){const m={};return u.project!==void 0&&(m.project=u.project?a.Project.toJSON(u.project):void 0),u.broadcastUpdated!==void 0&&(m.broadcastUpdated=u.broadcastUpdated),m},fromPartial(u){var m;const S=Ht();return S.project=u.project!==void 0&&u.project!==null?a.Project.fromPartial(u.project):void 0,S.broadcastUpdated=(m=u.broadcastUpdated)!==null&&m!==void 0?m:!1,S}};function jt(){return{collectionId:"",projectId:"",force:void 0}}a.DeleteProjectRequest={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.force!==void 0&&m.uint32(24).bool(u.force),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=jt();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.projectId=S.string();break;case 3:k.force=S.bool();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",force:Q(u.force)?Boolean(u.force):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.force!==void 0&&(m.force=u.force),m},fromPartial(u){var m,S,B;const k=jt();return k.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",k.projectId=(S=u.projectId)!==null&&S!==void 0?S:"",k.force=(B=u.force)!==null&&B!==void 0?B:void 0,k}};function Yt(){return{broadcastStopped:!1,layoutsDeleted:0}}a.DeleteProjectResponse={encode(u,m=p.Writer.create()){return u.broadcastStopped===!0&&m.uint32(8).bool(u.broadcastStopped),u.layoutsDeleted!==0&&m.uint32(16).uint32(u.layoutsDeleted),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Yt();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.broadcastStopped=S.bool();break;case 2:k.layoutsDeleted=S.uint32();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{broadcastStopped:Q(u.broadcastStopped)?Boolean(u.broadcastStopped):!1,layoutsDeleted:Q(u.layoutsDeleted)?Number(u.layoutsDeleted):0}},toJSON(u){const m={};return u.broadcastStopped!==void 0&&(m.broadcastStopped=u.broadcastStopped),u.layoutsDeleted!==void 0&&(m.layoutsDeleted=Math.round(u.layoutsDeleted)),m},fromPartial(u){var m,S;const B=Yt();return B.broadcastStopped=(m=u.broadcastStopped)!==null&&m!==void 0?m:!1,B.layoutsDeleted=(S=u.layoutsDeleted)!==null&&S!==void 0?S:0,B}};function zt(){return{collectionId:"",projectId:"",webrtcStart:void 0}}a.StartProjectBroadcastRequest={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.webrtcStart!==void 0&&m.uint32(24).bool(u.webrtcStart),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=zt();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.projectId=S.string();break;case 3:k.webrtcStart=S.bool();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",webrtcStart:Q(u.webrtcStart)?Boolean(u.webrtcStart):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.webrtcStart!==void 0&&(m.webrtcStart=u.webrtcStart),m},fromPartial(u){var m,S,B;const k=zt();return k.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",k.projectId=(S=u.projectId)!==null&&S!==void 0?S:"",k.webrtcStart=(B=u.webrtcStart)!==null&&B!==void 0?B:void 0,k}};function xt(){return{broadcastId:""}}a.StartProjectBroadcastResponse={encode(u,m=p.Writer.create()){return u.broadcastId!==""&&m.uint32(10).string(u.broadcastId),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=xt();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.broadcastId=S.string();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{broadcastId:Q(u.broadcastId)?String(u.broadcastId):""}},toJSON(u){const m={};return u.broadcastId!==void 0&&(m.broadcastId=u.broadcastId),m},fromPartial(u){var m;const S=xt();return S.broadcastId=(m=u.broadcastId)!==null&&m!==void 0?m:"",S}};function Kt(){return{collectionId:"",projectId:"",webrtcStop:void 0}}a.StopProjectBroadcastRequest={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.webrtcStop!==void 0&&m.uint32(24).bool(u.webrtcStop),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Kt();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.projectId=S.string();break;case 3:k.webrtcStop=S.bool();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",webrtcStop:Q(u.webrtcStop)?Boolean(u.webrtcStop):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.webrtcStop!==void 0&&(m.webrtcStop=u.webrtcStop),m},fromPartial(u){var m,S,B;const k=Kt();return k.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",k.projectId=(S=u.projectId)!==null&&S!==void 0?S:"",k.webrtcStop=(B=u.webrtcStop)!==null&&B!==void 0?B:void 0,k}};function Qt(){return{}}a.StopProjectBroadcastResponse={encode(u,m=p.Writer.create()){return m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Qt();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){default:S.skipType(H&7);break}}return k},fromJSON(u){return{}},toJSON(u){return{}},fromPartial(u){return Qt()}};function Xt(){return{collectionId:"",projectId:"",status:void 0}}a.GetProjectRequest={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.status!==void 0&&m.uint32(24).bool(u.status),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Xt();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.projectId=S.string();break;case 3:k.status=S.bool();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",status:Q(u.status)?Boolean(u.status):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.status!==void 0&&(m.status=u.status),m},fromPartial(u){var m,S,B;const k=Xt();return k.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",k.projectId=(S=u.projectId)!==null&&S!==void 0?S:"",k.status=(B=u.status)!==null&&B!==void 0?B:void 0,k}};function Zt(){return{project:void 0,status:void 0}}a.GetProjectResponse={encode(u,m=p.Writer.create()){return u.project!==void 0&&a.Project.encode(u.project,m.uint32(10).fork()).ldelim(),u.status!==void 0&&a.ProjectBroadcastStatus.encode(u.status,m.uint32(18).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Zt();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.project=a.Project.decode(S,S.uint32());break;case 2:k.status=a.ProjectBroadcastStatus.decode(S,S.uint32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{project:Q(u.project)?a.Project.fromJSON(u.project):void 0,status:Q(u.status)?a.ProjectBroadcastStatus.fromJSON(u.status):void 0}},toJSON(u){const m={};return u.project!==void 0&&(m.project=u.project?a.Project.toJSON(u.project):void 0),u.status!==void 0&&(m.status=u.status?a.ProjectBroadcastStatus.toJSON(u.status):void 0),m},fromPartial(u){const m=Zt();return m.project=u.project!==void 0&&u.project!==null?a.Project.fromPartial(u.project):void 0,m.status=u.status!==void 0&&u.status!==null?a.ProjectBroadcastStatus.fromPartial(u.status):void 0,m}};function en(){return{collectionId:"",projectId:"",format:void 0}}a.GetProjectBroadcastSnapshotRequest={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.format!==void 0&&m.uint32(24).int32(A(u.format)),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=en();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.projectId=S.string();break;case 3:k.format=P(S.int32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",format:Q(u.format)?P(u.format):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.format!==void 0&&(m.format=u.format!==void 0?C(u.format):void 0),m},fromPartial(u){var m,S,B;const k=en();return k.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",k.projectId=(S=u.projectId)!==null&&S!==void 0?S:"",k.format=(B=u.format)!==null&&B!==void 0?B:void 0,k}};function tn(){return{format:O.IMAGE_FORMAT_UNSPECIFIED,image:new Uint8Array}}a.GetProjectBroadcastSnapshotResponse={encode(u,m=p.Writer.create()){return u.format!==O.IMAGE_FORMAT_UNSPECIFIED&&m.uint32(8).int32(A(u.format)),u.image.length!==0&&m.uint32(18).bytes(u.image),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=tn();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.format=P(S.int32());break;case 2:k.image=S.bytes();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{format:Q(u.format)?P(u.format):O.IMAGE_FORMAT_UNSPECIFIED,image:Q(u.image)?Pr(u.image):new Uint8Array}},toJSON(u){const m={};return u.format!==void 0&&(m.format=C(u.format)),u.image!==void 0&&(m.image=Ar(u.image!==void 0?u.image:new Uint8Array)),m},fromPartial(u){var m,S;const B=tn();return B.format=(m=u.format)!==null&&m!==void 0?m:O.IMAGE_FORMAT_UNSPECIFIED,B.image=(S=u.image)!==null&&S!==void 0?S:new Uint8Array,B}};function nn(){return{collectionId:"",projectId:""}}a.GetProjectBroadcastStatusRequest={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=nn();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.projectId=S.string();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):""}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),m},fromPartial(u){var m,S;const B=nn();return B.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",B.projectId=(S=u.projectId)!==null&&S!==void 0?S:"",B}};function rn(){return{status:void 0}}a.GetProjectBroadcastStatusResponse={encode(u,m=p.Writer.create()){return u.status!==void 0&&a.ProjectBroadcastStatus.encode(u.status,m.uint32(10).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=rn();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.status=a.ProjectBroadcastStatus.decode(S,S.uint32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{status:Q(u.status)?a.ProjectBroadcastStatus.fromJSON(u.status):void 0}},toJSON(u){const m={};return u.status!==void 0&&(m.status=u.status?a.ProjectBroadcastStatus.toJSON(u.status):void 0),m},fromPartial(u){const m=rn();return m.status=u.status!==void 0&&u.status!==null?a.ProjectBroadcastStatus.fromPartial(u.status):void 0,m}};function an(){return{collectionId:"",projectId:""}}a.StartProjectWebRtcRequest={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=an();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.projectId=S.string();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):""}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),m},fromPartial(u){var m,S;const B=an();return B.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",B.projectId=(S=u.projectId)!==null&&S!==void 0?S:"",B}};function sn(){return{}}a.StartProjectWebRtcResponse={encode(u,m=p.Writer.create()){return m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=sn();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){default:S.skipType(H&7);break}}return k},fromJSON(u){return{}},toJSON(u){return{}},fromPartial(u){return sn()}};function dn(){return{collectionId:"",projectId:""}}a.StopProjectWebRtcRequest={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=dn();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.projectId=S.string();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):""}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),m},fromPartial(u){var m,S;const B=dn();return B.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",B.projectId=(S=u.projectId)!==null&&S!==void 0?S:"",B}};function un(){return{}}a.StopProjectWebRtcResponse={encode(u,m=p.Writer.create()){return m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=un();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){default:S.skipType(H&7);break}}return k},fromJSON(u){return{}},toJSON(u){return{}},fromPartial(u){return un()}};function cn(){return{collectionId:"",projectId:"",metadata:void 0,address:void 0,enabled:void 0,timeout:void 0}}a.CreateDestinationRequest={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.metadata!==void 0&&_.Value.encode(_.Value.wrap(u.metadata),m.uint32(26).fork()).ldelim(),u.address!==void 0&&a.DestinationAddress.encode(u.address,m.uint32(42).fork()).ldelim(),u.enabled!==void 0&&m.uint32(48).bool(u.enabled),u.timeout!==void 0&&m.uint32(56).uint32(u.timeout),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=cn();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.projectId=S.string();break;case 3:k.metadata=_.Value.unwrap(_.Value.decode(S,S.uint32()));break;case 5:k.address=a.DestinationAddress.decode(S,S.uint32());break;case 6:k.enabled=S.bool();break;case 7:k.timeout=S.uint32();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",metadata:Q(u==null?void 0:u.metadata)?u.metadata:void 0,address:Q(u.address)?a.DestinationAddress.fromJSON(u.address):void 0,enabled:Q(u.enabled)?Boolean(u.enabled):void 0,timeout:Q(u.timeout)?Number(u.timeout):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.metadata!==void 0&&(m.metadata=u.metadata),u.address!==void 0&&(m.address=u.address?a.DestinationAddress.toJSON(u.address):void 0),u.enabled!==void 0&&(m.enabled=u.enabled),u.timeout!==void 0&&(m.timeout=Math.round(u.timeout)),m},fromPartial(u){var m,S,B,k,H;const Se=cn();return Se.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",Se.projectId=(S=u.projectId)!==null&&S!==void 0?S:"",Se.metadata=(B=u.metadata)!==null&&B!==void 0?B:void 0,Se.address=u.address!==void 0&&u.address!==null?a.DestinationAddress.fromPartial(u.address):void 0,Se.enabled=(k=u.enabled)!==null&&k!==void 0?k:void 0,Se.timeout=(H=u.timeout)!==null&&H!==void 0?H:void 0,Se}};function ln(){return{destination:void 0}}a.CreateDestinationResponse={encode(u,m=p.Writer.create()){return u.destination!==void 0&&a.Destination.encode(u.destination,m.uint32(10).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=ln();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.destination=a.Destination.decode(S,S.uint32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{destination:Q(u.destination)?a.Destination.fromJSON(u.destination):void 0}},toJSON(u){const m={};return u.destination!==void 0&&(m.destination=u.destination?a.Destination.toJSON(u.destination):void 0),m},fromPartial(u){const m=ln();return m.destination=u.destination!==void 0&&u.destination!==null?a.Destination.fromPartial(u.destination):void 0,m}};function fn(){return{collectionId:"",projectId:"",destinationId:""}}a.GetDestinationRequest={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.destinationId!==""&&m.uint32(26).string(u.destinationId),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=fn();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.projectId=S.string();break;case 3:k.destinationId=S.string();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",destinationId:Q(u.destinationId)?String(u.destinationId):""}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.destinationId!==void 0&&(m.destinationId=u.destinationId),m},fromPartial(u){var m,S,B;const k=fn();return k.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",k.projectId=(S=u.projectId)!==null&&S!==void 0?S:"",k.destinationId=(B=u.destinationId)!==null&&B!==void 0?B:"",k}};function pn(){return{destination:void 0}}a.GetDestinationResponse={encode(u,m=p.Writer.create()){return u.destination!==void 0&&a.Destination.encode(u.destination,m.uint32(10).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=pn();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.destination=a.Destination.decode(S,S.uint32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{destination:Q(u.destination)?a.Destination.fromJSON(u.destination):void 0}},toJSON(u){const m={};return u.destination!==void 0&&(m.destination=u.destination?a.Destination.toJSON(u.destination):void 0),m},fromPartial(u){const m=pn();return m.destination=u.destination!==void 0&&u.destination!==null?a.Destination.fromPartial(u.destination):void 0,m}};function hn(){return{collectionId:"",projectId:"",destinationId:"",force:void 0}}a.DeleteDestinationRequest={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.destinationId!==""&&m.uint32(26).string(u.destinationId),u.force!==void 0&&m.uint32(32).bool(u.force),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=hn();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.projectId=S.string();break;case 3:k.destinationId=S.string();break;case 4:k.force=S.bool();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",destinationId:Q(u.destinationId)?String(u.destinationId):"",force:Q(u.force)?Boolean(u.force):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.destinationId!==void 0&&(m.destinationId=u.destinationId),u.force!==void 0&&(m.force=u.force),m},fromPartial(u){var m,S,B,k;const H=hn();return H.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",H.projectId=(S=u.projectId)!==null&&S!==void 0?S:"",H.destinationId=(B=u.destinationId)!==null&&B!==void 0?B:"",H.force=(k=u.force)!==null&&k!==void 0?k:void 0,H}};function mn(){return{broadcastUpdated:!1}}a.DeleteDestinationResponse={encode(u,m=p.Writer.create()){return u.broadcastUpdated===!0&&m.uint32(8).bool(u.broadcastUpdated),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=mn();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.broadcastUpdated=S.bool();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{broadcastUpdated:Q(u.broadcastUpdated)?Boolean(u.broadcastUpdated):!1}},toJSON(u){const m={};return u.broadcastUpdated!==void 0&&(m.broadcastUpdated=u.broadcastUpdated),m},fromPartial(u){var m;const S=mn();return S.broadcastUpdated=(m=u.broadcastUpdated)!==null&&m!==void 0?m:!1,S}};function vn(){return{collectionId:"",projectId:"",destinationId:"",updateMask:void 0,metadata:void 0,address:void 0,enabled:void 0,timeout:void 0}}a.UpdateDestinationRequest={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.destinationId!==""&&m.uint32(26).string(u.destinationId),u.updateMask!==void 0&&E.FieldMask.encode(E.FieldMask.wrap(u.updateMask),m.uint32(34).fork()).ldelim(),u.metadata!==void 0&&_.Value.encode(_.Value.wrap(u.metadata),m.uint32(42).fork()).ldelim(),u.address!==void 0&&a.DestinationAddress.encode(u.address,m.uint32(50).fork()).ldelim(),u.enabled!==void 0&&m.uint32(56).bool(u.enabled),u.timeout!==void 0&&m.uint32(64).uint32(u.timeout),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=vn();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.projectId=S.string();break;case 3:k.destinationId=S.string();break;case 4:k.updateMask=E.FieldMask.unwrap(E.FieldMask.decode(S,S.uint32()));break;case 5:k.metadata=_.Value.unwrap(_.Value.decode(S,S.uint32()));break;case 6:k.address=a.DestinationAddress.decode(S,S.uint32());break;case 7:k.enabled=S.bool();break;case 8:k.timeout=S.uint32();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",destinationId:Q(u.destinationId)?String(u.destinationId):"",updateMask:Q(u.updateMask)?E.FieldMask.unwrap(E.FieldMask.fromJSON(u.updateMask)):void 0,metadata:Q(u==null?void 0:u.metadata)?u.metadata:void 0,address:Q(u.address)?a.DestinationAddress.fromJSON(u.address):void 0,enabled:Q(u.enabled)?Boolean(u.enabled):void 0,timeout:Q(u.timeout)?Number(u.timeout):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.destinationId!==void 0&&(m.destinationId=u.destinationId),u.updateMask!==void 0&&(m.updateMask=E.FieldMask.toJSON(E.FieldMask.wrap(u.updateMask))),u.metadata!==void 0&&(m.metadata=u.metadata),u.address!==void 0&&(m.address=u.address?a.DestinationAddress.toJSON(u.address):void 0),u.enabled!==void 0&&(m.enabled=u.enabled),u.timeout!==void 0&&(m.timeout=Math.round(u.timeout)),m},fromPartial(u){var m,S,B,k,H,Se,ke;const Ge=vn();return Ge.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",Ge.projectId=(S=u.projectId)!==null&&S!==void 0?S:"",Ge.destinationId=(B=u.destinationId)!==null&&B!==void 0?B:"",Ge.updateMask=(k=u.updateMask)!==null&&k!==void 0?k:void 0,Ge.metadata=(H=u.metadata)!==null&&H!==void 0?H:void 0,Ge.address=u.address!==void 0&&u.address!==null?a.DestinationAddress.fromPartial(u.address):void 0,Ge.enabled=(Se=u.enabled)!==null&&Se!==void 0?Se:void 0,Ge.timeout=(ke=u.timeout)!==null&&ke!==void 0?ke:void 0,Ge}};function Sn(){return{destination:void 0,broadcastUpdated:!1}}a.UpdateDestinationResponse={encode(u,m=p.Writer.create()){return u.destination!==void 0&&a.Destination.encode(u.destination,m.uint32(10).fork()).ldelim(),u.broadcastUpdated===!0&&m.uint32(16).bool(u.broadcastUpdated),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Sn();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.destination=a.Destination.decode(S,S.uint32());break;case 2:k.broadcastUpdated=S.bool();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{destination:Q(u.destination)?a.Destination.fromJSON(u.destination):void 0,broadcastUpdated:Q(u.broadcastUpdated)?Boolean(u.broadcastUpdated):!1}},toJSON(u){const m={};return u.destination!==void 0&&(m.destination=u.destination?a.Destination.toJSON(u.destination):void 0),u.broadcastUpdated!==void 0&&(m.broadcastUpdated=u.broadcastUpdated),m},fromPartial(u){var m;const S=Sn();return S.destination=u.destination!==void 0&&u.destination!==null?a.Destination.fromPartial(u.destination):void 0,S.broadcastUpdated=(m=u.broadcastUpdated)!==null&&m!==void 0?m:!1,S}};function yn(){return{collectionId:"",metadata:void 0,address:void 0,preview:void 0}}a.CreateSourceRequest={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.metadata!==void 0&&_.Value.encode(_.Value.wrap(u.metadata),m.uint32(18).fork()).ldelim(),u.address!==void 0&&a.SourceAddress.encode(u.address,m.uint32(26).fork()).ldelim(),u.preview!==void 0&&a.PreviewAddress.encode(u.preview,m.uint32(34).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=yn();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.metadata=_.Value.unwrap(_.Value.decode(S,S.uint32()));break;case 3:k.address=a.SourceAddress.decode(S,S.uint32());break;case 4:k.preview=a.PreviewAddress.decode(S,S.uint32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",metadata:Q(u==null?void 0:u.metadata)?u.metadata:void 0,address:Q(u.address)?a.SourceAddress.fromJSON(u.address):void 0,preview:Q(u.preview)?a.PreviewAddress.fromJSON(u.preview):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.metadata!==void 0&&(m.metadata=u.metadata),u.address!==void 0&&(m.address=u.address?a.SourceAddress.toJSON(u.address):void 0),u.preview!==void 0&&(m.preview=u.preview?a.PreviewAddress.toJSON(u.preview):void 0),m},fromPartial(u){var m,S;const B=yn();return B.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",B.metadata=(S=u.metadata)!==null&&S!==void 0?S:void 0,B.address=u.address!==void 0&&u.address!==null?a.SourceAddress.fromPartial(u.address):void 0,B.preview=u.preview!==void 0&&u.preview!==null?a.PreviewAddress.fromPartial(u.preview):void 0,B}};function bn(){return{source:void 0}}a.CreateSourceResponse={encode(u,m=p.Writer.create()){return u.source!==void 0&&a.Source.encode(u.source,m.uint32(10).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=bn();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.source=a.Source.decode(S,S.uint32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{source:Q(u.source)?a.Source.fromJSON(u.source):void 0}},toJSON(u){const m={};return u.source!==void 0&&(m.source=u.source?a.Source.toJSON(u.source):void 0),m},fromPartial(u){const m=bn();return m.source=u.source!==void 0&&u.source!==null?a.Source.fromPartial(u.source):void 0,m}};function _n(){return{collectionId:"",sourceId:"",force:void 0}}a.DeleteSourceRequest={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.sourceId!==""&&m.uint32(18).string(u.sourceId),u.force!==void 0&&m.uint32(24).bool(u.force),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=_n();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.sourceId=S.string();break;case 3:k.force=S.bool();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",sourceId:Q(u.sourceId)?String(u.sourceId):"",force:Q(u.force)?Boolean(u.force):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.sourceId!==void 0&&(m.sourceId=u.sourceId),u.force!==void 0&&(m.force=u.force),m},fromPartial(u){var m,S,B;const k=_n();return k.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",k.sourceId=(S=u.sourceId)!==null&&S!==void 0?S:"",k.force=(B=u.force)!==null&&B!==void 0?B:void 0,k}};function gn(){return{projectIdsUpdated:[]}}a.DeleteSourceResponse={encode(u,m=p.Writer.create()){for(const S of u.projectIdsUpdated)m.uint32(26).string(S);return m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=gn();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 3:k.projectIdsUpdated.push(S.string());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{projectIdsUpdated:Array.isArray(u==null?void 0:u.projectIdsUpdated)?u.projectIdsUpdated.map(m=>String(m)):[]}},toJSON(u){const m={};return u.projectIdsUpdated?m.projectIdsUpdated=u.projectIdsUpdated.map(S=>S):m.projectIdsUpdated=[],m},fromPartial(u){var m;const S=gn();return S.projectIdsUpdated=((m=u.projectIdsUpdated)===null||m===void 0?void 0:m.map(B=>B))||[],S}};function En(){return{collectionId:"",projectId:"",sourceId:"",trigger:void 0}}a.AddSourceToProjectRequest={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.sourceId!==""&&m.uint32(26).string(u.sourceId),u.trigger!==void 0&&a.SourceTrigger.encode(u.trigger,m.uint32(34).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=En();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.projectId=S.string();break;case 3:k.sourceId=S.string();break;case 4:k.trigger=a.SourceTrigger.decode(S,S.uint32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",sourceId:Q(u.sourceId)?String(u.sourceId):"",trigger:Q(u.trigger)?a.SourceTrigger.fromJSON(u.trigger):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.sourceId!==void 0&&(m.sourceId=u.sourceId),u.trigger!==void 0&&(m.trigger=u.trigger?a.SourceTrigger.toJSON(u.trigger):void 0),m},fromPartial(u){var m,S,B;const k=En();return k.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",k.projectId=(S=u.projectId)!==null&&S!==void 0?S:"",k.sourceId=(B=u.sourceId)!==null&&B!==void 0?B:"",k.trigger=u.trigger!==void 0&&u.trigger!==null?a.SourceTrigger.fromPartial(u.trigger):void 0,k}};function Tn(){return{project:void 0,broadcastUpdated:!1}}a.AddSourceToProjectResponse={encode(u,m=p.Writer.create()){return u.project!==void 0&&a.Project.encode(u.project,m.uint32(10).fork()).ldelim(),u.broadcastUpdated===!0&&m.uint32(16).bool(u.broadcastUpdated),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Tn();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.project=a.Project.decode(S,S.uint32());break;case 2:k.broadcastUpdated=S.bool();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{project:Q(u.project)?a.Project.fromJSON(u.project):void 0,broadcastUpdated:Q(u.broadcastUpdated)?Boolean(u.broadcastUpdated):!1}},toJSON(u){const m={};return u.project!==void 0&&(m.project=u.project?a.Project.toJSON(u.project):void 0),u.broadcastUpdated!==void 0&&(m.broadcastUpdated=u.broadcastUpdated),m},fromPartial(u){var m;const S=Tn();return S.project=u.project!==void 0&&u.project!==null?a.Project.fromPartial(u.project):void 0,S.broadcastUpdated=(m=u.broadcastUpdated)!==null&&m!==void 0?m:!1,S}};function In(){return{collectionId:"",projectId:"",sourceId:"",updateMask:void 0,trigger:void 0}}a.UpdateSourceInProjectRequest={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.sourceId!==""&&m.uint32(26).string(u.sourceId),u.updateMask!==void 0&&E.FieldMask.encode(E.FieldMask.wrap(u.updateMask),m.uint32(34).fork()).ldelim(),u.trigger!==void 0&&a.SourceTrigger.encode(u.trigger,m.uint32(42).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=In();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.projectId=S.string();break;case 3:k.sourceId=S.string();break;case 4:k.updateMask=E.FieldMask.unwrap(E.FieldMask.decode(S,S.uint32()));break;case 5:k.trigger=a.SourceTrigger.decode(S,S.uint32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",sourceId:Q(u.sourceId)?String(u.sourceId):"",updateMask:Q(u.updateMask)?E.FieldMask.unwrap(E.FieldMask.fromJSON(u.updateMask)):void 0,trigger:Q(u.trigger)?a.SourceTrigger.fromJSON(u.trigger):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.sourceId!==void 0&&(m.sourceId=u.sourceId),u.updateMask!==void 0&&(m.updateMask=E.FieldMask.toJSON(E.FieldMask.wrap(u.updateMask))),u.trigger!==void 0&&(m.trigger=u.trigger?a.SourceTrigger.toJSON(u.trigger):void 0),m},fromPartial(u){var m,S,B,k;const H=In();return H.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",H.projectId=(S=u.projectId)!==null&&S!==void 0?S:"",H.sourceId=(B=u.sourceId)!==null&&B!==void 0?B:"",H.updateMask=(k=u.updateMask)!==null&&k!==void 0?k:void 0,H.trigger=u.trigger!==void 0&&u.trigger!==null?a.SourceTrigger.fromPartial(u.trigger):void 0,H}};function On(){return{project:void 0}}a.UpdateSourceInProjectResponse={encode(u,m=p.Writer.create()){return u.project!==void 0&&a.Project.encode(u.project,m.uint32(10).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=On();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.project=a.Project.decode(S,S.uint32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{project:Q(u.project)?a.Project.fromJSON(u.project):void 0}},toJSON(u){const m={};return u.project!==void 0&&(m.project=u.project?a.Project.toJSON(u.project):void 0),m},fromPartial(u){const m=On();return m.project=u.project!==void 0&&u.project!==null?a.Project.fromPartial(u.project):void 0,m}};function kn(){return{collectionId:"",sourceId:""}}a.GetSourceRequest={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.sourceId!==""&&m.uint32(26).string(u.sourceId),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=kn();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 3:k.sourceId=S.string();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",sourceId:Q(u.sourceId)?String(u.sourceId):""}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.sourceId!==void 0&&(m.sourceId=u.sourceId),m},fromPartial(u){var m,S;const B=kn();return B.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",B.sourceId=(S=u.sourceId)!==null&&S!==void 0?S:"",B}};function Rn(){return{source:void 0}}a.GetSourceResponse={encode(u,m=p.Writer.create()){return u.source!==void 0&&a.Source.encode(u.source,m.uint32(10).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Rn();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.source=a.Source.decode(S,S.uint32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{source:Q(u.source)?a.Source.fromJSON(u.source):void 0}},toJSON(u){const m={};return u.source!==void 0&&(m.source=u.source?a.Source.toJSON(u.source):void 0),m},fromPartial(u){const m=Rn();return m.source=u.source!==void 0&&u.source!==null?a.Source.fromPartial(u.source):void 0,m}};function Cn(){return{collectionId:""}}a.GetSourcesRequest={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Cn();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):""}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),m},fromPartial(u){var m;const S=Cn();return S.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",S}};function Pn(){return{sources:[]}}a.GetSourcesResponse={encode(u,m=p.Writer.create()){for(const S of u.sources)a.Source.encode(S,m.uint32(10).fork()).ldelim();return m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Pn();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.sources.push(a.Source.decode(S,S.uint32()));break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{sources:Array.isArray(u==null?void 0:u.sources)?u.sources.map(m=>a.Source.fromJSON(m)):[]}},toJSON(u){const m={};return u.sources?m.sources=u.sources.map(S=>S?a.Source.toJSON(S):void 0):m.sources=[],m},fromPartial(u){var m;const S=Pn();return S.sources=((m=u.sources)===null||m===void 0?void 0:m.map(B=>a.Source.fromPartial(B)))||[],S}};function Nn(){return{collectionId:"",sourceId:"",updateMask:void 0,metadata:void 0,address:void 0,preview:void 0}}a.UpdateSourceRequest={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.sourceId!==""&&m.uint32(26).string(u.sourceId),u.updateMask!==void 0&&E.FieldMask.encode(E.FieldMask.wrap(u.updateMask),m.uint32(34).fork()).ldelim(),u.metadata!==void 0&&_.Value.encode(_.Value.wrap(u.metadata),m.uint32(42).fork()).ldelim(),u.address!==void 0&&a.SourceAddress.encode(u.address,m.uint32(50).fork()).ldelim(),u.preview!==void 0&&a.PreviewAddress.encode(u.preview,m.uint32(58).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Nn();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 3:k.sourceId=S.string();break;case 4:k.updateMask=E.FieldMask.unwrap(E.FieldMask.decode(S,S.uint32()));break;case 5:k.metadata=_.Value.unwrap(_.Value.decode(S,S.uint32()));break;case 6:k.address=a.SourceAddress.decode(S,S.uint32());break;case 7:k.preview=a.PreviewAddress.decode(S,S.uint32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",sourceId:Q(u.sourceId)?String(u.sourceId):"",updateMask:Q(u.updateMask)?E.FieldMask.unwrap(E.FieldMask.fromJSON(u.updateMask)):void 0,metadata:Q(u==null?void 0:u.metadata)?u.metadata:void 0,address:Q(u.address)?a.SourceAddress.fromJSON(u.address):void 0,preview:Q(u.preview)?a.PreviewAddress.fromJSON(u.preview):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.sourceId!==void 0&&(m.sourceId=u.sourceId),u.updateMask!==void 0&&(m.updateMask=E.FieldMask.toJSON(E.FieldMask.wrap(u.updateMask))),u.metadata!==void 0&&(m.metadata=u.metadata),u.address!==void 0&&(m.address=u.address?a.SourceAddress.toJSON(u.address):void 0),u.preview!==void 0&&(m.preview=u.preview?a.PreviewAddress.toJSON(u.preview):void 0),m},fromPartial(u){var m,S,B,k;const H=Nn();return H.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",H.sourceId=(S=u.sourceId)!==null&&S!==void 0?S:"",H.updateMask=(B=u.updateMask)!==null&&B!==void 0?B:void 0,H.metadata=(k=u.metadata)!==null&&k!==void 0?k:void 0,H.address=u.address!==void 0&&u.address!==null?a.SourceAddress.fromPartial(u.address):void 0,H.preview=u.preview!==void 0&&u.preview!==null?a.PreviewAddress.fromPartial(u.preview):void 0,H}};function An(){return{source:void 0,broadcastUpdated:!1}}a.UpdateSourceResponse={encode(u,m=p.Writer.create()){return u.source!==void 0&&a.Source.encode(u.source,m.uint32(10).fork()).ldelim(),u.broadcastUpdated===!0&&m.uint32(16).bool(u.broadcastUpdated),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=An();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.source=a.Source.decode(S,S.uint32());break;case 2:k.broadcastUpdated=S.bool();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{source:Q(u.source)?a.Source.fromJSON(u.source):void 0,broadcastUpdated:Q(u.broadcastUpdated)?Boolean(u.broadcastUpdated):!1}},toJSON(u){const m={};return u.source!==void 0&&(m.source=u.source?a.Source.toJSON(u.source):void 0),u.broadcastUpdated!==void 0&&(m.broadcastUpdated=u.broadcastUpdated),m},fromPartial(u){var m;const S=An();return S.source=u.source!==void 0&&u.source!==null?a.Source.fromPartial(u.source):void 0,S.broadcastUpdated=(m=u.broadcastUpdated)!==null&&m!==void 0?m:!1,S}};function wn(){return{collectionId:"",projectId:"",sourceId:"",force:void 0}}a.RemoveSourceFromProjectRequest={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.sourceId!==""&&m.uint32(26).string(u.sourceId),u.force!==void 0&&m.uint32(32).bool(u.force),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=wn();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.projectId=S.string();break;case 3:k.sourceId=S.string();break;case 4:k.force=S.bool();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",sourceId:Q(u.sourceId)?String(u.sourceId):"",force:Q(u.force)?Boolean(u.force):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.sourceId!==void 0&&(m.sourceId=u.sourceId),u.force!==void 0&&(m.force=u.force),m},fromPartial(u){var m,S,B,k;const H=wn();return H.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",H.projectId=(S=u.projectId)!==null&&S!==void 0?S:"",H.sourceId=(B=u.sourceId)!==null&&B!==void 0?B:"",H.force=(k=u.force)!==null&&k!==void 0?k:void 0,H}};function Dn(){return{project:void 0,broadcastUpdated:!1}}a.RemoveSourceFromProjectResponse={encode(u,m=p.Writer.create()){return u.project!==void 0&&a.Project.encode(u.project,m.uint32(10).fork()).ldelim(),u.broadcastUpdated===!0&&m.uint32(16).bool(u.broadcastUpdated),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Dn();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.project=a.Project.decode(S,S.uint32());break;case 2:k.broadcastUpdated=S.bool();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{project:Q(u.project)?a.Project.fromJSON(u.project):void 0,broadcastUpdated:Q(u.broadcastUpdated)?Boolean(u.broadcastUpdated):!1}},toJSON(u){const m={};return u.project!==void 0&&(m.project=u.project?a.Project.toJSON(u.project):void 0),u.broadcastUpdated!==void 0&&(m.broadcastUpdated=u.broadcastUpdated),m},fromPartial(u){var m;const S=Dn();return S.project=u.project!==void 0&&u.project!==null?a.Project.fromPartial(u.project):void 0,S.broadcastUpdated=(m=u.broadcastUpdated)!==null&&m!==void 0?m:!1,S}};function Ln(){return{serviceUserId:"",displayName:void 0,role:void 0,maxDuration:void 0}}a.CreateAccessTokenRequest={encode(u,m=p.Writer.create()){return u.serviceUserId!==""&&m.uint32(10).string(u.serviceUserId),u.displayName!==void 0&&m.uint32(34).string(u.displayName),u.role!==void 0&&m.uint32(16).int32(Ae(u.role)),u.maxDuration!==void 0&&m.uint32(24).uint32(u.maxDuration),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Ln();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.serviceUserId=S.string();break;case 4:k.displayName=S.string();break;case 2:k.role=Oe(S.int32());break;case 3:k.maxDuration=S.uint32();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{serviceUserId:Q(u.serviceUserId)?String(u.serviceUserId):"",displayName:Q(u.displayName)?String(u.displayName):void 0,role:Q(u.role)?Oe(u.role):void 0,maxDuration:Q(u.maxDuration)?Number(u.maxDuration):void 0}},toJSON(u){const m={};return u.serviceUserId!==void 0&&(m.serviceUserId=u.serviceUserId),u.displayName!==void 0&&(m.displayName=u.displayName),u.role!==void 0&&(m.role=u.role!==void 0?Ee(u.role):void 0),u.maxDuration!==void 0&&(m.maxDuration=Math.round(u.maxDuration)),m},fromPartial(u){var m,S,B,k;const H=Ln();return H.serviceUserId=(m=u.serviceUserId)!==null&&m!==void 0?m:"",H.displayName=(S=u.displayName)!==null&&S!==void 0?S:void 0,H.role=(B=u.role)!==null&&B!==void 0?B:void 0,H.maxDuration=(k=u.maxDuration)!==null&&k!==void 0?k:void 0,H}};function $n(){return{accessToken:""}}a.CreateAccessTokenResponse={encode(u,m=p.Writer.create()){return u.accessToken!==""&&m.uint32(10).string(u.accessToken),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=$n();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.accessToken=S.string();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{accessToken:Q(u.accessToken)?String(u.accessToken):""}},toJSON(u){const m={};return u.accessToken!==void 0&&(m.accessToken=u.accessToken),m},fromPartial(u){var m;const S=$n();return S.accessToken=(m=u.accessToken)!==null&&m!==void 0?m:"",S}};function Mn(){return{displayName:"",serviceUserId:void 0}}a.GuestAccessTokenDirect={encode(u,m=p.Writer.create()){return u.displayName!==""&&m.uint32(10).string(u.displayName),u.serviceUserId!==void 0&&m.uint32(18).string(u.serviceUserId),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Mn();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.displayName=S.string();break;case 2:k.serviceUserId=S.string();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{displayName:Q(u.displayName)?String(u.displayName):"",serviceUserId:Q(u.serviceUserId)?String(u.serviceUserId):void 0}},toJSON(u){const m={};return u.displayName!==void 0&&(m.displayName=u.displayName),u.serviceUserId!==void 0&&(m.serviceUserId=u.serviceUserId),m},fromPartial(u){var m,S;const B=Mn();return B.displayName=(m=u.displayName)!==null&&m!==void 0?m:"",B.serviceUserId=(S=u.serviceUserId)!==null&&S!==void 0?S:void 0,B}};function Un(){return{maxDuration:void 0}}a.GuestAccessTokenExchange={encode(u,m=p.Writer.create()){return u.maxDuration!==void 0&&m.uint32(8).uint32(u.maxDuration),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Un();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.maxDuration=S.uint32();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{maxDuration:Q(u.maxDuration)?Number(u.maxDuration):void 0}},toJSON(u){const m={};return u.maxDuration!==void 0&&(m.maxDuration=Math.round(u.maxDuration)),m},fromPartial(u){var m;const S=Un();return S.maxDuration=(m=u.maxDuration)!==null&&m!==void 0?m:void 0,S}};function Vn(){return{direct:void 0,exchange:void 0}}a.GuestAccessToken={encode(u,m=p.Writer.create()){return u.direct!==void 0&&a.GuestAccessTokenDirect.encode(u.direct,m.uint32(10).fork()).ldelim(),u.exchange!==void 0&&a.GuestAccessTokenExchange.encode(u.exchange,m.uint32(18).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Vn();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.direct=a.GuestAccessTokenDirect.decode(S,S.uint32());break;case 2:k.exchange=a.GuestAccessTokenExchange.decode(S,S.uint32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{direct:Q(u.direct)?a.GuestAccessTokenDirect.fromJSON(u.direct):void 0,exchange:Q(u.exchange)?a.GuestAccessTokenExchange.fromJSON(u.exchange):void 0}},toJSON(u){const m={};return u.direct!==void 0&&(m.direct=u.direct?a.GuestAccessTokenDirect.toJSON(u.direct):void 0),u.exchange!==void 0&&(m.exchange=u.exchange?a.GuestAccessTokenExchange.toJSON(u.exchange):void 0),m},fromPartial(u){const m=Vn();return m.direct=u.direct!==void 0&&u.direct!==null?a.GuestAccessTokenDirect.fromPartial(u.direct):void 0,m.exchange=u.exchange!==void 0&&u.exchange!==null?a.GuestAccessTokenExchange.fromPartial(u.exchange):void 0,m}};function Bn(){return{collectionId:"",projectId:"",maxDuration:void 0,role:ve.ROLE_UNSPECIFIED,token:void 0,url:void 0}}a.CreateGuestAccessTokenRequest={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.maxDuration!==void 0&&m.uint32(24).uint32(u.maxDuration),u.role!==ve.ROLE_UNSPECIFIED&&m.uint32(32).int32(Ae(u.role)),u.token!==void 0&&a.GuestAccessToken.encode(u.token,m.uint32(42).fork()).ldelim(),u.url!==void 0&&m.uint32(50).string(u.url),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Bn();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.projectId=S.string();break;case 3:k.maxDuration=S.uint32();break;case 4:k.role=Oe(S.int32());break;case 5:k.token=a.GuestAccessToken.decode(S,S.uint32());break;case 6:k.url=S.string();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",maxDuration:Q(u.maxDuration)?Number(u.maxDuration):void 0,role:Q(u.role)?Oe(u.role):ve.ROLE_UNSPECIFIED,token:Q(u.token)?a.GuestAccessToken.fromJSON(u.token):void 0,url:Q(u.url)?String(u.url):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.maxDuration!==void 0&&(m.maxDuration=Math.round(u.maxDuration)),u.role!==void 0&&(m.role=Ee(u.role)),u.token!==void 0&&(m.token=u.token?a.GuestAccessToken.toJSON(u.token):void 0),u.url!==void 0&&(m.url=u.url),m},fromPartial(u){var m,S,B,k,H;const Se=Bn();return Se.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",Se.projectId=(S=u.projectId)!==null&&S!==void 0?S:"",Se.maxDuration=(B=u.maxDuration)!==null&&B!==void 0?B:void 0,Se.role=(k=u.role)!==null&&k!==void 0?k:ve.ROLE_UNSPECIFIED,Se.token=u.token!==void 0&&u.token!==null?a.GuestAccessToken.fromPartial(u.token):void 0,Se.url=(H=u.url)!==null&&H!==void 0?H:void 0,Se}};function Jn(){return{accessToken:"",url:void 0}}a.CreateGuestAccessTokenResponse={encode(u,m=p.Writer.create()){return u.accessToken!==""&&m.uint32(10).string(u.accessToken),u.url!==void 0&&m.uint32(18).string(u.url),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Jn();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.accessToken=S.string();break;case 2:k.url=S.string();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{accessToken:Q(u.accessToken)?String(u.accessToken):"",url:Q(u.url)?String(u.url):void 0}},toJSON(u){const m={};return u.accessToken!==void 0&&(m.accessToken=u.accessToken),u.url!==void 0&&(m.url=u.url),m},fromPartial(u){var m,S;const B=Jn();return B.accessToken=(m=u.accessToken)!==null&&m!==void 0?m:"",B.url=(S=u.url)!==null&&S!==void 0?S:void 0,B}};function Fn(){return{collectionId:"",projectId:"",displayName:""}}a.CreateWebRtcAccessTokenRequest={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.displayName!==""&&m.uint32(26).string(u.displayName),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Fn();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.projectId=S.string();break;case 3:k.displayName=S.string();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",displayName:Q(u.displayName)?String(u.displayName):""}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.displayName!==void 0&&(m.displayName=u.displayName),m},fromPartial(u){var m,S,B;const k=Fn();return k.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",k.projectId=(S=u.projectId)!==null&&S!==void 0?S:"",k.displayName=(B=u.displayName)!==null&&B!==void 0?B:"",k}};function Gn(){return{webrtcAccess:void 0}}a.CreateWebRtcAccessTokenResponse={encode(u,m=p.Writer.create()){return u.webrtcAccess!==void 0&&a.WebRtcAccess.encode(u.webrtcAccess,m.uint32(18).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Gn();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 2:k.webrtcAccess=a.WebRtcAccess.decode(S,S.uint32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{webrtcAccess:Q(u.webrtcAccess)?a.WebRtcAccess.fromJSON(u.webrtcAccess):void 0}},toJSON(u){const m={};return u.webrtcAccess!==void 0&&(m.webrtcAccess=u.webrtcAccess?a.WebRtcAccess.toJSON(u.webrtcAccess):void 0),m},fromPartial(u){const m=Gn();return m.webrtcAccess=u.webrtcAccess!==void 0&&u.webrtcAccess!==null?a.WebRtcAccess.fromPartial(u.webrtcAccess):void 0,m}};function qn(){return{}}a.RefreshAccessTokenRequest={encode(u,m=p.Writer.create()){return m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=qn();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){default:S.skipType(H&7);break}}return k},fromJSON(u){return{}},toJSON(u){return{}},fromPartial(u){return qn()}};function Wn(){return{}}a.RefreshAccessTokenResponse={encode(u,m=p.Writer.create()){return m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Wn();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){default:S.skipType(H&7);break}}return k},fromJSON(u){return{}},toJSON(u){return{}},fromPartial(u){return Wn()}};function Hn(){return{collectionId:"",projectId:"",code:"",url:"",autoDelete:void 0}}a.GuestCode={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.code!==""&&m.uint32(26).string(u.code),u.url!==""&&m.uint32(34).string(u.url),u.autoDelete!==void 0&&y.Timestamp.encode(st(u.autoDelete),m.uint32(42).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Hn();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.projectId=S.string();break;case 3:k.code=S.string();break;case 4:k.url=S.string();break;case 5:k.autoDelete=dt(y.Timestamp.decode(S,S.uint32()));break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",code:Q(u.code)?String(u.code):"",url:Q(u.url)?String(u.url):"",autoDelete:Q(u.autoDelete)?String(u.autoDelete):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.code!==void 0&&(m.code=u.code),u.url!==void 0&&(m.url=u.url),u.autoDelete!==void 0&&(m.autoDelete=u.autoDelete),m},fromPartial(u){var m,S,B,k,H;const Se=Hn();return Se.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",Se.projectId=(S=u.projectId)!==null&&S!==void 0?S:"",Se.code=(B=u.code)!==null&&B!==void 0?B:"",Se.url=(k=u.url)!==null&&k!==void 0?k:"",Se.autoDelete=(H=u.autoDelete)!==null&&H!==void 0?H:void 0,Se}};function jn(){return{serviceId:"",code:""}}a.GuestCodeRedirectRequest={encode(u,m=p.Writer.create()){return u.serviceId!==""&&m.uint32(10).string(u.serviceId),u.code!==""&&m.uint32(18).string(u.code),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=jn();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.serviceId=S.string();break;case 2:k.code=S.string();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{serviceId:Q(u.serviceId)?String(u.serviceId):"",code:Q(u.code)?String(u.code):""}},toJSON(u){const m={};return u.serviceId!==void 0&&(m.serviceId=u.serviceId),u.code!==void 0&&(m.code=u.code),m},fromPartial(u){var m,S;const B=jn();return B.serviceId=(m=u.serviceId)!==null&&m!==void 0?m:"",B.code=(S=u.code)!==null&&S!==void 0?S:"",B}};function Yn(){return{}}a.GuestCodeRedirectResponse={encode(u,m=p.Writer.create()){return m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Yn();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){default:S.skipType(H&7);break}}return k},fromJSON(u){return{}},toJSON(u){return{}},fromPartial(u){return Yn()}};function zn(){return{alg:"",kty:"",use:"",kid:"",e:"",n:""}}a.JsonWebKey={encode(u,m=p.Writer.create()){return u.alg!==""&&m.uint32(10).string(u.alg),u.kty!==""&&m.uint32(18).string(u.kty),u.use!==""&&m.uint32(26).string(u.use),u.kid!==""&&m.uint32(34).string(u.kid),u.e!==""&&m.uint32(42).string(u.e),u.n!==""&&m.uint32(50).string(u.n),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=zn();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.alg=S.string();break;case 2:k.kty=S.string();break;case 3:k.use=S.string();break;case 4:k.kid=S.string();break;case 5:k.e=S.string();break;case 6:k.n=S.string();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{alg:Q(u.alg)?String(u.alg):"",kty:Q(u.kty)?String(u.kty):"",use:Q(u.use)?String(u.use):"",kid:Q(u.kid)?String(u.kid):"",e:Q(u.e)?String(u.e):"",n:Q(u.n)?String(u.n):""}},toJSON(u){const m={};return u.alg!==void 0&&(m.alg=u.alg),u.kty!==void 0&&(m.kty=u.kty),u.use!==void 0&&(m.use=u.use),u.kid!==void 0&&(m.kid=u.kid),u.e!==void 0&&(m.e=u.e),u.n!==void 0&&(m.n=u.n),m},fromPartial(u){var m,S,B,k,H,Se;const ke=zn();return ke.alg=(m=u.alg)!==null&&m!==void 0?m:"",ke.kty=(S=u.kty)!==null&&S!==void 0?S:"",ke.use=(B=u.use)!==null&&B!==void 0?B:"",ke.kid=(k=u.kid)!==null&&k!==void 0?k:"",ke.e=(H=u.e)!==null&&H!==void 0?H:"",ke.n=(Se=u.n)!==null&&Se!==void 0?Se:"",ke}};function xn(){return{}}a.GetJsonWebKeySetRequest={encode(u,m=p.Writer.create()){return m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=xn();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){default:S.skipType(H&7);break}}return k},fromJSON(u){return{}},toJSON(u){return{}},fromPartial(u){return xn()}};function Kn(){return{keys:[]}}a.GetJsonWebKeySetResponse={encode(u,m=p.Writer.create()){for(const S of u.keys)a.JsonWebKey.encode(S,m.uint32(10).fork()).ldelim();return m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Kn();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.keys.push(a.JsonWebKey.decode(S,S.uint32()));break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{keys:Array.isArray(u==null?void 0:u.keys)?u.keys.map(m=>a.JsonWebKey.fromJSON(m)):[]}},toJSON(u){const m={};return u.keys?m.keys=u.keys.map(S=>S?a.JsonWebKey.toJSON(S):void 0):m.keys=[],m},fromPartial(u){var m;const S=Kn();return S.keys=((m=u.keys)===null||m===void 0?void 0:m.map(B=>a.JsonWebKey.fromPartial(B)))||[],S}};function Qn(){return{}}a.GetTestTokenRequest={encode(u,m=p.Writer.create()){return m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Qn();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){default:S.skipType(H&7);break}}return k},fromJSON(u){return{}},toJSON(u){return{}},fromPartial(u){return Qn()}};function Xn(){return{accessToken:""}}a.GetTestTokenResponse={encode(u,m=p.Writer.create()){return u.accessToken!==""&&m.uint32(10).string(u.accessToken),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Xn();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.accessToken=S.string();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{accessToken:Q(u.accessToken)?String(u.accessToken):""}},toJSON(u){const m={};return u.accessToken!==void 0&&(m.accessToken=u.accessToken),m},fromPartial(u){var m;const S=Xn();return S.accessToken=(m=u.accessToken)!==null&&m!==void 0?m:"",S}};function Zn(){return{collectionId:"",projectId:"",destinationId:"",destination:void 0}}a.DestinationCreateEvent={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.destinationId!==""&&m.uint32(26).string(u.destinationId),u.destination!==void 0&&a.Destination.encode(u.destination,m.uint32(34).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Zn();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.projectId=S.string();break;case 3:k.destinationId=S.string();break;case 4:k.destination=a.Destination.decode(S,S.uint32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",destinationId:Q(u.destinationId)?String(u.destinationId):"",destination:Q(u.destination)?a.Destination.fromJSON(u.destination):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.destinationId!==void 0&&(m.destinationId=u.destinationId),u.destination!==void 0&&(m.destination=u.destination?a.Destination.toJSON(u.destination):void 0),m},fromPartial(u){var m,S,B;const k=Zn();return k.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",k.projectId=(S=u.projectId)!==null&&S!==void 0?S:"",k.destinationId=(B=u.destinationId)!==null&&B!==void 0?B:"",k.destination=u.destination!==void 0&&u.destination!==null?a.Destination.fromPartial(u.destination):void 0,k}};function er(){return{collectionId:"",projectId:"",destinationId:""}}a.DestinationDeleteEvent={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.destinationId!==""&&m.uint32(26).string(u.destinationId),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=er();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.projectId=S.string();break;case 3:k.destinationId=S.string();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",destinationId:Q(u.destinationId)?String(u.destinationId):""}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.destinationId!==void 0&&(m.destinationId=u.destinationId),m},fromPartial(u){var m,S,B;const k=er();return k.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",k.projectId=(S=u.projectId)!==null&&S!==void 0?S:"",k.destinationId=(B=u.destinationId)!==null&&B!==void 0?B:"",k}};function tr(){return{collectionId:"",projectId:"",destinationId:"",updateMask:[],destination:void 0}}a.DestinationUpdateEvent={encode(u,m=p.Writer.create()){u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.destinationId!==""&&m.uint32(26).string(u.destinationId);for(const S of u.updateMask)m.uint32(34).string(S);return u.destination!==void 0&&a.Destination.encode(u.destination,m.uint32(42).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=tr();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.projectId=S.string();break;case 3:k.destinationId=S.string();break;case 4:k.updateMask.push(S.string());break;case 5:k.destination=a.Destination.decode(S,S.uint32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",destinationId:Q(u.destinationId)?String(u.destinationId):"",updateMask:Array.isArray(u==null?void 0:u.updateMask)?u.updateMask.map(m=>String(m)):[],destination:Q(u.destination)?a.Destination.fromJSON(u.destination):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.destinationId!==void 0&&(m.destinationId=u.destinationId),u.updateMask?m.updateMask=u.updateMask.map(S=>S):m.updateMask=[],u.destination!==void 0&&(m.destination=u.destination?a.Destination.toJSON(u.destination):void 0),m},fromPartial(u){var m,S,B,k;const H=tr();return H.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",H.projectId=(S=u.projectId)!==null&&S!==void 0?S:"",H.destinationId=(B=u.destinationId)!==null&&B!==void 0?B:"",H.updateMask=((k=u.updateMask)===null||k===void 0?void 0:k.map(Se=>Se))||[],H.destination=u.destination!==void 0&&u.destination!==null?a.Destination.fromPartial(u.destination):void 0,H}};function nr(){return{collectionId:"",projectId:"",destinationId:"",connect:void 0}}a.DestinationStateEvent={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.destinationId!==""&&m.uint32(26).string(u.destinationId),u.connect!==void 0&&m.uint32(32).int32(rt(u.connect)),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=nr();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.projectId=S.string();break;case 3:k.destinationId=S.string();break;case 4:k.connect=Ze(S.int32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",destinationId:Q(u.destinationId)?String(u.destinationId):"",connect:Q(u.connect)?Ze(u.connect):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.destinationId!==void 0&&(m.destinationId=u.destinationId),u.connect!==void 0&&(m.connect=u.connect!==void 0?nt(u.connect):void 0),m},fromPartial(u){var m,S,B,k;const H=nr();return H.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",H.projectId=(S=u.projectId)!==null&&S!==void 0?S:"",H.destinationId=(B=u.destinationId)!==null&&B!==void 0?B:"",H.connect=(k=u.connect)!==null&&k!==void 0?k:void 0,H}};function rr(){return{collectionId:"",projectId:"",project:void 0}}a.ProjectCreateEvent={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.project!==void 0&&a.Project.encode(u.project,m.uint32(26).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=rr();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.projectId=S.string();break;case 3:k.project=a.Project.decode(S,S.uint32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",project:Q(u.project)?a.Project.fromJSON(u.project):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.project!==void 0&&(m.project=u.project?a.Project.toJSON(u.project):void 0),m},fromPartial(u){var m,S;const B=rr();return B.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",B.projectId=(S=u.projectId)!==null&&S!==void 0?S:"",B.project=u.project!==void 0&&u.project!==null?a.Project.fromPartial(u.project):void 0,B}};function ir(){return{collectionId:"",projectId:""}}a.ProjectDeleteEvent={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=ir();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.projectId=S.string();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):""}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),m},fromPartial(u){var m,S;const B=ir();return B.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",B.projectId=(S=u.projectId)!==null&&S!==void 0?S:"",B}};function ar(){return{collectionId:"",projectId:"",updateMask:[],project:void 0}}a.ProjectUpdateEvent={encode(u,m=p.Writer.create()){u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId);for(const S of u.updateMask)m.uint32(26).string(S);return u.project!==void 0&&a.Project.encode(u.project,m.uint32(34).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=ar();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.projectId=S.string();break;case 3:k.updateMask.push(S.string());break;case 4:k.project=a.Project.decode(S,S.uint32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",updateMask:Array.isArray(u==null?void 0:u.updateMask)?u.updateMask.map(m=>String(m)):[],project:Q(u.project)?a.Project.fromJSON(u.project):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.updateMask?m.updateMask=u.updateMask.map(S=>S):m.updateMask=[],u.project!==void 0&&(m.project=u.project?a.Project.toJSON(u.project):void 0),m},fromPartial(u){var m,S,B;const k=ar();return k.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",k.projectId=(S=u.projectId)!==null&&S!==void 0?S:"",k.updateMask=((B=u.updateMask)===null||B===void 0?void 0:B.map(H=>H))||[],k.project=u.project!==void 0&&u.project!==null?a.Project.fromPartial(u.project):void 0,k}};function or(){return{collectionId:"",projectId:"",broadcastId:"",phase:void 0,error:void 0}}a.ProjectBroadcastStateEvent={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.broadcastId!==""&&m.uint32(26).string(u.broadcastId),u.phase!==void 0&&m.uint32(32).int32(le(u.phase)),u.error!==void 0&&m.uint32(40).int32(Xe(u.error)),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=or();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.projectId=S.string();break;case 3:k.broadcastId=S.string();break;case 4:k.phase=$(S.int32());break;case 5:k.error=Qe(S.int32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",broadcastId:Q(u.broadcastId)?String(u.broadcastId):"",phase:Q(u.phase)?$(u.phase):void 0,error:Q(u.error)?Qe(u.error):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.broadcastId!==void 0&&(m.broadcastId=u.broadcastId),u.phase!==void 0&&(m.phase=u.phase!==void 0?Z(u.phase):void 0),u.error!==void 0&&(m.error=u.error!==void 0?Re(u.error):void 0),m},fromPartial(u){var m,S,B,k,H;const Se=or();return Se.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",Se.projectId=(S=u.projectId)!==null&&S!==void 0?S:"",Se.broadcastId=(B=u.broadcastId)!==null&&B!==void 0?B:"",Se.phase=(k=u.phase)!==null&&k!==void 0?k:void 0,Se.error=(H=u.error)!==null&&H!==void 0?H:void 0,Se}};function sr(){return{collectionId:"",collection:void 0}}a.CollectionCreateEvent={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.collection!==void 0&&a.Collection.encode(u.collection,m.uint32(18).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=sr();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.collection=a.Collection.decode(S,S.uint32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",collection:Q(u.collection)?a.Collection.fromJSON(u.collection):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.collection!==void 0&&(m.collection=u.collection?a.Collection.toJSON(u.collection):void 0),m},fromPartial(u){var m;const S=sr();return S.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",S.collection=u.collection!==void 0&&u.collection!==null?a.Collection.fromPartial(u.collection):void 0,S}};function dr(){return{collectionId:""}}a.CollectionDeleteEvent={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=dr();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):""}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),m},fromPartial(u){var m;const S=dr();return S.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",S}};function ur(){return{collectionId:"",updateMask:[],collection:void 0}}a.CollectionUpdateEvent={encode(u,m=p.Writer.create()){u.collectionId!==""&&m.uint32(10).string(u.collectionId);for(const S of u.updateMask)m.uint32(18).string(S);return u.collection!==void 0&&a.Collection.encode(u.collection,m.uint32(26).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=ur();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.updateMask.push(S.string());break;case 3:k.collection=a.Collection.decode(S,S.uint32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",updateMask:Array.isArray(u==null?void 0:u.updateMask)?u.updateMask.map(m=>String(m)):[],collection:Q(u.collection)?a.Collection.fromJSON(u.collection):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.updateMask?m.updateMask=u.updateMask.map(S=>S):m.updateMask=[],u.collection!==void 0&&(m.collection=u.collection?a.Collection.toJSON(u.collection):void 0),m},fromPartial(u){var m,S;const B=ur();return B.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",B.updateMask=((S=u.updateMask)===null||S===void 0?void 0:S.map(k=>k))||[],B.collection=u.collection!==void 0&&u.collection!==null?a.Collection.fromPartial(u.collection):void 0,B}};function cr(){return{collectionId:"",sourceId:"",source:void 0}}a.SourceCreateEvent={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.sourceId!==""&&m.uint32(18).string(u.sourceId),u.source!==void 0&&a.Source.encode(u.source,m.uint32(26).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=cr();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.sourceId=S.string();break;case 3:k.source=a.Source.decode(S,S.uint32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",sourceId:Q(u.sourceId)?String(u.sourceId):"",source:Q(u.source)?a.Source.fromJSON(u.source):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.sourceId!==void 0&&(m.sourceId=u.sourceId),u.source!==void 0&&(m.source=u.source?a.Source.toJSON(u.source):void 0),m},fromPartial(u){var m,S;const B=cr();return B.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",B.sourceId=(S=u.sourceId)!==null&&S!==void 0?S:"",B.source=u.source!==void 0&&u.source!==null?a.Source.fromPartial(u.source):void 0,B}};function lr(){return{collectionId:"",sourceId:""}}a.SourceDeleteEvent={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.sourceId!==""&&m.uint32(18).string(u.sourceId),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=lr();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.sourceId=S.string();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",sourceId:Q(u.sourceId)?String(u.sourceId):""}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.sourceId!==void 0&&(m.sourceId=u.sourceId),m},fromPartial(u){var m,S;const B=lr();return B.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",B.sourceId=(S=u.sourceId)!==null&&S!==void 0?S:"",B}};function fr(){return{collectionId:"",sourceId:"",updateMask:[],source:void 0}}a.SourceUpdateEvent={encode(u,m=p.Writer.create()){u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.sourceId!==""&&m.uint32(18).string(u.sourceId);for(const S of u.updateMask)m.uint32(26).string(S);return u.source!==void 0&&a.Source.encode(u.source,m.uint32(34).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=fr();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.sourceId=S.string();break;case 3:k.updateMask.push(S.string());break;case 4:k.source=a.Source.decode(S,S.uint32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",sourceId:Q(u.sourceId)?String(u.sourceId):"",updateMask:Array.isArray(u==null?void 0:u.updateMask)?u.updateMask.map(m=>String(m)):[],source:Q(u.source)?a.Source.fromJSON(u.source):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.sourceId!==void 0&&(m.sourceId=u.sourceId),u.updateMask?m.updateMask=u.updateMask.map(S=>S):m.updateMask=[],u.source!==void 0&&(m.source=u.source?a.Source.toJSON(u.source):void 0),m},fromPartial(u){var m,S,B;const k=fr();return k.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",k.sourceId=(S=u.sourceId)!==null&&S!==void 0?S:"",k.updateMask=((B=u.updateMask)===null||B===void 0?void 0:B.map(H=>H))||[],k.source=u.source!==void 0&&u.source!==null?a.Source.fromPartial(u.source):void 0,k}};function pr(){return{collectionId:"",sourceId:"",projectId:"",source:void 0}}a.SourceAddEvent={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.sourceId!==""&&m.uint32(18).string(u.sourceId),u.projectId!==""&&m.uint32(26).string(u.projectId),u.source!==void 0&&a.Source.encode(u.source,m.uint32(34).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=pr();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.sourceId=S.string();break;case 3:k.projectId=S.string();break;case 4:k.source=a.Source.decode(S,S.uint32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",sourceId:Q(u.sourceId)?String(u.sourceId):"",projectId:Q(u.projectId)?String(u.projectId):"",source:Q(u.source)?a.Source.fromJSON(u.source):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.sourceId!==void 0&&(m.sourceId=u.sourceId),u.projectId!==void 0&&(m.projectId=u.projectId),u.source!==void 0&&(m.source=u.source?a.Source.toJSON(u.source):void 0),m},fromPartial(u){var m,S,B;const k=pr();return k.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",k.sourceId=(S=u.sourceId)!==null&&S!==void 0?S:"",k.projectId=(B=u.projectId)!==null&&B!==void 0?B:"",k.source=u.source!==void 0&&u.source!==null?a.Source.fromPartial(u.source):void 0,k}};function hr(){return{collectionId:"",sourceId:"",projectId:""}}a.SourceRemoveEvent={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.sourceId!==""&&m.uint32(18).string(u.sourceId),u.projectId!==""&&m.uint32(26).string(u.projectId),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=hr();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.sourceId=S.string();break;case 3:k.projectId=S.string();break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",sourceId:Q(u.sourceId)?String(u.sourceId):"",projectId:Q(u.projectId)?String(u.projectId):""}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.sourceId!==void 0&&(m.sourceId=u.sourceId),u.projectId!==void 0&&(m.projectId=u.projectId),m},fromPartial(u){var m,S,B;const k=hr();return k.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",k.sourceId=(S=u.sourceId)!==null&&S!==void 0?S:"",k.projectId=(B=u.projectId)!==null&&B!==void 0?B:"",k}};function mr(){return{collectionId:"",projectId:"",sourceId:"",connect:void 0}}a.SourceStateEvent={encode(u,m=p.Writer.create()){return u.collectionId!==""&&m.uint32(10).string(u.collectionId),u.projectId!==""&&m.uint32(18).string(u.projectId),u.sourceId!==""&&m.uint32(26).string(u.sourceId),u.connect!==void 0&&m.uint32(32).int32(rt(u.connect)),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=mr();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collectionId=S.string();break;case 2:k.projectId=S.string();break;case 3:k.sourceId=S.string();break;case 4:k.connect=Ze(S.int32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collectionId:Q(u.collectionId)?String(u.collectionId):"",projectId:Q(u.projectId)?String(u.projectId):"",sourceId:Q(u.sourceId)?String(u.sourceId):"",connect:Q(u.connect)?Ze(u.connect):void 0}},toJSON(u){const m={};return u.collectionId!==void 0&&(m.collectionId=u.collectionId),u.projectId!==void 0&&(m.projectId=u.projectId),u.sourceId!==void 0&&(m.sourceId=u.sourceId),u.connect!==void 0&&(m.connect=u.connect!==void 0?nt(u.connect):void 0),m},fromPartial(u){var m,S,B,k;const H=mr();return H.collectionId=(m=u.collectionId)!==null&&m!==void 0?m:"",H.projectId=(S=u.projectId)!==null&&S!==void 0?S:"",H.sourceId=(B=u.sourceId)!==null&&B!==void 0?B:"",H.connect=(k=u.connect)!==null&&k!==void 0?k:void 0,H}};function vr(){return{create:void 0,update:void 0,delete:void 0}}a.CollectionEvent={encode(u,m=p.Writer.create()){return u.create!==void 0&&a.CollectionCreateEvent.encode(u.create,m.uint32(10).fork()).ldelim(),u.update!==void 0&&a.CollectionUpdateEvent.encode(u.update,m.uint32(18).fork()).ldelim(),u.delete!==void 0&&a.CollectionDeleteEvent.encode(u.delete,m.uint32(26).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=vr();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.create=a.CollectionCreateEvent.decode(S,S.uint32());break;case 2:k.update=a.CollectionUpdateEvent.decode(S,S.uint32());break;case 3:k.delete=a.CollectionDeleteEvent.decode(S,S.uint32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{create:Q(u.create)?a.CollectionCreateEvent.fromJSON(u.create):void 0,update:Q(u.update)?a.CollectionUpdateEvent.fromJSON(u.update):void 0,delete:Q(u.delete)?a.CollectionDeleteEvent.fromJSON(u.delete):void 0}},toJSON(u){const m={};return u.create!==void 0&&(m.create=u.create?a.CollectionCreateEvent.toJSON(u.create):void 0),u.update!==void 0&&(m.update=u.update?a.CollectionUpdateEvent.toJSON(u.update):void 0),u.delete!==void 0&&(m.delete=u.delete?a.CollectionDeleteEvent.toJSON(u.delete):void 0),m},fromPartial(u){const m=vr();return m.create=u.create!==void 0&&u.create!==null?a.CollectionCreateEvent.fromPartial(u.create):void 0,m.update=u.update!==void 0&&u.update!==null?a.CollectionUpdateEvent.fromPartial(u.update):void 0,m.delete=u.delete!==void 0&&u.delete!==null?a.CollectionDeleteEvent.fromPartial(u.delete):void 0,m}};function Sr(){return{create:void 0,update:void 0,delete:void 0,state:void 0}}a.DestinationEvent={encode(u,m=p.Writer.create()){return u.create!==void 0&&a.DestinationCreateEvent.encode(u.create,m.uint32(10).fork()).ldelim(),u.update!==void 0&&a.DestinationUpdateEvent.encode(u.update,m.uint32(18).fork()).ldelim(),u.delete!==void 0&&a.DestinationDeleteEvent.encode(u.delete,m.uint32(26).fork()).ldelim(),u.state!==void 0&&a.DestinationStateEvent.encode(u.state,m.uint32(34).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=Sr();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.create=a.DestinationCreateEvent.decode(S,S.uint32());break;case 2:k.update=a.DestinationUpdateEvent.decode(S,S.uint32());break;case 3:k.delete=a.DestinationDeleteEvent.decode(S,S.uint32());break;case 4:k.state=a.DestinationStateEvent.decode(S,S.uint32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{create:Q(u.create)?a.DestinationCreateEvent.fromJSON(u.create):void 0,update:Q(u.update)?a.DestinationUpdateEvent.fromJSON(u.update):void 0,delete:Q(u.delete)?a.DestinationDeleteEvent.fromJSON(u.delete):void 0,state:Q(u.state)?a.DestinationStateEvent.fromJSON(u.state):void 0}},toJSON(u){const m={};return u.create!==void 0&&(m.create=u.create?a.DestinationCreateEvent.toJSON(u.create):void 0),u.update!==void 0&&(m.update=u.update?a.DestinationUpdateEvent.toJSON(u.update):void 0),u.delete!==void 0&&(m.delete=u.delete?a.DestinationDeleteEvent.toJSON(u.delete):void 0),u.state!==void 0&&(m.state=u.state?a.DestinationStateEvent.toJSON(u.state):void 0),m},fromPartial(u){const m=Sr();return m.create=u.create!==void 0&&u.create!==null?a.DestinationCreateEvent.fromPartial(u.create):void 0,m.update=u.update!==void 0&&u.update!==null?a.DestinationUpdateEvent.fromPartial(u.update):void 0,m.delete=u.delete!==void 0&&u.delete!==null?a.DestinationDeleteEvent.fromPartial(u.delete):void 0,m.state=u.state!==void 0&&u.state!==null?a.DestinationStateEvent.fromPartial(u.state):void 0,m}};function yr(){return{create:void 0,update:void 0,delete:void 0,state:void 0}}a.ProjectEvent={encode(u,m=p.Writer.create()){return u.create!==void 0&&a.ProjectCreateEvent.encode(u.create,m.uint32(10).fork()).ldelim(),u.update!==void 0&&a.ProjectUpdateEvent.encode(u.update,m.uint32(18).fork()).ldelim(),u.delete!==void 0&&a.ProjectDeleteEvent.encode(u.delete,m.uint32(26).fork()).ldelim(),u.state!==void 0&&a.ProjectBroadcastStateEvent.encode(u.state,m.uint32(34).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=yr();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.create=a.ProjectCreateEvent.decode(S,S.uint32());break;case 2:k.update=a.ProjectUpdateEvent.decode(S,S.uint32());break;case 3:k.delete=a.ProjectDeleteEvent.decode(S,S.uint32());break;case 4:k.state=a.ProjectBroadcastStateEvent.decode(S,S.uint32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{create:Q(u.create)?a.ProjectCreateEvent.fromJSON(u.create):void 0,update:Q(u.update)?a.ProjectUpdateEvent.fromJSON(u.update):void 0,delete:Q(u.delete)?a.ProjectDeleteEvent.fromJSON(u.delete):void 0,state:Q(u.state)?a.ProjectBroadcastStateEvent.fromJSON(u.state):void 0}},toJSON(u){const m={};return u.create!==void 0&&(m.create=u.create?a.ProjectCreateEvent.toJSON(u.create):void 0),u.update!==void 0&&(m.update=u.update?a.ProjectUpdateEvent.toJSON(u.update):void 0),u.delete!==void 0&&(m.delete=u.delete?a.ProjectDeleteEvent.toJSON(u.delete):void 0),u.state!==void 0&&(m.state=u.state?a.ProjectBroadcastStateEvent.toJSON(u.state):void 0),m},fromPartial(u){const m=yr();return m.create=u.create!==void 0&&u.create!==null?a.ProjectCreateEvent.fromPartial(u.create):void 0,m.update=u.update!==void 0&&u.update!==null?a.ProjectUpdateEvent.fromPartial(u.update):void 0,m.delete=u.delete!==void 0&&u.delete!==null?a.ProjectDeleteEvent.fromPartial(u.delete):void 0,m.state=u.state!==void 0&&u.state!==null?a.ProjectBroadcastStateEvent.fromPartial(u.state):void 0,m}};function br(){return{create:void 0,update:void 0,delete:void 0,add:void 0,remove:void 0,state:void 0}}a.SourceEvent={encode(u,m=p.Writer.create()){return u.create!==void 0&&a.SourceCreateEvent.encode(u.create,m.uint32(10).fork()).ldelim(),u.update!==void 0&&a.SourceUpdateEvent.encode(u.update,m.uint32(18).fork()).ldelim(),u.delete!==void 0&&a.SourceDeleteEvent.encode(u.delete,m.uint32(26).fork()).ldelim(),u.add!==void 0&&a.SourceAddEvent.encode(u.add,m.uint32(34).fork()).ldelim(),u.remove!==void 0&&a.SourceDeleteEvent.encode(u.remove,m.uint32(42).fork()).ldelim(),u.state!==void 0&&a.SourceStateEvent.encode(u.state,m.uint32(50).fork()).ldelim(),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=br();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.create=a.SourceCreateEvent.decode(S,S.uint32());break;case 2:k.update=a.SourceUpdateEvent.decode(S,S.uint32());break;case 3:k.delete=a.SourceDeleteEvent.decode(S,S.uint32());break;case 4:k.add=a.SourceAddEvent.decode(S,S.uint32());break;case 5:k.remove=a.SourceDeleteEvent.decode(S,S.uint32());break;case 6:k.state=a.SourceStateEvent.decode(S,S.uint32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{create:Q(u.create)?a.SourceCreateEvent.fromJSON(u.create):void 0,update:Q(u.update)?a.SourceUpdateEvent.fromJSON(u.update):void 0,delete:Q(u.delete)?a.SourceDeleteEvent.fromJSON(u.delete):void 0,add:Q(u.add)?a.SourceAddEvent.fromJSON(u.add):void 0,remove:Q(u.remove)?a.SourceDeleteEvent.fromJSON(u.remove):void 0,state:Q(u.state)?a.SourceStateEvent.fromJSON(u.state):void 0}},toJSON(u){const m={};return u.create!==void 0&&(m.create=u.create?a.SourceCreateEvent.toJSON(u.create):void 0),u.update!==void 0&&(m.update=u.update?a.SourceUpdateEvent.toJSON(u.update):void 0),u.delete!==void 0&&(m.delete=u.delete?a.SourceDeleteEvent.toJSON(u.delete):void 0),u.add!==void 0&&(m.add=u.add?a.SourceAddEvent.toJSON(u.add):void 0),u.remove!==void 0&&(m.remove=u.remove?a.SourceDeleteEvent.toJSON(u.remove):void 0),u.state!==void 0&&(m.state=u.state?a.SourceStateEvent.toJSON(u.state):void 0),m},fromPartial(u){const m=br();return m.create=u.create!==void 0&&u.create!==null?a.SourceCreateEvent.fromPartial(u.create):void 0,m.update=u.update!==void 0&&u.update!==null?a.SourceUpdateEvent.fromPartial(u.update):void 0,m.delete=u.delete!==void 0&&u.delete!==null?a.SourceDeleteEvent.fromPartial(u.delete):void 0,m.add=u.add!==void 0&&u.add!==null?a.SourceAddEvent.fromPartial(u.add):void 0,m.remove=u.remove!==void 0&&u.remove!==null?a.SourceDeleteEvent.fromPartial(u.remove):void 0,m.state=u.state!==void 0&&u.state!==null?a.SourceStateEvent.fromPartial(u.state):void 0,m}};function _r(){return{collection:void 0,destination:void 0,project:void 0,source:void 0,unspecified:void 0}}a.LiveEvent={encode(u,m=p.Writer.create()){return u.collection!==void 0&&a.CollectionEvent.encode(u.collection,m.uint32(10).fork()).ldelim(),u.destination!==void 0&&a.DestinationEvent.encode(u.destination,m.uint32(18).fork()).ldelim(),u.project!==void 0&&a.ProjectEvent.encode(u.project,m.uint32(26).fork()).ldelim(),u.source!==void 0&&a.SourceEvent.encode(u.source,m.uint32(34).fork()).ldelim(),u.unspecified!==void 0&&m.uint32(40).int32((0,_.nullValueToNumber)(u.unspecified)),m},decode(u,m){const S=u instanceof p.Reader?u:new p.Reader(u);let B=m===void 0?S.len:S.pos+m;const k=_r();for(;S.pos<B;){const H=S.uint32();switch(H>>>3){case 1:k.collection=a.CollectionEvent.decode(S,S.uint32());break;case 2:k.destination=a.DestinationEvent.decode(S,S.uint32());break;case 3:k.project=a.ProjectEvent.decode(S,S.uint32());break;case 4:k.source=a.SourceEvent.decode(S,S.uint32());break;case 5:k.unspecified=(0,_.nullValueFromJSON)(S.int32());break;default:S.skipType(H&7);break}}return k},fromJSON(u){return{collection:Q(u.collection)?a.CollectionEvent.fromJSON(u.collection):void 0,destination:Q(u.destination)?a.DestinationEvent.fromJSON(u.destination):void 0,project:Q(u.project)?a.ProjectEvent.fromJSON(u.project):void 0,source:Q(u.source)?a.SourceEvent.fromJSON(u.source):void 0,unspecified:Q(u.unspecified)?(0,_.nullValueFromJSON)(u.unspecified):void 0}},toJSON(u){const m={};return u.collection!==void 0&&(m.collection=u.collection?a.CollectionEvent.toJSON(u.collection):void 0),u.destination!==void 0&&(m.destination=u.destination?a.DestinationEvent.toJSON(u.destination):void 0),u.project!==void 0&&(m.project=u.project?a.ProjectEvent.toJSON(u.project):void 0),u.source!==void 0&&(m.source=u.source?a.SourceEvent.toJSON(u.source):void 0),u.unspecified!==void 0&&(m.unspecified=u.unspecified!==void 0?(0,_.nullValueToJSON)(u.unspecified):void 0),m},fromPartial(u){var m;const S=_r();return S.collection=u.collection!==void 0&&u.collection!==null?a.CollectionEvent.fromPartial(u.collection):void 0,S.destination=u.destination!==void 0&&u.destination!==null?a.DestinationEvent.fromPartial(u.destination):void 0,S.project=u.project!==void 0&&u.project!==null?a.ProjectEvent.fromPartial(u.project):void 0,S.source=u.source!==void 0&&u.source!==null?a.SourceEvent.fromPartial(u.source):void 0,S.unspecified=(m=u.unspecified)!==null&&m!==void 0?m:void 0,S}};class gr{constructor(m){this.rpc=m,this.CreateCollection=this.CreateCollection.bind(this),this.GetCollection=this.GetCollection.bind(this),this.GetCollections=this.GetCollections.bind(this),this.UpdateCollection=this.UpdateCollection.bind(this),this.DeleteCollection=this.DeleteCollection.bind(this)}CreateCollection(m){const S=a.CreateCollectionRequest.encode(m).finish();return this.rpc.request("live.v21.CollectionService","CreateCollection",S).then(k=>a.CreateCollectionResponse.decode(new p.Reader(k)))}GetCollection(m){const S=a.GetCollectionRequest.encode(m).finish();return this.rpc.request("live.v21.CollectionService","GetCollection",S).then(k=>a.GetCollectionResponse.decode(new p.Reader(k)))}GetCollections(m){const S=a.GetCollectionsRequest.encode(m).finish();return this.rpc.request("live.v21.CollectionService","GetCollections",S).then(k=>a.GetCollectionsResponse.decode(new p.Reader(k)))}UpdateCollection(m){const S=a.UpdateCollectionRequest.encode(m).finish();return this.rpc.request("live.v21.CollectionService","UpdateCollection",S).then(k=>a.UpdateCollectionResponse.decode(new p.Reader(k)))}DeleteCollection(m){const S=a.DeleteCollectionRequest.encode(m).finish();return this.rpc.request("live.v21.CollectionService","DeleteCollection",S).then(k=>a.DeleteCollectionResponse.decode(new p.Reader(k)))}}a.CollectionServiceClientImpl=gr,a.CollectionServiceDefinition={name:"CollectionService",fullName:"live.v21.CollectionService",methods:{createCollection:{name:"CreateCollection",requestType:a.CreateCollectionRequest,requestStream:!1,responseType:a.CreateCollectionResponse,responseStream:!1,options:{}},getCollection:{name:"GetCollection",requestType:a.GetCollectionRequest,requestStream:!1,responseType:a.GetCollectionResponse,responseStream:!1,options:{}},getCollections:{name:"GetCollections",requestType:a.GetCollectionsRequest,requestStream:!1,responseType:a.GetCollectionsResponse,responseStream:!1,options:{}},updateCollection:{name:"UpdateCollection",requestType:a.UpdateCollectionRequest,requestStream:!1,responseType:a.UpdateCollectionResponse,responseStream:!1,options:{}},deleteCollection:{name:"DeleteCollection",requestType:a.DeleteCollectionRequest,requestStream:!1,responseType:a.DeleteCollectionResponse,responseStream:!1,options:{}}}};class Er{constructor(m){this.rpc=m,this.CreateProject=this.CreateProject.bind(this),this.GetProject=this.GetProject.bind(this),this.DeleteProject=this.DeleteProject.bind(this),this.UpdateProject=this.UpdateProject.bind(this),this.StartProjectBroadcast=this.StartProjectBroadcast.bind(this),this.StopProjectBroadcast=this.StopProjectBroadcast.bind(this),this.StartProjectWebRtc=this.StartProjectWebRtc.bind(this),this.StopProjectWebRtc=this.StopProjectWebRtc.bind(this),this.GetProjectBroadcastSnapshot=this.GetProjectBroadcastSnapshot.bind(this),this.GetProjectBroadcastStatus=this.GetProjectBroadcastStatus.bind(this)}CreateProject(m){const S=a.CreateProjectRequest.encode(m).finish();return this.rpc.request("live.v21.ProjectService","CreateProject",S).then(k=>a.CreateProjectResponse.decode(new p.Reader(k)))}GetProject(m){const S=a.GetProjectRequest.encode(m).finish();return this.rpc.request("live.v21.ProjectService","GetProject",S).then(k=>a.GetProjectResponse.decode(new p.Reader(k)))}DeleteProject(m){const S=a.DeleteProjectRequest.encode(m).finish();return this.rpc.request("live.v21.ProjectService","DeleteProject",S).then(k=>a.DeleteProjectResponse.decode(new p.Reader(k)))}UpdateProject(m){const S=a.UpdateProjectRequest.encode(m).finish();return this.rpc.request("live.v21.ProjectService","UpdateProject",S).then(k=>a.UpdateProjectResponse.decode(new p.Reader(k)))}StartProjectBroadcast(m){const S=a.StartProjectBroadcastRequest.encode(m).finish();return this.rpc.request("live.v21.ProjectService","StartProjectBroadcast",S).then(k=>a.StartProjectBroadcastResponse.decode(new p.Reader(k)))}StopProjectBroadcast(m){const S=a.StopProjectBroadcastRequest.encode(m).finish();return this.rpc.request("live.v21.ProjectService","StopProjectBroadcast",S).then(k=>a.StopProjectBroadcastResponse.decode(new p.Reader(k)))}StartProjectWebRtc(m){const S=a.StartProjectWebRtcRequest.encode(m).finish();return this.rpc.request("live.v21.ProjectService","StartProjectWebRtc",S).then(k=>a.StartProjectWebRtcResponse.decode(new p.Reader(k)))}StopProjectWebRtc(m){const S=a.StopProjectWebRtcRequest.encode(m).finish();return this.rpc.request("live.v21.ProjectService","StopProjectWebRtc",S).then(k=>a.StopProjectWebRtcResponse.decode(new p.Reader(k)))}GetProjectBroadcastSnapshot(m){const S=a.GetProjectBroadcastSnapshotRequest.encode(m).finish();return this.rpc.request("live.v21.ProjectService","GetProjectBroadcastSnapshot",S).then(k=>a.GetProjectBroadcastSnapshotResponse.decode(new p.Reader(k)))}GetProjectBroadcastStatus(m){const S=a.GetProjectBroadcastStatusRequest.encode(m).finish();return this.rpc.request("live.v21.ProjectService","GetProjectBroadcastStatus",S).then(k=>a.GetProjectBroadcastStatusResponse.decode(new p.Reader(k)))}}a.ProjectServiceClientImpl=Er,a.ProjectServiceDefinition={name:"ProjectService",fullName:"live.v21.ProjectService",methods:{createProject:{name:"CreateProject",requestType:a.CreateProjectRequest,requestStream:!1,responseType:a.CreateProjectResponse,responseStream:!1,options:{}},getProject:{name:"GetProject",requestType:a.GetProjectRequest,requestStream:!1,responseType:a.GetProjectResponse,responseStream:!1,options:{}},deleteProject:{name:"DeleteProject",requestType:a.DeleteProjectRequest,requestStream:!1,responseType:a.DeleteProjectResponse,responseStream:!1,options:{}},updateProject:{name:"UpdateProject",requestType:a.UpdateProjectRequest,requestStream:!1,responseType:a.UpdateProjectResponse,responseStream:!1,options:{}},startProjectBroadcast:{name:"StartProjectBroadcast",requestType:a.StartProjectBroadcastRequest,requestStream:!1,responseType:a.StartProjectBroadcastResponse,responseStream:!1,options:{}},stopProjectBroadcast:{name:"StopProjectBroadcast",requestType:a.StopProjectBroadcastRequest,requestStream:!1,responseType:a.StopProjectBroadcastResponse,responseStream:!1,options:{}},startProjectWebRtc:{name:"StartProjectWebRtc",requestType:a.StartProjectWebRtcRequest,requestStream:!1,responseType:a.StartProjectWebRtcResponse,responseStream:!1,options:{}},stopProjectWebRtc:{name:"StopProjectWebRtc",requestType:a.StopProjectWebRtcRequest,requestStream:!1,responseType:a.StopProjectWebRtcResponse,responseStream:!1,options:{}},getProjectBroadcastSnapshot:{name:"GetProjectBroadcastSnapshot",requestType:a.GetProjectBroadcastSnapshotRequest,requestStream:!1,responseType:a.GetProjectBroadcastSnapshotResponse,responseStream:!1,options:{}},getProjectBroadcastStatus:{name:"GetProjectBroadcastStatus",requestType:a.GetProjectBroadcastStatusRequest,requestStream:!1,responseType:a.GetProjectBroadcastStatusResponse,responseStream:!1,options:{}}}};class Tr{constructor(m){this.rpc=m,this.CreateDestination=this.CreateDestination.bind(this),this.GetDestination=this.GetDestination.bind(this),this.UpdateDestination=this.UpdateDestination.bind(this),this.DeleteDestination=this.DeleteDestination.bind(this)}CreateDestination(m){const S=a.CreateDestinationRequest.encode(m).finish();return this.rpc.request("live.v21.DestinationService","CreateDestination",S).then(k=>a.CreateDestinationResponse.decode(new p.Reader(k)))}GetDestination(m){const S=a.GetDestinationRequest.encode(m).finish();return this.rpc.request("live.v21.DestinationService","GetDestination",S).then(k=>a.GetDestinationResponse.decode(new p.Reader(k)))}UpdateDestination(m){const S=a.UpdateDestinationRequest.encode(m).finish();return this.rpc.request("live.v21.DestinationService","UpdateDestination",S).then(k=>a.UpdateDestinationResponse.decode(new p.Reader(k)))}DeleteDestination(m){const S=a.DeleteDestinationRequest.encode(m).finish();return this.rpc.request("live.v21.DestinationService","DeleteDestination",S).then(k=>a.DeleteDestinationResponse.decode(new p.Reader(k)))}}a.DestinationServiceClientImpl=Tr,a.DestinationServiceDefinition={name:"DestinationService",fullName:"live.v21.DestinationService",methods:{createDestination:{name:"CreateDestination",requestType:a.CreateDestinationRequest,requestStream:!1,responseType:a.CreateDestinationResponse,responseStream:!1,options:{}},getDestination:{name:"GetDestination",requestType:a.GetDestinationRequest,requestStream:!1,responseType:a.GetDestinationResponse,responseStream:!1,options:{}},updateDestination:{name:"UpdateDestination",requestType:a.UpdateDestinationRequest,requestStream:!1,responseType:a.UpdateDestinationResponse,responseStream:!1,options:{}},deleteDestination:{name:"DeleteDestination",requestType:a.DeleteDestinationRequest,requestStream:!1,responseType:a.DeleteDestinationResponse,responseStream:!1,options:{}}}};class Ir{constructor(m){this.rpc=m,this.CreateSource=this.CreateSource.bind(this),this.DeleteSource=this.DeleteSource.bind(this),this.UpdateSource=this.UpdateSource.bind(this),this.UpdateSourceInProject=this.UpdateSourceInProject.bind(this),this.GetSource=this.GetSource.bind(this),this.GetSources=this.GetSources.bind(this),this.AddSourceToProject=this.AddSourceToProject.bind(this),this.RemoveSourceFromProject=this.RemoveSourceFromProject.bind(this)}CreateSource(m){const S=a.CreateSourceRequest.encode(m).finish();return this.rpc.request("live.v21.SourceService","CreateSource",S).then(k=>a.CreateSourceResponse.decode(new p.Reader(k)))}DeleteSource(m){const S=a.DeleteSourceRequest.encode(m).finish();return this.rpc.request("live.v21.SourceService","DeleteSource",S).then(k=>a.DeleteSourceResponse.decode(new p.Reader(k)))}UpdateSource(m){const S=a.UpdateSourceRequest.encode(m).finish();return this.rpc.request("live.v21.SourceService","UpdateSource",S).then(k=>a.UpdateSourceResponse.decode(new p.Reader(k)))}UpdateSourceInProject(m){const S=a.UpdateSourceInProjectRequest.encode(m).finish();return this.rpc.request("live.v21.SourceService","UpdateSourceInProject",S).then(k=>a.UpdateSourceInProjectResponse.decode(new p.Reader(k)))}GetSource(m){const S=a.GetSourceRequest.encode(m).finish();return this.rpc.request("live.v21.SourceService","GetSource",S).then(k=>a.GetSourceResponse.decode(new p.Reader(k)))}GetSources(m){const S=a.GetSourcesRequest.encode(m).finish();return this.rpc.request("live.v21.SourceService","GetSources",S).then(k=>a.GetSourcesResponse.decode(new p.Reader(k)))}AddSourceToProject(m){const S=a.AddSourceToProjectRequest.encode(m).finish();return this.rpc.request("live.v21.SourceService","AddSourceToProject",S).then(k=>a.AddSourceToProjectResponse.decode(new p.Reader(k)))}RemoveSourceFromProject(m){const S=a.RemoveSourceFromProjectRequest.encode(m).finish();return this.rpc.request("live.v21.SourceService","RemoveSourceFromProject",S).then(k=>a.RemoveSourceFromProjectResponse.decode(new p.Reader(k)))}}a.SourceServiceClientImpl=Ir,a.SourceServiceDefinition={name:"SourceService",fullName:"live.v21.SourceService",methods:{createSource:{name:"CreateSource",requestType:a.CreateSourceRequest,requestStream:!1,responseType:a.CreateSourceResponse,responseStream:!1,options:{}},deleteSource:{name:"DeleteSource",requestType:a.DeleteSourceRequest,requestStream:!1,responseType:a.DeleteSourceResponse,responseStream:!1,options:{}},updateSource:{name:"UpdateSource",requestType:a.UpdateSourceRequest,requestStream:!1,responseType:a.UpdateSourceResponse,responseStream:!1,options:{}},updateSourceInProject:{name:"UpdateSourceInProject",requestType:a.UpdateSourceInProjectRequest,requestStream:!1,responseType:a.UpdateSourceInProjectResponse,responseStream:!1,options:{}},getSource:{name:"GetSource",requestType:a.GetSourceRequest,requestStream:!1,responseType:a.GetSourceResponse,responseStream:!1,options:{}},getSources:{name:"GetSources",requestType:a.GetSourcesRequest,requestStream:!1,responseType:a.GetSourcesResponse,responseStream:!1,options:{}},addSourceToProject:{name:"AddSourceToProject",requestType:a.AddSourceToProjectRequest,requestStream:!1,responseType:a.AddSourceToProjectResponse,responseStream:!1,options:{}},removeSourceFromProject:{name:"RemoveSourceFromProject",requestType:a.RemoveSourceFromProjectRequest,requestStream:!1,responseType:a.RemoveSourceFromProjectResponse,responseStream:!1,options:{}}}};class Or{constructor(m){this.rpc=m,this.CreateAccessToken=this.CreateAccessToken.bind(this)}CreateAccessToken(m){const S=a.CreateAccessTokenRequest.encode(m).finish();return this.rpc.request("live.v21.BackendAuthenticationService","CreateAccessToken",S).then(k=>a.CreateAccessTokenResponse.decode(new p.Reader(k)))}}a.BackendAuthenticationServiceClientImpl=Or,a.BackendAuthenticationServiceDefinition={name:"BackendAuthenticationService",fullName:"live.v21.BackendAuthenticationService",methods:{createAccessToken:{name:"CreateAccessToken",requestType:a.CreateAccessTokenRequest,requestStream:!1,responseType:a.CreateAccessTokenResponse,responseStream:!1,options:{}}}};class kr{constructor(m){this.rpc=m,this.CreateGuestAccessToken=this.CreateGuestAccessToken.bind(this),this.RefreshAccessToken=this.RefreshAccessToken.bind(this),this.CreateWebRtcAccessToken=this.CreateWebRtcAccessToken.bind(this)}CreateGuestAccessToken(m){const S=a.CreateGuestAccessTokenRequest.encode(m).finish();return this.rpc.request("live.v21.AuthenticationService","CreateGuestAccessToken",S).then(k=>a.CreateGuestAccessTokenResponse.decode(new p.Reader(k)))}RefreshAccessToken(m){const S=a.RefreshAccessTokenRequest.encode(m).finish();return this.rpc.request("live.v21.AuthenticationService","RefreshAccessToken",S).then(k=>a.RefreshAccessTokenResponse.decode(new p.Reader(k)))}CreateWebRtcAccessToken(m){const S=a.CreateWebRtcAccessTokenRequest.encode(m).finish();return this.rpc.request("live.v21.AuthenticationService","CreateWebRtcAccessToken",S).then(k=>a.CreateWebRtcAccessTokenResponse.decode(new p.Reader(k)))}}a.AuthenticationServiceClientImpl=kr,a.AuthenticationServiceDefinition={name:"AuthenticationService",fullName:"live.v21.AuthenticationService",methods:{createGuestAccessToken:{name:"CreateGuestAccessToken",requestType:a.CreateGuestAccessTokenRequest,requestStream:!1,responseType:a.CreateGuestAccessTokenResponse,responseStream:!1,options:{}},refreshAccessToken:{name:"RefreshAccessToken",requestType:a.RefreshAccessTokenRequest,requestStream:!1,responseType:a.RefreshAccessTokenResponse,responseStream:!1,options:{}},createWebRtcAccessToken:{name:"CreateWebRtcAccessToken",requestType:a.CreateWebRtcAccessTokenRequest,requestStream:!1,responseType:a.CreateWebRtcAccessTokenResponse,responseStream:!1,options:{}}}};class Rr{constructor(m){this.rpc=m,this.GetJsonWebKeySet=this.GetJsonWebKeySet.bind(this),this.GuestCodeRedirect=this.GuestCodeRedirect.bind(this)}GetJsonWebKeySet(m){const S=a.GetJsonWebKeySetRequest.encode(m).finish();return this.rpc.request("live.v21.PublicAuthenticationService","GetJsonWebKeySet",S).then(k=>a.GetJsonWebKeySetResponse.decode(new p.Reader(k)))}GuestCodeRedirect(m){const S=a.GuestCodeRedirectRequest.encode(m).finish();return this.rpc.request("live.v21.PublicAuthenticationService","GuestCodeRedirect",S).then(k=>a.GuestCodeRedirectResponse.decode(new p.Reader(k)))}}a.PublicAuthenticationServiceClientImpl=Rr,a.PublicAuthenticationServiceDefinition={name:"PublicAuthenticationService",fullName:"live.v21.PublicAuthenticationService",methods:{getJsonWebKeySet:{name:"GetJsonWebKeySet",requestType:a.GetJsonWebKeySetRequest,requestStream:!1,responseType:a.GetJsonWebKeySetResponse,responseStream:!1,options:{}},guestCodeRedirect:{name:"GuestCodeRedirect",requestType:a.GuestCodeRedirectRequest,requestStream:!1,responseType:a.GuestCodeRedirectResponse,responseStream:!1,options:{}}}};var Ve=(()=>{if(typeof Ve!="undefined")return Ve;if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof commonjsGlobal!="undefined")return commonjsGlobal;throw"Unable to locate global object"})();const Cr=Ve.atob||(u=>Ve.Buffer.from(u,"base64").toString("binary"));function Pr(u){const m=Cr(u),S=new Uint8Array(m.length);for(let B=0;B<m.length;++B)S[B]=m.charCodeAt(B);return S}const Nr=Ve.btoa||(u=>Ve.Buffer.from(u,"binary").toString("base64"));function Ar(u){const m=[];return u.forEach(S=>{m.push(String.fromCharCode(S))}),Nr(m.join(""))}function st(u){const m=new Date(u),S=m.getTime()/1e3,B=m.getTime()%1e3*1e6;return{seconds:S,nanos:B}}function dt(u){let m=u.seconds*1e3;return m+=u.nanos/1e6,new Date(m).toISOString()}p.util.Long!==h.default&&(p.util.Long=h.default,p.configure());function Q(u){return u!=null}}(api$1),function(a){var s=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(C,A,q,U){U===void 0&&(U=q);var F=Object.getOwnPropertyDescriptor(A,q);(!F||("get"in F?!A.__esModule:F.writable||F.configurable))&&(F={enumerable:!0,get:function(){return A[q]}}),Object.defineProperty(C,U,F)}:function(C,A,q,U){U===void 0&&(U=q),C[U]=A[q]}),d=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(C,A){Object.defineProperty(C,"default",{enumerable:!0,value:A})}:function(C,A){C.default=A}),c=commonjsGlobal&&commonjsGlobal.__decorate||function(C,A,q,U){var F=arguments.length,j=F<3?A:U===null?U=Object.getOwnPropertyDescriptor(A,q):U,T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")j=Reflect.decorate(C,A,q,U);else for(var D=C.length-1;D>=0;D--)(T=C[D])&&(j=(F<3?T(j):F>3?T(A,q,j):T(A,q))||j);return F>3&&j&&Object.defineProperty(A,q,j),j},l=commonjsGlobal&&commonjsGlobal.__importStar||function(C){if(C&&C.__esModule)return C;var A={};if(C!=null)for(var q in C)q!=="default"&&Object.prototype.hasOwnProperty.call(C,q)&&s(A,C,q);return d(A,C),A},h=commonjsGlobal&&commonjsGlobal.__metadata||function(C,A){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(C,A)};Object.defineProperty(a,"__esModule",{value:!0}),a.LiveApi=void 0;const p=l(lib$1),y=api$2,_=l(api$1),E=decorator,O="LiveApi";class P extends y.ApiClient{constructor(A,q,U,F,j,T,D){super(A,U,T,O,D),this.handlers={},this.eventApi=q,this.accessTokenRefreshCallback=F,this.publicAuthentication=this.clientFactory.create(_.PublicAuthenticationServiceDefinition,this.channel),j!=null&&(this.backendAuthentication=this.clientFactory.create(_.BackendAuthenticationServiceDefinition,this.channel,{"*":{metadata:p.Metadata({"X-Api-Key":j})}})),this.eventApi.on("event",{name:`${P.LIVEAPI_EVENT_PREFIX}:*`,ignoreSessionEvents:!0,allowedSessionEvents:[`${P.LIVEAPI_EVENT_PREFIX}:EVENT_TYPE_PROJECT:EVENT_SUB_TYPE_STATE`]},this.eventCallback.bind(this))}on(A,q){var U;this.handlers[A]=(U=this.handlers[A])!==null&&U!==void 0?U:[],this.handlers[A].push(q)}off(A,q){this.handlers[A]=this.handlers[A].filter(U=>U!==q)}emitToHandlers(A,q,U){var F;for(const j of(F=this.handlers[A])!==null&&F!==void 0?F:[])j(Object.values(U).find(T=>!!T),q)}async subscribeToCollection(A){await this.eventApi.subscribe(`${P.LIVEAPI_EVENT_PREFIX}:*`,{target:{collectionId:A}})}async unsubscribeFromCollection(A){await this.eventApi.unsubscribe(`${P.LIVEAPI_EVENT_PREFIX}:*`,{target:{collectionId:A}})}async subscribeToProject(A,q){await this.eventApi.subscribe(`${P.LIVEAPI_EVENT_PREFIX}:*`,{target:{collectionId:A,projectId:q}})}async unsubscribeFromProject(A,q){await this.eventApi.unsubscribe(`${P.LIVEAPI_EVENT_PREFIX}:*`,{target:{collectionId:A,projectId:q}})}eventCallback(A){let U=A.name.split(`${P.LIVEAPI_EVENT_PREFIX}:`)[1].split(":"),F=_.eventTypeFromJSON(U[0]),j=_.eventSubTypeFromJSON(U[1]);this.log.info("processing event: "+F+"/"+j),P.liveApiEventMap[F]&&this.emitToHandlers(F,j,A.payload)}_setup(A){let q=this;A.onHeader=function(U){let F=U.get("Authorization");if(F!=null){const j=F.split(" ");if(j.length==2&&j[0]=="Bearer"){let T=j[1];q.log.info("received refresh token"),q.accessTokenRefreshCallback(T)}}},this.collection=this.clientFactory.create(_.CollectionServiceDefinition,this.channel,{"*":A}),this.project=this.clientFactory.create(_.ProjectServiceDefinition,this.channel,{"*":A}),this.source=this.clientFactory.create(_.SourceServiceDefinition,this.channel,{"*":A}),this.destination=this.clientFactory.create(_.DestinationServiceDefinition,this.channel,{"*":A}),this.authentication=this.clientFactory.create(_.AuthenticationServiceDefinition,this.channel,{"*":A})}}P.LIVEAPI_EVENT_PREFIX="apistream:live",c([(0,E.RequiresSdkAuthentication)(),h("design:type",Object)],P.prototype,"collection",void 0),c([(0,E.RequiresSdkAuthentication)(),h("design:type",Object)],P.prototype,"project",void 0),c([(0,E.RequiresSdkAuthentication)(),h("design:type",Object)],P.prototype,"source",void 0),c([(0,E.RequiresSdkAuthentication)(),h("design:type",Object)],P.prototype,"destination",void 0),c([(0,E.RequiresSdkAuthentication)(),h("design:type",Object)],P.prototype,"authentication",void 0),a.LiveApi=P,function(C){C.liveApiEventMap={[_.EventType.EVENT_TYPE_COLLECTION]:"collection",[_.EventType.EVENT_TYPE_PROJECT]:"project",[_.EventType.EVENT_TYPE_SOURCE]:"source",[_.EventType.EVENT_TYPE_DESTINATION]:"destination",[_.EventType.EVENT_TYPE_UNSPECIFIED]:"unspecified"}}(P=a.LiveApi||(a.LiveApi={}))}(liveapi);var eventapi={},dist$2={},api={};/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */var extendStatics=function(a,s){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,c){d.__proto__=c}||function(d,c){for(var l in c)c.hasOwnProperty(l)&&(d[l]=c[l])},extendStatics(a,s)};function __extends(a,s){extendStatics(a,s);function d(){this.constructor=a}a.prototype=s===null?Object.create(s):(d.prototype=s.prototype,new d)}function isFunction$1(a){return typeof a=="function"}var _enable_super_gross_mode_that_will_cause_bad_things=!1,config$2={Promise:void 0,set useDeprecatedSynchronousErrorHandling(a){if(a){var s=new Error;""+s.stack}_enable_super_gross_mode_that_will_cause_bad_things=a},get useDeprecatedSynchronousErrorHandling(){return _enable_super_gross_mode_that_will_cause_bad_things}};function hostReportError(a){setTimeout(function(){throw a},0)}var empty$2={closed:!0,next:function(a){},error:function(a){if(config$2.useDeprecatedSynchronousErrorHandling)throw a;hostReportError(a)},complete:function(){}},isArray$2=function(){return Array.isArray||function(a){return a&&typeof a.length=="number"}}();function isObject$4(a){return a!==null&&typeof a=="object"}var UnsubscriptionErrorImpl=function(){function a(s){return Error.call(this),this.message=s?s.length+` errors occurred during unsubscription:
`+s.map(function(d,c){return c+1+") "+d.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=s,this}return a.prototype=Object.create(Error.prototype),a}(),UnsubscriptionError=UnsubscriptionErrorImpl,Subscription=function(){function a(s){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,s&&(this._ctorUnsubscribe=!0,this._unsubscribe=s)}return a.prototype.unsubscribe=function(){var s;if(!this.closed){var d=this,c=d._parentOrParents,l=d._ctorUnsubscribe,h=d._unsubscribe,p=d._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,c instanceof a)c.remove(this);else if(c!==null)for(var y=0;y<c.length;++y){var _=c[y];_.remove(this)}if(isFunction$1(h)){l&&(this._unsubscribe=void 0);try{h.call(this)}catch(P){s=P instanceof UnsubscriptionError?flattenUnsubscriptionErrors(P.errors):[P]}}if(isArray$2(p))for(var y=-1,E=p.length;++y<E;){var O=p[y];if(isObject$4(O))try{O.unsubscribe()}catch(C){s=s||[],C instanceof UnsubscriptionError?s=s.concat(flattenUnsubscriptionErrors(C.errors)):s.push(C)}}if(s)throw new UnsubscriptionError(s)}},a.prototype.add=function(s){var d=s;if(!s)return a.EMPTY;switch(typeof s){case"function":d=new a(s);case"object":if(d===this||d.closed||typeof d.unsubscribe!="function")return d;if(this.closed)return d.unsubscribe(),d;if(!(d instanceof a)){var c=d;d=new a,d._subscriptions=[c]}break;default:throw new Error("unrecognized teardown "+s+" added to Subscription.")}var l=d._parentOrParents;if(l===null)d._parentOrParents=this;else if(l instanceof a){if(l===this)return d;d._parentOrParents=[l,this]}else if(l.indexOf(this)===-1)l.push(this);else return d;var h=this._subscriptions;return h===null?this._subscriptions=[d]:h.push(d),d},a.prototype.remove=function(s){var d=this._subscriptions;if(d){var c=d.indexOf(s);c!==-1&&d.splice(c,1)}},a.EMPTY=function(s){return s.closed=!0,s}(new a),a}();function flattenUnsubscriptionErrors(a){return a.reduce(function(s,d){return s.concat(d instanceof UnsubscriptionError?d.errors:d)},[])}var rxSubscriber=function(){return typeof Symbol=="function"?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),Subscriber=function(a){__extends(s,a);function s(d,c,l){var h=a.call(this)||this;switch(h.syncErrorValue=null,h.syncErrorThrown=!1,h.syncErrorThrowable=!1,h.isStopped=!1,arguments.length){case 0:h.destination=empty$2;break;case 1:if(!d){h.destination=empty$2;break}if(typeof d=="object"){d instanceof s?(h.syncErrorThrowable=d.syncErrorThrowable,h.destination=d,d.add(h)):(h.syncErrorThrowable=!0,h.destination=new SafeSubscriber(h,d));break}default:h.syncErrorThrowable=!0,h.destination=new SafeSubscriber(h,d,c,l);break}return h}return s.prototype[rxSubscriber]=function(){return this},s.create=function(d,c,l){var h=new s(d,c,l);return h.syncErrorThrowable=!1,h},s.prototype.next=function(d){this.isStopped||this._next(d)},s.prototype.error=function(d){this.isStopped||(this.isStopped=!0,this._error(d))},s.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},s.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,a.prototype.unsubscribe.call(this))},s.prototype._next=function(d){this.destination.next(d)},s.prototype._error=function(d){this.destination.error(d),this.unsubscribe()},s.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},s.prototype._unsubscribeAndRecycle=function(){var d=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=d,this},s}(Subscription),SafeSubscriber=function(a){__extends(s,a);function s(d,c,l,h){var p=a.call(this)||this;p._parentSubscriber=d;var y,_=p;return isFunction$1(c)?y=c:c&&(y=c.next,l=c.error,h=c.complete,c!==empty$2&&(_=Object.create(c),isFunction$1(_.unsubscribe)&&p.add(_.unsubscribe.bind(_)),_.unsubscribe=p.unsubscribe.bind(p))),p._context=_,p._next=y,p._error=l,p._complete=h,p}return s.prototype.next=function(d){if(!this.isStopped&&this._next){var c=this._parentSubscriber;!config$2.useDeprecatedSynchronousErrorHandling||!c.syncErrorThrowable?this.__tryOrUnsub(this._next,d):this.__tryOrSetError(c,this._next,d)&&this.unsubscribe()}},s.prototype.error=function(d){if(!this.isStopped){var c=this._parentSubscriber,l=config$2.useDeprecatedSynchronousErrorHandling;if(this._error)!l||!c.syncErrorThrowable?(this.__tryOrUnsub(this._error,d),this.unsubscribe()):(this.__tryOrSetError(c,this._error,d),this.unsubscribe());else if(c.syncErrorThrowable)l?(c.syncErrorValue=d,c.syncErrorThrown=!0):hostReportError(d),this.unsubscribe();else{if(this.unsubscribe(),l)throw d;hostReportError(d)}}},s.prototype.complete=function(){var d=this;if(!this.isStopped){var c=this._parentSubscriber;if(this._complete){var l=function(){return d._complete.call(d._context)};!config$2.useDeprecatedSynchronousErrorHandling||!c.syncErrorThrowable?(this.__tryOrUnsub(l),this.unsubscribe()):(this.__tryOrSetError(c,l),this.unsubscribe())}else this.unsubscribe()}},s.prototype.__tryOrUnsub=function(d,c){try{d.call(this._context,c)}catch(l){if(this.unsubscribe(),config$2.useDeprecatedSynchronousErrorHandling)throw l;hostReportError(l)}},s.prototype.__tryOrSetError=function(d,c,l){if(!config$2.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{c.call(this._context,l)}catch(h){return config$2.useDeprecatedSynchronousErrorHandling?(d.syncErrorValue=h,d.syncErrorThrown=!0,!0):(hostReportError(h),!0)}return!1},s.prototype._unsubscribe=function(){var d=this._parentSubscriber;this._context=null,this._parentSubscriber=null,d.unsubscribe()},s}(Subscriber);function canReportError(a){for(;a;){var s=a,d=s.closed,c=s.destination,l=s.isStopped;if(d||l)return!1;c&&c instanceof Subscriber?a=c:a=null}return!0}function toSubscriber(a,s,d){if(a){if(a instanceof Subscriber)return a;if(a[rxSubscriber])return a[rxSubscriber]()}return!a&&!s&&!d?new Subscriber(empty$2):new Subscriber(a,s,d)}var observable=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function identity(a){return a}function pipe(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];return pipeFromArray(a)}function pipeFromArray(a){return a.length===0?identity:a.length===1?a[0]:function(d){return a.reduce(function(c,l){return l(c)},d)}}var Observable=function(){function a(s){this._isScalar=!1,s&&(this._subscribe=s)}return a.prototype.lift=function(s){var d=new a;return d.source=this,d.operator=s,d},a.prototype.subscribe=function(s,d,c){var l=this.operator,h=toSubscriber(s,d,c);if(l?h.add(l.call(h,this.source)):h.add(this.source||config$2.useDeprecatedSynchronousErrorHandling&&!h.syncErrorThrowable?this._subscribe(h):this._trySubscribe(h)),config$2.useDeprecatedSynchronousErrorHandling&&h.syncErrorThrowable&&(h.syncErrorThrowable=!1,h.syncErrorThrown))throw h.syncErrorValue;return h},a.prototype._trySubscribe=function(s){try{return this._subscribe(s)}catch(d){config$2.useDeprecatedSynchronousErrorHandling&&(s.syncErrorThrown=!0,s.syncErrorValue=d),canReportError(s)?s.error(d):console.warn(d)}},a.prototype.forEach=function(s,d){var c=this;return d=getPromiseCtor(d),new d(function(l,h){var p;p=c.subscribe(function(y){try{s(y)}catch(_){h(_),p&&p.unsubscribe()}},h,l)})},a.prototype._subscribe=function(s){var d=this.source;return d&&d.subscribe(s)},a.prototype[observable]=function(){return this},a.prototype.pipe=function(){for(var s=[],d=0;d<arguments.length;d++)s[d]=arguments[d];return s.length===0?this:pipeFromArray(s)(this)},a.prototype.toPromise=function(s){var d=this;return s=getPromiseCtor(s),new s(function(c,l){var h;d.subscribe(function(p){return h=p},function(p){return l(p)},function(){return c(h)})})},a.create=function(s){return new a(s)},a}();function getPromiseCtor(a){if(a||(a=config$2.Promise||Promise),!a)throw new Error("no Promise impl found");return a}var subscribeToArray=function(a){return function(s){for(var d=0,c=a.length;d<c&&!s.closed;d++)s.next(a[d]);s.complete()}},subscribeToPromise=function(a){return function(s){return a.then(function(d){s.closed||(s.next(d),s.complete())},function(d){return s.error(d)}).then(null,hostReportError),s}};function getSymbolIterator(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var iterator=getSymbolIterator(),subscribeToIterable=function(a){return function(s){var d=a[iterator]();do{var c=void 0;try{c=d.next()}catch(l){return s.error(l),s}if(c.done){s.complete();break}if(s.next(c.value),s.closed)break}while(!0);return typeof d.return=="function"&&s.add(function(){d.return&&d.return()}),s}},subscribeToObservable=function(a){return function(s){var d=a[observable]();if(typeof d.subscribe!="function")throw new TypeError("Provided object does not correctly implement Symbol.observable");return d.subscribe(s)}},isArrayLike=function(a){return a&&typeof a.length=="number"&&typeof a!="function"};function isPromise(a){return!!a&&typeof a.subscribe!="function"&&typeof a.then=="function"}var subscribeTo=function(a){if(!!a&&typeof a[observable]=="function")return subscribeToObservable(a);if(isArrayLike(a))return subscribeToArray(a);if(isPromise(a))return subscribeToPromise(a);if(!!a&&typeof a[iterator]=="function")return subscribeToIterable(a);var s=isObject$4(a)?"an invalid object":"'"+a+"'",d="You provided "+s+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.";throw new TypeError(d)},SimpleInnerSubscriber=function(a){__extends(s,a);function s(d){var c=a.call(this)||this;return c.parent=d,c}return s.prototype._next=function(d){this.parent.notifyNext(d)},s.prototype._error=function(d){this.parent.notifyError(d),this.unsubscribe()},s.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},s}(Subscriber),SimpleOuterSubscriber=function(a){__extends(s,a);function s(){return a!==null&&a.apply(this,arguments)||this}return s.prototype.notifyNext=function(d){this.destination.next(d)},s.prototype.notifyError=function(d){this.destination.error(d)},s.prototype.notifyComplete=function(){this.destination.complete()},s}(Subscriber);function innerSubscribe(a,s){if(!s.closed){if(a instanceof Observable)return a.subscribe(s);var d;try{d=subscribeTo(a)(s)}catch(c){s.error(c)}return d}}function audit(a){return function(d){return d.lift(new AuditOperator(a))}}var AuditOperator=function(){function a(s){this.durationSelector=s}return a.prototype.call=function(s,d){return d.subscribe(new AuditSubscriber(s,this.durationSelector))},a}(),AuditSubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.durationSelector=c,l.hasValue=!1,l}return s.prototype._next=function(d){if(this.value=d,this.hasValue=!0,!this.throttled){var c=void 0;try{var l=this.durationSelector;c=l(d)}catch(p){return this.destination.error(p)}var h=innerSubscribe(c,new SimpleInnerSubscriber(this));!h||h.closed?this.clearThrottle():this.add(this.throttled=h)}},s.prototype.clearThrottle=function(){var d=this,c=d.value,l=d.hasValue,h=d.throttled;h&&(this.remove(h),this.throttled=void 0,h.unsubscribe()),l&&(this.value=void 0,this.hasValue=!1,this.destination.next(c))},s.prototype.notifyNext=function(){this.clearThrottle()},s.prototype.notifyComplete=function(){this.clearThrottle()},s}(SimpleOuterSubscriber),Action=function(a){__extends(s,a);function s(d,c){return a.call(this)||this}return s.prototype.schedule=function(d,c){return this},s}(Subscription),AsyncAction=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d,c)||this;return l.scheduler=d,l.work=c,l.pending=!1,l}return s.prototype.schedule=function(d,c){if(c===void 0&&(c=0),this.closed)return this;this.state=d;var l=this.id,h=this.scheduler;return l!=null&&(this.id=this.recycleAsyncId(h,l,c)),this.pending=!0,this.delay=c,this.id=this.id||this.requestAsyncId(h,this.id,c),this},s.prototype.requestAsyncId=function(d,c,l){return l===void 0&&(l=0),setInterval(d.flush.bind(d,this),l)},s.prototype.recycleAsyncId=function(d,c,l){if(l===void 0&&(l=0),l!==null&&this.delay===l&&this.pending===!1)return c;clearInterval(c)},s.prototype.execute=function(d,c){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var l=this._execute(d,c);if(l)return l;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},s.prototype._execute=function(d,c){var l=!1,h=void 0;try{this.work(d)}catch(p){l=!0,h=!!p&&p||new Error(p)}if(l)return this.unsubscribe(),h},s.prototype._unsubscribe=function(){var d=this.id,c=this.scheduler,l=c.actions,h=l.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,h!==-1&&l.splice(h,1),d!=null&&(this.id=this.recycleAsyncId(c,d,null)),this.delay=null},s}(Action),Scheduler=function(){function a(s,d){d===void 0&&(d=a.now),this.SchedulerAction=s,this.now=d}return a.prototype.schedule=function(s,d,c){return d===void 0&&(d=0),new this.SchedulerAction(this,s).schedule(c,d)},a.now=function(){return Date.now()},a}(),AsyncScheduler=function(a){__extends(s,a);function s(d,c){c===void 0&&(c=Scheduler.now);var l=a.call(this,d,function(){return s.delegate&&s.delegate!==l?s.delegate.now():c()})||this;return l.actions=[],l.active=!1,l.scheduled=void 0,l}return s.prototype.schedule=function(d,c,l){return c===void 0&&(c=0),s.delegate&&s.delegate!==this?s.delegate.schedule(d,c,l):a.prototype.schedule.call(this,d,c,l)},s.prototype.flush=function(d){var c=this.actions;if(this.active){c.push(d);return}var l;this.active=!0;do if(l=d.execute(d.state,d.delay))break;while(d=c.shift());if(this.active=!1,l){for(;d=c.shift();)d.unsubscribe();throw l}},s}(Scheduler),asyncScheduler=new AsyncScheduler(AsyncAction),async=asyncScheduler;function isNumeric(a){return!isArray$2(a)&&a-parseFloat(a)+1>=0}function isScheduler(a){return a&&typeof a.schedule=="function"}function timer(a,s,d){a===void 0&&(a=0);var c=-1;return isNumeric(s)?c=Number(s)<1&&1||Number(s):isScheduler(s)&&(d=s),isScheduler(d)||(d=async),new Observable(function(l){var h=isNumeric(a)?a:+a-d.now();return d.schedule(dispatch$1,h,{index:0,period:c,subscriber:l})})}function dispatch$1(a){var s=a.index,d=a.period,c=a.subscriber;if(c.next(s),!c.closed){if(d===-1)return c.complete();a.index=s+1,this.schedule(a,d)}}function auditTime(a,s){return s===void 0&&(s=async),audit(function(){return timer(a,s)})}function buffer(a){return function(d){return d.lift(new BufferOperator(a))}}var BufferOperator=function(){function a(s){this.closingNotifier=s}return a.prototype.call=function(s,d){return d.subscribe(new BufferSubscriber(s,this.closingNotifier))},a}(),BufferSubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.buffer=[],l.add(innerSubscribe(c,new SimpleInnerSubscriber(l))),l}return s.prototype._next=function(d){this.buffer.push(d)},s.prototype.notifyNext=function(){var d=this.buffer;this.buffer=[],this.destination.next(d)},s}(SimpleOuterSubscriber);function bufferCount(a,s){return s===void 0&&(s=null),function(c){return c.lift(new BufferCountOperator(a,s))}}var BufferCountOperator=function(){function a(s,d){this.bufferSize=s,this.startBufferEvery=d,!d||s===d?this.subscriberClass=BufferCountSubscriber:this.subscriberClass=BufferSkipCountSubscriber}return a.prototype.call=function(s,d){return d.subscribe(new this.subscriberClass(s,this.bufferSize,this.startBufferEvery))},a}(),BufferCountSubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.bufferSize=c,l.buffer=[],l}return s.prototype._next=function(d){var c=this.buffer;c.push(d),c.length==this.bufferSize&&(this.destination.next(c),this.buffer=[])},s.prototype._complete=function(){var d=this.buffer;d.length>0&&this.destination.next(d),a.prototype._complete.call(this)},s}(Subscriber),BufferSkipCountSubscriber=function(a){__extends(s,a);function s(d,c,l){var h=a.call(this,d)||this;return h.bufferSize=c,h.startBufferEvery=l,h.buffers=[],h.count=0,h}return s.prototype._next=function(d){var c=this,l=c.bufferSize,h=c.startBufferEvery,p=c.buffers,y=c.count;this.count++,y%h===0&&p.push([]);for(var _=p.length;_--;){var E=p[_];E.push(d),E.length===l&&(p.splice(_,1),this.destination.next(E))}},s.prototype._complete=function(){for(var d=this,c=d.buffers,l=d.destination;c.length>0;){var h=c.shift();h.length>0&&l.next(h)}a.prototype._complete.call(this)},s}(Subscriber);function bufferTime(a){var s=arguments.length,d=async;isScheduler(arguments[arguments.length-1])&&(d=arguments[arguments.length-1],s--);var c=null;s>=2&&(c=arguments[1]);var l=Number.POSITIVE_INFINITY;return s>=3&&(l=arguments[2]),function(p){return p.lift(new BufferTimeOperator(a,c,l,d))}}var BufferTimeOperator=function(){function a(s,d,c,l){this.bufferTimeSpan=s,this.bufferCreationInterval=d,this.maxBufferSize=c,this.scheduler=l}return a.prototype.call=function(s,d){return d.subscribe(new BufferTimeSubscriber(s,this.bufferTimeSpan,this.bufferCreationInterval,this.maxBufferSize,this.scheduler))},a}(),Context=function(){function a(){this.buffer=[]}return a}(),BufferTimeSubscriber=function(a){__extends(s,a);function s(d,c,l,h,p){var y=a.call(this,d)||this;y.bufferTimeSpan=c,y.bufferCreationInterval=l,y.maxBufferSize=h,y.scheduler=p,y.contexts=[];var _=y.openContext();if(y.timespanOnly=l==null||l<0,y.timespanOnly){var E={subscriber:y,context:_,bufferTimeSpan:c};y.add(_.closeAction=p.schedule(dispatchBufferTimeSpanOnly,c,E))}else{var O={subscriber:y,context:_},P={bufferTimeSpan:c,bufferCreationInterval:l,subscriber:y,scheduler:p};y.add(_.closeAction=p.schedule(dispatchBufferClose,c,O)),y.add(p.schedule(dispatchBufferCreation,l,P))}return y}return s.prototype._next=function(d){for(var c=this.contexts,l=c.length,h,p=0;p<l;p++){var y=c[p],_=y.buffer;_.push(d),_.length==this.maxBufferSize&&(h=y)}h&&this.onBufferFull(h)},s.prototype._error=function(d){this.contexts.length=0,a.prototype._error.call(this,d)},s.prototype._complete=function(){for(var d=this,c=d.contexts,l=d.destination;c.length>0;){var h=c.shift();l.next(h.buffer)}a.prototype._complete.call(this)},s.prototype._unsubscribe=function(){this.contexts=null},s.prototype.onBufferFull=function(d){this.closeContext(d);var c=d.closeAction;if(c.unsubscribe(),this.remove(c),!this.closed&&this.timespanOnly){d=this.openContext();var l=this.bufferTimeSpan,h={subscriber:this,context:d,bufferTimeSpan:l};this.add(d.closeAction=this.scheduler.schedule(dispatchBufferTimeSpanOnly,l,h))}},s.prototype.openContext=function(){var d=new Context;return this.contexts.push(d),d},s.prototype.closeContext=function(d){this.destination.next(d.buffer);var c=this.contexts,l=c?c.indexOf(d):-1;l>=0&&c.splice(c.indexOf(d),1)},s}(Subscriber);function dispatchBufferTimeSpanOnly(a){var s=a.subscriber,d=a.context;d&&s.closeContext(d),s.closed||(a.context=s.openContext(),a.context.closeAction=this.schedule(a,a.bufferTimeSpan))}function dispatchBufferCreation(a){var s=a.bufferCreationInterval,d=a.bufferTimeSpan,c=a.subscriber,l=a.scheduler,h=c.openContext(),p=this;c.closed||(c.add(h.closeAction=l.schedule(dispatchBufferClose,d,{subscriber:c,context:h})),p.schedule(a,s))}function dispatchBufferClose(a){var s=a.subscriber,d=a.context;s.closeContext(d)}var InnerSubscriber=function(a){__extends(s,a);function s(d,c,l){var h=a.call(this)||this;return h.parent=d,h.outerValue=c,h.outerIndex=l,h.index=0,h}return s.prototype._next=function(d){this.parent.notifyNext(this.outerValue,d,this.outerIndex,this.index++,this)},s.prototype._error=function(d){this.parent.notifyError(d,this),this.unsubscribe()},s.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},s}(Subscriber);function subscribeToResult(a,s,d,c,l){if(l===void 0&&(l=new InnerSubscriber(a,d,c)),!l.closed)return s instanceof Observable?s.subscribe(l):subscribeTo(s)(l)}var OuterSubscriber=function(a){__extends(s,a);function s(){return a!==null&&a.apply(this,arguments)||this}return s.prototype.notifyNext=function(d,c,l,h,p){this.destination.next(c)},s.prototype.notifyError=function(d,c){this.destination.error(d)},s.prototype.notifyComplete=function(d){this.destination.complete()},s}(Subscriber);function bufferToggle(a,s){return function(c){return c.lift(new BufferToggleOperator(a,s))}}var BufferToggleOperator=function(){function a(s,d){this.openings=s,this.closingSelector=d}return a.prototype.call=function(s,d){return d.subscribe(new BufferToggleSubscriber(s,this.openings,this.closingSelector))},a}(),BufferToggleSubscriber=function(a){__extends(s,a);function s(d,c,l){var h=a.call(this,d)||this;return h.closingSelector=l,h.contexts=[],h.add(subscribeToResult(h,c)),h}return s.prototype._next=function(d){for(var c=this.contexts,l=c.length,h=0;h<l;h++)c[h].buffer.push(d)},s.prototype._error=function(d){for(var c=this.contexts;c.length>0;){var l=c.shift();l.subscription.unsubscribe(),l.buffer=null,l.subscription=null}this.contexts=null,a.prototype._error.call(this,d)},s.prototype._complete=function(){for(var d=this.contexts;d.length>0;){var c=d.shift();this.destination.next(c.buffer),c.subscription.unsubscribe(),c.buffer=null,c.subscription=null}this.contexts=null,a.prototype._complete.call(this)},s.prototype.notifyNext=function(d,c){d?this.closeBuffer(d):this.openBuffer(c)},s.prototype.notifyComplete=function(d){this.closeBuffer(d.context)},s.prototype.openBuffer=function(d){try{var c=this.closingSelector,l=c.call(this,d);l&&this.trySubscribe(l)}catch(h){this._error(h)}},s.prototype.closeBuffer=function(d){var c=this.contexts;if(c&&d){var l=d.buffer,h=d.subscription;this.destination.next(l),c.splice(c.indexOf(d),1),this.remove(h),h.unsubscribe()}},s.prototype.trySubscribe=function(d){var c=this.contexts,l=[],h=new Subscription,p={buffer:l,subscription:h};c.push(p);var y=subscribeToResult(this,d,p);!y||y.closed?this.closeBuffer(p):(y.context=p,this.add(y),h.add(y))},s}(OuterSubscriber);function bufferWhen(a){return function(s){return s.lift(new BufferWhenOperator(a))}}var BufferWhenOperator=function(){function a(s){this.closingSelector=s}return a.prototype.call=function(s,d){return d.subscribe(new BufferWhenSubscriber(s,this.closingSelector))},a}(),BufferWhenSubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.closingSelector=c,l.subscribing=!1,l.openBuffer(),l}return s.prototype._next=function(d){this.buffer.push(d)},s.prototype._complete=function(){var d=this.buffer;d&&this.destination.next(d),a.prototype._complete.call(this)},s.prototype._unsubscribe=function(){this.buffer=void 0,this.subscribing=!1},s.prototype.notifyNext=function(){this.openBuffer()},s.prototype.notifyComplete=function(){this.subscribing?this.complete():this.openBuffer()},s.prototype.openBuffer=function(){var d=this.closingSubscription;d&&(this.remove(d),d.unsubscribe());var c=this.buffer;this.buffer&&this.destination.next(c),this.buffer=[];var l;try{var h=this.closingSelector;l=h()}catch(p){return this.error(p)}d=new Subscription,this.closingSubscription=d,this.add(d),this.subscribing=!0,d.add(innerSubscribe(l,new SimpleInnerSubscriber(this))),this.subscribing=!1},s}(SimpleOuterSubscriber);function catchError(a){return function(d){var c=new CatchOperator(a),l=d.lift(c);return c.caught=l}}var CatchOperator=function(){function a(s){this.selector=s}return a.prototype.call=function(s,d){return d.subscribe(new CatchSubscriber(s,this.selector,this.caught))},a}(),CatchSubscriber=function(a){__extends(s,a);function s(d,c,l){var h=a.call(this,d)||this;return h.selector=c,h.caught=l,h}return s.prototype.error=function(d){if(!this.isStopped){var c=void 0;try{c=this.selector(d,this.caught)}catch(p){a.prototype.error.call(this,p);return}this._unsubscribeAndRecycle();var l=new SimpleInnerSubscriber(this);this.add(l);var h=innerSubscribe(c,l);h!==l&&this.add(h)}},s}(SimpleOuterSubscriber);function scheduleArray(a,s){return new Observable(function(d){var c=new Subscription,l=0;return c.add(s.schedule(function(){if(l===a.length){d.complete();return}d.next(a[l++]),d.closed||c.add(this.schedule())})),c})}function fromArray(a,s){return s?scheduleArray(a,s):new Observable(subscribeToArray(a))}var NONE={},CombineLatestOperator=function(){function a(s){this.resultSelector=s}return a.prototype.call=function(s,d){return d.subscribe(new CombineLatestSubscriber(s,this.resultSelector))},a}(),CombineLatestSubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.resultSelector=c,l.active=0,l.values=[],l.observables=[],l}return s.prototype._next=function(d){this.values.push(NONE),this.observables.push(d)},s.prototype._complete=function(){var d=this.observables,c=d.length;if(c===0)this.destination.complete();else{this.active=c,this.toRespond=c;for(var l=0;l<c;l++){var h=d[l];this.add(subscribeToResult(this,h,void 0,l))}}},s.prototype.notifyComplete=function(d){(this.active-=1)===0&&this.destination.complete()},s.prototype.notifyNext=function(d,c,l){var h=this.values,p=h[l],y=this.toRespond?p===NONE?--this.toRespond:this.toRespond:0;h[l]=c,y===0&&(this.resultSelector?this._tryResultSelector(h):this.destination.next(h.slice()))},s.prototype._tryResultSelector=function(d){var c;try{c=this.resultSelector.apply(this,d)}catch(l){this.destination.error(l);return}this.destination.next(c)},s}(OuterSubscriber);function combineAll(a){return function(s){return s.lift(new CombineLatestOperator(a))}}function scheduleObservable(a,s){return new Observable(function(d){var c=new Subscription;return c.add(s.schedule(function(){var l=a[observable]();c.add(l.subscribe({next:function(h){c.add(s.schedule(function(){return d.next(h)}))},error:function(h){c.add(s.schedule(function(){return d.error(h)}))},complete:function(){c.add(s.schedule(function(){return d.complete()}))}}))})),c})}function schedulePromise(a,s){return new Observable(function(d){var c=new Subscription;return c.add(s.schedule(function(){return a.then(function(l){c.add(s.schedule(function(){d.next(l),c.add(s.schedule(function(){return d.complete()}))}))},function(l){c.add(s.schedule(function(){return d.error(l)}))})})),c})}function scheduleIterable(a,s){if(!a)throw new Error("Iterable cannot be null");return new Observable(function(d){var c=new Subscription,l;return c.add(function(){l&&typeof l.return=="function"&&l.return()}),c.add(s.schedule(function(){l=a[iterator](),c.add(s.schedule(function(){if(!d.closed){var h,p;try{var y=l.next();h=y.value,p=y.done}catch(_){d.error(_);return}p?d.complete():(d.next(h),this.schedule())}}))})),c})}function isInteropObservable(a){return a&&typeof a[observable]=="function"}function isIterable(a){return a&&typeof a[iterator]=="function"}function scheduled(a,s){if(a!=null){if(isInteropObservable(a))return scheduleObservable(a,s);if(isPromise(a))return schedulePromise(a,s);if(isArrayLike(a))return scheduleArray(a,s);if(isIterable(a)||typeof a=="string")return scheduleIterable(a,s)}throw new TypeError((a!==null&&typeof a||a)+" is not observable")}function from(a,s){return s?scheduled(a,s):a instanceof Observable?a:new Observable(subscribeTo(a))}function combineLatest(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];var d=null;return typeof a[a.length-1]=="function"&&(d=a.pop()),a.length===1&&isArray$2(a[0])&&(a=a[0].slice()),function(c){return c.lift.call(from([c].concat(a)),new CombineLatestOperator(d))}}function of(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];var d=a[a.length-1];return isScheduler(d)?(a.pop(),scheduleArray(a,d)):fromArray(a)}function map(a,s){return function(c){if(typeof a!="function")throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return c.lift(new MapOperator(a,s))}}var MapOperator=function(){function a(s,d){this.project=s,this.thisArg=d}return a.prototype.call=function(s,d){return d.subscribe(new MapSubscriber(s,this.project,this.thisArg))},a}(),MapSubscriber=function(a){__extends(s,a);function s(d,c,l){var h=a.call(this,d)||this;return h.project=c,h.count=0,h.thisArg=l||h,h}return s.prototype._next=function(d){var c;try{c=this.project.call(this.thisArg,d,this.count++)}catch(l){this.destination.error(l);return}this.destination.next(c)},s}(Subscriber);function mergeMap(a,s,d){return d===void 0&&(d=Number.POSITIVE_INFINITY),typeof s=="function"?function(c){return c.pipe(mergeMap(function(l,h){return from(a(l,h)).pipe(map(function(p,y){return s(l,p,h,y)}))},d))}:(typeof s=="number"&&(d=s),function(c){return c.lift(new MergeMapOperator(a,d))})}var MergeMapOperator=function(){function a(s,d){d===void 0&&(d=Number.POSITIVE_INFINITY),this.project=s,this.concurrent=d}return a.prototype.call=function(s,d){return d.subscribe(new MergeMapSubscriber(s,this.project,this.concurrent))},a}(),MergeMapSubscriber=function(a){__extends(s,a);function s(d,c,l){l===void 0&&(l=Number.POSITIVE_INFINITY);var h=a.call(this,d)||this;return h.project=c,h.concurrent=l,h.hasCompleted=!1,h.buffer=[],h.active=0,h.index=0,h}return s.prototype._next=function(d){this.active<this.concurrent?this._tryNext(d):this.buffer.push(d)},s.prototype._tryNext=function(d){var c,l=this.index++;try{c=this.project(d,l)}catch(h){this.destination.error(h);return}this.active++,this._innerSub(c)},s.prototype._innerSub=function(d){var c=new SimpleInnerSubscriber(this),l=this.destination;l.add(c);var h=innerSubscribe(d,c);h!==c&&l.add(h)},s.prototype._complete=function(){this.hasCompleted=!0,this.active===0&&this.buffer.length===0&&this.destination.complete(),this.unsubscribe()},s.prototype.notifyNext=function(d){this.destination.next(d)},s.prototype.notifyComplete=function(){var d=this.buffer;this.active--,d.length>0?this._next(d.shift()):this.active===0&&this.hasCompleted&&this.destination.complete()},s}(SimpleOuterSubscriber),flatMap=mergeMap;function mergeAll(a){return a===void 0&&(a=Number.POSITIVE_INFINITY),mergeMap(identity,a)}function concatAll(){return mergeAll(1)}function concat$1(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];return concatAll()(of.apply(void 0,a))}function concat(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];return function(d){return d.lift.call(concat$1.apply(void 0,[d].concat(a)))}}function concatMap(a,s){return mergeMap(a,s,1)}function concatMapTo(a,s){return concatMap(function(){return a},s)}function count(a){return function(s){return s.lift(new CountOperator(a,s))}}var CountOperator=function(){function a(s,d){this.predicate=s,this.source=d}return a.prototype.call=function(s,d){return d.subscribe(new CountSubscriber(s,this.predicate,this.source))},a}(),CountSubscriber=function(a){__extends(s,a);function s(d,c,l){var h=a.call(this,d)||this;return h.predicate=c,h.source=l,h.count=0,h.index=0,h}return s.prototype._next=function(d){this.predicate?this._tryPredicate(d):this.count++},s.prototype._tryPredicate=function(d){var c;try{c=this.predicate(d,this.index++,this.source)}catch(l){this.destination.error(l);return}c&&this.count++},s.prototype._complete=function(){this.destination.next(this.count),this.destination.complete()},s}(Subscriber);function debounce(a){return function(s){return s.lift(new DebounceOperator(a))}}var DebounceOperator=function(){function a(s){this.durationSelector=s}return a.prototype.call=function(s,d){return d.subscribe(new DebounceSubscriber(s,this.durationSelector))},a}(),DebounceSubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.durationSelector=c,l.hasValue=!1,l}return s.prototype._next=function(d){try{var c=this.durationSelector.call(this,d);c&&this._tryNext(d,c)}catch(l){this.destination.error(l)}},s.prototype._complete=function(){this.emitValue(),this.destination.complete()},s.prototype._tryNext=function(d,c){var l=this.durationSubscription;this.value=d,this.hasValue=!0,l&&(l.unsubscribe(),this.remove(l)),l=innerSubscribe(c,new SimpleInnerSubscriber(this)),l&&!l.closed&&this.add(this.durationSubscription=l)},s.prototype.notifyNext=function(){this.emitValue()},s.prototype.notifyComplete=function(){this.emitValue()},s.prototype.emitValue=function(){if(this.hasValue){var d=this.value,c=this.durationSubscription;c&&(this.durationSubscription=void 0,c.unsubscribe(),this.remove(c)),this.value=void 0,this.hasValue=!1,a.prototype._next.call(this,d)}},s}(SimpleOuterSubscriber);function debounceTime(a,s){return s===void 0&&(s=async),function(d){return d.lift(new DebounceTimeOperator(a,s))}}var DebounceTimeOperator=function(){function a(s,d){this.dueTime=s,this.scheduler=d}return a.prototype.call=function(s,d){return d.subscribe(new DebounceTimeSubscriber(s,this.dueTime,this.scheduler))},a}(),DebounceTimeSubscriber=function(a){__extends(s,a);function s(d,c,l){var h=a.call(this,d)||this;return h.dueTime=c,h.scheduler=l,h.debouncedSubscription=null,h.lastValue=null,h.hasValue=!1,h}return s.prototype._next=function(d){this.clearDebounce(),this.lastValue=d,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(dispatchNext$1,this.dueTime,this))},s.prototype._complete=function(){this.debouncedNext(),this.destination.complete()},s.prototype.debouncedNext=function(){if(this.clearDebounce(),this.hasValue){var d=this.lastValue;this.lastValue=null,this.hasValue=!1,this.destination.next(d)}},s.prototype.clearDebounce=function(){var d=this.debouncedSubscription;d!==null&&(this.remove(d),d.unsubscribe(),this.debouncedSubscription=null)},s}(Subscriber);function dispatchNext$1(a){a.debouncedNext()}function defaultIfEmpty(a){return a===void 0&&(a=null),function(s){return s.lift(new DefaultIfEmptyOperator(a))}}var DefaultIfEmptyOperator=function(){function a(s){this.defaultValue=s}return a.prototype.call=function(s,d){return d.subscribe(new DefaultIfEmptySubscriber(s,this.defaultValue))},a}(),DefaultIfEmptySubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.defaultValue=c,l.isEmpty=!0,l}return s.prototype._next=function(d){this.isEmpty=!1,this.destination.next(d)},s.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},s}(Subscriber);function isDate$1(a){return a instanceof Date&&!isNaN(+a)}var EMPTY=new Observable(function(a){return a.complete()});function empty$1(a){return a?emptyScheduled(a):EMPTY}function emptyScheduled(a){return new Observable(function(s){return a.schedule(function(){return s.complete()})})}function throwError(a,s){return s?new Observable(function(d){return s.schedule(dispatch,0,{error:a,subscriber:d})}):new Observable(function(d){return d.error(a)})}function dispatch(a){var s=a.error,d=a.subscriber;d.error(s)}var Notification=function(){function a(s,d,c){this.kind=s,this.value=d,this.error=c,this.hasValue=s==="N"}return a.prototype.observe=function(s){switch(this.kind){case"N":return s.next&&s.next(this.value);case"E":return s.error&&s.error(this.error);case"C":return s.complete&&s.complete()}},a.prototype.do=function(s,d,c){var l=this.kind;switch(l){case"N":return s&&s(this.value);case"E":return d&&d(this.error);case"C":return c&&c()}},a.prototype.accept=function(s,d,c){return s&&typeof s.next=="function"?this.observe(s):this.do(s,d,c)},a.prototype.toObservable=function(){var s=this.kind;switch(s){case"N":return of(this.value);case"E":return throwError(this.error);case"C":return empty$1()}throw new Error("unexpected notification kind value")},a.createNext=function(s){return typeof s!="undefined"?new a("N",s):a.undefinedValueNotification},a.createError=function(s){return new a("E",void 0,s)},a.createComplete=function(){return a.completeNotification},a.completeNotification=new a("C"),a.undefinedValueNotification=new a("N",void 0),a}();function delay(a,s){s===void 0&&(s=async);var d=isDate$1(a),c=d?+a-s.now():Math.abs(a);return function(l){return l.lift(new DelayOperator(c,s))}}var DelayOperator=function(){function a(s,d){this.delay=s,this.scheduler=d}return a.prototype.call=function(s,d){return d.subscribe(new DelaySubscriber(s,this.delay,this.scheduler))},a}(),DelaySubscriber=function(a){__extends(s,a);function s(d,c,l){var h=a.call(this,d)||this;return h.delay=c,h.scheduler=l,h.queue=[],h.active=!1,h.errored=!1,h}return s.dispatch=function(d){for(var c=d.source,l=c.queue,h=d.scheduler,p=d.destination;l.length>0&&l[0].time-h.now()<=0;)l.shift().notification.observe(p);if(l.length>0){var y=Math.max(0,l[0].time-h.now());this.schedule(d,y)}else this.unsubscribe(),c.active=!1},s.prototype._schedule=function(d){this.active=!0;var c=this.destination;c.add(d.schedule(s.dispatch,this.delay,{source:this,destination:this.destination,scheduler:d}))},s.prototype.scheduleNotification=function(d){if(this.errored!==!0){var c=this.scheduler,l=new DelayMessage(c.now()+this.delay,d);this.queue.push(l),this.active===!1&&this._schedule(c)}},s.prototype._next=function(d){this.scheduleNotification(Notification.createNext(d))},s.prototype._error=function(d){this.errored=!0,this.queue=[],this.destination.error(d),this.unsubscribe()},s.prototype._complete=function(){this.scheduleNotification(Notification.createComplete()),this.unsubscribe()},s}(Subscriber),DelayMessage=function(){function a(s,d){this.time=s,this.notification=d}return a}();function delayWhen(a,s){return s?function(d){return new SubscriptionDelayObservable(d,s).lift(new DelayWhenOperator(a))}:function(d){return d.lift(new DelayWhenOperator(a))}}var DelayWhenOperator=function(){function a(s){this.delayDurationSelector=s}return a.prototype.call=function(s,d){return d.subscribe(new DelayWhenSubscriber(s,this.delayDurationSelector))},a}(),DelayWhenSubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.delayDurationSelector=c,l.completed=!1,l.delayNotifierSubscriptions=[],l.index=0,l}return s.prototype.notifyNext=function(d,c,l,h,p){this.destination.next(d),this.removeSubscription(p),this.tryComplete()},s.prototype.notifyError=function(d,c){this._error(d)},s.prototype.notifyComplete=function(d){var c=this.removeSubscription(d);c&&this.destination.next(c),this.tryComplete()},s.prototype._next=function(d){var c=this.index++;try{var l=this.delayDurationSelector(d,c);l&&this.tryDelay(l,d)}catch(h){this.destination.error(h)}},s.prototype._complete=function(){this.completed=!0,this.tryComplete(),this.unsubscribe()},s.prototype.removeSubscription=function(d){d.unsubscribe();var c=this.delayNotifierSubscriptions.indexOf(d);return c!==-1&&this.delayNotifierSubscriptions.splice(c,1),d.outerValue},s.prototype.tryDelay=function(d,c){var l=subscribeToResult(this,d,c);if(l&&!l.closed){var h=this.destination;h.add(l),this.delayNotifierSubscriptions.push(l)}},s.prototype.tryComplete=function(){this.completed&&this.delayNotifierSubscriptions.length===0&&this.destination.complete()},s}(OuterSubscriber),SubscriptionDelayObservable=function(a){__extends(s,a);function s(d,c){var l=a.call(this)||this;return l.source=d,l.subscriptionDelay=c,l}return s.prototype._subscribe=function(d){this.subscriptionDelay.subscribe(new SubscriptionDelaySubscriber(d,this.source))},s}(Observable),SubscriptionDelaySubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this)||this;return l.parent=d,l.source=c,l.sourceSubscribed=!1,l}return s.prototype._next=function(d){this.subscribeToSource()},s.prototype._error=function(d){this.unsubscribe(),this.parent.error(d)},s.prototype._complete=function(){this.unsubscribe(),this.subscribeToSource()},s.prototype.subscribeToSource=function(){this.sourceSubscribed||(this.sourceSubscribed=!0,this.unsubscribe(),this.source.subscribe(this.parent))},s}(Subscriber);function dematerialize(){return function(s){return s.lift(new DeMaterializeOperator)}}var DeMaterializeOperator=function(){function a(){}return a.prototype.call=function(s,d){return d.subscribe(new DeMaterializeSubscriber(s))},a}(),DeMaterializeSubscriber=function(a){__extends(s,a);function s(d){return a.call(this,d)||this}return s.prototype._next=function(d){d.observe(this.destination)},s}(Subscriber);function distinct(a,s){return function(d){return d.lift(new DistinctOperator(a,s))}}var DistinctOperator=function(){function a(s,d){this.keySelector=s,this.flushes=d}return a.prototype.call=function(s,d){return d.subscribe(new DistinctSubscriber(s,this.keySelector,this.flushes))},a}(),DistinctSubscriber=function(a){__extends(s,a);function s(d,c,l){var h=a.call(this,d)||this;return h.keySelector=c,h.values=new Set,l&&h.add(innerSubscribe(l,new SimpleInnerSubscriber(h))),h}return s.prototype.notifyNext=function(){this.values.clear()},s.prototype.notifyError=function(d){this._error(d)},s.prototype._next=function(d){this.keySelector?this._useKeySelector(d):this._finalizeNext(d,d)},s.prototype._useKeySelector=function(d){var c,l=this.destination;try{c=this.keySelector(d)}catch(h){l.error(h);return}this._finalizeNext(c,d)},s.prototype._finalizeNext=function(d,c){var l=this.values;l.has(d)||(l.add(d),this.destination.next(c))},s}(SimpleOuterSubscriber);function distinctUntilChanged(a,s){return function(d){return d.lift(new DistinctUntilChangedOperator(a,s))}}var DistinctUntilChangedOperator=function(){function a(s,d){this.compare=s,this.keySelector=d}return a.prototype.call=function(s,d){return d.subscribe(new DistinctUntilChangedSubscriber(s,this.compare,this.keySelector))},a}(),DistinctUntilChangedSubscriber=function(a){__extends(s,a);function s(d,c,l){var h=a.call(this,d)||this;return h.keySelector=l,h.hasKey=!1,typeof c=="function"&&(h.compare=c),h}return s.prototype.compare=function(d,c){return d===c},s.prototype._next=function(d){var c;try{var l=this.keySelector;c=l?l(d):d}catch(y){return this.destination.error(y)}var h=!1;if(this.hasKey)try{var p=this.compare;h=p(this.key,c)}catch(y){return this.destination.error(y)}else this.hasKey=!0;h||(this.key=c,this.destination.next(d))},s}(Subscriber);function distinctUntilKeyChanged(a,s){return distinctUntilChanged(function(d,c){return s?s(d[a],c[a]):d[a]===c[a]})}var ArgumentOutOfRangeErrorImpl=function(){function a(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return a.prototype=Object.create(Error.prototype),a}(),ArgumentOutOfRangeError=ArgumentOutOfRangeErrorImpl;function filter(a,s){return function(c){return c.lift(new FilterOperator(a,s))}}var FilterOperator=function(){function a(s,d){this.predicate=s,this.thisArg=d}return a.prototype.call=function(s,d){return d.subscribe(new FilterSubscriber(s,this.predicate,this.thisArg))},a}(),FilterSubscriber=function(a){__extends(s,a);function s(d,c,l){var h=a.call(this,d)||this;return h.predicate=c,h.thisArg=l,h.count=0,h}return s.prototype._next=function(d){var c;try{c=this.predicate.call(this.thisArg,d,this.count++)}catch(l){this.destination.error(l);return}c&&this.destination.next(d)},s}(Subscriber),EmptyErrorImpl=function(){function a(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return a.prototype=Object.create(Error.prototype),a}(),EmptyError=EmptyErrorImpl;function throwIfEmpty(a){return a===void 0&&(a=defaultErrorFactory),function(s){return s.lift(new ThrowIfEmptyOperator(a))}}var ThrowIfEmptyOperator=function(){function a(s){this.errorFactory=s}return a.prototype.call=function(s,d){return d.subscribe(new ThrowIfEmptySubscriber(s,this.errorFactory))},a}(),ThrowIfEmptySubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.errorFactory=c,l.hasValue=!1,l}return s.prototype._next=function(d){this.hasValue=!0,this.destination.next(d)},s.prototype._complete=function(){if(this.hasValue)return this.destination.complete();var d=void 0;try{d=this.errorFactory()}catch(c){d=c}this.destination.error(d)},s}(Subscriber);function defaultErrorFactory(){return new EmptyError}function take(a){return function(s){return a===0?empty$1():s.lift(new TakeOperator(a))}}var TakeOperator=function(){function a(s){if(this.total=s,this.total<0)throw new ArgumentOutOfRangeError}return a.prototype.call=function(s,d){return d.subscribe(new TakeSubscriber(s,this.total))},a}(),TakeSubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.total=c,l.count=0,l}return s.prototype._next=function(d){var c=this.total,l=++this.count;l<=c&&(this.destination.next(d),l===c&&(this.destination.complete(),this.unsubscribe()))},s}(Subscriber);function elementAt(a,s){if(a<0)throw new ArgumentOutOfRangeError;var d=arguments.length>=2;return function(c){return c.pipe(filter(function(l,h){return h===a}),take(1),d?defaultIfEmpty(s):throwIfEmpty(function(){return new ArgumentOutOfRangeError}))}}function endWith(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];return function(d){return concat$1(d,of.apply(void 0,a))}}function every(a,s){return function(d){return d.lift(new EveryOperator(a,s,d))}}var EveryOperator=function(){function a(s,d,c){this.predicate=s,this.thisArg=d,this.source=c}return a.prototype.call=function(s,d){return d.subscribe(new EverySubscriber(s,this.predicate,this.thisArg,this.source))},a}(),EverySubscriber=function(a){__extends(s,a);function s(d,c,l,h){var p=a.call(this,d)||this;return p.predicate=c,p.thisArg=l,p.source=h,p.index=0,p.thisArg=l||p,p}return s.prototype.notifyComplete=function(d){this.destination.next(d),this.destination.complete()},s.prototype._next=function(d){var c=!1;try{c=this.predicate.call(this.thisArg,d,this.index++,this.source)}catch(l){this.destination.error(l);return}c||this.notifyComplete(!1)},s.prototype._complete=function(){this.notifyComplete(!0)},s}(Subscriber);function exhaust(){return function(a){return a.lift(new SwitchFirstOperator)}}var SwitchFirstOperator=function(){function a(){}return a.prototype.call=function(s,d){return d.subscribe(new SwitchFirstSubscriber(s))},a}(),SwitchFirstSubscriber=function(a){__extends(s,a);function s(d){var c=a.call(this,d)||this;return c.hasCompleted=!1,c.hasSubscription=!1,c}return s.prototype._next=function(d){this.hasSubscription||(this.hasSubscription=!0,this.add(innerSubscribe(d,new SimpleInnerSubscriber(this))))},s.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete()},s.prototype.notifyComplete=function(){this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},s}(SimpleOuterSubscriber);function exhaustMap(a,s){return s?function(d){return d.pipe(exhaustMap(function(c,l){return from(a(c,l)).pipe(map(function(h,p){return s(c,h,l,p)}))}))}:function(d){return d.lift(new ExhaustMapOperator(a))}}var ExhaustMapOperator=function(){function a(s){this.project=s}return a.prototype.call=function(s,d){return d.subscribe(new ExhaustMapSubscriber(s,this.project))},a}(),ExhaustMapSubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.project=c,l.hasSubscription=!1,l.hasCompleted=!1,l.index=0,l}return s.prototype._next=function(d){this.hasSubscription||this.tryNext(d)},s.prototype.tryNext=function(d){var c,l=this.index++;try{c=this.project(d,l)}catch(h){this.destination.error(h);return}this.hasSubscription=!0,this._innerSub(c)},s.prototype._innerSub=function(d){var c=new SimpleInnerSubscriber(this),l=this.destination;l.add(c);var h=innerSubscribe(d,c);h!==c&&l.add(h)},s.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete(),this.unsubscribe()},s.prototype.notifyNext=function(d){this.destination.next(d)},s.prototype.notifyError=function(d){this.destination.error(d)},s.prototype.notifyComplete=function(){this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},s}(SimpleOuterSubscriber);function expand(a,s,d){return s===void 0&&(s=Number.POSITIVE_INFINITY),s=(s||0)<1?Number.POSITIVE_INFINITY:s,function(c){return c.lift(new ExpandOperator(a,s,d))}}var ExpandOperator=function(){function a(s,d,c){this.project=s,this.concurrent=d,this.scheduler=c}return a.prototype.call=function(s,d){return d.subscribe(new ExpandSubscriber(s,this.project,this.concurrent,this.scheduler))},a}(),ExpandSubscriber=function(a){__extends(s,a);function s(d,c,l,h){var p=a.call(this,d)||this;return p.project=c,p.concurrent=l,p.scheduler=h,p.index=0,p.active=0,p.hasCompleted=!1,l<Number.POSITIVE_INFINITY&&(p.buffer=[]),p}return s.dispatch=function(d){var c=d.subscriber,l=d.result,h=d.value,p=d.index;c.subscribeToProjection(l,h,p)},s.prototype._next=function(d){var c=this.destination;if(c.closed){this._complete();return}var l=this.index++;if(this.active<this.concurrent){c.next(d);try{var h=this.project,p=h(d,l);if(!this.scheduler)this.subscribeToProjection(p,d,l);else{var y={subscriber:this,result:p,value:d,index:l},_=this.destination;_.add(this.scheduler.schedule(s.dispatch,0,y))}}catch(E){c.error(E)}}else this.buffer.push(d)},s.prototype.subscribeToProjection=function(d,c,l){this.active++;var h=this.destination;h.add(innerSubscribe(d,new SimpleInnerSubscriber(this)))},s.prototype._complete=function(){this.hasCompleted=!0,this.hasCompleted&&this.active===0&&this.destination.complete(),this.unsubscribe()},s.prototype.notifyNext=function(d){this._next(d)},s.prototype.notifyComplete=function(){var d=this.buffer;this.active--,d&&d.length>0&&this._next(d.shift()),this.hasCompleted&&this.active===0&&this.destination.complete()},s}(SimpleOuterSubscriber);function finalize(a){return function(s){return s.lift(new FinallyOperator(a))}}var FinallyOperator=function(){function a(s){this.callback=s}return a.prototype.call=function(s,d){return d.subscribe(new FinallySubscriber(s,this.callback))},a}(),FinallySubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.add(new Subscription(c)),l}return s}(Subscriber);function find$1(a,s){if(typeof a!="function")throw new TypeError("predicate is not a function");return function(d){return d.lift(new FindValueOperator(a,d,!1,s))}}var FindValueOperator=function(){function a(s,d,c,l){this.predicate=s,this.source=d,this.yieldIndex=c,this.thisArg=l}return a.prototype.call=function(s,d){return d.subscribe(new FindValueSubscriber(s,this.predicate,this.source,this.yieldIndex,this.thisArg))},a}(),FindValueSubscriber=function(a){__extends(s,a);function s(d,c,l,h,p){var y=a.call(this,d)||this;return y.predicate=c,y.source=l,y.yieldIndex=h,y.thisArg=p,y.index=0,y}return s.prototype.notifyComplete=function(d){var c=this.destination;c.next(d),c.complete(),this.unsubscribe()},s.prototype._next=function(d){var c=this,l=c.predicate,h=c.thisArg,p=this.index++;try{var y=l.call(h||this,d,p,this.source);y&&this.notifyComplete(this.yieldIndex?p:d)}catch(_){this.destination.error(_)}},s.prototype._complete=function(){this.notifyComplete(this.yieldIndex?-1:void 0)},s}(Subscriber);function findIndex(a,s){return function(d){return d.lift(new FindValueOperator(a,d,!0,s))}}function first(a,s){var d=arguments.length>=2;return function(c){return c.pipe(a?filter(function(l,h){return a(l,h,c)}):identity,take(1),d?defaultIfEmpty(s):throwIfEmpty(function(){return new EmptyError}))}}var ObjectUnsubscribedErrorImpl=function(){function a(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return a.prototype=Object.create(Error.prototype),a}(),ObjectUnsubscribedError=ObjectUnsubscribedErrorImpl,SubjectSubscription=function(a){__extends(s,a);function s(d,c){var l=a.call(this)||this;return l.subject=d,l.subscriber=c,l.closed=!1,l}return s.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var d=this.subject,c=d.observers;if(this.subject=null,!(!c||c.length===0||d.isStopped||d.closed)){var l=c.indexOf(this.subscriber);l!==-1&&c.splice(l,1)}}},s}(Subscription),SubjectSubscriber=function(a){__extends(s,a);function s(d){var c=a.call(this,d)||this;return c.destination=d,c}return s}(Subscriber),Subject=function(a){__extends(s,a);function s(){var d=a.call(this)||this;return d.observers=[],d.closed=!1,d.isStopped=!1,d.hasError=!1,d.thrownError=null,d}return s.prototype[rxSubscriber]=function(){return new SubjectSubscriber(this)},s.prototype.lift=function(d){var c=new AnonymousSubject(this,this);return c.operator=d,c},s.prototype.next=function(d){if(this.closed)throw new ObjectUnsubscribedError;if(!this.isStopped)for(var c=this.observers,l=c.length,h=c.slice(),p=0;p<l;p++)h[p].next(d)},s.prototype.error=function(d){if(this.closed)throw new ObjectUnsubscribedError;this.hasError=!0,this.thrownError=d,this.isStopped=!0;for(var c=this.observers,l=c.length,h=c.slice(),p=0;p<l;p++)h[p].error(d);this.observers.length=0},s.prototype.complete=function(){if(this.closed)throw new ObjectUnsubscribedError;this.isStopped=!0;for(var d=this.observers,c=d.length,l=d.slice(),h=0;h<c;h++)l[h].complete();this.observers.length=0},s.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},s.prototype._trySubscribe=function(d){if(this.closed)throw new ObjectUnsubscribedError;return a.prototype._trySubscribe.call(this,d)},s.prototype._subscribe=function(d){if(this.closed)throw new ObjectUnsubscribedError;return this.hasError?(d.error(this.thrownError),Subscription.EMPTY):this.isStopped?(d.complete(),Subscription.EMPTY):(this.observers.push(d),new SubjectSubscription(this,d))},s.prototype.asObservable=function(){var d=new Observable;return d.source=this,d},s.create=function(d,c){return new AnonymousSubject(d,c)},s}(Observable),AnonymousSubject=function(a){__extends(s,a);function s(d,c){var l=a.call(this)||this;return l.destination=d,l.source=c,l}return s.prototype.next=function(d){var c=this.destination;c&&c.next&&c.next(d)},s.prototype.error=function(d){var c=this.destination;c&&c.error&&this.destination.error(d)},s.prototype.complete=function(){var d=this.destination;d&&d.complete&&this.destination.complete()},s.prototype._subscribe=function(d){var c=this.source;return c?this.source.subscribe(d):Subscription.EMPTY},s}(Subject);function groupBy(a,s,d,c){return function(l){return l.lift(new GroupByOperator(a,s,d,c))}}var GroupByOperator=function(){function a(s,d,c,l){this.keySelector=s,this.elementSelector=d,this.durationSelector=c,this.subjectSelector=l}return a.prototype.call=function(s,d){return d.subscribe(new GroupBySubscriber(s,this.keySelector,this.elementSelector,this.durationSelector,this.subjectSelector))},a}(),GroupBySubscriber=function(a){__extends(s,a);function s(d,c,l,h,p){var y=a.call(this,d)||this;return y.keySelector=c,y.elementSelector=l,y.durationSelector=h,y.subjectSelector=p,y.groups=null,y.attemptedToUnsubscribe=!1,y.count=0,y}return s.prototype._next=function(d){var c;try{c=this.keySelector(d)}catch(l){this.error(l);return}this._group(d,c)},s.prototype._group=function(d,c){var l=this.groups;l||(l=this.groups=new Map);var h=l.get(c),p;if(this.elementSelector)try{p=this.elementSelector(d)}catch(E){this.error(E)}else p=d;if(!h){h=this.subjectSelector?this.subjectSelector():new Subject,l.set(c,h);var y=new GroupedObservable(c,h,this);if(this.destination.next(y),this.durationSelector){var _=void 0;try{_=this.durationSelector(new GroupedObservable(c,h))}catch(E){this.error(E);return}this.add(_.subscribe(new GroupDurationSubscriber(c,h,this)))}}h.closed||h.next(p)},s.prototype._error=function(d){var c=this.groups;c&&(c.forEach(function(l,h){l.error(d)}),c.clear()),this.destination.error(d)},s.prototype._complete=function(){var d=this.groups;d&&(d.forEach(function(c,l){c.complete()}),d.clear()),this.destination.complete()},s.prototype.removeGroup=function(d){this.groups.delete(d)},s.prototype.unsubscribe=function(){this.closed||(this.attemptedToUnsubscribe=!0,this.count===0&&a.prototype.unsubscribe.call(this))},s}(Subscriber),GroupDurationSubscriber=function(a){__extends(s,a);function s(d,c,l){var h=a.call(this,c)||this;return h.key=d,h.group=c,h.parent=l,h}return s.prototype._next=function(d){this.complete()},s.prototype._unsubscribe=function(){var d=this,c=d.parent,l=d.key;this.key=this.parent=null,c&&c.removeGroup(l)},s}(Subscriber),GroupedObservable=function(a){__extends(s,a);function s(d,c,l){var h=a.call(this)||this;return h.key=d,h.groupSubject=c,h.refCountSubscription=l,h}return s.prototype._subscribe=function(d){var c=new Subscription,l=this,h=l.refCountSubscription,p=l.groupSubject;return h&&!h.closed&&c.add(new InnerRefCountSubscription(h)),c.add(p.subscribe(d)),c},s}(Observable),InnerRefCountSubscription=function(a){__extends(s,a);function s(d){var c=a.call(this)||this;return c.parent=d,d.count++,c}return s.prototype.unsubscribe=function(){var d=this.parent;!d.closed&&!this.closed&&(a.prototype.unsubscribe.call(this),d.count-=1,d.count===0&&d.attemptedToUnsubscribe&&d.unsubscribe())},s}(Subscription);function ignoreElements(){return function(s){return s.lift(new IgnoreElementsOperator)}}var IgnoreElementsOperator=function(){function a(){}return a.prototype.call=function(s,d){return d.subscribe(new IgnoreElementsSubscriber(s))},a}(),IgnoreElementsSubscriber=function(a){__extends(s,a);function s(){return a!==null&&a.apply(this,arguments)||this}return s.prototype._next=function(d){},s}(Subscriber);function isEmpty(){return function(a){return a.lift(new IsEmptyOperator)}}var IsEmptyOperator=function(){function a(){}return a.prototype.call=function(s,d){return d.subscribe(new IsEmptySubscriber(s))},a}(),IsEmptySubscriber=function(a){__extends(s,a);function s(d){return a.call(this,d)||this}return s.prototype.notifyComplete=function(d){var c=this.destination;c.next(d),c.complete()},s.prototype._next=function(d){this.notifyComplete(!1)},s.prototype._complete=function(){this.notifyComplete(!0)},s}(Subscriber);function takeLast(a){return function(d){return a===0?empty$1():d.lift(new TakeLastOperator(a))}}var TakeLastOperator=function(){function a(s){if(this.total=s,this.total<0)throw new ArgumentOutOfRangeError}return a.prototype.call=function(s,d){return d.subscribe(new TakeLastSubscriber(s,this.total))},a}(),TakeLastSubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.total=c,l.ring=new Array,l.count=0,l}return s.prototype._next=function(d){var c=this.ring,l=this.total,h=this.count++;if(c.length<l)c.push(d);else{var p=h%l;c[p]=d}},s.prototype._complete=function(){var d=this.destination,c=this.count;if(c>0)for(var l=this.count>=this.total?this.total:this.count,h=this.ring,p=0;p<l;p++){var y=c++%l;d.next(h[y])}d.complete()},s}(Subscriber);function last(a,s){var d=arguments.length>=2;return function(c){return c.pipe(a?filter(function(l,h){return a(l,h,c)}):identity,takeLast(1),d?defaultIfEmpty(s):throwIfEmpty(function(){return new EmptyError}))}}function mapTo(a){return function(s){return s.lift(new MapToOperator(a))}}var MapToOperator=function(){function a(s){this.value=s}return a.prototype.call=function(s,d){return d.subscribe(new MapToSubscriber(s,this.value))},a}(),MapToSubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.value=c,l}return s.prototype._next=function(d){this.destination.next(this.value)},s}(Subscriber);function materialize(){return function(s){return s.lift(new MaterializeOperator)}}var MaterializeOperator=function(){function a(){}return a.prototype.call=function(s,d){return d.subscribe(new MaterializeSubscriber(s))},a}(),MaterializeSubscriber=function(a){__extends(s,a);function s(d){return a.call(this,d)||this}return s.prototype._next=function(d){this.destination.next(Notification.createNext(d))},s.prototype._error=function(d){var c=this.destination;c.next(Notification.createError(d)),c.complete()},s.prototype._complete=function(){var d=this.destination;d.next(Notification.createComplete()),d.complete()},s}(Subscriber);function scan(a,s){var d=!1;return arguments.length>=2&&(d=!0),function(l){return l.lift(new ScanOperator(a,s,d))}}var ScanOperator=function(){function a(s,d,c){c===void 0&&(c=!1),this.accumulator=s,this.seed=d,this.hasSeed=c}return a.prototype.call=function(s,d){return d.subscribe(new ScanSubscriber(s,this.accumulator,this.seed,this.hasSeed))},a}(),ScanSubscriber=function(a){__extends(s,a);function s(d,c,l,h){var p=a.call(this,d)||this;return p.accumulator=c,p._seed=l,p.hasSeed=h,p.index=0,p}return Object.defineProperty(s.prototype,"seed",{get:function(){return this._seed},set:function(d){this.hasSeed=!0,this._seed=d},enumerable:!0,configurable:!0}),s.prototype._next=function(d){if(!this.hasSeed)this.seed=d,this.destination.next(d);else return this._tryNext(d)},s.prototype._tryNext=function(d){var c=this.index++,l;try{l=this.accumulator(this.seed,d,c)}catch(h){this.destination.error(h)}this.seed=l,this.destination.next(l)},s}(Subscriber);function reduce(a,s){return arguments.length>=2?function(c){return pipe(scan(a,s),takeLast(1),defaultIfEmpty(s))(c)}:function(c){return pipe(scan(function(l,h,p){return a(l,h,p+1)}),takeLast(1))(c)}}function max(a){var s=typeof a=="function"?function(d,c){return a(d,c)>0?d:c}:function(d,c){return d>c?d:c};return reduce(s)}function merge$2(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];var d=Number.POSITIVE_INFINITY,c=null,l=a[a.length-1];return isScheduler(l)?(c=a.pop(),a.length>1&&typeof a[a.length-1]=="number"&&(d=a.pop())):typeof l=="number"&&(d=a.pop()),c===null&&a.length===1&&a[0]instanceof Observable?a[0]:mergeAll(d)(fromArray(a,c))}function merge$1(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];return function(d){return d.lift.call(merge$2.apply(void 0,[d].concat(a)))}}function mergeMapTo(a,s,d){return d===void 0&&(d=Number.POSITIVE_INFINITY),typeof s=="function"?mergeMap(function(){return a},s,d):(typeof s=="number"&&(d=s),mergeMap(function(){return a},d))}function mergeScan(a,s,d){return d===void 0&&(d=Number.POSITIVE_INFINITY),function(c){return c.lift(new MergeScanOperator(a,s,d))}}var MergeScanOperator=function(){function a(s,d,c){this.accumulator=s,this.seed=d,this.concurrent=c}return a.prototype.call=function(s,d){return d.subscribe(new MergeScanSubscriber(s,this.accumulator,this.seed,this.concurrent))},a}(),MergeScanSubscriber=function(a){__extends(s,a);function s(d,c,l,h){var p=a.call(this,d)||this;return p.accumulator=c,p.acc=l,p.concurrent=h,p.hasValue=!1,p.hasCompleted=!1,p.buffer=[],p.active=0,p.index=0,p}return s.prototype._next=function(d){if(this.active<this.concurrent){var c=this.index++,l=this.destination,h=void 0;try{var p=this.accumulator;h=p(this.acc,d,c)}catch(y){return l.error(y)}this.active++,this._innerSub(h)}else this.buffer.push(d)},s.prototype._innerSub=function(d){var c=new SimpleInnerSubscriber(this),l=this.destination;l.add(c);var h=innerSubscribe(d,c);h!==c&&l.add(h)},s.prototype._complete=function(){this.hasCompleted=!0,this.active===0&&this.buffer.length===0&&(this.hasValue===!1&&this.destination.next(this.acc),this.destination.complete()),this.unsubscribe()},s.prototype.notifyNext=function(d){var c=this.destination;this.acc=d,this.hasValue=!0,c.next(d)},s.prototype.notifyComplete=function(){var d=this.buffer;this.active--,d.length>0?this._next(d.shift()):this.active===0&&this.hasCompleted&&(this.hasValue===!1&&this.destination.next(this.acc),this.destination.complete())},s}(SimpleOuterSubscriber);function min(a){var s=typeof a=="function"?function(d,c){return a(d,c)<0?d:c}:function(d,c){return d<c?d:c};return reduce(s)}function refCount(){return function(s){return s.lift(new RefCountOperator(s))}}var RefCountOperator=function(){function a(s){this.connectable=s}return a.prototype.call=function(s,d){var c=this.connectable;c._refCount++;var l=new RefCountSubscriber(s,c),h=d.subscribe(l);return l.closed||(l.connection=c.connect()),h},a}(),RefCountSubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.connectable=c,l}return s.prototype._unsubscribe=function(){var d=this.connectable;if(!d){this.connection=null;return}this.connectable=null;var c=d._refCount;if(c<=0){this.connection=null;return}if(d._refCount=c-1,c>1){this.connection=null;return}var l=this.connection,h=d._connection;this.connection=null,h&&(!l||h===l)&&h.unsubscribe()},s}(Subscriber),ConnectableObservable=function(a){__extends(s,a);function s(d,c){var l=a.call(this)||this;return l.source=d,l.subjectFactory=c,l._refCount=0,l._isComplete=!1,l}return s.prototype._subscribe=function(d){return this.getSubject().subscribe(d)},s.prototype.getSubject=function(){var d=this._subject;return(!d||d.isStopped)&&(this._subject=this.subjectFactory()),this._subject},s.prototype.connect=function(){var d=this._connection;return d||(this._isComplete=!1,d=this._connection=new Subscription,d.add(this.source.subscribe(new ConnectableSubscriber(this.getSubject(),this))),d.closed&&(this._connection=null,d=Subscription.EMPTY)),d},s.prototype.refCount=function(){return refCount()(this)},s}(Observable),connectableObservableDescriptor=function(){var a=ConnectableObservable.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:a._subscribe},_isComplete:{value:a._isComplete,writable:!0},getSubject:{value:a.getSubject},connect:{value:a.connect},refCount:{value:a.refCount}}}(),ConnectableSubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.connectable=c,l}return s.prototype._error=function(d){this._unsubscribe(),a.prototype._error.call(this,d)},s.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),a.prototype._complete.call(this)},s.prototype._unsubscribe=function(){var d=this.connectable;if(d){this.connectable=null;var c=d._connection;d._refCount=0,d._subject=null,d._connection=null,c&&c.unsubscribe()}},s}(SubjectSubscriber);function multicast(a,s){return function(c){var l;if(typeof a=="function"?l=a:l=function(){return a},typeof s=="function")return c.lift(new MulticastOperator(l,s));var h=Object.create(c,connectableObservableDescriptor);return h.source=c,h.subjectFactory=l,h}}var MulticastOperator=function(){function a(s,d){this.subjectFactory=s,this.selector=d}return a.prototype.call=function(s,d){var c=this.selector,l=this.subjectFactory(),h=c(l).subscribe(s);return h.add(d.subscribe(l)),h},a}();function observeOn(a,s){return s===void 0&&(s=0),function(c){return c.lift(new ObserveOnOperator(a,s))}}var ObserveOnOperator=function(){function a(s,d){d===void 0&&(d=0),this.scheduler=s,this.delay=d}return a.prototype.call=function(s,d){return d.subscribe(new ObserveOnSubscriber(s,this.scheduler,this.delay))},a}(),ObserveOnSubscriber=function(a){__extends(s,a);function s(d,c,l){l===void 0&&(l=0);var h=a.call(this,d)||this;return h.scheduler=c,h.delay=l,h}return s.dispatch=function(d){var c=d.notification,l=d.destination;c.observe(l),this.unsubscribe()},s.prototype.scheduleMessage=function(d){var c=this.destination;c.add(this.scheduler.schedule(s.dispatch,this.delay,new ObserveOnMessage(d,this.destination)))},s.prototype._next=function(d){this.scheduleMessage(Notification.createNext(d))},s.prototype._error=function(d){this.scheduleMessage(Notification.createError(d)),this.unsubscribe()},s.prototype._complete=function(){this.scheduleMessage(Notification.createComplete()),this.unsubscribe()},s}(Subscriber),ObserveOnMessage=function(){function a(s,d){this.notification=s,this.destination=d}return a}();function onErrorResumeNext(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];return a.length===1&&isArray$2(a[0])&&(a=a[0]),function(d){return d.lift(new OnErrorResumeNextOperator(a))}}var OnErrorResumeNextOperator=function(){function a(s){this.nextSources=s}return a.prototype.call=function(s,d){return d.subscribe(new OnErrorResumeNextSubscriber(s,this.nextSources))},a}(),OnErrorResumeNextSubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.destination=d,l.nextSources=c,l}return s.prototype.notifyError=function(){this.subscribeToNextSource()},s.prototype.notifyComplete=function(){this.subscribeToNextSource()},s.prototype._error=function(d){this.subscribeToNextSource(),this.unsubscribe()},s.prototype._complete=function(){this.subscribeToNextSource(),this.unsubscribe()},s.prototype.subscribeToNextSource=function(){var d=this.nextSources.shift();if(d){var c=new SimpleInnerSubscriber(this),l=this.destination;l.add(c);var h=innerSubscribe(d,c);h!==c&&l.add(h)}else this.destination.complete()},s}(SimpleOuterSubscriber);function pairwise(){return function(a){return a.lift(new PairwiseOperator)}}var PairwiseOperator=function(){function a(){}return a.prototype.call=function(s,d){return d.subscribe(new PairwiseSubscriber(s))},a}(),PairwiseSubscriber=function(a){__extends(s,a);function s(d){var c=a.call(this,d)||this;return c.hasPrev=!1,c}return s.prototype._next=function(d){var c;this.hasPrev?c=[this.prev,d]:this.hasPrev=!0,this.prev=d,c&&this.destination.next(c)},s}(Subscriber);function not(a,s){function d(){return!d.pred.apply(d.thisArg,arguments)}return d.pred=a,d.thisArg=s,d}function partition(a,s){return function(d){return[filter(a,s)(d),filter(not(a,s))(d)]}}function pluck(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];var d=a.length;if(d===0)throw new Error("list of properties cannot be empty.");return function(c){return map(plucker(a,d))(c)}}function plucker(a,s){var d=function(c){for(var l=c,h=0;h<s;h++){var p=l!=null?l[a[h]]:void 0;if(p!==void 0)l=p;else return}return l};return d}function publish(a){return a?multicast(function(){return new Subject},a):multicast(new Subject)}var BehaviorSubject=function(a){__extends(s,a);function s(d){var c=a.call(this)||this;return c._value=d,c}return Object.defineProperty(s.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),s.prototype._subscribe=function(d){var c=a.prototype._subscribe.call(this,d);return c&&!c.closed&&d.next(this._value),c},s.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new ObjectUnsubscribedError;return this._value},s.prototype.next=function(d){a.prototype.next.call(this,this._value=d)},s}(Subject);function publishBehavior(a){return function(s){return multicast(new BehaviorSubject(a))(s)}}var AsyncSubject=function(a){__extends(s,a);function s(){var d=a!==null&&a.apply(this,arguments)||this;return d.value=null,d.hasNext=!1,d.hasCompleted=!1,d}return s.prototype._subscribe=function(d){return this.hasError?(d.error(this.thrownError),Subscription.EMPTY):this.hasCompleted&&this.hasNext?(d.next(this.value),d.complete(),Subscription.EMPTY):a.prototype._subscribe.call(this,d)},s.prototype.next=function(d){this.hasCompleted||(this.value=d,this.hasNext=!0)},s.prototype.error=function(d){this.hasCompleted||a.prototype.error.call(this,d)},s.prototype.complete=function(){this.hasCompleted=!0,this.hasNext&&a.prototype.next.call(this,this.value),a.prototype.complete.call(this)},s}(Subject);function publishLast(){return function(a){return multicast(new AsyncSubject)(a)}}var QueueAction=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d,c)||this;return l.scheduler=d,l.work=c,l}return s.prototype.schedule=function(d,c){return c===void 0&&(c=0),c>0?a.prototype.schedule.call(this,d,c):(this.delay=c,this.state=d,this.scheduler.flush(this),this)},s.prototype.execute=function(d,c){return c>0||this.closed?a.prototype.execute.call(this,d,c):this._execute(d,c)},s.prototype.requestAsyncId=function(d,c,l){return l===void 0&&(l=0),l!==null&&l>0||l===null&&this.delay>0?a.prototype.requestAsyncId.call(this,d,c,l):d.flush(this)},s}(AsyncAction),QueueScheduler=function(a){__extends(s,a);function s(){return a!==null&&a.apply(this,arguments)||this}return s}(AsyncScheduler),queueScheduler=new QueueScheduler(QueueAction),queue=queueScheduler,ReplaySubject=function(a){__extends(s,a);function s(d,c,l){d===void 0&&(d=Number.POSITIVE_INFINITY),c===void 0&&(c=Number.POSITIVE_INFINITY);var h=a.call(this)||this;return h.scheduler=l,h._events=[],h._infiniteTimeWindow=!1,h._bufferSize=d<1?1:d,h._windowTime=c<1?1:c,c===Number.POSITIVE_INFINITY?(h._infiniteTimeWindow=!0,h.next=h.nextInfiniteTimeWindow):h.next=h.nextTimeWindow,h}return s.prototype.nextInfiniteTimeWindow=function(d){if(!this.isStopped){var c=this._events;c.push(d),c.length>this._bufferSize&&c.shift()}a.prototype.next.call(this,d)},s.prototype.nextTimeWindow=function(d){this.isStopped||(this._events.push(new ReplayEvent(this._getNow(),d)),this._trimBufferThenGetEvents()),a.prototype.next.call(this,d)},s.prototype._subscribe=function(d){var c=this._infiniteTimeWindow,l=c?this._events:this._trimBufferThenGetEvents(),h=this.scheduler,p=l.length,y;if(this.closed)throw new ObjectUnsubscribedError;if(this.isStopped||this.hasError?y=Subscription.EMPTY:(this.observers.push(d),y=new SubjectSubscription(this,d)),h&&d.add(d=new ObserveOnSubscriber(d,h)),c)for(var _=0;_<p&&!d.closed;_++)d.next(l[_]);else for(var _=0;_<p&&!d.closed;_++)d.next(l[_].value);return this.hasError?d.error(this.thrownError):this.isStopped&&d.complete(),y},s.prototype._getNow=function(){return(this.scheduler||queue).now()},s.prototype._trimBufferThenGetEvents=function(){for(var d=this._getNow(),c=this._bufferSize,l=this._windowTime,h=this._events,p=h.length,y=0;y<p&&!(d-h[y].time<l);)y++;return p>c&&(y=Math.max(y,p-c)),y>0&&h.splice(0,y),h},s}(Subject),ReplayEvent=function(){function a(s,d){this.time=s,this.value=d}return a}();function publishReplay(a,s,d,c){d&&typeof d!="function"&&(c=d);var l=typeof d=="function"?d:void 0,h=new ReplaySubject(a,s,c);return function(p){return multicast(function(){return h},l)(p)}}function race$1(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];if(a.length===1)if(isArray$2(a[0]))a=a[0];else return a[0];return fromArray(a,void 0).lift(new RaceOperator)}var RaceOperator=function(){function a(){}return a.prototype.call=function(s,d){return d.subscribe(new RaceSubscriber(s))},a}(),RaceSubscriber=function(a){__extends(s,a);function s(d){var c=a.call(this,d)||this;return c.hasFirst=!1,c.observables=[],c.subscriptions=[],c}return s.prototype._next=function(d){this.observables.push(d)},s.prototype._complete=function(){var d=this.observables,c=d.length;if(c===0)this.destination.complete();else{for(var l=0;l<c&&!this.hasFirst;l++){var h=d[l],p=subscribeToResult(this,h,void 0,l);this.subscriptions&&this.subscriptions.push(p),this.add(p)}this.observables=null}},s.prototype.notifyNext=function(d,c,l){if(!this.hasFirst){this.hasFirst=!0;for(var h=0;h<this.subscriptions.length;h++)if(h!==l){var p=this.subscriptions[h];p.unsubscribe(),this.remove(p)}this.subscriptions=null}this.destination.next(c)},s}(OuterSubscriber);function race(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];return function(c){return a.length===1&&isArray$2(a[0])&&(a=a[0]),c.lift.call(race$1.apply(void 0,[c].concat(a)))}}function repeat(a){return a===void 0&&(a=-1),function(s){return a===0?empty$1():a<0?s.lift(new RepeatOperator(-1,s)):s.lift(new RepeatOperator(a-1,s))}}var RepeatOperator=function(){function a(s,d){this.count=s,this.source=d}return a.prototype.call=function(s,d){return d.subscribe(new RepeatSubscriber(s,this.count,this.source))},a}(),RepeatSubscriber=function(a){__extends(s,a);function s(d,c,l){var h=a.call(this,d)||this;return h.count=c,h.source=l,h}return s.prototype.complete=function(){if(!this.isStopped){var d=this,c=d.source,l=d.count;if(l===0)return a.prototype.complete.call(this);l>-1&&(this.count=l-1),c.subscribe(this._unsubscribeAndRecycle())}},s}(Subscriber);function repeatWhen(a){return function(s){return s.lift(new RepeatWhenOperator(a))}}var RepeatWhenOperator=function(){function a(s){this.notifier=s}return a.prototype.call=function(s,d){return d.subscribe(new RepeatWhenSubscriber(s,this.notifier,d))},a}(),RepeatWhenSubscriber=function(a){__extends(s,a);function s(d,c,l){var h=a.call(this,d)||this;return h.notifier=c,h.source=l,h.sourceIsBeingSubscribedTo=!0,h}return s.prototype.notifyNext=function(){this.sourceIsBeingSubscribedTo=!0,this.source.subscribe(this)},s.prototype.notifyComplete=function(){if(this.sourceIsBeingSubscribedTo===!1)return a.prototype.complete.call(this)},s.prototype.complete=function(){if(this.sourceIsBeingSubscribedTo=!1,!this.isStopped){if(this.retries||this.subscribeToRetries(),!this.retriesSubscription||this.retriesSubscription.closed)return a.prototype.complete.call(this);this._unsubscribeAndRecycle(),this.notifications.next(void 0)}},s.prototype._unsubscribe=function(){var d=this,c=d.notifications,l=d.retriesSubscription;c&&(c.unsubscribe(),this.notifications=void 0),l&&(l.unsubscribe(),this.retriesSubscription=void 0),this.retries=void 0},s.prototype._unsubscribeAndRecycle=function(){var d=this._unsubscribe;return this._unsubscribe=null,a.prototype._unsubscribeAndRecycle.call(this),this._unsubscribe=d,this},s.prototype.subscribeToRetries=function(){this.notifications=new Subject;var d;try{var c=this.notifier;d=c(this.notifications)}catch{return a.prototype.complete.call(this)}this.retries=d,this.retriesSubscription=innerSubscribe(d,new SimpleInnerSubscriber(this))},s}(SimpleOuterSubscriber);function retry(a){return a===void 0&&(a=-1),function(s){return s.lift(new RetryOperator(a,s))}}var RetryOperator=function(){function a(s,d){this.count=s,this.source=d}return a.prototype.call=function(s,d){return d.subscribe(new RetrySubscriber(s,this.count,this.source))},a}(),RetrySubscriber=function(a){__extends(s,a);function s(d,c,l){var h=a.call(this,d)||this;return h.count=c,h.source=l,h}return s.prototype.error=function(d){if(!this.isStopped){var c=this,l=c.source,h=c.count;if(h===0)return a.prototype.error.call(this,d);h>-1&&(this.count=h-1),l.subscribe(this._unsubscribeAndRecycle())}},s}(Subscriber);function retryWhen(a){return function(s){return s.lift(new RetryWhenOperator(a,s))}}var RetryWhenOperator=function(){function a(s,d){this.notifier=s,this.source=d}return a.prototype.call=function(s,d){return d.subscribe(new RetryWhenSubscriber(s,this.notifier,this.source))},a}(),RetryWhenSubscriber=function(a){__extends(s,a);function s(d,c,l){var h=a.call(this,d)||this;return h.notifier=c,h.source=l,h}return s.prototype.error=function(d){if(!this.isStopped){var c=this.errors,l=this.retries,h=this.retriesSubscription;if(l)this.errors=void 0,this.retriesSubscription=void 0;else{c=new Subject;try{var p=this.notifier;l=p(c)}catch(y){return a.prototype.error.call(this,y)}h=innerSubscribe(l,new SimpleInnerSubscriber(this))}this._unsubscribeAndRecycle(),this.errors=c,this.retries=l,this.retriesSubscription=h,c.next(d)}},s.prototype._unsubscribe=function(){var d=this,c=d.errors,l=d.retriesSubscription;c&&(c.unsubscribe(),this.errors=void 0),l&&(l.unsubscribe(),this.retriesSubscription=void 0),this.retries=void 0},s.prototype.notifyNext=function(){var d=this._unsubscribe;this._unsubscribe=null,this._unsubscribeAndRecycle(),this._unsubscribe=d,this.source.subscribe(this)},s}(SimpleOuterSubscriber);function sample(a){return function(s){return s.lift(new SampleOperator(a))}}var SampleOperator=function(){function a(s){this.notifier=s}return a.prototype.call=function(s,d){var c=new SampleSubscriber(s),l=d.subscribe(c);return l.add(innerSubscribe(this.notifier,new SimpleInnerSubscriber(c))),l},a}(),SampleSubscriber=function(a){__extends(s,a);function s(){var d=a!==null&&a.apply(this,arguments)||this;return d.hasValue=!1,d}return s.prototype._next=function(d){this.value=d,this.hasValue=!0},s.prototype.notifyNext=function(){this.emitValue()},s.prototype.notifyComplete=function(){this.emitValue()},s.prototype.emitValue=function(){this.hasValue&&(this.hasValue=!1,this.destination.next(this.value))},s}(SimpleOuterSubscriber);function sampleTime(a,s){return s===void 0&&(s=async),function(d){return d.lift(new SampleTimeOperator(a,s))}}var SampleTimeOperator=function(){function a(s,d){this.period=s,this.scheduler=d}return a.prototype.call=function(s,d){return d.subscribe(new SampleTimeSubscriber(s,this.period,this.scheduler))},a}(),SampleTimeSubscriber=function(a){__extends(s,a);function s(d,c,l){var h=a.call(this,d)||this;return h.period=c,h.scheduler=l,h.hasValue=!1,h.add(l.schedule(dispatchNotification,c,{subscriber:h,period:c})),h}return s.prototype._next=function(d){this.lastValue=d,this.hasValue=!0},s.prototype.notifyNext=function(){this.hasValue&&(this.hasValue=!1,this.destination.next(this.lastValue))},s}(Subscriber);function dispatchNotification(a){var s=a.subscriber,d=a.period;s.notifyNext(),this.schedule(a,d)}function sequenceEqual(a,s){return function(d){return d.lift(new SequenceEqualOperator(a,s))}}var SequenceEqualOperator=function(){function a(s,d){this.compareTo=s,this.comparator=d}return a.prototype.call=function(s,d){return d.subscribe(new SequenceEqualSubscriber(s,this.compareTo,this.comparator))},a}(),SequenceEqualSubscriber=function(a){__extends(s,a);function s(d,c,l){var h=a.call(this,d)||this;return h.compareTo=c,h.comparator=l,h._a=[],h._b=[],h._oneComplete=!1,h.destination.add(c.subscribe(new SequenceEqualCompareToSubscriber(d,h))),h}return s.prototype._next=function(d){this._oneComplete&&this._b.length===0?this.emit(!1):(this._a.push(d),this.checkValues())},s.prototype._complete=function(){this._oneComplete?this.emit(this._a.length===0&&this._b.length===0):this._oneComplete=!0,this.unsubscribe()},s.prototype.checkValues=function(){for(var d=this,c=d._a,l=d._b,h=d.comparator;c.length>0&&l.length>0;){var p=c.shift(),y=l.shift(),_=!1;try{_=h?h(p,y):p===y}catch(E){this.destination.error(E)}_||this.emit(!1)}},s.prototype.emit=function(d){var c=this.destination;c.next(d),c.complete()},s.prototype.nextB=function(d){this._oneComplete&&this._a.length===0?this.emit(!1):(this._b.push(d),this.checkValues())},s.prototype.completeB=function(){this._oneComplete?this.emit(this._a.length===0&&this._b.length===0):this._oneComplete=!0},s}(Subscriber),SequenceEqualCompareToSubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.parent=c,l}return s.prototype._next=function(d){this.parent.nextB(d)},s.prototype._error=function(d){this.parent.error(d),this.unsubscribe()},s.prototype._complete=function(){this.parent.completeB(),this.unsubscribe()},s}(Subscriber);function shareSubjectFactory(){return new Subject}function share(){return function(a){return refCount()(multicast(shareSubjectFactory)(a))}}function shareReplay(a,s,d){var c;return a&&typeof a=="object"?c=a:c={bufferSize:a,windowTime:s,refCount:!1,scheduler:d},function(l){return l.lift(shareReplayOperator(c))}}function shareReplayOperator(a){var s=a.bufferSize,d=s===void 0?Number.POSITIVE_INFINITY:s,c=a.windowTime,l=c===void 0?Number.POSITIVE_INFINITY:c,h=a.refCount,p=a.scheduler,y,_=0,E,O=!1,P=!1;return function(A){_++;var q;!y||O?(O=!1,y=new ReplaySubject(d,l,p),q=y.subscribe(this),E=A.subscribe({next:function(U){y.next(U)},error:function(U){O=!0,y.error(U)},complete:function(){P=!0,E=void 0,y.complete()}}),P&&(E=void 0)):q=y.subscribe(this),this.add(function(){_--,q.unsubscribe(),q=void 0,E&&!P&&h&&_===0&&(E.unsubscribe(),E=void 0,y=void 0)})}}function single(a){return function(s){return s.lift(new SingleOperator(a,s))}}var SingleOperator=function(){function a(s,d){this.predicate=s,this.source=d}return a.prototype.call=function(s,d){return d.subscribe(new SingleSubscriber(s,this.predicate,this.source))},a}(),SingleSubscriber=function(a){__extends(s,a);function s(d,c,l){var h=a.call(this,d)||this;return h.predicate=c,h.source=l,h.seenValue=!1,h.index=0,h}return s.prototype.applySingleValue=function(d){this.seenValue?this.destination.error("Sequence contains more than one element"):(this.seenValue=!0,this.singleValue=d)},s.prototype._next=function(d){var c=this.index++;this.predicate?this.tryNext(d,c):this.applySingleValue(d)},s.prototype.tryNext=function(d,c){try{this.predicate(d,c,this.source)&&this.applySingleValue(d)}catch(l){this.destination.error(l)}},s.prototype._complete=function(){var d=this.destination;this.index>0?(d.next(this.seenValue?this.singleValue:void 0),d.complete()):d.error(new EmptyError)},s}(Subscriber);function skip(a){return function(s){return s.lift(new SkipOperator(a))}}var SkipOperator=function(){function a(s){this.total=s}return a.prototype.call=function(s,d){return d.subscribe(new SkipSubscriber(s,this.total))},a}(),SkipSubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.total=c,l.count=0,l}return s.prototype._next=function(d){++this.count>this.total&&this.destination.next(d)},s}(Subscriber);function skipLast(a){return function(s){return s.lift(new SkipLastOperator(a))}}var SkipLastOperator=function(){function a(s){if(this._skipCount=s,this._skipCount<0)throw new ArgumentOutOfRangeError}return a.prototype.call=function(s,d){return this._skipCount===0?d.subscribe(new Subscriber(s)):d.subscribe(new SkipLastSubscriber(s,this._skipCount))},a}(),SkipLastSubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l._skipCount=c,l._count=0,l._ring=new Array(c),l}return s.prototype._next=function(d){var c=this._skipCount,l=this._count++;if(l<c)this._ring[l]=d;else{var h=l%c,p=this._ring,y=p[h];p[h]=d,this.destination.next(y)}},s}(Subscriber);function skipUntil(a){return function(s){return s.lift(new SkipUntilOperator(a))}}var SkipUntilOperator=function(){function a(s){this.notifier=s}return a.prototype.call=function(s,d){return d.subscribe(new SkipUntilSubscriber(s,this.notifier))},a}(),SkipUntilSubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;l.hasValue=!1;var h=new SimpleInnerSubscriber(l);l.add(h),l.innerSubscription=h;var p=innerSubscribe(c,h);return p!==h&&(l.add(p),l.innerSubscription=p),l}return s.prototype._next=function(d){this.hasValue&&a.prototype._next.call(this,d)},s.prototype.notifyNext=function(){this.hasValue=!0,this.innerSubscription&&this.innerSubscription.unsubscribe()},s.prototype.notifyComplete=function(){},s}(SimpleOuterSubscriber);function skipWhile(a){return function(s){return s.lift(new SkipWhileOperator(a))}}var SkipWhileOperator=function(){function a(s){this.predicate=s}return a.prototype.call=function(s,d){return d.subscribe(new SkipWhileSubscriber(s,this.predicate))},a}(),SkipWhileSubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.predicate=c,l.skipping=!0,l.index=0,l}return s.prototype._next=function(d){var c=this.destination;this.skipping&&this.tryCallPredicate(d),this.skipping||c.next(d)},s.prototype.tryCallPredicate=function(d){try{var c=this.predicate(d,this.index++);this.skipping=Boolean(c)}catch(l){this.destination.error(l)}},s}(Subscriber);function startWith(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];var d=a[a.length-1];return isScheduler(d)?(a.pop(),function(c){return concat$1(a,c,d)}):function(c){return concat$1(a,c)}}var nextHandle=1,RESOLVED=function(){return Promise.resolve()}(),activeHandles={};function findAndClearHandle(a){return a in activeHandles?(delete activeHandles[a],!0):!1}var Immediate={setImmediate:function(a){var s=nextHandle++;return activeHandles[s]=!0,RESOLVED.then(function(){return findAndClearHandle(s)&&a()}),s},clearImmediate:function(a){findAndClearHandle(a)}},AsapAction=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d,c)||this;return l.scheduler=d,l.work=c,l}return s.prototype.requestAsyncId=function(d,c,l){return l===void 0&&(l=0),l!==null&&l>0?a.prototype.requestAsyncId.call(this,d,c,l):(d.actions.push(this),d.scheduled||(d.scheduled=Immediate.setImmediate(d.flush.bind(d,null))))},s.prototype.recycleAsyncId=function(d,c,l){if(l===void 0&&(l=0),l!==null&&l>0||l===null&&this.delay>0)return a.prototype.recycleAsyncId.call(this,d,c,l);d.actions.length===0&&(Immediate.clearImmediate(c),d.scheduled=void 0)},s}(AsyncAction),AsapScheduler=function(a){__extends(s,a);function s(){return a!==null&&a.apply(this,arguments)||this}return s.prototype.flush=function(d){this.active=!0,this.scheduled=void 0;var c=this.actions,l,h=-1,p=c.length;d=d||c.shift();do if(l=d.execute(d.state,d.delay))break;while(++h<p&&(d=c.shift()));if(this.active=!1,l){for(;++h<p&&(d=c.shift());)d.unsubscribe();throw l}},s}(AsyncScheduler),asapScheduler=new AsapScheduler(AsapAction),asap=asapScheduler,SubscribeOnObservable=function(a){__extends(s,a);function s(d,c,l){c===void 0&&(c=0),l===void 0&&(l=asap);var h=a.call(this)||this;return h.source=d,h.delayTime=c,h.scheduler=l,(!isNumeric(c)||c<0)&&(h.delayTime=0),(!l||typeof l.schedule!="function")&&(h.scheduler=asap),h}return s.create=function(d,c,l){return c===void 0&&(c=0),l===void 0&&(l=asap),new s(d,c,l)},s.dispatch=function(d){var c=d.source,l=d.subscriber;return this.add(c.subscribe(l))},s.prototype._subscribe=function(d){var c=this.delayTime,l=this.source,h=this.scheduler;return h.schedule(s.dispatch,c,{source:l,subscriber:d})},s}(Observable);function subscribeOn(a,s){return s===void 0&&(s=0),function(c){return c.lift(new SubscribeOnOperator(a,s))}}var SubscribeOnOperator=function(){function a(s,d){this.scheduler=s,this.delay=d}return a.prototype.call=function(s,d){return new SubscribeOnObservable(d,this.delay,this.scheduler).subscribe(s)},a}();function switchMap(a,s){return typeof s=="function"?function(d){return d.pipe(switchMap(function(c,l){return from(a(c,l)).pipe(map(function(h,p){return s(c,h,l,p)}))}))}:function(d){return d.lift(new SwitchMapOperator(a))}}var SwitchMapOperator=function(){function a(s){this.project=s}return a.prototype.call=function(s,d){return d.subscribe(new SwitchMapSubscriber(s,this.project))},a}(),SwitchMapSubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.project=c,l.index=0,l}return s.prototype._next=function(d){var c,l=this.index++;try{c=this.project(d,l)}catch(h){this.destination.error(h);return}this._innerSub(c)},s.prototype._innerSub=function(d){var c=this.innerSubscription;c&&c.unsubscribe();var l=new SimpleInnerSubscriber(this),h=this.destination;h.add(l),this.innerSubscription=innerSubscribe(d,l),this.innerSubscription!==l&&h.add(this.innerSubscription)},s.prototype._complete=function(){var d=this.innerSubscription;(!d||d.closed)&&a.prototype._complete.call(this),this.unsubscribe()},s.prototype._unsubscribe=function(){this.innerSubscription=void 0},s.prototype.notifyComplete=function(){this.innerSubscription=void 0,this.isStopped&&a.prototype._complete.call(this)},s.prototype.notifyNext=function(d){this.destination.next(d)},s}(SimpleOuterSubscriber);function switchAll(){return switchMap(identity)}function switchMapTo(a,s){return s?switchMap(function(){return a},s):switchMap(function(){return a})}function takeUntil(a){return function(s){return s.lift(new TakeUntilOperator(a))}}var TakeUntilOperator=function(){function a(s){this.notifier=s}return a.prototype.call=function(s,d){var c=new TakeUntilSubscriber(s),l=innerSubscribe(this.notifier,new SimpleInnerSubscriber(c));return l&&!c.seenValue?(c.add(l),d.subscribe(c)):c},a}(),TakeUntilSubscriber=function(a){__extends(s,a);function s(d){var c=a.call(this,d)||this;return c.seenValue=!1,c}return s.prototype.notifyNext=function(){this.seenValue=!0,this.complete()},s.prototype.notifyComplete=function(){},s}(SimpleOuterSubscriber);function takeWhile(a,s){return s===void 0&&(s=!1),function(d){return d.lift(new TakeWhileOperator(a,s))}}var TakeWhileOperator=function(){function a(s,d){this.predicate=s,this.inclusive=d}return a.prototype.call=function(s,d){return d.subscribe(new TakeWhileSubscriber(s,this.predicate,this.inclusive))},a}(),TakeWhileSubscriber=function(a){__extends(s,a);function s(d,c,l){var h=a.call(this,d)||this;return h.predicate=c,h.inclusive=l,h.index=0,h}return s.prototype._next=function(d){var c=this.destination,l;try{l=this.predicate(d,this.index++)}catch(h){c.error(h);return}this.nextOrComplete(d,l)},s.prototype.nextOrComplete=function(d,c){var l=this.destination;Boolean(c)?l.next(d):(this.inclusive&&l.next(d),l.complete())},s}(Subscriber);function noop$1(){}function tap(a,s,d){return function(l){return l.lift(new DoOperator(a,s,d))}}var DoOperator=function(){function a(s,d,c){this.nextOrObserver=s,this.error=d,this.complete=c}return a.prototype.call=function(s,d){return d.subscribe(new TapSubscriber(s,this.nextOrObserver,this.error,this.complete))},a}(),TapSubscriber=function(a){__extends(s,a);function s(d,c,l,h){var p=a.call(this,d)||this;return p._tapNext=noop$1,p._tapError=noop$1,p._tapComplete=noop$1,p._tapError=l||noop$1,p._tapComplete=h||noop$1,isFunction$1(c)?(p._context=p,p._tapNext=c):c&&(p._context=c,p._tapNext=c.next||noop$1,p._tapError=c.error||noop$1,p._tapComplete=c.complete||noop$1),p}return s.prototype._next=function(d){try{this._tapNext.call(this._context,d)}catch(c){this.destination.error(c);return}this.destination.next(d)},s.prototype._error=function(d){try{this._tapError.call(this._context,d)}catch(c){this.destination.error(c);return}this.destination.error(d)},s.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(d){this.destination.error(d);return}return this.destination.complete()},s}(Subscriber),defaultThrottleConfig={leading:!0,trailing:!1};function throttle(a,s){return s===void 0&&(s=defaultThrottleConfig),function(d){return d.lift(new ThrottleOperator(a,!!s.leading,!!s.trailing))}}var ThrottleOperator=function(){function a(s,d,c){this.durationSelector=s,this.leading=d,this.trailing=c}return a.prototype.call=function(s,d){return d.subscribe(new ThrottleSubscriber(s,this.durationSelector,this.leading,this.trailing))},a}(),ThrottleSubscriber=function(a){__extends(s,a);function s(d,c,l,h){var p=a.call(this,d)||this;return p.destination=d,p.durationSelector=c,p._leading=l,p._trailing=h,p._hasValue=!1,p}return s.prototype._next=function(d){this._hasValue=!0,this._sendValue=d,this._throttled||(this._leading?this.send():this.throttle(d))},s.prototype.send=function(){var d=this,c=d._hasValue,l=d._sendValue;c&&(this.destination.next(l),this.throttle(l)),this._hasValue=!1,this._sendValue=void 0},s.prototype.throttle=function(d){var c=this.tryDurationSelector(d);c&&this.add(this._throttled=innerSubscribe(c,new SimpleInnerSubscriber(this)))},s.prototype.tryDurationSelector=function(d){try{return this.durationSelector(d)}catch(c){return this.destination.error(c),null}},s.prototype.throttlingDone=function(){var d=this,c=d._throttled,l=d._trailing;c&&c.unsubscribe(),this._throttled=void 0,l&&this.send()},s.prototype.notifyNext=function(){this.throttlingDone()},s.prototype.notifyComplete=function(){this.throttlingDone()},s}(SimpleOuterSubscriber);function throttleTime(a,s,d){return s===void 0&&(s=async),d===void 0&&(d=defaultThrottleConfig),function(c){return c.lift(new ThrottleTimeOperator(a,s,d.leading,d.trailing))}}var ThrottleTimeOperator=function(){function a(s,d,c,l){this.duration=s,this.scheduler=d,this.leading=c,this.trailing=l}return a.prototype.call=function(s,d){return d.subscribe(new ThrottleTimeSubscriber(s,this.duration,this.scheduler,this.leading,this.trailing))},a}(),ThrottleTimeSubscriber=function(a){__extends(s,a);function s(d,c,l,h,p){var y=a.call(this,d)||this;return y.duration=c,y.scheduler=l,y.leading=h,y.trailing=p,y._hasTrailingValue=!1,y._trailingValue=null,y}return s.prototype._next=function(d){this.throttled?this.trailing&&(this._trailingValue=d,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(dispatchNext,this.duration,{subscriber:this})),this.leading?this.destination.next(d):this.trailing&&(this._trailingValue=d,this._hasTrailingValue=!0))},s.prototype._complete=function(){this._hasTrailingValue?(this.destination.next(this._trailingValue),this.destination.complete()):this.destination.complete()},s.prototype.clearThrottle=function(){var d=this.throttled;d&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),d.unsubscribe(),this.remove(d),this.throttled=null)},s}(Subscriber);function dispatchNext(a){var s=a.subscriber;s.clearThrottle()}function defer(a){return new Observable(function(s){var d;try{d=a()}catch(l){s.error(l);return}var c=d?from(d):empty$1();return c.subscribe(s)})}function timeInterval(a){return a===void 0&&(a=async),function(s){return defer(function(){return s.pipe(scan(function(d,c){var l=d.current;return{value:c,current:a.now(),last:l}},{current:a.now(),value:void 0,last:void 0}),map(function(d){var c=d.current,l=d.last,h=d.value;return new TimeInterval(h,c-l)}))})}}var TimeInterval=function(){function a(s,d){this.value=s,this.interval=d}return a}(),TimeoutErrorImpl=function(){function a(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}return a.prototype=Object.create(Error.prototype),a}(),TimeoutError=TimeoutErrorImpl;function timeoutWith(a,s,d){return d===void 0&&(d=async),function(c){var l=isDate$1(a),h=l?+a-d.now():Math.abs(a);return c.lift(new TimeoutWithOperator(h,l,s,d))}}var TimeoutWithOperator=function(){function a(s,d,c,l){this.waitFor=s,this.absoluteTimeout=d,this.withObservable=c,this.scheduler=l}return a.prototype.call=function(s,d){return d.subscribe(new TimeoutWithSubscriber(s,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))},a}(),TimeoutWithSubscriber=function(a){__extends(s,a);function s(d,c,l,h,p){var y=a.call(this,d)||this;return y.absoluteTimeout=c,y.waitFor=l,y.withObservable=h,y.scheduler=p,y.scheduleTimeout(),y}return s.dispatchTimeout=function(d){var c=d.withObservable;d._unsubscribeAndRecycle(),d.add(innerSubscribe(c,new SimpleInnerSubscriber(d)))},s.prototype.scheduleTimeout=function(){var d=this.action;d?this.action=d.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(s.dispatchTimeout,this.waitFor,this))},s.prototype._next=function(d){this.absoluteTimeout||this.scheduleTimeout(),a.prototype._next.call(this,d)},s.prototype._unsubscribe=function(){this.action=void 0,this.scheduler=null,this.withObservable=null},s}(SimpleOuterSubscriber);function timeout(a,s){return s===void 0&&(s=async),timeoutWith(a,throwError(new TimeoutError),s)}function timestamp(a){return a===void 0&&(a=async),map(function(s){return new Timestamp(s,a.now())})}var Timestamp=function(){function a(s,d){this.value=s,this.timestamp=d}return a}();function toArrayReducer(a,s,d){return d===0?[s]:(a.push(s),a)}function toArray(){return reduce(toArrayReducer,[])}function window$1(a){return function(d){return d.lift(new WindowOperator$1(a))}}var WindowOperator$1=function(){function a(s){this.windowBoundaries=s}return a.prototype.call=function(s,d){var c=new WindowSubscriber$1(s),l=d.subscribe(c);return l.closed||c.add(innerSubscribe(this.windowBoundaries,new SimpleInnerSubscriber(c))),l},a}(),WindowSubscriber$1=function(a){__extends(s,a);function s(d){var c=a.call(this,d)||this;return c.window=new Subject,d.next(c.window),c}return s.prototype.notifyNext=function(){this.openWindow()},s.prototype.notifyError=function(d){this._error(d)},s.prototype.notifyComplete=function(){this._complete()},s.prototype._next=function(d){this.window.next(d)},s.prototype._error=function(d){this.window.error(d),this.destination.error(d)},s.prototype._complete=function(){this.window.complete(),this.destination.complete()},s.prototype._unsubscribe=function(){this.window=null},s.prototype.openWindow=function(){var d=this.window;d&&d.complete();var c=this.destination,l=this.window=new Subject;c.next(l)},s}(SimpleOuterSubscriber);function windowCount(a,s){return s===void 0&&(s=0),function(c){return c.lift(new WindowCountOperator(a,s))}}var WindowCountOperator=function(){function a(s,d){this.windowSize=s,this.startWindowEvery=d}return a.prototype.call=function(s,d){return d.subscribe(new WindowCountSubscriber(s,this.windowSize,this.startWindowEvery))},a}(),WindowCountSubscriber=function(a){__extends(s,a);function s(d,c,l){var h=a.call(this,d)||this;return h.destination=d,h.windowSize=c,h.startWindowEvery=l,h.windows=[new Subject],h.count=0,d.next(h.windows[0]),h}return s.prototype._next=function(d){for(var c=this.startWindowEvery>0?this.startWindowEvery:this.windowSize,l=this.destination,h=this.windowSize,p=this.windows,y=p.length,_=0;_<y&&!this.closed;_++)p[_].next(d);var E=this.count-h+1;if(E>=0&&E%c===0&&!this.closed&&p.shift().complete(),++this.count%c===0&&!this.closed){var O=new Subject;p.push(O),l.next(O)}},s.prototype._error=function(d){var c=this.windows;if(c)for(;c.length>0&&!this.closed;)c.shift().error(d);this.destination.error(d)},s.prototype._complete=function(){var d=this.windows;if(d)for(;d.length>0&&!this.closed;)d.shift().complete();this.destination.complete()},s.prototype._unsubscribe=function(){this.count=0,this.windows=null},s}(Subscriber);function windowTime(a){var s=async,d=null,c=Number.POSITIVE_INFINITY;return isScheduler(arguments[3])&&(s=arguments[3]),isScheduler(arguments[2])?s=arguments[2]:isNumeric(arguments[2])&&(c=Number(arguments[2])),isScheduler(arguments[1])?s=arguments[1]:isNumeric(arguments[1])&&(d=Number(arguments[1])),function(h){return h.lift(new WindowTimeOperator(a,d,c,s))}}var WindowTimeOperator=function(){function a(s,d,c,l){this.windowTimeSpan=s,this.windowCreationInterval=d,this.maxWindowSize=c,this.scheduler=l}return a.prototype.call=function(s,d){return d.subscribe(new WindowTimeSubscriber(s,this.windowTimeSpan,this.windowCreationInterval,this.maxWindowSize,this.scheduler))},a}(),CountedSubject=function(a){__extends(s,a);function s(){var d=a!==null&&a.apply(this,arguments)||this;return d._numberOfNextedValues=0,d}return s.prototype.next=function(d){this._numberOfNextedValues++,a.prototype.next.call(this,d)},Object.defineProperty(s.prototype,"numberOfNextedValues",{get:function(){return this._numberOfNextedValues},enumerable:!0,configurable:!0}),s}(Subject),WindowTimeSubscriber=function(a){__extends(s,a);function s(d,c,l,h,p){var y=a.call(this,d)||this;y.destination=d,y.windowTimeSpan=c,y.windowCreationInterval=l,y.maxWindowSize=h,y.scheduler=p,y.windows=[];var _=y.openWindow();if(l!==null&&l>=0){var E={subscriber:y,window:_,context:null},O={windowTimeSpan:c,windowCreationInterval:l,subscriber:y,scheduler:p};y.add(p.schedule(dispatchWindowClose,c,E)),y.add(p.schedule(dispatchWindowCreation,l,O))}else{var P={subscriber:y,window:_,windowTimeSpan:c};y.add(p.schedule(dispatchWindowTimeSpanOnly,c,P))}return y}return s.prototype._next=function(d){for(var c=this.windows,l=c.length,h=0;h<l;h++){var p=c[h];p.closed||(p.next(d),p.numberOfNextedValues>=this.maxWindowSize&&this.closeWindow(p))}},s.prototype._error=function(d){for(var c=this.windows;c.length>0;)c.shift().error(d);this.destination.error(d)},s.prototype._complete=function(){for(var d=this.windows;d.length>0;){var c=d.shift();c.closed||c.complete()}this.destination.complete()},s.prototype.openWindow=function(){var d=new CountedSubject;this.windows.push(d);var c=this.destination;return c.next(d),d},s.prototype.closeWindow=function(d){d.complete();var c=this.windows;c.splice(c.indexOf(d),1)},s}(Subscriber);function dispatchWindowTimeSpanOnly(a){var s=a.subscriber,d=a.windowTimeSpan,c=a.window;c&&s.closeWindow(c),a.window=s.openWindow(),this.schedule(a,d)}function dispatchWindowCreation(a){var s=a.windowTimeSpan,d=a.subscriber,c=a.scheduler,l=a.windowCreationInterval,h=d.openWindow(),p=this,y={action:p,subscription:null},_={subscriber:d,window:h,context:y};y.subscription=c.schedule(dispatchWindowClose,s,_),p.add(y.subscription),p.schedule(a,l)}function dispatchWindowClose(a){var s=a.subscriber,d=a.window,c=a.context;c&&c.action&&c.subscription&&c.action.remove(c.subscription),s.closeWindow(d)}function windowToggle(a,s){return function(d){return d.lift(new WindowToggleOperator(a,s))}}var WindowToggleOperator=function(){function a(s,d){this.openings=s,this.closingSelector=d}return a.prototype.call=function(s,d){return d.subscribe(new WindowToggleSubscriber(s,this.openings,this.closingSelector))},a}(),WindowToggleSubscriber=function(a){__extends(s,a);function s(d,c,l){var h=a.call(this,d)||this;return h.openings=c,h.closingSelector=l,h.contexts=[],h.add(h.openSubscription=subscribeToResult(h,c,c)),h}return s.prototype._next=function(d){var c=this.contexts;if(c)for(var l=c.length,h=0;h<l;h++)c[h].window.next(d)},s.prototype._error=function(d){var c=this.contexts;if(this.contexts=null,c)for(var l=c.length,h=-1;++h<l;){var p=c[h];p.window.error(d),p.subscription.unsubscribe()}a.prototype._error.call(this,d)},s.prototype._complete=function(){var d=this.contexts;if(this.contexts=null,d)for(var c=d.length,l=-1;++l<c;){var h=d[l];h.window.complete(),h.subscription.unsubscribe()}a.prototype._complete.call(this)},s.prototype._unsubscribe=function(){var d=this.contexts;if(this.contexts=null,d)for(var c=d.length,l=-1;++l<c;){var h=d[l];h.window.unsubscribe(),h.subscription.unsubscribe()}},s.prototype.notifyNext=function(d,c,l,h,p){if(d===this.openings){var y=void 0;try{var _=this.closingSelector;y=_(c)}catch(A){return this.error(A)}var E=new Subject,O=new Subscription,P={window:E,subscription:O};this.contexts.push(P);var C=subscribeToResult(this,y,P);C.closed?this.closeWindow(this.contexts.length-1):(C.context=P,O.add(C)),this.destination.next(E)}else this.closeWindow(this.contexts.indexOf(d))},s.prototype.notifyError=function(d){this.error(d)},s.prototype.notifyComplete=function(d){d!==this.openSubscription&&this.closeWindow(this.contexts.indexOf(d.context))},s.prototype.closeWindow=function(d){if(d!==-1){var c=this.contexts,l=c[d],h=l.window,p=l.subscription;c.splice(d,1),h.complete(),p.unsubscribe()}},s}(OuterSubscriber);function windowWhen(a){return function(d){return d.lift(new WindowOperator(a))}}var WindowOperator=function(){function a(s){this.closingSelector=s}return a.prototype.call=function(s,d){return d.subscribe(new WindowSubscriber(s,this.closingSelector))},a}(),WindowSubscriber=function(a){__extends(s,a);function s(d,c){var l=a.call(this,d)||this;return l.destination=d,l.closingSelector=c,l.openWindow(),l}return s.prototype.notifyNext=function(d,c,l,h,p){this.openWindow(p)},s.prototype.notifyError=function(d){this._error(d)},s.prototype.notifyComplete=function(d){this.openWindow(d)},s.prototype._next=function(d){this.window.next(d)},s.prototype._error=function(d){this.window.error(d),this.destination.error(d),this.unsubscribeClosingNotification()},s.prototype._complete=function(){this.window.complete(),this.destination.complete(),this.unsubscribeClosingNotification()},s.prototype.unsubscribeClosingNotification=function(){this.closingNotification&&this.closingNotification.unsubscribe()},s.prototype.openWindow=function(d){d===void 0&&(d=null),d&&(this.remove(d),d.unsubscribe());var c=this.window;c&&c.complete();var l=this.window=new Subject;this.destination.next(l);var h;try{var p=this.closingSelector;h=p()}catch(y){this.destination.error(y),this.window.error(y);return}this.add(this.closingNotification=subscribeToResult(this,h))},s}(OuterSubscriber);function withLatestFrom(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];return function(d){var c;typeof a[a.length-1]=="function"&&(c=a.pop());var l=a;return d.lift(new WithLatestFromOperator(l,c))}}var WithLatestFromOperator=function(){function a(s,d){this.observables=s,this.project=d}return a.prototype.call=function(s,d){return d.subscribe(new WithLatestFromSubscriber(s,this.observables,this.project))},a}(),WithLatestFromSubscriber=function(a){__extends(s,a);function s(d,c,l){var h=a.call(this,d)||this;h.observables=c,h.project=l,h.toRespond=[];var p=c.length;h.values=new Array(p);for(var y=0;y<p;y++)h.toRespond.push(y);for(var y=0;y<p;y++){var _=c[y];h.add(subscribeToResult(h,_,void 0,y))}return h}return s.prototype.notifyNext=function(d,c,l){this.values[l]=c;var h=this.toRespond;if(h.length>0){var p=h.indexOf(l);p!==-1&&h.splice(p,1)}},s.prototype.notifyComplete=function(){},s.prototype._next=function(d){if(this.toRespond.length===0){var c=[d].concat(this.values);this.project?this._tryProject(c):this.destination.next(c)}},s.prototype._tryProject=function(d){var c;try{c=this.project.apply(this,d)}catch(l){this.destination.error(l);return}this.destination.next(c)},s}(OuterSubscriber);function zip$1(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];var d=a[a.length-1];return typeof d=="function"&&a.pop(),fromArray(a,void 0).lift(new ZipOperator(d))}var ZipOperator=function(){function a(s){this.resultSelector=s}return a.prototype.call=function(s,d){return d.subscribe(new ZipSubscriber(s,this.resultSelector))},a}(),ZipSubscriber=function(a){__extends(s,a);function s(d,c,l){var h=a.call(this,d)||this;return h.resultSelector=c,h.iterators=[],h.active=0,h.resultSelector=typeof c=="function"?c:void 0,h}return s.prototype._next=function(d){var c=this.iterators;isArray$2(d)?c.push(new StaticArrayIterator(d)):typeof d[iterator]=="function"?c.push(new StaticIterator(d[iterator]())):c.push(new ZipBufferIterator(this.destination,this,d))},s.prototype._complete=function(){var d=this.iterators,c=d.length;if(this.unsubscribe(),c===0){this.destination.complete();return}this.active=c;for(var l=0;l<c;l++){var h=d[l];if(h.stillUnsubscribed){var p=this.destination;p.add(h.subscribe())}else this.active--}},s.prototype.notifyInactive=function(){this.active--,this.active===0&&this.destination.complete()},s.prototype.checkIterators=function(){for(var d=this.iterators,c=d.length,l=this.destination,h=0;h<c;h++){var p=d[h];if(typeof p.hasValue=="function"&&!p.hasValue())return}for(var y=!1,_=[],h=0;h<c;h++){var p=d[h],E=p.next();if(p.hasCompleted()&&(y=!0),E.done){l.complete();return}_.push(E.value)}this.resultSelector?this._tryresultSelector(_):l.next(_),y&&l.complete()},s.prototype._tryresultSelector=function(d){var c;try{c=this.resultSelector.apply(this,d)}catch(l){this.destination.error(l);return}this.destination.next(c)},s}(Subscriber),StaticIterator=function(){function a(s){this.iterator=s,this.nextResult=s.next()}return a.prototype.hasValue=function(){return!0},a.prototype.next=function(){var s=this.nextResult;return this.nextResult=this.iterator.next(),s},a.prototype.hasCompleted=function(){var s=this.nextResult;return Boolean(s&&s.done)},a}(),StaticArrayIterator=function(){function a(s){this.array=s,this.index=0,this.length=0,this.length=s.length}return a.prototype[iterator]=function(){return this},a.prototype.next=function(s){var d=this.index++,c=this.array;return d<this.length?{value:c[d],done:!1}:{value:null,done:!0}},a.prototype.hasValue=function(){return this.array.length>this.index},a.prototype.hasCompleted=function(){return this.array.length===this.index},a}(),ZipBufferIterator=function(a){__extends(s,a);function s(d,c,l){var h=a.call(this,d)||this;return h.parent=c,h.observable=l,h.stillUnsubscribed=!0,h.buffer=[],h.isComplete=!1,h}return s.prototype[iterator]=function(){return this},s.prototype.next=function(){var d=this.buffer;return d.length===0&&this.isComplete?{value:null,done:!0}:{value:d.shift(),done:!1}},s.prototype.hasValue=function(){return this.buffer.length>0},s.prototype.hasCompleted=function(){return this.buffer.length===0&&this.isComplete},s.prototype.notifyComplete=function(){this.buffer.length>0?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()},s.prototype.notifyNext=function(d){this.buffer.push(d),this.parent.checkIterators()},s.prototype.subscribe=function(){return innerSubscribe(this.observable,new SimpleInnerSubscriber(this))},s}(SimpleOuterSubscriber);function zip(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];return function(c){return c.lift.call(zip$1.apply(void 0,[c].concat(a)))}}function zipAll(a){return function(s){return s.lift(new ZipOperator(a))}}var operators=Object.freeze(Object.defineProperty({__proto__:null,audit,auditTime,buffer,bufferCount,bufferTime,bufferToggle,bufferWhen,catchError,combineAll,combineLatest,concat,concatAll,concatMap,concatMapTo,count,debounce,debounceTime,defaultIfEmpty,delay,delayWhen,dematerialize,distinct,distinctUntilChanged,distinctUntilKeyChanged,elementAt,endWith,every,exhaust,exhaustMap,expand,filter,finalize,find:find$1,findIndex,first,groupBy,ignoreElements,isEmpty,last,map,mapTo,materialize,max,merge:merge$1,mergeAll,mergeMap,flatMap,mergeMapTo,mergeScan,min,multicast,observeOn,onErrorResumeNext,pairwise,partition,pluck,publish,publishBehavior,publishLast,publishReplay,race,reduce,repeat,repeatWhen,retry,retryWhen,refCount,sample,sampleTime,scan,sequenceEqual,share,shareReplay,single,skip,skipLast,skipUntil,skipWhile,startWith,subscribeOn,switchAll,switchMap,switchMapTo,take,takeLast,takeUntil,takeWhile,tap,throttle,throttleTime,throwIfEmpty,timeInterval,timeout,timeoutWith,timestamp,toArray,window:window$1,windowCount,windowTime,windowToggle,windowWhen,withLatestFrom,zip,zipAll},Symbol.toStringTag,{value:"Module"})),require$$2=getAugmentedNamespace(operators),struct={};(function(a){var s=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(T,D,J,ee){ee===void 0&&(ee=J),Object.defineProperty(T,ee,{enumerable:!0,get:function(){return D[J]}})}:function(T,D,J,ee){ee===void 0&&(ee=J),T[ee]=D[J]}),d=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(T,D){Object.defineProperty(T,"default",{enumerable:!0,value:D})}:function(T,D){T.default=D}),c=commonjsGlobal&&commonjsGlobal.__importStar||function(T){if(T&&T.__esModule)return T;var D={};if(T!=null)for(var J in T)J!=="default"&&Object.hasOwnProperty.call(T,J)&&s(D,T,J);return d(D,T),D},l=commonjsGlobal&&commonjsGlobal.__importDefault||function(T){return T&&T.__esModule?T:{default:T}};Object.defineProperty(a,"__esModule",{value:!0}),a.ListValue=a.Value=a.Struct_FieldsEntry=a.Struct=a.nullValueToNumber=a.nullValueToJSON=a.nullValueFromJSON=a.NullValue=a.protobufPackage=void 0;const h=l(umd.exports),p=c(minimal);a.protobufPackage="google.protobuf";var y;(function(T){T.NULL_VALUE="NULL_VALUE"})(y=a.NullValue||(a.NullValue={}));function _(T){switch(T){case 0:case"NULL_VALUE":return y.NULL_VALUE;default:throw new U.Error("Unrecognized enum value "+T+" for enum NullValue")}}a.nullValueFromJSON=_;function E(T){switch(T){case y.NULL_VALUE:return"NULL_VALUE";default:return"UNKNOWN"}}a.nullValueToJSON=E;function O(T){switch(T){case y.NULL_VALUE:return 0;default:return 0}}a.nullValueToNumber=O;function P(){return{fields:{}}}a.Struct={encode(T,D=p.Writer.create()){return Object.entries(T.fields).forEach(([J,ee])=>{ee!==void 0&&a.Struct_FieldsEntry.encode({key:J,value:ee},D.uint32(10).fork()).ldelim()}),D},decode(T,D){const J=T instanceof p.Reader?T:new p.Reader(T);let ee=D===void 0?J.len:J.pos+D;const z=P();for(;J.pos<ee;){const ne=J.uint32();switch(ne>>>3){case 1:const X=a.Struct_FieldsEntry.decode(J,J.uint32());X.value!==void 0&&(z.fields[X.key]=X.value);break;default:J.skipType(ne&7);break}}return z},fromJSON(T){return{fields:F(T.fields)?Object.entries(T.fields).reduce((D,[J,ee])=>(D[J]=ee,D),{}):{}}},toJSON(T){const D={};return D.fields={},T.fields&&Object.entries(T.fields).forEach(([J,ee])=>{D.fields[J]=ee}),D},fromPartial(T){var D;const J=P();return J.fields=Object.entries((D=T.fields)!==null&&D!==void 0?D:{}).reduce((ee,[z,ne])=>(ne!==void 0&&(ee[z]=ne),ee),{}),J},wrap(T){const D=P();return T!==void 0&&Object.keys(T).forEach(J=>{D.fields[J]=T[J]}),D},unwrap(T){const D={};return Object.keys(T.fields).forEach(J=>{D[J]=T.fields[J]}),D}};function C(){return{key:"",value:void 0}}a.Struct_FieldsEntry={encode(T,D=p.Writer.create()){return T.key!==""&&D.uint32(10).string(T.key),T.value!==void 0&&a.Value.encode(a.Value.wrap(T.value),D.uint32(18).fork()).ldelim(),D},decode(T,D){const J=T instanceof p.Reader?T:new p.Reader(T);let ee=D===void 0?J.len:J.pos+D;const z=C();for(;J.pos<ee;){const ne=J.uint32();switch(ne>>>3){case 1:z.key=J.string();break;case 2:z.value=a.Value.unwrap(a.Value.decode(J,J.uint32()));break;default:J.skipType(ne&7);break}}return z},fromJSON(T){return{key:j(T.key)?String(T.key):"",value:j(T==null?void 0:T.value)?T.value:void 0}},toJSON(T){const D={};return T.key!==void 0&&(D.key=T.key),T.value!==void 0&&(D.value=T.value),D},fromPartial(T){var D,J;const ee=C();return ee.key=(D=T.key)!==null&&D!==void 0?D:"",ee.value=(J=T.value)!==null&&J!==void 0?J:void 0,ee}};function A(){return{nullValue:void 0,numberValue:void 0,stringValue:void 0,boolValue:void 0,structValue:void 0,listValue:void 0}}a.Value={encode(T,D=p.Writer.create()){return T.nullValue!==void 0&&D.uint32(8).int32(O(T.nullValue)),T.numberValue!==void 0&&D.uint32(17).double(T.numberValue),T.stringValue!==void 0&&D.uint32(26).string(T.stringValue),T.boolValue!==void 0&&D.uint32(32).bool(T.boolValue),T.structValue!==void 0&&a.Struct.encode(a.Struct.wrap(T.structValue),D.uint32(42).fork()).ldelim(),T.listValue!==void 0&&a.ListValue.encode(a.ListValue.wrap(T.listValue),D.uint32(50).fork()).ldelim(),D},decode(T,D){const J=T instanceof p.Reader?T:new p.Reader(T);let ee=D===void 0?J.len:J.pos+D;const z=A();for(;J.pos<ee;){const ne=J.uint32();switch(ne>>>3){case 1:z.nullValue=_(J.int32());break;case 2:z.numberValue=J.double();break;case 3:z.stringValue=J.string();break;case 4:z.boolValue=J.bool();break;case 5:z.structValue=a.Struct.unwrap(a.Struct.decode(J,J.uint32()));break;case 6:z.listValue=a.ListValue.unwrap(a.ListValue.decode(J,J.uint32()));break;default:J.skipType(ne&7);break}}return z},fromJSON(T){return{nullValue:j(T.nullValue)?_(T.nullValue):void 0,numberValue:j(T.numberValue)?Number(T.numberValue):void 0,stringValue:j(T.stringValue)?String(T.stringValue):void 0,boolValue:j(T.boolValue)?Boolean(T.boolValue):void 0,structValue:F(T.structValue)?T.structValue:void 0,listValue:Array.isArray(T.listValue)?[...T.listValue]:void 0}},toJSON(T){const D={};return T.nullValue!==void 0&&(D.nullValue=T.nullValue!==void 0?E(T.nullValue):void 0),T.numberValue!==void 0&&(D.numberValue=T.numberValue),T.stringValue!==void 0&&(D.stringValue=T.stringValue),T.boolValue!==void 0&&(D.boolValue=T.boolValue),T.structValue!==void 0&&(D.structValue=T.structValue),T.listValue!==void 0&&(D.listValue=T.listValue),D},fromPartial(T){var D,J,ee,z,ne,X;const M=A();return M.nullValue=(D=T.nullValue)!==null&&D!==void 0?D:void 0,M.numberValue=(J=T.numberValue)!==null&&J!==void 0?J:void 0,M.stringValue=(ee=T.stringValue)!==null&&ee!==void 0?ee:void 0,M.boolValue=(z=T.boolValue)!==null&&z!==void 0?z:void 0,M.structValue=(ne=T.structValue)!==null&&ne!==void 0?ne:void 0,M.listValue=(X=T.listValue)!==null&&X!==void 0?X:void 0,M},wrap(T){const D=A();if(T===null)D.nullValue=y.NULL_VALUE;else if(typeof T=="boolean")D.boolValue=T;else if(typeof T=="number")D.numberValue=T;else if(typeof T=="string")D.stringValue=T;else if(Array.isArray(T))D.listValue=T;else if(typeof T=="object")D.structValue=T;else if(typeof T!="undefined")throw new Error("Unsupported any value type: "+typeof T);return D},unwrap(T){if((T==null?void 0:T.stringValue)!==void 0)return T.stringValue;if((T==null?void 0:T.numberValue)!==void 0)return T.numberValue;if((T==null?void 0:T.boolValue)!==void 0)return T.boolValue;if((T==null?void 0:T.structValue)!==void 0)return T.structValue;if((T==null?void 0:T.listValue)!==void 0)return T.listValue;if((T==null?void 0:T.nullValue)!==void 0)return null}};function q(){return{values:[]}}a.ListValue={encode(T,D=p.Writer.create()){for(const J of T.values)a.Value.encode(a.Value.wrap(J),D.uint32(10).fork()).ldelim();return D},decode(T,D){const J=T instanceof p.Reader?T:new p.Reader(T);let ee=D===void 0?J.len:J.pos+D;const z=q();for(;J.pos<ee;){const ne=J.uint32();switch(ne>>>3){case 1:z.values.push(a.Value.unwrap(a.Value.decode(J,J.uint32())));break;default:J.skipType(ne&7);break}}return z},fromJSON(T){return{values:Array.isArray(T==null?void 0:T.values)?[...T.values]:[]}},toJSON(T){const D={};return T.values?D.values=T.values.map(J=>J):D.values=[],D},fromPartial(T){var D;const J=q();return J.values=((D=T.values)===null||D===void 0?void 0:D.map(ee=>ee))||[],J},wrap(T){const D=q();return D.values=T!=null?T:[],D},unwrap(T){return T.values}};var U=(()=>{if(typeof U!="undefined")return U;if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof commonjsGlobal!="undefined")return commonjsGlobal;throw"Unable to locate global object"})();p.util.Long!==h.default&&(p.util.Long=h.default,p.configure());function F(T){return typeof T=="object"&&T!==null}function j(T){return T!=null}})(struct),function(a){var s=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(M,K,te,L){L===void 0&&(L=te),Object.defineProperty(M,L,{enumerable:!0,get:function(){return K[te]}})}:function(M,K,te,L){L===void 0&&(L=te),M[L]=K[te]}),d=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(M,K){Object.defineProperty(M,"default",{enumerable:!0,value:K})}:function(M,K){M.default=K}),c=commonjsGlobal&&commonjsGlobal.__importStar||function(M){if(M&&M.__esModule)return M;var K={};if(M!=null)for(var te in M)te!=="default"&&Object.hasOwnProperty.call(M,te)&&s(K,M,te);return d(K,M),K},l=commonjsGlobal&&commonjsGlobal.__importDefault||function(M){return M&&M.__esModule?M:{default:M}};Object.defineProperty(a,"__esModule",{value:!0}),a.EventServiceDefinition=a.EventServiceClientImpl=a.EventsStreamResponse=a.EventsStreamRequest=a.EventsStreamReconnectRequest=a.EventsStreamError=a.SubscribePayload=a.PublishEventResponse=a.PublishEventRequest=a.EventTarget=a.eventsStreamMessageTypeToNumber=a.eventsStreamMessageTypeToJSON=a.eventsStreamMessageTypeFromJSON=a.EventsStreamMessageType=a.protobufPackage=void 0;const h=l(umd.exports),p=c(minimal),y=require$$2,_=struct;a.protobufPackage="apis.event.v2";var E;(function(M){M.EVENTS_STREAM_MESSAGE_TYPE_UNSPECIFIED="EVENTS_STREAM_MESSAGE_TYPE_UNSPECIFIED",M.EVENTS_STREAM_MESSAGE_TYPE_PING="EVENTS_STREAM_MESSAGE_TYPE_PING",M.EVENTS_STREAM_MESSAGE_TYPE_ERROR="EVENTS_STREAM_MESSAGE_TYPE_ERROR",M.EVENTS_STREAM_MESSAGE_TYPE_SUBSCRIBED="EVENTS_STREAM_MESSAGE_TYPE_SUBSCRIBED",M.EVENTS_STREAM_MESSAGE_TYPE_UNSUBSCRIBED="EVENTS_STREAM_MESSAGE_TYPE_UNSUBSCRIBED",M.EVENTS_STREAM_MESSAGE_TYPE_PUBLISHED="EVENTS_STREAM_MESSAGE_TYPE_PUBLISHED"})(E=a.EventsStreamMessageType||(a.EventsStreamMessageType={}));function O(M){switch(M){case 0:case"EVENTS_STREAM_MESSAGE_TYPE_UNSPECIFIED":return E.EVENTS_STREAM_MESSAGE_TYPE_UNSPECIFIED;case 1:case"EVENTS_STREAM_MESSAGE_TYPE_PING":return E.EVENTS_STREAM_MESSAGE_TYPE_PING;case 2:case"EVENTS_STREAM_MESSAGE_TYPE_ERROR":return E.EVENTS_STREAM_MESSAGE_TYPE_ERROR;case 3:case"EVENTS_STREAM_MESSAGE_TYPE_SUBSCRIBED":return E.EVENTS_STREAM_MESSAGE_TYPE_SUBSCRIBED;case 4:case"EVENTS_STREAM_MESSAGE_TYPE_UNSUBSCRIBED":return E.EVENTS_STREAM_MESSAGE_TYPE_UNSUBSCRIBED;case 5:case"EVENTS_STREAM_MESSAGE_TYPE_PUBLISHED":return E.EVENTS_STREAM_MESSAGE_TYPE_PUBLISHED;default:throw new z.Error("Unrecognized enum value "+M+" for enum EventsStreamMessageType")}}a.eventsStreamMessageTypeFromJSON=O;function P(M){switch(M){case E.EVENTS_STREAM_MESSAGE_TYPE_UNSPECIFIED:return"EVENTS_STREAM_MESSAGE_TYPE_UNSPECIFIED";case E.EVENTS_STREAM_MESSAGE_TYPE_PING:return"EVENTS_STREAM_MESSAGE_TYPE_PING";case E.EVENTS_STREAM_MESSAGE_TYPE_ERROR:return"EVENTS_STREAM_MESSAGE_TYPE_ERROR";case E.EVENTS_STREAM_MESSAGE_TYPE_SUBSCRIBED:return"EVENTS_STREAM_MESSAGE_TYPE_SUBSCRIBED";case E.EVENTS_STREAM_MESSAGE_TYPE_UNSUBSCRIBED:return"EVENTS_STREAM_MESSAGE_TYPE_UNSUBSCRIBED";case E.EVENTS_STREAM_MESSAGE_TYPE_PUBLISHED:return"EVENTS_STREAM_MESSAGE_TYPE_PUBLISHED";default:return"UNKNOWN"}}a.eventsStreamMessageTypeToJSON=P;function C(M){switch(M){case E.EVENTS_STREAM_MESSAGE_TYPE_UNSPECIFIED:return 0;case E.EVENTS_STREAM_MESSAGE_TYPE_PING:return 1;case E.EVENTS_STREAM_MESSAGE_TYPE_ERROR:return 2;case E.EVENTS_STREAM_MESSAGE_TYPE_SUBSCRIBED:return 3;case E.EVENTS_STREAM_MESSAGE_TYPE_UNSUBSCRIBED:return 4;case E.EVENTS_STREAM_MESSAGE_TYPE_PUBLISHED:return 5;default:return 0}}a.eventsStreamMessageTypeToNumber=C;function A(){return{collectionId:void 0,projectId:void 0,layoutId:void 0}}a.EventTarget={encode(M,K=p.Writer.create()){return M.collectionId!==void 0&&K.uint32(42).string(M.collectionId),M.projectId!==void 0&&K.uint32(34).string(M.projectId),M.layoutId!==void 0&&K.uint32(10).string(M.layoutId),K},decode(M,K){const te=M instanceof p.Reader?M:new p.Reader(M);let L=K===void 0?te.len:te.pos+K;const G=A();for(;te.pos<L;){const W=te.uint32();switch(W>>>3){case 5:G.collectionId=te.string();break;case 4:G.projectId=te.string();break;case 1:G.layoutId=te.string();break;default:te.skipType(W&7);break}}return G},fromJSON(M){return{collectionId:X(M.collectionId)?String(M.collectionId):void 0,projectId:X(M.projectId)?String(M.projectId):void 0,layoutId:X(M.layoutId)?String(M.layoutId):void 0}},toJSON(M){const K={};return M.collectionId!==void 0&&(K.collectionId=M.collectionId),M.projectId!==void 0&&(K.projectId=M.projectId),M.layoutId!==void 0&&(K.layoutId=M.layoutId),K},fromPartial(M){var K,te,L;const G=A();return G.collectionId=(K=M.collectionId)!==null&&K!==void 0?K:void 0,G.projectId=(te=M.projectId)!==null&&te!==void 0?te:void 0,G.layoutId=(L=M.layoutId)!==null&&L!==void 0?L:void 0,G}};function q(){return{name:"",payload:void 0,requestMetadata:void 0,target:void 0}}a.PublishEventRequest={encode(M,K=p.Writer.create()){return M.name!==""&&K.uint32(10).string(M.name),M.payload!==void 0&&_.Struct.encode(_.Struct.wrap(M.payload),K.uint32(18).fork()).ldelim(),M.requestMetadata!==void 0&&_.Value.encode(_.Value.wrap(M.requestMetadata),K.uint32(34).fork()).ldelim(),M.target!==void 0&&a.EventTarget.encode(M.target,K.uint32(26).fork()).ldelim(),K},decode(M,K){const te=M instanceof p.Reader?M:new p.Reader(M);let L=K===void 0?te.len:te.pos+K;const G=q();for(;te.pos<L;){const W=te.uint32();switch(W>>>3){case 1:G.name=te.string();break;case 2:G.payload=_.Struct.unwrap(_.Struct.decode(te,te.uint32()));break;case 4:G.requestMetadata=_.Value.unwrap(_.Value.decode(te,te.uint32()));break;case 3:G.target=a.EventTarget.decode(te,te.uint32());break;default:te.skipType(W&7);break}}return G},fromJSON(M){return{name:X(M.name)?String(M.name):"",payload:ne(M.payload)?M.payload:void 0,requestMetadata:X(M==null?void 0:M.requestMetadata)?M.requestMetadata:void 0,target:X(M.target)?a.EventTarget.fromJSON(M.target):void 0}},toJSON(M){const K={};return M.name!==void 0&&(K.name=M.name),M.payload!==void 0&&(K.payload=M.payload),M.requestMetadata!==void 0&&(K.requestMetadata=M.requestMetadata),M.target!==void 0&&(K.target=M.target?a.EventTarget.toJSON(M.target):void 0),K},fromPartial(M){var K,te,L;const G=q();return G.name=(K=M.name)!==null&&K!==void 0?K:"",G.payload=(te=M.payload)!==null&&te!==void 0?te:void 0,G.requestMetadata=(L=M.requestMetadata)!==null&&L!==void 0?L:void 0,G.target=M.target!==void 0&&M.target!==null?a.EventTarget.fromPartial(M.target):void 0,G}};function U(){return{name:"",payload:void 0,target:void 0,requestMetadata:void 0,id:""}}a.PublishEventResponse={encode(M,K=p.Writer.create()){return M.name!==""&&K.uint32(10).string(M.name),M.payload!==void 0&&_.Struct.encode(_.Struct.wrap(M.payload),K.uint32(18).fork()).ldelim(),M.target!==void 0&&a.EventTarget.encode(M.target,K.uint32(26).fork()).ldelim(),M.requestMetadata!==void 0&&_.Value.encode(_.Value.wrap(M.requestMetadata),K.uint32(34).fork()).ldelim(),M.id!==""&&K.uint32(42).string(M.id),K},decode(M,K){const te=M instanceof p.Reader?M:new p.Reader(M);let L=K===void 0?te.len:te.pos+K;const G=U();for(;te.pos<L;){const W=te.uint32();switch(W>>>3){case 1:G.name=te.string();break;case 2:G.payload=_.Struct.unwrap(_.Struct.decode(te,te.uint32()));break;case 3:G.target=a.EventTarget.decode(te,te.uint32());break;case 4:G.requestMetadata=_.Value.unwrap(_.Value.decode(te,te.uint32()));break;case 5:G.id=te.string();break;default:te.skipType(W&7);break}}return G},fromJSON(M){return{name:X(M.name)?String(M.name):"",payload:ne(M.payload)?M.payload:void 0,target:X(M.target)?a.EventTarget.fromJSON(M.target):void 0,requestMetadata:X(M==null?void 0:M.requestMetadata)?M.requestMetadata:void 0,id:X(M.id)?String(M.id):""}},toJSON(M){const K={};return M.name!==void 0&&(K.name=M.name),M.payload!==void 0&&(K.payload=M.payload),M.target!==void 0&&(K.target=M.target?a.EventTarget.toJSON(M.target):void 0),M.requestMetadata!==void 0&&(K.requestMetadata=M.requestMetadata),M.id!==void 0&&(K.id=M.id),K},fromPartial(M){var K,te,L,G;const W=U();return W.name=(K=M.name)!==null&&K!==void 0?K:"",W.payload=(te=M.payload)!==null&&te!==void 0?te:void 0,W.target=M.target!==void 0&&M.target!==null?a.EventTarget.fromPartial(M.target):void 0,W.requestMetadata=(L=M.requestMetadata)!==null&&L!==void 0?L:void 0,W.id=(G=M.id)!==null&&G!==void 0?G:"",W}};function F(){return{name:"",target:void 0}}a.SubscribePayload={encode(M,K=p.Writer.create()){return M.name!==""&&K.uint32(10).string(M.name),M.target!==void 0&&a.EventTarget.encode(M.target,K.uint32(18).fork()).ldelim(),K},decode(M,K){const te=M instanceof p.Reader?M:new p.Reader(M);let L=K===void 0?te.len:te.pos+K;const G=F();for(;te.pos<L;){const W=te.uint32();switch(W>>>3){case 1:G.name=te.string();break;case 2:G.target=a.EventTarget.decode(te,te.uint32());break;default:te.skipType(W&7);break}}return G},fromJSON(M){return{name:X(M.name)?String(M.name):"",target:X(M.target)?a.EventTarget.fromJSON(M.target):void 0}},toJSON(M){const K={};return M.name!==void 0&&(K.name=M.name),M.target!==void 0&&(K.target=M.target?a.EventTarget.toJSON(M.target):void 0),K},fromPartial(M){var K;const te=F();return te.name=(K=M.name)!==null&&K!==void 0?K:"",te.target=M.target!==void 0&&M.target!==null?a.EventTarget.fromPartial(M.target):void 0,te}};function j(){return{code:0,message:""}}a.EventsStreamError={encode(M,K=p.Writer.create()){return M.code!==0&&K.uint32(8).int32(M.code),M.message!==""&&K.uint32(18).string(M.message),K},decode(M,K){const te=M instanceof p.Reader?M:new p.Reader(M);let L=K===void 0?te.len:te.pos+K;const G=j();for(;te.pos<L;){const W=te.uint32();switch(W>>>3){case 1:G.code=te.int32();break;case 2:G.message=te.string();break;default:te.skipType(W&7);break}}return G},fromJSON(M){return{code:X(M.code)?Number(M.code):0,message:X(M.message)?String(M.message):""}},toJSON(M){const K={};return M.code!==void 0&&(K.code=Math.round(M.code)),M.message!==void 0&&(K.message=M.message),K},fromPartial(M){var K,te;const L=j();return L.code=(K=M.code)!==null&&K!==void 0?K:0,L.message=(te=M.message)!==null&&te!==void 0?te:"",L}};function T(){return{reauthenticate:!1,beforeTimestamp:""}}a.EventsStreamReconnectRequest={encode(M,K=p.Writer.create()){return M.reauthenticate===!0&&K.uint32(8).bool(M.reauthenticate),M.beforeTimestamp!==""&&K.uint32(18).string(M.beforeTimestamp),K},decode(M,K){const te=M instanceof p.Reader?M:new p.Reader(M);let L=K===void 0?te.len:te.pos+K;const G=T();for(;te.pos<L;){const W=te.uint32();switch(W>>>3){case 1:G.reauthenticate=te.bool();break;case 2:G.beforeTimestamp=te.string();break;default:te.skipType(W&7);break}}return G},fromJSON(M){return{reauthenticate:X(M.reauthenticate)?Boolean(M.reauthenticate):!1,beforeTimestamp:X(M.beforeTimestamp)?String(M.beforeTimestamp):""}},toJSON(M){const K={};return M.reauthenticate!==void 0&&(K.reauthenticate=M.reauthenticate),M.beforeTimestamp!==void 0&&(K.beforeTimestamp=M.beforeTimestamp),K},fromPartial(M){var K,te;const L=T();return L.reauthenticate=(K=M.reauthenticate)!==null&&K!==void 0?K:!1,L.beforeTimestamp=(te=M.beforeTimestamp)!==null&&te!==void 0?te:"",L}};function D(){return{correlationId:void 0,subscribe:void 0,unsubscribe:void 0,publish:void 0,ping:void 0}}a.EventsStreamRequest={encode(M,K=p.Writer.create()){return M.correlationId!==void 0&&K.uint32(10).string(M.correlationId),M.subscribe!==void 0&&a.SubscribePayload.encode(M.subscribe,K.uint32(802).fork()).ldelim(),M.unsubscribe!==void 0&&a.SubscribePayload.encode(M.unsubscribe,K.uint32(810).fork()).ldelim(),M.publish!==void 0&&a.PublishEventRequest.encode(M.publish,K.uint32(818).fork()).ldelim(),M.ping!==void 0&&K.uint32(826).string(M.ping),K},decode(M,K){const te=M instanceof p.Reader?M:new p.Reader(M);let L=K===void 0?te.len:te.pos+K;const G=D();for(;te.pos<L;){const W=te.uint32();switch(W>>>3){case 1:G.correlationId=te.string();break;case 100:G.subscribe=a.SubscribePayload.decode(te,te.uint32());break;case 101:G.unsubscribe=a.SubscribePayload.decode(te,te.uint32());break;case 102:G.publish=a.PublishEventRequest.decode(te,te.uint32());break;case 103:G.ping=te.string();break;default:te.skipType(W&7);break}}return G},fromJSON(M){return{correlationId:X(M.correlationId)?String(M.correlationId):void 0,subscribe:X(M.subscribe)?a.SubscribePayload.fromJSON(M.subscribe):void 0,unsubscribe:X(M.unsubscribe)?a.SubscribePayload.fromJSON(M.unsubscribe):void 0,publish:X(M.publish)?a.PublishEventRequest.fromJSON(M.publish):void 0,ping:X(M.ping)?String(M.ping):void 0}},toJSON(M){const K={};return M.correlationId!==void 0&&(K.correlationId=M.correlationId),M.subscribe!==void 0&&(K.subscribe=M.subscribe?a.SubscribePayload.toJSON(M.subscribe):void 0),M.unsubscribe!==void 0&&(K.unsubscribe=M.unsubscribe?a.SubscribePayload.toJSON(M.unsubscribe):void 0),M.publish!==void 0&&(K.publish=M.publish?a.PublishEventRequest.toJSON(M.publish):void 0),M.ping!==void 0&&(K.ping=M.ping),K},fromPartial(M){var K,te;const L=D();return L.correlationId=(K=M.correlationId)!==null&&K!==void 0?K:void 0,L.subscribe=M.subscribe!==void 0&&M.subscribe!==null?a.SubscribePayload.fromPartial(M.subscribe):void 0,L.unsubscribe=M.unsubscribe!==void 0&&M.unsubscribe!==null?a.SubscribePayload.fromPartial(M.unsubscribe):void 0,L.publish=M.publish!==void 0&&M.publish!==null?a.PublishEventRequest.fromPartial(M.publish):void 0,L.ping=(te=M.ping)!==null&&te!==void 0?te:void 0,L}};function J(){return{correlationId:void 0,sessionId:void 0,event:void 0,pong:void 0,error:void 0,subscribed:void 0,unsubscribed:void 0,published:void 0,reconnectBefore:void 0}}a.EventsStreamResponse={encode(M,K=p.Writer.create()){return M.correlationId!==void 0&&K.uint32(18).string(M.correlationId),M.sessionId!==void 0&&K.uint32(26).string(M.sessionId),M.event!==void 0&&a.PublishEventResponse.encode(M.event,K.uint32(802).fork()).ldelim(),M.pong!==void 0&&K.uint32(1602).string(M.pong),M.error!==void 0&&a.EventsStreamError.encode(M.error,K.uint32(1610).fork()).ldelim(),M.subscribed!==void 0&&a.SubscribePayload.encode(M.subscribed,K.uint32(1618).fork()).ldelim(),M.unsubscribed!==void 0&&a.SubscribePayload.encode(M.unsubscribed,K.uint32(1626).fork()).ldelim(),M.published!==void 0&&a.PublishEventResponse.encode(M.published,K.uint32(1634).fork()).ldelim(),M.reconnectBefore!==void 0&&a.EventsStreamReconnectRequest.encode(M.reconnectBefore,K.uint32(1642).fork()).ldelim(),K},decode(M,K){const te=M instanceof p.Reader?M:new p.Reader(M);let L=K===void 0?te.len:te.pos+K;const G=J();for(;te.pos<L;){const W=te.uint32();switch(W>>>3){case 2:G.correlationId=te.string();break;case 3:G.sessionId=te.string();break;case 100:G.event=a.PublishEventResponse.decode(te,te.uint32());break;case 200:G.pong=te.string();break;case 201:G.error=a.EventsStreamError.decode(te,te.uint32());break;case 202:G.subscribed=a.SubscribePayload.decode(te,te.uint32());break;case 203:G.unsubscribed=a.SubscribePayload.decode(te,te.uint32());break;case 204:G.published=a.PublishEventResponse.decode(te,te.uint32());break;case 205:G.reconnectBefore=a.EventsStreamReconnectRequest.decode(te,te.uint32());break;default:te.skipType(W&7);break}}return G},fromJSON(M){return{correlationId:X(M.correlationId)?String(M.correlationId):void 0,sessionId:X(M.sessionId)?String(M.sessionId):void 0,event:X(M.event)?a.PublishEventResponse.fromJSON(M.event):void 0,pong:X(M.pong)?String(M.pong):void 0,error:X(M.error)?a.EventsStreamError.fromJSON(M.error):void 0,subscribed:X(M.subscribed)?a.SubscribePayload.fromJSON(M.subscribed):void 0,unsubscribed:X(M.unsubscribed)?a.SubscribePayload.fromJSON(M.unsubscribed):void 0,published:X(M.published)?a.PublishEventResponse.fromJSON(M.published):void 0,reconnectBefore:X(M.reconnectBefore)?a.EventsStreamReconnectRequest.fromJSON(M.reconnectBefore):void 0}},toJSON(M){const K={};return M.correlationId!==void 0&&(K.correlationId=M.correlationId),M.sessionId!==void 0&&(K.sessionId=M.sessionId),M.event!==void 0&&(K.event=M.event?a.PublishEventResponse.toJSON(M.event):void 0),M.pong!==void 0&&(K.pong=M.pong),M.error!==void 0&&(K.error=M.error?a.EventsStreamError.toJSON(M.error):void 0),M.subscribed!==void 0&&(K.subscribed=M.subscribed?a.SubscribePayload.toJSON(M.subscribed):void 0),M.unsubscribed!==void 0&&(K.unsubscribed=M.unsubscribed?a.SubscribePayload.toJSON(M.unsubscribed):void 0),M.published!==void 0&&(K.published=M.published?a.PublishEventResponse.toJSON(M.published):void 0),M.reconnectBefore!==void 0&&(K.reconnectBefore=M.reconnectBefore?a.EventsStreamReconnectRequest.toJSON(M.reconnectBefore):void 0),K},fromPartial(M){var K,te,L;const G=J();return G.correlationId=(K=M.correlationId)!==null&&K!==void 0?K:void 0,G.sessionId=(te=M.sessionId)!==null&&te!==void 0?te:void 0,G.event=M.event!==void 0&&M.event!==null?a.PublishEventResponse.fromPartial(M.event):void 0,G.pong=(L=M.pong)!==null&&L!==void 0?L:void 0,G.error=M.error!==void 0&&M.error!==null?a.EventsStreamError.fromPartial(M.error):void 0,G.subscribed=M.subscribed!==void 0&&M.subscribed!==null?a.SubscribePayload.fromPartial(M.subscribed):void 0,G.unsubscribed=M.unsubscribed!==void 0&&M.unsubscribed!==null?a.SubscribePayload.fromPartial(M.unsubscribed):void 0,G.published=M.published!==void 0&&M.published!==null?a.PublishEventResponse.fromPartial(M.published):void 0,G.reconnectBefore=M.reconnectBefore!==void 0&&M.reconnectBefore!==null?a.EventsStreamReconnectRequest.fromPartial(M.reconnectBefore):void 0,G}};class ee{constructor(K){this.rpc=K,this.Stream=this.Stream.bind(this),this.Publish=this.Publish.bind(this)}Stream(K){const te=K.pipe(y.map(G=>a.EventsStreamRequest.encode(G).finish()));return this.rpc.bidirectionalStreamingRequest("apis.event.v2.EventService","Stream",te).pipe(y.map(G=>a.EventsStreamResponse.decode(new p.Reader(G))))}Publish(K){const te=a.PublishEventRequest.encode(K).finish();return this.rpc.request("apis.event.v2.EventService","Publish",te).then(G=>a.PublishEventResponse.decode(new p.Reader(G)))}}a.EventServiceClientImpl=ee,a.EventServiceDefinition={name:"EventService",fullName:"apis.event.v2.EventService",methods:{stream:{name:"Stream",requestType:a.EventsStreamRequest,requestStream:!0,responseType:a.EventsStreamResponse,responseStream:!0,options:{}},publish:{name:"Publish",requestType:a.PublishEventRequest,requestStream:!1,responseType:a.PublishEventResponse,responseStream:!1,options:{}}}};var z=(()=>{if(typeof z!="undefined")return z;if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof commonjsGlobal!="undefined")return commonjsGlobal;throw"Unable to locate global object"})();p.util.Long!==h.default&&(p.util.Long=h.default,p.configure());function ne(M){return typeof M=="object"&&M!==null}function X(M){return M!=null}}(api),function(a){var s=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(c,l,h,p){p===void 0&&(p=h),Object.defineProperty(c,p,{enumerable:!0,get:function(){return l[h]}})}:function(c,l,h,p){p===void 0&&(p=h),c[p]=l[h]}),d=commonjsGlobal&&commonjsGlobal.__exportStar||function(c,l){for(var h in c)h!=="default"&&!l.hasOwnProperty(h)&&s(l,c,h)};Object.defineProperty(a,"__esModule",{value:!0}),a.eventsApiSupportedEvents=a.eventsApiEventRpcCalls=void 0,d(api,a),a.eventsApiEventRpcCalls={ping:"pong",publish:"published",subscribe:"subscribed",unsubscribe:"unsubscribed"},a.eventsApiSupportedEvents=[...Object.values(a.eventsApiEventRpcCalls),"error","event","reconnectBefore"]}(dist$2);var ws=null;typeof WebSocket!="undefined"?ws=WebSocket:typeof MozWebSocket!="undefined"?ws=MozWebSocket:typeof commonjsGlobal!="undefined"?ws=commonjsGlobal.WebSocket||commonjsGlobal.MozWebSocket:typeof window!="undefined"?ws=window.WebSocket||window.MozWebSocket:typeof self!="undefined"&&(ws=self.WebSocket||self.MozWebSocket);var browser$1=ws,matcher={exports:{}},escapeStringRegexp$1=a=>{if(typeof a!="string")throw new TypeError("Expected a string");return a.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")};const escapeStringRegexp=escapeStringRegexp$1,regexpCache=new Map;function sanitizeArray(a,s){if(!Array.isArray(a))switch(typeof a){case"string":a=[a];break;case"undefined":a=[];break;default:throw new TypeError(`Expected '${s}' to be a string or an array, but got a type of '${typeof a}'`)}return a.filter(d=>{if(typeof d!="string"){if(typeof d=="undefined")return!1;throw new TypeError(`Expected '${s}' to be an array of strings, but found a type of '${typeof d}' in the array`)}return!0})}function makeRegexp(a,s){s={caseSensitive:!1,...s};const d=a+JSON.stringify(s);if(regexpCache.has(d))return regexpCache.get(d);const c=a[0]==="!";c&&(a=a.slice(1)),a=escapeStringRegexp(a).replace(/\\\*/g,"[\\s\\S]*");const l=new RegExp(`^${a}$`,s.caseSensitive?"":"i");return l.negated=c,regexpCache.set(d,l),l}matcher.exports=(a,s,d)=>{if(a=sanitizeArray(a,"inputs"),s=sanitizeArray(s,"patterns"),s.length===0)return[];const c=s[0][0]==="!";s=s.map(h=>makeRegexp(h,d));const l=[];for(const h of a){let p=c;for(const y of s)y.test(h)&&(p=!y.negated);p&&l.push(h)}return l},matcher.exports.isMatch=(a,s,d)=>(a=sanitizeArray(a,"inputs"),s=sanitizeArray(s,"patterns"),s.length===0?!1:a.some(c=>s.every(l=>{const h=makeRegexp(l,d),p=h.test(c);return h.negated?!p:p})));var __createBinding$1=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(a,s,d,c){c===void 0&&(c=d);var l=Object.getOwnPropertyDescriptor(s,d);(!l||("get"in l?!s.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return s[d]}}),Object.defineProperty(a,c,l)}:function(a,s,d,c){c===void 0&&(c=d),a[c]=s[d]}),__setModuleDefault$1=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(a,s){Object.defineProperty(a,"default",{enumerable:!0,value:s})}:function(a,s){a.default=s}),__importStar$1=commonjsGlobal&&commonjsGlobal.__importStar||function(a){if(a&&a.__esModule)return a;var s={};if(a!=null)for(var d in a)d!=="default"&&Object.prototype.hasOwnProperty.call(a,d)&&__createBinding$1(s,a,d);return __setModuleDefault$1(s,a),s},__importDefault$e=commonjsGlobal&&commonjsGlobal.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(eventapi,"__esModule",{value:!0}),eventapi.EventApi=void 0;const EventApiModel=__importStar$1(dist$2),isomorphic_ws_1=__importDefault$e(browser$1),uuid_1=require$$1$2,NiceGrpc=__importStar$1(lib$1),matcher_1=matcher.exports,api_1=api$2,clientVersion=version$2,WS_PING_INTERVAL=2e4,WS_PING_TIMEOUT=1e4,WS_RECONNECT_DELAY=2e3,WS_MAX_BADAUTH_ATTEMPTS=3,LOG_CATEGORY="EventApi";class EventApi extends api_1.ApiClient{constructor(s,d,c,l,h,p){super(s,d,l,LOG_CATEGORY,h,p),this.websocketServer=c,this.subscriptions=new Set,this.eventHandlers={},this.calls={},this.messageQueue=[],this.websocketReady=!1,this.reconnectionAttempts=0,this.badAuthentication=!1,this.eventsClient=null}publish(...s){return this.websocketReady?this.call("publish",s[0]):this.eventsClient.publish(...s)}connect(){if(!this.ws){this.cleanup();const s=this.accessToken,d=[`version=${clientVersion}`,`sessionid=${this.sessionId}`];this.sdkVersion&&d.push(`sdkversion=${this.sdkVersion}`),this.ws=new isomorphic_ws_1.default(`${this.websocketServer}/stream?${d.join("&")}`,["Bearer",this.accessToken]);let c;this.ws.addEventListener("message",l=>{const h=JSON.parse(l.data.toString()),p=h.result;if(h.error&&(c=h.error,this.handleEvent("error",{error:{code:h.code,message:h.message}}),["You do not have permission to this resource","You do not have permission to this resource"].includes(h.message)&&(this.badAuthentication=!0)),!p)return;p.reconnectBefore&&p.reconnectBefore.reauthenticate&&this.accessToken===s&&(this.badAuthentication=!0);const y=EventApiModel.eventsApiSupportedEvents.find(_=>!!p[_]);y&&this.handleEvent(y,p)}),this.ws.addEventListener("open",()=>{this.log.info("websocket connected"),this.call("ping","hello",{timeout:WS_PING_TIMEOUT,skipQueue:!0}).then(()=>{this.ready()}).catch(l=>{!c&&l.message!=="Stream connection closed"&&this.disconnect("hello timeout")})}),this.ws.addEventListener("close",l=>{var h;c?this.reconnect(`${(h=c==null?void 0:c.message)!==null&&h!==void 0?h:"unknown"}`):this.reconnect(`closed - ${l.reason||l.code}`)}),this.ws.addEventListener("error",l=>{c=l})}}async subscribe(s,d={}){return this.call("subscribe",{name:s,...d}).then(()=>{this.subscriptions.add(JSON.stringify({name:s,...d}))})}async unsubscribe(s,d={}){this.subscriptions.delete(JSON.stringify({name:s,payload:d})),await this.call("unsubscribe",{name:s,...d})}on(s,d,c){const l=c||d,h={ignoreSessionEvents:!1,allowedSessionEvents:[],...c?d:{}};this.eventHandlers[s]||(this.eventHandlers[s]=[]),this.eventHandlers[s].push({...h,handler:l})}off(s,d,c){var l;const h=c||d,p={ignoreSessionEvents:!1,allowedSessionEvents:[],...c?d:{}};this.eventHandlers[s]=((l=this.eventHandlers[s])!==null&&l!==void 0?l:[]).filter(y=>!(y.ignoreSessionEvents===p.ignoreSessionEvents&&y.allowedSessionEvents===p.allowedSessionEvents&&y.handler===h&&y.name===p.name))}disconnect(s){this.log.warn(`disconnected from events reason=${s}`),Object.values(this.calls).forEach(d=>{clearTimeout(d.timeout),d.reject(new Error("Stream connection closed"))}),this.calls={},this.cleanup()}_setup(s){this.eventsClient=this.clientFactory.create(EventApiModel.EventServiceDefinition,this.channel,{"*":s}),this.badAuthentication&&(this.badAuthentication=!1,this.reconnectionAttempts=0,this.reconnect("updated token"))}ready(){this.reconnectionAttempts=0,this.badAuthentication=!1,this.websocketReady=!0,this.handleEvent("connected",{connected:void 0});for(const s of this.subscriptions.values())this.send({subscribe:JSON.parse(s),correlationId:(0,uuid_1.v4)()});for(const s of this.messageQueue)this.send(s);this.messageQueue=[],this.pingLoop=setInterval(()=>{this.ping()},WS_PING_INTERVAL)}ping(){this.call("ping",`${+new Date}`,{timeout:WS_PING_TIMEOUT}).catch(()=>{this.reconnect("connection stalled")})}reconnect(s){this.disconnect(s),this.reconnectTimeout=setTimeout(()=>{if(this.reconnectionAttempts++,this.badAuthentication&&this.reconnectionAttempts>=WS_MAX_BADAUTH_ATTEMPTS){this.log.warn("Maximum number of reconnection attempts reached with bad authentication, please re-authenticate the SDK");return}this.connect()},WS_RECONNECT_DELAY)}send(s){this.ws&&this.ws.readyState===this.ws.OPEN?this.ws.send(JSON.stringify(s)):this.log.warn("Message sent to a disconnected stream")}handleEvent(s,d){var c;if(this.calls[d.correlationId]){const l=EventApiModel.eventsApiEventRpcCalls[this.calls[d.correlationId].method]===s,h=!!d.error;if(l||h){this.resolveCall(s,d);return}}for(const l of(c=this.eventHandlers[s])!==null&&c!==void 0?c:[]){if(s==="event"&&d.event){if(d.sessionId===this.sessionId&&l.ignoreSessionEvents&&!l.allowedSessionEvents.includes(d.event.name)){this.log.trace("ignorning user event from self: "+d.event.name+", payload.sessionId="+d.sessionId+", this.sessionId");continue}if(l.name&&!(0,matcher_1.isMatch)(d.event.name,l.name))continue;if(this.eventLogCallback){let h,p=d.event.name,y;if(d.event.name.startsWith(EventApi.APISTREAM_EVENT_PREFIX)){let _=d.event.name.split(":");_.length==4&&(h=_[1],p=_[2],y=_[3]),this.eventLogCallback(h,p,y,d)}}}else if(d.sessionId===this.sessionId&&l.ignoreSessionEvents){this.log.trace("ignorning event from self: "+d.event.name+", payload.sessionId="+d.sessionId+", this.sessionId");continue}this.log.trace("processing event: payload.sessionId="+d.sessionId+", this.sessionId"),l.handler(d?d[s]:void 0,{isFromCurrentSession:d.sessionId===this.sessionId})}}async call(s,d,c={timeout:2e4,skipQueue:!1}){this.ws||this.connect();const l=(0,uuid_1.v4)();return new Promise((h,p)=>{const y=setTimeout(()=>{delete this.calls[l],p(new Error("Request timed out"))},c.timeout);this.calls[l]={resolve:h,reject:p,timeout:y,method:s},this.websocketReady||c.skipQueue?this.send({[s]:d,correlationId:l}):this.messageQueue.push({[s]:d,correlationId:l})})}resolveCall(s,d){const c=this.calls[d.correlationId];if(!!c){if(clearTimeout(c.timeout),delete this.calls[d.correlationId],s==="error"&&d.error){c.reject(new NiceGrpc.ClientError("error",d.error.code,d.error.message));return}c.resolve(d[s])}}cleanup(){clearTimeout(this.pingLoop),clearTimeout(this.reconnectTimeout),this.websocketReady=!1,this.ws&&(this.ws.onclose=function(){},this.ws.close(),this.ws=null)}}eventapi.EventApi=EventApi,EventApi.APISTREAM_EVENT_PREFIX="apistream";var livekit={},__importDefault$d=commonjsGlobal&&commonjsGlobal.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(livekit,"__esModule",{value:!0}),livekit.LiveKitUtils=void 0;const jwt_decode_1=__importDefault$d(require$$0$2);class LiveKitUtils{static decodeJwt(s){return(0,jwt_decode_1.default)(s,{header:!1})}static isRoomAdmin(s){return LiveKitUtils.decodeJwt(s).video.roomAdmin}static getRoomName(s){return LiveKitUtils.decodeJwt(s).video.room}}livekit.LiveKitUtils=LiveKitUtils,function(a){var s=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(X,M,K,te){te===void 0&&(te=K);var L=Object.getOwnPropertyDescriptor(M,K);(!L||("get"in L?!M.__esModule:L.writable||L.configurable))&&(L={enumerable:!0,get:function(){return M[K]}}),Object.defineProperty(X,te,L)}:function(X,M,K,te){te===void 0&&(te=K),X[te]=M[K]}),d=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(X,M){Object.defineProperty(X,"default",{enumerable:!0,value:M})}:function(X,M){X.default=M}),c=commonjsGlobal&&commonjsGlobal.__importStar||function(X){if(X&&X.__esModule)return X;var M={};if(X!=null)for(var K in X)K!=="default"&&Object.prototype.hasOwnProperty.call(X,K)&&s(M,X,K);return d(M,X),M},l=commonjsGlobal&&commonjsGlobal.__importDefault||function(X){return X&&X.__esModule?X:{default:X}};Object.defineProperty(a,"__esModule",{value:!0}),a.ApiStream=a.LiveKitUtils=a.EventApiModel=a.LayoutApiModel=a.LiveApiModel=void 0;const h=l(require$$0$2),p=require$$1$2,y=require$$2$1,_=layoutapi,E=liveapi,O=eventapi,P=c(api$1);a.LiveApiModel=P;const C=c(dist$3);a.LayoutApiModel=C;const A=c(dist$2);a.EventApiModel=A;const q=livekit;Object.defineProperty(a,"LiveKitUtils",{enumerable:!0,get:function(){return q.LiveKitUtils}});const U=logger$1,F=version$2,j={dev:"http://127.0.0.1:8081",stage:"https://live.stream.horse/grpcweb/live/v2",prod:"https://live.api.stream/grpcweb/live/v2"},T={dev:"https://live.stream.horse/grpcweb/layout/v2",stage:"https://live.stream.horse/grpcweb/layout/v2",prod:"https://live.api.stream/grpcweb/layout/v2"},D={dev:"wss://live.stream.horse/event/v2",stage:"wss://live.stream.horse/event/v2",prod:"wss://live.api.stream/event/v2"},J={dev:"https://live.stream.horse/grpcweb/event/v2",stage:"https://live.stream.horse/grpcweb/event/v2",prod:"https://live.api.stream/grpcweb/event/v2"},ee={dev:"wss://live.stream.horse/webrtc/v2",stage:"wss://live.stream.horse/webrtc/v2",prod:"wss://live.api.stream/webrtc/v2"},z={dev:"https://live.stream.horse/webrtc/v2",stage:"https://live.stream.horse/webrtc/v2",prod:"https://live.api.stream/webrtc/v2"};class ne{constructor(M={}){var K;const te={env:"prod",logLevel:"Warn",...M};this.env=te.env;let L=(0,p.v4)();te.sessionId!=null&&(L=te.sessionId),this.log=U.logger.getCategory("ApiStream"),this.setLogLevel(te.env=="dev"?"Trace":te.logLevel);const G=(K=te.overrideEndpoints)!==null&&K!==void 0?K:{};G.liveApiServer==null&&(G.liveApiServer=j[this.env]),G.layoutApiServer==null&&(G.layoutApiServer=T[this.env]),G.eventApiServer==null&&(G.eventApiServer=J[this.env]),G.eventApiWebSocketServer==null&&(G.eventApiWebSocketServer=D[this.env]),this.eventApi=new O.EventApi(L,G.eventApiServer,G.eventApiWebSocketServer,te.sdkVersion,te.apiLogCallback,te.eventLogCallback),this.layoutApi=new _.LayoutApi(L,this.eventApi,G.layoutApiServer,te.sdkVersion,te.apiLogCallback),this.liveApi=new E.LiveApi(L,this.eventApi,G.liveApiServer,this.setAccessToken.bind(this),te.apiKey,te.sdkVersion,te.apiLogCallback),this.eventApi.on("reconnectBefore",W=>{W.reauthenticate&&this.liveApi.authentication.refreshAccessToken({}).catch(()=>{})}),this.log.info("api.stream: sessionid="+L+", version="+F+", sdkVersion="+te.sdkVersion)}LiveApi(){return this.liveApi}LayoutApi(){return this.layoutApi}EventApi(){return this.eventApi}setLogLevel(M){try{let K=y.LogLevel.toLogLevel(M);U.logger.updateRuntimeSettings({level:K})}catch{this.log.warn(`unknown logging level ${M}`)}}setAccessToken(M){this.decodedAccessToken=ne.decodeAccessToken(M),this.log.debug("setting accessToken",M,this.decodedAccessToken),this.layoutApi.setAccessToken(M),this.liveApi.setAccessToken(M),this.eventApi.setAccessToken(M)}getAccessToken(){return this.decodedAccessToken}getGuestProject(){return this.decodedAccessToken.guestControl}async load(M){if(M==null&&typeof window!="undefined"){let K=this.parseQuery();K.get(ne.ACCESS_TOKEN_QUERY_PARAM)!=null&&(M=K.get(ne.ACCESS_TOKEN_QUERY_PARAM))}return M!=null&&(this.setAccessToken(M),this.decodedAccessToken.guestControl!=null)?(this.log.info("loading guest token and exchanging"),await this.LiveApi().authentication.refreshAccessToken({}),this.log.info("auto-loading project = "+JSON.stringify(this.decodedAccessToken.guestControl)),this.decodedAccessToken.guestControl):null}getLiveKitServer(M=!1){return M?z[this.env]:ee[this.env]}parseQuery(){let M=window.location.search,K=new Map,te=(M[0]==="?"?M.substr(1):M).split("&");for(let L=0;L<te.length;L++){let G=te[L].split("=");G.length==2&&(K.set(decodeURIComponent(G[0]),decodeURIComponent(G[1]||"")),this.log.debug(`found query param: ${decodeURIComponent(G[0])}=${decodeURIComponent(G[1]||"")}`))}return K}static decodeAccessToken(M){let K=(0,h.default)(M,{header:!1}),te={serviceUserId:K.user.serviceUserId,userId:K.user.userId,displayName:K.user.displayName,trial:K.user.trial,demo:K.user.demo};return K.guestControl!=null&&(te.guestControl={collectionId:K.guestControl.collectionId,projectId:K.guestControl.projectId,role:P.roleFromJSON(K.guestControl.role)}),te}}a.ApiStream=ne,ne.ACCESS_TOKEN_QUERY_PARAM="at"}(lib$2);var dist$1={},logger={};(function(a){var s=commonjsGlobal&&commonjsGlobal.__importDefault||function(p){return p&&p.__esModule?p:{default:p}};Object.defineProperty(a,"__esModule",{value:!0}),a.setLogLevel=a.LogLevel=void 0;const d=s(loglevel.exports);var c;(function(p){p.trace="trace",p.debug="debug",p.info="info",p.warn="warn",p.error="error",p.silent="silent"})(c=a.LogLevel||(a.LogLevel={}));const l=d.default.getLogger("livekit");l.setLevel(c.info),a.default=l;function h(p){l.setLevel(p)}a.setLogLevel=h})(logger);var livekit_models$1={};(function(a){var s=commonjsGlobal&&commonjsGlobal.__importDefault||function(I){return I&&I.__esModule?I:{default:I}};Object.defineProperty(a,"__esModule",{value:!0}),a.ClientInfo=a.ParticipantTracks=a.UserPacket=a.SpeakerInfo=a.ActiveSpeakerUpdate=a.DataPacket=a.VideoLayer=a.TrackInfo=a.ParticipantInfo=a.Codec=a.Room=a.clientInfo_SDKToJSON=a.clientInfo_SDKFromJSON=a.ClientInfo_SDK=a.dataPacket_KindToJSON=a.dataPacket_KindFromJSON=a.DataPacket_Kind=a.participantInfo_StateToJSON=a.participantInfo_StateFromJSON=a.ParticipantInfo_State=a.connectionQualityToJSON=a.connectionQualityFromJSON=a.ConnectionQuality=a.videoQualityToJSON=a.videoQualityFromJSON=a.VideoQuality=a.trackSourceToJSON=a.trackSourceFromJSON=a.TrackSource=a.trackTypeToJSON=a.trackTypeFromJSON=a.TrackType=a.protobufPackage=void 0;const d=s(umd.exports),c=s(minimal);a.protobufPackage="livekit";var l;(function(I){I[I.AUDIO=0]="AUDIO",I[I.VIDEO=1]="VIDEO",I[I.DATA=2]="DATA",I[I.UNRECOGNIZED=-1]="UNRECOGNIZED"})(l=a.TrackType||(a.TrackType={}));function h(I){switch(I){case 0:case"AUDIO":return l.AUDIO;case 1:case"VIDEO":return l.VIDEO;case 2:case"DATA":return l.DATA;case-1:case"UNRECOGNIZED":default:return l.UNRECOGNIZED}}a.trackTypeFromJSON=h;function p(I){switch(I){case l.AUDIO:return"AUDIO";case l.VIDEO:return"VIDEO";case l.DATA:return"DATA";default:return"UNKNOWN"}}a.trackTypeToJSON=p;var y;(function(I){I[I.UNKNOWN=0]="UNKNOWN",I[I.CAMERA=1]="CAMERA",I[I.MICROPHONE=2]="MICROPHONE",I[I.SCREEN_SHARE=3]="SCREEN_SHARE",I[I.SCREEN_SHARE_AUDIO=4]="SCREEN_SHARE_AUDIO",I[I.UNRECOGNIZED=-1]="UNRECOGNIZED"})(y=a.TrackSource||(a.TrackSource={}));function _(I){switch(I){case 0:case"UNKNOWN":return y.UNKNOWN;case 1:case"CAMERA":return y.CAMERA;case 2:case"MICROPHONE":return y.MICROPHONE;case 3:case"SCREEN_SHARE":return y.SCREEN_SHARE;case 4:case"SCREEN_SHARE_AUDIO":return y.SCREEN_SHARE_AUDIO;case-1:case"UNRECOGNIZED":default:return y.UNRECOGNIZED}}a.trackSourceFromJSON=_;function E(I){switch(I){case y.UNKNOWN:return"UNKNOWN";case y.CAMERA:return"CAMERA";case y.MICROPHONE:return"MICROPHONE";case y.SCREEN_SHARE:return"SCREEN_SHARE";case y.SCREEN_SHARE_AUDIO:return"SCREEN_SHARE_AUDIO";default:return"UNKNOWN"}}a.trackSourceToJSON=E;var O;(function(I){I[I.LOW=0]="LOW",I[I.MEDIUM=1]="MEDIUM",I[I.HIGH=2]="HIGH",I[I.OFF=3]="OFF",I[I.UNRECOGNIZED=-1]="UNRECOGNIZED"})(O=a.VideoQuality||(a.VideoQuality={}));function P(I){switch(I){case 0:case"LOW":return O.LOW;case 1:case"MEDIUM":return O.MEDIUM;case 2:case"HIGH":return O.HIGH;case 3:case"OFF":return O.OFF;case-1:case"UNRECOGNIZED":default:return O.UNRECOGNIZED}}a.videoQualityFromJSON=P;function C(I){switch(I){case O.LOW:return"LOW";case O.MEDIUM:return"MEDIUM";case O.HIGH:return"HIGH";case O.OFF:return"OFF";default:return"UNKNOWN"}}a.videoQualityToJSON=C;var A;(function(I){I[I.POOR=0]="POOR",I[I.GOOD=1]="GOOD",I[I.EXCELLENT=2]="EXCELLENT",I[I.UNRECOGNIZED=-1]="UNRECOGNIZED"})(A=a.ConnectionQuality||(a.ConnectionQuality={}));function q(I){switch(I){case 0:case"POOR":return A.POOR;case 1:case"GOOD":return A.GOOD;case 2:case"EXCELLENT":return A.EXCELLENT;case-1:case"UNRECOGNIZED":default:return A.UNRECOGNIZED}}a.connectionQualityFromJSON=q;function U(I){switch(I){case A.POOR:return"POOR";case A.GOOD:return"GOOD";case A.EXCELLENT:return"EXCELLENT";default:return"UNKNOWN"}}a.connectionQualityToJSON=U;var F;(function(I){I[I.JOINING=0]="JOINING",I[I.JOINED=1]="JOINED",I[I.ACTIVE=2]="ACTIVE",I[I.DISCONNECTED=3]="DISCONNECTED",I[I.UNRECOGNIZED=-1]="UNRECOGNIZED"})(F=a.ParticipantInfo_State||(a.ParticipantInfo_State={}));function j(I){switch(I){case 0:case"JOINING":return F.JOINING;case 1:case"JOINED":return F.JOINED;case 2:case"ACTIVE":return F.ACTIVE;case 3:case"DISCONNECTED":return F.DISCONNECTED;case-1:case"UNRECOGNIZED":default:return F.UNRECOGNIZED}}a.participantInfo_StateFromJSON=j;function T(I){switch(I){case F.JOINING:return"JOINING";case F.JOINED:return"JOINED";case F.ACTIVE:return"ACTIVE";case F.DISCONNECTED:return"DISCONNECTED";default:return"UNKNOWN"}}a.participantInfo_StateToJSON=T;var D;(function(I){I[I.RELIABLE=0]="RELIABLE",I[I.LOSSY=1]="LOSSY",I[I.UNRECOGNIZED=-1]="UNRECOGNIZED"})(D=a.DataPacket_Kind||(a.DataPacket_Kind={}));function J(I){switch(I){case 0:case"RELIABLE":return D.RELIABLE;case 1:case"LOSSY":return D.LOSSY;case-1:case"UNRECOGNIZED":default:return D.UNRECOGNIZED}}a.dataPacket_KindFromJSON=J;function ee(I){switch(I){case D.RELIABLE:return"RELIABLE";case D.LOSSY:return"LOSSY";default:return"UNKNOWN"}}a.dataPacket_KindToJSON=ee;var z;(function(I){I[I.UNKNOWN=0]="UNKNOWN",I[I.JS=1]="JS",I[I.SWIFT=2]="SWIFT",I[I.ANDROID=3]="ANDROID",I[I.FLUTTER=4]="FLUTTER",I[I.GO=5]="GO",I[I.UNITY=6]="UNITY",I[I.UNRECOGNIZED=-1]="UNRECOGNIZED"})(z=a.ClientInfo_SDK||(a.ClientInfo_SDK={}));function ne(I){switch(I){case 0:case"UNKNOWN":return z.UNKNOWN;case 1:case"JS":return z.JS;case 2:case"SWIFT":return z.SWIFT;case 3:case"ANDROID":return z.ANDROID;case 4:case"FLUTTER":return z.FLUTTER;case 5:case"GO":return z.GO;case 6:case"UNITY":return z.UNITY;case-1:case"UNRECOGNIZED":default:return z.UNRECOGNIZED}}a.clientInfo_SDKFromJSON=ne;function X(I){switch(I){case z.UNKNOWN:return"UNKNOWN";case z.JS:return"JS";case z.SWIFT:return"SWIFT";case z.ANDROID:return"ANDROID";case z.FLUTTER:return"FLUTTER";case z.GO:return"GO";case z.UNITY:return"UNITY";default:return"UNKNOWN"}}a.clientInfo_SDKToJSON=X;const M={sid:"",name:"",emptyTimeout:0,maxParticipants:0,creationTime:0,turnPassword:"",metadata:"",numParticipants:0,activeRecording:!1};a.Room={encode(I,$=c.default.Writer.create()){I.sid!==""&&$.uint32(10).string(I.sid),I.name!==""&&$.uint32(18).string(I.name),I.emptyTimeout!==0&&$.uint32(24).uint32(I.emptyTimeout),I.maxParticipants!==0&&$.uint32(32).uint32(I.maxParticipants),I.creationTime!==0&&$.uint32(40).int64(I.creationTime),I.turnPassword!==""&&$.uint32(50).string(I.turnPassword);for(const Z of I.enabledCodecs)a.Codec.encode(Z,$.uint32(58).fork()).ldelim();return I.metadata!==""&&$.uint32(66).string(I.metadata),I.numParticipants!==0&&$.uint32(72).uint32(I.numParticipants),I.activeRecording===!0&&$.uint32(80).bool(I.activeRecording),$},decode(I,$){const Z=I instanceof c.default.Reader?I:new c.default.Reader(I);let le=$===void 0?Z.len:Z.pos+$;const de=Object.assign({},M);for(de.enabledCodecs=[];Z.pos<le;){const he=Z.uint32();switch(he>>>3){case 1:de.sid=Z.string();break;case 2:de.name=Z.string();break;case 3:de.emptyTimeout=Z.uint32();break;case 4:de.maxParticipants=Z.uint32();break;case 5:de.creationTime=ae(Z.int64());break;case 6:de.turnPassword=Z.string();break;case 7:de.enabledCodecs.push(a.Codec.decode(Z,Z.uint32()));break;case 8:de.metadata=Z.string();break;case 9:de.numParticipants=Z.uint32();break;case 10:de.activeRecording=Z.bool();break;default:Z.skipType(he&7);break}}return de},fromJSON(I){const $=Object.assign({},M);if($.enabledCodecs=[],I.sid!==void 0&&I.sid!==null?$.sid=String(I.sid):$.sid="",I.name!==void 0&&I.name!==null?$.name=String(I.name):$.name="",I.emptyTimeout!==void 0&&I.emptyTimeout!==null?$.emptyTimeout=Number(I.emptyTimeout):$.emptyTimeout=0,I.maxParticipants!==void 0&&I.maxParticipants!==null?$.maxParticipants=Number(I.maxParticipants):$.maxParticipants=0,I.creationTime!==void 0&&I.creationTime!==null?$.creationTime=Number(I.creationTime):$.creationTime=0,I.turnPassword!==void 0&&I.turnPassword!==null?$.turnPassword=String(I.turnPassword):$.turnPassword="",I.enabledCodecs!==void 0&&I.enabledCodecs!==null)for(const Z of I.enabledCodecs)$.enabledCodecs.push(a.Codec.fromJSON(Z));return I.metadata!==void 0&&I.metadata!==null?$.metadata=String(I.metadata):$.metadata="",I.numParticipants!==void 0&&I.numParticipants!==null?$.numParticipants=Number(I.numParticipants):$.numParticipants=0,I.activeRecording!==void 0&&I.activeRecording!==null?$.activeRecording=Boolean(I.activeRecording):$.activeRecording=!1,$},toJSON(I){const $={};return I.sid!==void 0&&($.sid=I.sid),I.name!==void 0&&($.name=I.name),I.emptyTimeout!==void 0&&($.emptyTimeout=I.emptyTimeout),I.maxParticipants!==void 0&&($.maxParticipants=I.maxParticipants),I.creationTime!==void 0&&($.creationTime=I.creationTime),I.turnPassword!==void 0&&($.turnPassword=I.turnPassword),I.enabledCodecs?$.enabledCodecs=I.enabledCodecs.map(Z=>Z?a.Codec.toJSON(Z):void 0):$.enabledCodecs=[],I.metadata!==void 0&&($.metadata=I.metadata),I.numParticipants!==void 0&&($.numParticipants=I.numParticipants),I.activeRecording!==void 0&&($.activeRecording=I.activeRecording),$},fromPartial(I){var $,Z,le,de,he,ge,Pe,Te,_e;const Ne=Object.assign({},M);if(Ne.sid=($=I.sid)!==null&&$!==void 0?$:"",Ne.name=(Z=I.name)!==null&&Z!==void 0?Z:"",Ne.emptyTimeout=(le=I.emptyTimeout)!==null&&le!==void 0?le:0,Ne.maxParticipants=(de=I.maxParticipants)!==null&&de!==void 0?de:0,Ne.creationTime=(he=I.creationTime)!==null&&he!==void 0?he:0,Ne.turnPassword=(ge=I.turnPassword)!==null&&ge!==void 0?ge:"",Ne.enabledCodecs=[],I.enabledCodecs!==void 0&&I.enabledCodecs!==null)for(const We of I.enabledCodecs)Ne.enabledCodecs.push(a.Codec.fromPartial(We));return Ne.metadata=(Pe=I.metadata)!==null&&Pe!==void 0?Pe:"",Ne.numParticipants=(Te=I.numParticipants)!==null&&Te!==void 0?Te:0,Ne.activeRecording=(_e=I.activeRecording)!==null&&_e!==void 0?_e:!1,Ne}};const K={mime:"",fmtpLine:""};a.Codec={encode(I,$=c.default.Writer.create()){return I.mime!==""&&$.uint32(10).string(I.mime),I.fmtpLine!==""&&$.uint32(18).string(I.fmtpLine),$},decode(I,$){const Z=I instanceof c.default.Reader?I:new c.default.Reader(I);let le=$===void 0?Z.len:Z.pos+$;const de=Object.assign({},K);for(;Z.pos<le;){const he=Z.uint32();switch(he>>>3){case 1:de.mime=Z.string();break;case 2:de.fmtpLine=Z.string();break;default:Z.skipType(he&7);break}}return de},fromJSON(I){const $=Object.assign({},K);return I.mime!==void 0&&I.mime!==null?$.mime=String(I.mime):$.mime="",I.fmtpLine!==void 0&&I.fmtpLine!==null?$.fmtpLine=String(I.fmtpLine):$.fmtpLine="",$},toJSON(I){const $={};return I.mime!==void 0&&($.mime=I.mime),I.fmtpLine!==void 0&&($.fmtpLine=I.fmtpLine),$},fromPartial(I){var $,Z;const le=Object.assign({},K);return le.mime=($=I.mime)!==null&&$!==void 0?$:"",le.fmtpLine=(Z=I.fmtpLine)!==null&&Z!==void 0?Z:"",le}};const te={sid:"",identity:"",state:0,metadata:"",joinedAt:0,hidden:!1,recorder:!1,name:""};a.ParticipantInfo={encode(I,$=c.default.Writer.create()){I.sid!==""&&$.uint32(10).string(I.sid),I.identity!==""&&$.uint32(18).string(I.identity),I.state!==0&&$.uint32(24).int32(I.state);for(const Z of I.tracks)a.TrackInfo.encode(Z,$.uint32(34).fork()).ldelim();return I.metadata!==""&&$.uint32(42).string(I.metadata),I.joinedAt!==0&&$.uint32(48).int64(I.joinedAt),I.hidden===!0&&$.uint32(56).bool(I.hidden),I.recorder===!0&&$.uint32(64).bool(I.recorder),I.name!==""&&$.uint32(74).string(I.name),$},decode(I,$){const Z=I instanceof c.default.Reader?I:new c.default.Reader(I);let le=$===void 0?Z.len:Z.pos+$;const de=Object.assign({},te);for(de.tracks=[];Z.pos<le;){const he=Z.uint32();switch(he>>>3){case 1:de.sid=Z.string();break;case 2:de.identity=Z.string();break;case 3:de.state=Z.int32();break;case 4:de.tracks.push(a.TrackInfo.decode(Z,Z.uint32()));break;case 5:de.metadata=Z.string();break;case 6:de.joinedAt=ae(Z.int64());break;case 7:de.hidden=Z.bool();break;case 8:de.recorder=Z.bool();break;case 9:de.name=Z.string();break;default:Z.skipType(he&7);break}}return de},fromJSON(I){const $=Object.assign({},te);if($.tracks=[],I.sid!==void 0&&I.sid!==null?$.sid=String(I.sid):$.sid="",I.identity!==void 0&&I.identity!==null?$.identity=String(I.identity):$.identity="",I.state!==void 0&&I.state!==null?$.state=j(I.state):$.state=0,I.tracks!==void 0&&I.tracks!==null)for(const Z of I.tracks)$.tracks.push(a.TrackInfo.fromJSON(Z));return I.metadata!==void 0&&I.metadata!==null?$.metadata=String(I.metadata):$.metadata="",I.joinedAt!==void 0&&I.joinedAt!==null?$.joinedAt=Number(I.joinedAt):$.joinedAt=0,I.hidden!==void 0&&I.hidden!==null?$.hidden=Boolean(I.hidden):$.hidden=!1,I.recorder!==void 0&&I.recorder!==null?$.recorder=Boolean(I.recorder):$.recorder=!1,I.name!==void 0&&I.name!==null?$.name=String(I.name):$.name="",$},toJSON(I){const $={};return I.sid!==void 0&&($.sid=I.sid),I.identity!==void 0&&($.identity=I.identity),I.state!==void 0&&($.state=T(I.state)),I.tracks?$.tracks=I.tracks.map(Z=>Z?a.TrackInfo.toJSON(Z):void 0):$.tracks=[],I.metadata!==void 0&&($.metadata=I.metadata),I.joinedAt!==void 0&&($.joinedAt=I.joinedAt),I.hidden!==void 0&&($.hidden=I.hidden),I.recorder!==void 0&&($.recorder=I.recorder),I.name!==void 0&&($.name=I.name),$},fromPartial(I){var $,Z,le,de,he,ge,Pe,Te;const _e=Object.assign({},te);if(_e.sid=($=I.sid)!==null&&$!==void 0?$:"",_e.identity=(Z=I.identity)!==null&&Z!==void 0?Z:"",_e.state=(le=I.state)!==null&&le!==void 0?le:0,_e.tracks=[],I.tracks!==void 0&&I.tracks!==null)for(const Ne of I.tracks)_e.tracks.push(a.TrackInfo.fromPartial(Ne));return _e.metadata=(de=I.metadata)!==null&&de!==void 0?de:"",_e.joinedAt=(he=I.joinedAt)!==null&&he!==void 0?he:0,_e.hidden=(ge=I.hidden)!==null&&ge!==void 0?ge:!1,_e.recorder=(Pe=I.recorder)!==null&&Pe!==void 0?Pe:!1,_e.name=(Te=I.name)!==null&&Te!==void 0?Te:"",_e}};const L={sid:"",type:0,name:"",muted:!1,width:0,height:0,simulcast:!1,disableDtx:!1,source:0,mimeType:"",mid:""};a.TrackInfo={encode(I,$=c.default.Writer.create()){I.sid!==""&&$.uint32(10).string(I.sid),I.type!==0&&$.uint32(16).int32(I.type),I.name!==""&&$.uint32(26).string(I.name),I.muted===!0&&$.uint32(32).bool(I.muted),I.width!==0&&$.uint32(40).uint32(I.width),I.height!==0&&$.uint32(48).uint32(I.height),I.simulcast===!0&&$.uint32(56).bool(I.simulcast),I.disableDtx===!0&&$.uint32(64).bool(I.disableDtx),I.source!==0&&$.uint32(72).int32(I.source);for(const Z of I.layers)a.VideoLayer.encode(Z,$.uint32(82).fork()).ldelim();return I.mimeType!==""&&$.uint32(90).string(I.mimeType),I.mid!==""&&$.uint32(98).string(I.mid),$},decode(I,$){const Z=I instanceof c.default.Reader?I:new c.default.Reader(I);let le=$===void 0?Z.len:Z.pos+$;const de=Object.assign({},L);for(de.layers=[];Z.pos<le;){const he=Z.uint32();switch(he>>>3){case 1:de.sid=Z.string();break;case 2:de.type=Z.int32();break;case 3:de.name=Z.string();break;case 4:de.muted=Z.bool();break;case 5:de.width=Z.uint32();break;case 6:de.height=Z.uint32();break;case 7:de.simulcast=Z.bool();break;case 8:de.disableDtx=Z.bool();break;case 9:de.source=Z.int32();break;case 10:de.layers.push(a.VideoLayer.decode(Z,Z.uint32()));break;case 11:de.mimeType=Z.string();break;case 12:de.mid=Z.string();break;default:Z.skipType(he&7);break}}return de},fromJSON(I){const $=Object.assign({},L);if($.layers=[],I.sid!==void 0&&I.sid!==null?$.sid=String(I.sid):$.sid="",I.type!==void 0&&I.type!==null?$.type=h(I.type):$.type=0,I.name!==void 0&&I.name!==null?$.name=String(I.name):$.name="",I.muted!==void 0&&I.muted!==null?$.muted=Boolean(I.muted):$.muted=!1,I.width!==void 0&&I.width!==null?$.width=Number(I.width):$.width=0,I.height!==void 0&&I.height!==null?$.height=Number(I.height):$.height=0,I.simulcast!==void 0&&I.simulcast!==null?$.simulcast=Boolean(I.simulcast):$.simulcast=!1,I.disableDtx!==void 0&&I.disableDtx!==null?$.disableDtx=Boolean(I.disableDtx):$.disableDtx=!1,I.source!==void 0&&I.source!==null?$.source=_(I.source):$.source=0,I.layers!==void 0&&I.layers!==null)for(const Z of I.layers)$.layers.push(a.VideoLayer.fromJSON(Z));return I.mimeType!==void 0&&I.mimeType!==null?$.mimeType=String(I.mimeType):$.mimeType="",I.mid!==void 0&&I.mid!==null?$.mid=String(I.mid):$.mid="",$},toJSON(I){const $={};return I.sid!==void 0&&($.sid=I.sid),I.type!==void 0&&($.type=p(I.type)),I.name!==void 0&&($.name=I.name),I.muted!==void 0&&($.muted=I.muted),I.width!==void 0&&($.width=I.width),I.height!==void 0&&($.height=I.height),I.simulcast!==void 0&&($.simulcast=I.simulcast),I.disableDtx!==void 0&&($.disableDtx=I.disableDtx),I.source!==void 0&&($.source=E(I.source)),I.layers?$.layers=I.layers.map(Z=>Z?a.VideoLayer.toJSON(Z):void 0):$.layers=[],I.mimeType!==void 0&&($.mimeType=I.mimeType),I.mid!==void 0&&($.mid=I.mid),$},fromPartial(I){var $,Z,le,de,he,ge,Pe,Te,_e,Ne,We;const ye=Object.assign({},L);if(ye.sid=($=I.sid)!==null&&$!==void 0?$:"",ye.type=(Z=I.type)!==null&&Z!==void 0?Z:0,ye.name=(le=I.name)!==null&&le!==void 0?le:"",ye.muted=(de=I.muted)!==null&&de!==void 0?de:!1,ye.width=(he=I.width)!==null&&he!==void 0?he:0,ye.height=(ge=I.height)!==null&&ge!==void 0?ge:0,ye.simulcast=(Pe=I.simulcast)!==null&&Pe!==void 0?Pe:!1,ye.disableDtx=(Te=I.disableDtx)!==null&&Te!==void 0?Te:!1,ye.source=(_e=I.source)!==null&&_e!==void 0?_e:0,ye.layers=[],I.layers!==void 0&&I.layers!==null)for(const qe of I.layers)ye.layers.push(a.VideoLayer.fromPartial(qe));return ye.mimeType=(Ne=I.mimeType)!==null&&Ne!==void 0?Ne:"",ye.mid=(We=I.mid)!==null&&We!==void 0?We:"",ye}};const G={quality:0,width:0,height:0,bitrate:0,ssrc:0};a.VideoLayer={encode(I,$=c.default.Writer.create()){return I.quality!==0&&$.uint32(8).int32(I.quality),I.width!==0&&$.uint32(16).uint32(I.width),I.height!==0&&$.uint32(24).uint32(I.height),I.bitrate!==0&&$.uint32(32).uint32(I.bitrate),I.ssrc!==0&&$.uint32(40).uint32(I.ssrc),$},decode(I,$){const Z=I instanceof c.default.Reader?I:new c.default.Reader(I);let le=$===void 0?Z.len:Z.pos+$;const de=Object.assign({},G);for(;Z.pos<le;){const he=Z.uint32();switch(he>>>3){case 1:de.quality=Z.int32();break;case 2:de.width=Z.uint32();break;case 3:de.height=Z.uint32();break;case 4:de.bitrate=Z.uint32();break;case 5:de.ssrc=Z.uint32();break;default:Z.skipType(he&7);break}}return de},fromJSON(I){const $=Object.assign({},G);return I.quality!==void 0&&I.quality!==null?$.quality=P(I.quality):$.quality=0,I.width!==void 0&&I.width!==null?$.width=Number(I.width):$.width=0,I.height!==void 0&&I.height!==null?$.height=Number(I.height):$.height=0,I.bitrate!==void 0&&I.bitrate!==null?$.bitrate=Number(I.bitrate):$.bitrate=0,I.ssrc!==void 0&&I.ssrc!==null?$.ssrc=Number(I.ssrc):$.ssrc=0,$},toJSON(I){const $={};return I.quality!==void 0&&($.quality=C(I.quality)),I.width!==void 0&&($.width=I.width),I.height!==void 0&&($.height=I.height),I.bitrate!==void 0&&($.bitrate=I.bitrate),I.ssrc!==void 0&&($.ssrc=I.ssrc),$},fromPartial(I){var $,Z,le,de,he;const ge=Object.assign({},G);return ge.quality=($=I.quality)!==null&&$!==void 0?$:0,ge.width=(Z=I.width)!==null&&Z!==void 0?Z:0,ge.height=(le=I.height)!==null&&le!==void 0?le:0,ge.bitrate=(de=I.bitrate)!==null&&de!==void 0?de:0,ge.ssrc=(he=I.ssrc)!==null&&he!==void 0?he:0,ge}};const W={kind:0};a.DataPacket={encode(I,$=c.default.Writer.create()){return I.kind!==0&&$.uint32(8).int32(I.kind),I.user!==void 0&&a.UserPacket.encode(I.user,$.uint32(18).fork()).ldelim(),I.speaker!==void 0&&a.ActiveSpeakerUpdate.encode(I.speaker,$.uint32(26).fork()).ldelim(),$},decode(I,$){const Z=I instanceof c.default.Reader?I:new c.default.Reader(I);let le=$===void 0?Z.len:Z.pos+$;const de=Object.assign({},W);for(;Z.pos<le;){const he=Z.uint32();switch(he>>>3){case 1:de.kind=Z.int32();break;case 2:de.user=a.UserPacket.decode(Z,Z.uint32());break;case 3:de.speaker=a.ActiveSpeakerUpdate.decode(Z,Z.uint32());break;default:Z.skipType(he&7);break}}return de},fromJSON(I){const $=Object.assign({},W);return I.kind!==void 0&&I.kind!==null?$.kind=J(I.kind):$.kind=0,I.user!==void 0&&I.user!==null?$.user=a.UserPacket.fromJSON(I.user):$.user=void 0,I.speaker!==void 0&&I.speaker!==null?$.speaker=a.ActiveSpeakerUpdate.fromJSON(I.speaker):$.speaker=void 0,$},toJSON(I){const $={};return I.kind!==void 0&&($.kind=ee(I.kind)),I.user!==void 0&&($.user=I.user?a.UserPacket.toJSON(I.user):void 0),I.speaker!==void 0&&($.speaker=I.speaker?a.ActiveSpeakerUpdate.toJSON(I.speaker):void 0),$},fromPartial(I){var $;const Z=Object.assign({},W);return Z.kind=($=I.kind)!==null&&$!==void 0?$:0,I.user!==void 0&&I.user!==null?Z.user=a.UserPacket.fromPartial(I.user):Z.user=void 0,I.speaker!==void 0&&I.speaker!==null?Z.speaker=a.ActiveSpeakerUpdate.fromPartial(I.speaker):Z.speaker=void 0,Z}};const ie={};a.ActiveSpeakerUpdate={encode(I,$=c.default.Writer.create()){for(const Z of I.speakers)a.SpeakerInfo.encode(Z,$.uint32(10).fork()).ldelim();return $},decode(I,$){const Z=I instanceof c.default.Reader?I:new c.default.Reader(I);let le=$===void 0?Z.len:Z.pos+$;const de=Object.assign({},ie);for(de.speakers=[];Z.pos<le;){const he=Z.uint32();switch(he>>>3){case 1:de.speakers.push(a.SpeakerInfo.decode(Z,Z.uint32()));break;default:Z.skipType(he&7);break}}return de},fromJSON(I){const $=Object.assign({},ie);if($.speakers=[],I.speakers!==void 0&&I.speakers!==null)for(const Z of I.speakers)$.speakers.push(a.SpeakerInfo.fromJSON(Z));return $},toJSON(I){const $={};return I.speakers?$.speakers=I.speakers.map(Z=>Z?a.SpeakerInfo.toJSON(Z):void 0):$.speakers=[],$},fromPartial(I){const $=Object.assign({},ie);if($.speakers=[],I.speakers!==void 0&&I.speakers!==null)for(const Z of I.speakers)$.speakers.push(a.SpeakerInfo.fromPartial(Z));return $}};const x={sid:"",level:0,active:!1};a.SpeakerInfo={encode(I,$=c.default.Writer.create()){return I.sid!==""&&$.uint32(10).string(I.sid),I.level!==0&&$.uint32(21).float(I.level),I.active===!0&&$.uint32(24).bool(I.active),$},decode(I,$){const Z=I instanceof c.default.Reader?I:new c.default.Reader(I);let le=$===void 0?Z.len:Z.pos+$;const de=Object.assign({},x);for(;Z.pos<le;){const he=Z.uint32();switch(he>>>3){case 1:de.sid=Z.string();break;case 2:de.level=Z.float();break;case 3:de.active=Z.bool();break;default:Z.skipType(he&7);break}}return de},fromJSON(I){const $=Object.assign({},x);return I.sid!==void 0&&I.sid!==null?$.sid=String(I.sid):$.sid="",I.level!==void 0&&I.level!==null?$.level=Number(I.level):$.level=0,I.active!==void 0&&I.active!==null?$.active=Boolean(I.active):$.active=!1,$},toJSON(I){const $={};return I.sid!==void 0&&($.sid=I.sid),I.level!==void 0&&($.level=I.level),I.active!==void 0&&($.active=I.active),$},fromPartial(I){var $,Z,le;const de=Object.assign({},x);return de.sid=($=I.sid)!==null&&$!==void 0?$:"",de.level=(Z=I.level)!==null&&Z!==void 0?Z:0,de.active=(le=I.active)!==null&&le!==void 0?le:!1,de}};const Y={participantSid:"",destinationSids:""};a.UserPacket={encode(I,$=c.default.Writer.create()){I.participantSid!==""&&$.uint32(10).string(I.participantSid),I.payload.length!==0&&$.uint32(18).bytes(I.payload);for(const Z of I.destinationSids)$.uint32(26).string(Z);return $},decode(I,$){const Z=I instanceof c.default.Reader?I:new c.default.Reader(I);let le=$===void 0?Z.len:Z.pos+$;const de=Object.assign({},Y);for(de.destinationSids=[],de.payload=new Uint8Array;Z.pos<le;){const he=Z.uint32();switch(he>>>3){case 1:de.participantSid=Z.string();break;case 2:de.payload=Z.bytes();break;case 3:de.destinationSids.push(Z.string());break;default:Z.skipType(he&7);break}}return de},fromJSON(I){const $=Object.assign({},Y);if($.destinationSids=[],$.payload=new Uint8Array,I.participantSid!==void 0&&I.participantSid!==null?$.participantSid=String(I.participantSid):$.participantSid="",I.payload!==void 0&&I.payload!==null&&($.payload=v(I.payload)),I.destinationSids!==void 0&&I.destinationSids!==null)for(const Z of I.destinationSids)$.destinationSids.push(String(Z));return $},toJSON(I){const $={};return I.participantSid!==void 0&&($.participantSid=I.participantSid),I.payload!==void 0&&($.payload=w(I.payload!==void 0?I.payload:new Uint8Array)),I.destinationSids?$.destinationSids=I.destinationSids.map(Z=>Z):$.destinationSids=[],$},fromPartial(I){var $,Z;const le=Object.assign({},Y);if(le.participantSid=($=I.participantSid)!==null&&$!==void 0?$:"",le.payload=(Z=I.payload)!==null&&Z!==void 0?Z:new Uint8Array,le.destinationSids=[],I.destinationSids!==void 0&&I.destinationSids!==null)for(const de of I.destinationSids)le.destinationSids.push(de);return le}};const oe={participantSid:"",trackSids:""};a.ParticipantTracks={encode(I,$=c.default.Writer.create()){I.participantSid!==""&&$.uint32(10).string(I.participantSid);for(const Z of I.trackSids)$.uint32(18).string(Z);return $},decode(I,$){const Z=I instanceof c.default.Reader?I:new c.default.Reader(I);let le=$===void 0?Z.len:Z.pos+$;const de=Object.assign({},oe);for(de.trackSids=[];Z.pos<le;){const he=Z.uint32();switch(he>>>3){case 1:de.participantSid=Z.string();break;case 2:de.trackSids.push(Z.string());break;default:Z.skipType(he&7);break}}return de},fromJSON(I){const $=Object.assign({},oe);if($.trackSids=[],I.participantSid!==void 0&&I.participantSid!==null?$.participantSid=String(I.participantSid):$.participantSid="",I.trackSids!==void 0&&I.trackSids!==null)for(const Z of I.trackSids)$.trackSids.push(String(Z));return $},toJSON(I){const $={};return I.participantSid!==void 0&&($.participantSid=I.participantSid),I.trackSids?$.trackSids=I.trackSids.map(Z=>Z):$.trackSids=[],$},fromPartial(I){var $;const Z=Object.assign({},oe);if(Z.participantSid=($=I.participantSid)!==null&&$!==void 0?$:"",Z.trackSids=[],I.trackSids!==void 0&&I.trackSids!==null)for(const le of I.trackSids)Z.trackSids.push(le);return Z}};const fe={sdk:0,version:"",protocol:0,os:"",osVersion:"",deviceModel:"",browser:"",browserVersion:""};a.ClientInfo={encode(I,$=c.default.Writer.create()){return I.sdk!==0&&$.uint32(8).int32(I.sdk),I.version!==""&&$.uint32(18).string(I.version),I.protocol!==0&&$.uint32(24).int32(I.protocol),I.os!==""&&$.uint32(34).string(I.os),I.osVersion!==""&&$.uint32(42).string(I.osVersion),I.deviceModel!==""&&$.uint32(50).string(I.deviceModel),I.browser!==""&&$.uint32(58).string(I.browser),I.browserVersion!==""&&$.uint32(66).string(I.browserVersion),$},decode(I,$){const Z=I instanceof c.default.Reader?I:new c.default.Reader(I);let le=$===void 0?Z.len:Z.pos+$;const de=Object.assign({},fe);for(;Z.pos<le;){const he=Z.uint32();switch(he>>>3){case 1:de.sdk=Z.int32();break;case 2:de.version=Z.string();break;case 3:de.protocol=Z.int32();break;case 4:de.os=Z.string();break;case 5:de.osVersion=Z.string();break;case 6:de.deviceModel=Z.string();break;case 7:de.browser=Z.string();break;case 8:de.browserVersion=Z.string();break;default:Z.skipType(he&7);break}}return de},fromJSON(I){const $=Object.assign({},fe);return I.sdk!==void 0&&I.sdk!==null?$.sdk=ne(I.sdk):$.sdk=0,I.version!==void 0&&I.version!==null?$.version=String(I.version):$.version="",I.protocol!==void 0&&I.protocol!==null?$.protocol=Number(I.protocol):$.protocol=0,I.os!==void 0&&I.os!==null?$.os=String(I.os):$.os="",I.osVersion!==void 0&&I.osVersion!==null?$.osVersion=String(I.osVersion):$.osVersion="",I.deviceModel!==void 0&&I.deviceModel!==null?$.deviceModel=String(I.deviceModel):$.deviceModel="",I.browser!==void 0&&I.browser!==null?$.browser=String(I.browser):$.browser="",I.browserVersion!==void 0&&I.browserVersion!==null?$.browserVersion=String(I.browserVersion):$.browserVersion="",$},toJSON(I){const $={};return I.sdk!==void 0&&($.sdk=X(I.sdk)),I.version!==void 0&&($.version=I.version),I.protocol!==void 0&&($.protocol=I.protocol),I.os!==void 0&&($.os=I.os),I.osVersion!==void 0&&($.osVersion=I.osVersion),I.deviceModel!==void 0&&($.deviceModel=I.deviceModel),I.browser!==void 0&&($.browser=I.browser),I.browserVersion!==void 0&&($.browserVersion=I.browserVersion),$},fromPartial(I){var $,Z,le,de,he,ge,Pe,Te;const _e=Object.assign({},fe);return _e.sdk=($=I.sdk)!==null&&$!==void 0?$:0,_e.version=(Z=I.version)!==null&&Z!==void 0?Z:"",_e.protocol=(le=I.protocol)!==null&&le!==void 0?le:0,_e.os=(de=I.os)!==null&&de!==void 0?de:"",_e.osVersion=(he=I.osVersion)!==null&&he!==void 0?he:"",_e.deviceModel=(ge=I.deviceModel)!==null&&ge!==void 0?ge:"",_e.browser=(Pe=I.browser)!==null&&Pe!==void 0?Pe:"",_e.browserVersion=(Te=I.browserVersion)!==null&&Te!==void 0?Te:"",_e}};var pe=(()=>{if(typeof pe!="undefined")return pe;if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof commonjsGlobal!="undefined")return commonjsGlobal;throw"Unable to locate global object"})();const me=pe.atob||(I=>pe.Buffer.from(I,"base64").toString("binary"));function v(I){const $=me(I),Z=new Uint8Array($.length);for(let le=0;le<$.length;++le)Z[le]=$.charCodeAt(le);return Z}const g=pe.btoa||(I=>pe.Buffer.from(I,"binary").toString("base64"));function w(I){const $=[];for(const Z of I)$.push(String.fromCharCode(Z));return g($.join(""))}function ae(I){if(I.gt(Number.MAX_SAFE_INTEGER))throw new pe.Error("Value is larger than Number.MAX_SAFE_INTEGER");return I.toNumber()}c.default.util.Long!==d.default&&(c.default.util.Long=d.default,c.default.configure())})(livekit_models$1);var LocalParticipant$1={},livekit_rtc={};(function(a){var s=commonjsGlobal&&commonjsGlobal.__importDefault||function(v){return v&&v.__esModule?v:{default:v}};Object.defineProperty(a,"__esModule",{value:!0}),a.SimulateScenario=a.SyncState=a.SubscriptionPermissionUpdate=a.UpdateSubscriptionPermissions=a.TrackPermission=a.SubscribedQualityUpdate=a.SubscribedQuality=a.StreamStateUpdate=a.StreamStateInfo=a.ConnectionQualityUpdate=a.ConnectionQualityInfo=a.RoomUpdate=a.SpeakersChanged=a.ICEServer=a.UpdateVideoLayers=a.LeaveRequest=a.UpdateTrackSettings=a.UpdateSubscription=a.ParticipantUpdate=a.SessionDescription=a.TrackPublishedResponse=a.JoinResponse=a.MuteTrackRequest=a.TrickleRequest=a.AddTrackRequest=a.SignalResponse=a.SignalRequest=a.streamStateToJSON=a.streamStateFromJSON=a.StreamState=a.signalTargetToJSON=a.signalTargetFromJSON=a.SignalTarget=a.protobufPackage=void 0;const d=s(umd.exports),c=s(minimal),l=livekit_models$1;a.protobufPackage="livekit";var h;(function(v){v[v.PUBLISHER=0]="PUBLISHER",v[v.SUBSCRIBER=1]="SUBSCRIBER",v[v.UNRECOGNIZED=-1]="UNRECOGNIZED"})(h=a.SignalTarget||(a.SignalTarget={}));function p(v){switch(v){case 0:case"PUBLISHER":return h.PUBLISHER;case 1:case"SUBSCRIBER":return h.SUBSCRIBER;case-1:case"UNRECOGNIZED":default:return h.UNRECOGNIZED}}a.signalTargetFromJSON=p;function y(v){switch(v){case h.PUBLISHER:return"PUBLISHER";case h.SUBSCRIBER:return"SUBSCRIBER";default:return"UNKNOWN"}}a.signalTargetToJSON=y;var _;(function(v){v[v.ACTIVE=0]="ACTIVE",v[v.PAUSED=1]="PAUSED",v[v.UNRECOGNIZED=-1]="UNRECOGNIZED"})(_=a.StreamState||(a.StreamState={}));function E(v){switch(v){case 0:case"ACTIVE":return _.ACTIVE;case 1:case"PAUSED":return _.PAUSED;case-1:case"UNRECOGNIZED":default:return _.UNRECOGNIZED}}a.streamStateFromJSON=E;function O(v){switch(v){case _.ACTIVE:return"ACTIVE";case _.PAUSED:return"PAUSED";default:return"UNKNOWN"}}a.streamStateToJSON=O;const P={};a.SignalRequest={encode(v,g=c.default.Writer.create()){return v.offer!==void 0&&a.SessionDescription.encode(v.offer,g.uint32(10).fork()).ldelim(),v.answer!==void 0&&a.SessionDescription.encode(v.answer,g.uint32(18).fork()).ldelim(),v.trickle!==void 0&&a.TrickleRequest.encode(v.trickle,g.uint32(26).fork()).ldelim(),v.addTrack!==void 0&&a.AddTrackRequest.encode(v.addTrack,g.uint32(34).fork()).ldelim(),v.mute!==void 0&&a.MuteTrackRequest.encode(v.mute,g.uint32(42).fork()).ldelim(),v.subscription!==void 0&&a.UpdateSubscription.encode(v.subscription,g.uint32(50).fork()).ldelim(),v.trackSetting!==void 0&&a.UpdateTrackSettings.encode(v.trackSetting,g.uint32(58).fork()).ldelim(),v.leave!==void 0&&a.LeaveRequest.encode(v.leave,g.uint32(66).fork()).ldelim(),v.updateLayers!==void 0&&a.UpdateVideoLayers.encode(v.updateLayers,g.uint32(82).fork()).ldelim(),v.subscriptionPermissions!==void 0&&a.UpdateSubscriptionPermissions.encode(v.subscriptionPermissions,g.uint32(90).fork()).ldelim(),v.syncState!==void 0&&a.SyncState.encode(v.syncState,g.uint32(98).fork()).ldelim(),v.simulate!==void 0&&a.SimulateScenario.encode(v.simulate,g.uint32(106).fork()).ldelim(),g},decode(v,g){const w=v instanceof c.default.Reader?v:new c.default.Reader(v);let ae=g===void 0?w.len:w.pos+g;const I=Object.assign({},P);for(;w.pos<ae;){const $=w.uint32();switch($>>>3){case 1:I.offer=a.SessionDescription.decode(w,w.uint32());break;case 2:I.answer=a.SessionDescription.decode(w,w.uint32());break;case 3:I.trickle=a.TrickleRequest.decode(w,w.uint32());break;case 4:I.addTrack=a.AddTrackRequest.decode(w,w.uint32());break;case 5:I.mute=a.MuteTrackRequest.decode(w,w.uint32());break;case 6:I.subscription=a.UpdateSubscription.decode(w,w.uint32());break;case 7:I.trackSetting=a.UpdateTrackSettings.decode(w,w.uint32());break;case 8:I.leave=a.LeaveRequest.decode(w,w.uint32());break;case 10:I.updateLayers=a.UpdateVideoLayers.decode(w,w.uint32());break;case 11:I.subscriptionPermissions=a.UpdateSubscriptionPermissions.decode(w,w.uint32());break;case 12:I.syncState=a.SyncState.decode(w,w.uint32());break;case 13:I.simulate=a.SimulateScenario.decode(w,w.uint32());break;default:w.skipType($&7);break}}return I},fromJSON(v){const g=Object.assign({},P);return v.offer!==void 0&&v.offer!==null?g.offer=a.SessionDescription.fromJSON(v.offer):g.offer=void 0,v.answer!==void 0&&v.answer!==null?g.answer=a.SessionDescription.fromJSON(v.answer):g.answer=void 0,v.trickle!==void 0&&v.trickle!==null?g.trickle=a.TrickleRequest.fromJSON(v.trickle):g.trickle=void 0,v.addTrack!==void 0&&v.addTrack!==null?g.addTrack=a.AddTrackRequest.fromJSON(v.addTrack):g.addTrack=void 0,v.mute!==void 0&&v.mute!==null?g.mute=a.MuteTrackRequest.fromJSON(v.mute):g.mute=void 0,v.subscription!==void 0&&v.subscription!==null?g.subscription=a.UpdateSubscription.fromJSON(v.subscription):g.subscription=void 0,v.trackSetting!==void 0&&v.trackSetting!==null?g.trackSetting=a.UpdateTrackSettings.fromJSON(v.trackSetting):g.trackSetting=void 0,v.leave!==void 0&&v.leave!==null?g.leave=a.LeaveRequest.fromJSON(v.leave):g.leave=void 0,v.updateLayers!==void 0&&v.updateLayers!==null?g.updateLayers=a.UpdateVideoLayers.fromJSON(v.updateLayers):g.updateLayers=void 0,v.subscriptionPermissions!==void 0&&v.subscriptionPermissions!==null?g.subscriptionPermissions=a.UpdateSubscriptionPermissions.fromJSON(v.subscriptionPermissions):g.subscriptionPermissions=void 0,v.syncState!==void 0&&v.syncState!==null?g.syncState=a.SyncState.fromJSON(v.syncState):g.syncState=void 0,v.simulate!==void 0&&v.simulate!==null?g.simulate=a.SimulateScenario.fromJSON(v.simulate):g.simulate=void 0,g},toJSON(v){const g={};return v.offer!==void 0&&(g.offer=v.offer?a.SessionDescription.toJSON(v.offer):void 0),v.answer!==void 0&&(g.answer=v.answer?a.SessionDescription.toJSON(v.answer):void 0),v.trickle!==void 0&&(g.trickle=v.trickle?a.TrickleRequest.toJSON(v.trickle):void 0),v.addTrack!==void 0&&(g.addTrack=v.addTrack?a.AddTrackRequest.toJSON(v.addTrack):void 0),v.mute!==void 0&&(g.mute=v.mute?a.MuteTrackRequest.toJSON(v.mute):void 0),v.subscription!==void 0&&(g.subscription=v.subscription?a.UpdateSubscription.toJSON(v.subscription):void 0),v.trackSetting!==void 0&&(g.trackSetting=v.trackSetting?a.UpdateTrackSettings.toJSON(v.trackSetting):void 0),v.leave!==void 0&&(g.leave=v.leave?a.LeaveRequest.toJSON(v.leave):void 0),v.updateLayers!==void 0&&(g.updateLayers=v.updateLayers?a.UpdateVideoLayers.toJSON(v.updateLayers):void 0),v.subscriptionPermissions!==void 0&&(g.subscriptionPermissions=v.subscriptionPermissions?a.UpdateSubscriptionPermissions.toJSON(v.subscriptionPermissions):void 0),v.syncState!==void 0&&(g.syncState=v.syncState?a.SyncState.toJSON(v.syncState):void 0),v.simulate!==void 0&&(g.simulate=v.simulate?a.SimulateScenario.toJSON(v.simulate):void 0),g},fromPartial(v){const g=Object.assign({},P);return v.offer!==void 0&&v.offer!==null?g.offer=a.SessionDescription.fromPartial(v.offer):g.offer=void 0,v.answer!==void 0&&v.answer!==null?g.answer=a.SessionDescription.fromPartial(v.answer):g.answer=void 0,v.trickle!==void 0&&v.trickle!==null?g.trickle=a.TrickleRequest.fromPartial(v.trickle):g.trickle=void 0,v.addTrack!==void 0&&v.addTrack!==null?g.addTrack=a.AddTrackRequest.fromPartial(v.addTrack):g.addTrack=void 0,v.mute!==void 0&&v.mute!==null?g.mute=a.MuteTrackRequest.fromPartial(v.mute):g.mute=void 0,v.subscription!==void 0&&v.subscription!==null?g.subscription=a.UpdateSubscription.fromPartial(v.subscription):g.subscription=void 0,v.trackSetting!==void 0&&v.trackSetting!==null?g.trackSetting=a.UpdateTrackSettings.fromPartial(v.trackSetting):g.trackSetting=void 0,v.leave!==void 0&&v.leave!==null?g.leave=a.LeaveRequest.fromPartial(v.leave):g.leave=void 0,v.updateLayers!==void 0&&v.updateLayers!==null?g.updateLayers=a.UpdateVideoLayers.fromPartial(v.updateLayers):g.updateLayers=void 0,v.subscriptionPermissions!==void 0&&v.subscriptionPermissions!==null?g.subscriptionPermissions=a.UpdateSubscriptionPermissions.fromPartial(v.subscriptionPermissions):g.subscriptionPermissions=void 0,v.syncState!==void 0&&v.syncState!==null?g.syncState=a.SyncState.fromPartial(v.syncState):g.syncState=void 0,v.simulate!==void 0&&v.simulate!==null?g.simulate=a.SimulateScenario.fromPartial(v.simulate):g.simulate=void 0,g}};const C={};a.SignalResponse={encode(v,g=c.default.Writer.create()){return v.join!==void 0&&a.JoinResponse.encode(v.join,g.uint32(10).fork()).ldelim(),v.answer!==void 0&&a.SessionDescription.encode(v.answer,g.uint32(18).fork()).ldelim(),v.offer!==void 0&&a.SessionDescription.encode(v.offer,g.uint32(26).fork()).ldelim(),v.trickle!==void 0&&a.TrickleRequest.encode(v.trickle,g.uint32(34).fork()).ldelim(),v.update!==void 0&&a.ParticipantUpdate.encode(v.update,g.uint32(42).fork()).ldelim(),v.trackPublished!==void 0&&a.TrackPublishedResponse.encode(v.trackPublished,g.uint32(50).fork()).ldelim(),v.leave!==void 0&&a.LeaveRequest.encode(v.leave,g.uint32(66).fork()).ldelim(),v.mute!==void 0&&a.MuteTrackRequest.encode(v.mute,g.uint32(74).fork()).ldelim(),v.speakersChanged!==void 0&&a.SpeakersChanged.encode(v.speakersChanged,g.uint32(82).fork()).ldelim(),v.roomUpdate!==void 0&&a.RoomUpdate.encode(v.roomUpdate,g.uint32(90).fork()).ldelim(),v.connectionQuality!==void 0&&a.ConnectionQualityUpdate.encode(v.connectionQuality,g.uint32(98).fork()).ldelim(),v.streamStateUpdate!==void 0&&a.StreamStateUpdate.encode(v.streamStateUpdate,g.uint32(106).fork()).ldelim(),v.subscribedQualityUpdate!==void 0&&a.SubscribedQualityUpdate.encode(v.subscribedQualityUpdate,g.uint32(114).fork()).ldelim(),v.subscriptionPermissionUpdate!==void 0&&a.SubscriptionPermissionUpdate.encode(v.subscriptionPermissionUpdate,g.uint32(122).fork()).ldelim(),g},decode(v,g){const w=v instanceof c.default.Reader?v:new c.default.Reader(v);let ae=g===void 0?w.len:w.pos+g;const I=Object.assign({},C);for(;w.pos<ae;){const $=w.uint32();switch($>>>3){case 1:I.join=a.JoinResponse.decode(w,w.uint32());break;case 2:I.answer=a.SessionDescription.decode(w,w.uint32());break;case 3:I.offer=a.SessionDescription.decode(w,w.uint32());break;case 4:I.trickle=a.TrickleRequest.decode(w,w.uint32());break;case 5:I.update=a.ParticipantUpdate.decode(w,w.uint32());break;case 6:I.trackPublished=a.TrackPublishedResponse.decode(w,w.uint32());break;case 8:I.leave=a.LeaveRequest.decode(w,w.uint32());break;case 9:I.mute=a.MuteTrackRequest.decode(w,w.uint32());break;case 10:I.speakersChanged=a.SpeakersChanged.decode(w,w.uint32());break;case 11:I.roomUpdate=a.RoomUpdate.decode(w,w.uint32());break;case 12:I.connectionQuality=a.ConnectionQualityUpdate.decode(w,w.uint32());break;case 13:I.streamStateUpdate=a.StreamStateUpdate.decode(w,w.uint32());break;case 14:I.subscribedQualityUpdate=a.SubscribedQualityUpdate.decode(w,w.uint32());break;case 15:I.subscriptionPermissionUpdate=a.SubscriptionPermissionUpdate.decode(w,w.uint32());break;default:w.skipType($&7);break}}return I},fromJSON(v){const g=Object.assign({},C);return v.join!==void 0&&v.join!==null?g.join=a.JoinResponse.fromJSON(v.join):g.join=void 0,v.answer!==void 0&&v.answer!==null?g.answer=a.SessionDescription.fromJSON(v.answer):g.answer=void 0,v.offer!==void 0&&v.offer!==null?g.offer=a.SessionDescription.fromJSON(v.offer):g.offer=void 0,v.trickle!==void 0&&v.trickle!==null?g.trickle=a.TrickleRequest.fromJSON(v.trickle):g.trickle=void 0,v.update!==void 0&&v.update!==null?g.update=a.ParticipantUpdate.fromJSON(v.update):g.update=void 0,v.trackPublished!==void 0&&v.trackPublished!==null?g.trackPublished=a.TrackPublishedResponse.fromJSON(v.trackPublished):g.trackPublished=void 0,v.leave!==void 0&&v.leave!==null?g.leave=a.LeaveRequest.fromJSON(v.leave):g.leave=void 0,v.mute!==void 0&&v.mute!==null?g.mute=a.MuteTrackRequest.fromJSON(v.mute):g.mute=void 0,v.speakersChanged!==void 0&&v.speakersChanged!==null?g.speakersChanged=a.SpeakersChanged.fromJSON(v.speakersChanged):g.speakersChanged=void 0,v.roomUpdate!==void 0&&v.roomUpdate!==null?g.roomUpdate=a.RoomUpdate.fromJSON(v.roomUpdate):g.roomUpdate=void 0,v.connectionQuality!==void 0&&v.connectionQuality!==null?g.connectionQuality=a.ConnectionQualityUpdate.fromJSON(v.connectionQuality):g.connectionQuality=void 0,v.streamStateUpdate!==void 0&&v.streamStateUpdate!==null?g.streamStateUpdate=a.StreamStateUpdate.fromJSON(v.streamStateUpdate):g.streamStateUpdate=void 0,v.subscribedQualityUpdate!==void 0&&v.subscribedQualityUpdate!==null?g.subscribedQualityUpdate=a.SubscribedQualityUpdate.fromJSON(v.subscribedQualityUpdate):g.subscribedQualityUpdate=void 0,v.subscriptionPermissionUpdate!==void 0&&v.subscriptionPermissionUpdate!==null?g.subscriptionPermissionUpdate=a.SubscriptionPermissionUpdate.fromJSON(v.subscriptionPermissionUpdate):g.subscriptionPermissionUpdate=void 0,g},toJSON(v){const g={};return v.join!==void 0&&(g.join=v.join?a.JoinResponse.toJSON(v.join):void 0),v.answer!==void 0&&(g.answer=v.answer?a.SessionDescription.toJSON(v.answer):void 0),v.offer!==void 0&&(g.offer=v.offer?a.SessionDescription.toJSON(v.offer):void 0),v.trickle!==void 0&&(g.trickle=v.trickle?a.TrickleRequest.toJSON(v.trickle):void 0),v.update!==void 0&&(g.update=v.update?a.ParticipantUpdate.toJSON(v.update):void 0),v.trackPublished!==void 0&&(g.trackPublished=v.trackPublished?a.TrackPublishedResponse.toJSON(v.trackPublished):void 0),v.leave!==void 0&&(g.leave=v.leave?a.LeaveRequest.toJSON(v.leave):void 0),v.mute!==void 0&&(g.mute=v.mute?a.MuteTrackRequest.toJSON(v.mute):void 0),v.speakersChanged!==void 0&&(g.speakersChanged=v.speakersChanged?a.SpeakersChanged.toJSON(v.speakersChanged):void 0),v.roomUpdate!==void 0&&(g.roomUpdate=v.roomUpdate?a.RoomUpdate.toJSON(v.roomUpdate):void 0),v.connectionQuality!==void 0&&(g.connectionQuality=v.connectionQuality?a.ConnectionQualityUpdate.toJSON(v.connectionQuality):void 0),v.streamStateUpdate!==void 0&&(g.streamStateUpdate=v.streamStateUpdate?a.StreamStateUpdate.toJSON(v.streamStateUpdate):void 0),v.subscribedQualityUpdate!==void 0&&(g.subscribedQualityUpdate=v.subscribedQualityUpdate?a.SubscribedQualityUpdate.toJSON(v.subscribedQualityUpdate):void 0),v.subscriptionPermissionUpdate!==void 0&&(g.subscriptionPermissionUpdate=v.subscriptionPermissionUpdate?a.SubscriptionPermissionUpdate.toJSON(v.subscriptionPermissionUpdate):void 0),g},fromPartial(v){const g=Object.assign({},C);return v.join!==void 0&&v.join!==null?g.join=a.JoinResponse.fromPartial(v.join):g.join=void 0,v.answer!==void 0&&v.answer!==null?g.answer=a.SessionDescription.fromPartial(v.answer):g.answer=void 0,v.offer!==void 0&&v.offer!==null?g.offer=a.SessionDescription.fromPartial(v.offer):g.offer=void 0,v.trickle!==void 0&&v.trickle!==null?g.trickle=a.TrickleRequest.fromPartial(v.trickle):g.trickle=void 0,v.update!==void 0&&v.update!==null?g.update=a.ParticipantUpdate.fromPartial(v.update):g.update=void 0,v.trackPublished!==void 0&&v.trackPublished!==null?g.trackPublished=a.TrackPublishedResponse.fromPartial(v.trackPublished):g.trackPublished=void 0,v.leave!==void 0&&v.leave!==null?g.leave=a.LeaveRequest.fromPartial(v.leave):g.leave=void 0,v.mute!==void 0&&v.mute!==null?g.mute=a.MuteTrackRequest.fromPartial(v.mute):g.mute=void 0,v.speakersChanged!==void 0&&v.speakersChanged!==null?g.speakersChanged=a.SpeakersChanged.fromPartial(v.speakersChanged):g.speakersChanged=void 0,v.roomUpdate!==void 0&&v.roomUpdate!==null?g.roomUpdate=a.RoomUpdate.fromPartial(v.roomUpdate):g.roomUpdate=void 0,v.connectionQuality!==void 0&&v.connectionQuality!==null?g.connectionQuality=a.ConnectionQualityUpdate.fromPartial(v.connectionQuality):g.connectionQuality=void 0,v.streamStateUpdate!==void 0&&v.streamStateUpdate!==null?g.streamStateUpdate=a.StreamStateUpdate.fromPartial(v.streamStateUpdate):g.streamStateUpdate=void 0,v.subscribedQualityUpdate!==void 0&&v.subscribedQualityUpdate!==null?g.subscribedQualityUpdate=a.SubscribedQualityUpdate.fromPartial(v.subscribedQualityUpdate):g.subscribedQualityUpdate=void 0,v.subscriptionPermissionUpdate!==void 0&&v.subscriptionPermissionUpdate!==null?g.subscriptionPermissionUpdate=a.SubscriptionPermissionUpdate.fromPartial(v.subscriptionPermissionUpdate):g.subscriptionPermissionUpdate=void 0,g}};const A={cid:"",name:"",type:0,width:0,height:0,muted:!1,disableDtx:!1,source:0};a.AddTrackRequest={encode(v,g=c.default.Writer.create()){v.cid!==""&&g.uint32(10).string(v.cid),v.name!==""&&g.uint32(18).string(v.name),v.type!==0&&g.uint32(24).int32(v.type),v.width!==0&&g.uint32(32).uint32(v.width),v.height!==0&&g.uint32(40).uint32(v.height),v.muted===!0&&g.uint32(48).bool(v.muted),v.disableDtx===!0&&g.uint32(56).bool(v.disableDtx),v.source!==0&&g.uint32(64).int32(v.source);for(const w of v.layers)l.VideoLayer.encode(w,g.uint32(74).fork()).ldelim();return g},decode(v,g){const w=v instanceof c.default.Reader?v:new c.default.Reader(v);let ae=g===void 0?w.len:w.pos+g;const I=Object.assign({},A);for(I.layers=[];w.pos<ae;){const $=w.uint32();switch($>>>3){case 1:I.cid=w.string();break;case 2:I.name=w.string();break;case 3:I.type=w.int32();break;case 4:I.width=w.uint32();break;case 5:I.height=w.uint32();break;case 6:I.muted=w.bool();break;case 7:I.disableDtx=w.bool();break;case 8:I.source=w.int32();break;case 9:I.layers.push(l.VideoLayer.decode(w,w.uint32()));break;default:w.skipType($&7);break}}return I},fromJSON(v){const g=Object.assign({},A);if(g.layers=[],v.cid!==void 0&&v.cid!==null?g.cid=String(v.cid):g.cid="",v.name!==void 0&&v.name!==null?g.name=String(v.name):g.name="",v.type!==void 0&&v.type!==null?g.type=l.trackTypeFromJSON(v.type):g.type=0,v.width!==void 0&&v.width!==null?g.width=Number(v.width):g.width=0,v.height!==void 0&&v.height!==null?g.height=Number(v.height):g.height=0,v.muted!==void 0&&v.muted!==null?g.muted=Boolean(v.muted):g.muted=!1,v.disableDtx!==void 0&&v.disableDtx!==null?g.disableDtx=Boolean(v.disableDtx):g.disableDtx=!1,v.source!==void 0&&v.source!==null?g.source=l.trackSourceFromJSON(v.source):g.source=0,v.layers!==void 0&&v.layers!==null)for(const w of v.layers)g.layers.push(l.VideoLayer.fromJSON(w));return g},toJSON(v){const g={};return v.cid!==void 0&&(g.cid=v.cid),v.name!==void 0&&(g.name=v.name),v.type!==void 0&&(g.type=l.trackTypeToJSON(v.type)),v.width!==void 0&&(g.width=v.width),v.height!==void 0&&(g.height=v.height),v.muted!==void 0&&(g.muted=v.muted),v.disableDtx!==void 0&&(g.disableDtx=v.disableDtx),v.source!==void 0&&(g.source=l.trackSourceToJSON(v.source)),v.layers?g.layers=v.layers.map(w=>w?l.VideoLayer.toJSON(w):void 0):g.layers=[],g},fromPartial(v){var g,w,ae,I,$,Z,le,de;const he=Object.assign({},A);if(he.cid=(g=v.cid)!==null&&g!==void 0?g:"",he.name=(w=v.name)!==null&&w!==void 0?w:"",he.type=(ae=v.type)!==null&&ae!==void 0?ae:0,he.width=(I=v.width)!==null&&I!==void 0?I:0,he.height=($=v.height)!==null&&$!==void 0?$:0,he.muted=(Z=v.muted)!==null&&Z!==void 0?Z:!1,he.disableDtx=(le=v.disableDtx)!==null&&le!==void 0?le:!1,he.source=(de=v.source)!==null&&de!==void 0?de:0,he.layers=[],v.layers!==void 0&&v.layers!==null)for(const ge of v.layers)he.layers.push(l.VideoLayer.fromPartial(ge));return he}};const q={candidateInit:"",target:0};a.TrickleRequest={encode(v,g=c.default.Writer.create()){return v.candidateInit!==""&&g.uint32(10).string(v.candidateInit),v.target!==0&&g.uint32(16).int32(v.target),g},decode(v,g){const w=v instanceof c.default.Reader?v:new c.default.Reader(v);let ae=g===void 0?w.len:w.pos+g;const I=Object.assign({},q);for(;w.pos<ae;){const $=w.uint32();switch($>>>3){case 1:I.candidateInit=w.string();break;case 2:I.target=w.int32();break;default:w.skipType($&7);break}}return I},fromJSON(v){const g=Object.assign({},q);return v.candidateInit!==void 0&&v.candidateInit!==null?g.candidateInit=String(v.candidateInit):g.candidateInit="",v.target!==void 0&&v.target!==null?g.target=p(v.target):g.target=0,g},toJSON(v){const g={};return v.candidateInit!==void 0&&(g.candidateInit=v.candidateInit),v.target!==void 0&&(g.target=y(v.target)),g},fromPartial(v){var g,w;const ae=Object.assign({},q);return ae.candidateInit=(g=v.candidateInit)!==null&&g!==void 0?g:"",ae.target=(w=v.target)!==null&&w!==void 0?w:0,ae}};const U={sid:"",muted:!1};a.MuteTrackRequest={encode(v,g=c.default.Writer.create()){return v.sid!==""&&g.uint32(10).string(v.sid),v.muted===!0&&g.uint32(16).bool(v.muted),g},decode(v,g){const w=v instanceof c.default.Reader?v:new c.default.Reader(v);let ae=g===void 0?w.len:w.pos+g;const I=Object.assign({},U);for(;w.pos<ae;){const $=w.uint32();switch($>>>3){case 1:I.sid=w.string();break;case 2:I.muted=w.bool();break;default:w.skipType($&7);break}}return I},fromJSON(v){const g=Object.assign({},U);return v.sid!==void 0&&v.sid!==null?g.sid=String(v.sid):g.sid="",v.muted!==void 0&&v.muted!==null?g.muted=Boolean(v.muted):g.muted=!1,g},toJSON(v){const g={};return v.sid!==void 0&&(g.sid=v.sid),v.muted!==void 0&&(g.muted=v.muted),g},fromPartial(v){var g,w;const ae=Object.assign({},U);return ae.sid=(g=v.sid)!==null&&g!==void 0?g:"",ae.muted=(w=v.muted)!==null&&w!==void 0?w:!1,ae}};const F={serverVersion:"",subscriberPrimary:!1,alternativeUrl:""};a.JoinResponse={encode(v,g=c.default.Writer.create()){v.room!==void 0&&l.Room.encode(v.room,g.uint32(10).fork()).ldelim(),v.participant!==void 0&&l.ParticipantInfo.encode(v.participant,g.uint32(18).fork()).ldelim();for(const w of v.otherParticipants)l.ParticipantInfo.encode(w,g.uint32(26).fork()).ldelim();v.serverVersion!==""&&g.uint32(34).string(v.serverVersion);for(const w of v.iceServers)a.ICEServer.encode(w,g.uint32(42).fork()).ldelim();return v.subscriberPrimary===!0&&g.uint32(48).bool(v.subscriberPrimary),v.alternativeUrl!==""&&g.uint32(58).string(v.alternativeUrl),g},decode(v,g){const w=v instanceof c.default.Reader?v:new c.default.Reader(v);let ae=g===void 0?w.len:w.pos+g;const I=Object.assign({},F);for(I.otherParticipants=[],I.iceServers=[];w.pos<ae;){const $=w.uint32();switch($>>>3){case 1:I.room=l.Room.decode(w,w.uint32());break;case 2:I.participant=l.ParticipantInfo.decode(w,w.uint32());break;case 3:I.otherParticipants.push(l.ParticipantInfo.decode(w,w.uint32()));break;case 4:I.serverVersion=w.string();break;case 5:I.iceServers.push(a.ICEServer.decode(w,w.uint32()));break;case 6:I.subscriberPrimary=w.bool();break;case 7:I.alternativeUrl=w.string();break;default:w.skipType($&7);break}}return I},fromJSON(v){const g=Object.assign({},F);if(g.otherParticipants=[],g.iceServers=[],v.room!==void 0&&v.room!==null?g.room=l.Room.fromJSON(v.room):g.room=void 0,v.participant!==void 0&&v.participant!==null?g.participant=l.ParticipantInfo.fromJSON(v.participant):g.participant=void 0,v.otherParticipants!==void 0&&v.otherParticipants!==null)for(const w of v.otherParticipants)g.otherParticipants.push(l.ParticipantInfo.fromJSON(w));if(v.serverVersion!==void 0&&v.serverVersion!==null?g.serverVersion=String(v.serverVersion):g.serverVersion="",v.iceServers!==void 0&&v.iceServers!==null)for(const w of v.iceServers)g.iceServers.push(a.ICEServer.fromJSON(w));return v.subscriberPrimary!==void 0&&v.subscriberPrimary!==null?g.subscriberPrimary=Boolean(v.subscriberPrimary):g.subscriberPrimary=!1,v.alternativeUrl!==void 0&&v.alternativeUrl!==null?g.alternativeUrl=String(v.alternativeUrl):g.alternativeUrl="",g},toJSON(v){const g={};return v.room!==void 0&&(g.room=v.room?l.Room.toJSON(v.room):void 0),v.participant!==void 0&&(g.participant=v.participant?l.ParticipantInfo.toJSON(v.participant):void 0),v.otherParticipants?g.otherParticipants=v.otherParticipants.map(w=>w?l.ParticipantInfo.toJSON(w):void 0):g.otherParticipants=[],v.serverVersion!==void 0&&(g.serverVersion=v.serverVersion),v.iceServers?g.iceServers=v.iceServers.map(w=>w?a.ICEServer.toJSON(w):void 0):g.iceServers=[],v.subscriberPrimary!==void 0&&(g.subscriberPrimary=v.subscriberPrimary),v.alternativeUrl!==void 0&&(g.alternativeUrl=v.alternativeUrl),g},fromPartial(v){var g,w,ae;const I=Object.assign({},F);if(v.room!==void 0&&v.room!==null?I.room=l.Room.fromPartial(v.room):I.room=void 0,v.participant!==void 0&&v.participant!==null?I.participant=l.ParticipantInfo.fromPartial(v.participant):I.participant=void 0,I.otherParticipants=[],v.otherParticipants!==void 0&&v.otherParticipants!==null)for(const $ of v.otherParticipants)I.otherParticipants.push(l.ParticipantInfo.fromPartial($));if(I.serverVersion=(g=v.serverVersion)!==null&&g!==void 0?g:"",I.iceServers=[],v.iceServers!==void 0&&v.iceServers!==null)for(const $ of v.iceServers)I.iceServers.push(a.ICEServer.fromPartial($));return I.subscriberPrimary=(w=v.subscriberPrimary)!==null&&w!==void 0?w:!1,I.alternativeUrl=(ae=v.alternativeUrl)!==null&&ae!==void 0?ae:"",I}};const j={cid:""};a.TrackPublishedResponse={encode(v,g=c.default.Writer.create()){return v.cid!==""&&g.uint32(10).string(v.cid),v.track!==void 0&&l.TrackInfo.encode(v.track,g.uint32(18).fork()).ldelim(),g},decode(v,g){const w=v instanceof c.default.Reader?v:new c.default.Reader(v);let ae=g===void 0?w.len:w.pos+g;const I=Object.assign({},j);for(;w.pos<ae;){const $=w.uint32();switch($>>>3){case 1:I.cid=w.string();break;case 2:I.track=l.TrackInfo.decode(w,w.uint32());break;default:w.skipType($&7);break}}return I},fromJSON(v){const g=Object.assign({},j);return v.cid!==void 0&&v.cid!==null?g.cid=String(v.cid):g.cid="",v.track!==void 0&&v.track!==null?g.track=l.TrackInfo.fromJSON(v.track):g.track=void 0,g},toJSON(v){const g={};return v.cid!==void 0&&(g.cid=v.cid),v.track!==void 0&&(g.track=v.track?l.TrackInfo.toJSON(v.track):void 0),g},fromPartial(v){var g;const w=Object.assign({},j);return w.cid=(g=v.cid)!==null&&g!==void 0?g:"",v.track!==void 0&&v.track!==null?w.track=l.TrackInfo.fromPartial(v.track):w.track=void 0,w}};const T={type:"",sdp:""};a.SessionDescription={encode(v,g=c.default.Writer.create()){return v.type!==""&&g.uint32(10).string(v.type),v.sdp!==""&&g.uint32(18).string(v.sdp),g},decode(v,g){const w=v instanceof c.default.Reader?v:new c.default.Reader(v);let ae=g===void 0?w.len:w.pos+g;const I=Object.assign({},T);for(;w.pos<ae;){const $=w.uint32();switch($>>>3){case 1:I.type=w.string();break;case 2:I.sdp=w.string();break;default:w.skipType($&7);break}}return I},fromJSON(v){const g=Object.assign({},T);return v.type!==void 0&&v.type!==null?g.type=String(v.type):g.type="",v.sdp!==void 0&&v.sdp!==null?g.sdp=String(v.sdp):g.sdp="",g},toJSON(v){const g={};return v.type!==void 0&&(g.type=v.type),v.sdp!==void 0&&(g.sdp=v.sdp),g},fromPartial(v){var g,w;const ae=Object.assign({},T);return ae.type=(g=v.type)!==null&&g!==void 0?g:"",ae.sdp=(w=v.sdp)!==null&&w!==void 0?w:"",ae}};const D={};a.ParticipantUpdate={encode(v,g=c.default.Writer.create()){for(const w of v.participants)l.ParticipantInfo.encode(w,g.uint32(10).fork()).ldelim();return g},decode(v,g){const w=v instanceof c.default.Reader?v:new c.default.Reader(v);let ae=g===void 0?w.len:w.pos+g;const I=Object.assign({},D);for(I.participants=[];w.pos<ae;){const $=w.uint32();switch($>>>3){case 1:I.participants.push(l.ParticipantInfo.decode(w,w.uint32()));break;default:w.skipType($&7);break}}return I},fromJSON(v){const g=Object.assign({},D);if(g.participants=[],v.participants!==void 0&&v.participants!==null)for(const w of v.participants)g.participants.push(l.ParticipantInfo.fromJSON(w));return g},toJSON(v){const g={};return v.participants?g.participants=v.participants.map(w=>w?l.ParticipantInfo.toJSON(w):void 0):g.participants=[],g},fromPartial(v){const g=Object.assign({},D);if(g.participants=[],v.participants!==void 0&&v.participants!==null)for(const w of v.participants)g.participants.push(l.ParticipantInfo.fromPartial(w));return g}};const J={trackSids:"",subscribe:!1};a.UpdateSubscription={encode(v,g=c.default.Writer.create()){for(const w of v.trackSids)g.uint32(10).string(w);v.subscribe===!0&&g.uint32(16).bool(v.subscribe);for(const w of v.participantTracks)l.ParticipantTracks.encode(w,g.uint32(26).fork()).ldelim();return g},decode(v,g){const w=v instanceof c.default.Reader?v:new c.default.Reader(v);let ae=g===void 0?w.len:w.pos+g;const I=Object.assign({},J);for(I.trackSids=[],I.participantTracks=[];w.pos<ae;){const $=w.uint32();switch($>>>3){case 1:I.trackSids.push(w.string());break;case 2:I.subscribe=w.bool();break;case 3:I.participantTracks.push(l.ParticipantTracks.decode(w,w.uint32()));break;default:w.skipType($&7);break}}return I},fromJSON(v){const g=Object.assign({},J);if(g.trackSids=[],g.participantTracks=[],v.trackSids!==void 0&&v.trackSids!==null)for(const w of v.trackSids)g.trackSids.push(String(w));if(v.subscribe!==void 0&&v.subscribe!==null?g.subscribe=Boolean(v.subscribe):g.subscribe=!1,v.participantTracks!==void 0&&v.participantTracks!==null)for(const w of v.participantTracks)g.participantTracks.push(l.ParticipantTracks.fromJSON(w));return g},toJSON(v){const g={};return v.trackSids?g.trackSids=v.trackSids.map(w=>w):g.trackSids=[],v.subscribe!==void 0&&(g.subscribe=v.subscribe),v.participantTracks?g.participantTracks=v.participantTracks.map(w=>w?l.ParticipantTracks.toJSON(w):void 0):g.participantTracks=[],g},fromPartial(v){var g;const w=Object.assign({},J);if(w.trackSids=[],v.trackSids!==void 0&&v.trackSids!==null)for(const ae of v.trackSids)w.trackSids.push(ae);if(w.subscribe=(g=v.subscribe)!==null&&g!==void 0?g:!1,w.participantTracks=[],v.participantTracks!==void 0&&v.participantTracks!==null)for(const ae of v.participantTracks)w.participantTracks.push(l.ParticipantTracks.fromPartial(ae));return w}};const ee={trackSids:"",disabled:!1,quality:0,width:0,height:0};a.UpdateTrackSettings={encode(v,g=c.default.Writer.create()){for(const w of v.trackSids)g.uint32(10).string(w);return v.disabled===!0&&g.uint32(24).bool(v.disabled),v.quality!==0&&g.uint32(32).int32(v.quality),v.width!==0&&g.uint32(40).uint32(v.width),v.height!==0&&g.uint32(48).uint32(v.height),g},decode(v,g){const w=v instanceof c.default.Reader?v:new c.default.Reader(v);let ae=g===void 0?w.len:w.pos+g;const I=Object.assign({},ee);for(I.trackSids=[];w.pos<ae;){const $=w.uint32();switch($>>>3){case 1:I.trackSids.push(w.string());break;case 3:I.disabled=w.bool();break;case 4:I.quality=w.int32();break;case 5:I.width=w.uint32();break;case 6:I.height=w.uint32();break;default:w.skipType($&7);break}}return I},fromJSON(v){const g=Object.assign({},ee);if(g.trackSids=[],v.trackSids!==void 0&&v.trackSids!==null)for(const w of v.trackSids)g.trackSids.push(String(w));return v.disabled!==void 0&&v.disabled!==null?g.disabled=Boolean(v.disabled):g.disabled=!1,v.quality!==void 0&&v.quality!==null?g.quality=l.videoQualityFromJSON(v.quality):g.quality=0,v.width!==void 0&&v.width!==null?g.width=Number(v.width):g.width=0,v.height!==void 0&&v.height!==null?g.height=Number(v.height):g.height=0,g},toJSON(v){const g={};return v.trackSids?g.trackSids=v.trackSids.map(w=>w):g.trackSids=[],v.disabled!==void 0&&(g.disabled=v.disabled),v.quality!==void 0&&(g.quality=l.videoQualityToJSON(v.quality)),v.width!==void 0&&(g.width=v.width),v.height!==void 0&&(g.height=v.height),g},fromPartial(v){var g,w,ae,I;const $=Object.assign({},ee);if($.trackSids=[],v.trackSids!==void 0&&v.trackSids!==null)for(const Z of v.trackSids)$.trackSids.push(Z);return $.disabled=(g=v.disabled)!==null&&g!==void 0?g:!1,$.quality=(w=v.quality)!==null&&w!==void 0?w:0,$.width=(ae=v.width)!==null&&ae!==void 0?ae:0,$.height=(I=v.height)!==null&&I!==void 0?I:0,$}};const z={canReconnect:!1};a.LeaveRequest={encode(v,g=c.default.Writer.create()){return v.canReconnect===!0&&g.uint32(8).bool(v.canReconnect),g},decode(v,g){const w=v instanceof c.default.Reader?v:new c.default.Reader(v);let ae=g===void 0?w.len:w.pos+g;const I=Object.assign({},z);for(;w.pos<ae;){const $=w.uint32();switch($>>>3){case 1:I.canReconnect=w.bool();break;default:w.skipType($&7);break}}return I},fromJSON(v){const g=Object.assign({},z);return v.canReconnect!==void 0&&v.canReconnect!==null?g.canReconnect=Boolean(v.canReconnect):g.canReconnect=!1,g},toJSON(v){const g={};return v.canReconnect!==void 0&&(g.canReconnect=v.canReconnect),g},fromPartial(v){var g;const w=Object.assign({},z);return w.canReconnect=(g=v.canReconnect)!==null&&g!==void 0?g:!1,w}};const ne={trackSid:""};a.UpdateVideoLayers={encode(v,g=c.default.Writer.create()){v.trackSid!==""&&g.uint32(10).string(v.trackSid);for(const w of v.layers)l.VideoLayer.encode(w,g.uint32(18).fork()).ldelim();return g},decode(v,g){const w=v instanceof c.default.Reader?v:new c.default.Reader(v);let ae=g===void 0?w.len:w.pos+g;const I=Object.assign({},ne);for(I.layers=[];w.pos<ae;){const $=w.uint32();switch($>>>3){case 1:I.trackSid=w.string();break;case 2:I.layers.push(l.VideoLayer.decode(w,w.uint32()));break;default:w.skipType($&7);break}}return I},fromJSON(v){const g=Object.assign({},ne);if(g.layers=[],v.trackSid!==void 0&&v.trackSid!==null?g.trackSid=String(v.trackSid):g.trackSid="",v.layers!==void 0&&v.layers!==null)for(const w of v.layers)g.layers.push(l.VideoLayer.fromJSON(w));return g},toJSON(v){const g={};return v.trackSid!==void 0&&(g.trackSid=v.trackSid),v.layers?g.layers=v.layers.map(w=>w?l.VideoLayer.toJSON(w):void 0):g.layers=[],g},fromPartial(v){var g;const w=Object.assign({},ne);if(w.trackSid=(g=v.trackSid)!==null&&g!==void 0?g:"",w.layers=[],v.layers!==void 0&&v.layers!==null)for(const ae of v.layers)w.layers.push(l.VideoLayer.fromPartial(ae));return w}};const X={urls:"",username:"",credential:""};a.ICEServer={encode(v,g=c.default.Writer.create()){for(const w of v.urls)g.uint32(10).string(w);return v.username!==""&&g.uint32(18).string(v.username),v.credential!==""&&g.uint32(26).string(v.credential),g},decode(v,g){const w=v instanceof c.default.Reader?v:new c.default.Reader(v);let ae=g===void 0?w.len:w.pos+g;const I=Object.assign({},X);for(I.urls=[];w.pos<ae;){const $=w.uint32();switch($>>>3){case 1:I.urls.push(w.string());break;case 2:I.username=w.string();break;case 3:I.credential=w.string();break;default:w.skipType($&7);break}}return I},fromJSON(v){const g=Object.assign({},X);if(g.urls=[],v.urls!==void 0&&v.urls!==null)for(const w of v.urls)g.urls.push(String(w));return v.username!==void 0&&v.username!==null?g.username=String(v.username):g.username="",v.credential!==void 0&&v.credential!==null?g.credential=String(v.credential):g.credential="",g},toJSON(v){const g={};return v.urls?g.urls=v.urls.map(w=>w):g.urls=[],v.username!==void 0&&(g.username=v.username),v.credential!==void 0&&(g.credential=v.credential),g},fromPartial(v){var g,w;const ae=Object.assign({},X);if(ae.urls=[],v.urls!==void 0&&v.urls!==null)for(const I of v.urls)ae.urls.push(I);return ae.username=(g=v.username)!==null&&g!==void 0?g:"",ae.credential=(w=v.credential)!==null&&w!==void 0?w:"",ae}};const M={};a.SpeakersChanged={encode(v,g=c.default.Writer.create()){for(const w of v.speakers)l.SpeakerInfo.encode(w,g.uint32(10).fork()).ldelim();return g},decode(v,g){const w=v instanceof c.default.Reader?v:new c.default.Reader(v);let ae=g===void 0?w.len:w.pos+g;const I=Object.assign({},M);for(I.speakers=[];w.pos<ae;){const $=w.uint32();switch($>>>3){case 1:I.speakers.push(l.SpeakerInfo.decode(w,w.uint32()));break;default:w.skipType($&7);break}}return I},fromJSON(v){const g=Object.assign({},M);if(g.speakers=[],v.speakers!==void 0&&v.speakers!==null)for(const w of v.speakers)g.speakers.push(l.SpeakerInfo.fromJSON(w));return g},toJSON(v){const g={};return v.speakers?g.speakers=v.speakers.map(w=>w?l.SpeakerInfo.toJSON(w):void 0):g.speakers=[],g},fromPartial(v){const g=Object.assign({},M);if(g.speakers=[],v.speakers!==void 0&&v.speakers!==null)for(const w of v.speakers)g.speakers.push(l.SpeakerInfo.fromPartial(w));return g}};const K={};a.RoomUpdate={encode(v,g=c.default.Writer.create()){return v.room!==void 0&&l.Room.encode(v.room,g.uint32(10).fork()).ldelim(),g},decode(v,g){const w=v instanceof c.default.Reader?v:new c.default.Reader(v);let ae=g===void 0?w.len:w.pos+g;const I=Object.assign({},K);for(;w.pos<ae;){const $=w.uint32();switch($>>>3){case 1:I.room=l.Room.decode(w,w.uint32());break;default:w.skipType($&7);break}}return I},fromJSON(v){const g=Object.assign({},K);return v.room!==void 0&&v.room!==null?g.room=l.Room.fromJSON(v.room):g.room=void 0,g},toJSON(v){const g={};return v.room!==void 0&&(g.room=v.room?l.Room.toJSON(v.room):void 0),g},fromPartial(v){const g=Object.assign({},K);return v.room!==void 0&&v.room!==null?g.room=l.Room.fromPartial(v.room):g.room=void 0,g}};const te={participantSid:"",quality:0,score:0};a.ConnectionQualityInfo={encode(v,g=c.default.Writer.create()){return v.participantSid!==""&&g.uint32(10).string(v.participantSid),v.quality!==0&&g.uint32(16).int32(v.quality),v.score!==0&&g.uint32(29).float(v.score),g},decode(v,g){const w=v instanceof c.default.Reader?v:new c.default.Reader(v);let ae=g===void 0?w.len:w.pos+g;const I=Object.assign({},te);for(;w.pos<ae;){const $=w.uint32();switch($>>>3){case 1:I.participantSid=w.string();break;case 2:I.quality=w.int32();break;case 3:I.score=w.float();break;default:w.skipType($&7);break}}return I},fromJSON(v){const g=Object.assign({},te);return v.participantSid!==void 0&&v.participantSid!==null?g.participantSid=String(v.participantSid):g.participantSid="",v.quality!==void 0&&v.quality!==null?g.quality=l.connectionQualityFromJSON(v.quality):g.quality=0,v.score!==void 0&&v.score!==null?g.score=Number(v.score):g.score=0,g},toJSON(v){const g={};return v.participantSid!==void 0&&(g.participantSid=v.participantSid),v.quality!==void 0&&(g.quality=l.connectionQualityToJSON(v.quality)),v.score!==void 0&&(g.score=v.score),g},fromPartial(v){var g,w,ae;const I=Object.assign({},te);return I.participantSid=(g=v.participantSid)!==null&&g!==void 0?g:"",I.quality=(w=v.quality)!==null&&w!==void 0?w:0,I.score=(ae=v.score)!==null&&ae!==void 0?ae:0,I}};const L={};a.ConnectionQualityUpdate={encode(v,g=c.default.Writer.create()){for(const w of v.updates)a.ConnectionQualityInfo.encode(w,g.uint32(10).fork()).ldelim();return g},decode(v,g){const w=v instanceof c.default.Reader?v:new c.default.Reader(v);let ae=g===void 0?w.len:w.pos+g;const I=Object.assign({},L);for(I.updates=[];w.pos<ae;){const $=w.uint32();switch($>>>3){case 1:I.updates.push(a.ConnectionQualityInfo.decode(w,w.uint32()));break;default:w.skipType($&7);break}}return I},fromJSON(v){const g=Object.assign({},L);if(g.updates=[],v.updates!==void 0&&v.updates!==null)for(const w of v.updates)g.updates.push(a.ConnectionQualityInfo.fromJSON(w));return g},toJSON(v){const g={};return v.updates?g.updates=v.updates.map(w=>w?a.ConnectionQualityInfo.toJSON(w):void 0):g.updates=[],g},fromPartial(v){const g=Object.assign({},L);if(g.updates=[],v.updates!==void 0&&v.updates!==null)for(const w of v.updates)g.updates.push(a.ConnectionQualityInfo.fromPartial(w));return g}};const G={participantSid:"",trackSid:"",state:0};a.StreamStateInfo={encode(v,g=c.default.Writer.create()){return v.participantSid!==""&&g.uint32(10).string(v.participantSid),v.trackSid!==""&&g.uint32(18).string(v.trackSid),v.state!==0&&g.uint32(24).int32(v.state),g},decode(v,g){const w=v instanceof c.default.Reader?v:new c.default.Reader(v);let ae=g===void 0?w.len:w.pos+g;const I=Object.assign({},G);for(;w.pos<ae;){const $=w.uint32();switch($>>>3){case 1:I.participantSid=w.string();break;case 2:I.trackSid=w.string();break;case 3:I.state=w.int32();break;default:w.skipType($&7);break}}return I},fromJSON(v){const g=Object.assign({},G);return v.participantSid!==void 0&&v.participantSid!==null?g.participantSid=String(v.participantSid):g.participantSid="",v.trackSid!==void 0&&v.trackSid!==null?g.trackSid=String(v.trackSid):g.trackSid="",v.state!==void 0&&v.state!==null?g.state=E(v.state):g.state=0,g},toJSON(v){const g={};return v.participantSid!==void 0&&(g.participantSid=v.participantSid),v.trackSid!==void 0&&(g.trackSid=v.trackSid),v.state!==void 0&&(g.state=O(v.state)),g},fromPartial(v){var g,w,ae;const I=Object.assign({},G);return I.participantSid=(g=v.participantSid)!==null&&g!==void 0?g:"",I.trackSid=(w=v.trackSid)!==null&&w!==void 0?w:"",I.state=(ae=v.state)!==null&&ae!==void 0?ae:0,I}};const W={};a.StreamStateUpdate={encode(v,g=c.default.Writer.create()){for(const w of v.streamStates)a.StreamStateInfo.encode(w,g.uint32(10).fork()).ldelim();return g},decode(v,g){const w=v instanceof c.default.Reader?v:new c.default.Reader(v);let ae=g===void 0?w.len:w.pos+g;const I=Object.assign({},W);for(I.streamStates=[];w.pos<ae;){const $=w.uint32();switch($>>>3){case 1:I.streamStates.push(a.StreamStateInfo.decode(w,w.uint32()));break;default:w.skipType($&7);break}}return I},fromJSON(v){const g=Object.assign({},W);if(g.streamStates=[],v.streamStates!==void 0&&v.streamStates!==null)for(const w of v.streamStates)g.streamStates.push(a.StreamStateInfo.fromJSON(w));return g},toJSON(v){const g={};return v.streamStates?g.streamStates=v.streamStates.map(w=>w?a.StreamStateInfo.toJSON(w):void 0):g.streamStates=[],g},fromPartial(v){const g=Object.assign({},W);if(g.streamStates=[],v.streamStates!==void 0&&v.streamStates!==null)for(const w of v.streamStates)g.streamStates.push(a.StreamStateInfo.fromPartial(w));return g}};const ie={quality:0,enabled:!1};a.SubscribedQuality={encode(v,g=c.default.Writer.create()){return v.quality!==0&&g.uint32(8).int32(v.quality),v.enabled===!0&&g.uint32(16).bool(v.enabled),g},decode(v,g){const w=v instanceof c.default.Reader?v:new c.default.Reader(v);let ae=g===void 0?w.len:w.pos+g;const I=Object.assign({},ie);for(;w.pos<ae;){const $=w.uint32();switch($>>>3){case 1:I.quality=w.int32();break;case 2:I.enabled=w.bool();break;default:w.skipType($&7);break}}return I},fromJSON(v){const g=Object.assign({},ie);return v.quality!==void 0&&v.quality!==null?g.quality=l.videoQualityFromJSON(v.quality):g.quality=0,v.enabled!==void 0&&v.enabled!==null?g.enabled=Boolean(v.enabled):g.enabled=!1,g},toJSON(v){const g={};return v.quality!==void 0&&(g.quality=l.videoQualityToJSON(v.quality)),v.enabled!==void 0&&(g.enabled=v.enabled),g},fromPartial(v){var g,w;const ae=Object.assign({},ie);return ae.quality=(g=v.quality)!==null&&g!==void 0?g:0,ae.enabled=(w=v.enabled)!==null&&w!==void 0?w:!1,ae}};const x={trackSid:""};a.SubscribedQualityUpdate={encode(v,g=c.default.Writer.create()){v.trackSid!==""&&g.uint32(10).string(v.trackSid);for(const w of v.subscribedQualities)a.SubscribedQuality.encode(w,g.uint32(18).fork()).ldelim();return g},decode(v,g){const w=v instanceof c.default.Reader?v:new c.default.Reader(v);let ae=g===void 0?w.len:w.pos+g;const I=Object.assign({},x);for(I.subscribedQualities=[];w.pos<ae;){const $=w.uint32();switch($>>>3){case 1:I.trackSid=w.string();break;case 2:I.subscribedQualities.push(a.SubscribedQuality.decode(w,w.uint32()));break;default:w.skipType($&7);break}}return I},fromJSON(v){const g=Object.assign({},x);if(g.subscribedQualities=[],v.trackSid!==void 0&&v.trackSid!==null?g.trackSid=String(v.trackSid):g.trackSid="",v.subscribedQualities!==void 0&&v.subscribedQualities!==null)for(const w of v.subscribedQualities)g.subscribedQualities.push(a.SubscribedQuality.fromJSON(w));return g},toJSON(v){const g={};return v.trackSid!==void 0&&(g.trackSid=v.trackSid),v.subscribedQualities?g.subscribedQualities=v.subscribedQualities.map(w=>w?a.SubscribedQuality.toJSON(w):void 0):g.subscribedQualities=[],g},fromPartial(v){var g;const w=Object.assign({},x);if(w.trackSid=(g=v.trackSid)!==null&&g!==void 0?g:"",w.subscribedQualities=[],v.subscribedQualities!==void 0&&v.subscribedQualities!==null)for(const ae of v.subscribedQualities)w.subscribedQualities.push(a.SubscribedQuality.fromPartial(ae));return w}};const Y={participantSid:"",allTracks:!1,trackSids:""};a.TrackPermission={encode(v,g=c.default.Writer.create()){v.participantSid!==""&&g.uint32(10).string(v.participantSid),v.allTracks===!0&&g.uint32(16).bool(v.allTracks);for(const w of v.trackSids)g.uint32(26).string(w);return g},decode(v,g){const w=v instanceof c.default.Reader?v:new c.default.Reader(v);let ae=g===void 0?w.len:w.pos+g;const I=Object.assign({},Y);for(I.trackSids=[];w.pos<ae;){const $=w.uint32();switch($>>>3){case 1:I.participantSid=w.string();break;case 2:I.allTracks=w.bool();break;case 3:I.trackSids.push(w.string());break;default:w.skipType($&7);break}}return I},fromJSON(v){const g=Object.assign({},Y);if(g.trackSids=[],v.participantSid!==void 0&&v.participantSid!==null?g.participantSid=String(v.participantSid):g.participantSid="",v.allTracks!==void 0&&v.allTracks!==null?g.allTracks=Boolean(v.allTracks):g.allTracks=!1,v.trackSids!==void 0&&v.trackSids!==null)for(const w of v.trackSids)g.trackSids.push(String(w));return g},toJSON(v){const g={};return v.participantSid!==void 0&&(g.participantSid=v.participantSid),v.allTracks!==void 0&&(g.allTracks=v.allTracks),v.trackSids?g.trackSids=v.trackSids.map(w=>w):g.trackSids=[],g},fromPartial(v){var g,w;const ae=Object.assign({},Y);if(ae.participantSid=(g=v.participantSid)!==null&&g!==void 0?g:"",ae.allTracks=(w=v.allTracks)!==null&&w!==void 0?w:!1,ae.trackSids=[],v.trackSids!==void 0&&v.trackSids!==null)for(const I of v.trackSids)ae.trackSids.push(I);return ae}};const oe={allParticipants:!1};a.UpdateSubscriptionPermissions={encode(v,g=c.default.Writer.create()){v.allParticipants===!0&&g.uint32(8).bool(v.allParticipants);for(const w of v.trackPermissions)a.TrackPermission.encode(w,g.uint32(18).fork()).ldelim();return g},decode(v,g){const w=v instanceof c.default.Reader?v:new c.default.Reader(v);let ae=g===void 0?w.len:w.pos+g;const I=Object.assign({},oe);for(I.trackPermissions=[];w.pos<ae;){const $=w.uint32();switch($>>>3){case 1:I.allParticipants=w.bool();break;case 2:I.trackPermissions.push(a.TrackPermission.decode(w,w.uint32()));break;default:w.skipType($&7);break}}return I},fromJSON(v){const g=Object.assign({},oe);if(g.trackPermissions=[],v.allParticipants!==void 0&&v.allParticipants!==null?g.allParticipants=Boolean(v.allParticipants):g.allParticipants=!1,v.trackPermissions!==void 0&&v.trackPermissions!==null)for(const w of v.trackPermissions)g.trackPermissions.push(a.TrackPermission.fromJSON(w));return g},toJSON(v){const g={};return v.allParticipants!==void 0&&(g.allParticipants=v.allParticipants),v.trackPermissions?g.trackPermissions=v.trackPermissions.map(w=>w?a.TrackPermission.toJSON(w):void 0):g.trackPermissions=[],g},fromPartial(v){var g;const w=Object.assign({},oe);if(w.allParticipants=(g=v.allParticipants)!==null&&g!==void 0?g:!1,w.trackPermissions=[],v.trackPermissions!==void 0&&v.trackPermissions!==null)for(const ae of v.trackPermissions)w.trackPermissions.push(a.TrackPermission.fromPartial(ae));return w}};const fe={participantSid:"",trackSid:"",allowed:!1};a.SubscriptionPermissionUpdate={encode(v,g=c.default.Writer.create()){return v.participantSid!==""&&g.uint32(10).string(v.participantSid),v.trackSid!==""&&g.uint32(18).string(v.trackSid),v.allowed===!0&&g.uint32(24).bool(v.allowed),g},decode(v,g){const w=v instanceof c.default.Reader?v:new c.default.Reader(v);let ae=g===void 0?w.len:w.pos+g;const I=Object.assign({},fe);for(;w.pos<ae;){const $=w.uint32();switch($>>>3){case 1:I.participantSid=w.string();break;case 2:I.trackSid=w.string();break;case 3:I.allowed=w.bool();break;default:w.skipType($&7);break}}return I},fromJSON(v){const g=Object.assign({},fe);return v.participantSid!==void 0&&v.participantSid!==null?g.participantSid=String(v.participantSid):g.participantSid="",v.trackSid!==void 0&&v.trackSid!==null?g.trackSid=String(v.trackSid):g.trackSid="",v.allowed!==void 0&&v.allowed!==null?g.allowed=Boolean(v.allowed):g.allowed=!1,g},toJSON(v){const g={};return v.participantSid!==void 0&&(g.participantSid=v.participantSid),v.trackSid!==void 0&&(g.trackSid=v.trackSid),v.allowed!==void 0&&(g.allowed=v.allowed),g},fromPartial(v){var g,w,ae;const I=Object.assign({},fe);return I.participantSid=(g=v.participantSid)!==null&&g!==void 0?g:"",I.trackSid=(w=v.trackSid)!==null&&w!==void 0?w:"",I.allowed=(ae=v.allowed)!==null&&ae!==void 0?ae:!1,I}};const pe={};a.SyncState={encode(v,g=c.default.Writer.create()){v.answer!==void 0&&a.SessionDescription.encode(v.answer,g.uint32(10).fork()).ldelim(),v.subscription!==void 0&&a.UpdateSubscription.encode(v.subscription,g.uint32(18).fork()).ldelim();for(const w of v.publishTracks)a.TrackPublishedResponse.encode(w,g.uint32(26).fork()).ldelim();return g},decode(v,g){const w=v instanceof c.default.Reader?v:new c.default.Reader(v);let ae=g===void 0?w.len:w.pos+g;const I=Object.assign({},pe);for(I.publishTracks=[];w.pos<ae;){const $=w.uint32();switch($>>>3){case 1:I.answer=a.SessionDescription.decode(w,w.uint32());break;case 2:I.subscription=a.UpdateSubscription.decode(w,w.uint32());break;case 3:I.publishTracks.push(a.TrackPublishedResponse.decode(w,w.uint32()));break;default:w.skipType($&7);break}}return I},fromJSON(v){const g=Object.assign({},pe);if(g.publishTracks=[],v.answer!==void 0&&v.answer!==null?g.answer=a.SessionDescription.fromJSON(v.answer):g.answer=void 0,v.subscription!==void 0&&v.subscription!==null?g.subscription=a.UpdateSubscription.fromJSON(v.subscription):g.subscription=void 0,v.publishTracks!==void 0&&v.publishTracks!==null)for(const w of v.publishTracks)g.publishTracks.push(a.TrackPublishedResponse.fromJSON(w));return g},toJSON(v){const g={};return v.answer!==void 0&&(g.answer=v.answer?a.SessionDescription.toJSON(v.answer):void 0),v.subscription!==void 0&&(g.subscription=v.subscription?a.UpdateSubscription.toJSON(v.subscription):void 0),v.publishTracks?g.publishTracks=v.publishTracks.map(w=>w?a.TrackPublishedResponse.toJSON(w):void 0):g.publishTracks=[],g},fromPartial(v){const g=Object.assign({},pe);if(v.answer!==void 0&&v.answer!==null?g.answer=a.SessionDescription.fromPartial(v.answer):g.answer=void 0,v.subscription!==void 0&&v.subscription!==null?g.subscription=a.UpdateSubscription.fromPartial(v.subscription):g.subscription=void 0,g.publishTracks=[],v.publishTracks!==void 0&&v.publishTracks!==null)for(const w of v.publishTracks)g.publishTracks.push(a.TrackPublishedResponse.fromPartial(w));return g}};const me={};a.SimulateScenario={encode(v,g=c.default.Writer.create()){return v.speakerUpdate!==void 0&&g.uint32(8).int32(v.speakerUpdate),v.nodeFailure!==void 0&&g.uint32(16).bool(v.nodeFailure),v.migration!==void 0&&g.uint32(24).bool(v.migration),v.serverLeave!==void 0&&g.uint32(32).bool(v.serverLeave),g},decode(v,g){const w=v instanceof c.default.Reader?v:new c.default.Reader(v);let ae=g===void 0?w.len:w.pos+g;const I=Object.assign({},me);for(;w.pos<ae;){const $=w.uint32();switch($>>>3){case 1:I.speakerUpdate=w.int32();break;case 2:I.nodeFailure=w.bool();break;case 3:I.migration=w.bool();break;case 4:I.serverLeave=w.bool();break;default:w.skipType($&7);break}}return I},fromJSON(v){const g=Object.assign({},me);return v.speakerUpdate!==void 0&&v.speakerUpdate!==null?g.speakerUpdate=Number(v.speakerUpdate):g.speakerUpdate=void 0,v.nodeFailure!==void 0&&v.nodeFailure!==null?g.nodeFailure=Boolean(v.nodeFailure):g.nodeFailure=void 0,v.migration!==void 0&&v.migration!==null?g.migration=Boolean(v.migration):g.migration=void 0,v.serverLeave!==void 0&&v.serverLeave!==null?g.serverLeave=Boolean(v.serverLeave):g.serverLeave=void 0,g},toJSON(v){const g={};return v.speakerUpdate!==void 0&&(g.speakerUpdate=v.speakerUpdate),v.nodeFailure!==void 0&&(g.nodeFailure=v.nodeFailure),v.migration!==void 0&&(g.migration=v.migration),v.serverLeave!==void 0&&(g.serverLeave=v.serverLeave),g},fromPartial(v){var g,w,ae,I;const $=Object.assign({},me);return $.speakerUpdate=(g=v.speakerUpdate)!==null&&g!==void 0?g:void 0,$.nodeFailure=(w=v.nodeFailure)!==null&&w!==void 0?w:void 0,$.migration=(ae=v.migration)!==null&&ae!==void 0?ae:void 0,$.serverLeave=(I=v.serverLeave)!==null&&I!==void 0?I:void 0,$}},c.default.util.Long!==d.default&&(c.default.util.Long=d.default,c.default.configure())})(livekit_rtc);var errors={};(function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.MediaDeviceFailure=a.PublishDataError=a.UnexpectedConnectionState=a.UnsupportedServer=a.TrackInvalidError=a.ConnectionError=a.LivekitError=void 0;class s extends Error{constructor(_,E){super(E||"an error has occured"),this.code=_}}a.LivekitError=s;class d extends s{constructor(_){super(1,_)}}a.ConnectionError=d;class c extends s{constructor(_){super(20,_||"Track is invalid")}}a.TrackInvalidError=c;class l extends s{constructor(_){super(10,_||"Unsupported server")}}a.UnsupportedServer=l;class h extends s{constructor(_){super(12,_||"Unexpected connection state")}}a.UnexpectedConnectionState=h;class p extends s{constructor(_){super(13,_||"Unable to publish data")}}a.PublishDataError=p,function(y){y.PermissionDenied="PermissionDenied",y.NotFound="NotFound",y.DeviceInUse="DeviceInUse",y.Other="Other"}(a.MediaDeviceFailure||(a.MediaDeviceFailure={})),function(y){function _(E){if(E&&"name"in E)return E.name==="NotFoundError"||E.name==="DevicesNotFoundError"?y.NotFound:E.name==="NotAllowedError"||E.name==="PermissionDeniedError"?y.PermissionDenied:E.name==="NotReadableError"||E.name==="TrackStartError"?y.DeviceInUse:y.Other}y.getFailure=_}(a.MediaDeviceFailure||(a.MediaDeviceFailure={}))})(errors);var events$1={};(function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.TrackEvent=a.EngineEvent=a.ParticipantEvent=a.RoomEvent=void 0,function(s){s.Reconnecting="reconnecting",s.Reconnected="reconnected",s.Disconnected="disconnected",s.MediaDevicesChanged="mediaDevicesChanged",s.ParticipantConnected="participantConnected",s.ParticipantDisconnected="participantDisconnected",s.TrackPublished="trackPublished",s.TrackSubscribed="trackSubscribed",s.TrackSubscriptionFailed="trackSubscriptionFailed",s.TrackUnpublished="trackUnpublished",s.TrackUnsubscribed="trackUnsubscribed",s.TrackMuted="trackMuted",s.TrackUnmuted="trackUnmuted",s.LocalTrackPublished="localTrackPublished",s.LocalTrackUnpublished="localTrackUnpublished",s.ActiveSpeakersChanged="activeSpeakersChanged",s.MetadataChanged="metadataChanged",s.ParticipantMetadataChanged="participantMetaDataChanged",s.RoomMetadataChanged="roomMetadataChanged",s.DataReceived="dataReceived",s.ConnectionQualityChanged="connectionQualityChanged",s.TrackStreamStateChanged="trackStreamStateChanged",s.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",s.AudioPlaybackStatusChanged="audioPlaybackChanged",s.MediaDevicesError="mediaDevicesError"}(a.RoomEvent||(a.RoomEvent={})),function(s){s.TrackPublished="trackPublished",s.TrackSubscribed="trackSubscribed",s.TrackSubscriptionFailed="trackSubscriptionFailed",s.TrackUnpublished="trackUnpublished",s.TrackUnsubscribed="trackUnsubscribed",s.TrackMuted="trackMuted",s.TrackUnmuted="trackUnmuted",s.LocalTrackPublished="localTrackPublished",s.LocalTrackUnpublished="localTrackUnpublished",s.MetadataChanged="metadataChanged",s.ParticipantMetadataChanged="participantMetadataChanged",s.DataReceived="dataReceived",s.IsSpeakingChanged="isSpeakingChanged",s.ConnectionQualityChanged="connectionQualityChanged",s.TrackStreamStateChanged="trackStreamStateChanged",s.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",s.MediaDevicesError="mediaDevicesError"}(a.ParticipantEvent||(a.ParticipantEvent={})),function(s){s.Connected="connected",s.Disconnected="disconnected",s.Reconnecting="reconnecting",s.Reconnected="reconnected",s.SignalConnected="singalConnected",s.MediaTrackAdded="mediaTrackAdded",s.ActiveSpeakersUpdate="activeSpeakersUpdate",s.DataPacketReceived="dataPacketReceived"}(a.EngineEvent||(a.EngineEvent={})),function(s){s.Message="message",s.Muted="muted",s.Unmuted="unmuted",s.Ended="ended",s.UpdateSettings="updateSettings",s.UpdateSubscription="updateSubscription",s.AudioPlaybackStarted="audioPlaybackStarted",s.AudioPlaybackFailed="audioPlaybackFailed",s.VisibilityChanged="visibilityChanged",s.VideoDimensionsChanged="videoDimensionsChanged"}(a.TrackEvent||(a.TrackEvent={}))})(events$1);var LocalAudioTrack$1={},stats={};Object.defineProperty(stats,"__esModule",{value:!0}),stats.computeBitrate=stats.monitorFrequency=void 0,stats.monitorFrequency=2e3;function computeBitrate(a,s){if(!s)return 0;let d,c;return"bytesReceived"in a?(d=a.bytesReceived,c=s.bytesReceived):"bytesSent"in a&&(d=a.bytesSent,c=s.bytesSent),d===void 0||c===void 0||a.timestamp===void 0||s.timestamp===void 0?0:(d-c)*8*1e3/(a.timestamp-s.timestamp)}stats.computeBitrate=computeBitrate;var LocalTrack$1={},DeviceManager$1={},__awaiter$c=commonjsGlobal&&commonjsGlobal.__awaiter||function(a,s,d,c){function l(h){return h instanceof d?h:new d(function(p){p(h)})}return new(d||(d=Promise))(function(h,p){function y(O){try{E(c.next(O))}catch(P){p(P)}}function _(O){try{E(c.throw(O))}catch(P){p(P)}}function E(O){O.done?h(O.value):l(O.value).then(y,_)}E((c=c.apply(a,s||[])).next())})};Object.defineProperty(DeviceManager$1,"__esModule",{value:!0});const defaultId="default";class DeviceManager{static getInstance(){return this.instance===void 0&&(this.instance=new DeviceManager),this.instance}getDevices(s){return __awaiter$c(this,void 0,void 0,function*(){let d=yield navigator.mediaDevices.enumerateDevices();if(d=d.filter(c=>c.kind===s),d.length>1&&d[0].deviceId===defaultId){const c=d[0];for(let l=1;l<d.length;l+=1)if(d[l].groupId===c.groupId){const h=d[0];d[0]=d[l],d[l]=h;break}return d.filter(l=>l!==c)}return d})}normalizeDeviceId(s,d,c){return __awaiter$c(this,void 0,void 0,function*(){if(d!==defaultId)return d;const h=(yield this.getDevices(s)).find(p=>p.groupId===c&&p.deviceId!==defaultId);return h==null?void 0:h.deviceId})}}DeviceManager$1.default=DeviceManager,DeviceManager.mediaDeviceKinds=["audioinput","audiooutput","videoinput"];var Track={},events={exports:{}},R=typeof Reflect=="object"?Reflect:null,ReflectApply=R&&typeof R.apply=="function"?R.apply:function a(s,d,c){return Function.prototype.apply.call(s,d,c)},ReflectOwnKeys;R&&typeof R.ownKeys=="function"?ReflectOwnKeys=R.ownKeys:Object.getOwnPropertySymbols?ReflectOwnKeys=function(s){return Object.getOwnPropertyNames(s).concat(Object.getOwnPropertySymbols(s))}:ReflectOwnKeys=function(s){return Object.getOwnPropertyNames(s)};function ProcessEmitWarning(a){console&&console.warn&&console.warn(a)}var NumberIsNaN=Number.isNaN||function a(s){return s!==s};function EventEmitter(){EventEmitter.init.call(this)}events.exports=EventEmitter,events.exports.once=once,EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._eventsCount=0,EventEmitter.prototype._maxListeners=void 0;var defaultMaxListeners=10;function checkListener(a){if(typeof a!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof a)}Object.defineProperty(EventEmitter,"defaultMaxListeners",{enumerable:!0,get:function(){return defaultMaxListeners},set:function(a){if(typeof a!="number"||a<0||NumberIsNaN(a))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+a+".");defaultMaxListeners=a}}),EventEmitter.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},EventEmitter.prototype.setMaxListeners=function a(s){if(typeof s!="number"||s<0||NumberIsNaN(s))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+s+".");return this._maxListeners=s,this};function _getMaxListeners(a){return a._maxListeners===void 0?EventEmitter.defaultMaxListeners:a._maxListeners}EventEmitter.prototype.getMaxListeners=function a(){return _getMaxListeners(this)},EventEmitter.prototype.emit=function a(s){for(var d=[],c=1;c<arguments.length;c++)d.push(arguments[c]);var l=s==="error",h=this._events;if(h!==void 0)l=l&&h.error===void 0;else if(!l)return!1;if(l){var p;if(d.length>0&&(p=d[0]),p instanceof Error)throw p;var y=new Error("Unhandled error."+(p?" ("+p.message+")":""));throw y.context=p,y}var _=h[s];if(_===void 0)return!1;if(typeof _=="function")ReflectApply(_,this,d);else for(var E=_.length,O=arrayClone(_,E),c=0;c<E;++c)ReflectApply(O[c],this,d);return!0};function _addListener(a,s,d,c){var l,h,p;if(checkListener(d),h=a._events,h===void 0?(h=a._events=Object.create(null),a._eventsCount=0):(h.newListener!==void 0&&(a.emit("newListener",s,d.listener?d.listener:d),h=a._events),p=h[s]),p===void 0)p=h[s]=d,++a._eventsCount;else if(typeof p=="function"?p=h[s]=c?[d,p]:[p,d]:c?p.unshift(d):p.push(d),l=_getMaxListeners(a),l>0&&p.length>l&&!p.warned){p.warned=!0;var y=new Error("Possible EventEmitter memory leak detected. "+p.length+" "+String(s)+" listeners added. Use emitter.setMaxListeners() to increase limit");y.name="MaxListenersExceededWarning",y.emitter=a,y.type=s,y.count=p.length,ProcessEmitWarning(y)}return a}EventEmitter.prototype.addListener=function a(s,d){return _addListener(this,s,d,!1)},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.prependListener=function a(s,d){return _addListener(this,s,d,!0)};function onceWrapper(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function _onceWrap(a,s,d){var c={fired:!1,wrapFn:void 0,target:a,type:s,listener:d},l=onceWrapper.bind(c);return l.listener=d,c.wrapFn=l,l}EventEmitter.prototype.once=function a(s,d){return checkListener(d),this.on(s,_onceWrap(this,s,d)),this},EventEmitter.prototype.prependOnceListener=function a(s,d){return checkListener(d),this.prependListener(s,_onceWrap(this,s,d)),this},EventEmitter.prototype.removeListener=function a(s,d){var c,l,h,p,y;if(checkListener(d),l=this._events,l===void 0)return this;if(c=l[s],c===void 0)return this;if(c===d||c.listener===d)--this._eventsCount===0?this._events=Object.create(null):(delete l[s],l.removeListener&&this.emit("removeListener",s,c.listener||d));else if(typeof c!="function"){for(h=-1,p=c.length-1;p>=0;p--)if(c[p]===d||c[p].listener===d){y=c[p].listener,h=p;break}if(h<0)return this;h===0?c.shift():spliceOne(c,h),c.length===1&&(l[s]=c[0]),l.removeListener!==void 0&&this.emit("removeListener",s,y||d)}return this},EventEmitter.prototype.off=EventEmitter.prototype.removeListener,EventEmitter.prototype.removeAllListeners=function a(s){var d,c,l;if(c=this._events,c===void 0)return this;if(c.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):c[s]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete c[s]),this;if(arguments.length===0){var h=Object.keys(c),p;for(l=0;l<h.length;++l)p=h[l],p!=="removeListener"&&this.removeAllListeners(p);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(d=c[s],typeof d=="function")this.removeListener(s,d);else if(d!==void 0)for(l=d.length-1;l>=0;l--)this.removeListener(s,d[l]);return this};function _listeners(a,s,d){var c=a._events;if(c===void 0)return[];var l=c[s];return l===void 0?[]:typeof l=="function"?d?[l.listener||l]:[l]:d?unwrapListeners(l):arrayClone(l,l.length)}EventEmitter.prototype.listeners=function a(s){return _listeners(this,s,!0)},EventEmitter.prototype.rawListeners=function a(s){return _listeners(this,s,!1)},EventEmitter.listenerCount=function(a,s){return typeof a.listenerCount=="function"?a.listenerCount(s):listenerCount.call(a,s)},EventEmitter.prototype.listenerCount=listenerCount;function listenerCount(a){var s=this._events;if(s!==void 0){var d=s[a];if(typeof d=="function")return 1;if(d!==void 0)return d.length}return 0}EventEmitter.prototype.eventNames=function a(){return this._eventsCount>0?ReflectOwnKeys(this._events):[]};function arrayClone(a,s){for(var d=new Array(s),c=0;c<s;++c)d[c]=a[c];return d}function spliceOne(a,s){for(;s+1<a.length;s++)a[s]=a[s+1];a.pop()}function unwrapListeners(a){for(var s=new Array(a.length),d=0;d<s.length;++d)s[d]=a[d].listener||a[d];return s}function once(a,s){return new Promise(function(d,c){function l(p){a.removeListener(s,h),c(p)}function h(){typeof a.removeListener=="function"&&a.removeListener("error",l),d([].slice.call(arguments))}eventTargetAgnosticAddListener(a,s,h,{once:!0}),s!=="error"&&addErrorHandlerIfEventEmitter(a,l,{once:!0})})}function addErrorHandlerIfEventEmitter(a,s,d){typeof a.on=="function"&&eventTargetAgnosticAddListener(a,"error",s,d)}function eventTargetAgnosticAddListener(a,s,d,c){if(typeof a.on=="function")c.once?a.once(s,d):a.on(s,d);else if(typeof a.addEventListener=="function")a.addEventListener(s,function l(h){c.once&&a.removeEventListener(s,l),d(h)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof a)}var utils$f={},uaParser={exports:{}};(function(a,s){(function(d,c){var l="1.0.2",h="",p="?",y="function",_="undefined",E="object",O="string",P="major",C="model",A="name",q="type",U="vendor",F="version",j="architecture",T="console",D="mobile",J="tablet",ee="smarttv",z="wearable",ne="embedded",X=255,M="Amazon",K="Apple",te="ASUS",L="BlackBerry",G="Browser",W="Chrome",ie="Edge",x="Firefox",Y="Google",oe="Huawei",fe="LG",pe="Microsoft",me="Motorola",v="Opera",g="Samsung",w="Sony",ae="Xiaomi",I="Zebra",$="Facebook",Z=function(ve,Oe){var Ee={};for(var Ae in ve)Oe[Ae]&&Oe[Ae].length%2===0?Ee[Ae]=Oe[Ae].concat(ve[Ae]):Ee[Ae]=ve[Ae];return Ee},le=function(ve){for(var Oe={},Ee=0;Ee<ve.length;Ee++)Oe[ve[Ee].toUpperCase()]=ve[Ee];return Oe},de=function(ve,Oe){return typeof ve===O?he(Oe).indexOf(he(ve))!==-1:!1},he=function(ve){return ve.toLowerCase()},ge=function(ve){return typeof ve===O?ve.replace(/[^\d\.]/g,h).split(".")[0]:c},Pe=function(ve,Oe){if(typeof ve===O)return ve=ve.replace(/^\s\s*/,h).replace(/\s\s*$/,h),typeof Oe===_?ve:ve.substring(0,X)},Te=function(ve,Oe){for(var Ee=0,Ae,be,Qe,Re,Xe,Me;Ee<Oe.length&&!Xe;){var Ze=Oe[Ee],nt=Oe[Ee+1];for(Ae=be=0;Ae<Ze.length&&!Xe;)if(Xe=Ze[Ae++].exec(ve),Xe)for(Qe=0;Qe<nt.length;Qe++)Me=Xe[++be],Re=nt[Qe],typeof Re===E&&Re.length>0?Re.length===2?typeof Re[1]==y?this[Re[0]]=Re[1].call(this,Me):this[Re[0]]=Re[1]:Re.length===3?typeof Re[1]===y&&!(Re[1].exec&&Re[1].test)?this[Re[0]]=Me?Re[1].call(this,Me,Re[2]):c:this[Re[0]]=Me?Me.replace(Re[1],Re[2]):c:Re.length===4&&(this[Re[0]]=Me?Re[3].call(this,Me.replace(Re[1],Re[2])):c):this[Re]=Me||c;Ee+=2}},_e=function(ve,Oe){for(var Ee in Oe)if(typeof Oe[Ee]===E&&Oe[Ee].length>0){for(var Ae=0;Ae<Oe[Ee].length;Ae++)if(de(Oe[Ee][Ae],ve))return Ee===p?c:Ee}else if(de(Oe[Ee],ve))return Ee===p?c:Ee;return ve},Ne={"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"},We={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},ye={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[F,[A,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[F,[A,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[A,F],[/opios[\/ ]+([\w\.]+)/i],[F,[A,v+" Mini"]],[/\bopr\/([\w\.]+)/i],[F,[A,v]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[A,F],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[F,[A,"UC"+G]],[/\bqbcore\/([\w\.]+)/i],[F,[A,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[F,[A,"WeChat"]],[/konqueror\/([\w\.]+)/i],[F,[A,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[F,[A,"IE"]],[/yabrowser\/([\w\.]+)/i],[F,[A,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[A,/(.+)/,"$1 Secure "+G],F],[/\bfocus\/([\w\.]+)/i],[F,[A,x+" Focus"]],[/\bopt\/([\w\.]+)/i],[F,[A,v+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[F,[A,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[F,[A,"Dolphin"]],[/coast\/([\w\.]+)/i],[F,[A,v+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[F,[A,"MIUI "+G]],[/fxios\/([-\w\.]+)/i],[F,[A,x]],[/\bqihu|(qi?ho?o?|360)browser/i],[[A,"360 "+G]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[A,/(.+)/,"$1 "+G],F],[/(comodo_dragon)\/([\w\.]+)/i],[[A,/_/g," "],F],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[A,F],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i],[A],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[A,$],F],[/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[A,F],[/\bgsa\/([\w\.]+) .*safari\//i],[F,[A,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[F,[A,W+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[A,W+" WebView"],F],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[F,[A,"Android "+G]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[A,F],[/version\/([\w\.]+) .*mobile\/\w+ (safari)/i],[F,[A,"Mobile Safari"]],[/version\/([\w\.]+) .*(mobile ?safari|safari)/i],[F,A],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[A,[F,_e,Ne]],[/(webkit|khtml)\/([\w\.]+)/i],[A,F],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[A,"Netscape"],F],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[F,[A,x+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[A,F]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[j,"amd64"]],[/(ia32(?=;))/i],[[j,he]],[/((?:i[346]|x)86)[;\)]/i],[[j,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[j,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[j,"armhf"]],[/windows (ce|mobile); ppc;/i],[[j,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[j,/ower/,h,he]],[/(sun4\w)[;\)]/i],[[j,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[j,he]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[C,[U,g],[q,J]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[C,[U,g],[q,D]],[/\((ip(?:hone|od)[\w ]*);/i],[C,[U,K],[q,D]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[C,[U,K],[q,J]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[C,[U,oe],[q,J]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}-[atu]?[ln][01259x][012359][an]?)\b(?!.+d\/s)/i],[C,[U,oe],[q,D]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[C,/_/g," "],[U,ae],[q,D]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[C,/_/g," "],[U,ae],[q,J]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[C,[U,"OPPO"],[q,D]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[C,[U,"Vivo"],[q,D]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[C,[U,"Realme"],[q,D]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[C,[U,me],[q,D]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[C,[U,me],[q,J]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[C,[U,fe],[q,J]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[C,[U,fe],[q,D]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[C,[U,"Lenovo"],[q,J]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[C,/_/g," "],[U,"Nokia"],[q,D]],[/(pixel c)\b/i],[C,[U,Y],[q,J]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[C,[U,Y],[q,D]],[/droid.+ ([c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[C,[U,w],[q,D]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[C,"Xperia Tablet"],[U,w],[q,J]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[C,[U,"OnePlus"],[q,D]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[C,[U,M],[q,J]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[C,/(.+)/g,"Fire Phone $1"],[U,M],[q,D]],[/(playbook);[-\w\),; ]+(rim)/i],[C,U,[q,J]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[C,[U,L],[q,D]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[C,[U,te],[q,J]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[C,[U,te],[q,D]],[/(nexus 9)/i],[C,[U,"HTC"],[q,J]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic|sony)[-_ ]?([-\w]*)/i],[U,[C,/_/g," "],[q,D]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[C,[U,"Acer"],[q,J]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[C,[U,"Meizu"],[q,D]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[C,[U,"Sharp"],[q,D]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[U,C,[q,D]],[/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[U,C,[q,J]],[/(surface duo)/i],[C,[U,pe],[q,J]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[C,[U,"Fairphone"],[q,D]],[/(u304aa)/i],[C,[U,"AT&T"],[q,D]],[/\bsie-(\w*)/i],[C,[U,"Siemens"],[q,D]],[/\b(rct\w+) b/i],[C,[U,"RCA"],[q,J]],[/\b(venue[\d ]{2,7}) b/i],[C,[U,"Dell"],[q,J]],[/\b(q(?:mv|ta)\w+) b/i],[C,[U,"Verizon"],[q,J]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[C,[U,"Barnes & Noble"],[q,J]],[/\b(tm\d{3}\w+) b/i],[C,[U,"NuVision"],[q,J]],[/\b(k88) b/i],[C,[U,"ZTE"],[q,J]],[/\b(nx\d{3}j) b/i],[C,[U,"ZTE"],[q,D]],[/\b(gen\d{3}) b.+49h/i],[C,[U,"Swiss"],[q,D]],[/\b(zur\d{3}) b/i],[C,[U,"Swiss"],[q,J]],[/\b((zeki)?tb.*\b) b/i],[C,[U,"Zeki"],[q,J]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[U,"Dragon Touch"],C,[q,J]],[/\b(ns-?\w{0,9}) b/i],[C,[U,"Insignia"],[q,J]],[/\b((nxa|next)-?\w{0,9}) b/i],[C,[U,"NextBook"],[q,J]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[U,"Voice"],C,[q,D]],[/\b(lvtel\-)?(v1[12]) b/i],[[U,"LvTel"],C,[q,D]],[/\b(ph-1) /i],[C,[U,"Essential"],[q,D]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[C,[U,"Envizen"],[q,J]],[/\b(trio[-\w\. ]+) b/i],[C,[U,"MachSpeed"],[q,J]],[/\btu_(1491) b/i],[C,[U,"Rotor"],[q,J]],[/(shield[\w ]+) b/i],[C,[U,"Nvidia"],[q,J]],[/(sprint) (\w+)/i],[U,C,[q,D]],[/(kin\.[onetw]{3})/i],[[C,/\./g," "],[U,pe],[q,D]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[C,[U,I],[q,J]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[C,[U,I],[q,D]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[U,C,[q,T]],[/droid.+; (shield) bui/i],[C,[U,"Nvidia"],[q,T]],[/(playstation [345portablevi]+)/i],[C,[U,w],[q,T]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[C,[U,pe],[q,T]],[/smart-tv.+(samsung)/i],[U,[q,ee]],[/hbbtv.+maple;(\d+)/i],[[C,/^/,"SmartTV"],[U,g],[q,ee]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[U,fe],[q,ee]],[/(apple) ?tv/i],[U,[C,K+" TV"],[q,ee]],[/crkey/i],[[C,W+"cast"],[U,Y],[q,ee]],[/droid.+aft(\w)( bui|\))/i],[C,[U,M],[q,ee]],[/\(dtv[\);].+(aquos)/i],[C,[U,"Sharp"],[q,ee]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i],[[U,Pe],[C,Pe],[q,ee]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[q,ee]],[/((pebble))app/i],[U,C,[q,z]],[/droid.+; (glass) \d/i],[C,[U,Y],[q,z]],[/droid.+; (wt63?0{2,3})\)/i],[C,[U,I],[q,z]],[/(quest( 2)?)/i],[C,[U,$],[q,z]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[U,[q,ne]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[C,[q,D]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[C,[q,J]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[q,J]],[/(phone|mobile(?:[;\/]| safari)|pda(?=.+windows ce))/i],[[q,D]],[/(android[-\w\. ]{0,9});.+buil/i],[C,[U,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[F,[A,ie+"HTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[F,[A,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[A,F],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[F,A]],os:[[/microsoft (windows) (vista|xp)/i],[A,F],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[A,[F,_e,We]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[A,"Windows"],[F,_e,We]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[F,/_/g,"."],[A,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[A,"Mac OS"],[F,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86)/i],[F,A],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[A,F],[/\(bb(10);/i],[F,[A,L]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[F,[A,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[F,[A,x+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[F,[A,"webOS"]],[/crkey\/([\d\.]+)/i],[F,[A,W+"cast"]],[/(cros) [\w]+ ([\w\.]+\w)/i],[[A,"Chromium OS"],F],[/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[A,F],[/(sunos) ?([\w\.\d]*)/i],[[A,"Solaris"],F],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[A,F]]},qe=function(ve,Oe){if(typeof ve===E&&(Oe=ve,ve=c),!(this instanceof qe))return new qe(ve,Oe).getResult();var Ee=ve||(typeof d!==_&&d.navigator&&d.navigator.userAgent?d.navigator.userAgent:h),Ae=Oe?Z(ye,Oe):ye;return this.getBrowser=function(){var be={};return be[A]=c,be[F]=c,Te.call(be,Ee,Ae.browser),be.major=ge(be.version),be},this.getCPU=function(){var be={};return be[j]=c,Te.call(be,Ee,Ae.cpu),be},this.getDevice=function(){var be={};return be[U]=c,be[C]=c,be[q]=c,Te.call(be,Ee,Ae.device),be},this.getEngine=function(){var be={};return be[A]=c,be[F]=c,Te.call(be,Ee,Ae.engine),be},this.getOS=function(){var be={};return be[A]=c,be[F]=c,Te.call(be,Ee,Ae.os),be},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return Ee},this.setUA=function(be){return Ee=typeof be===O&&be.length>X?Pe(be,X):be,this},this.setUA(Ee),this};qe.VERSION=l,qe.BROWSER=le([A,F,P]),qe.CPU=le([j]),qe.DEVICE=le([C,U,q,T,D,ee,J,z,ne]),qe.ENGINE=qe.OS=le([A,F]),a.exports&&(s=a.exports=qe),s.UAParser=qe;var Ke=typeof d!==_&&(d.jQuery||d.Zepto);if(Ke&&!Ke.ua){var et=new qe;Ke.ua=et.getResult(),Ke.ua.get=function(){return et.getUA()},Ke.ua.set=function(ve){et.setUA(ve);var Oe=et.getResult();for(var Ee in Oe)Ke.ua[Ee]=Oe[Ee]}}})(typeof window=="object"?window:commonjsGlobal)})(uaParser,uaParser.exports);var version$1={};Object.defineProperty(version$1,"__esModule",{value:!0}),version$1.protocolVersion=version$1.version=void 0,version$1.version="0.15.4",version$1.protocolVersion=5;var __awaiter$b=commonjsGlobal&&commonjsGlobal.__awaiter||function(a,s,d,c){function l(h){return h instanceof d?h:new d(function(p){p(h)})}return new(d||(d=Promise))(function(h,p){function y(O){try{E(c.next(O))}catch(P){p(P)}}function _(O){try{E(c.throw(O))}catch(P){p(P)}}function E(O){O.done?h(O.value):l(O.value).then(y,_)}E((c=c.apply(a,s||[])).next())})},__importDefault$c=commonjsGlobal&&commonjsGlobal.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(utils$f,"__esModule",{value:!0}),utils$f.getClientInfo=utils$f.getIntersectionObserver=utils$f.getResizeObserver=utils$f.isFireFox=utils$f.sleep=utils$f.unpackStreamId=void 0;const ua_parser_js_1=__importDefault$c(uaParser.exports),livekit_models_1$3=livekit_models$1,version_1=version$1,separator="|";function unpackStreamId(a){const s=a.split(separator);return s.length>1?[s[0],a.substr(s[0].length+1)]:[a,""]}utils$f.unpackStreamId=unpackStreamId;function sleep(a){return __awaiter$b(this,void 0,void 0,function*(){return new Promise(s=>setTimeout(s,a))})}utils$f.sleep=sleep;function isFireFox(){return navigator.userAgent.indexOf("Firefox")!==-1}utils$f.isFireFox=isFireFox;function roDispatchCallback(a){for(const s of a)s.target.handleResize(s)}function ioDispatchCallback(a){for(const s of a)s.target.handleVisibilityChanged(s)}let resizeObserver=null;const getResizeObserver=()=>(resizeObserver||(resizeObserver=new ResizeObserver(roDispatchCallback)),resizeObserver);utils$f.getResizeObserver=getResizeObserver;let intersectionObserver=null;const getIntersectionObserver=()=>(intersectionObserver||(intersectionObserver=new IntersectionObserver(ioDispatchCallback)),intersectionObserver);utils$f.getIntersectionObserver=getIntersectionObserver;function getClientInfo(){const a=ua_parser_js_1.default(navigator.userAgent),s=livekit_models_1$3.ClientInfo.fromPartial({sdk:livekit_models_1$3.ClientInfo_SDK.JS,protocol:version_1.protocolVersion,version:version_1.version,os:a.os.name,osVersion:a.os.version,browser:a.browser.name,browserVersion:a.browser.version});let d="";return a.device.vendor&&(d+=a.device.vendor),a.device.model&&(d&&(d+=" "),d+=a.device.model),d&&(s.deviceModel=d),s}utils$f.getClientInfo=getClientInfo,function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.detachTrack=a.attachToElement=a.Track=void 0;const s=events.exports,d=livekit_models$1,c=livekit_rtc,l=events$1,h=utils$f,p=[];class y extends s.EventEmitter{constructor(P,C){super(),this.attachedElements=[],this.isMuted=!1,this.streamState=y.StreamState.Active,this._currentBitrate=0,this.kind=C,this.mediaStreamTrack=P,this.source=y.Source.Unknown}get currentBitrate(){return this._currentBitrate}attach(P){let C="audio";return this.kind===y.Kind.Video&&(C="video"),P||(C==="audio"&&(p.forEach(A=>{A.parentElement===null&&!P&&(P=A)}),P&&p.splice(p.indexOf(P),1)),P||(P=document.createElement(C))),P instanceof HTMLVideoElement&&(P.playsInline=!0,P.autoplay=!0),this.attachedElements.includes(P)||(_(this.mediaStreamTrack,P),this.attachedElements.push(P),P instanceof HTMLAudioElement&&P.play().then(()=>{this.emit(l.TrackEvent.AudioPlaybackStarted)}).catch(A=>{this.emit(l.TrackEvent.AudioPlaybackFailed,A)})),P}detach(P){if(P){E(this.mediaStreamTrack,P);const A=this.attachedElements.indexOf(P);return A>=0&&(this.attachedElements.splice(A,1),this.recycleElement(P)),P}const C=[];return this.attachedElements.forEach(A=>{E(this.mediaStreamTrack,A),C.push(A),this.recycleElement(A)}),this.attachedElements=[],C}stop(){this.mediaStreamTrack.stop()}enable(){this.mediaStreamTrack.enabled=!0}disable(){this.mediaStreamTrack.enabled=!1}recycleElement(P){if(P instanceof HTMLAudioElement){let C=!0;P.pause(),p.forEach(A=>{A.parentElement||(C=!1)}),C&&p.push(P)}}}a.Track=y;function _(O,P){let C;P.srcObject instanceof MediaStream?C=P.srcObject:(C=new MediaStream,P.srcObject=C);let A;O.kind==="audio"?A=C.getAudioTracks():A=C.getVideoTracks(),A.forEach(q=>{C.removeTrack(q)}),C.addTrack(O),h.isFireFox()&&setTimeout(()=>{P.srcObject=C},1)}a.attachToElement=_;function E(O,P){P.srcObject instanceof MediaStream&&(P.srcObject.removeTrack(O),P.srcObject=null)}a.detachTrack=E,function(O){let P;(function(D){D.Audio="audio",D.Video="video",D.Unknown="unknown"})(P=O.Kind||(O.Kind={}));let C;(function(D){D.Camera="camera",D.Microphone="microphone",D.ScreenShare="screen_share",D.ScreenShareAudio="screen_share_audio",D.Unknown="unknown"})(C=O.Source||(O.Source={}));let A;(function(D){D.Active="active",D.Paused="paused",D.Unknown="unknown"})(A=O.StreamState||(O.StreamState={}));function q(D){switch(D){case P.Audio:return d.TrackType.AUDIO;case P.Video:return d.TrackType.VIDEO;default:return d.TrackType.UNRECOGNIZED}}O.kindToProto=q;function U(D){switch(D){case d.TrackType.AUDIO:return P.Audio;case d.TrackType.VIDEO:return P.Video;default:return P.Unknown}}O.kindFromProto=U;function F(D){switch(D){case C.Camera:return d.TrackSource.CAMERA;case C.Microphone:return d.TrackSource.MICROPHONE;case C.ScreenShare:return d.TrackSource.SCREEN_SHARE;case C.ScreenShareAudio:return d.TrackSource.SCREEN_SHARE_AUDIO;default:return d.TrackSource.UNRECOGNIZED}}O.sourceToProto=F;function j(D){switch(D){case d.TrackSource.CAMERA:return C.Camera;case d.TrackSource.MICROPHONE:return C.Microphone;case d.TrackSource.SCREEN_SHARE:return C.ScreenShare;case d.TrackSource.SCREEN_SHARE_AUDIO:return C.ScreenShareAudio;default:return C.Unknown}}O.sourceFromProto=j;function T(D){switch(D){case c.StreamState.ACTIVE:return A.Active;case c.StreamState.PAUSED:return A.Paused;default:return A.Unknown}}O.streamStateFromProto=T}(y=a.Track||(a.Track={}))}(Track);var __awaiter$a=commonjsGlobal&&commonjsGlobal.__awaiter||function(a,s,d,c){function l(h){return h instanceof d?h:new d(function(p){p(h)})}return new(d||(d=Promise))(function(h,p){function y(O){try{E(c.next(O))}catch(P){p(P)}}function _(O){try{E(c.throw(O))}catch(P){p(P)}}function E(O){O.done?h(O.value):l(O.value).then(y,_)}E((c=c.apply(a,s||[])).next())})},__importDefault$b=commonjsGlobal&&commonjsGlobal.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(LocalTrack$1,"__esModule",{value:!0});const logger_1$7=__importDefault$b(logger),DeviceManager_1=__importDefault$b(DeviceManager$1),errors_1$3=errors,events_1$6=events$1,Track_1$8=Track;class LocalTrack extends Track_1$8.Track{constructor(s,d,c){super(s,d),this.handleEnded=()=>{this.emit(events_1$6.TrackEvent.Ended,this)},this.mediaStreamTrack.addEventListener("ended",this.handleEnded),this.constraints=c!=null?c:s.getConstraints()}get id(){return this.mediaStreamTrack.id}get dimensions(){if(this.kind!==Track_1$8.Track.Kind.Video)return;const{width:s,height:d}=this.mediaStreamTrack.getSettings();if(s&&d)return{width:s,height:d}}getDeviceId(){return __awaiter$a(this,void 0,void 0,function*(){if(this.source===Track_1$8.Track.Source.ScreenShare)return;const{deviceId:s,groupId:d}=this.mediaStreamTrack.getSettings(),c=this.kind===Track_1$8.Track.Kind.Audio?"audioinput":"videoinput";return DeviceManager_1.default.getInstance().normalizeDeviceId(c,s,d)})}mute(){return __awaiter$a(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return __awaiter$a(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}restart(s){return __awaiter$a(this,void 0,void 0,function*(){if(!this.sender)throw new errors_1$3.TrackInvalidError("unable to restart an unpublished track");s||(s=this.constraints),logger_1$7.default.debug("restarting track with constraints",s);const d={audio:!1,video:!1};this.kind===Track_1$8.Track.Kind.Video?d.video=s:d.audio=s,this.attachedElements.forEach(h=>{Track_1$8.detachTrack(this.mediaStreamTrack,h)}),this.mediaStreamTrack.removeEventListener("ended",this.handleEnded),this.mediaStreamTrack.stop();const l=(yield navigator.mediaDevices.getUserMedia(d)).getTracks()[0];return l.addEventListener("ended",this.handleEnded),logger_1$7.default.debug("re-acquired MediaStreamTrack"),yield this.sender.replaceTrack(l),this.mediaStreamTrack=l,this.attachedElements.forEach(h=>{Track_1$8.attachToElement(l,h)}),this.constraints=s,this})}setTrackMuted(s){this.isMuted!==s&&(this.isMuted=s,this.mediaStreamTrack.enabled=!s,this.emit(s?events_1$6.TrackEvent.Muted:events_1$6.TrackEvent.Unmuted,this))}}LocalTrack$1.default=LocalTrack;var utils$e={};Object.defineProperty(utils$e,"__esModule",{value:!0}),utils$e.constraintsForOptions=utils$e.mergeDefaultOptions=void 0;function mergeDefaultOptions(a,s,d){const c=Object.assign({},a);return c.audio===!0&&(c.audio={}),c.video===!0&&(c.video={}),c.audio&&mergeObjectWithoutOverwriting(c.audio,s),c.video&&mergeObjectWithoutOverwriting(c.video,d),c}utils$e.mergeDefaultOptions=mergeDefaultOptions;function mergeObjectWithoutOverwriting(a,s){return Object.keys(s).forEach(d=>{a[d]===void 0&&(a[d]=s[d])}),a}function constraintsForOptions(a){const s={};if(a.video)if(typeof a.video=="object"){const d={},c=d,l=a.video;Object.keys(l).forEach(h=>{switch(h){case"resolution":mergeObjectWithoutOverwriting(c,l.resolution);break;default:c[h]=l[h]}}),s.video=d}else s.video=a.video;else s.video=!1;return a.audio?typeof a.audio=="object"?s.audio=a.audio:s.audio=!0:s.audio=!1,s}utils$e.constraintsForOptions=constraintsForOptions;var __awaiter$9=commonjsGlobal&&commonjsGlobal.__awaiter||function(a,s,d,c){function l(h){return h instanceof d?h:new d(function(p){p(h)})}return new(d||(d=Promise))(function(h,p){function y(O){try{E(c.next(O))}catch(P){p(P)}}function _(O){try{E(c.throw(O))}catch(P){p(P)}}function E(O){O.done?h(O.value):l(O.value).then(y,_)}E((c=c.apply(a,s||[])).next())})},__importDefault$a=commonjsGlobal&&commonjsGlobal.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(LocalAudioTrack$1,"__esModule",{value:!0});const logger_1$6=__importDefault$a(logger),stats_1$4=stats,LocalTrack_1$1=__importDefault$a(LocalTrack$1),Track_1$7=Track,utils_1$5=utils$e;class LocalAudioTrack extends LocalTrack_1$1.default{constructor(s,d){super(s,Track_1$7.Track.Kind.Audio,d),this.stopOnMute=!1,this.monitorSender=()=>__awaiter$9(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}const c=yield this.getSenderStats();c&&this.prevStats&&(this._currentBitrate=stats_1$4.computeBitrate(c,this.prevStats)),this.prevStats=c,setTimeout(()=>{this.monitorSender()},stats_1$4.monitorFrequency)})}setDeviceId(s){return __awaiter$9(this,void 0,void 0,function*(){this.constraints.deviceId!==s&&(this.constraints.deviceId=s,this.isMuted||(yield this.restartTrack()))})}mute(){const s=Object.create(null,{mute:{get:()=>super.mute}});return __awaiter$9(this,void 0,void 0,function*(){return this.source===Track_1$7.Track.Source.Microphone&&this.stopOnMute&&(logger_1$6.default.debug("stopping mic track"),this.mediaStreamTrack.stop()),yield s.mute.call(this),this})}unmute(){const s=Object.create(null,{unmute:{get:()=>super.unmute}});return __awaiter$9(this,void 0,void 0,function*(){return this.source===Track_1$7.Track.Source.Microphone&&this.stopOnMute&&(logger_1$6.default.debug("reacquiring mic track"),yield this.restartTrack()),yield s.unmute.call(this),this})}restartTrack(s){return __awaiter$9(this,void 0,void 0,function*(){let d;if(s){const c=utils_1$5.constraintsForOptions({audio:s});typeof c.audio!="boolean"&&(d=c.audio)}yield this.restart(d)})}startMonitor(){setTimeout(()=>{this.monitorSender()},stats_1$4.monitorFrequency)}getSenderStats(){return __awaiter$9(this,void 0,void 0,function*(){if(!this.sender)return;const s=yield this.sender.getStats();let d;return s.forEach(c=>{c.type==="outbound-rtp"&&(d={type:"audio",streamId:c.id,packetsSent:c.packetsSent,packetsLost:c.packetsLost,bytesSent:c.bytesSent,timestamp:c.timestamp,roundTripTime:c.roundTripTime,jitter:c.jitter})}),d})}}LocalAudioTrack$1.default=LocalAudioTrack;var LocalTrackPublication$1={},TrackPublication={},LocalVideoTrack$1={},__awaiter$8=commonjsGlobal&&commonjsGlobal.__awaiter||function(a,s,d,c){function l(h){return h instanceof d?h:new d(function(p){p(h)})}return new(d||(d=Promise))(function(h,p){function y(O){try{E(c.next(O))}catch(P){p(P)}}function _(O){try{E(c.throw(O))}catch(P){p(P)}}function E(O){O.done?h(O.value):l(O.value).then(y,_)}E((c=c.apply(a,s||[])).next())})},__importDefault$9=commonjsGlobal&&commonjsGlobal.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(LocalVideoTrack$1,"__esModule",{value:!0}),LocalVideoTrack$1.videoLayersFromEncodings=LocalVideoTrack$1.videoQualityForRid=void 0;const logger_1$5=__importDefault$9(logger),livekit_models_1$2=livekit_models$1,stats_1$3=stats,utils_1$4=utils$f,LocalTrack_1=__importDefault$9(LocalTrack$1),Track_1$6=Track,utils_2=utils$e,QUALITY_UPGRADE_DELAY=60*1e3,QUALITY_DOWNGRADE_DELAY=5*1e3,ridOrder=["q","h","f"];class LocalVideoTrack extends LocalTrack_1.default{constructor(s,d){super(s,Track_1$6.Track.Kind.Video,d),this.monitorSender=c=>__awaiter$8(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}const l=yield this.getSenderStats(),h=new Map(l.map(p=>[p.rid,p]));if(!c&&this.prevStats&&this.isSimulcast&&this.checkAndUpdateSimulcast(h),this.prevStats){let p=0;h.forEach((y,_)=>{var E;const O=(E=this.prevStats)===null||E===void 0?void 0:E.get(_);p+=stats_1$3.computeBitrate(y,O)}),this._currentBitrate=p}this.prevStats=h,setTimeout(()=>{this.monitorSender(c)},stats_1$3.monitorFrequency)})}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(s,d){var c;this.signalClient=s;const l=(c=this.sender)===null||c===void 0?void 0:c.getParameters();l&&(this.encodings=l.encodings),setTimeout(()=>{this.monitorSender(d)},stats_1$3.monitorFrequency)}stop(){this.sender=void 0,this.mediaStreamTrack.getConstraints(),super.stop()}mute(){const s=Object.create(null,{mute:{get:()=>super.mute}});return __awaiter$8(this,void 0,void 0,function*(){return this.source===Track_1$6.Track.Source.Camera&&(logger_1$5.default.debug("stopping camera track"),this.mediaStreamTrack.stop()),yield s.mute.call(this),this})}unmute(){const s=Object.create(null,{unmute:{get:()=>super.unmute}});return __awaiter$8(this,void 0,void 0,function*(){return this.source===Track_1$6.Track.Source.Camera&&(logger_1$5.default.debug("reacquiring camera track"),yield this.restartTrack()),yield s.unmute.call(this),this})}getSenderStats(){return __awaiter$8(this,void 0,void 0,function*(){if(!this.sender)return[];const s=[],d=yield this.sender.getStats();return d.forEach(c=>{var l;if(c.type==="outbound-rtp"){const h={type:"video",streamId:c.id,frameHeight:c.frameHeight,frameWidth:c.frameWidth,firCount:c.firCount,pliCount:c.pliCount,nackCount:c.nackCount,packetsSent:c.packetsSent,bytesSent:c.bytesSent,framesSent:c.framesSent,timestamp:c.timestamp,rid:(l=c.rid)!==null&&l!==void 0?l:"",retransmittedPacketsSent:c.retransmittedPacketsSent,qualityLimitationReason:c.qualityLimitationReason,qualityLimitationResolutionChanges:c.qualityLimitationResolutionChanges},p=d.get(c.remoteId);p&&(h.jitter=p.jitter,h.packetsLost=p.packetsLost,h.roundTripTime=p.roundTripTime),s.push(h)}}),s})}setPublishingQuality(s){const d=[];for(let c=livekit_models_1$2.VideoQuality.LOW;c<=livekit_models_1$2.VideoQuality.HIGH;c+=1)d.push({quality:c,enabled:c<=s});logger_1$5.default.debug("setting publishing quality. max quality",s),this.setPublishingLayers(d)}setDeviceId(s){return __awaiter$8(this,void 0,void 0,function*(){this.constraints.deviceId!==s&&(this.constraints.deviceId=s,this.isMuted||(yield this.restartTrack()))})}restartTrack(s){return __awaiter$8(this,void 0,void 0,function*(){let d;if(s){const c=utils_2.constraintsForOptions({video:s});typeof c.video!="boolean"&&(d=c.video)}yield this.restart(d)})}setPublishingLayers(s){return __awaiter$8(this,void 0,void 0,function*(){if(logger_1$5.default.debug("setting publishing layers",s),!this.sender||!this.encodings)return;const d=this.sender.getParameters(),{encodings:c}=d;if(!c)return;if(c.length!==this.encodings.length){logger_1$5.default.warn("cannot set publishing layers, encodings mismatch");return}this.activeQualities=s;let l=!1;c.forEach((h,p)=>{var y;let _=(y=h.rid)!==null&&y!==void 0?y:"";_===""&&(_="q");const E=videoQualityForRid(_),O=s.find(P=>P.quality===E);!O||h.active!==O.enabled&&(l=!0,h.active=O.enabled,logger_1$5.default.debug(`setting layer ${O.quality} to ${h.active?"enabled":"disabled"}`),utils_1$4.isFireFox()&&(O.enabled?(h.scaleResolutionDownBy=this.encodings[p].scaleResolutionDownBy,h.maxBitrate=this.encodings[p].maxBitrate,h.maxFrameRate=this.encodings[p].maxFrameRate):(h.scaleResolutionDownBy=4,h.maxBitrate=10,h.maxFrameRate=2)))}),l&&(d.encodings=c,yield this.sender.setParameters(d))})}checkAndUpdateSimulcast(s){var d,c;if(!this.sender||this.isMuted||!this.encodings)return;let l;const{encodings:h}=this.sender.getParameters();if(h.forEach(O=>{!O.active||(l===void 0||l.rid&&O.rid&&ridOrder.indexOf(l.rid)<ridOrder.indexOf(O.rid)||l.maxBitrate!==void 0&&O.maxBitrate!==void 0&&l.maxBitrate<O.maxBitrate)&&(l=O)}),!l)return;const p=(d=l.rid)!==null&&d!==void 0?d:"",y=s.get(p),_=(c=this.prevStats)===null||c===void 0?void 0:c.get(p);if(!y||!_)return;const E=videoQualityForRid(p);if(y.qualityLimitationResolutionChanges-_.qualityLimitationResolutionChanges>0&&(this.lastQualityChange=new Date().getTime()),y.framesSent-_.framesSent>0){if(E===livekit_models_1$2.VideoQuality.HIGH||!this.lastQualityChange)return;const O=E+1;if(new Date().getTime()-this.lastQualityChange<QUALITY_UPGRADE_DELAY||this.activeQualities&&this.activeQualities.some(C=>C.quality===O&&!C.enabled))return;let P=livekit_models_1$2.VideoQuality.LOW;if(h.forEach(C=>{var A;const q=videoQualityForRid((A=C.rid)!==null&&A!==void 0?A:"");q>P&&(P=q)}),O>P)return;logger_1$5.default.debug("upgrading video quality to",O),this.setPublishingQuality(O);return}y.framesSent!==0&&(this.lastExplicitQualityChange&&new Date().getTime()-this.lastExplicitQualityChange<QUALITY_DOWNGRADE_DELAY||E!==livekit_models_1$2.VideoQuality.UNRECOGNIZED&&E!==livekit_models_1$2.VideoQuality.LOW&&(logger_1$5.default.debug("downgrading video quality to",E-1),this.setPublishingQuality(E-1)))}}LocalVideoTrack$1.default=LocalVideoTrack;function videoQualityForRid(a){switch(a){case"f":return livekit_models_1$2.VideoQuality.HIGH;case"h":return livekit_models_1$2.VideoQuality.MEDIUM;case"q":return livekit_models_1$2.VideoQuality.LOW;default:return livekit_models_1$2.VideoQuality.UNRECOGNIZED}}LocalVideoTrack$1.videoQualityForRid=videoQualityForRid;function videoLayersFromEncodings(a,s,d){return d?d.map(c=>{var l,h,p;const y=(l=c.scaleResolutionDownBy)!==null&&l!==void 0?l:1;let _=videoQualityForRid((h=c.rid)!==null&&h!==void 0?h:"");return _===livekit_models_1$2.VideoQuality.UNRECOGNIZED&&d.length===1&&(_=livekit_models_1$2.VideoQuality.HIGH),{quality:_,width:a/y,height:s/y,bitrate:(p=c.maxBitrate)!==null&&p!==void 0?p:0,ssrc:0}}):[{quality:livekit_models_1$2.VideoQuality.HIGH,width:a,height:s,bitrate:0,ssrc:0}]}LocalVideoTrack$1.videoLayersFromEncodings=videoLayersFromEncodings;var RemoteAudioTrack$1={},RemoteTrack$1={};Object.defineProperty(RemoteTrack$1,"__esModule",{value:!0});const events_1$5=events$1,stats_1$2=stats,Track_1$5=Track;class RemoteTrack extends Track_1$5.Track{constructor(s,d,c,l){super(s,c),this.sid=d,this.receiver=l}setMuted(s){this.isMuted!==s&&(this.isMuted=s,this.emit(s?events_1$5.TrackEvent.Muted:events_1$5.TrackEvent.Unmuted,this))}setMediaStream(s){s.onremovetrack=()=>{this.receiver=void 0,this._currentBitrate=0,this.emit(events_1$5.TrackEvent.Ended,this)}}start(){this.startMonitor(),super.enable()}stop(){super.disable()}startMonitor(){setTimeout(()=>{this.monitorReceiver()},stats_1$2.monitorFrequency)}}RemoteTrack$1.default=RemoteTrack;var __awaiter$7=commonjsGlobal&&commonjsGlobal.__awaiter||function(a,s,d,c){function l(h){return h instanceof d?h:new d(function(p){p(h)})}return new(d||(d=Promise))(function(h,p){function y(O){try{E(c.next(O))}catch(P){p(P)}}function _(O){try{E(c.throw(O))}catch(P){p(P)}}function E(O){O.done?h(O.value):l(O.value).then(y,_)}E((c=c.apply(a,s||[])).next())})},__importDefault$8=commonjsGlobal&&commonjsGlobal.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(RemoteAudioTrack$1,"__esModule",{value:!0});const stats_1$1=stats,RemoteTrack_1$1=__importDefault$8(RemoteTrack$1),Track_1$4=Track;class RemoteAudioTrack extends RemoteTrack_1$1.default{constructor(s,d,c){super(s,d,Track_1$4.Track.Kind.Audio,c),this.monitorReceiver=()=>__awaiter$7(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const l=yield this.getReceiverStats();l&&this.prevStats&&this.receiver&&(this._currentBitrate=stats_1$1.computeBitrate(l,this.prevStats)),this.prevStats=l,setTimeout(()=>{this.monitorReceiver()},stats_1$1.monitorFrequency)})}getReceiverStats(){return __awaiter$7(this,void 0,void 0,function*(){if(!this.receiver)return;const s=yield this.receiver.getStats();let d;return s.forEach(c=>{c.type==="inbound-rtp"&&(d={type:"audio",timestamp:c.timestamp,jitter:c.jitter,bytesReceived:c.bytesReceived,concealedSamples:c.concealedSamples,concealmentEvents:c.concealmentEvents,silentConcealedSamples:c.silentConcealedSamples,silentConcealmentEvents:c.silentConcealmentEvents,totalAudioEnergy:c.totalAudioEnergy,totalSamplesDuration:c.totalSamplesDuration})}),d})}}RemoteAudioTrack$1.default=RemoteAudioTrack;var RemoteVideoTrack$1={};function r(a,s,d){var c,l,h;s===void 0&&(s=50),d===void 0&&(d={});var p=(c=d.isImmediate)!=null&&c,y=(l=d.callback)!=null&&l,_=d.maxWait,E=Date.now(),O=[];function P(){if(_!==void 0){var A=Date.now()-E;if(A+s>=_)return _-A}return s}var C=function(){var A=[].slice.call(arguments),q=this;return new Promise(function(U,F){var j=p&&h===void 0;if(h!==void 0&&clearTimeout(h),h=setTimeout(function(){if(h=void 0,E=Date.now(),!p){var D=a.apply(q,A);y&&y(D),O.forEach(function(J){return(0,J.resolve)(D)}),O=[]}},P()),j){var T=a.apply(q,A);return y&&y(T),U(T)}O.push({resolve:U,reject:F})})};return C.cancel=function(A){h!==void 0&&clearTimeout(h),O.forEach(function(q){return(0,q.reject)(A)}),O=[]},C}var index_esm=Object.freeze(Object.defineProperty({__proto__:null,debounce:r},Symbol.toStringTag,{value:"Module"})),require$$0$1=getAugmentedNamespace(index_esm),__awaiter$6=commonjsGlobal&&commonjsGlobal.__awaiter||function(a,s,d,c){function l(h){return h instanceof d?h:new d(function(p){p(h)})}return new(d||(d=Promise))(function(h,p){function y(O){try{E(c.next(O))}catch(P){p(P)}}function _(O){try{E(c.throw(O))}catch(P){p(P)}}function E(O){O.done?h(O.value):l(O.value).then(y,_)}E((c=c.apply(a,s||[])).next())})},__importDefault$7=commonjsGlobal&&commonjsGlobal.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(RemoteVideoTrack$1,"__esModule",{value:!0});const ts_debounce_1$1=require$$0$1,events_1$4=events$1,stats_1=stats,utils_1$3=utils$f,RemoteTrack_1=__importDefault$7(RemoteTrack$1),Track_1$3=Track,REACTION_DELAY=100;class RemoteVideoTrack extends RemoteTrack_1.default{constructor(s,d,c,l){super(s,d,Track_1$3.Track.Kind.Video,c),this.elementInfos=[],this.monitorReceiver=()=>__awaiter$6(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const h=yield this.getReceiverStats();h&&this.prevStats&&this.receiver&&(this._currentBitrate=stats_1.computeBitrate(h,this.prevStats)),this.prevStats=h,setTimeout(()=>{this.monitorReceiver()},stats_1.monitorFrequency)}),this.handleVisibilityChanged=h=>{const{target:p,isIntersecting:y}=h,_=this.elementInfos.find(E=>E.element===p);_&&(_.visible=y,_.visibilityChangedAt=Date.now()),this.updateVisibility()},this.debouncedHandleResize=ts_debounce_1$1.debounce(()=>{this.updateDimensions()},REACTION_DELAY),this.adaptiveStream=l}get isAdaptiveStream(){var s;return(s=this.adaptiveStream)!==null&&s!==void 0?s:!1}setMuted(s){super.setMuted(s),this.attachedElements.forEach(d=>{s?Track_1$3.detachTrack(this.mediaStreamTrack,d):Track_1$3.attachToElement(this.mediaStreamTrack,d)})}attach(s){return s?super.attach(s):s=super.attach(),this.adaptiveStream&&(this.elementInfos.push({element:s,visible:!0}),s.handleResize=this.debouncedHandleResize,s.handleVisibilityChanged=this.handleVisibilityChanged,utils_1$3.getIntersectionObserver().observe(s),utils_1$3.getResizeObserver().observe(s)),s}detach(s){let d=[];if(s)return this.stopObservingElement(s),super.detach(s);d=super.detach();for(const c of d)this.stopObservingElement(c);return d}getReceiverStats(){return __awaiter$6(this,void 0,void 0,function*(){if(!this.receiver)return;const s=yield this.receiver.getStats();let d;return s.forEach(c=>{c.type==="inbound-rtp"&&(d={type:"video",framesDecoded:c.framesDecoded,framesDropped:c.framesDropped,framesReceived:c.framesReceived,packetsReceived:c.packetsReceived,packetsLost:c.packetsLost,frameWidth:c.frameWidth,frameHeight:c.frameHeight,pliCount:c.pliCount,firCount:c.firCount,nackCount:c.nackCount,jitter:c.jitter,timestamp:c.timestamp,bytesReceived:c.bytesReceived})}),d})}stopObservingElement(s){var d,c;(d=utils_1$3.getIntersectionObserver())===null||d===void 0||d.unobserve(s),(c=utils_1$3.getResizeObserver())===null||c===void 0||c.unobserve(s),this.elementInfos=this.elementInfos.filter(l=>l.element!==s)}updateVisibility(){const s=this.elementInfos.reduce((c,l)=>Math.max(c,l.visibilityChangedAt||0),0),d=this.elementInfos.some(c=>c.visible);if(this.lastVisible!==d){if(!d&&Date.now()-s<REACTION_DELAY){setTimeout(()=>{this.updateVisibility()},Date.now()-s);return}this.lastVisible=d,this.emit(events_1$4.TrackEvent.VisibilityChanged,d,this)}}updateDimensions(){var s,d;let c=0,l=0;for(const h of this.elementInfos)h.visible&&h.element.clientWidth+h.element.clientHeight>c+l&&(c=h.element.clientWidth,l=h.element.clientHeight);((s=this.lastDimensions)===null||s===void 0?void 0:s.width)===c&&((d=this.lastDimensions)===null||d===void 0?void 0:d.height)===l||(this.lastDimensions={width:c,height:l},this.emit(events_1$4.TrackEvent.VideoDimensionsChanged,this.lastDimensions,this))}}RemoteVideoTrack$1.default=RemoteVideoTrack,function(a){var s=commonjsGlobal&&commonjsGlobal.__importDefault||function(O){return O&&O.__esModule?O:{default:O}};Object.defineProperty(a,"__esModule",{value:!0}),a.TrackPublication=void 0;const d=events.exports,c=events$1,l=s(LocalAudioTrack$1),h=s(LocalVideoTrack$1),p=s(RemoteAudioTrack$1),y=s(RemoteVideoTrack$1),_=Track;class E extends d.EventEmitter{constructor(P,C,A){super(),this.metadataMuted=!1,this.handleMuted=()=>{this.emit(c.TrackEvent.Muted)},this.handleUnmuted=()=>{this.emit(c.TrackEvent.Unmuted)},this.kind=P,this.trackSid=C,this.trackName=A,this.source=_.Track.Source.Unknown}setTrack(P){this.track&&(this.track.off(c.TrackEvent.Muted,this.handleMuted),this.track.off(c.TrackEvent.Unmuted,this.handleUnmuted)),this.track=P,P&&(P.on(c.TrackEvent.Muted,this.handleMuted),P.on(c.TrackEvent.Unmuted,this.handleUnmuted))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return this.track!==void 0}get audioTrack(){if(this.track instanceof l.default||this.track instanceof p.default)return this.track}get videoTrack(){if(this.track instanceof h.default||this.track instanceof y.default)return this.track}updateInfo(P){this.trackSid=P.sid,this.trackName=P.name,this.source=_.Track.sourceFromProto(P.source),this.mimeType=P.mimeType,this.kind===_.Track.Kind.Video&&P.width>0&&(this.dimensions={width:P.width,height:P.height},this.simulcasted=P.simulcast),this.trackInfo=P}}a.TrackPublication=E,function(O){(function(P){P.Subscribed="subscribed",P.NotAllowed="not_allowed",P.Unsubscribed="unsubscribed"})(O.SubscriptionStatus||(O.SubscriptionStatus={}))}(E=a.TrackPublication||(a.TrackPublication={}))}(TrackPublication);var __awaiter$5=commonjsGlobal&&commonjsGlobal.__awaiter||function(a,s,d,c){function l(h){return h instanceof d?h:new d(function(p){p(h)})}return new(d||(d=Promise))(function(h,p){function y(O){try{E(c.next(O))}catch(P){p(P)}}function _(O){try{E(c.throw(O))}catch(P){p(P)}}function E(O){O.done?h(O.value):l(O.value).then(y,_)}E((c=c.apply(a,s||[])).next())})};Object.defineProperty(LocalTrackPublication$1,"__esModule",{value:!0});const events_1$3=events$1,TrackPublication_1$1=TrackPublication;class LocalTrackPublication extends TrackPublication_1$1.TrackPublication{constructor(s,d,c){super(s,d.sid,d.name),this.handleTrackEnded=l=>{this.emit(events_1$3.TrackEvent.Ended,l)},this.updateInfo(d),this.setTrack(c)}setTrack(s){this.track&&this.track.off(events_1$3.TrackEvent.Ended,this.handleTrackEnded),super.setTrack(s),s&&s.on(events_1$3.TrackEvent.Ended,this.handleTrackEnded)}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}mute(){var s;return __awaiter$5(this,void 0,void 0,function*(){return(s=this.track)===null||s===void 0?void 0:s.mute()})}unmute(){var s;return __awaiter$5(this,void 0,void 0,function*(){return(s=this.track)===null||s===void 0?void 0:s.unmute()})}}LocalTrackPublication$1.default=LocalTrackPublication;var options$1={};(function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.ScreenSharePresets=a.VideoPresets43=a.VideoPresets=a.AudioPresets=a.VideoPreset=void 0;class s{constructor(c,l,h,p){this.width=c,this.height=l,this.encoding={maxBitrate:h,maxFramerate:p}}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.width/this.height}}}a.VideoPreset=s,function(d){d.telephone={maxBitrate:12e3},d.speech={maxBitrate:2e4},d.music={maxBitrate:32e3}}(a.AudioPresets||(a.AudioPresets={})),a.VideoPresets={qvga:new s(320,180,12e4,10),vga:new s(640,360,3e5,20),qhd:new s(960,540,6e5,25),hd:new s(1280,720,2e6,30),fhd:new s(1920,1080,3e6,30)},a.VideoPresets43={qvga:new s(240,180,9e4,10),vga:new s(480,360,225e3,20),qhd:new s(720,540,45e4,25),hd:new s(960,720,15e5,30),fhd:new s(1440,1080,28e5,30)},a.ScreenSharePresets={vga:new s(640,360,2e5,3),hd_8:new s(1280,720,4e5,5),hd_15:new s(1280,720,1e6,15),fhd_15:new s(1920,1080,15e5,15),fhd_30:new s(1920,1080,3e6,30)}})(options$1);var Participant={};(function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.ConnectionQuality=void 0;const s=events.exports,d=livekit_models$1,c=events$1,l=Track;var h;(function(_){_.Excellent="excellent",_.Good="good",_.Poor="poor",_.Unknown="unknown"})(h=a.ConnectionQuality||(a.ConnectionQuality={}));function p(_){switch(_){case d.ConnectionQuality.EXCELLENT:return h.Excellent;case d.ConnectionQuality.GOOD:return h.Good;case d.ConnectionQuality.POOR:return h.Poor;default:return h.Unknown}}class y extends s.EventEmitter{constructor(E,O){super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=h.Unknown,this.sid=E,this.identity=O,this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map}getTracks(){return Array.from(this.tracks.values())}getTrack(E){if(E!==l.Track.Source.Unknown){for(const[,O]of this.tracks)if(O.source===E||O.source===l.Track.Source.Unknown&&(E===l.Track.Source.Microphone&&O.kind===l.Track.Kind.Audio&&O.trackName!=="screen"||E===l.Track.Source.Camera&&O.kind===l.Track.Kind.Video&&O.trackName!=="screen"||E===l.Track.Source.ScreenShare&&O.kind===l.Track.Kind.Video&&O.trackName==="screen"||E===l.Track.Source.ScreenShareAudio&&O.kind===l.Track.Kind.Audio&&O.trackName==="screen"))return O}}getTrackByName(E){for(const[,O]of this.tracks)if(O.trackName===E)return O}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var E;const O=this.getTrack(l.Track.Source.Camera);return!(!((E=O==null?void 0:O.isMuted)!==null&&E!==void 0)||E)}get isMicrophoneEnabled(){var E;const O=this.getTrack(l.Track.Source.Microphone);return!(!((E=O==null?void 0:O.isMuted)!==null&&E!==void 0)||E)}get isScreenShareEnabled(){return!!this.getTrack(l.Track.Source.ScreenShare)}get joinedAt(){return this.participantInfo?new Date(this.participantInfo.joinedAt*1e3):new Date}updateInfo(E){this.identity=E.identity,this.sid=E.sid,this.name=E.name,this.setMetadata(E.metadata),this.participantInfo=E}setMetadata(E){const O=!this.participantInfo||this.participantInfo.metadata!==E,P=this.metadata;this.metadata=E,O&&(this.emit(c.ParticipantEvent.MetadataChanged,P,this),this.emit(c.ParticipantEvent.ParticipantMetadataChanged,P,this))}setIsSpeaking(E){E!==this.isSpeaking&&(this.isSpeaking=E,E&&(this.lastSpokeAt=new Date),this.emit(c.ParticipantEvent.IsSpeakingChanged,E))}setConnectionQuality(E){const O=this._connectionQuality;this._connectionQuality=p(E),O!==this._connectionQuality&&this.emit(c.ParticipantEvent.ConnectionQualityChanged,this._connectionQuality)}addTrackPublication(E){E.on(c.TrackEvent.Muted,()=>{this.emit(c.ParticipantEvent.TrackMuted,E)}),E.on(c.TrackEvent.Unmuted,()=>{this.emit(c.ParticipantEvent.TrackUnmuted,E)});const O=E;switch(O.track&&(O.track.sid=E.trackSid),this.tracks.set(E.trackSid,E),E.kind){case l.Track.Kind.Audio:this.audioTracks.set(E.trackSid,E);break;case l.Track.Kind.Video:this.videoTracks.set(E.trackSid,E);break}}}a.default=y})(Participant);var ParticipantTrackPermission={};Object.defineProperty(ParticipantTrackPermission,"__esModule",{value:!0}),ParticipantTrackPermission.trackPermissionToProto=void 0;function trackPermissionToProto(a){var s;if(!a.participantSid)throw new Error("Invalid track permission, missing participantSid");return{participantSid:a.participantSid,allTracks:(s=a.allowAll)!==null&&s!==void 0?s:!1,trackSids:a.allowedTrackSids||[]}}ParticipantTrackPermission.trackPermissionToProto=trackPermissionToProto;var publishUtils={};(function(a){var s=commonjsGlobal&&commonjsGlobal.__importDefault||function(A){return A&&A.__esModule?A:{default:A}};Object.defineProperty(a,"__esModule",{value:!0}),a.presetsForResolution=a.determineAppropriateEncoding=a.computeVideoEncodings=a.presetsScreenShare=a.presets43=a.presets169=a.mediaTrackToLocalTrack=void 0;const d=s(logger),c=errors,l=s(LocalAudioTrack$1),h=s(LocalVideoTrack$1),p=options$1;function y(A,q){switch(A.kind){case"audio":return new l.default(A,q);case"video":return new h.default(A,q);default:throw new c.TrackInvalidError(`unsupported track type: ${A.kind}`)}}a.mediaTrackToLocalTrack=y,a.presets169=[p.VideoPresets.qvga,p.VideoPresets.vga,p.VideoPresets.qhd,p.VideoPresets.hd,p.VideoPresets.fhd],a.presets43=[p.VideoPresets43.qvga,p.VideoPresets43.vga,p.VideoPresets43.qhd,p.VideoPresets43.hd,p.VideoPresets43.fhd],a.presetsScreenShare=[p.ScreenSharePresets.vga,p.ScreenSharePresets.hd_8,p.ScreenSharePresets.hd_15,p.ScreenSharePresets.fhd_15,p.ScreenSharePresets.fhd_30];const _=["q","h","f"];function E(A,q,U,F){let j=F==null?void 0:F.videoEncoding;A&&(j=F==null?void 0:F.screenShareEncoding);const T=!A&&(F==null?void 0:F.simulcast);if(!j&&!T||!q||!U)return[{}];if(j||(j=O(A,q,U),d.default.debug("using video encoding",j)),!T)return[j];const D=P(A,q,U);let J;const ee=D[0];D.length>1&&([,J]=D);const z=new p.VideoPreset(q,U,j.maxBitrate,j.maxFramerate),ne=Math.max(q,U);return ne>=960&&J?C(q,U,[ee,J,z]):ne>=500?C(q,U,[ee,z]):C(q,U,[z])}a.computeVideoEncodings=E;function O(A,q,U){const F=P(A,q,U);let{encoding:j}=F[0];const T=Math.max(q,U);for(let D=0;D<F.length;D+=1){const J=F[D];if(j=J.encoding,J.width>=T)break}return j}a.determineAppropriateEncoding=O;function P(A,q,U){if(A)return a.presetsScreenShare;const F=q>U?q/U:U/q;return Math.abs(F-16/9)<Math.abs(F-4/3)?a.presets169:a.presets43}a.presetsForResolution=P;function C(A,q,U){const F=[];return U.forEach((j,T)=>{if(T>=_.length)return;const D=Math.min(A,q),J=_[T];F.push({rid:J,scaleResolutionDownBy:D/Math.min(j.width,j.height),maxBitrate:j.encoding.maxBitrate,maxFramerate:j.encoding.maxFramerate})}),F}})(publishUtils);var RemoteParticipant$1={},RemoteTrackPublication$1={},__importDefault$6=commonjsGlobal&&commonjsGlobal.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(RemoteTrackPublication$1,"__esModule",{value:!0});const logger_1$4=__importDefault$6(logger),livekit_models_1$1=livekit_models$1,livekit_rtc_1$2=livekit_rtc,events_1$2=events$1,RemoteVideoTrack_1$1=__importDefault$6(RemoteVideoTrack$1),TrackPublication_1=TrackPublication;class RemoteTrackPublication extends TrackPublication_1.TrackPublication{constructor(){super(...arguments),this._allowed=!0,this.disabled=!1,this.currentVideoQuality=livekit_models_1$1.VideoQuality.HIGH,this.handleEnded=s=>{this.emit(events_1$2.TrackEvent.Ended,s)},this.handleVisibilityChange=s=>{logger_1$4.default.debug("adaptivestream video visibility",this.trackSid,`visible=${s}`),this.disabled=!s,this.emitTrackUpdate()},this.handleVideoDimensionsChange=s=>{logger_1$4.default.debug("adaptivestream video dimensions",this.trackSid,`${s.width}x${s.height}`),this.videoDimensions=s,this.emitTrackUpdate()}}setSubscribed(s){this.subscribed=s;const d={trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[]};this.emit(events_1$2.TrackEvent.UpdateSubscription,d)}get subscriptionStatus(){return this.subscribed===!1||!super.isSubscribed?TrackPublication_1.TrackPublication.SubscriptionStatus.Unsubscribed:this._allowed?TrackPublication_1.TrackPublication.SubscriptionStatus.Subscribed:TrackPublication_1.TrackPublication.SubscriptionStatus.NotAllowed}get isSubscribed(){return this.subscribed===!1||!this._allowed?!1:super.isSubscribed}get isEnabled(){return!this.disabled}setEnabled(s){!this.isManualOperationAllowed()||this.disabled===!s||(this.disabled=!s,this.emitTrackUpdate())}setVideoQuality(s){!this.isManualOperationAllowed()||this.currentVideoQuality===s||(this.currentVideoQuality=s,this.videoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(s){var d,c;!this.isManualOperationAllowed()||((d=this.videoDimensions)===null||d===void 0?void 0:d.width)===s.width&&((c=this.videoDimensions)===null||c===void 0?void 0:c.height)===s.height||(this.track instanceof RemoteVideoTrack_1$1.default&&(this.videoDimensions=s),this.currentVideoQuality=void 0,this.emitTrackUpdate())}get videoQuality(){return this.currentVideoQuality}setTrack(s){this.track&&(this.track.off(events_1$2.TrackEvent.VideoDimensionsChanged,this.handleVideoDimensionsChange),this.track.off(events_1$2.TrackEvent.VisibilityChanged,this.handleVisibilityChange),this.track.off(events_1$2.TrackEvent.Ended,this.handleEnded)),super.setTrack(s),s&&(s.sid=this.trackSid,s.on(events_1$2.TrackEvent.VideoDimensionsChanged,this.handleVideoDimensionsChange),s.on(events_1$2.TrackEvent.VisibilityChanged,this.handleVisibilityChange),s.on(events_1$2.TrackEvent.Ended,this.handleEnded))}updateInfo(s){var d;super.updateInfo(s),this.metadataMuted=s.muted,(d=this.track)===null||d===void 0||d.setMuted(s.muted)}isManualOperationAllowed(){return this.isAdaptiveStream?(logger_1$4.default.warn("adaptive stream is enabled, cannot change track settings",this.trackSid),!1):this.isSubscribed?!0:(logger_1$4.default.warn("cannot update track settings when not subscribed",this.trackSid),!1)}get isAdaptiveStream(){return this.track instanceof RemoteVideoTrack_1$1.default&&this.track.isAdaptiveStream}emitTrackUpdate(){const s=livekit_rtc_1$2.UpdateTrackSettings.fromPartial({trackSids:[this.trackSid],disabled:this.disabled});this.videoDimensions?(s.width=this.videoDimensions.width,s.height=this.videoDimensions.height):this.currentVideoQuality!==void 0?s.quality=this.currentVideoQuality:s.quality=livekit_models_1$1.VideoQuality.HIGH,this.emit(events_1$2.TrackEvent.UpdateSettings,s)}}RemoteTrackPublication$1.default=RemoteTrackPublication;var __importDefault$5=commonjsGlobal&&commonjsGlobal.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(RemoteParticipant$1,"__esModule",{value:!0});const logger_1$3=__importDefault$5(logger),events_1$1=events$1,RemoteAudioTrack_1=__importDefault$5(RemoteAudioTrack$1),RemoteTrackPublication_1=__importDefault$5(RemoteTrackPublication$1),RemoteVideoTrack_1=__importDefault$5(RemoteVideoTrack$1),Track_1$2=Track,Participant_1$1=__importDefault$5(Participant);class RemoteParticipant extends Participant_1$1.default{constructor(s,d,c){super(d,c||""),this.signalClient=s,this.tracks=new Map,this.audioTracks=new Map,this.videoTracks=new Map}static fromParticipantInfo(s,d){const c=new RemoteParticipant(s,d.sid,d.identity);return c.updateInfo(d),c}addTrackPublication(s){super.addTrackPublication(s),s.on(events_1$1.TrackEvent.UpdateSettings,d=>{this.signalClient.sendUpdateTrackSettings(d)}),s.on(events_1$1.TrackEvent.UpdateSubscription,d=>{this.signalClient.sendUpdateSubscription(d)}),s.on(events_1$1.TrackEvent.Ended,d=>{this.emit(events_1$1.ParticipantEvent.TrackUnsubscribed,d,s)})}getTrack(s){const d=super.getTrack(s);if(d)return d}getTrackByName(s){const d=super.getTrackByName(s);if(d)return d}addSubscribedMediaTrack(s,d,c,l,h,p){let y=this.getTrackPublication(d);if(y||d.startsWith("TR")||this.tracks.forEach(O=>{!y&&s.kind===O.kind.toString()&&(y=O)}),!y){if(p===0){logger_1$3.default.error("could not find published track",this.sid,d),this.emit(events_1$1.ParticipantEvent.TrackSubscriptionFailed,d);return}p===void 0&&(p=20),setTimeout(()=>{this.addSubscribedMediaTrack(s,d,c,l,h,p-1)},150);return}const _=s.kind==="video";let E;return _?E=new RemoteVideoTrack_1.default(s,d,l,h):E=new RemoteAudioTrack_1.default(s,d,l),E.source=y.source,E.isMuted=y.isMuted,E.setMediaStream(c),E.start(),y.setTrack(E),this.emit(events_1$1.ParticipantEvent.TrackSubscribed,E,y),y}get hasMetadata(){return!!this.participantInfo}getTrackPublication(s){return this.tracks.get(s)}updateInfo(s){const d=this.hasMetadata;super.updateInfo(s);const c=new Map,l=new Map;s.tracks.forEach(h=>{let p=this.getTrackPublication(h.sid);if(p)p.updateInfo(h);else{const y=Track_1$2.Track.kindFromProto(h.type);if(!y)return;p=new RemoteTrackPublication_1.default(y,h.sid,h.name),p.updateInfo(h),l.set(h.sid,p),this.addTrackPublication(p)}c.set(h.sid,p)}),d&&l.forEach(h=>{this.emit(events_1$1.ParticipantEvent.TrackPublished,h)}),this.tracks.forEach(h=>{c.has(h.trackSid)||this.unpublishTrack(h.trackSid,!0)})}unpublishTrack(s,d){const c=this.tracks.get(s);if(!c)return;switch(this.tracks.delete(s),c.kind){case Track_1$2.Track.Kind.Audio:this.audioTracks.delete(s);break;case Track_1$2.Track.Kind.Video:this.videoTracks.delete(s);break}const{track:l}=c;if(l){const{isSubscribed:h}=c;l.stop(),c.setTrack(void 0),h&&this.emit(events_1$1.ParticipantEvent.TrackUnsubscribed,l,c)}d&&this.emit(events_1$1.ParticipantEvent.TrackUnpublished,c)}emit(s,...d){return logger_1$3.default.trace("participant event",this.sid,s,...d),super.emit(s,...d)}}RemoteParticipant$1.default=RemoteParticipant;var __createBinding=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(a,s,d,c){c===void 0&&(c=d),Object.defineProperty(a,c,{enumerable:!0,get:function(){return s[d]}})}:function(a,s,d,c){c===void 0&&(c=d),a[c]=s[d]}),__setModuleDefault=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(a,s){Object.defineProperty(a,"default",{enumerable:!0,value:s})}:function(a,s){a.default=s}),__importStar=commonjsGlobal&&commonjsGlobal.__importStar||function(a){if(a&&a.__esModule)return a;var s={};if(a!=null)for(var d in a)d!=="default"&&Object.prototype.hasOwnProperty.call(a,d)&&__createBinding(s,a,d);return __setModuleDefault(s,a),s},__awaiter$4=commonjsGlobal&&commonjsGlobal.__awaiter||function(a,s,d,c){function l(h){return h instanceof d?h:new d(function(p){p(h)})}return new(d||(d=Promise))(function(h,p){function y(O){try{E(c.next(O))}catch(P){p(P)}}function _(O){try{E(c.throw(O))}catch(P){p(P)}}function E(O){O.done?h(O.value):l(O.value).then(y,_)}E((c=c.apply(a,s||[])).next())})},__importDefault$4=commonjsGlobal&&commonjsGlobal.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(LocalParticipant$1,"__esModule",{value:!0});const logger_1$2=__importDefault$4(logger),livekit_rtc_1$1=livekit_rtc,errors_1$2=errors,events_1=events$1,LocalAudioTrack_1$1=__importDefault$4(LocalAudioTrack$1),LocalTrackPublication_1=__importDefault$4(LocalTrackPublication$1),LocalVideoTrack_1$1=__importStar(LocalVideoTrack$1),options_1$2=options$1,Track_1$1=Track,utils_1$2=utils$e,Participant_1=__importDefault$4(Participant),ParticipantTrackPermission_1=ParticipantTrackPermission,publishUtils_1$1=publishUtils,RemoteParticipant_1=__importDefault$4(RemoteParticipant$1);class LocalParticipant extends Participant_1.default{constructor(s,d,c,l){super(s,d),this.pendingPublishing=new Set,this.onTrackUnmuted=h=>{this.onTrackMuted(h,!1)},this.onTrackMuted=(h,p)=>{if(p===void 0&&(p=!0),!h.sid){logger_1$2.default.error("could not update mute status for unpublished track",h);return}this.engine.updateMuteStatus(h.sid,p)},this.handleSubscribedQualityUpdate=h=>{var p,y;if(!(!((p=this.roomOptions)===null||p===void 0)&&p.dynacast))return;const _=this.videoTracks.get(h.trackSid);if(!_){logger_1$2.default.warn("handleSubscribedQualityUpdate","received subscribed quality update for unknown track",h.trackSid);return}(y=_.videoTrack)===null||y===void 0||y.setPublishingLayers(h.subscribedQualities)},this.onTrackUnpublish=h=>{this.unpublishTrack(h)},this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map,this.engine=c,this.roomOptions=l,this.engine.client.onRemoteMuteChanged=(h,p)=>{const y=this.tracks.get(h);!y||!y.track||(p?y.mute():y.unmute())},this.engine.client.onSubscribedQualityUpdate=this.handleSubscribedQualityUpdate}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}getTrack(s){const d=super.getTrack(s);if(d)return d}getTrackByName(s){const d=super.getTrackByName(s);if(d)return d}setCameraEnabled(s){return this.setTrackEnabled(Track_1$1.Track.Source.Camera,s)}setMicrophoneEnabled(s){return this.setTrackEnabled(Track_1$1.Track.Source.Microphone,s)}setScreenShareEnabled(s){return this.setTrackEnabled(Track_1$1.Track.Source.ScreenShare,s)}setTrackEnabled(s,d){return __awaiter$4(this,void 0,void 0,function*(){logger_1$2.default.debug("setTrackEnabled",s,d);const c=this.getTrack(s);if(d)if(c)yield c.unmute();else{let l;if(this.pendingPublishing.has(s)){logger_1$2.default.info("skipping duplicate published source",s);return}this.pendingPublishing.add(s);try{switch(s){case Track_1$1.Track.Source.Camera:[l]=yield this.createTracks({video:!0});break;case Track_1$1.Track.Source.Microphone:[l]=yield this.createTracks({audio:!0});break;case Track_1$1.Track.Source.ScreenShare:[l]=yield this.createScreenTracks({audio:!1});break;default:throw new errors_1$2.TrackInvalidError(s)}yield this.publishTrack(l)}catch(h){throw h instanceof Error&&!(h instanceof errors_1$2.TrackInvalidError)&&this.emit(events_1.ParticipantEvent.MediaDevicesError,h),h}finally{this.pendingPublishing.delete(s)}}else c&&c.track&&(s===Track_1$1.Track.Source.ScreenShare?this.unpublishTrack(c.track):yield c.mute())})}enableCameraAndMicrophone(){return __awaiter$4(this,void 0,void 0,function*(){if(!(this.pendingPublishing.has(Track_1$1.Track.Source.Camera)||this.pendingPublishing.has(Track_1$1.Track.Source.Microphone))){this.pendingPublishing.add(Track_1$1.Track.Source.Camera),this.pendingPublishing.add(Track_1$1.Track.Source.Microphone);try{const s=yield this.createTracks({audio:!0,video:!0});yield Promise.all(s.map(d=>this.publishTrack(d)))}finally{this.pendingPublishing.delete(Track_1$1.Track.Source.Camera),this.pendingPublishing.delete(Track_1$1.Track.Source.Microphone)}}})}createTracks(s){var d,c;return __awaiter$4(this,void 0,void 0,function*(){const l=utils_1$2.mergeDefaultOptions(s,(d=this.roomOptions)===null||d===void 0?void 0:d.audioCaptureDefaults,(c=this.roomOptions)===null||c===void 0?void 0:c.videoCaptureDefaults),h=utils_1$2.constraintsForOptions(l);let p;try{p=yield navigator.mediaDevices.getUserMedia(h)}catch(y){throw y instanceof Error&&(h.audio&&(this.microphoneError=y),h.video&&(this.cameraError=y)),y}return h.audio&&(this.microphoneError=void 0),h.video&&(this.cameraError=void 0),p.getTracks().map(y=>{const _=y.kind==="audio";_?s.audio:s.video;let E;const O=_?h.audio:h.video;typeof O!="boolean"&&(E=O);const P=publishUtils_1$1.mediaTrackToLocalTrack(y,E);return P.kind===Track_1$1.Track.Kind.Video?P.source=Track_1$1.Track.Source.Camera:P.kind===Track_1$1.Track.Kind.Audio&&(P.source=Track_1$1.Track.Source.Microphone),P})})}createScreenTracks(s){var d;return __awaiter$4(this,void 0,void 0,function*(){s===void 0&&(s={}),s.resolution===void 0&&(s.resolution=options_1$2.VideoPresets.fhd.resolution);let c=!0;s.resolution&&(c={width:s.resolution.width,height:s.resolution.height,frameRate:s.resolution.frameRate});const l=yield navigator.mediaDevices.getDisplayMedia({audio:(d=s.audio)!==null&&d!==void 0?d:!1,video:c}),h=l.getVideoTracks();if(h.length===0)throw new errors_1$2.TrackInvalidError("no video track found");const p=new LocalVideoTrack_1$1.default(h[0]);p.source=Track_1$1.Track.Source.ScreenShare;const y=[p];if(l.getAudioTracks().length>0){const _=new LocalAudioTrack_1$1.default(l.getAudioTracks()[0]);_.source=Track_1$1.Track.Source.ScreenShareAudio,y.push(_)}return y})}publishTrack(s,d){var c,l,h,p,y,_,E,O;return __awaiter$4(this,void 0,void 0,function*(){const P=Object.assign(Object.assign({},(c=this.roomOptions)===null||c===void 0?void 0:c.publishDefaults),d);if(s instanceof MediaStreamTrack)switch(s.kind){case"audio":s=new LocalAudioTrack_1$1.default(s);break;case"video":s=new LocalVideoTrack_1$1.default(s);break;default:throw new errors_1$2.TrackInvalidError(`unsupported MediaStreamTrack kind ${s.kind}`)}let C;if(this.tracks.forEach(D=>{!D.track||D.track===s&&(C=D)}),C)return C;P.source&&(s.source=P.source),P.stopMicTrackOnMute&&s instanceof LocalAudioTrack_1$1.default&&(s.stopOnMute=!0),s.on(events_1.TrackEvent.Muted,this.onTrackMuted),s.on(events_1.TrackEvent.Unmuted,this.onTrackUnmuted),s.on(events_1.TrackEvent.Ended,this.onTrackUnpublish);const A=livekit_rtc_1$1.AddTrackRequest.fromPartial({cid:s.mediaStreamTrack.id,name:d==null?void 0:d.name,type:Track_1$1.Track.kindToProto(s.kind),muted:s.isMuted,source:Track_1$1.Track.sourceToProto(s.source),disableDtx:!(!((l=P==null?void 0:P.dtx)!==null&&l!==void 0)||l)});let q;if(s.kind===Track_1$1.Track.Kind.Video){const D=s.mediaStreamTrack.getSettings(),J=(h=D.width)!==null&&h!==void 0?h:(p=s.dimensions)===null||p===void 0?void 0:p.width,ee=(y=D.height)!==null&&y!==void 0?y:(_=s.dimensions)===null||_===void 0?void 0:_.height;A.width=J!=null?J:0,A.height=ee!=null?ee:0,q=publishUtils_1$1.computeVideoEncodings(s.source===Track_1$1.Track.Source.ScreenShare,J,ee,P),A.layers=LocalVideoTrack_1$1.videoLayersFromEncodings(A.width,A.height,q)}else s.kind===Track_1$1.Track.Kind.Audio&&P.audioBitrate&&(q=[{maxBitrate:P.audioBitrate}]);const U=yield this.engine.addTrack(A),F=new LocalTrackPublication_1.default(s.kind,U,s);if(s.sid=U.sid,!this.engine.publisher)throw new errors_1$2.UnexpectedConnectionState("publisher is closed");logger_1$2.default.debug(`publishing ${s.kind} with encodings`,q,U);const j={direction:"sendonly"};q&&(j.sendEncodings=q);const T=this.engine.publisher.pc.addTransceiver(s.mediaStreamTrack,j);if(this.engine.negotiate(),s.sender=T.sender,s instanceof LocalVideoTrack_1$1.default){const D=(O=(E=this.roomOptions)===null||E===void 0?void 0:E.expDisableLayerPause)!==null&&O!==void 0?O:!1;s.startMonitor(this.engine.client,D)}else s instanceof LocalAudioTrack_1$1.default&&s.startMonitor();return P.videoCodec&&this.setPreferredCodec(T,s.kind,P.videoCodec),this.addTrackPublication(F),this.emit(events_1.ParticipantEvent.LocalTrackPublished,F),F})}unpublishTrack(s){var d,c;const l=this.getPublicationForTrack(s);if(logger_1$2.default.debug("unpublishTrack","unpublishing track",s),!l||!l.track)return logger_1$2.default.warn("unpublishTrack","track was not unpublished because no publication was found",s),null;s=l.track,s.off(events_1.TrackEvent.Muted,this.onTrackMuted),s.off(events_1.TrackEvent.Unmuted,this.onTrackUnmuted),s.off(events_1.TrackEvent.Ended,this.onTrackUnpublish),(!((c=(d=this.roomOptions)===null||d===void 0?void 0:d.stopLocalTrackOnUnpublish)!==null&&c!==void 0)||c)&&s.stop();const{mediaStreamTrack:h}=s;switch(this.engine.publisher&&this.engine.publisher.pc.getSenders().forEach(y=>{var _;if(y.track===h)try{(_=this.engine.publisher)===null||_===void 0||_.pc.removeTrack(y),this.engine.negotiate()}catch(E){logger_1$2.default.warn("unpublishTrack","failed to remove track",E)}}),this.tracks.delete(l.trackSid),l.kind){case Track_1$1.Track.Kind.Audio:this.audioTracks.delete(l.trackSid);break;case Track_1$1.Track.Kind.Video:this.videoTracks.delete(l.trackSid);break}return l.setTrack(void 0),this.emit(events_1.ParticipantEvent.LocalTrackUnpublished,l),l}unpublishTracks(s){const d=[];return s.forEach(c=>{const l=this.unpublishTrack(c);l&&d.push(l)}),d}get publisherMetrics(){return null}publishData(s,d,c){return __awaiter$4(this,void 0,void 0,function*(){const l=[];c!==void 0&&c.forEach(p=>{p instanceof RemoteParticipant_1.default?l.push(p.sid):l.push(p)});const h={kind:d,user:{participantSid:this.sid,payload:s,destinationSids:l}};yield this.engine.sendDataPacket(h,d)})}setTrackSubscriptionPermissions(s,d=[]){this.engine.client.sendUpdateSubscriptionPermissions(s,d.map(c=>ParticipantTrackPermission_1.trackPermissionToProto(c)))}getPublicationForTrack(s){let d;return this.tracks.forEach(c=>{const l=c.track;!l||(s instanceof MediaStreamTrack?(l instanceof LocalAudioTrack_1$1.default||l instanceof LocalVideoTrack_1$1.default)&&l.mediaStreamTrack===s&&(d=c):s===l&&(d=c))}),d}setPreferredCodec(s,d,c){if(!("getCapabilities"in RTCRtpSender))return;const l=RTCRtpSender.getCapabilities(d);if(!l)return;const h=l.codecs.find(p=>{const y=p.mimeType.toLowerCase(),_=y===`video/${c}`;return c==="h264"&&p.sdpFmtpLine?_&&p.sdpFmtpLine.includes("profile-level-id=42e01f"):_||y==="audio/opus"});h&&"setCodecPreferences"in s&&s.setCodecPreferences([h])}publishedTracksInfo(){const s=[];return this.tracks.forEach(d=>{d.track!==void 0&&s.push({cid:d.track.mediaStreamTrack.id,track:d.trackInfo})}),s}}LocalParticipant$1.default=LocalParticipant;var Room={},SignalClient$1={};let logDisabled_=!0,deprecationWarnings_=!0;function extractVersion(a,s,d){const c=a.match(s);return c&&c.length>=d&&parseInt(c[d],10)}function wrapPeerConnectionEvent(a,s,d){if(!a.RTCPeerConnection)return;const c=a.RTCPeerConnection.prototype,l=c.addEventListener;c.addEventListener=function(p,y){if(p!==s)return l.apply(this,arguments);const _=E=>{const O=d(E);O&&(y.handleEvent?y.handleEvent(O):y(O))};return this._eventMap=this._eventMap||{},this._eventMap[s]||(this._eventMap[s]=new Map),this._eventMap[s].set(y,_),l.apply(this,[p,_])};const h=c.removeEventListener;c.removeEventListener=function(p,y){if(p!==s||!this._eventMap||!this._eventMap[s])return h.apply(this,arguments);if(!this._eventMap[s].has(y))return h.apply(this,arguments);const _=this._eventMap[s].get(y);return this._eventMap[s].delete(y),this._eventMap[s].size===0&&delete this._eventMap[s],Object.keys(this._eventMap).length===0&&delete this._eventMap,h.apply(this,[p,_])},Object.defineProperty(c,"on"+s,{get(){return this["_on"+s]},set(p){this["_on"+s]&&(this.removeEventListener(s,this["_on"+s]),delete this["_on"+s]),p&&this.addEventListener(s,this["_on"+s]=p)},enumerable:!0,configurable:!0})}function disableLog(a){return typeof a!="boolean"?new Error("Argument type: "+typeof a+". Please use a boolean."):(logDisabled_=a,a?"adapter.js logging disabled":"adapter.js logging enabled")}function disableWarnings(a){return typeof a!="boolean"?new Error("Argument type: "+typeof a+". Please use a boolean."):(deprecationWarnings_=!a,"adapter.js deprecation warnings "+(a?"disabled":"enabled"))}function log(){if(typeof window=="object"){if(logDisabled_)return;typeof console!="undefined"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function deprecated(a,s){!deprecationWarnings_||console.warn(a+" is deprecated, please use "+s+" instead.")}function detectBrowser(a){const s={browser:null,version:null};if(typeof a=="undefined"||!a.navigator)return s.browser="Not a browser.",s;const{navigator:d}=a;if(d.mozGetUserMedia)s.browser="firefox",s.version=extractVersion(d.userAgent,/Firefox\/(\d+)\./,1);else if(d.webkitGetUserMedia||a.isSecureContext===!1&&a.webkitRTCPeerConnection&&!a.RTCIceGatherer)s.browser="chrome",s.version=extractVersion(d.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(a.RTCPeerConnection&&d.userAgent.match(/AppleWebKit\/(\d+)\./))s.browser="safari",s.version=extractVersion(d.userAgent,/AppleWebKit\/(\d+)\./,1),s.supportsUnifiedPlan=a.RTCRtpTransceiver&&"currentDirection"in a.RTCRtpTransceiver.prototype;else return s.browser="Not a supported browser.",s;return s}function isObject$3(a){return Object.prototype.toString.call(a)==="[object Object]"}function compactObject(a){return isObject$3(a)?Object.keys(a).reduce(function(s,d){const c=isObject$3(a[d]),l=c?compactObject(a[d]):a[d],h=c&&!Object.keys(l).length;return l===void 0||h?s:Object.assign(s,{[d]:l})},{}):a}function walkStats(a,s,d){!s||d.has(s.id)||(d.set(s.id,s),Object.keys(s).forEach(c=>{c.endsWith("Id")?walkStats(a,a.get(s[c]),d):c.endsWith("Ids")&&s[c].forEach(l=>{walkStats(a,a.get(l),d)})}))}function filterStats(a,s,d){const c=d?"outbound-rtp":"inbound-rtp",l=new Map;if(s===null)return l;const h=[];return a.forEach(p=>{p.type==="track"&&p.trackIdentifier===s.id&&h.push(p)}),h.forEach(p=>{a.forEach(y=>{y.type===c&&y.trackId===p.id&&walkStats(a,y,l)})}),l}const logging=log;function shimGetUserMedia$2(a,s){const d=a&&a.navigator;if(!d.mediaDevices)return;const c=function(y){if(typeof y!="object"||y.mandatory||y.optional)return y;const _={};return Object.keys(y).forEach(E=>{if(E==="require"||E==="advanced"||E==="mediaSource")return;const O=typeof y[E]=="object"?y[E]:{ideal:y[E]};O.exact!==void 0&&typeof O.exact=="number"&&(O.min=O.max=O.exact);const P=function(C,A){return C?C+A.charAt(0).toUpperCase()+A.slice(1):A==="deviceId"?"sourceId":A};if(O.ideal!==void 0){_.optional=_.optional||[];let C={};typeof O.ideal=="number"?(C[P("min",E)]=O.ideal,_.optional.push(C),C={},C[P("max",E)]=O.ideal,_.optional.push(C)):(C[P("",E)]=O.ideal,_.optional.push(C))}O.exact!==void 0&&typeof O.exact!="number"?(_.mandatory=_.mandatory||{},_.mandatory[P("",E)]=O.exact):["min","max"].forEach(C=>{O[C]!==void 0&&(_.mandatory=_.mandatory||{},_.mandatory[P(C,E)]=O[C])})}),y.advanced&&(_.optional=(_.optional||[]).concat(y.advanced)),_},l=function(y,_){if(s.version>=61)return _(y);if(y=JSON.parse(JSON.stringify(y)),y&&typeof y.audio=="object"){const E=function(O,P,C){P in O&&!(C in O)&&(O[C]=O[P],delete O[P])};y=JSON.parse(JSON.stringify(y)),E(y.audio,"autoGainControl","googAutoGainControl"),E(y.audio,"noiseSuppression","googNoiseSuppression"),y.audio=c(y.audio)}if(y&&typeof y.video=="object"){let E=y.video.facingMode;E=E&&(typeof E=="object"?E:{ideal:E});const O=s.version<66;if(E&&(E.exact==="user"||E.exact==="environment"||E.ideal==="user"||E.ideal==="environment")&&!(d.mediaDevices.getSupportedConstraints&&d.mediaDevices.getSupportedConstraints().facingMode&&!O)){delete y.video.facingMode;let P;if(E.exact==="environment"||E.ideal==="environment"?P=["back","rear"]:(E.exact==="user"||E.ideal==="user")&&(P=["front"]),P)return d.mediaDevices.enumerateDevices().then(C=>{C=C.filter(q=>q.kind==="videoinput");let A=C.find(q=>P.some(U=>q.label.toLowerCase().includes(U)));return!A&&C.length&&P.includes("back")&&(A=C[C.length-1]),A&&(y.video.deviceId=E.exact?{exact:A.deviceId}:{ideal:A.deviceId}),y.video=c(y.video),logging("chrome: "+JSON.stringify(y)),_(y)})}y.video=c(y.video)}return logging("chrome: "+JSON.stringify(y)),_(y)},h=function(y){return s.version>=64?y:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[y.name]||y.name,message:y.message,constraint:y.constraint||y.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},p=function(y,_,E){l(y,O=>{d.webkitGetUserMedia(O,_,P=>{E&&E(h(P))})})};if(d.getUserMedia=p.bind(d),d.mediaDevices.getUserMedia){const y=d.mediaDevices.getUserMedia.bind(d.mediaDevices);d.mediaDevices.getUserMedia=function(_){return l(_,E=>y(E).then(O=>{if(E.audio&&!O.getAudioTracks().length||E.video&&!O.getVideoTracks().length)throw O.getTracks().forEach(P=>{P.stop()}),new DOMException("","NotFoundError");return O},O=>Promise.reject(h(O))))}}}function shimGetDisplayMedia$1(a,s){if(!(a.navigator.mediaDevices&&"getDisplayMedia"in a.navigator.mediaDevices)&&!!a.navigator.mediaDevices){if(typeof s!="function"){console.error("shimGetDisplayMedia: getSourceId argument is not a function");return}a.navigator.mediaDevices.getDisplayMedia=function(c){return s(c).then(l=>{const h=c.video&&c.video.width,p=c.video&&c.video.height,y=c.video&&c.video.frameRate;return c.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:l,maxFrameRate:y||3}},h&&(c.video.mandatory.maxWidth=h),p&&(c.video.mandatory.maxHeight=p),a.navigator.mediaDevices.getUserMedia(c)})}}}function shimMediaStream(a){a.MediaStream=a.MediaStream||a.webkitMediaStream}function shimOnTrack$1(a){if(typeof a=="object"&&a.RTCPeerConnection&&!("ontrack"in a.RTCPeerConnection.prototype)){Object.defineProperty(a.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(d){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=d)},enumerable:!0,configurable:!0});const s=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=c=>{c.stream.addEventListener("addtrack",l=>{let h;a.RTCPeerConnection.prototype.getReceivers?h=this.getReceivers().find(y=>y.track&&y.track.id===l.track.id):h={track:l.track};const p=new Event("track");p.track=l.track,p.receiver=h,p.transceiver={receiver:h},p.streams=[c.stream],this.dispatchEvent(p)}),c.stream.getTracks().forEach(l=>{let h;a.RTCPeerConnection.prototype.getReceivers?h=this.getReceivers().find(y=>y.track&&y.track.id===l.id):h={track:l};const p=new Event("track");p.track=l,p.receiver=h,p.transceiver={receiver:h},p.streams=[c.stream],this.dispatchEvent(p)})},this.addEventListener("addstream",this._ontrackpoly)),s.apply(this,arguments)}}else wrapPeerConnectionEvent(a,"track",s=>(s.transceiver||Object.defineProperty(s,"transceiver",{value:{receiver:s.receiver}}),s))}function shimGetSendersWithDtmf(a){if(typeof a=="object"&&a.RTCPeerConnection&&!("getSenders"in a.RTCPeerConnection.prototype)&&"createDTMFSender"in a.RTCPeerConnection.prototype){const s=function(l,h){return{track:h,get dtmf(){return this._dtmf===void 0&&(h.kind==="audio"?this._dtmf=l.createDTMFSender(h):this._dtmf=null),this._dtmf},_pc:l}};if(!a.RTCPeerConnection.prototype.getSenders){a.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const l=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=function(y,_){let E=l.apply(this,arguments);return E||(E=s(this,y),this._senders.push(E)),E};const h=a.RTCPeerConnection.prototype.removeTrack;a.RTCPeerConnection.prototype.removeTrack=function(y){h.apply(this,arguments);const _=this._senders.indexOf(y);_!==-1&&this._senders.splice(_,1)}}const d=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(h){this._senders=this._senders||[],d.apply(this,[h]),h.getTracks().forEach(p=>{this._senders.push(s(this,p))})};const c=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(h){this._senders=this._senders||[],c.apply(this,[h]),h.getTracks().forEach(p=>{const y=this._senders.find(_=>_.track===p);y&&this._senders.splice(this._senders.indexOf(y),1)})}}else if(typeof a=="object"&&a.RTCPeerConnection&&"getSenders"in a.RTCPeerConnection.prototype&&"createDTMFSender"in a.RTCPeerConnection.prototype&&a.RTCRtpSender&&!("dtmf"in a.RTCRtpSender.prototype)){const s=a.RTCPeerConnection.prototype.getSenders;a.RTCPeerConnection.prototype.getSenders=function(){const c=s.apply(this,[]);return c.forEach(l=>l._pc=this),c},Object.defineProperty(a.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function shimGetStats(a){if(!a.RTCPeerConnection)return;const s=a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(){const[c,l,h]=arguments;if(arguments.length>0&&typeof c=="function")return s.apply(this,arguments);if(s.length===0&&(arguments.length===0||typeof c!="function"))return s.apply(this,[]);const p=function(_){const E={};return _.result().forEach(P=>{const C={id:P.id,timestamp:P.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[P.type]||P.type};P.names().forEach(A=>{C[A]=P.stat(A)}),E[C.id]=C}),E},y=function(_){return new Map(Object.keys(_).map(E=>[E,_[E]]))};if(arguments.length>=2){const _=function(E){l(y(p(E)))};return s.apply(this,[_,c])}return new Promise((_,E)=>{s.apply(this,[function(O){_(y(p(O)))},E])}).then(l,h)}}function shimSenderReceiverGetStats(a){if(!(typeof a=="object"&&a.RTCPeerConnection&&a.RTCRtpSender&&a.RTCRtpReceiver))return;if(!("getStats"in a.RTCRtpSender.prototype)){const d=a.RTCPeerConnection.prototype.getSenders;d&&(a.RTCPeerConnection.prototype.getSenders=function(){const h=d.apply(this,[]);return h.forEach(p=>p._pc=this),h});const c=a.RTCPeerConnection.prototype.addTrack;c&&(a.RTCPeerConnection.prototype.addTrack=function(){const h=c.apply(this,arguments);return h._pc=this,h}),a.RTCRtpSender.prototype.getStats=function(){const h=this;return this._pc.getStats().then(p=>filterStats(p,h.track,!0))}}if(!("getStats"in a.RTCRtpReceiver.prototype)){const d=a.RTCPeerConnection.prototype.getReceivers;d&&(a.RTCPeerConnection.prototype.getReceivers=function(){const l=d.apply(this,[]);return l.forEach(h=>h._pc=this),l}),wrapPeerConnectionEvent(a,"track",c=>(c.receiver._pc=c.srcElement,c)),a.RTCRtpReceiver.prototype.getStats=function(){const l=this;return this._pc.getStats().then(h=>filterStats(h,l.track,!1))}}if(!("getStats"in a.RTCRtpSender.prototype&&"getStats"in a.RTCRtpReceiver.prototype))return;const s=a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof a.MediaStreamTrack){const c=arguments[0];let l,h,p;return this.getSenders().forEach(y=>{y.track===c&&(l?p=!0:l=y)}),this.getReceivers().forEach(y=>(y.track===c&&(h?p=!0:h=y),y.track===c)),p||l&&h?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):l?l.getStats():h?h.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return s.apply(this,arguments)}}function shimAddTrackRemoveTrackWithNative(a){a.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(p=>this._shimmedLocalStreams[p][0])};const s=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=function(p,y){if(!y)return s.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const _=s.apply(this,arguments);return this._shimmedLocalStreams[y.id]?this._shimmedLocalStreams[y.id].indexOf(_)===-1&&this._shimmedLocalStreams[y.id].push(_):this._shimmedLocalStreams[y.id]=[y,_],_};const d=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(p){this._shimmedLocalStreams=this._shimmedLocalStreams||{},p.getTracks().forEach(E=>{if(this.getSenders().find(P=>P.track===E))throw new DOMException("Track already exists.","InvalidAccessError")});const y=this.getSenders();d.apply(this,arguments);const _=this.getSenders().filter(E=>y.indexOf(E)===-1);this._shimmedLocalStreams[p.id]=[p].concat(_)};const c=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(p){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[p.id],c.apply(this,arguments)};const l=a.RTCPeerConnection.prototype.removeTrack;a.RTCPeerConnection.prototype.removeTrack=function(p){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},p&&Object.keys(this._shimmedLocalStreams).forEach(y=>{const _=this._shimmedLocalStreams[y].indexOf(p);_!==-1&&this._shimmedLocalStreams[y].splice(_,1),this._shimmedLocalStreams[y].length===1&&delete this._shimmedLocalStreams[y]}),l.apply(this,arguments)}}function shimAddTrackRemoveTrack(a,s){if(!a.RTCPeerConnection)return;if(a.RTCPeerConnection.prototype.addTrack&&s.version>=65)return shimAddTrackRemoveTrackWithNative(a);const d=a.RTCPeerConnection.prototype.getLocalStreams;a.RTCPeerConnection.prototype.getLocalStreams=function(){const O=d.apply(this);return this._reverseStreams=this._reverseStreams||{},O.map(P=>this._reverseStreams[P.id])};const c=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(O){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},O.getTracks().forEach(P=>{if(this.getSenders().find(A=>A.track===P))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[O.id]){const P=new a.MediaStream(O.getTracks());this._streams[O.id]=P,this._reverseStreams[P.id]=O,O=P}c.apply(this,[O])};const l=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(O){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},l.apply(this,[this._streams[O.id]||O]),delete this._reverseStreams[this._streams[O.id]?this._streams[O.id].id:O.id],delete this._streams[O.id]},a.RTCPeerConnection.prototype.addTrack=function(O,P){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const C=[].slice.call(arguments,1);if(C.length!==1||!C[0].getTracks().find(U=>U===O))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(U=>U.track===O))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const q=this._streams[P.id];if(q)q.addTrack(O),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const U=new a.MediaStream([O]);this._streams[P.id]=U,this._reverseStreams[U.id]=P,this.addStream(U)}return this.getSenders().find(U=>U.track===O)};function h(E,O){let P=O.sdp;return Object.keys(E._reverseStreams||[]).forEach(C=>{const A=E._reverseStreams[C],q=E._streams[A.id];P=P.replace(new RegExp(q.id,"g"),A.id)}),new RTCSessionDescription({type:O.type,sdp:P})}function p(E,O){let P=O.sdp;return Object.keys(E._reverseStreams||[]).forEach(C=>{const A=E._reverseStreams[C],q=E._streams[A.id];P=P.replace(new RegExp(A.id,"g"),q.id)}),new RTCSessionDescription({type:O.type,sdp:P})}["createOffer","createAnswer"].forEach(function(E){const O=a.RTCPeerConnection.prototype[E],P={[E](){const C=arguments;return arguments.length&&typeof arguments[0]=="function"?O.apply(this,[q=>{const U=h(this,q);C[0].apply(null,[U])},q=>{C[1]&&C[1].apply(null,q)},arguments[2]]):O.apply(this,arguments).then(q=>h(this,q))}};a.RTCPeerConnection.prototype[E]=P[E]});const y=a.RTCPeerConnection.prototype.setLocalDescription;a.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?y.apply(this,arguments):(arguments[0]=p(this,arguments[0]),y.apply(this,arguments))};const _=Object.getOwnPropertyDescriptor(a.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(a.RTCPeerConnection.prototype,"localDescription",{get(){const E=_.get.apply(this);return E.type===""?E:h(this,E)}}),a.RTCPeerConnection.prototype.removeTrack=function(O){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!O._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(O._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let C;Object.keys(this._streams).forEach(A=>{this._streams[A].getTracks().find(U=>O.track===U)&&(C=this._streams[A])}),C&&(C.getTracks().length===1?this.removeStream(this._reverseStreams[C.id]):C.removeTrack(O.track),this.dispatchEvent(new Event("negotiationneeded")))}}function shimPeerConnection$1(a,s){!a.RTCPeerConnection&&a.webkitRTCPeerConnection&&(a.RTCPeerConnection=a.webkitRTCPeerConnection),!!a.RTCPeerConnection&&s.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(d){const c=a.RTCPeerConnection.prototype[d],l={[d](){return arguments[0]=new(d==="addIceCandidate"?a.RTCIceCandidate:a.RTCSessionDescription)(arguments[0]),c.apply(this,arguments)}};a.RTCPeerConnection.prototype[d]=l[d]})}function fixNegotiationNeeded(a,s){wrapPeerConnectionEvent(a,"negotiationneeded",d=>{const c=d.target;if(!((s.version<72||c.getConfiguration&&c.getConfiguration().sdpSemantics==="plan-b")&&c.signalingState!=="stable"))return d})}var chromeShim=Object.freeze(Object.defineProperty({__proto__:null,shimMediaStream,shimOnTrack:shimOnTrack$1,shimGetSendersWithDtmf,shimGetStats,shimSenderReceiverGetStats,shimAddTrackRemoveTrackWithNative,shimAddTrackRemoveTrack,shimPeerConnection:shimPeerConnection$1,fixNegotiationNeeded,shimGetUserMedia:shimGetUserMedia$2,shimGetDisplayMedia:shimGetDisplayMedia$1},Symbol.toStringTag,{value:"Module"}));function shimGetUserMedia$1(a,s){const d=a&&a.navigator,c=a&&a.MediaStreamTrack;if(d.getUserMedia=function(l,h,p){deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),d.mediaDevices.getUserMedia(l).then(h,p)},!(s.version>55&&"autoGainControl"in d.mediaDevices.getSupportedConstraints())){const l=function(p,y,_){y in p&&!(_ in p)&&(p[_]=p[y],delete p[y])},h=d.mediaDevices.getUserMedia.bind(d.mediaDevices);if(d.mediaDevices.getUserMedia=function(p){return typeof p=="object"&&typeof p.audio=="object"&&(p=JSON.parse(JSON.stringify(p)),l(p.audio,"autoGainControl","mozAutoGainControl"),l(p.audio,"noiseSuppression","mozNoiseSuppression")),h(p)},c&&c.prototype.getSettings){const p=c.prototype.getSettings;c.prototype.getSettings=function(){const y=p.apply(this,arguments);return l(y,"mozAutoGainControl","autoGainControl"),l(y,"mozNoiseSuppression","noiseSuppression"),y}}if(c&&c.prototype.applyConstraints){const p=c.prototype.applyConstraints;c.prototype.applyConstraints=function(y){return this.kind==="audio"&&typeof y=="object"&&(y=JSON.parse(JSON.stringify(y)),l(y,"autoGainControl","mozAutoGainControl"),l(y,"noiseSuppression","mozNoiseSuppression")),p.apply(this,[y])}}}}function shimGetDisplayMedia(a,s){a.navigator.mediaDevices&&"getDisplayMedia"in a.navigator.mediaDevices||!a.navigator.mediaDevices||(a.navigator.mediaDevices.getDisplayMedia=function(c){if(!(c&&c.video)){const l=new DOMException("getDisplayMedia without video constraints is undefined");return l.name="NotFoundError",l.code=8,Promise.reject(l)}return c.video===!0?c.video={mediaSource:s}:c.video.mediaSource=s,a.navigator.mediaDevices.getUserMedia(c)})}function shimOnTrack(a){typeof a=="object"&&a.RTCTrackEvent&&"receiver"in a.RTCTrackEvent.prototype&&!("transceiver"in a.RTCTrackEvent.prototype)&&Object.defineProperty(a.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function shimPeerConnection(a,s){if(typeof a!="object"||!(a.RTCPeerConnection||a.mozRTCPeerConnection))return;!a.RTCPeerConnection&&a.mozRTCPeerConnection&&(a.RTCPeerConnection=a.mozRTCPeerConnection),s.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(l){const h=a.RTCPeerConnection.prototype[l],p={[l](){return arguments[0]=new(l==="addIceCandidate"?a.RTCIceCandidate:a.RTCSessionDescription)(arguments[0]),h.apply(this,arguments)}};a.RTCPeerConnection.prototype[l]=p[l]});const d={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},c=a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(){const[h,p,y]=arguments;return c.apply(this,[h||null]).then(_=>{if(s.version<53&&!p)try{_.forEach(E=>{E.type=d[E.type]||E.type})}catch(E){if(E.name!=="TypeError")throw E;_.forEach((O,P)=>{_.set(P,Object.assign({},O,{type:d[O.type]||O.type}))})}return _}).then(p,y)}}function shimSenderGetStats(a){if(!(typeof a=="object"&&a.RTCPeerConnection&&a.RTCRtpSender)||a.RTCRtpSender&&"getStats"in a.RTCRtpSender.prototype)return;const s=a.RTCPeerConnection.prototype.getSenders;s&&(a.RTCPeerConnection.prototype.getSenders=function(){const l=s.apply(this,[]);return l.forEach(h=>h._pc=this),l});const d=a.RTCPeerConnection.prototype.addTrack;d&&(a.RTCPeerConnection.prototype.addTrack=function(){const l=d.apply(this,arguments);return l._pc=this,l}),a.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function shimReceiverGetStats(a){if(!(typeof a=="object"&&a.RTCPeerConnection&&a.RTCRtpSender)||a.RTCRtpSender&&"getStats"in a.RTCRtpReceiver.prototype)return;const s=a.RTCPeerConnection.prototype.getReceivers;s&&(a.RTCPeerConnection.prototype.getReceivers=function(){const c=s.apply(this,[]);return c.forEach(l=>l._pc=this),c}),wrapPeerConnectionEvent(a,"track",d=>(d.receiver._pc=d.srcElement,d)),a.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function shimRemoveStream(a){!a.RTCPeerConnection||"removeStream"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.removeStream=function(d){deprecated("removeStream","removeTrack"),this.getSenders().forEach(c=>{c.track&&d.getTracks().includes(c.track)&&this.removeTrack(c)})})}function shimRTCDataChannel(a){a.DataChannel&&!a.RTCDataChannel&&(a.RTCDataChannel=a.DataChannel)}function shimAddTransceiver(a){if(!(typeof a=="object"&&a.RTCPeerConnection))return;const s=a.RTCPeerConnection.prototype.addTransceiver;s&&(a.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];const c=arguments[1],l=c&&"sendEncodings"in c;l&&c.sendEncodings.forEach(p=>{if("rid"in p&&!/^[a-z0-9]{0,16}$/i.test(p.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in p&&!(parseFloat(p.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in p&&!(parseFloat(p.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const h=s.apply(this,arguments);if(l){const{sender:p}=h,y=p.getParameters();(!("encodings"in y)||y.encodings.length===1&&Object.keys(y.encodings[0]).length===0)&&(y.encodings=c.sendEncodings,p.sendEncodings=c.sendEncodings,this.setParametersPromises.push(p.setParameters(y).then(()=>{delete p.sendEncodings}).catch(()=>{delete p.sendEncodings})))}return h})}function shimGetParameters(a){if(!(typeof a=="object"&&a.RTCRtpSender))return;const s=a.RTCRtpSender.prototype.getParameters;s&&(a.RTCRtpSender.prototype.getParameters=function(){const c=s.apply(this,arguments);return"encodings"in c||(c.encodings=[].concat(this.sendEncodings||[{}])),c})}function shimCreateOffer(a){if(!(typeof a=="object"&&a.RTCPeerConnection))return;const s=a.RTCPeerConnection.prototype.createOffer;a.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>s.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):s.apply(this,arguments)}}function shimCreateAnswer(a){if(!(typeof a=="object"&&a.RTCPeerConnection))return;const s=a.RTCPeerConnection.prototype.createAnswer;a.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>s.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):s.apply(this,arguments)}}var firefoxShim=Object.freeze(Object.defineProperty({__proto__:null,shimOnTrack,shimPeerConnection,shimSenderGetStats,shimReceiverGetStats,shimRemoveStream,shimRTCDataChannel,shimAddTransceiver,shimGetParameters,shimCreateOffer,shimCreateAnswer,shimGetUserMedia:shimGetUserMedia$1,shimGetDisplayMedia},Symbol.toStringTag,{value:"Module"}));function shimLocalStreamsAPI(a){if(!(typeof a!="object"||!a.RTCPeerConnection)){if("getLocalStreams"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in a.RTCPeerConnection.prototype)){const s=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addStream=function(c){this._localStreams||(this._localStreams=[]),this._localStreams.includes(c)||this._localStreams.push(c),c.getAudioTracks().forEach(l=>s.call(this,l,c)),c.getVideoTracks().forEach(l=>s.call(this,l,c))},a.RTCPeerConnection.prototype.addTrack=function(c,...l){return l&&l.forEach(h=>{this._localStreams?this._localStreams.includes(h)||this._localStreams.push(h):this._localStreams=[h]}),s.apply(this,arguments)}}"removeStream"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.removeStream=function(d){this._localStreams||(this._localStreams=[]);const c=this._localStreams.indexOf(d);if(c===-1)return;this._localStreams.splice(c,1);const l=d.getTracks();this.getSenders().forEach(h=>{l.includes(h.track)&&this.removeTrack(h)})})}}function shimRemoteStreamsAPI(a){if(!(typeof a!="object"||!a.RTCPeerConnection)&&("getRemoteStreams"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in a.RTCPeerConnection.prototype))){Object.defineProperty(a.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(d){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=d),this.addEventListener("track",this._onaddstreampoly=c=>{c.streams.forEach(l=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(l))return;this._remoteStreams.push(l);const h=new Event("addstream");h.stream=l,this.dispatchEvent(h)})})}});const s=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){const c=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(l){l.streams.forEach(h=>{if(c._remoteStreams||(c._remoteStreams=[]),c._remoteStreams.indexOf(h)>=0)return;c._remoteStreams.push(h);const p=new Event("addstream");p.stream=h,c.dispatchEvent(p)})}),s.apply(c,arguments)}}}function shimCallbacksAPI(a){if(typeof a!="object"||!a.RTCPeerConnection)return;const s=a.RTCPeerConnection.prototype,d=s.createOffer,c=s.createAnswer,l=s.setLocalDescription,h=s.setRemoteDescription,p=s.addIceCandidate;s.createOffer=function(E,O){const P=arguments.length>=2?arguments[2]:arguments[0],C=d.apply(this,[P]);return O?(C.then(E,O),Promise.resolve()):C},s.createAnswer=function(E,O){const P=arguments.length>=2?arguments[2]:arguments[0],C=c.apply(this,[P]);return O?(C.then(E,O),Promise.resolve()):C};let y=function(_,E,O){const P=l.apply(this,[_]);return O?(P.then(E,O),Promise.resolve()):P};s.setLocalDescription=y,y=function(_,E,O){const P=h.apply(this,[_]);return O?(P.then(E,O),Promise.resolve()):P},s.setRemoteDescription=y,y=function(_,E,O){const P=p.apply(this,[_]);return O?(P.then(E,O),Promise.resolve()):P},s.addIceCandidate=y}function shimGetUserMedia(a){const s=a&&a.navigator;if(s.mediaDevices&&s.mediaDevices.getUserMedia){const d=s.mediaDevices,c=d.getUserMedia.bind(d);s.mediaDevices.getUserMedia=l=>c(shimConstraints(l))}!s.getUserMedia&&s.mediaDevices&&s.mediaDevices.getUserMedia&&(s.getUserMedia=function(c,l,h){s.mediaDevices.getUserMedia(c).then(l,h)}.bind(s))}function shimConstraints(a){return a&&a.video!==void 0?Object.assign({},a,{video:compactObject(a.video)}):a}function shimRTCIceServerUrls(a){if(!a.RTCPeerConnection)return;const s=a.RTCPeerConnection;a.RTCPeerConnection=function(c,l){if(c&&c.iceServers){const h=[];for(let p=0;p<c.iceServers.length;p++){let y=c.iceServers[p];!y.hasOwnProperty("urls")&&y.hasOwnProperty("url")?(deprecated("RTCIceServer.url","RTCIceServer.urls"),y=JSON.parse(JSON.stringify(y)),y.urls=y.url,delete y.url,h.push(y)):h.push(c.iceServers[p])}c.iceServers=h}return new s(c,l)},a.RTCPeerConnection.prototype=s.prototype,"generateCertificate"in s&&Object.defineProperty(a.RTCPeerConnection,"generateCertificate",{get(){return s.generateCertificate}})}function shimTrackEventTransceiver(a){typeof a=="object"&&a.RTCTrackEvent&&"receiver"in a.RTCTrackEvent.prototype&&!("transceiver"in a.RTCTrackEvent.prototype)&&Object.defineProperty(a.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function shimCreateOfferLegacy(a){const s=a.RTCPeerConnection.prototype.createOffer;a.RTCPeerConnection.prototype.createOffer=function(c){if(c){typeof c.offerToReceiveAudio!="undefined"&&(c.offerToReceiveAudio=!!c.offerToReceiveAudio);const l=this.getTransceivers().find(p=>p.receiver.track.kind==="audio");c.offerToReceiveAudio===!1&&l?l.direction==="sendrecv"?l.setDirection?l.setDirection("sendonly"):l.direction="sendonly":l.direction==="recvonly"&&(l.setDirection?l.setDirection("inactive"):l.direction="inactive"):c.offerToReceiveAudio===!0&&!l&&this.addTransceiver("audio",{direction:"recvonly"}),typeof c.offerToReceiveVideo!="undefined"&&(c.offerToReceiveVideo=!!c.offerToReceiveVideo);const h=this.getTransceivers().find(p=>p.receiver.track.kind==="video");c.offerToReceiveVideo===!1&&h?h.direction==="sendrecv"?h.setDirection?h.setDirection("sendonly"):h.direction="sendonly":h.direction==="recvonly"&&(h.setDirection?h.setDirection("inactive"):h.direction="inactive"):c.offerToReceiveVideo===!0&&!h&&this.addTransceiver("video",{direction:"recvonly"})}return s.apply(this,arguments)}}function shimAudioContext(a){typeof a!="object"||a.AudioContext||(a.AudioContext=a.webkitAudioContext)}var safariShim=Object.freeze(Object.defineProperty({__proto__:null,shimLocalStreamsAPI,shimRemoteStreamsAPI,shimCallbacksAPI,shimGetUserMedia,shimConstraints,shimRTCIceServerUrls,shimTrackEventTransceiver,shimCreateOfferLegacy,shimAudioContext},Symbol.toStringTag,{value:"Module"})),sdp$1={exports:{}};(function(a){const s={};s.generateIdentifier=function(){return Math.random().toString(36).substr(2,10)},s.localCName=s.generateIdentifier(),s.splitLines=function(d){return d.trim().split(`
`).map(c=>c.trim())},s.splitSections=function(d){return d.split(`
m=`).map((l,h)=>(h>0?"m="+l:l).trim()+`\r
`)},s.getDescription=function(d){const c=s.splitSections(d);return c&&c[0]},s.getMediaSections=function(d){const c=s.splitSections(d);return c.shift(),c},s.matchPrefix=function(d,c){return s.splitLines(d).filter(l=>l.indexOf(c)===0)},s.parseCandidate=function(d){let c;d.indexOf("a=candidate:")===0?c=d.substring(12).split(" "):c=d.substring(10).split(" ");const l={foundation:c[0],component:{1:"rtp",2:"rtcp"}[c[1]]||c[1],protocol:c[2].toLowerCase(),priority:parseInt(c[3],10),ip:c[4],address:c[4],port:parseInt(c[5],10),type:c[7]};for(let h=8;h<c.length;h+=2)switch(c[h]){case"raddr":l.relatedAddress=c[h+1];break;case"rport":l.relatedPort=parseInt(c[h+1],10);break;case"tcptype":l.tcpType=c[h+1];break;case"ufrag":l.ufrag=c[h+1],l.usernameFragment=c[h+1];break;default:l[c[h]]===void 0&&(l[c[h]]=c[h+1]);break}return l},s.writeCandidate=function(d){const c=[];c.push(d.foundation);const l=d.component;l==="rtp"?c.push(1):l==="rtcp"?c.push(2):c.push(l),c.push(d.protocol.toUpperCase()),c.push(d.priority),c.push(d.address||d.ip),c.push(d.port);const h=d.type;return c.push("typ"),c.push(h),h!=="host"&&d.relatedAddress&&d.relatedPort&&(c.push("raddr"),c.push(d.relatedAddress),c.push("rport"),c.push(d.relatedPort)),d.tcpType&&d.protocol.toLowerCase()==="tcp"&&(c.push("tcptype"),c.push(d.tcpType)),(d.usernameFragment||d.ufrag)&&(c.push("ufrag"),c.push(d.usernameFragment||d.ufrag)),"candidate:"+c.join(" ")},s.parseIceOptions=function(d){return d.substr(14).split(" ")},s.parseRtpMap=function(d){let c=d.substr(9).split(" ");const l={payloadType:parseInt(c.shift(),10)};return c=c[0].split("/"),l.name=c[0],l.clockRate=parseInt(c[1],10),l.channels=c.length===3?parseInt(c[2],10):1,l.numChannels=l.channels,l},s.writeRtpMap=function(d){let c=d.payloadType;d.preferredPayloadType!==void 0&&(c=d.preferredPayloadType);const l=d.channels||d.numChannels||1;return"a=rtpmap:"+c+" "+d.name+"/"+d.clockRate+(l!==1?"/"+l:"")+`\r
`},s.parseExtmap=function(d){const c=d.substr(9).split(" ");return{id:parseInt(c[0],10),direction:c[0].indexOf("/")>0?c[0].split("/")[1]:"sendrecv",uri:c[1]}},s.writeExtmap=function(d){return"a=extmap:"+(d.id||d.preferredId)+(d.direction&&d.direction!=="sendrecv"?"/"+d.direction:"")+" "+d.uri+`\r
`},s.parseFmtp=function(d){const c={};let l;const h=d.substr(d.indexOf(" ")+1).split(";");for(let p=0;p<h.length;p++)l=h[p].trim().split("="),c[l[0].trim()]=l[1];return c},s.writeFmtp=function(d){let c="",l=d.payloadType;if(d.preferredPayloadType!==void 0&&(l=d.preferredPayloadType),d.parameters&&Object.keys(d.parameters).length){const h=[];Object.keys(d.parameters).forEach(p=>{d.parameters[p]!==void 0?h.push(p+"="+d.parameters[p]):h.push(p)}),c+="a=fmtp:"+l+" "+h.join(";")+`\r
`}return c},s.parseRtcpFb=function(d){const c=d.substr(d.indexOf(" ")+1).split(" ");return{type:c.shift(),parameter:c.join(" ")}},s.writeRtcpFb=function(d){let c="",l=d.payloadType;return d.preferredPayloadType!==void 0&&(l=d.preferredPayloadType),d.rtcpFeedback&&d.rtcpFeedback.length&&d.rtcpFeedback.forEach(h=>{c+="a=rtcp-fb:"+l+" "+h.type+(h.parameter&&h.parameter.length?" "+h.parameter:"")+`\r
`}),c},s.parseSsrcMedia=function(d){const c=d.indexOf(" "),l={ssrc:parseInt(d.substr(7,c-7),10)},h=d.indexOf(":",c);return h>-1?(l.attribute=d.substr(c+1,h-c-1),l.value=d.substr(h+1)):l.attribute=d.substr(c+1),l},s.parseSsrcGroup=function(d){const c=d.substr(13).split(" ");return{semantics:c.shift(),ssrcs:c.map(l=>parseInt(l,10))}},s.getMid=function(d){const c=s.matchPrefix(d,"a=mid:")[0];if(c)return c.substr(6)},s.parseFingerprint=function(d){const c=d.substr(14).split(" ");return{algorithm:c[0].toLowerCase(),value:c[1].toUpperCase()}},s.getDtlsParameters=function(d,c){const l=s.matchPrefix(d+c,"a=fingerprint:");return{role:"auto",fingerprints:l.map(s.parseFingerprint)}},s.writeDtlsParameters=function(d,c){let l="a=setup:"+c+`\r
`;return d.fingerprints.forEach(h=>{l+="a=fingerprint:"+h.algorithm+" "+h.value+`\r
`}),l},s.parseCryptoLine=function(d){const c=d.substr(9).split(" ");return{tag:parseInt(c[0],10),cryptoSuite:c[1],keyParams:c[2],sessionParams:c.slice(3)}},s.writeCryptoLine=function(d){return"a=crypto:"+d.tag+" "+d.cryptoSuite+" "+(typeof d.keyParams=="object"?s.writeCryptoKeyParams(d.keyParams):d.keyParams)+(d.sessionParams?" "+d.sessionParams.join(" "):"")+`\r
`},s.parseCryptoKeyParams=function(d){if(d.indexOf("inline:")!==0)return null;const c=d.substr(7).split("|");return{keyMethod:"inline",keySalt:c[0],lifeTime:c[1],mkiValue:c[2]?c[2].split(":")[0]:void 0,mkiLength:c[2]?c[2].split(":")[1]:void 0}},s.writeCryptoKeyParams=function(d){return d.keyMethod+":"+d.keySalt+(d.lifeTime?"|"+d.lifeTime:"")+(d.mkiValue&&d.mkiLength?"|"+d.mkiValue+":"+d.mkiLength:"")},s.getCryptoParameters=function(d,c){return s.matchPrefix(d+c,"a=crypto:").map(s.parseCryptoLine)},s.getIceParameters=function(d,c){const l=s.matchPrefix(d+c,"a=ice-ufrag:")[0],h=s.matchPrefix(d+c,"a=ice-pwd:")[0];return l&&h?{usernameFragment:l.substr(12),password:h.substr(10)}:null},s.writeIceParameters=function(d){let c="a=ice-ufrag:"+d.usernameFragment+`\r
a=ice-pwd:`+d.password+`\r
`;return d.iceLite&&(c+=`a=ice-lite\r
`),c},s.parseRtpParameters=function(d){const c={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},h=s.splitLines(d)[0].split(" ");for(let p=3;p<h.length;p++){const y=h[p],_=s.matchPrefix(d,"a=rtpmap:"+y+" ")[0];if(_){const E=s.parseRtpMap(_),O=s.matchPrefix(d,"a=fmtp:"+y+" ");switch(E.parameters=O.length?s.parseFmtp(O[0]):{},E.rtcpFeedback=s.matchPrefix(d,"a=rtcp-fb:"+y+" ").map(s.parseRtcpFb),c.codecs.push(E),E.name.toUpperCase()){case"RED":case"ULPFEC":c.fecMechanisms.push(E.name.toUpperCase());break}}}return s.matchPrefix(d,"a=extmap:").forEach(p=>{c.headerExtensions.push(s.parseExtmap(p))}),c},s.writeRtpDescription=function(d,c){let l="";l+="m="+d+" ",l+=c.codecs.length>0?"9":"0",l+=" UDP/TLS/RTP/SAVPF ",l+=c.codecs.map(p=>p.preferredPayloadType!==void 0?p.preferredPayloadType:p.payloadType).join(" ")+`\r
`,l+=`c=IN IP4 0.0.0.0\r
`,l+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,c.codecs.forEach(p=>{l+=s.writeRtpMap(p),l+=s.writeFmtp(p),l+=s.writeRtcpFb(p)});let h=0;return c.codecs.forEach(p=>{p.maxptime>h&&(h=p.maxptime)}),h>0&&(l+="a=maxptime:"+h+`\r
`),c.headerExtensions&&c.headerExtensions.forEach(p=>{l+=s.writeExtmap(p)}),l},s.parseRtpEncodingParameters=function(d){const c=[],l=s.parseRtpParameters(d),h=l.fecMechanisms.indexOf("RED")!==-1,p=l.fecMechanisms.indexOf("ULPFEC")!==-1,y=s.matchPrefix(d,"a=ssrc:").map(C=>s.parseSsrcMedia(C)).filter(C=>C.attribute==="cname"),_=y.length>0&&y[0].ssrc;let E;const O=s.matchPrefix(d,"a=ssrc-group:FID").map(C=>C.substr(17).split(" ").map(q=>parseInt(q,10)));O.length>0&&O[0].length>1&&O[0][0]===_&&(E=O[0][1]),l.codecs.forEach(C=>{if(C.name.toUpperCase()==="RTX"&&C.parameters.apt){let A={ssrc:_,codecPayloadType:parseInt(C.parameters.apt,10)};_&&E&&(A.rtx={ssrc:E}),c.push(A),h&&(A=JSON.parse(JSON.stringify(A)),A.fec={ssrc:_,mechanism:p?"red+ulpfec":"red"},c.push(A))}}),c.length===0&&_&&c.push({ssrc:_});let P=s.matchPrefix(d,"b=");return P.length&&(P[0].indexOf("b=TIAS:")===0?P=parseInt(P[0].substr(7),10):P[0].indexOf("b=AS:")===0?P=parseInt(P[0].substr(5),10)*1e3*.95-50*40*8:P=void 0,c.forEach(C=>{C.maxBitrate=P})),c},s.parseRtcpParameters=function(d){const c={},l=s.matchPrefix(d,"a=ssrc:").map(y=>s.parseSsrcMedia(y)).filter(y=>y.attribute==="cname")[0];l&&(c.cname=l.value,c.ssrc=l.ssrc);const h=s.matchPrefix(d,"a=rtcp-rsize");c.reducedSize=h.length>0,c.compound=h.length===0;const p=s.matchPrefix(d,"a=rtcp-mux");return c.mux=p.length>0,c},s.writeRtcpParameters=function(d){let c="";return d.reducedSize&&(c+=`a=rtcp-rsize\r
`),d.mux&&(c+=`a=rtcp-mux\r
`),d.ssrc!==void 0&&d.cname&&(c+="a=ssrc:"+d.ssrc+" cname:"+d.cname+`\r
`),c},s.parseMsid=function(d){let c;const l=s.matchPrefix(d,"a=msid:");if(l.length===1)return c=l[0].substr(7).split(" "),{stream:c[0],track:c[1]};const h=s.matchPrefix(d,"a=ssrc:").map(p=>s.parseSsrcMedia(p)).filter(p=>p.attribute==="msid");if(h.length>0)return c=h[0].value.split(" "),{stream:c[0],track:c[1]}},s.parseSctpDescription=function(d){const c=s.parseMLine(d),l=s.matchPrefix(d,"a=max-message-size:");let h;l.length>0&&(h=parseInt(l[0].substr(19),10)),isNaN(h)&&(h=65536);const p=s.matchPrefix(d,"a=sctp-port:");if(p.length>0)return{port:parseInt(p[0].substr(12),10),protocol:c.fmt,maxMessageSize:h};const y=s.matchPrefix(d,"a=sctpmap:");if(y.length>0){const _=y[0].substr(10).split(" ");return{port:parseInt(_[0],10),protocol:_[1],maxMessageSize:h}}},s.writeSctpDescription=function(d,c){let l=[];return d.protocol!=="DTLS/SCTP"?l=["m="+d.kind+" 9 "+d.protocol+" "+c.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+c.port+`\r
`]:l=["m="+d.kind+" 9 "+d.protocol+" "+c.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+c.port+" "+c.protocol+` 65535\r
`],c.maxMessageSize!==void 0&&l.push("a=max-message-size:"+c.maxMessageSize+`\r
`),l.join("")},s.generateSessionId=function(){return Math.random().toString().substr(2,21)},s.writeSessionBoilerplate=function(d,c,l){let h;const p=c!==void 0?c:2;return d?h=d:h=s.generateSessionId(),`v=0\r
o=`+(l||"thisisadapterortc")+" "+h+" "+p+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},s.getDirection=function(d,c){const l=s.splitLines(d);for(let h=0;h<l.length;h++)switch(l[h]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return l[h].substr(2)}return c?s.getDirection(c):"sendrecv"},s.getKind=function(d){return s.splitLines(d)[0].split(" ")[0].substr(2)},s.isRejected=function(d){return d.split(" ",2)[1]==="0"},s.parseMLine=function(d){const l=s.splitLines(d)[0].substr(2).split(" ");return{kind:l[0],port:parseInt(l[1],10),protocol:l[2],fmt:l.slice(3).join(" ")}},s.parseOLine=function(d){const l=s.matchPrefix(d,"o=")[0].substr(2).split(" ");return{username:l[0],sessionId:l[1],sessionVersion:parseInt(l[2],10),netType:l[3],addressType:l[4],address:l[5]}},s.isValidSDP=function(d){if(typeof d!="string"||d.length===0)return!1;const c=s.splitLines(d);for(let l=0;l<c.length;l++)if(c[l].length<2||c[l].charAt(1)!=="=")return!1;return!0},a.exports=s})(sdp$1);var SDPUtils=sdp$1.exports,sdp=_mergeNamespaces({__proto__:null,default:SDPUtils},[sdp$1.exports]);function shimRTCIceCandidate(a){if(!a.RTCIceCandidate||a.RTCIceCandidate&&"foundation"in a.RTCIceCandidate.prototype)return;const s=a.RTCIceCandidate;a.RTCIceCandidate=function(c){if(typeof c=="object"&&c.candidate&&c.candidate.indexOf("a=")===0&&(c=JSON.parse(JSON.stringify(c)),c.candidate=c.candidate.substr(2)),c.candidate&&c.candidate.length){const l=new s(c),h=SDPUtils.parseCandidate(c.candidate),p=Object.assign(l,h);return p.toJSON=function(){return{candidate:p.candidate,sdpMid:p.sdpMid,sdpMLineIndex:p.sdpMLineIndex,usernameFragment:p.usernameFragment}},p}return new s(c)},a.RTCIceCandidate.prototype=s.prototype,wrapPeerConnectionEvent(a,"icecandidate",d=>(d.candidate&&Object.defineProperty(d,"candidate",{value:new a.RTCIceCandidate(d.candidate),writable:"false"}),d))}function shimMaxMessageSize(a,s){if(!a.RTCPeerConnection)return;"sctp"in a.RTCPeerConnection.prototype||Object.defineProperty(a.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp=="undefined"?null:this._sctp}});const d=function(y){if(!y||!y.sdp)return!1;const _=SDPUtils.splitSections(y.sdp);return _.shift(),_.some(E=>{const O=SDPUtils.parseMLine(E);return O&&O.kind==="application"&&O.protocol.indexOf("SCTP")!==-1})},c=function(y){const _=y.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(_===null||_.length<2)return-1;const E=parseInt(_[1],10);return E!==E?-1:E},l=function(y){let _=65536;return s.browser==="firefox"&&(s.version<57?y===-1?_=16384:_=2147483637:s.version<60?_=s.version===57?65535:65536:_=2147483637),_},h=function(y,_){let E=65536;s.browser==="firefox"&&s.version===57&&(E=65535);const O=SDPUtils.matchPrefix(y.sdp,"a=max-message-size:");return O.length>0?E=parseInt(O[0].substr(19),10):s.browser==="firefox"&&_!==-1&&(E=2147483637),E},p=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,s.browser==="chrome"&&s.version>=76){const{sdpSemantics:_}=this.getConfiguration();_==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp=="undefined"?null:this._sctp},enumerable:!0,configurable:!0})}if(d(arguments[0])){const _=c(arguments[0]),E=l(_),O=h(arguments[0],_);let P;E===0&&O===0?P=Number.POSITIVE_INFINITY:E===0||O===0?P=Math.max(E,O):P=Math.min(E,O);const C={};Object.defineProperty(C,"maxMessageSize",{get(){return P}}),this._sctp=C}return p.apply(this,arguments)}}function shimSendThrowTypeError(a){if(!(a.RTCPeerConnection&&"createDataChannel"in a.RTCPeerConnection.prototype))return;function s(c,l){const h=c.send;c.send=function(){const y=arguments[0],_=y.length||y.size||y.byteLength;if(c.readyState==="open"&&l.sctp&&_>l.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+l.sctp.maxMessageSize+" bytes)");return h.apply(c,arguments)}}const d=a.RTCPeerConnection.prototype.createDataChannel;a.RTCPeerConnection.prototype.createDataChannel=function(){const l=d.apply(this,arguments);return s(l,this),l},wrapPeerConnectionEvent(a,"datachannel",c=>(s(c.channel,c.target),c))}function shimConnectionState(a){if(!a.RTCPeerConnection||"connectionState"in a.RTCPeerConnection.prototype)return;const s=a.RTCPeerConnection.prototype;Object.defineProperty(s,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(s,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(d){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),d&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=d)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(d=>{const c=s[d];s[d]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=l=>{const h=l.target;if(h._lastConnectionState!==h.connectionState){h._lastConnectionState=h.connectionState;const p=new Event("connectionstatechange",l);h.dispatchEvent(p)}return l},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),c.apply(this,arguments)}})}function removeExtmapAllowMixed(a,s){if(!a.RTCPeerConnection||s.browser==="chrome"&&s.version>=71||s.browser==="safari"&&s.version>=605)return;const d=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(l){if(l&&l.sdp&&l.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const h=l.sdp.split(`
`).filter(p=>p.trim()!=="a=extmap-allow-mixed").join(`
`);a.RTCSessionDescription&&l instanceof a.RTCSessionDescription?arguments[0]=new a.RTCSessionDescription({type:l.type,sdp:h}):l.sdp=h}return d.apply(this,arguments)}}function shimAddIceCandidateNullOrEmpty(a,s){if(!(a.RTCPeerConnection&&a.RTCPeerConnection.prototype))return;const d=a.RTCPeerConnection.prototype.addIceCandidate;!d||d.length===0||(a.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(s.browser==="chrome"&&s.version<78||s.browser==="firefox"&&s.version<68||s.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():d.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function shimParameterlessSetLocalDescription(a,s){if(!(a.RTCPeerConnection&&a.RTCPeerConnection.prototype))return;const d=a.RTCPeerConnection.prototype.setLocalDescription;!d||d.length===0||(a.RTCPeerConnection.prototype.setLocalDescription=function(){let l=arguments[0]||{};if(typeof l!="object"||l.type&&l.sdp)return d.apply(this,arguments);if(l={type:l.type,sdp:l.sdp},!l.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":l.type="offer";break;default:l.type="answer";break}return l.sdp||l.type!=="offer"&&l.type!=="answer"?d.apply(this,[l]):(l.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(p=>d.apply(this,[p]))})}var commonShim=Object.freeze(Object.defineProperty({__proto__:null,shimRTCIceCandidate,shimMaxMessageSize,shimSendThrowTypeError,shimConnectionState,removeExtmapAllowMixed,shimAddIceCandidateNullOrEmpty,shimParameterlessSetLocalDescription},Symbol.toStringTag,{value:"Module"}));function adapterFactory({window:a}={},s={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const d=log,c=detectBrowser(a),l={browserDetails:c,commonShim,extractVersion,disableLog,disableWarnings,sdp};switch(c.browser){case"chrome":if(!chromeShim||!shimPeerConnection$1||!s.shimChrome)return d("Chrome shim is not included in this adapter release."),l;if(c.version===null)return d("Chrome shim can not determine version, not shimming."),l;d("adapter.js shimming chrome."),l.browserShim=chromeShim,shimAddIceCandidateNullOrEmpty(a,c),shimParameterlessSetLocalDescription(a),shimGetUserMedia$2(a,c),shimMediaStream(a),shimPeerConnection$1(a,c),shimOnTrack$1(a),shimAddTrackRemoveTrack(a,c),shimGetSendersWithDtmf(a),shimGetStats(a),shimSenderReceiverGetStats(a),fixNegotiationNeeded(a,c),shimRTCIceCandidate(a),shimConnectionState(a),shimMaxMessageSize(a,c),shimSendThrowTypeError(a),removeExtmapAllowMixed(a,c);break;case"firefox":if(!firefoxShim||!shimPeerConnection||!s.shimFirefox)return d("Firefox shim is not included in this adapter release."),l;d("adapter.js shimming firefox."),l.browserShim=firefoxShim,shimAddIceCandidateNullOrEmpty(a,c),shimParameterlessSetLocalDescription(a),shimGetUserMedia$1(a,c),shimPeerConnection(a,c),shimOnTrack(a),shimRemoveStream(a),shimSenderGetStats(a),shimReceiverGetStats(a),shimRTCDataChannel(a),shimAddTransceiver(a),shimGetParameters(a),shimCreateOffer(a),shimCreateAnswer(a),shimRTCIceCandidate(a),shimConnectionState(a),shimMaxMessageSize(a,c),shimSendThrowTypeError(a);break;case"safari":if(!safariShim||!s.shimSafari)return d("Safari shim is not included in this adapter release."),l;d("adapter.js shimming safari."),l.browserShim=safariShim,shimAddIceCandidateNullOrEmpty(a,c),shimParameterlessSetLocalDescription(a),shimRTCIceServerUrls(a),shimCreateOfferLegacy(a),shimCallbacksAPI(a),shimLocalStreamsAPI(a),shimRemoteStreamsAPI(a),shimTrackEventTransceiver(a),shimGetUserMedia(a),shimAudioContext(a),shimRTCIceCandidate(a),shimMaxMessageSize(a,c),shimSendThrowTypeError(a),removeExtmapAllowMixed(a,c);break;default:d("Unsupported browser!");break}return l}adapterFactory({window:typeof window=="undefined"?void 0:window});var __awaiter$3=commonjsGlobal&&commonjsGlobal.__awaiter||function(a,s,d,c){function l(h){return h instanceof d?h:new d(function(p){p(h)})}return new(d||(d=Promise))(function(h,p){function y(O){try{E(c.next(O))}catch(P){p(P)}}function _(O){try{E(c.throw(O))}catch(P){p(P)}}function E(O){O.done?h(O.value):l(O.value).then(y,_)}E((c=c.apply(a,s||[])).next())})},__importDefault$3=commonjsGlobal&&commonjsGlobal.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(SignalClient$1,"__esModule",{value:!0}),SignalClient$1.toProtoSessionDescription=SignalClient$1.SignalClient=void 0;const logger_1$1=__importDefault$3(logger),livekit_rtc_1=livekit_rtc,errors_1$1=errors,utils_1$1=utils$f;class SignalClient{constructor(s=!1){this.isConnected=!1,this.useJSON=s}join(s,d,c){return __awaiter$3(this,void 0,void 0,function*(){return yield this.connect(s,d,{autoSubscribe:c==null?void 0:c.autoSubscribe})})}reconnect(s,d){return __awaiter$3(this,void 0,void 0,function*(){yield this.connect(s,d,{reconnect:!0})})}connect(s,d,c){s.startsWith("http")&&(s=s.replace("http","ws")),s=s.replace(/\/$/,""),s+="/rtc";const l=utils_1$1.getClientInfo(),h=createConnectionParams(d,l,c);return new Promise((p,y)=>{logger_1$1.default.debug("connecting to",s+h),this.ws=void 0;const _=new WebSocket(s+h);_.binaryType="arraybuffer",_.onerror=E=>__awaiter$3(this,void 0,void 0,function*(){if(!this.ws){try{const O=yield fetch(`http${s.substring(2)}/validate${h}`);if(O.ok)y(new errors_1$1.ConnectionError("Internal error"));else{const P=yield O.text();y(new errors_1$1.ConnectionError(P))}}catch{y(new errors_1$1.ConnectionError("server was not reachable"))}return}this.handleWSError(E)}),_.onopen=()=>{this.ws=_,c.reconnect&&(this.isConnected=!0,p())},_.onmessage=E=>__awaiter$3(this,void 0,void 0,function*(){let O;if(typeof E.data=="string"){const P=JSON.parse(E.data);O=livekit_rtc_1.SignalResponse.fromJSON(P)}else if(E.data instanceof ArrayBuffer)O=livekit_rtc_1.SignalResponse.decode(new Uint8Array(E.data));else{logger_1$1.default.error("could not decode websocket message",typeof E.data);return}if(!this.isConnected){O.join?(this.isConnected=!0,p(O.join)):y(new errors_1$1.ConnectionError("did not receive join response"));return}this.signalLatency&&(yield utils_1$1.sleep(this.signalLatency)),this.handleSignalResponse(O)}),_.onclose=E=>{!this.isConnected||(logger_1$1.default.debug("websocket connection closed",E.reason),this.isConnected=!1,this.onClose&&this.onClose(E.reason),this.ws===_&&(this.ws=void 0))}})}close(){var s;this.isConnected=!1,this.ws&&(this.ws.onclose=null),(s=this.ws)===null||s===void 0||s.close(),this.ws=void 0}sendOffer(s){logger_1$1.default.debug("sending offer",s),this.sendRequest({offer:toProtoSessionDescription(s)})}sendAnswer(s){logger_1$1.default.debug("sending answer"),this.sendRequest({answer:toProtoSessionDescription(s)})}sendIceCandidate(s,d){logger_1$1.default.trace("sending ice candidate",s),this.sendRequest({trickle:{candidateInit:JSON.stringify(s),target:d}})}sendMuteTrack(s,d){this.sendRequest({mute:{sid:s,muted:d}})}sendAddTrack(s){this.sendRequest({addTrack:livekit_rtc_1.AddTrackRequest.fromPartial(s)})}sendUpdateTrackSettings(s){this.sendRequest({trackSetting:s})}sendUpdateSubscription(s){this.sendRequest({subscription:s})}sendSyncState(s){this.sendRequest({syncState:s})}sendUpdateVideoLayers(s,d){this.sendRequest({updateLayers:{trackSid:s,layers:d}})}sendUpdateSubscriptionPermissions(s,d){this.sendRequest({subscriptionPermissions:{allParticipants:s,trackPermissions:d}})}sendSimulateScenario(s){this.sendRequest({simulate:s})}sendLeave(){this.sendRequest(livekit_rtc_1.SignalRequest.fromPartial({leave:{}}))}sendRequest(s){return __awaiter$3(this,void 0,void 0,function*(){if(this.signalLatency&&(yield utils_1$1.sleep(this.signalLatency)),!this.ws){logger_1$1.default.error("cannot send signal request before connected");return}try{this.useJSON?this.ws.send(JSON.stringify(livekit_rtc_1.SignalRequest.toJSON(s))):this.ws.send(livekit_rtc_1.SignalRequest.encode(s).finish())}catch(d){logger_1$1.default.error("error sending signal message",d)}})}handleSignalResponse(s){if(s.answer){const d=fromProtoSessionDescription(s.answer);this.onAnswer&&this.onAnswer(d)}else if(s.offer){const d=fromProtoSessionDescription(s.offer);this.onOffer&&this.onOffer(d)}else if(s.trickle){const d=JSON.parse(s.trickle.candidateInit);this.onTrickle&&this.onTrickle(d,s.trickle.target)}else s.update?this.onParticipantUpdate&&this.onParticipantUpdate(s.update.participants):s.trackPublished?this.onLocalTrackPublished&&this.onLocalTrackPublished(s.trackPublished):s.speakersChanged?this.onSpeakersChanged&&this.onSpeakersChanged(s.speakersChanged.speakers):s.leave?this.onLeave&&this.onLeave():s.mute?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(s.mute.sid,s.mute.muted):s.roomUpdate?this.onRoomUpdate&&this.onRoomUpdate(s.roomUpdate.room):s.connectionQuality?this.onConnectionQuality&&this.onConnectionQuality(s.connectionQuality):s.streamStateUpdate?this.onStreamStateUpdate&&this.onStreamStateUpdate(s.streamStateUpdate):s.subscribedQualityUpdate?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(s.subscribedQualityUpdate):s.subscriptionPermissionUpdate?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(s.subscriptionPermissionUpdate):logger_1$1.default.debug("unsupported message",s)}handleWSError(s){logger_1$1.default.error("websocket error",s)}}SignalClient$1.SignalClient=SignalClient;function fromProtoSessionDescription(a){const s={type:"offer",sdp:a.sdp};switch(a.type){case"answer":case"offer":case"pranswer":case"rollback":s.type=a.type;break}return s}function toProtoSessionDescription(a){return{sdp:a.sdp,type:a.type}}SignalClient$1.toProtoSessionDescription=toProtoSessionDescription;function createConnectionParams(a,s,d){const c=new URLSearchParams;return c.set("access_token",a),d!=null&&d.reconnect&&c.set("reconnect","1"),(d==null?void 0:d.autoSubscribe)!==void 0&&c.set("auto_subscribe",d.autoSubscribe?"1":"0"),c.set("sdk","js"),c.set("version",s.version),c.set("protocol",s.protocol.toString()),s.deviceModel&&c.set("device_model",s.deviceModel),s.os&&c.set("os",s.os),s.osVersion&&c.set("os_version",s.osVersion),s.browser&&c.set("browser",s.browser),s.browserVersion&&c.set("browser_version",s.browserVersion),`?${c.toString()}`}var RTCEngine={},PCTransport$1={},__awaiter$2=commonjsGlobal&&commonjsGlobal.__awaiter||function(a,s,d,c){function l(h){return h instanceof d?h:new d(function(p){p(h)})}return new(d||(d=Promise))(function(h,p){function y(O){try{E(c.next(O))}catch(P){p(P)}}function _(O){try{E(c.throw(O))}catch(P){p(P)}}function E(O){O.done?h(O.value):l(O.value).then(y,_)}E((c=c.apply(a,s||[])).next())})},__importDefault$2=commonjsGlobal&&commonjsGlobal.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(PCTransport$1,"__esModule",{value:!0});const ts_debounce_1=require$$0$1,logger_1=__importDefault$2(logger);class PCTransport{constructor(s){this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.negotiate=ts_debounce_1.debounce(()=>{this.createAndSendOffer()},100),this.pc=new RTCPeerConnection(s)}get isICEConnected(){return this.pc.iceConnectionState==="connected"||this.pc.iceConnectionState==="completed"}addIceCandidate(s){return __awaiter$2(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(s);this.pendingCandidates.push(s)})}setRemoteDescription(s){return __awaiter$2(this,void 0,void 0,function*(){yield this.pc.setRemoteDescription(s),this.pendingCandidates.forEach(d=>{this.pc.addIceCandidate(d)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate&&(this.renegotiate=!1,this.createAndSendOffer())})}createAndSendOffer(s){return __awaiter$2(this,void 0,void 0,function*(){if(this.onOffer===void 0)return;if(s!=null&&s.iceRestart&&(logger_1.default.debug("restarting ICE"),this.restartingIce=!0),this.pc.signalingState==="have-local-offer"){const c=this.pc.remoteDescription;if((s==null?void 0:s.iceRestart)&&c)yield this.pc.setRemoteDescription(c);else{this.renegotiate=!0;return}}else if(this.pc.signalingState==="closed"){logger_1.default.warn("could not createOffer with closed peer connection");return}logger_1.default.debug("starting to negotiate");const d=yield this.pc.createOffer(s);yield this.pc.setLocalDescription(d),this.onOffer(d)})}close(){this.pc.close()}}PCTransport$1.default=PCTransport,function(a){var s=commonjsGlobal&&commonjsGlobal.__awaiter||function(j,T,D,J){function ee(z){return z instanceof D?z:new D(function(ne){ne(z)})}return new(D||(D=Promise))(function(z,ne){function X(te){try{K(J.next(te))}catch(L){ne(L)}}function M(te){try{K(J.throw(te))}catch(L){ne(L)}}function K(te){te.done?z(te.value):ee(te.value).then(X,M)}K((J=J.apply(j,T||[])).next())})},d=commonjsGlobal&&commonjsGlobal.__importDefault||function(j){return j&&j.__esModule?j:{default:j}};Object.defineProperty(a,"__esModule",{value:!0}),a.maxICEConnectTimeout=void 0;const c=events.exports,l=SignalClient$1,h=d(logger),p=livekit_models$1,y=livekit_rtc,_=errors,E=events$1,O=d(PCTransport$1),P=utils$f,C="_lossy",A="_reliable",q=5;a.maxICEConnectTimeout=5*1e3;class U extends c.EventEmitter{constructor(){super(),this.rtcConfig={},this.subscriberPrimary=!1,this.iceConnected=!1,this.isClosed=!0,this.pendingTrackResolvers={},this.hasPublished=!1,this.reconnectAttempts=0,this.handleDataChannel=({channel:T})=>s(this,void 0,void 0,function*(){if(!!T){if(T.label===A)this.reliableDCSub=T;else if(T.label===C)this.lossyDCSub=T;else return;T.onmessage=this.handleDataMessage}}),this.handleDataMessage=T=>s(this,void 0,void 0,function*(){let D;if(T.data instanceof ArrayBuffer)D=T.data;else if(T.data instanceof Blob)D=yield T.data.arrayBuffer();else{h.default.error("unsupported data type",T.data);return}const J=p.DataPacket.decode(new Uint8Array(D));J.speaker?this.emit(E.EngineEvent.ActiveSpeakersUpdate,J.speaker.speakers):J.user&&this.emit(E.EngineEvent.DataPacketReceived,J.user,J.kind)}),this.handleDisconnect=T=>{if(this.isClosed)return;if(h.default.debug(`${T} disconnected`),this.reconnectAttempts>=q){h.default.info("could not connect to signal after",q,"attempts. giving up"),this.emit(E.EngineEvent.Disconnected),this.close();return}const D=this.reconnectAttempts*this.reconnectAttempts*300;setTimeout(()=>{this.reconnect().then(()=>{this.reconnectAttempts=0}).catch(this.handleDisconnect)},D)},this.client=new l.SignalClient}join(T,D,J){return s(this,void 0,void 0,function*(){this.url=T,this.token=D;const ee=yield this.client.join(T,D,J);return this.emit(E.EngineEvent.SignalConnected),this.isClosed=!1,this.subscriberPrimary=ee.subscriberPrimary,this.publisher||this.configure(ee),this.subscriberPrimary||this.negotiate(),ee})}close(){this.isClosed=!0,this.removeAllListeners(),this.publisher&&this.publisher.pc.signalingState!=="closed"&&(this.publisher.pc.getSenders().forEach(T=>{var D;try{(D=this.publisher)===null||D===void 0||D.pc.removeTrack(T)}catch(J){h.default.warn("could not removeTrack",J)}}),this.publisher.close(),this.publisher=void 0),this.subscriber&&(this.subscriber.close(),this.subscriber=void 0),this.client.close()}addTrack(T){if(this.pendingTrackResolvers[T.cid])throw new _.TrackInvalidError("a track with the same ID has already been published");return new Promise(D=>{this.pendingTrackResolvers[T.cid]=D,this.client.sendAddTrack(T)})}updateMuteStatus(T,D){this.client.sendMuteTrack(T,D)}get dataSubscriberReadyState(){var T;return(T=this.reliableDCSub)===null||T===void 0?void 0:T.readyState}get connectedServerAddress(){return this.connectedServerAddr}configure(T){if(this.publisher||this.subscriber)return;if(T.iceServers&&!this.rtcConfig.iceServers){const J=[];T.iceServers.forEach(ee=>{const z={urls:ee.urls};ee.username&&(z.username=ee.username),ee.credential&&(z.credential=ee.credential),J.push(z)}),this.rtcConfig.iceServers=J}this.publisher=new O.default(this.rtcConfig),this.subscriber=new O.default(this.rtcConfig),this.publisher.pc.onicecandidate=J=>{!J.candidate||(h.default.trace("adding ICE candidate for peer",J.candidate),this.client.sendIceCandidate(J.candidate,y.SignalTarget.PUBLISHER))},this.subscriber.pc.onicecandidate=J=>{!J.candidate||this.client.sendIceCandidate(J.candidate,y.SignalTarget.SUBSCRIBER)},this.publisher.onOffer=J=>{this.client.sendOffer(J)};let D=this.publisher.pc;T.subscriberPrimary&&(D=this.subscriber.pc,this.subscriber.pc.ondatachannel=this.handleDataChannel),D.oniceconnectionstatechange=()=>{D.iceConnectionState==="connected"?(h.default.trace("ICE connected"),this.iceConnected||(this.iceConnected=!0,this.emit(E.EngineEvent.Connected)),F(D).then(J=>{this.connectedServerAddr=J})):D.iceConnectionState==="failed"&&(h.default.trace("ICE disconnected"),this.iceConnected&&(this.iceConnected=!1,this.handleDisconnect("peerconnection")))},this.subscriber.pc.ontrack=J=>{this.emit(E.EngineEvent.MediaTrackAdded,J.track,J.streams[0],J.receiver)},this.lossyDC=this.publisher.pc.createDataChannel(C,{ordered:!0,maxRetransmits:0}),this.reliableDC=this.publisher.pc.createDataChannel(A,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.client.onAnswer=J=>s(this,void 0,void 0,function*(){!this.publisher||(h.default.debug("received server answer",J.type,this.publisher.pc.signalingState),yield this.publisher.setRemoteDescription(J))}),this.client.onTrickle=(J,ee)=>{!this.publisher||!this.subscriber||(h.default.trace("got ICE candidate from peer",J,ee),ee===y.SignalTarget.PUBLISHER?this.publisher.addIceCandidate(J):this.subscriber.addIceCandidate(J))},this.client.onOffer=J=>s(this,void 0,void 0,function*(){if(!this.subscriber)return;h.default.debug("received server offer",J.type,this.subscriber.pc.signalingState),yield this.subscriber.setRemoteDescription(J);const ee=yield this.subscriber.pc.createAnswer();yield this.subscriber.pc.setLocalDescription(ee),this.client.sendAnswer(ee)}),this.client.onLocalTrackPublished=J=>{h.default.debug("received trackPublishedResponse",J);const ee=this.pendingTrackResolvers[J.cid];if(!ee){h.default.error("missing track resolver for ",J.cid);return}delete this.pendingTrackResolvers[J.cid],ee(J.track)},this.client.onClose=()=>{this.handleDisconnect("signal")},this.client.onLeave=()=>{this.emit(E.EngineEvent.Disconnected),this.close()}}reconnect(){return s(this,void 0,void 0,function*(){if(this.isClosed)return;if(!this.url||!this.token)throw new _.ConnectionError("could not reconnect, url or token not saved");if(h.default.info("reconnecting to signal connection, attempt",this.reconnectAttempts),this.reconnectAttempts===0&&this.emit(E.EngineEvent.Reconnecting),this.reconnectAttempts+=1,yield this.client.reconnect(this.url,this.token),this.emit(E.EngineEvent.SignalConnected),!this.publisher||!this.subscriber)throw new _.UnexpectedConnectionState("publisher and subscriber connections unset");this.subscriber.restartingIce=!0,this.hasPublished&&(yield this.publisher.createAndSendOffer({iceRestart:!0}));const T=new Date().getTime();for(;new Date().getTime()-T<a.maxICEConnectTimeout*2;){if(this.iceConnected){this.emit(E.EngineEvent.Reconnected);return}yield P.sleep(100)}throw new _.ConnectionError("could not establish ICE connection")})}sendDataPacket(T,D){return s(this,void 0,void 0,function*(){const J=p.DataPacket.encode(T).finish();yield this.ensurePublisherConnected(D),D===p.DataPacket_Kind.LOSSY&&this.lossyDC?this.lossyDC.send(J):D===p.DataPacket_Kind.RELIABLE&&this.reliableDC&&this.reliableDC.send(J)})}ensurePublisherConnected(T){var D,J;return s(this,void 0,void 0,function*(){if(!this.subscriberPrimary)return;if(!this.publisher)throw new _.ConnectionError("publisher connection not set");!this.publisher.isICEConnected&&this.publisher.pc.iceConnectionState!=="checking"&&this.negotiate();const ee=this.dataChannelForKind(T);if((ee==null?void 0:ee.readyState)==="open")return;const z=new Date().getTime()+a.maxICEConnectTimeout;for(;new Date().getTime()<z;){if(this.publisher.isICEConnected&&((D=this.dataChannelForKind(T))===null||D===void 0?void 0:D.readyState)==="open")return;yield P.sleep(50)}throw new _.ConnectionError(`could not establish publisher connection, state ${(J=this.publisher)===null||J===void 0?void 0:J.pc.iceConnectionState}`)})}negotiate(){!this.publisher||(this.hasPublished=!0,this.publisher.negotiate())}dataChannelForKind(T){if(T===p.DataPacket_Kind.LOSSY)return this.lossyDC;if(T===p.DataPacket_Kind.RELIABLE)return this.reliableDC}}a.default=U;function F(j){var T;return s(this,void 0,void 0,function*(){let D="";const J=new Map,ee=new Map;if((yield j.getStats()).forEach(X=>{switch(X.type){case"transport":D=X.selectedCandidatePairId;break;case"candidate-pair":D===""&&X.selected&&(D=X.id),J.set(X.id,X);break;case"remote-candidate":ee.set(X.id,`${X.address}:${X.port}`);break}}),D==="")return;const ne=(T=J.get(D))===null||T===void 0?void 0:T.remoteCandidateId;if(ne!==void 0)return ee.get(ne)})}}(RTCEngine);var defaults$4={};Object.defineProperty(defaults$4,"__esModule",{value:!0}),defaults$4.videoDefaults=defaults$4.audioDefaults=defaults$4.publishDefaults=void 0;const options_1$1=options$1;defaults$4.publishDefaults={audioBitrate:options_1$1.AudioPresets.speech.maxBitrate,dtx:!0,simulcast:!0,screenShareEncoding:options_1$1.ScreenSharePresets.hd_15.encoding,stopMicTrackOnMute:!1},defaults$4.audioDefaults={autoGainControl:!0,channelCount:1,echoCancellation:!0,noiseSuppression:!0},defaults$4.videoDefaults={resolution:options_1$1.VideoPresets.qhd.resolution},function(a){var s=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(z,ne,X,M){M===void 0&&(M=X),Object.defineProperty(z,M,{enumerable:!0,get:function(){return ne[X]}})}:function(z,ne,X,M){M===void 0&&(M=X),z[M]=ne[X]}),d=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(z,ne){Object.defineProperty(z,"default",{enumerable:!0,value:ne})}:function(z,ne){z.default=ne}),c=commonjsGlobal&&commonjsGlobal.__importStar||function(z){if(z&&z.__esModule)return z;var ne={};if(z!=null)for(var X in z)X!=="default"&&Object.prototype.hasOwnProperty.call(z,X)&&s(ne,z,X);return d(ne,z),ne},l=commonjsGlobal&&commonjsGlobal.__awaiter||function(z,ne,X,M){function K(te){return te instanceof X?te:new X(function(L){L(te)})}return new(X||(X=Promise))(function(te,L){function G(x){try{ie(M.next(x))}catch(Y){L(Y)}}function W(x){try{ie(M.throw(x))}catch(Y){L(Y)}}function ie(x){x.done?te(x.value):K(x.value).then(G,W)}ie((M=M.apply(z,ne||[])).next())})},h=commonjsGlobal&&commonjsGlobal.__importDefault||function(z){return z&&z.__esModule?z:{default:z}};Object.defineProperty(a,"__esModule",{value:!0}),a.RoomState=void 0;const p=events.exports,y=SignalClient$1,_=h(logger),E=livekit_models$1,O=livekit_rtc,P=h(DeviceManager$1),C=errors,A=events$1,q=h(LocalParticipant$1),U=h(RemoteParticipant$1),F=c(RTCEngine),j=defaults$4,T=Track,D=utils$f;var J;(function(z){z.Disconnected="disconnected",z.Connected="connected",z.Reconnecting="reconnecting"})(J=a.RoomState||(a.RoomState={}));class ee extends p.EventEmitter{constructor(ne){super(),this.state=J.Disconnected,this.activeSpeakers=[],this.sid="",this.name="",this.metadata=void 0,this.audioEnabled=!0,this.connect=(X,M,K)=>l(this,void 0,void 0,function*(){if(this.state!==J.Disconnected){_.default.warn("already connected to room",this.name);return}this.createEngine(),this.acquireAudioContext(),K!=null&&K.rtcConfig&&(this.engine.rtcConfig=K.rtcConfig),this.connOptions=K;try{const te=yield this.engine.join(X,M,K);if(_.default.debug("connected to Livekit Server",te.serverVersion),!te.serverVersion)throw new C.UnsupportedServer("unknown server version");te.serverVersion==="0.15.1"&&this.options.dynacast&&(_.default.debug("disabling dynacast due to server version"),this.options.dynacast=!1),this.state=J.Connected;const L=te.participant;this.localParticipant=new q.default(L.sid,L.identity,this.engine,this.options),this.localParticipant.updateInfo(L),this.localParticipant.on(A.ParticipantEvent.MetadataChanged,G=>{this.emit(A.RoomEvent.MetadataChanged,G,this.localParticipant)}).on(A.ParticipantEvent.ParticipantMetadataChanged,G=>{this.emit(A.RoomEvent.ParticipantMetadataChanged,G,this.localParticipant)}).on(A.ParticipantEvent.TrackMuted,G=>{this.emit(A.RoomEvent.TrackMuted,G,this.localParticipant)}).on(A.ParticipantEvent.TrackUnmuted,G=>{this.emit(A.RoomEvent.TrackUnmuted,G,this.localParticipant)}).on(A.ParticipantEvent.LocalTrackPublished,G=>{this.emit(A.RoomEvent.LocalTrackPublished,G,this.localParticipant)}).on(A.ParticipantEvent.LocalTrackUnpublished,G=>{this.emit(A.RoomEvent.LocalTrackUnpublished,G,this.localParticipant)}).on(A.ParticipantEvent.ConnectionQualityChanged,G=>{this.emit(A.RoomEvent.ConnectionQualityChanged,G,this.localParticipant)}).on(A.ParticipantEvent.MediaDevicesError,G=>{this.emit(A.RoomEvent.MediaDevicesError,G)}),te.otherParticipants.forEach(G=>{this.getOrCreateParticipant(G.sid,G)}),this.name=te.room.name,this.sid=te.room.sid,this.metadata=te.room.metadata}catch(te){throw this.engine.close(),te}return new Promise((te,L)=>{const G=setTimeout(()=>{this.engine.close(),L(new C.ConnectionError("could not connect after timeout"))},F.maxICEConnectTimeout);this.engine.once(A.EngineEvent.Connected,()=>{clearTimeout(G),window.addEventListener("beforeunload",this.onBeforeUnload),navigator.mediaDevices.addEventListener("devicechange",this.handleDeviceChange),te(this)})})}),this.disconnect=(X=!0)=>{this.engine&&(this.engine.client.sendLeave(),this.engine.close()),this.handleDisconnect(X),this.engine=void 0},this.onBeforeUnload=()=>{this.disconnect()},this.handleParticipantUpdates=X=>{X.forEach(M=>{if(M.sid===this.localParticipant.sid){this.localParticipant.updateInfo(M);return}let K=this.participants.get(M.sid);const te=!K;K=this.getOrCreateParticipant(M.sid,M),M.state===E.ParticipantInfo_State.DISCONNECTED?this.handleParticipantDisconnected(M.sid,K):te?this.emit(A.RoomEvent.ParticipantConnected,K):K.updateInfo(M)})},this.handleActiveSpeakersUpdate=X=>{const M=[],K={};X.forEach(te=>{if(K[te.sid]=!0,te.sid===this.localParticipant.sid)this.localParticipant.audioLevel=te.level,this.localParticipant.setIsSpeaking(!0),M.push(this.localParticipant);else{const L=this.participants.get(te.sid);L&&(L.audioLevel=te.level,L.setIsSpeaking(!0),M.push(L))}}),K[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.participants.forEach(te=>{K[te.sid]||(te.audioLevel=0,te.setIsSpeaking(!1))}),this.activeSpeakers=M,this.emit(A.RoomEvent.ActiveSpeakersChanged,M)},this.handleSpeakersChanged=X=>{const M=new Map;this.activeSpeakers.forEach(te=>{M.set(te.sid,te)}),X.forEach(te=>{let L=this.participants.get(te.sid);te.sid===this.localParticipant.sid&&(L=this.localParticipant),L&&(L.audioLevel=te.level,L.setIsSpeaking(te.active),te.active?M.set(te.sid,L):M.delete(te.sid))});const K=Array.from(M.values());K.sort((te,L)=>L.audioLevel-te.audioLevel),this.activeSpeakers=K,this.emit(A.RoomEvent.ActiveSpeakersChanged,K)},this.handleStreamStateUpdate=X=>{X.streamStates.forEach(M=>{const K=this.participants.get(M.participantSid);if(!K)return;const te=K.getTrackPublication(M.trackSid);!te||!te.track||(te.track.streamState=T.Track.streamStateFromProto(M.state),K.emit(A.ParticipantEvent.TrackStreamStateChanged,te,te.track.streamState),this.emit(A.ParticipantEvent.TrackStreamStateChanged,te,te.track.streamState,K))})},this.handleSubscriptionPermissionUpdate=X=>{const M=this.participants.get(X.participantSid);if(!M)return;const K=M.getTrackPublication(X.trackSid);!K||(K._allowed=X.allowed,M.emit(A.ParticipantEvent.TrackSubscriptionPermissionChanged,K,K.subscriptionStatus),this.emit(A.ParticipantEvent.TrackSubscriptionPermissionChanged,K,K.subscriptionStatus,M))},this.handleDataPacket=(X,M)=>{const K=this.participants.get(X.participantSid);this.emit(A.RoomEvent.DataReceived,X.payload,K,M),K==null||K.emit(A.ParticipantEvent.DataReceived,X.payload,M)},this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(A.RoomEvent.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=X=>{_.default.warn("could not playback audio",X),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(A.RoomEvent.AudioPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>l(this,void 0,void 0,function*(){this.emit(A.RoomEvent.MediaDevicesChanged)}),this.handleRoomUpdate=X=>{this.metadata=X.metadata,this.emit(A.RoomEvent.RoomMetadataChanged,X.metadata)},this.handleConnectionQualityUpdate=X=>{X.updates.forEach(M=>{if(M.participantSid===this.localParticipant.sid){this.localParticipant.setConnectionQuality(M.quality);return}const K=this.participants.get(M.participantSid);K&&K.setConnectionQuality(M.quality)})},this.participants=new Map,this.options=ne||{},this.options.audioCaptureDefaults=Object.assign(Object.assign({},j.audioDefaults),ne==null?void 0:ne.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},j.videoDefaults),ne==null?void 0:ne.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},j.publishDefaults),ne==null?void 0:ne.publishDefaults),this.createEngine(),this.localParticipant=new q.default("","",this.engine,this.options)}createEngine(){this.engine||(this.engine=new F.default,this.engine.client.signalLatency=this.options.expSignalLatency,this.engine.on(A.EngineEvent.MediaTrackAdded,(ne,X,M)=>{this.onTrackAdded(ne,X,M)}),this.engine.on(A.EngineEvent.Disconnected,()=>{this.handleDisconnect()}),this.engine.client.onParticipantUpdate=this.handleParticipantUpdates,this.engine.client.onRoomUpdate=this.handleRoomUpdate,this.engine.client.onSpeakersChanged=this.handleSpeakersChanged,this.engine.client.onStreamStateUpdate=this.handleStreamStateUpdate,this.engine.client.onSubscriptionPermissionUpdate=this.handleSubscriptionPermissionUpdate,this.engine.on(A.EngineEvent.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate),this.engine.on(A.EngineEvent.DataPacketReceived,this.handleDataPacket),this.engine.on(A.EngineEvent.Reconnecting,()=>{this.state=J.Reconnecting,this.emit(A.RoomEvent.Reconnecting)}),this.engine.on(A.EngineEvent.Reconnected,()=>{this.state=J.Connected,this.emit(A.RoomEvent.Reconnected)}),this.engine.on(A.EngineEvent.SignalConnected,()=>{this.state===J.Reconnecting&&this.sendSyncState()}),this.engine.client.onConnectionQuality=this.handleConnectionQualityUpdate)}static getLocalDevices(ne){return P.default.getInstance().getDevices(ne)}getParticipantByIdentity(ne){for(const[,X]of this.participants)if(X.identity===ne)return X;if(this.localParticipant.identity===ne)return this.localParticipant}simulateScenario(ne){let X;switch(ne){case"speaker":X=O.SimulateScenario.fromPartial({speakerUpdate:3});break;case"node-failure":X=O.SimulateScenario.fromPartial({nodeFailure:!0});break;case"server-leave":X=O.SimulateScenario.fromPartial({serverLeave:!0});break;case"migration":X=O.SimulateScenario.fromPartial({migration:!0});break}X&&this.engine.client.sendSimulateScenario(X)}startAudio(){return l(this,void 0,void 0,function*(){this.acquireAudioContext();const ne=[];this.participants.forEach(X=>{X.audioTracks.forEach(M=>{M.track&&M.track.attachedElements.forEach(K=>{ne.push(K)})})});try{yield Promise.all(ne.map(X=>X.play())),this.handleAudioPlaybackStarted()}catch(X){throw this.handleAudioPlaybackFailed(X),X}})}get canPlaybackAudio(){return this.audioEnabled}switchActiveDevice(ne,X){return l(this,void 0,void 0,function*(){if(ne==="audioinput"){const M=Array.from(this.localParticipant.audioTracks.values()).filter(K=>K.source===T.Track.Source.Microphone);yield Promise.all(M.map(K=>{var te;return(te=K.audioTrack)===null||te===void 0?void 0:te.setDeviceId(X)})),this.options.audioCaptureDefaults.deviceId=X}else if(ne==="videoinput"){const M=Array.from(this.localParticipant.videoTracks.values()).filter(K=>K.source===T.Track.Source.Camera);yield Promise.all(M.map(K=>{var te;return(te=K.videoTrack)===null||te===void 0?void 0:te.setDeviceId(X)})),this.options.videoCaptureDefaults.deviceId=X}else if(ne==="audiooutput"){const M=[];this.participants.forEach(K=>{K.audioTracks.forEach(te=>{te.isSubscribed&&te.track&&te.track.attachedElements.forEach(L=>{M.push(L)})})}),yield Promise.all(M.map(K=>l(this,void 0,void 0,function*(){"setSinkId"in K&&(yield K.setSinkId(X))})))}})}onTrackAdded(ne,X,M){const K=D.unpackStreamId(X.id),te=K[0];let L=K[1];(!L||L==="")&&(L=ne.id),this.getOrCreateParticipant(te).addSubscribedMediaTrack(ne,L,X,M,this.options.adaptiveStream)}handleDisconnect(ne=!0){this.state!==J.Disconnected&&(this.participants.forEach(X=>{X.tracks.forEach(M=>{X.unpublishTrack(M.trackSid)})}),this.localParticipant.tracks.forEach(X=>{var M,K;X.track&&this.localParticipant.unpublishTrack(X.track),ne&&((M=X.track)===null||M===void 0||M.detach(),(K=X.track)===null||K===void 0||K.stop())}),this.participants.clear(),this.activeSpeakers=[],this.audioContext&&(this.audioContext.close(),this.audioContext=void 0),window.removeEventListener("beforeunload",this.onBeforeUnload),navigator.mediaDevices.removeEventListener("devicechange",this.handleDeviceChange),this.state=J.Disconnected,this.emit(A.RoomEvent.Disconnected))}handleParticipantDisconnected(ne,X){this.participants.delete(ne),X&&(X.tracks.forEach(M=>{X.unpublishTrack(M.trackSid)}),this.emit(A.RoomEvent.ParticipantDisconnected,X))}acquireAudioContext(){this.audioContext&&this.audioContext.close();const ne=window.AudioContext||window.webkitAudioContext;ne&&(this.audioContext=new ne)}getOrCreateParticipant(ne,X){let M=this.participants.get(ne);return M||(X?M=U.default.fromParticipantInfo(this.engine.client,X):M=new U.default(this.engine.client,ne,""),this.participants.set(ne,M),M.on(A.ParticipantEvent.TrackPublished,K=>{this.emit(A.RoomEvent.TrackPublished,K,M)}).on(A.ParticipantEvent.TrackSubscribed,(K,te)=>{K.kind===T.Track.Kind.Audio&&(K.on(A.TrackEvent.AudioPlaybackStarted,this.handleAudioPlaybackStarted),K.on(A.TrackEvent.AudioPlaybackFailed,this.handleAudioPlaybackFailed)),this.emit(A.RoomEvent.TrackSubscribed,K,te,M)}).on(A.ParticipantEvent.TrackUnpublished,K=>{this.emit(A.RoomEvent.TrackUnpublished,K,M)}).on(A.ParticipantEvent.TrackUnsubscribed,(K,te)=>{this.emit(A.RoomEvent.TrackUnsubscribed,K,te,M)}).on(A.ParticipantEvent.TrackSubscriptionFailed,K=>{this.emit(A.RoomEvent.TrackSubscriptionFailed,K,M)}).on(A.ParticipantEvent.TrackMuted,K=>{this.emit(A.RoomEvent.TrackMuted,K,M)}).on(A.ParticipantEvent.TrackUnmuted,K=>{this.emit(A.RoomEvent.TrackUnmuted,K,M)}).on(A.ParticipantEvent.MetadataChanged,K=>{this.emit(A.RoomEvent.MetadataChanged,K,M)}).on(A.ParticipantEvent.ParticipantMetadataChanged,K=>{this.emit(A.RoomEvent.ParticipantMetadataChanged,K,M)}).on(A.ParticipantEvent.ConnectionQualityChanged,K=>{this.emit(A.RoomEvent.ConnectionQualityChanged,K,M)})),M}sendSyncState(){var ne;if(this.engine.subscriber===void 0||this.engine.subscriber.pc.localDescription===null)return;const X=this.engine.subscriber.pc.localDescription,M=((ne=this.connOptions)===null||ne===void 0?void 0:ne.autoSubscribe)||!1,K=new Array;this.participants.forEach(te=>{te.tracks.forEach(L=>{L.isSubscribed!==M&&K.push(L.trackSid)})}),this.engine.client.sendSyncState({answer:y.toProtoSessionDescription({sdp:X.sdp,type:X.type}),subscription:{trackSids:K,subscribe:!M,participantTracks:[]},publishTracks:this.localParticipant.publishedTracksInfo()})}emit(ne,...X){return _.default.debug("room event",ne,...X),super.emit(ne,...X)}}a.default=ee}(Room);var connect={};(function(a){var s=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(C,A,q,U){U===void 0&&(U=q),Object.defineProperty(C,U,{enumerable:!0,get:function(){return A[q]}})}:function(C,A,q,U){U===void 0&&(U=q),C[U]=A[q]}),d=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(C,A){Object.defineProperty(C,"default",{enumerable:!0,value:A})}:function(C,A){C.default=A}),c=commonjsGlobal&&commonjsGlobal.__importStar||function(C){if(C&&C.__esModule)return C;var A={};if(C!=null)for(var q in C)q!=="default"&&Object.prototype.hasOwnProperty.call(C,q)&&s(A,C,q);return d(A,C),A},l=commonjsGlobal&&commonjsGlobal.__awaiter||function(C,A,q,U){function F(j){return j instanceof q?j:new q(function(T){T(j)})}return new(q||(q=Promise))(function(j,T){function D(z){try{ee(U.next(z))}catch(ne){T(ne)}}function J(z){try{ee(U.throw(z))}catch(ne){T(ne)}}function ee(z){z.done?j(z.value):F(z.value).then(D,J)}ee((U=U.apply(C,A||[])).next())})},h=commonjsGlobal&&commonjsGlobal.__importDefault||function(C){return C&&C.__esModule?C:{default:C}};Object.defineProperty(a,"__esModule",{value:!0}),a.connect=a.version=void 0;const p=c(logger),y=errors,_=events$1,E=h(Room);var O=version$1;Object.defineProperty(a,"version",{enumerable:!0,get:function(){return O.version}});function P(C,A,q){var U,F,j,T;return l(this,void 0,void 0,function*(){q!=null||(q={}),q.adaptiveStream===void 0&&(q.adaptiveStream=q.autoManageVideo),p.setLogLevel((U=q.logLevel)!==null&&U!==void 0?U:p.LogLevel.warn);const D=(F=q.rtcConfig)!==null&&F!==void 0?F:{};q.iceServers&&(D.iceServers=q.iceServers);const J=new E.default(q);yield J.connect(C,A,q);const ee=(j=q.audio)!==null&&j!==void 0?j:!1,z=(T=q.video)!==null&&T!==void 0?T:!1;return(ee||z)&&setTimeout(()=>l(this,void 0,void 0,function*(){let ne;if(ee&&z)try{yield J.localParticipant.enableCameraAndMicrophone()}catch(X){const M=y.MediaDeviceFailure.getFailure(X);if(p.default.warn("received error while creating media",M),X instanceof Error&&p.default.warn(X.message),M===y.MediaDeviceFailure.NotFound||M===y.MediaDeviceFailure.DeviceInUse)try{yield J.localParticipant.setMicrophoneEnabled(!0)}catch(K){ne=K}else ne=X}else if(ee)try{yield J.localParticipant.setMicrophoneEnabled(!0)}catch(X){ne=X}else if(z)try{yield J.localParticipant.setCameraEnabled(!0)}catch(X){ne=X}ne&&(J.emit(_.RoomEvent.MediaDevicesError,ne),p.default.error("could not create media",ne))})),J})}a.connect=P})(connect);var options={};Object.defineProperty(options,"__esModule",{value:!0});var create$2={},__awaiter$1=commonjsGlobal&&commonjsGlobal.__awaiter||function(a,s,d,c){function l(h){return h instanceof d?h:new d(function(p){p(h)})}return new(d||(d=Promise))(function(h,p){function y(O){try{E(c.next(O))}catch(P){p(P)}}function _(O){try{E(c.throw(O))}catch(P){p(P)}}function E(O){O.done?h(O.value):l(O.value).then(y,_)}E((c=c.apply(a,s||[])).next())})},__importDefault$1=commonjsGlobal&&commonjsGlobal.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(create$2,"__esModule",{value:!0}),create$2.createLocalScreenTracks=create$2.createLocalAudioTrack=create$2.createLocalVideoTrack=create$2.createLocalTracks=void 0;const errors_1=errors,publishUtils_1=publishUtils,defaults_1$1=defaults$4,LocalAudioTrack_1=__importDefault$1(LocalAudioTrack$1),LocalVideoTrack_1=__importDefault$1(LocalVideoTrack$1),options_1=options$1,Track_1=Track,utils_1=utils$e;function createLocalTracks(a){var s,d;return __awaiter$1(this,void 0,void 0,function*(){a!=null||(a={}),(s=a.audio)!==null&&s!==void 0||(a.audio=!0),(d=a.video)!==null&&d!==void 0||(a.video=!0);const c=utils_1.mergeDefaultOptions(a,defaults_1$1.audioDefaults,defaults_1$1.videoDefaults),l=utils_1.constraintsForOptions(c);return(yield navigator.mediaDevices.getUserMedia(l)).getTracks().map(p=>{const y=p.kind==="audio";y?a.audio:a.video;let _;const E=y?l.audio:l.video;typeof E!="boolean"&&(_=E);const O=publishUtils_1.mediaTrackToLocalTrack(p,_);return O.kind===Track_1.Track.Kind.Video?O.source=Track_1.Track.Source.Camera:O.kind===Track_1.Track.Kind.Audio&&(O.source=Track_1.Track.Source.Microphone),O})})}create$2.createLocalTracks=createLocalTracks;function createLocalVideoTrack(a){return __awaiter$1(this,void 0,void 0,function*(){return(yield createLocalTracks({audio:!1,video:a}))[0]})}create$2.createLocalVideoTrack=createLocalVideoTrack;function createLocalAudioTrack(a){return __awaiter$1(this,void 0,void 0,function*(){return(yield createLocalTracks({audio:a,video:!1}))[0]})}create$2.createLocalAudioTrack=createLocalAudioTrack;function createLocalScreenTracks(a){var s;return __awaiter$1(this,void 0,void 0,function*(){a===void 0&&(a={}),a.resolution===void 0&&(a.resolution=options_1.VideoPresets.fhd.resolution);let d=!0;a.resolution&&(d={width:a.resolution.width,height:a.resolution.height});const c=yield navigator.mediaDevices.getDisplayMedia({audio:(s=a.audio)!==null&&s!==void 0?s:!1,video:d}),l=c.getVideoTracks();if(l.length===0)throw new errors_1.TrackInvalidError("no video track found");const h=new LocalVideoTrack_1.default(l[0]);h.source=Track_1.Track.Source.ScreenShare;const p=[h];if(c.getAudioTracks().length>0){const y=new LocalAudioTrack_1.default(c.getAudioTracks()[0]);y.source=Track_1.Track.Source.ScreenShareAudio,p.push(y)}return p})}create$2.createLocalScreenTracks=createLocalScreenTracks;var types$1={};Object.defineProperty(types$1,"__esModule",{value:!0}),function(a){var s=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(ee,z,ne,X){X===void 0&&(X=ne),Object.defineProperty(ee,X,{enumerable:!0,get:function(){return z[ne]}})}:function(ee,z,ne,X){X===void 0&&(X=ne),ee[X]=z[ne]}),d=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(ee,z){Object.defineProperty(ee,"default",{enumerable:!0,value:z})}:function(ee,z){ee.default=z}),c=commonjsGlobal&&commonjsGlobal.__importStar||function(ee){if(ee&&ee.__esModule)return ee;var z={};if(ee!=null)for(var ne in ee)ne!=="default"&&Object.prototype.hasOwnProperty.call(ee,ne)&&s(z,ee,ne);return d(z,ee),z},l=commonjsGlobal&&commonjsGlobal.__exportStar||function(ee,z){for(var ne in ee)ne!=="default"&&!Object.prototype.hasOwnProperty.call(z,ne)&&s(z,ee,ne)},h=commonjsGlobal&&commonjsGlobal.__importDefault||function(ee){return ee&&ee.__esModule?ee:{default:ee}};Object.defineProperty(a,"__esModule",{value:!0}),a.VideoQuality=a.TrackPublication=a.RemoteTrackPublication=a.RemoteVideoTrack=a.RemoteAudioTrack=a.RemoteTrack=a.LocalTrackPublication=a.LocalTrack=a.LocalVideoTrack=a.LocalAudioTrack=a.LocalParticipant=a.RemoteParticipant=a.Participant=a.ConnectionQuality=a.DataPacket_Kind=a.RoomState=a.Room=a.setLogLevel=void 0;const p=logger;Object.defineProperty(a,"setLogLevel",{enumerable:!0,get:function(){return p.setLogLevel}});const y=livekit_models$1;Object.defineProperty(a,"DataPacket_Kind",{enumerable:!0,get:function(){return y.DataPacket_Kind}}),Object.defineProperty(a,"VideoQuality",{enumerable:!0,get:function(){return y.VideoQuality}});const _=h(LocalParticipant$1);a.LocalParticipant=_.default;const E=c(Participant);a.Participant=E.default,Object.defineProperty(a,"ConnectionQuality",{enumerable:!0,get:function(){return E.ConnectionQuality}});const O=h(RemoteParticipant$1);a.RemoteParticipant=O.default;const P=c(Room);a.Room=P.default,Object.defineProperty(a,"RoomState",{enumerable:!0,get:function(){return P.RoomState}});const C=h(LocalAudioTrack$1);a.LocalAudioTrack=C.default;const A=h(LocalTrack$1);a.LocalTrack=A.default;const q=h(LocalTrackPublication$1);a.LocalTrackPublication=q.default;const U=h(LocalVideoTrack$1);a.LocalVideoTrack=U.default;const F=h(RemoteAudioTrack$1);a.RemoteAudioTrack=F.default;const j=h(RemoteTrack$1);a.RemoteTrack=j.default;const T=h(RemoteTrackPublication$1);a.RemoteTrackPublication=T.default;const D=h(RemoteVideoTrack$1);a.RemoteVideoTrack=D.default;const J=TrackPublication;Object.defineProperty(a,"TrackPublication",{enumerable:!0,get:function(){return J.TrackPublication}}),l(connect,a),l(options,a),l(errors,a),l(events$1,a),l(create$2,a),l(options$1,a),l(Track,a),l(types$1,a),l(version$1,a)}(dist$1);var dist={},grants={};Object.defineProperty(grants,"__esModule",{value:!0});var livekit_models={};(function(a){var s=commonjsGlobal&&commonjsGlobal.__importDefault||function(v){return v&&v.__esModule?v:{default:v}};Object.defineProperty(a,"__esModule",{value:!0}),a.ParticipantTracks=a.UserPacket=a.SpeakerInfo=a.ActiveSpeakerUpdate=a.DataPacket=a.VideoLayer=a.TrackInfo=a.ParticipantInfo=a.Codec=a.Room=a.dataPacket_KindToJSON=a.dataPacket_KindFromJSON=a.DataPacket_Kind=a.participantInfo_StateToJSON=a.participantInfo_StateFromJSON=a.ParticipantInfo_State=a.connectionQualityToJSON=a.connectionQualityFromJSON=a.ConnectionQuality=a.videoQualityToJSON=a.videoQualityFromJSON=a.VideoQuality=a.trackSourceToJSON=a.trackSourceFromJSON=a.TrackSource=a.trackTypeToJSON=a.trackTypeFromJSON=a.TrackType=a.protobufPackage=void 0;const d=s(umd.exports),c=s(minimal);a.protobufPackage="livekit";var l;(function(v){v[v.AUDIO=0]="AUDIO",v[v.VIDEO=1]="VIDEO",v[v.DATA=2]="DATA",v[v.UNRECOGNIZED=-1]="UNRECOGNIZED"})(l=a.TrackType||(a.TrackType={}));function h(v){switch(v){case 0:case"AUDIO":return l.AUDIO;case 1:case"VIDEO":return l.VIDEO;case 2:case"DATA":return l.DATA;case-1:case"UNRECOGNIZED":default:return l.UNRECOGNIZED}}a.trackTypeFromJSON=h;function p(v){switch(v){case l.AUDIO:return"AUDIO";case l.VIDEO:return"VIDEO";case l.DATA:return"DATA";default:return"UNKNOWN"}}a.trackTypeToJSON=p;var y;(function(v){v[v.UNKNOWN=0]="UNKNOWN",v[v.CAMERA=1]="CAMERA",v[v.MICROPHONE=2]="MICROPHONE",v[v.SCREEN_SHARE=3]="SCREEN_SHARE",v[v.SCREEN_SHARE_AUDIO=4]="SCREEN_SHARE_AUDIO",v[v.UNRECOGNIZED=-1]="UNRECOGNIZED"})(y=a.TrackSource||(a.TrackSource={}));function _(v){switch(v){case 0:case"UNKNOWN":return y.UNKNOWN;case 1:case"CAMERA":return y.CAMERA;case 2:case"MICROPHONE":return y.MICROPHONE;case 3:case"SCREEN_SHARE":return y.SCREEN_SHARE;case 4:case"SCREEN_SHARE_AUDIO":return y.SCREEN_SHARE_AUDIO;case-1:case"UNRECOGNIZED":default:return y.UNRECOGNIZED}}a.trackSourceFromJSON=_;function E(v){switch(v){case y.UNKNOWN:return"UNKNOWN";case y.CAMERA:return"CAMERA";case y.MICROPHONE:return"MICROPHONE";case y.SCREEN_SHARE:return"SCREEN_SHARE";case y.SCREEN_SHARE_AUDIO:return"SCREEN_SHARE_AUDIO";default:return"UNKNOWN"}}a.trackSourceToJSON=E;var O;(function(v){v[v.LOW=0]="LOW",v[v.MEDIUM=1]="MEDIUM",v[v.HIGH=2]="HIGH",v[v.UNRECOGNIZED=-1]="UNRECOGNIZED"})(O=a.VideoQuality||(a.VideoQuality={}));function P(v){switch(v){case 0:case"LOW":return O.LOW;case 1:case"MEDIUM":return O.MEDIUM;case 2:case"HIGH":return O.HIGH;case-1:case"UNRECOGNIZED":default:return O.UNRECOGNIZED}}a.videoQualityFromJSON=P;function C(v){switch(v){case O.LOW:return"LOW";case O.MEDIUM:return"MEDIUM";case O.HIGH:return"HIGH";default:return"UNKNOWN"}}a.videoQualityToJSON=C;var A;(function(v){v[v.POOR=0]="POOR",v[v.GOOD=1]="GOOD",v[v.EXCELLENT=2]="EXCELLENT",v[v.UNRECOGNIZED=-1]="UNRECOGNIZED"})(A=a.ConnectionQuality||(a.ConnectionQuality={}));function q(v){switch(v){case 0:case"POOR":return A.POOR;case 1:case"GOOD":return A.GOOD;case 2:case"EXCELLENT":return A.EXCELLENT;case-1:case"UNRECOGNIZED":default:return A.UNRECOGNIZED}}a.connectionQualityFromJSON=q;function U(v){switch(v){case A.POOR:return"POOR";case A.GOOD:return"GOOD";case A.EXCELLENT:return"EXCELLENT";default:return"UNKNOWN"}}a.connectionQualityToJSON=U;var F;(function(v){v[v.JOINING=0]="JOINING",v[v.JOINED=1]="JOINED",v[v.ACTIVE=2]="ACTIVE",v[v.DISCONNECTED=3]="DISCONNECTED",v[v.UNRECOGNIZED=-1]="UNRECOGNIZED"})(F=a.ParticipantInfo_State||(a.ParticipantInfo_State={}));function j(v){switch(v){case 0:case"JOINING":return F.JOINING;case 1:case"JOINED":return F.JOINED;case 2:case"ACTIVE":return F.ACTIVE;case 3:case"DISCONNECTED":return F.DISCONNECTED;case-1:case"UNRECOGNIZED":default:return F.UNRECOGNIZED}}a.participantInfo_StateFromJSON=j;function T(v){switch(v){case F.JOINING:return"JOINING";case F.JOINED:return"JOINED";case F.ACTIVE:return"ACTIVE";case F.DISCONNECTED:return"DISCONNECTED";default:return"UNKNOWN"}}a.participantInfo_StateToJSON=T;var D;(function(v){v[v.RELIABLE=0]="RELIABLE",v[v.LOSSY=1]="LOSSY",v[v.UNRECOGNIZED=-1]="UNRECOGNIZED"})(D=a.DataPacket_Kind||(a.DataPacket_Kind={}));function J(v){switch(v){case 0:case"RELIABLE":return D.RELIABLE;case 1:case"LOSSY":return D.LOSSY;case-1:case"UNRECOGNIZED":default:return D.UNRECOGNIZED}}a.dataPacket_KindFromJSON=J;function ee(v){switch(v){case D.RELIABLE:return"RELIABLE";case D.LOSSY:return"LOSSY";default:return"UNKNOWN"}}a.dataPacket_KindToJSON=ee;const z={sid:"",name:"",emptyTimeout:0,maxParticipants:0,creationTime:0,turnPassword:"",metadata:"",numParticipants:0,activeRecording:!1};a.Room={encode(v,g=c.default.Writer.create()){v.sid!==""&&g.uint32(10).string(v.sid),v.name!==""&&g.uint32(18).string(v.name),v.emptyTimeout!==0&&g.uint32(24).uint32(v.emptyTimeout),v.maxParticipants!==0&&g.uint32(32).uint32(v.maxParticipants),v.creationTime!==0&&g.uint32(40).int64(v.creationTime),v.turnPassword!==""&&g.uint32(50).string(v.turnPassword);for(const w of v.enabledCodecs)a.Codec.encode(w,g.uint32(58).fork()).ldelim();return v.metadata!==""&&g.uint32(66).string(v.metadata),v.numParticipants!==0&&g.uint32(72).uint32(v.numParticipants),v.activeRecording===!0&&g.uint32(80).bool(v.activeRecording),g},decode(v,g){const w=v instanceof c.default.Reader?v:new c.default.Reader(v);let ae=g===void 0?w.len:w.pos+g;const I=Object.assign({},z);for(I.enabledCodecs=[];w.pos<ae;){const $=w.uint32();switch($>>>3){case 1:I.sid=w.string();break;case 2:I.name=w.string();break;case 3:I.emptyTimeout=w.uint32();break;case 4:I.maxParticipants=w.uint32();break;case 5:I.creationTime=me(w.int64());break;case 6:I.turnPassword=w.string();break;case 7:I.enabledCodecs.push(a.Codec.decode(w,w.uint32()));break;case 8:I.metadata=w.string();break;case 9:I.numParticipants=w.uint32();break;case 10:I.activeRecording=w.bool();break;default:w.skipType($&7);break}}return I},fromJSON(v){const g=Object.assign({},z);if(g.enabledCodecs=[],v.sid!==void 0&&v.sid!==null?g.sid=String(v.sid):g.sid="",v.name!==void 0&&v.name!==null?g.name=String(v.name):g.name="",v.emptyTimeout!==void 0&&v.emptyTimeout!==null?g.emptyTimeout=Number(v.emptyTimeout):g.emptyTimeout=0,v.maxParticipants!==void 0&&v.maxParticipants!==null?g.maxParticipants=Number(v.maxParticipants):g.maxParticipants=0,v.creationTime!==void 0&&v.creationTime!==null?g.creationTime=Number(v.creationTime):g.creationTime=0,v.turnPassword!==void 0&&v.turnPassword!==null?g.turnPassword=String(v.turnPassword):g.turnPassword="",v.enabledCodecs!==void 0&&v.enabledCodecs!==null)for(const w of v.enabledCodecs)g.enabledCodecs.push(a.Codec.fromJSON(w));return v.metadata!==void 0&&v.metadata!==null?g.metadata=String(v.metadata):g.metadata="",v.numParticipants!==void 0&&v.numParticipants!==null?g.numParticipants=Number(v.numParticipants):g.numParticipants=0,v.activeRecording!==void 0&&v.activeRecording!==null?g.activeRecording=Boolean(v.activeRecording):g.activeRecording=!1,g},toJSON(v){const g={};return v.sid!==void 0&&(g.sid=v.sid),v.name!==void 0&&(g.name=v.name),v.emptyTimeout!==void 0&&(g.emptyTimeout=v.emptyTimeout),v.maxParticipants!==void 0&&(g.maxParticipants=v.maxParticipants),v.creationTime!==void 0&&(g.creationTime=v.creationTime),v.turnPassword!==void 0&&(g.turnPassword=v.turnPassword),v.enabledCodecs?g.enabledCodecs=v.enabledCodecs.map(w=>w?a.Codec.toJSON(w):void 0):g.enabledCodecs=[],v.metadata!==void 0&&(g.metadata=v.metadata),v.numParticipants!==void 0&&(g.numParticipants=v.numParticipants),v.activeRecording!==void 0&&(g.activeRecording=v.activeRecording),g},fromPartial(v){const g=Object.assign({},z);if(g.enabledCodecs=[],v.sid!==void 0&&v.sid!==null?g.sid=v.sid:g.sid="",v.name!==void 0&&v.name!==null?g.name=v.name:g.name="",v.emptyTimeout!==void 0&&v.emptyTimeout!==null?g.emptyTimeout=v.emptyTimeout:g.emptyTimeout=0,v.maxParticipants!==void 0&&v.maxParticipants!==null?g.maxParticipants=v.maxParticipants:g.maxParticipants=0,v.creationTime!==void 0&&v.creationTime!==null?g.creationTime=v.creationTime:g.creationTime=0,v.turnPassword!==void 0&&v.turnPassword!==null?g.turnPassword=v.turnPassword:g.turnPassword="",v.enabledCodecs!==void 0&&v.enabledCodecs!==null)for(const w of v.enabledCodecs)g.enabledCodecs.push(a.Codec.fromPartial(w));return v.metadata!==void 0&&v.metadata!==null?g.metadata=v.metadata:g.metadata="",v.numParticipants!==void 0&&v.numParticipants!==null?g.numParticipants=v.numParticipants:g.numParticipants=0,v.activeRecording!==void 0&&v.activeRecording!==null?g.activeRecording=v.activeRecording:g.activeRecording=!1,g}};const ne={mime:"",fmtpLine:""};a.Codec={encode(v,g=c.default.Writer.create()){return v.mime!==""&&g.uint32(10).string(v.mime),v.fmtpLine!==""&&g.uint32(18).string(v.fmtpLine),g},decode(v,g){const w=v instanceof c.default.Reader?v:new c.default.Reader(v);let ae=g===void 0?w.len:w.pos+g;const I=Object.assign({},ne);for(;w.pos<ae;){const $=w.uint32();switch($>>>3){case 1:I.mime=w.string();break;case 2:I.fmtpLine=w.string();break;default:w.skipType($&7);break}}return I},fromJSON(v){const g=Object.assign({},ne);return v.mime!==void 0&&v.mime!==null?g.mime=String(v.mime):g.mime="",v.fmtpLine!==void 0&&v.fmtpLine!==null?g.fmtpLine=String(v.fmtpLine):g.fmtpLine="",g},toJSON(v){const g={};return v.mime!==void 0&&(g.mime=v.mime),v.fmtpLine!==void 0&&(g.fmtpLine=v.fmtpLine),g},fromPartial(v){const g=Object.assign({},ne);return v.mime!==void 0&&v.mime!==null?g.mime=v.mime:g.mime="",v.fmtpLine!==void 0&&v.fmtpLine!==null?g.fmtpLine=v.fmtpLine:g.fmtpLine="",g}};const X={sid:"",identity:"",state:0,metadata:"",joinedAt:0,hidden:!1,recorder:!1,name:""};a.ParticipantInfo={encode(v,g=c.default.Writer.create()){v.sid!==""&&g.uint32(10).string(v.sid),v.identity!==""&&g.uint32(18).string(v.identity),v.state!==0&&g.uint32(24).int32(v.state);for(const w of v.tracks)a.TrackInfo.encode(w,g.uint32(34).fork()).ldelim();return v.metadata!==""&&g.uint32(42).string(v.metadata),v.joinedAt!==0&&g.uint32(48).int64(v.joinedAt),v.hidden===!0&&g.uint32(56).bool(v.hidden),v.recorder===!0&&g.uint32(64).bool(v.recorder),v.name!==""&&g.uint32(74).string(v.name),g},decode(v,g){const w=v instanceof c.default.Reader?v:new c.default.Reader(v);let ae=g===void 0?w.len:w.pos+g;const I=Object.assign({},X);for(I.tracks=[];w.pos<ae;){const $=w.uint32();switch($>>>3){case 1:I.sid=w.string();break;case 2:I.identity=w.string();break;case 3:I.state=w.int32();break;case 4:I.tracks.push(a.TrackInfo.decode(w,w.uint32()));break;case 5:I.metadata=w.string();break;case 6:I.joinedAt=me(w.int64());break;case 7:I.hidden=w.bool();break;case 8:I.recorder=w.bool();break;case 9:I.name=w.string();break;default:w.skipType($&7);break}}return I},fromJSON(v){const g=Object.assign({},X);if(g.tracks=[],v.sid!==void 0&&v.sid!==null?g.sid=String(v.sid):g.sid="",v.identity!==void 0&&v.identity!==null?g.identity=String(v.identity):g.identity="",v.state!==void 0&&v.state!==null?g.state=j(v.state):g.state=0,v.tracks!==void 0&&v.tracks!==null)for(const w of v.tracks)g.tracks.push(a.TrackInfo.fromJSON(w));return v.metadata!==void 0&&v.metadata!==null?g.metadata=String(v.metadata):g.metadata="",v.joinedAt!==void 0&&v.joinedAt!==null?g.joinedAt=Number(v.joinedAt):g.joinedAt=0,v.hidden!==void 0&&v.hidden!==null?g.hidden=Boolean(v.hidden):g.hidden=!1,v.recorder!==void 0&&v.recorder!==null?g.recorder=Boolean(v.recorder):g.recorder=!1,v.name!==void 0&&v.name!==null?g.name=String(v.name):g.name="",g},toJSON(v){const g={};return v.sid!==void 0&&(g.sid=v.sid),v.identity!==void 0&&(g.identity=v.identity),v.state!==void 0&&(g.state=T(v.state)),v.tracks?g.tracks=v.tracks.map(w=>w?a.TrackInfo.toJSON(w):void 0):g.tracks=[],v.metadata!==void 0&&(g.metadata=v.metadata),v.joinedAt!==void 0&&(g.joinedAt=v.joinedAt),v.hidden!==void 0&&(g.hidden=v.hidden),v.recorder!==void 0&&(g.recorder=v.recorder),v.name!==void 0&&(g.name=v.name),g},fromPartial(v){const g=Object.assign({},X);if(g.tracks=[],v.sid!==void 0&&v.sid!==null?g.sid=v.sid:g.sid="",v.identity!==void 0&&v.identity!==null?g.identity=v.identity:g.identity="",v.state!==void 0&&v.state!==null?g.state=v.state:g.state=0,v.tracks!==void 0&&v.tracks!==null)for(const w of v.tracks)g.tracks.push(a.TrackInfo.fromPartial(w));return v.metadata!==void 0&&v.metadata!==null?g.metadata=v.metadata:g.metadata="",v.joinedAt!==void 0&&v.joinedAt!==null?g.joinedAt=v.joinedAt:g.joinedAt=0,v.hidden!==void 0&&v.hidden!==null?g.hidden=v.hidden:g.hidden=!1,v.recorder!==void 0&&v.recorder!==null?g.recorder=v.recorder:g.recorder=!1,v.name!==void 0&&v.name!==null?g.name=v.name:g.name="",g}};const M={sid:"",type:0,name:"",muted:!1,width:0,height:0,simulcast:!1,disableDtx:!1,source:0,mimeType:""};a.TrackInfo={encode(v,g=c.default.Writer.create()){v.sid!==""&&g.uint32(10).string(v.sid),v.type!==0&&g.uint32(16).int32(v.type),v.name!==""&&g.uint32(26).string(v.name),v.muted===!0&&g.uint32(32).bool(v.muted),v.width!==0&&g.uint32(40).uint32(v.width),v.height!==0&&g.uint32(48).uint32(v.height),v.simulcast===!0&&g.uint32(56).bool(v.simulcast),v.disableDtx===!0&&g.uint32(64).bool(v.disableDtx),v.source!==0&&g.uint32(72).int32(v.source);for(const w of v.layers)a.VideoLayer.encode(w,g.uint32(82).fork()).ldelim();return v.mimeType!==""&&g.uint32(90).string(v.mimeType),g},decode(v,g){const w=v instanceof c.default.Reader?v:new c.default.Reader(v);let ae=g===void 0?w.len:w.pos+g;const I=Object.assign({},M);for(I.layers=[];w.pos<ae;){const $=w.uint32();switch($>>>3){case 1:I.sid=w.string();break;case 2:I.type=w.int32();break;case 3:I.name=w.string();break;case 4:I.muted=w.bool();break;case 5:I.width=w.uint32();break;case 6:I.height=w.uint32();break;case 7:I.simulcast=w.bool();break;case 8:I.disableDtx=w.bool();break;case 9:I.source=w.int32();break;case 10:I.layers.push(a.VideoLayer.decode(w,w.uint32()));break;case 11:I.mimeType=w.string();break;default:w.skipType($&7);break}}return I},fromJSON(v){const g=Object.assign({},M);if(g.layers=[],v.sid!==void 0&&v.sid!==null?g.sid=String(v.sid):g.sid="",v.type!==void 0&&v.type!==null?g.type=h(v.type):g.type=0,v.name!==void 0&&v.name!==null?g.name=String(v.name):g.name="",v.muted!==void 0&&v.muted!==null?g.muted=Boolean(v.muted):g.muted=!1,v.width!==void 0&&v.width!==null?g.width=Number(v.width):g.width=0,v.height!==void 0&&v.height!==null?g.height=Number(v.height):g.height=0,v.simulcast!==void 0&&v.simulcast!==null?g.simulcast=Boolean(v.simulcast):g.simulcast=!1,v.disableDtx!==void 0&&v.disableDtx!==null?g.disableDtx=Boolean(v.disableDtx):g.disableDtx=!1,v.source!==void 0&&v.source!==null?g.source=_(v.source):g.source=0,v.layers!==void 0&&v.layers!==null)for(const w of v.layers)g.layers.push(a.VideoLayer.fromJSON(w));return v.mimeType!==void 0&&v.mimeType!==null?g.mimeType=String(v.mimeType):g.mimeType="",g},toJSON(v){const g={};return v.sid!==void 0&&(g.sid=v.sid),v.type!==void 0&&(g.type=p(v.type)),v.name!==void 0&&(g.name=v.name),v.muted!==void 0&&(g.muted=v.muted),v.width!==void 0&&(g.width=v.width),v.height!==void 0&&(g.height=v.height),v.simulcast!==void 0&&(g.simulcast=v.simulcast),v.disableDtx!==void 0&&(g.disableDtx=v.disableDtx),v.source!==void 0&&(g.source=E(v.source)),v.layers?g.layers=v.layers.map(w=>w?a.VideoLayer.toJSON(w):void 0):g.layers=[],v.mimeType!==void 0&&(g.mimeType=v.mimeType),g},fromPartial(v){const g=Object.assign({},M);if(g.layers=[],v.sid!==void 0&&v.sid!==null?g.sid=v.sid:g.sid="",v.type!==void 0&&v.type!==null?g.type=v.type:g.type=0,v.name!==void 0&&v.name!==null?g.name=v.name:g.name="",v.muted!==void 0&&v.muted!==null?g.muted=v.muted:g.muted=!1,v.width!==void 0&&v.width!==null?g.width=v.width:g.width=0,v.height!==void 0&&v.height!==null?g.height=v.height:g.height=0,v.simulcast!==void 0&&v.simulcast!==null?g.simulcast=v.simulcast:g.simulcast=!1,v.disableDtx!==void 0&&v.disableDtx!==null?g.disableDtx=v.disableDtx:g.disableDtx=!1,v.source!==void 0&&v.source!==null?g.source=v.source:g.source=0,v.layers!==void 0&&v.layers!==null)for(const w of v.layers)g.layers.push(a.VideoLayer.fromPartial(w));return v.mimeType!==void 0&&v.mimeType!==null?g.mimeType=v.mimeType:g.mimeType="",g}};const K={quality:0,width:0,height:0,bitrate:0};a.VideoLayer={encode(v,g=c.default.Writer.create()){return v.quality!==0&&g.uint32(8).int32(v.quality),v.width!==0&&g.uint32(16).uint32(v.width),v.height!==0&&g.uint32(24).uint32(v.height),v.bitrate!==0&&g.uint32(32).uint32(v.bitrate),g},decode(v,g){const w=v instanceof c.default.Reader?v:new c.default.Reader(v);let ae=g===void 0?w.len:w.pos+g;const I=Object.assign({},K);for(;w.pos<ae;){const $=w.uint32();switch($>>>3){case 1:I.quality=w.int32();break;case 2:I.width=w.uint32();break;case 3:I.height=w.uint32();break;case 4:I.bitrate=w.uint32();break;default:w.skipType($&7);break}}return I},fromJSON(v){const g=Object.assign({},K);return v.quality!==void 0&&v.quality!==null?g.quality=P(v.quality):g.quality=0,v.width!==void 0&&v.width!==null?g.width=Number(v.width):g.width=0,v.height!==void 0&&v.height!==null?g.height=Number(v.height):g.height=0,v.bitrate!==void 0&&v.bitrate!==null?g.bitrate=Number(v.bitrate):g.bitrate=0,g},toJSON(v){const g={};return v.quality!==void 0&&(g.quality=C(v.quality)),v.width!==void 0&&(g.width=v.width),v.height!==void 0&&(g.height=v.height),v.bitrate!==void 0&&(g.bitrate=v.bitrate),g},fromPartial(v){const g=Object.assign({},K);return v.quality!==void 0&&v.quality!==null?g.quality=v.quality:g.quality=0,v.width!==void 0&&v.width!==null?g.width=v.width:g.width=0,v.height!==void 0&&v.height!==null?g.height=v.height:g.height=0,v.bitrate!==void 0&&v.bitrate!==null?g.bitrate=v.bitrate:g.bitrate=0,g}};const te={kind:0};a.DataPacket={encode(v,g=c.default.Writer.create()){return v.kind!==0&&g.uint32(8).int32(v.kind),v.user!==void 0&&a.UserPacket.encode(v.user,g.uint32(18).fork()).ldelim(),v.speaker!==void 0&&a.ActiveSpeakerUpdate.encode(v.speaker,g.uint32(26).fork()).ldelim(),g},decode(v,g){const w=v instanceof c.default.Reader?v:new c.default.Reader(v);let ae=g===void 0?w.len:w.pos+g;const I=Object.assign({},te);for(;w.pos<ae;){const $=w.uint32();switch($>>>3){case 1:I.kind=w.int32();break;case 2:I.user=a.UserPacket.decode(w,w.uint32());break;case 3:I.speaker=a.ActiveSpeakerUpdate.decode(w,w.uint32());break;default:w.skipType($&7);break}}return I},fromJSON(v){const g=Object.assign({},te);return v.kind!==void 0&&v.kind!==null?g.kind=J(v.kind):g.kind=0,v.user!==void 0&&v.user!==null?g.user=a.UserPacket.fromJSON(v.user):g.user=void 0,v.speaker!==void 0&&v.speaker!==null?g.speaker=a.ActiveSpeakerUpdate.fromJSON(v.speaker):g.speaker=void 0,g},toJSON(v){const g={};return v.kind!==void 0&&(g.kind=ee(v.kind)),v.user!==void 0&&(g.user=v.user?a.UserPacket.toJSON(v.user):void 0),v.speaker!==void 0&&(g.speaker=v.speaker?a.ActiveSpeakerUpdate.toJSON(v.speaker):void 0),g},fromPartial(v){const g=Object.assign({},te);return v.kind!==void 0&&v.kind!==null?g.kind=v.kind:g.kind=0,v.user!==void 0&&v.user!==null?g.user=a.UserPacket.fromPartial(v.user):g.user=void 0,v.speaker!==void 0&&v.speaker!==null?g.speaker=a.ActiveSpeakerUpdate.fromPartial(v.speaker):g.speaker=void 0,g}};const L={};a.ActiveSpeakerUpdate={encode(v,g=c.default.Writer.create()){for(const w of v.speakers)a.SpeakerInfo.encode(w,g.uint32(10).fork()).ldelim();return g},decode(v,g){const w=v instanceof c.default.Reader?v:new c.default.Reader(v);let ae=g===void 0?w.len:w.pos+g;const I=Object.assign({},L);for(I.speakers=[];w.pos<ae;){const $=w.uint32();switch($>>>3){case 1:I.speakers.push(a.SpeakerInfo.decode(w,w.uint32()));break;default:w.skipType($&7);break}}return I},fromJSON(v){const g=Object.assign({},L);if(g.speakers=[],v.speakers!==void 0&&v.speakers!==null)for(const w of v.speakers)g.speakers.push(a.SpeakerInfo.fromJSON(w));return g},toJSON(v){const g={};return v.speakers?g.speakers=v.speakers.map(w=>w?a.SpeakerInfo.toJSON(w):void 0):g.speakers=[],g},fromPartial(v){const g=Object.assign({},L);if(g.speakers=[],v.speakers!==void 0&&v.speakers!==null)for(const w of v.speakers)g.speakers.push(a.SpeakerInfo.fromPartial(w));return g}};const G={sid:"",level:0,active:!1};a.SpeakerInfo={encode(v,g=c.default.Writer.create()){return v.sid!==""&&g.uint32(10).string(v.sid),v.level!==0&&g.uint32(21).float(v.level),v.active===!0&&g.uint32(24).bool(v.active),g},decode(v,g){const w=v instanceof c.default.Reader?v:new c.default.Reader(v);let ae=g===void 0?w.len:w.pos+g;const I=Object.assign({},G);for(;w.pos<ae;){const $=w.uint32();switch($>>>3){case 1:I.sid=w.string();break;case 2:I.level=w.float();break;case 3:I.active=w.bool();break;default:w.skipType($&7);break}}return I},fromJSON(v){const g=Object.assign({},G);return v.sid!==void 0&&v.sid!==null?g.sid=String(v.sid):g.sid="",v.level!==void 0&&v.level!==null?g.level=Number(v.level):g.level=0,v.active!==void 0&&v.active!==null?g.active=Boolean(v.active):g.active=!1,g},toJSON(v){const g={};return v.sid!==void 0&&(g.sid=v.sid),v.level!==void 0&&(g.level=v.level),v.active!==void 0&&(g.active=v.active),g},fromPartial(v){const g=Object.assign({},G);return v.sid!==void 0&&v.sid!==null?g.sid=v.sid:g.sid="",v.level!==void 0&&v.level!==null?g.level=v.level:g.level=0,v.active!==void 0&&v.active!==null?g.active=v.active:g.active=!1,g}};const W={participantSid:"",destinationSids:""};a.UserPacket={encode(v,g=c.default.Writer.create()){v.participantSid!==""&&g.uint32(10).string(v.participantSid),v.payload.length!==0&&g.uint32(18).bytes(v.payload);for(const w of v.destinationSids)g.uint32(26).string(w);return g},decode(v,g){const w=v instanceof c.default.Reader?v:new c.default.Reader(v);let ae=g===void 0?w.len:w.pos+g;const I=Object.assign({},W);for(I.destinationSids=[],I.payload=new Uint8Array;w.pos<ae;){const $=w.uint32();switch($>>>3){case 1:I.participantSid=w.string();break;case 2:I.payload=w.bytes();break;case 3:I.destinationSids.push(w.string());break;default:w.skipType($&7);break}}return I},fromJSON(v){const g=Object.assign({},W);if(g.destinationSids=[],g.payload=new Uint8Array,v.participantSid!==void 0&&v.participantSid!==null?g.participantSid=String(v.participantSid):g.participantSid="",v.payload!==void 0&&v.payload!==null&&(g.payload=oe(v.payload)),v.destinationSids!==void 0&&v.destinationSids!==null)for(const w of v.destinationSids)g.destinationSids.push(String(w));return g},toJSON(v){const g={};return v.participantSid!==void 0&&(g.participantSid=v.participantSid),v.payload!==void 0&&(g.payload=pe(v.payload!==void 0?v.payload:new Uint8Array)),v.destinationSids?g.destinationSids=v.destinationSids.map(w=>w):g.destinationSids=[],g},fromPartial(v){const g=Object.assign({},W);if(g.destinationSids=[],v.participantSid!==void 0&&v.participantSid!==null?g.participantSid=v.participantSid:g.participantSid="",v.payload!==void 0&&v.payload!==null?g.payload=v.payload:g.payload=new Uint8Array,v.destinationSids!==void 0&&v.destinationSids!==null)for(const w of v.destinationSids)g.destinationSids.push(w);return g}};const ie={participantSid:"",trackSids:""};a.ParticipantTracks={encode(v,g=c.default.Writer.create()){v.participantSid!==""&&g.uint32(10).string(v.participantSid);for(const w of v.trackSids)g.uint32(18).string(w);return g},decode(v,g){const w=v instanceof c.default.Reader?v:new c.default.Reader(v);let ae=g===void 0?w.len:w.pos+g;const I=Object.assign({},ie);for(I.trackSids=[];w.pos<ae;){const $=w.uint32();switch($>>>3){case 1:I.participantSid=w.string();break;case 2:I.trackSids.push(w.string());break;default:w.skipType($&7);break}}return I},fromJSON(v){const g=Object.assign({},ie);if(g.trackSids=[],v.participantSid!==void 0&&v.participantSid!==null?g.participantSid=String(v.participantSid):g.participantSid="",v.trackSids!==void 0&&v.trackSids!==null)for(const w of v.trackSids)g.trackSids.push(String(w));return g},toJSON(v){const g={};return v.participantSid!==void 0&&(g.participantSid=v.participantSid),v.trackSids?g.trackSids=v.trackSids.map(w=>w):g.trackSids=[],g},fromPartial(v){const g=Object.assign({},ie);if(g.trackSids=[],v.participantSid!==void 0&&v.participantSid!==null?g.participantSid=v.participantSid:g.participantSid="",v.trackSids!==void 0&&v.trackSids!==null)for(const w of v.trackSids)g.trackSids.push(w);return g}};var x=(()=>{if(typeof x!="undefined")return x;if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof commonjsGlobal!="undefined")return commonjsGlobal;throw"Unable to locate global object"})();const Y=x.atob||(v=>x.Buffer.from(v,"base64").toString("binary"));function oe(v){const g=Y(v),w=new Uint8Array(g.length);for(let ae=0;ae<g.length;++ae)w[ae]=g.charCodeAt(ae);return w}const fe=x.btoa||(v=>x.Buffer.from(v,"binary").toString("base64"));function pe(v){const g=[];for(const w of v)g.push(String.fromCharCode(w));return fe(g.join(""))}function me(v){if(v.gt(Number.MAX_SAFE_INTEGER))throw new x.Error("Value is larger than Number.MAX_SAFE_INTEGER");return v.toNumber()}c.default.util.Long!==d.default&&(c.default.util.Long=d.default,c.default.configure())})(livekit_models);var RoomServiceClient$1={},livekit_room={};(function(a){var s=commonjsGlobal&&commonjsGlobal.__importDefault||function(L){return L&&L.__esModule?L:{default:L}};Object.defineProperty(a,"__esModule",{value:!0}),a.UpdateRoomMetadataRequest=a.SendDataResponse=a.SendDataRequest=a.UpdateSubscriptionsResponse=a.UpdateSubscriptionsRequest=a.UpdateParticipantRequest=a.ParticipantPermission=a.MuteRoomTrackResponse=a.MuteRoomTrackRequest=a.RemoveParticipantResponse=a.RoomParticipantIdentity=a.ListParticipantsResponse=a.ListParticipantsRequest=a.DeleteRoomResponse=a.DeleteRoomRequest=a.ListRoomsResponse=a.ListRoomsRequest=a.CreateRoomRequest=a.protobufPackage=void 0;const d=s(umd.exports),c=s(minimal),l=livekit_models;a.protobufPackage="livekit";const h={name:"",emptyTimeout:0,maxParticipants:0,nodeId:"",metadata:""};a.CreateRoomRequest={encode(L,G=c.default.Writer.create()){return L.name!==""&&G.uint32(10).string(L.name),L.emptyTimeout!==0&&G.uint32(16).uint32(L.emptyTimeout),L.maxParticipants!==0&&G.uint32(24).uint32(L.maxParticipants),L.nodeId!==""&&G.uint32(34).string(L.nodeId),L.metadata!==""&&G.uint32(42).string(L.metadata),G},decode(L,G){const W=L instanceof c.default.Reader?L:new c.default.Reader(L);let ie=G===void 0?W.len:W.pos+G;const x=Object.assign({},h);for(;W.pos<ie;){const Y=W.uint32();switch(Y>>>3){case 1:x.name=W.string();break;case 2:x.emptyTimeout=W.uint32();break;case 3:x.maxParticipants=W.uint32();break;case 4:x.nodeId=W.string();break;case 5:x.metadata=W.string();break;default:W.skipType(Y&7);break}}return x},fromJSON(L){const G=Object.assign({},h);return L.name!==void 0&&L.name!==null?G.name=String(L.name):G.name="",L.emptyTimeout!==void 0&&L.emptyTimeout!==null?G.emptyTimeout=Number(L.emptyTimeout):G.emptyTimeout=0,L.maxParticipants!==void 0&&L.maxParticipants!==null?G.maxParticipants=Number(L.maxParticipants):G.maxParticipants=0,L.nodeId!==void 0&&L.nodeId!==null?G.nodeId=String(L.nodeId):G.nodeId="",L.metadata!==void 0&&L.metadata!==null?G.metadata=String(L.metadata):G.metadata="",G},toJSON(L){const G={};return L.name!==void 0&&(G.name=L.name),L.emptyTimeout!==void 0&&(G.emptyTimeout=L.emptyTimeout),L.maxParticipants!==void 0&&(G.maxParticipants=L.maxParticipants),L.nodeId!==void 0&&(G.nodeId=L.nodeId),L.metadata!==void 0&&(G.metadata=L.metadata),G},fromPartial(L){const G=Object.assign({},h);return L.name!==void 0&&L.name!==null?G.name=L.name:G.name="",L.emptyTimeout!==void 0&&L.emptyTimeout!==null?G.emptyTimeout=L.emptyTimeout:G.emptyTimeout=0,L.maxParticipants!==void 0&&L.maxParticipants!==null?G.maxParticipants=L.maxParticipants:G.maxParticipants=0,L.nodeId!==void 0&&L.nodeId!==null?G.nodeId=L.nodeId:G.nodeId="",L.metadata!==void 0&&L.metadata!==null?G.metadata=L.metadata:G.metadata="",G}};const p={names:""};a.ListRoomsRequest={encode(L,G=c.default.Writer.create()){for(const W of L.names)G.uint32(10).string(W);return G},decode(L,G){const W=L instanceof c.default.Reader?L:new c.default.Reader(L);let ie=G===void 0?W.len:W.pos+G;const x=Object.assign({},p);for(x.names=[];W.pos<ie;){const Y=W.uint32();switch(Y>>>3){case 1:x.names.push(W.string());break;default:W.skipType(Y&7);break}}return x},fromJSON(L){const G=Object.assign({},p);if(G.names=[],L.names!==void 0&&L.names!==null)for(const W of L.names)G.names.push(String(W));return G},toJSON(L){const G={};return L.names?G.names=L.names.map(W=>W):G.names=[],G},fromPartial(L){const G=Object.assign({},p);if(G.names=[],L.names!==void 0&&L.names!==null)for(const W of L.names)G.names.push(W);return G}};const y={};a.ListRoomsResponse={encode(L,G=c.default.Writer.create()){for(const W of L.rooms)l.Room.encode(W,G.uint32(10).fork()).ldelim();return G},decode(L,G){const W=L instanceof c.default.Reader?L:new c.default.Reader(L);let ie=G===void 0?W.len:W.pos+G;const x=Object.assign({},y);for(x.rooms=[];W.pos<ie;){const Y=W.uint32();switch(Y>>>3){case 1:x.rooms.push(l.Room.decode(W,W.uint32()));break;default:W.skipType(Y&7);break}}return x},fromJSON(L){const G=Object.assign({},y);if(G.rooms=[],L.rooms!==void 0&&L.rooms!==null)for(const W of L.rooms)G.rooms.push(l.Room.fromJSON(W));return G},toJSON(L){const G={};return L.rooms?G.rooms=L.rooms.map(W=>W?l.Room.toJSON(W):void 0):G.rooms=[],G},fromPartial(L){const G=Object.assign({},y);if(G.rooms=[],L.rooms!==void 0&&L.rooms!==null)for(const W of L.rooms)G.rooms.push(l.Room.fromPartial(W));return G}};const _={room:""};a.DeleteRoomRequest={encode(L,G=c.default.Writer.create()){return L.room!==""&&G.uint32(10).string(L.room),G},decode(L,G){const W=L instanceof c.default.Reader?L:new c.default.Reader(L);let ie=G===void 0?W.len:W.pos+G;const x=Object.assign({},_);for(;W.pos<ie;){const Y=W.uint32();switch(Y>>>3){case 1:x.room=W.string();break;default:W.skipType(Y&7);break}}return x},fromJSON(L){const G=Object.assign({},_);return L.room!==void 0&&L.room!==null?G.room=String(L.room):G.room="",G},toJSON(L){const G={};return L.room!==void 0&&(G.room=L.room),G},fromPartial(L){const G=Object.assign({},_);return L.room!==void 0&&L.room!==null?G.room=L.room:G.room="",G}};const E={};a.DeleteRoomResponse={encode(L,G=c.default.Writer.create()){return G},decode(L,G){const W=L instanceof c.default.Reader?L:new c.default.Reader(L);let ie=G===void 0?W.len:W.pos+G;const x=Object.assign({},E);for(;W.pos<ie;){const Y=W.uint32();switch(Y>>>3){default:W.skipType(Y&7);break}}return x},fromJSON(L){return Object.assign({},E)},toJSON(L){return{}},fromPartial(L){return Object.assign({},E)}};const O={room:""};a.ListParticipantsRequest={encode(L,G=c.default.Writer.create()){return L.room!==""&&G.uint32(10).string(L.room),G},decode(L,G){const W=L instanceof c.default.Reader?L:new c.default.Reader(L);let ie=G===void 0?W.len:W.pos+G;const x=Object.assign({},O);for(;W.pos<ie;){const Y=W.uint32();switch(Y>>>3){case 1:x.room=W.string();break;default:W.skipType(Y&7);break}}return x},fromJSON(L){const G=Object.assign({},O);return L.room!==void 0&&L.room!==null?G.room=String(L.room):G.room="",G},toJSON(L){const G={};return L.room!==void 0&&(G.room=L.room),G},fromPartial(L){const G=Object.assign({},O);return L.room!==void 0&&L.room!==null?G.room=L.room:G.room="",G}};const P={};a.ListParticipantsResponse={encode(L,G=c.default.Writer.create()){for(const W of L.participants)l.ParticipantInfo.encode(W,G.uint32(10).fork()).ldelim();return G},decode(L,G){const W=L instanceof c.default.Reader?L:new c.default.Reader(L);let ie=G===void 0?W.len:W.pos+G;const x=Object.assign({},P);for(x.participants=[];W.pos<ie;){const Y=W.uint32();switch(Y>>>3){case 1:x.participants.push(l.ParticipantInfo.decode(W,W.uint32()));break;default:W.skipType(Y&7);break}}return x},fromJSON(L){const G=Object.assign({},P);if(G.participants=[],L.participants!==void 0&&L.participants!==null)for(const W of L.participants)G.participants.push(l.ParticipantInfo.fromJSON(W));return G},toJSON(L){const G={};return L.participants?G.participants=L.participants.map(W=>W?l.ParticipantInfo.toJSON(W):void 0):G.participants=[],G},fromPartial(L){const G=Object.assign({},P);if(G.participants=[],L.participants!==void 0&&L.participants!==null)for(const W of L.participants)G.participants.push(l.ParticipantInfo.fromPartial(W));return G}};const C={room:"",identity:""};a.RoomParticipantIdentity={encode(L,G=c.default.Writer.create()){return L.room!==""&&G.uint32(10).string(L.room),L.identity!==""&&G.uint32(18).string(L.identity),G},decode(L,G){const W=L instanceof c.default.Reader?L:new c.default.Reader(L);let ie=G===void 0?W.len:W.pos+G;const x=Object.assign({},C);for(;W.pos<ie;){const Y=W.uint32();switch(Y>>>3){case 1:x.room=W.string();break;case 2:x.identity=W.string();break;default:W.skipType(Y&7);break}}return x},fromJSON(L){const G=Object.assign({},C);return L.room!==void 0&&L.room!==null?G.room=String(L.room):G.room="",L.identity!==void 0&&L.identity!==null?G.identity=String(L.identity):G.identity="",G},toJSON(L){const G={};return L.room!==void 0&&(G.room=L.room),L.identity!==void 0&&(G.identity=L.identity),G},fromPartial(L){const G=Object.assign({},C);return L.room!==void 0&&L.room!==null?G.room=L.room:G.room="",L.identity!==void 0&&L.identity!==null?G.identity=L.identity:G.identity="",G}};const A={};a.RemoveParticipantResponse={encode(L,G=c.default.Writer.create()){return G},decode(L,G){const W=L instanceof c.default.Reader?L:new c.default.Reader(L);let ie=G===void 0?W.len:W.pos+G;const x=Object.assign({},A);for(;W.pos<ie;){const Y=W.uint32();switch(Y>>>3){default:W.skipType(Y&7);break}}return x},fromJSON(L){return Object.assign({},A)},toJSON(L){return{}},fromPartial(L){return Object.assign({},A)}};const q={room:"",identity:"",trackSid:"",muted:!1};a.MuteRoomTrackRequest={encode(L,G=c.default.Writer.create()){return L.room!==""&&G.uint32(10).string(L.room),L.identity!==""&&G.uint32(18).string(L.identity),L.trackSid!==""&&G.uint32(26).string(L.trackSid),L.muted===!0&&G.uint32(32).bool(L.muted),G},decode(L,G){const W=L instanceof c.default.Reader?L:new c.default.Reader(L);let ie=G===void 0?W.len:W.pos+G;const x=Object.assign({},q);for(;W.pos<ie;){const Y=W.uint32();switch(Y>>>3){case 1:x.room=W.string();break;case 2:x.identity=W.string();break;case 3:x.trackSid=W.string();break;case 4:x.muted=W.bool();break;default:W.skipType(Y&7);break}}return x},fromJSON(L){const G=Object.assign({},q);return L.room!==void 0&&L.room!==null?G.room=String(L.room):G.room="",L.identity!==void 0&&L.identity!==null?G.identity=String(L.identity):G.identity="",L.trackSid!==void 0&&L.trackSid!==null?G.trackSid=String(L.trackSid):G.trackSid="",L.muted!==void 0&&L.muted!==null?G.muted=Boolean(L.muted):G.muted=!1,G},toJSON(L){const G={};return L.room!==void 0&&(G.room=L.room),L.identity!==void 0&&(G.identity=L.identity),L.trackSid!==void 0&&(G.trackSid=L.trackSid),L.muted!==void 0&&(G.muted=L.muted),G},fromPartial(L){const G=Object.assign({},q);return L.room!==void 0&&L.room!==null?G.room=L.room:G.room="",L.identity!==void 0&&L.identity!==null?G.identity=L.identity:G.identity="",L.trackSid!==void 0&&L.trackSid!==null?G.trackSid=L.trackSid:G.trackSid="",L.muted!==void 0&&L.muted!==null?G.muted=L.muted:G.muted=!1,G}};const U={};a.MuteRoomTrackResponse={encode(L,G=c.default.Writer.create()){return L.track!==void 0&&l.TrackInfo.encode(L.track,G.uint32(10).fork()).ldelim(),G},decode(L,G){const W=L instanceof c.default.Reader?L:new c.default.Reader(L);let ie=G===void 0?W.len:W.pos+G;const x=Object.assign({},U);for(;W.pos<ie;){const Y=W.uint32();switch(Y>>>3){case 1:x.track=l.TrackInfo.decode(W,W.uint32());break;default:W.skipType(Y&7);break}}return x},fromJSON(L){const G=Object.assign({},U);return L.track!==void 0&&L.track!==null?G.track=l.TrackInfo.fromJSON(L.track):G.track=void 0,G},toJSON(L){const G={};return L.track!==void 0&&(G.track=L.track?l.TrackInfo.toJSON(L.track):void 0),G},fromPartial(L){const G=Object.assign({},U);return L.track!==void 0&&L.track!==null?G.track=l.TrackInfo.fromPartial(L.track):G.track=void 0,G}};const F={canSubscribe:!1,canPublish:!1,canPublishData:!1};a.ParticipantPermission={encode(L,G=c.default.Writer.create()){return L.canSubscribe===!0&&G.uint32(8).bool(L.canSubscribe),L.canPublish===!0&&G.uint32(16).bool(L.canPublish),L.canPublishData===!0&&G.uint32(24).bool(L.canPublishData),G},decode(L,G){const W=L instanceof c.default.Reader?L:new c.default.Reader(L);let ie=G===void 0?W.len:W.pos+G;const x=Object.assign({},F);for(;W.pos<ie;){const Y=W.uint32();switch(Y>>>3){case 1:x.canSubscribe=W.bool();break;case 2:x.canPublish=W.bool();break;case 3:x.canPublishData=W.bool();break;default:W.skipType(Y&7);break}}return x},fromJSON(L){const G=Object.assign({},F);return L.canSubscribe!==void 0&&L.canSubscribe!==null?G.canSubscribe=Boolean(L.canSubscribe):G.canSubscribe=!1,L.canPublish!==void 0&&L.canPublish!==null?G.canPublish=Boolean(L.canPublish):G.canPublish=!1,L.canPublishData!==void 0&&L.canPublishData!==null?G.canPublishData=Boolean(L.canPublishData):G.canPublishData=!1,G},toJSON(L){const G={};return L.canSubscribe!==void 0&&(G.canSubscribe=L.canSubscribe),L.canPublish!==void 0&&(G.canPublish=L.canPublish),L.canPublishData!==void 0&&(G.canPublishData=L.canPublishData),G},fromPartial(L){const G=Object.assign({},F);return L.canSubscribe!==void 0&&L.canSubscribe!==null?G.canSubscribe=L.canSubscribe:G.canSubscribe=!1,L.canPublish!==void 0&&L.canPublish!==null?G.canPublish=L.canPublish:G.canPublish=!1,L.canPublishData!==void 0&&L.canPublishData!==null?G.canPublishData=L.canPublishData:G.canPublishData=!1,G}};const j={room:"",identity:"",metadata:""};a.UpdateParticipantRequest={encode(L,G=c.default.Writer.create()){return L.room!==""&&G.uint32(10).string(L.room),L.identity!==""&&G.uint32(18).string(L.identity),L.metadata!==""&&G.uint32(26).string(L.metadata),L.permission!==void 0&&a.ParticipantPermission.encode(L.permission,G.uint32(34).fork()).ldelim(),G},decode(L,G){const W=L instanceof c.default.Reader?L:new c.default.Reader(L);let ie=G===void 0?W.len:W.pos+G;const x=Object.assign({},j);for(;W.pos<ie;){const Y=W.uint32();switch(Y>>>3){case 1:x.room=W.string();break;case 2:x.identity=W.string();break;case 3:x.metadata=W.string();break;case 4:x.permission=a.ParticipantPermission.decode(W,W.uint32());break;default:W.skipType(Y&7);break}}return x},fromJSON(L){const G=Object.assign({},j);return L.room!==void 0&&L.room!==null?G.room=String(L.room):G.room="",L.identity!==void 0&&L.identity!==null?G.identity=String(L.identity):G.identity="",L.metadata!==void 0&&L.metadata!==null?G.metadata=String(L.metadata):G.metadata="",L.permission!==void 0&&L.permission!==null?G.permission=a.ParticipantPermission.fromJSON(L.permission):G.permission=void 0,G},toJSON(L){const G={};return L.room!==void 0&&(G.room=L.room),L.identity!==void 0&&(G.identity=L.identity),L.metadata!==void 0&&(G.metadata=L.metadata),L.permission!==void 0&&(G.permission=L.permission?a.ParticipantPermission.toJSON(L.permission):void 0),G},fromPartial(L){const G=Object.assign({},j);return L.room!==void 0&&L.room!==null?G.room=L.room:G.room="",L.identity!==void 0&&L.identity!==null?G.identity=L.identity:G.identity="",L.metadata!==void 0&&L.metadata!==null?G.metadata=L.metadata:G.metadata="",L.permission!==void 0&&L.permission!==null?G.permission=a.ParticipantPermission.fromPartial(L.permission):G.permission=void 0,G}};const T={room:"",identity:"",trackSids:"",subscribe:!1};a.UpdateSubscriptionsRequest={encode(L,G=c.default.Writer.create()){L.room!==""&&G.uint32(10).string(L.room),L.identity!==""&&G.uint32(18).string(L.identity);for(const W of L.trackSids)G.uint32(26).string(W);L.subscribe===!0&&G.uint32(32).bool(L.subscribe);for(const W of L.participantTracks)l.ParticipantTracks.encode(W,G.uint32(42).fork()).ldelim();return G},decode(L,G){const W=L instanceof c.default.Reader?L:new c.default.Reader(L);let ie=G===void 0?W.len:W.pos+G;const x=Object.assign({},T);for(x.trackSids=[],x.participantTracks=[];W.pos<ie;){const Y=W.uint32();switch(Y>>>3){case 1:x.room=W.string();break;case 2:x.identity=W.string();break;case 3:x.trackSids.push(W.string());break;case 4:x.subscribe=W.bool();break;case 5:x.participantTracks.push(l.ParticipantTracks.decode(W,W.uint32()));break;default:W.skipType(Y&7);break}}return x},fromJSON(L){const G=Object.assign({},T);if(G.trackSids=[],G.participantTracks=[],L.room!==void 0&&L.room!==null?G.room=String(L.room):G.room="",L.identity!==void 0&&L.identity!==null?G.identity=String(L.identity):G.identity="",L.trackSids!==void 0&&L.trackSids!==null)for(const W of L.trackSids)G.trackSids.push(String(W));if(L.subscribe!==void 0&&L.subscribe!==null?G.subscribe=Boolean(L.subscribe):G.subscribe=!1,L.participantTracks!==void 0&&L.participantTracks!==null)for(const W of L.participantTracks)G.participantTracks.push(l.ParticipantTracks.fromJSON(W));return G},toJSON(L){const G={};return L.room!==void 0&&(G.room=L.room),L.identity!==void 0&&(G.identity=L.identity),L.trackSids?G.trackSids=L.trackSids.map(W=>W):G.trackSids=[],L.subscribe!==void 0&&(G.subscribe=L.subscribe),L.participantTracks?G.participantTracks=L.participantTracks.map(W=>W?l.ParticipantTracks.toJSON(W):void 0):G.participantTracks=[],G},fromPartial(L){const G=Object.assign({},T);if(G.trackSids=[],G.participantTracks=[],L.room!==void 0&&L.room!==null?G.room=L.room:G.room="",L.identity!==void 0&&L.identity!==null?G.identity=L.identity:G.identity="",L.trackSids!==void 0&&L.trackSids!==null)for(const W of L.trackSids)G.trackSids.push(W);if(L.subscribe!==void 0&&L.subscribe!==null?G.subscribe=L.subscribe:G.subscribe=!1,L.participantTracks!==void 0&&L.participantTracks!==null)for(const W of L.participantTracks)G.participantTracks.push(l.ParticipantTracks.fromPartial(W));return G}};const D={};a.UpdateSubscriptionsResponse={encode(L,G=c.default.Writer.create()){return G},decode(L,G){const W=L instanceof c.default.Reader?L:new c.default.Reader(L);let ie=G===void 0?W.len:W.pos+G;const x=Object.assign({},D);for(;W.pos<ie;){const Y=W.uint32();switch(Y>>>3){default:W.skipType(Y&7);break}}return x},fromJSON(L){return Object.assign({},D)},toJSON(L){return{}},fromPartial(L){return Object.assign({},D)}};const J={room:"",kind:0,destinationSids:""};a.SendDataRequest={encode(L,G=c.default.Writer.create()){L.room!==""&&G.uint32(10).string(L.room),L.data.length!==0&&G.uint32(18).bytes(L.data),L.kind!==0&&G.uint32(24).int32(L.kind);for(const W of L.destinationSids)G.uint32(34).string(W);return G},decode(L,G){const W=L instanceof c.default.Reader?L:new c.default.Reader(L);let ie=G===void 0?W.len:W.pos+G;const x=Object.assign({},J);for(x.destinationSids=[],x.data=new Uint8Array;W.pos<ie;){const Y=W.uint32();switch(Y>>>3){case 1:x.room=W.string();break;case 2:x.data=W.bytes();break;case 3:x.kind=W.int32();break;case 4:x.destinationSids.push(W.string());break;default:W.skipType(Y&7);break}}return x},fromJSON(L){const G=Object.assign({},J);if(G.destinationSids=[],G.data=new Uint8Array,L.room!==void 0&&L.room!==null?G.room=String(L.room):G.room="",L.data!==void 0&&L.data!==null&&(G.data=M(L.data)),L.kind!==void 0&&L.kind!==null?G.kind=l.dataPacket_KindFromJSON(L.kind):G.kind=0,L.destinationSids!==void 0&&L.destinationSids!==null)for(const W of L.destinationSids)G.destinationSids.push(String(W));return G},toJSON(L){const G={};return L.room!==void 0&&(G.room=L.room),L.data!==void 0&&(G.data=te(L.data!==void 0?L.data:new Uint8Array)),L.kind!==void 0&&(G.kind=l.dataPacket_KindToJSON(L.kind)),L.destinationSids?G.destinationSids=L.destinationSids.map(W=>W):G.destinationSids=[],G},fromPartial(L){const G=Object.assign({},J);if(G.destinationSids=[],L.room!==void 0&&L.room!==null?G.room=L.room:G.room="",L.data!==void 0&&L.data!==null?G.data=L.data:G.data=new Uint8Array,L.kind!==void 0&&L.kind!==null?G.kind=L.kind:G.kind=0,L.destinationSids!==void 0&&L.destinationSids!==null)for(const W of L.destinationSids)G.destinationSids.push(W);return G}};const ee={};a.SendDataResponse={encode(L,G=c.default.Writer.create()){return G},decode(L,G){const W=L instanceof c.default.Reader?L:new c.default.Reader(L);let ie=G===void 0?W.len:W.pos+G;const x=Object.assign({},ee);for(;W.pos<ie;){const Y=W.uint32();switch(Y>>>3){default:W.skipType(Y&7);break}}return x},fromJSON(L){return Object.assign({},ee)},toJSON(L){return{}},fromPartial(L){return Object.assign({},ee)}};const z={room:"",metadata:""};a.UpdateRoomMetadataRequest={encode(L,G=c.default.Writer.create()){return L.room!==""&&G.uint32(10).string(L.room),L.metadata!==""&&G.uint32(18).string(L.metadata),G},decode(L,G){const W=L instanceof c.default.Reader?L:new c.default.Reader(L);let ie=G===void 0?W.len:W.pos+G;const x=Object.assign({},z);for(;W.pos<ie;){const Y=W.uint32();switch(Y>>>3){case 1:x.room=W.string();break;case 2:x.metadata=W.string();break;default:W.skipType(Y&7);break}}return x},fromJSON(L){const G=Object.assign({},z);return L.room!==void 0&&L.room!==null?G.room=String(L.room):G.room="",L.metadata!==void 0&&L.metadata!==null?G.metadata=String(L.metadata):G.metadata="",G},toJSON(L){const G={};return L.room!==void 0&&(G.room=L.room),L.metadata!==void 0&&(G.metadata=L.metadata),G},fromPartial(L){const G=Object.assign({},z);return L.room!==void 0&&L.room!==null?G.room=L.room:G.room="",L.metadata!==void 0&&L.metadata!==null?G.metadata=L.metadata:G.metadata="",G}};var ne=(()=>{if(typeof ne!="undefined")return ne;if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof commonjsGlobal!="undefined")return commonjsGlobal;throw"Unable to locate global object"})();const X=ne.atob||(L=>ne.Buffer.from(L,"base64").toString("binary"));function M(L){const G=X(L),W=new Uint8Array(G.length);for(let ie=0;ie<G.length;++ie)W[ie]=G.charCodeAt(ie);return W}const K=ne.btoa||(L=>ne.Buffer.from(L,"binary").toString("base64"));function te(L){const G=[];for(const W of L)G.push(String.fromCharCode(W));return K(G.join(""))}c.default.util.Long!==d.default&&(c.default.util.Long=d.default,c.default.configure())})(livekit_room);var TwirpRPC={},axios$2={exports:{}},bind$2=function a(s,d){return function(){for(var l=new Array(arguments.length),h=0;h<l.length;h++)l[h]=arguments[h];return s.apply(d,l)}},bind$1=bind$2,toString=Object.prototype.toString;function isArray$1(a){return toString.call(a)==="[object Array]"}function isUndefined(a){return typeof a=="undefined"}function isBuffer(a){return a!==null&&!isUndefined(a)&&a.constructor!==null&&!isUndefined(a.constructor)&&typeof a.constructor.isBuffer=="function"&&a.constructor.isBuffer(a)}function isArrayBuffer(a){return toString.call(a)==="[object ArrayBuffer]"}function isFormData(a){return typeof FormData!="undefined"&&a instanceof FormData}function isArrayBufferView(a){var s;return typeof ArrayBuffer!="undefined"&&ArrayBuffer.isView?s=ArrayBuffer.isView(a):s=a&&a.buffer&&a.buffer instanceof ArrayBuffer,s}function isString(a){return typeof a=="string"}function isNumber(a){return typeof a=="number"}function isObject$2(a){return a!==null&&typeof a=="object"}function isPlainObject(a){if(toString.call(a)!=="[object Object]")return!1;var s=Object.getPrototypeOf(a);return s===null||s===Object.prototype}function isDate(a){return toString.call(a)==="[object Date]"}function isFile(a){return toString.call(a)==="[object File]"}function isBlob(a){return toString.call(a)==="[object Blob]"}function isFunction(a){return toString.call(a)==="[object Function]"}function isStream(a){return isObject$2(a)&&isFunction(a.pipe)}function isURLSearchParams(a){return typeof URLSearchParams!="undefined"&&a instanceof URLSearchParams}function trim$1(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function isStandardBrowserEnv(){return typeof navigator!="undefined"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")?!1:typeof window!="undefined"&&typeof document!="undefined"}function forEach(a,s){if(!(a===null||typeof a=="undefined"))if(typeof a!="object"&&(a=[a]),isArray$1(a))for(var d=0,c=a.length;d<c;d++)s.call(null,a[d],d,a);else for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&s.call(null,a[l],l,a)}function merge(){var a={};function s(l,h){isPlainObject(a[h])&&isPlainObject(l)?a[h]=merge(a[h],l):isPlainObject(l)?a[h]=merge({},l):isArray$1(l)?a[h]=l.slice():a[h]=l}for(var d=0,c=arguments.length;d<c;d++)forEach(arguments[d],s);return a}function extend(a,s,d){return forEach(s,function(l,h){d&&typeof l=="function"?a[h]=bind$1(l,d):a[h]=l}),a}function stripBOM(a){return a.charCodeAt(0)===65279&&(a=a.slice(1)),a}var utils$d={isArray:isArray$1,isArrayBuffer,isBuffer,isFormData,isArrayBufferView,isString,isNumber,isObject:isObject$2,isPlainObject,isUndefined,isDate,isFile,isBlob,isFunction,isStream,isURLSearchParams,isStandardBrowserEnv,forEach,merge,extend,trim:trim$1,stripBOM},utils$c=utils$d;function encode(a){return encodeURIComponent(a).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var buildURL$2=function a(s,d,c){if(!d)return s;var l;if(c)l=c(d);else if(utils$c.isURLSearchParams(d))l=d.toString();else{var h=[];utils$c.forEach(d,function(_,E){_===null||typeof _=="undefined"||(utils$c.isArray(_)?E=E+"[]":_=[_],utils$c.forEach(_,function(P){utils$c.isDate(P)?P=P.toISOString():utils$c.isObject(P)&&(P=JSON.stringify(P)),h.push(encode(E)+"="+encode(P))}))}),l=h.join("&")}if(l){var p=s.indexOf("#");p!==-1&&(s=s.slice(0,p)),s+=(s.indexOf("?")===-1?"?":"&")+l}return s},utils$b=utils$d;function InterceptorManager$1(){this.handlers=[]}InterceptorManager$1.prototype.use=function a(s,d,c){return this.handlers.push({fulfilled:s,rejected:d,synchronous:c?c.synchronous:!1,runWhen:c?c.runWhen:null}),this.handlers.length-1},InterceptorManager$1.prototype.eject=function a(s){this.handlers[s]&&(this.handlers[s]=null)},InterceptorManager$1.prototype.forEach=function a(s){utils$b.forEach(this.handlers,function(c){c!==null&&s(c)})};var InterceptorManager_1=InterceptorManager$1,utils$a=utils$d,normalizeHeaderName$1=function a(s,d){utils$a.forEach(s,function(l,h){h!==d&&h.toUpperCase()===d.toUpperCase()&&(s[d]=l,delete s[h])})},enhanceError$2=function a(s,d,c,l,h){return s.config=d,c&&(s.code=c),s.request=l,s.response=h,s.isAxiosError=!0,s.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},s},enhanceError$1=enhanceError$2,createError$2=function a(s,d,c,l,h){var p=new Error(s);return enhanceError$1(p,d,c,l,h)},createError$1=createError$2,settle$1=function a(s,d,c){var l=c.config.validateStatus;!c.status||!l||l(c.status)?s(c):d(createError$1("Request failed with status code "+c.status,c.config,null,c.request,c))},utils$9=utils$d,cookies$1=utils$9.isStandardBrowserEnv()?function a(){return{write:function(d,c,l,h,p,y){var _=[];_.push(d+"="+encodeURIComponent(c)),utils$9.isNumber(l)&&_.push("expires="+new Date(l).toGMTString()),utils$9.isString(h)&&_.push("path="+h),utils$9.isString(p)&&_.push("domain="+p),y===!0&&_.push("secure"),document.cookie=_.join("; ")},read:function(d){var c=document.cookie.match(new RegExp("(^|;\\s*)("+d+")=([^;]*)"));return c?decodeURIComponent(c[3]):null},remove:function(d){this.write(d,"",Date.now()-864e5)}}}():function a(){return{write:function(){},read:function(){return null},remove:function(){}}}(),isAbsoluteURL$1=function a(s){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(s)},combineURLs$1=function a(s,d){return d?s.replace(/\/+$/,"")+"/"+d.replace(/^\/+/,""):s},isAbsoluteURL=isAbsoluteURL$1,combineURLs=combineURLs$1,buildFullPath$1=function a(s,d){return s&&!isAbsoluteURL(d)?combineURLs(s,d):d},utils$8=utils$d,ignoreDuplicateOf=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],parseHeaders$1=function a(s){var d={},c,l,h;return s&&utils$8.forEach(s.split(`
`),function(y){if(h=y.indexOf(":"),c=utils$8.trim(y.substr(0,h)).toLowerCase(),l=utils$8.trim(y.substr(h+1)),c){if(d[c]&&ignoreDuplicateOf.indexOf(c)>=0)return;c==="set-cookie"?d[c]=(d[c]?d[c]:[]).concat([l]):d[c]=d[c]?d[c]+", "+l:l}}),d},utils$7=utils$d,isURLSameOrigin$1=utils$7.isStandardBrowserEnv()?function a(){var s=/(msie|trident)/i.test(navigator.userAgent),d=document.createElement("a"),c;function l(h){var p=h;return s&&(d.setAttribute("href",p),p=d.href),d.setAttribute("href",p),{href:d.href,protocol:d.protocol?d.protocol.replace(/:$/,""):"",host:d.host,search:d.search?d.search.replace(/^\?/,""):"",hash:d.hash?d.hash.replace(/^#/,""):"",hostname:d.hostname,port:d.port,pathname:d.pathname.charAt(0)==="/"?d.pathname:"/"+d.pathname}}return c=l(window.location.href),function(p){var y=utils$7.isString(p)?l(p):p;return y.protocol===c.protocol&&y.host===c.host}}():function a(){return function(){return!0}}(),utils$6=utils$d,settle=settle$1,cookies=cookies$1,buildURL$1=buildURL$2,buildFullPath=buildFullPath$1,parseHeaders=parseHeaders$1,isURLSameOrigin=isURLSameOrigin$1,createError=createError$2,xhr=function a(s){return new Promise(function(c,l){var h=s.data,p=s.headers,y=s.responseType;utils$6.isFormData(h)&&delete p["Content-Type"];var _=new XMLHttpRequest;if(s.auth){var E=s.auth.username||"",O=s.auth.password?unescape(encodeURIComponent(s.auth.password)):"";p.Authorization="Basic "+btoa(E+":"+O)}var P=buildFullPath(s.baseURL,s.url);_.open(s.method.toUpperCase(),buildURL$1(P,s.params,s.paramsSerializer),!0),_.timeout=s.timeout;function C(){if(!!_){var q="getAllResponseHeaders"in _?parseHeaders(_.getAllResponseHeaders()):null,U=!y||y==="text"||y==="json"?_.responseText:_.response,F={data:U,status:_.status,statusText:_.statusText,headers:q,config:s,request:_};settle(c,l,F),_=null}}if("onloadend"in _?_.onloadend=C:_.onreadystatechange=function(){!_||_.readyState!==4||_.status===0&&!(_.responseURL&&_.responseURL.indexOf("file:")===0)||setTimeout(C)},_.onabort=function(){!_||(l(createError("Request aborted",s,"ECONNABORTED",_)),_=null)},_.onerror=function(){l(createError("Network Error",s,null,_)),_=null},_.ontimeout=function(){var U="timeout of "+s.timeout+"ms exceeded";s.timeoutErrorMessage&&(U=s.timeoutErrorMessage),l(createError(U,s,s.transitional&&s.transitional.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",_)),_=null},utils$6.isStandardBrowserEnv()){var A=(s.withCredentials||isURLSameOrigin(P))&&s.xsrfCookieName?cookies.read(s.xsrfCookieName):void 0;A&&(p[s.xsrfHeaderName]=A)}"setRequestHeader"in _&&utils$6.forEach(p,function(U,F){typeof h=="undefined"&&F.toLowerCase()==="content-type"?delete p[F]:_.setRequestHeader(F,U)}),utils$6.isUndefined(s.withCredentials)||(_.withCredentials=!!s.withCredentials),y&&y!=="json"&&(_.responseType=s.responseType),typeof s.onDownloadProgress=="function"&&_.addEventListener("progress",s.onDownloadProgress),typeof s.onUploadProgress=="function"&&_.upload&&_.upload.addEventListener("progress",s.onUploadProgress),s.cancelToken&&s.cancelToken.promise.then(function(U){!_||(_.abort(),l(U),_=null)}),h||(h=null),_.send(h)})},utils$5=utils$d,normalizeHeaderName=normalizeHeaderName$1,enhanceError=enhanceError$2,DEFAULT_CONTENT_TYPE={"Content-Type":"application/x-www-form-urlencoded"};function setContentTypeIfUnset(a,s){!utils$5.isUndefined(a)&&utils$5.isUndefined(a["Content-Type"])&&(a["Content-Type"]=s)}function getDefaultAdapter(){var a;return(typeof XMLHttpRequest!="undefined"||typeof process!="undefined"&&Object.prototype.toString.call(process)==="[object process]")&&(a=xhr),a}function stringifySafely(a,s,d){if(utils$5.isString(a))try{return(s||JSON.parse)(a),utils$5.trim(a)}catch(c){if(c.name!=="SyntaxError")throw c}return(d||JSON.stringify)(a)}var defaults$3={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:getDefaultAdapter(),transformRequest:[function a(s,d){return normalizeHeaderName(d,"Accept"),normalizeHeaderName(d,"Content-Type"),utils$5.isFormData(s)||utils$5.isArrayBuffer(s)||utils$5.isBuffer(s)||utils$5.isStream(s)||utils$5.isFile(s)||utils$5.isBlob(s)?s:utils$5.isArrayBufferView(s)?s.buffer:utils$5.isURLSearchParams(s)?(setContentTypeIfUnset(d,"application/x-www-form-urlencoded;charset=utf-8"),s.toString()):utils$5.isObject(s)||d&&d["Content-Type"]==="application/json"?(setContentTypeIfUnset(d,"application/json"),stringifySafely(s)):s}],transformResponse:[function a(s){var d=this.transitional,c=d&&d.silentJSONParsing,l=d&&d.forcedJSONParsing,h=!c&&this.responseType==="json";if(h||l&&utils$5.isString(s)&&s.length)try{return JSON.parse(s)}catch(p){if(h)throw p.name==="SyntaxError"?enhanceError(p,this,"E_JSON_PARSE"):p}return s}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function a(s){return s>=200&&s<300}};defaults$3.headers={common:{Accept:"application/json, text/plain, */*"}},utils$5.forEach(["delete","get","head"],function a(s){defaults$3.headers[s]={}}),utils$5.forEach(["post","put","patch"],function a(s){defaults$3.headers[s]=utils$5.merge(DEFAULT_CONTENT_TYPE)});var defaults_1=defaults$3,utils$4=utils$d,defaults$2=defaults_1,transformData$1=function a(s,d,c){var l=this||defaults$2;return utils$4.forEach(c,function(p){s=p.call(l,s,d)}),s},isCancel$1=function a(s){return!!(s&&s.__CANCEL__)},utils$3=utils$d,transformData=transformData$1,isCancel=isCancel$1,defaults$1=defaults_1;function throwIfCancellationRequested(a){a.cancelToken&&a.cancelToken.throwIfRequested()}var dispatchRequest$1=function a(s){throwIfCancellationRequested(s),s.headers=s.headers||{},s.data=transformData.call(s,s.data,s.headers,s.transformRequest),s.headers=utils$3.merge(s.headers.common||{},s.headers[s.method]||{},s.headers),utils$3.forEach(["delete","get","head","post","put","patch","common"],function(l){delete s.headers[l]});var d=s.adapter||defaults$1.adapter;return d(s).then(function(l){return throwIfCancellationRequested(s),l.data=transformData.call(s,l.data,l.headers,s.transformResponse),l},function(l){return isCancel(l)||(throwIfCancellationRequested(s),l&&l.response&&(l.response.data=transformData.call(s,l.response.data,l.response.headers,s.transformResponse))),Promise.reject(l)})},utils$2=utils$d,mergeConfig$2=function a(s,d){d=d||{};var c={},l=["url","method","data"],h=["headers","auth","proxy","params"],p=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],y=["validateStatus"];function _(C,A){return utils$2.isPlainObject(C)&&utils$2.isPlainObject(A)?utils$2.merge(C,A):utils$2.isPlainObject(A)?utils$2.merge({},A):utils$2.isArray(A)?A.slice():A}function E(C){utils$2.isUndefined(d[C])?utils$2.isUndefined(s[C])||(c[C]=_(void 0,s[C])):c[C]=_(s[C],d[C])}utils$2.forEach(l,function(A){utils$2.isUndefined(d[A])||(c[A]=_(void 0,d[A]))}),utils$2.forEach(h,E),utils$2.forEach(p,function(A){utils$2.isUndefined(d[A])?utils$2.isUndefined(s[A])||(c[A]=_(void 0,s[A])):c[A]=_(void 0,d[A])}),utils$2.forEach(y,function(A){A in d?c[A]=_(s[A],d[A]):A in s&&(c[A]=_(void 0,s[A]))});var O=l.concat(h).concat(p).concat(y),P=Object.keys(s).concat(Object.keys(d)).filter(function(A){return O.indexOf(A)===-1});return utils$2.forEach(P,E),c};const name="axios",version="0.21.4",description="Promise based HTTP client for the browser and node.js",main="index.js",scripts={test:"grunt test",start:"node ./sandbox/server.js",build:"NODE_ENV=production grunt build",preversion:"npm test",version:"npm run build && grunt version && git add -A dist && git add CHANGELOG.md bower.json package.json",postversion:"git push && git push --tags",examples:"node ./examples/server.js",coveralls:"cat coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js",fix:"eslint --fix lib/**/*.js"},repository={type:"git",url:"https://github.com/axios/axios.git"},keywords=["xhr","http","ajax","promise","node"],author="Matt Zabriskie",license="MIT",bugs={url:"https://github.com/axios/axios/issues"},homepage="https://axios-http.com",devDependencies={coveralls:"^3.0.0","es6-promise":"^4.2.4",grunt:"^1.3.0","grunt-banner":"^0.6.0","grunt-cli":"^1.2.0","grunt-contrib-clean":"^1.1.0","grunt-contrib-watch":"^1.0.0","grunt-eslint":"^23.0.0","grunt-karma":"^4.0.0","grunt-mocha-test":"^0.13.3","grunt-ts":"^6.0.0-beta.19","grunt-webpack":"^4.0.2","istanbul-instrumenter-loader":"^1.0.0","jasmine-core":"^2.4.1",karma:"^6.3.2","karma-chrome-launcher":"^3.1.0","karma-firefox-launcher":"^2.1.0","karma-jasmine":"^1.1.1","karma-jasmine-ajax":"^0.1.13","karma-safari-launcher":"^1.0.0","karma-sauce-launcher":"^4.3.6","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.8","karma-webpack":"^4.0.2","load-grunt-tasks":"^3.5.2",minimist:"^1.2.0",mocha:"^8.2.1",sinon:"^4.5.0","terser-webpack-plugin":"^4.2.3",typescript:"^4.0.5","url-search-params":"^0.10.0",webpack:"^4.44.2","webpack-dev-server":"^3.11.0"},browser={"./lib/adapters/http.js":"./lib/adapters/xhr.js"},jsdelivr="dist/axios.min.js",unpkg="dist/axios.min.js",typings="./index.d.ts",dependencies={"follow-redirects":"^1.14.0"},bundlesize=[{path:"./dist/axios.min.js",threshold:"5kB"}];var require$$0={name,version,description,main,scripts,repository,keywords,author,license,bugs,homepage,devDependencies,browser,jsdelivr,unpkg,typings,dependencies,bundlesize},pkg=require$$0,validators$1={};["object","boolean","number","function","string","symbol"].forEach(function(a,s){validators$1[a]=function(c){return typeof c===a||"a"+(s<1?"n ":" ")+a}});var deprecatedWarnings={},currentVerArr=pkg.version.split(".");function isOlderVersion(a,s){for(var d=s?s.split("."):currentVerArr,c=a.split("."),l=0;l<3;l++){if(d[l]>c[l])return!0;if(d[l]<c[l])return!1}return!1}validators$1.transitional=function a(s,d,c){var l=d&&isOlderVersion(d);function h(p,y){return"[Axios v"+pkg.version+"] Transitional option '"+p+"'"+y+(c?". "+c:"")}return function(p,y,_){if(s===!1)throw new Error(h(y," has been removed in "+d));return l&&!deprecatedWarnings[y]&&(deprecatedWarnings[y]=!0,console.warn(h(y," has been deprecated since v"+d+" and will be removed in the near future"))),s?s(p,y,_):!0}};function assertOptions(a,s,d){if(typeof a!="object")throw new TypeError("options must be an object");for(var c=Object.keys(a),l=c.length;l-- >0;){var h=c[l],p=s[h];if(p){var y=a[h],_=y===void 0||p(y,h,a);if(_!==!0)throw new TypeError("option "+h+" must be "+_);continue}if(d!==!0)throw Error("Unknown option "+h)}}var validator$1={isOlderVersion,assertOptions,validators:validators$1},utils$1=utils$d,buildURL=buildURL$2,InterceptorManager=InterceptorManager_1,dispatchRequest=dispatchRequest$1,mergeConfig$1=mergeConfig$2,validator=validator$1,validators=validator.validators;function Axios$1(a){this.defaults=a,this.interceptors={request:new InterceptorManager,response:new InterceptorManager}}Axios$1.prototype.request=function a(s){typeof s=="string"?(s=arguments[1]||{},s.url=arguments[0]):s=s||{},s=mergeConfig$1(this.defaults,s),s.method?s.method=s.method.toLowerCase():this.defaults.method?s.method=this.defaults.method.toLowerCase():s.method="get";var d=s.transitional;d!==void 0&&validator.assertOptions(d,{silentJSONParsing:validators.transitional(validators.boolean,"1.0.0"),forcedJSONParsing:validators.transitional(validators.boolean,"1.0.0"),clarifyTimeoutError:validators.transitional(validators.boolean,"1.0.0")},!1);var c=[],l=!0;this.interceptors.request.forEach(function(C){typeof C.runWhen=="function"&&C.runWhen(s)===!1||(l=l&&C.synchronous,c.unshift(C.fulfilled,C.rejected))});var h=[];this.interceptors.response.forEach(function(C){h.push(C.fulfilled,C.rejected)});var p;if(!l){var y=[dispatchRequest,void 0];for(Array.prototype.unshift.apply(y,c),y=y.concat(h),p=Promise.resolve(s);y.length;)p=p.then(y.shift(),y.shift());return p}for(var _=s;c.length;){var E=c.shift(),O=c.shift();try{_=E(_)}catch(P){O(P);break}}try{p=dispatchRequest(_)}catch(P){return Promise.reject(P)}for(;h.length;)p=p.then(h.shift(),h.shift());return p},Axios$1.prototype.getUri=function a(s){return s=mergeConfig$1(this.defaults,s),buildURL(s.url,s.params,s.paramsSerializer).replace(/^\?/,"")},utils$1.forEach(["delete","get","head","options"],function a(s){Axios$1.prototype[s]=function(d,c){return this.request(mergeConfig$1(c||{},{method:s,url:d,data:(c||{}).data}))}}),utils$1.forEach(["post","put","patch"],function a(s){Axios$1.prototype[s]=function(d,c,l){return this.request(mergeConfig$1(l||{},{method:s,url:d,data:c}))}});var Axios_1=Axios$1;function Cancel$1(a){this.message=a}Cancel$1.prototype.toString=function a(){return"Cancel"+(this.message?": "+this.message:"")},Cancel$1.prototype.__CANCEL__=!0;var Cancel_1=Cancel$1,Cancel=Cancel_1;function CancelToken(a){if(typeof a!="function")throw new TypeError("executor must be a function.");var s;this.promise=new Promise(function(l){s=l});var d=this;a(function(l){d.reason||(d.reason=new Cancel(l),s(d.reason))})}CancelToken.prototype.throwIfRequested=function a(){if(this.reason)throw this.reason},CancelToken.source=function a(){var s,d=new CancelToken(function(l){s=l});return{token:d,cancel:s}};var CancelToken_1=CancelToken,spread=function a(s){return function(c){return s.apply(null,c)}},isAxiosError=function a(s){return typeof s=="object"&&s.isAxiosError===!0},utils=utils$d,bind=bind$2,Axios=Axios_1,mergeConfig=mergeConfig$2,defaults=defaults_1;function createInstance(a){var s=new Axios(a),d=bind(Axios.prototype.request,s);return utils.extend(d,Axios.prototype,s),utils.extend(d,s),d}var axios$1=createInstance(defaults);axios$1.Axios=Axios,axios$1.create=function a(s){return createInstance(mergeConfig(axios$1.defaults,s))},axios$1.Cancel=Cancel_1,axios$1.CancelToken=CancelToken_1,axios$1.isCancel=isCancel$1,axios$1.all=function a(s){return Promise.all(s)},axios$1.spread=spread,axios$1.isAxiosError=isAxiosError,axios$2.exports=axios$1,axios$2.exports.default=axios$1;var axios=axios$2.exports,mapObj$1={exports:{}};const isObject$1=a=>typeof a=="object"&&a!==null,mapObjectSkip=Symbol("skip"),isObjectCustom=a=>isObject$1(a)&&!(a instanceof RegExp)&&!(a instanceof Error)&&!(a instanceof Date),mapObject=(a,s,d,c=new WeakMap)=>{if(d={deep:!1,target:{},...d},c.has(a))return c.get(a);c.set(a,d.target);const{target:l}=d;delete d.target;const h=p=>p.map(y=>isObjectCustom(y)?mapObject(y,s,d,c):y);if(Array.isArray(a))return h(a);for(const[p,y]of Object.entries(a)){const _=s(p,y,a);if(_===mapObjectSkip)continue;let[E,O,{shouldRecurse:P=!0}={}]=_;E!=="__proto__"&&(d.deep&&P&&isObjectCustom(O)&&(O=Array.isArray(O)?h(O):mapObject(O,s,d,c)),l[E]=O)}return l};mapObj$1.exports=(a,s,d)=>{if(!isObject$1(a))throw new TypeError(`Expected an object, got \`${a}\` (${typeof a})`);return mapObject(a,s,d)},mapObj$1.exports.mapObjectSkip=mapObjectSkip;var camelcase={exports:{}};const UPPERCASE=/[\p{Lu}]/u,LOWERCASE=/[\p{Ll}]/u,LEADING_CAPITAL=/^[\p{Lu}](?![\p{Lu}])/gu,IDENTIFIER=/([\p{Alpha}\p{N}_]|$)/u,SEPARATORS=/[_.\- ]+/,LEADING_SEPARATORS=new RegExp("^"+SEPARATORS.source),SEPARATORS_AND_IDENTIFIER=new RegExp(SEPARATORS.source+IDENTIFIER.source,"gu"),NUMBERS_AND_IDENTIFIER=new RegExp("\\d+"+IDENTIFIER.source,"gu"),preserveCamelCase=(a,s,d)=>{let c=!1,l=!1,h=!1;for(let p=0;p<a.length;p++){const y=a[p];c&&UPPERCASE.test(y)?(a=a.slice(0,p)+"-"+a.slice(p),c=!1,h=l,l=!0,p++):l&&h&&LOWERCASE.test(y)?(a=a.slice(0,p-1)+"-"+a.slice(p-1),h=l,l=!1,c=!0):(c=s(y)===y&&d(y)!==y,h=l,l=d(y)===y&&s(y)!==y)}return a},preserveConsecutiveUppercase=(a,s)=>(LEADING_CAPITAL.lastIndex=0,a.replace(LEADING_CAPITAL,d=>s(d))),postProcess=(a,s)=>(SEPARATORS_AND_IDENTIFIER.lastIndex=0,NUMBERS_AND_IDENTIFIER.lastIndex=0,a.replace(SEPARATORS_AND_IDENTIFIER,(d,c)=>s(c)).replace(NUMBERS_AND_IDENTIFIER,d=>s(d))),camelCase$1=(a,s)=>{if(!(typeof a=="string"||Array.isArray(a)))throw new TypeError("Expected the input to be `string | string[]`");if(s={pascalCase:!1,preserveConsecutiveUppercase:!1,...s},Array.isArray(a)?a=a.map(h=>h.trim()).filter(h=>h.length).join("-"):a=a.trim(),a.length===0)return"";const d=s.locale===!1?h=>h.toLowerCase():h=>h.toLocaleLowerCase(s.locale),c=s.locale===!1?h=>h.toUpperCase():h=>h.toLocaleUpperCase(s.locale);return a.length===1?s.pascalCase?c(a):d(a):(a!==d(a)&&(a=preserveCamelCase(a,d,c)),a=a.replace(LEADING_SEPARATORS,""),s.preserveConsecutiveUppercase?a=preserveConsecutiveUppercase(a,d):a=d(a),s.pascalCase&&(a=c(a.charAt(0))+a.slice(1)),postProcess(a,c))};camelcase.exports=camelCase$1,camelcase.exports.default=camelCase$1;class QuickLRU{constructor(s={}){if(!(s.maxSize&&s.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");this.maxSize=s.maxSize,this.onEviction=s.onEviction,this.cache=new Map,this.oldCache=new Map,this._size=0}_set(s,d){if(this.cache.set(s,d),this._size++,this._size>=this.maxSize){if(this._size=0,typeof this.onEviction=="function")for(const[c,l]of this.oldCache.entries())this.onEviction(c,l);this.oldCache=this.cache,this.cache=new Map}}get(s){if(this.cache.has(s))return this.cache.get(s);if(this.oldCache.has(s)){const d=this.oldCache.get(s);return this.oldCache.delete(s),this._set(s,d),d}}set(s,d){return this.cache.has(s)?this.cache.set(s,d):this._set(s,d),this}has(s){return this.cache.has(s)||this.oldCache.has(s)}peek(s){if(this.cache.has(s))return this.cache.get(s);if(this.oldCache.has(s))return this.oldCache.get(s)}delete(s){const d=this.cache.delete(s);return d&&this._size--,this.oldCache.delete(s)||d}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}*keys(){for(const[s]of this)yield s}*values(){for(const[,s]of this)yield s}*[Symbol.iterator](){for(const s of this.cache)yield s;for(const s of this.oldCache){const[d]=s;this.cache.has(d)||(yield s)}}get size(){let s=0;for(const d of this.oldCache.keys())this.cache.has(d)||s++;return Math.min(this._size+s,this.maxSize)}}var quickLru=QuickLRU;const mapObj=mapObj$1.exports,camelCase=camelcase.exports,QuickLru=quickLru,has=(a,s)=>a.some(d=>typeof d=="string"?d===s:(d.lastIndex=0,d.test(s))),cache$1=new QuickLru({maxSize:1e5}),isObject=a=>typeof a=="object"&&a!==null&&!(a instanceof RegExp)&&!(a instanceof Error)&&!(a instanceof Date),camelCaseConvert=(a,s)=>{if(!isObject(a))return a;s={deep:!1,pascalCase:!1,...s};const{exclude:d,pascalCase:c,stopPaths:l,deep:h}=s,p=new Set(l),y=_=>(E,O)=>{if(h&&isObject(O)){const P=_===void 0?E:`${_}.${E}`;p.has(P)||(O=mapObj(O,y(P)))}if(!(d&&has(d,E))){const P=c?`${E}_`:E;if(cache$1.has(P))E=cache$1.get(P);else{const C=camelCase(E,{pascalCase:c,locale:!1});E.length<100&&cache$1.set(P,C),E=C}}return[E,O]};return mapObj(a,y(void 0))};var camelcaseKeys=(a,s)=>Array.isArray(a)?Object.keys(a).map(d=>camelCaseConvert(a[d],s)):camelCaseConvert(a,s),__importDefault=commonjsGlobal&&commonjsGlobal.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(TwirpRPC,"__esModule",{value:!0}),TwirpRPC.TwirpRpc=TwirpRPC.livekitPackage=void 0;const axios_1=__importDefault(axios),camelcase_keys_1=__importDefault(camelcaseKeys),defaultPrefix="/twirp";TwirpRPC.livekitPackage="livekit";class TwirpRpc{constructor(s,d,c,l){this.host=s,this.pkg=d,this.prefix=c||defaultPrefix;let h={baseURL:s};l!=null&&(h.headers={Host:l}),this.instance=axios_1.default.create(h)}request(s,d,c,l){return new Promise((h,p)=>{const y=`${this.prefix}/${this.pkg}.${s}/${d}`;this.instance.post(y,c,{headers:l}).then(_=>{h(camelcase_keys_1.default(_.data,{deep:!0}))}).catch(p)})}}TwirpRPC.TwirpRpc=TwirpRpc;var __awaiter=commonjsGlobal&&commonjsGlobal.__awaiter||function(a,s,d,c){function l(h){return h instanceof d?h:new d(function(p){p(h)})}return new(d||(d=Promise))(function(h,p){function y(O){try{E(c.next(O))}catch(P){p(P)}}function _(O){try{E(c.throw(O))}catch(P){p(P)}}function E(O){O.done?h(O.value):l(O.value).then(y,_)}E((c=c.apply(a,s||[])).next())})};Object.defineProperty(RoomServiceClient$1,"__esModule",{value:!0}),RoomServiceClient$1.RoomServiceClient=void 0;const livekit_models_1=livekit_models,livekit_room_1=livekit_room,TwirpRPC_1=TwirpRPC,svc="RoomService";class RoomServiceClient{constructor(s,d,c,l,h){this.rpc=new TwirpRPC_1.TwirpRpc(s,TwirpRPC_1.livekitPackage,void 0,h),this.apiKey=d,this.secret=c,this.jwt=l}createRoom(s){return __awaiter(this,void 0,void 0,function*(){const d=yield this.rpc.request(svc,"CreateRoom",livekit_room_1.CreateRoomRequest.toJSON(livekit_room_1.CreateRoomRequest.fromPartial(s)),this.authHeader({roomCreate:!0}));return livekit_models_1.Room.fromJSON(d)})}listRooms(s){return __awaiter(this,void 0,void 0,function*(){const d=yield this.rpc.request(svc,"ListRooms",livekit_room_1.ListRoomsRequest.toJSON({names:s!=null?s:[]}),this.authHeader({roomList:!0}));return livekit_room_1.ListRoomsResponse.fromJSON(d).rooms})}deleteRoom(s){return __awaiter(this,void 0,void 0,function*(){yield this.rpc.request(svc,"DeleteRoom",livekit_room_1.DeleteRoomRequest.toJSON({room:s}),this.authHeader({roomCreate:!0}))})}updateRoomMetadata(s,d){return __awaiter(this,void 0,void 0,function*(){const c=yield this.rpc.request(svc,"UpdateRoomMetadata",livekit_room_1.UpdateRoomMetadataRequest.toJSON({room:s,metadata:d}),this.authHeader({roomAdmin:!0,room:s}));return livekit_models_1.Room.fromJSON(c)})}listParticipants(s){return __awaiter(this,void 0,void 0,function*(){const d=yield this.rpc.request(svc,"ListParticipants",livekit_room_1.ListParticipantsRequest.toJSON({room:s}),this.authHeader({roomAdmin:!0,room:s}));return livekit_room_1.ListParticipantsResponse.fromJSON(d).participants})}getParticipant(s,d){return __awaiter(this,void 0,void 0,function*(){const c=yield this.rpc.request(svc,"GetParticipant",livekit_room_1.RoomParticipantIdentity.toJSON({room:s,identity:d}),this.authHeader({roomAdmin:!0,room:s}));return livekit_models_1.ParticipantInfo.fromJSON(c)})}removeParticipant(s,d){return __awaiter(this,void 0,void 0,function*(){yield this.rpc.request(svc,"RemoveParticipant",livekit_room_1.RoomParticipantIdentity.toJSON({room:s,identity:d}),this.authHeader({roomAdmin:!0,room:s}))})}mutePublishedTrack(s,d,c,l){return __awaiter(this,void 0,void 0,function*(){const h=livekit_room_1.MuteRoomTrackRequest.toJSON({room:s,identity:d,trackSid:c,muted:l}),p=yield this.rpc.request(svc,"MutePublishedTrack",h,this.authHeader({roomAdmin:!0,room:s}));return livekit_room_1.MuteRoomTrackResponse.fromJSON(p).track})}updateParticipant(s,d,c,l){return __awaiter(this,void 0,void 0,function*(){const h={room:s,identity:d,metadata:c||"",permission:l},p=yield this.rpc.request(svc,"UpdateParticipant",livekit_room_1.UpdateParticipantRequest.toJSON(h),this.authHeader({roomAdmin:!0,room:s}));return livekit_models_1.ParticipantInfo.fromJSON(p)})}updateSubscriptions(s,d,c,l){return __awaiter(this,void 0,void 0,function*(){const h=livekit_room_1.UpdateSubscriptionsRequest.toJSON({room:s,identity:d,trackSids:c,subscribe:l,participantTracks:[]});yield this.rpc.request(svc,"UpdateSubscriptions",h,this.authHeader({roomAdmin:!0,room:s}))})}sendData(s,d,c,l=[]){return __awaiter(this,void 0,void 0,function*(){const h=livekit_room_1.SendDataRequest.toJSON({room:s,data:d,kind:c,destinationSids:l});yield this.rpc.request(svc,"SendData",h,this.authHeader({roomAdmin:!0,room:s}))})}authHeader(s){if(this.jwt!=null)return{Authorization:`Bearer ${this.jwt}`}}}RoomServiceClient$1.RoomServiceClient=RoomServiceClient,function(a){var s=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(l,h,p,y){y===void 0&&(y=p),Object.defineProperty(l,y,{enumerable:!0,get:function(){return h[p]}})}:function(l,h,p,y){y===void 0&&(y=p),l[y]=h[p]}),d=commonjsGlobal&&commonjsGlobal.__exportStar||function(l,h){for(var p in l)p!=="default"&&!Object.prototype.hasOwnProperty.call(h,p)&&s(h,l,p)};Object.defineProperty(a,"__esModule",{value:!0}),a.TrackType=a.TrackInfo=a.Room=a.ParticipantInfo_State=a.ParticipantInfo=a.DataPacket_Kind=void 0,d(grants,a);var c=livekit_models;Object.defineProperty(a,"DataPacket_Kind",{enumerable:!0,get:function(){return c.DataPacket_Kind}}),Object.defineProperty(a,"ParticipantInfo",{enumerable:!0,get:function(){return c.ParticipantInfo}}),Object.defineProperty(a,"ParticipantInfo_State",{enumerable:!0,get:function(){return c.ParticipantInfo_State}}),Object.defineProperty(a,"Room",{enumerable:!0,get:function(){return c.Room}}),Object.defineProperty(a,"TrackInfo",{enumerable:!0,get:function(){return c.TrackInfo}}),Object.defineProperty(a,"TrackType",{enumerable:!0,get:function(){return c.TrackType}}),d(RoomServiceClient$1,a)}(dist);var SpecialEvent=(a=>(a.Chat="Chat",a))(SpecialEvent||{});const decoder$1=new TextDecoder,encoder$1=new TextEncoder;class RoomsManager{constructor(){this.rooms=new Map,this.addRoom=this.addRoom.bind(this),this.ensureRoom=this.ensureRoom.bind(this),this.removeRoom=this.removeRoom.bind(this)}addRoom(s,d,c){const l=new RoomContext(s,d,c,this);return this.rooms.set(d,l),l}ensureRoom(s,d,c){return this.rooms.get(d)?(this.rooms.get(d).token=c,this.rooms.get(d)):this.addRoom(s,d,c)}async removeRoom(s){const d=this.rooms.get(s);if(!dist$1.Room)throw new Error("room not found!");if(d.isConnecting)throw new Error("Cannot remove room: Room is in connecting state");d.livekitRoom&&await d.livekitRoom.disconnect(!0),this.rooms.delete(s)}}class RoomContext{constructor(s,d,c,l){this._baseUrl=s,this._connectListeners=[],this._roomEventListenerRegistry={},this._jwt=c,Object.values(dist$1.RoomEvent).forEach(h=>{this._roomEventListenerRegistry[h]=new Set}),this._localParticipantEventListenerRegistry={},Object.values(dist$1.ParticipantEvent).forEach(h=>{this._localParticipantEventListenerRegistry[h]=new Set}),this._specialEventListenerRegistry={},this._manager=l,this._chatHistory=[],this.roomName=d,this.audioTracks=[],this.participants=[],this.isConnecting=!1,this.subscribeToRoomEvent(dist$1.RoomEvent.DataReceived,(h,p,y)=>{const _=decoder$1.decode(h);switch(JSON.parse(_).type){case"ChatMessage":return this._appendChat(h,p,y);default:return}}),this.connect=this.connect.bind(this),this.subscribeToRoomEvent=this.subscribeToRoomEvent.bind(this),this.subscribeToConnect=this.subscribeToConnect.bind(this),this.subscribeToLocalParticipantEvent=this.subscribeToLocalParticipantEvent.bind(this),this.subscribeToSpecialEvent=this.subscribeToSpecialEvent.bind(this),this.unsubscribeFromRoomEvent=this.unsubscribeFromRoomEvent.bind(this),this.unsubscribeFromSpecialEvent=this.unsubscribeFromSpecialEvent.bind(this),this.unsubscribeFromConnect=this.unsubscribeFromConnect.bind(this),this.unsubscribeFromLocalParticipantEvent=this.unsubscribeFromLocalParticipantEvent.bind(this),this.sendChatMessage=this.sendChatMessage.bind(this),this.kickParticipant=this.kickParticipant.bind(this),this.updateParticipant=this.updateParticipant.bind(this),this.muteTrackAsAdmin=this.muteTrackAsAdmin.bind(this),this._updateParticipants=this._updateParticipants.bind(this),this.subscribeToRoomEvent(dist$1.RoomEvent.ParticipantConnected,this._updateParticipants),this.subscribeToRoomEvent(dist$1.RoomEvent.ParticipantDisconnected,this._updateParticipants),this.subscribeToRoomEvent(dist$1.RoomEvent.TrackSubscribed,this._updateParticipants),this.subscribeToRoomEvent(dist$1.RoomEvent.TrackUnsubscribed,this._updateParticipants),this.subscribeToRoomEvent(dist$1.RoomEvent.LocalTrackPublished,this._updateParticipants),this.subscribeToRoomEvent(dist$1.RoomEvent.LocalTrackUnpublished,this._updateParticipants),this.subscribeToRoomEvent(dist$1.RoomEvent.Disconnected,()=>{this.livekitRoom.removeAllListeners(),this.livekitRoom=null,this._updateParticipants()})}bindApiClient(s){this._apiClient=s}get isAdmin(){return o(this._jwt).video.roomAdmin}set isAdmin(s){log$1.warn("isAdmin cannot be set")}get token(){return this._jwt}set token(s){this._jwt=s}get url(){return this._baseUrl}set url(s){}get chatHistory(){return this._chatHistory}set chatHistory(s){this._chatHistory=s}_updateParticipants(){if(!this.livekitRoom||this.livekitRoom.state===dist$1.RoomState.Disconnected){this.participants=[];return}else{const s=Array.from(this.livekitRoom.participants.values()),d=[this.livekitRoom.localParticipant];d.push(...s),this.participants=d}}async kickParticipant(s){if(this._admin)this._admin.removeParticipant(this.roomName,s);else throw new Error("no admin permissions")}updateParticipant(s,d){if(this._admin){const c=JSON.stringify(d);this._admin.updateParticipant(this.roomName,s,c)}else throw new Error("no admin permissions")}muteTrackAsAdmin(s,d=!0){if(this._admin){const c=this.participants.find(l=>[...l.audioTracks.values(),...l.videoTracks.values()].find(h=>h.trackSid===s));if(!c){log$1.warn("Could not find participant for track:",{trackSid:s});return}this._admin.mutePublishedTrack(this.roomName,c==null?void 0:c.identity,s,d)}else throw new Error("no admin permissions")}_appendChat(s,d,c){const l=decoder$1.decode(s),h=JSON.parse(l),p=d.identity,y=d.name,_={...h,displayName:y,sender:p};this.chatHistory=[...this.chatHistory,_],this._triggerSpecialEvents("Chat",_)}subscribeToConnect(s){return this._connectListeners.push(s),()=>this.unsubscribeFromConnect(s)}unsubscribeFromConnect(s){this._connectListeners=this._connectListeners.filter(d=>d!==s)}subscribeToSpecialEvent(s,d){return this._specialEventListenerRegistry[s]||(this._specialEventListenerRegistry[s]=new Set),this._specialEventListenerRegistry[s].add(d),()=>{this.unsubscribeFromSpecialEvent(s,d)}}unsubscribeFromSpecialEvent(s,d){this._specialEventListenerRegistry[s]||(this._specialEventListenerRegistry[s]=new Set),this._specialEventListenerRegistry[s].delete(d)}_triggerSpecialEvents(s,...d){this._specialEventListenerRegistry[s]||(this._specialEventListenerRegistry[s]=new Set),this._specialEventListenerRegistry[s].forEach(c=>{c(...d)})}async connect(s={}){var d,c;try{return this.livekitRoom&&this.livekitRoom.state==="connected"?this.livekitRoom:this.isConnecting?null:(this.isConnecting=!0,this.livekitRoom=await dist$1.connect(`wss://${this._baseUrl}`,this._jwt,{logLevel:CoreContext.logLevel,...s}),this.isConnecting=!1,Object.values(dist$1.RoomEvent).forEach(l=>{this.livekitRoom.on(l,(...h)=>{this._roomEventListenerRegistry[l].forEach(p=>{p(...h)})})}),Object.values(dist$1.ParticipantEvent).forEach(l=>{this.livekitRoom.localParticipant.on(l,(...h)=>{this._localParticipantEventListenerRegistry[l].forEach(p=>{p(...h)})})}),this._updateParticipants(),this._connectListeners.forEach(l=>l(this.livekitRoom)),lib$2.LiveKitUtils.isRoomAdmin(this._jwt)?(log$1.info("Room: Granting admin permissions"),log$1.debug("Livekit server: ",(d=this._apiClient)==null?void 0:d.getLiveKitServer(!0)),this._admin=new dist.RoomServiceClient((c=this._apiClient)==null?void 0:c.getLiveKitServer(!0),void 0,void 0,this._jwt)):log$1.debug("Room: Not an admin"),this.livekitRoom)}catch(l){this.isConnecting=!1,log$1.error(l)}}subscribeToLocalParticipantEvent(s,d){return this._localParticipantEventListenerRegistry[s]||(this._localParticipantEventListenerRegistry[s]=new Set),this._localParticipantEventListenerRegistry[s].add(d),()=>{this.unsubscribeFromLocalParticipantEvent(s,d)}}unsubscribeFromLocalParticipantEvent(s,d){this._localParticipantEventListenerRegistry[s]||(this._localParticipantEventListenerRegistry[s]=new Set),this._localParticipantEventListenerRegistry[s].delete(d)}subscribeToRoomEvent(s,d){return this._roomEventListenerRegistry[s]||(this._roomEventListenerRegistry[s]=new Set),this._roomEventListenerRegistry[s].add(d),()=>{this.unsubscribeFromRoomEvent(s,d)}}unsubscribeFromRoomEvent(s,d){this._roomEventListenerRegistry[s]||(this._roomEventListenerRegistry[s]=new Set),this._roomEventListenerRegistry[s].delete(d)}sendChatMessage(s){const{message:d,recipients:c,metadata:l}=s;if(!this.livekitRoom||this.livekitRoom.state!=="connected")return;const h={type:"ChatMessage",recipients:c,metadata:l,content:d,timestamp:Date.now()},p=JSON.stringify(h),y=encoder$1.encode(p);if({...h,sender:this.livekitRoom.localParticipant.identity,displayName:this.livekitRoom.localParticipant.identity},Boolean(c)){const _=c.map(this.livekitRoom.getParticipantByIdentity);return this.livekitRoom.localParticipant.publishData(y,dist$1.DataPacket_Kind.RELIABLE,_).then(()=>{this._appendChat(y,this.livekitRoom.localParticipant,dist$1.DataPacket_Kind.RELIABLE)})}else return this.livekitRoom.localParticipant.publishData(y,dist$1.DataPacket_Kind.RELIABLE).then(()=>{this._appendChat(y,this.livekitRoom.localParticipant,dist$1.DataPacket_Kind.RELIABLE)})}}const webrtcManager=new RoomsManager;var index$2=Object.freeze(Object.defineProperty({__proto__:null,webrtcManager},Symbol.toStringTag,{value:"Module"}));const encoder=new TextEncoder,decoder=new TextDecoder,simpleRooms=new Map,getRoom=a=>{if(!a)return null;if(simpleRooms.get(a))return simpleRooms.get(a);const s=webrtcManager.rooms.get(a);if(!s)return null;const d=s.livekitRoom,c=d.localParticipant;window.__StudioRoom=d,c||log$1.warn("No local participant!");const l={useTracks:new Set,useTrack:new Map,useParticipants:new Set,useParticipant:new Map,useChatHistory:new Set};let h={tracks:[],participants:[],result:{participants:[],tracks:[]},chat:s.chatHistory};const p=()=>{const U=s.participants,F=U.flatMap(T=>T.getTracks().map(D=>({...D,participant:T}))),j={participants:U.map(T=>{const D=JSON.parse(T.metadata);return{id:T.identity,isSelf:T===c,connectionQuality:T.connectionQuality,displayName:D.displayName||T.name,joinedAt:T.joinedAt,role:D.participantRole,meta:D,trackIds:F.filter(J=>J.participant.sid===T.sid).map(J=>J.trackSid)}}),tracks:F.map(T=>{var D,J,ee;return{mediaStreamTrack:(D=T.track)==null?void 0:D.mediaStreamTrack,id:T.trackSid,participantId:(J=T.participant)==null?void 0:J.identity,isMuted:(ee=T.track)==null?void 0:ee.isMuted,type:T.source}})};h={tracks:F,participants:U,result:j,chat:s.chatHistory},l.useTracks.forEach(T=>T(j.tracks)),l.useTrack.forEach((T,D)=>{D(E(T))}),l.useParticipants.forEach(T=>T(j.participants)),l.useParticipant.forEach((T,D)=>{D(O(T))}),l.useChatHistory.forEach(T=>{T(h.chat)})};[dist$1.RoomEvent.ParticipantConnected,dist$1.RoomEvent.ParticipantDisconnected,dist$1.RoomEvent.ParticipantMetadataChanged,dist$1.RoomEvent.Disconnected,dist$1.RoomEvent.TrackSubscribed,dist$1.RoomEvent.TrackUnsubscribed,dist$1.RoomEvent.LocalTrackPublished,dist$1.RoomEvent.LocalTrackUnpublished,dist$1.RoomEvent.ConnectionQualityChanged,dist$1.RoomEvent.TrackMuted,dist$1.RoomEvent.TrackUnmuted,dist$1.RoomEvent.TrackStreamStateChanged].map(U=>s.subscribeToRoomEvent(U,()=>p())).push(s.subscribeToSpecialEvent(SpecialEvent.Chat,p));const E=U=>h.result.tracks.find(F=>F.id===U),O=U=>h.result.participants.find(F=>F.id===U),P=(U,F)=>{const j=c.getTracks().find(T=>T.trackSid===U);j&&(F?j.mute():j.unmute())};let C,A;const q={id:s.roomName,participantId:c.identity,setTrackEnabled:P,setCameraEnabled:(U=!0)=>c.setCameraEnabled(U),setMicrophoneEnabled:(U=!0)=>c.setMicrophoneEnabled(U),setCamera:async(U={})=>{var j;if(C){log$1.warn("Cannot set camera until previous has resolved");return}C=!0;let F;try{const T=c.getTracks().find(J=>J.source===dist$1.Track.Source.Camera),D=await c.createTracks({video:{deviceId:U.deviceId,resolution:U.resolution||{width:1280,height:720,frameRate:30,aspectRatio:16/9}}});T!=null&&T.isMuted&&D.forEach(J=>{J.mute()}),F=await Promise.all(D.map(J=>c.publishTrack(J))),T&&c.unpublishTrack(T.track)}catch(T){throw T}finally{return C=!1,E((j=F[0])==null?void 0:j.trackSid)}},setMicrophone:async U=>{var j,T;if(A){log$1.warn("Cannot set microphone until previous has resolved");return}A=!0;let F;try{const D=c.getTracks().find(ee=>ee.source===dist$1.Track.Source.Microphone),J=await c.createTracks({audio:U||!0});return D!=null&&D.isMuted&&J.forEach(ee=>{ee.mute()}),F=await Promise.all(J.map(ee=>c.publishTrack(ee))),D&&c.unpublishTrack(D.track),E((j=F[0])==null?void 0:j.trackSid)}catch(D){throw D}finally{return A=!1,E((T=F[0])==null?void 0:T.trackSid)}},addCamera:async(U={})=>{var T;const F=await c.createTracks({video:{deviceId:U.deviceId,resolution:U.resolution||{width:1280,height:720,frameRate:30,aspectRatio:1.7777777777777777}}}),j=await Promise.all(F.map(D=>c.publishTrack(D)));return A=!1,E((T=j[0])==null?void 0:T.trackSid)},addScreen:async(U={audio:!1})=>{const F=await c.createScreenTracks(U),j=await Promise.all(F.map(J=>c.publishTrack(J))),T=j.find(J=>J.kind==="video"),D=j.find(J=>J.kind==="audio");return{screen:E(T==null?void 0:T.trackSid),audio:E(D==null?void 0:D.trackSid)}},removeTrack:async U=>{const F=h.tracks.find(j=>j.trackSid===U);c.unpublishTrack(F.track)},setParticipantMetadata:(U,F)=>s.updateParticipant(U,F),kickParticipant:s.kickParticipant,muteTrackAsAdmin:s.muteTrackAsAdmin,sendChatMessage:s.sendChatMessage,getTracks:()=>h.result.tracks,useTracks:U=>(l.useTracks.add(U),U(h.result.tracks),()=>{l.useTracks.delete(U)}),getTrack:E,useTrack:(U,F)=>(l.useTrack.set(F,U),F(E(U)),()=>{l.useTrack.delete(F)}),getParticipant:O,getParticipants:()=>h.result.participants,useParticipants:U=>(l.useParticipants.add(U),U(h.result.participants),()=>{l.useTracks.delete(U)}),useParticipant:(U,F)=>(l.useParticipant.set(F,U),F(O(U)),()=>{l.useTrack.delete(F)}),useChatHistory:U=>(l.useChatHistory.add(U),U(h.chat),()=>{l.useChatHistory.delete(U)}),useActiveSpeakers:U=>{const F=j=>{U(j.map(T=>T.identity))};return s.livekitRoom.on(dist$1.RoomEvent.ActiveSpeakersChanged,F),F(s.livekitRoom.activeSpeakers),()=>{var j;(j=s.livekitRoom)==null||j.off(dist$1.RoomEvent.ActiveSpeakersChanged,F)}},sendData:(U,F)=>{const j=encoder.encode(JSON.stringify(U)),T=F==null?void 0:F.map(D=>s.livekitRoom.getParticipantByIdentity(D).sid);return c.publishData(j,dist$1.DataPacket_Kind.RELIABLE,T)},onData:U=>{const F=(j,T)=>{const D=JSON.parse(decoder.decode(j));U(D,T==null?void 0:T.identity)};return s.livekitRoom.on(dist$1.RoomEvent.DataReceived,F),()=>{var j;(j=s.livekitRoom)==null||j.off(dist$1.RoomEvent.DataReceived,F)}},connect:()=>s.connect(),disconnect:()=>s.livekitRoom.disconnect(),onDisconnected:U=>(s.livekitRoom.on(dist$1.RoomEvent.Disconnected,U),()=>{var F;(F=s.livekitRoom)==null||F.off(dist$1.RoomEvent.DataReceived,U)}),setAudioOutput:U=>s.livekitRoom.switchActiveDevice("audiooutput",U)};return p(),simpleRooms.set(a,q),q},Rendering=lib$2.LiveApiModel.Rendering,VideoRendering=lib$2.LiveApiModel.VideoRendering,AudioRendering=lib$2.LiveApiModel.AudioRendering,RenderingQuality=lib$2.LiveApiModel.RenderingQuality,Encoding=lib$2.LiveApiModel.Encoding,VideoEncoding=lib$2.LiveApiModel.VideoEncoding,AudioEncoding=lib$2.LiveApiModel.AudioEncoding,ProjectBroadcastPhase=lib$2.LiveApiModel.ProjectBroadcastPhase,Role=lib$2.LiveApiModel.Role,DestinationAddress=lib$2.LiveApiModel.DestinationAddress,VideoCodec=lib$2.LiveApiModel.VideoCodec,AudioCodec=lib$2.LiveApiModel.AudioCodec,VideoCodecRateControl=lib$2.LiveApiModel.VideoCodecRateControl,VideoCodecProfile=lib$2.LiveApiModel.VideoCodecProfile;var types=Object.freeze(Object.defineProperty({__proto__:null,Rendering,VideoRendering,AudioRendering,RenderingQuality,Encoding,Role,DestinationAddress,VideoEncoding,AudioEncoding,VideoCodec,AudioCodec,VideoCodecRateControl,VideoCodecProfile,ProjectBroadcastPhase},Symbol.toStringTag,{value:"Module"}));const{state:state$2}=CoreContext,getAccessTokenData=()=>{var a;return((a=CoreContext.clients.accessTokenClaims)==null?void 0:a.user)||{}},getBaseUser=()=>state$2.user?{id:state$2.user.id,props:state$2.user.props,name:state$2.user.name,projects:state$2.projects.map(toBaseProject),sources:state$2.sources.map(toBaseSource)}:null,toBaseProject=a=>{const{compositor:s,videoApi:d,props:c={},role:l}=a,{destinations:h,encoding:p,rendering:y,sources:_}=d.project,E={get:s.get,getRoot:s.getRoot,getParent:s.getParent};Object.defineProperty(E,"nodes",{get(){return s.nodes.filter(C=>!C._deleted)}});const O=a.videoApi.phase,P=a.videoApi.broadcastId||null;return{broadcastPhase:O,role:l,broadcastId:P,isLive:[ProjectBroadcastPhase.PROJECT_BROADCAST_PHASE_RUNNING,ProjectBroadcastPhase.PROJECT_BROADCAST_PHASE_STOPPING].includes(O),scene:E,joinRoom:async(C={})=>CoreContext.Command.joinRoom({projectId:a.id,...C}),subscribe:C=>CoreContext.subscribe((A,q)=>{q.projectId&&(q==null?void 0:q.projectId)===a.id&&C(A,q)}),destinations:h.map(toBaseDestination),sources:_.map(toBaseSource),encoding:p,rendering:y,id:a.id,hostDisplayName:a.props.hostDisplayName,props:c}},toBaseDestination=a=>{var s;return{id:a.destinationId,enabled:a.enabled,address:a.address,props:((s=a.metadata)==null?void 0:s.props)||(a==null?void 0:a.metadata)||{}}},toBaseSource=a=>{var s;return{id:a.sourceId,address:a.address,props:((s=a.metadata)==null?void 0:s.props)||{}}},hydrateProject=async(a,s)=>{const d=a.metadata||{},c=await layoutToProject(d.layoutId);return{id:a.projectId,compositor:c,role:s,videoApi:{project:a,phase:ProjectBroadcastPhase.PROJECT_BROADCAST_PHASE_UNSPECIFIED},layoutApi:{layoutId:d.layoutId},props:(d==null?void 0:d.props)||d}},sceneNodeToLayer=a=>{const{id:s,props:d={},children:c=[]}=a;return{...s?{id:s}:{},type:d.type,data:{...d},children:c.map(l=>l.id)}},nodeToLayer=a=>({id:a.id,type:a.props.type,data:{...a.props},children:a.childIds.map(s=>s)}),layerToNode=a=>({id:String(a.id),props:{type:a.type,...a.data},childIds:a.children.map(s=>String(s))}),layoutToProject=async a=>{const{layers:s}=await CoreContext.clients.LayoutApi().layer.listLayers({layoutId:a}),d=s.map(layerToNode),c=d.reduce((h,p)=>h?h.props.isRoot?h:p.props.isRoot||!d.some(y=>y.childIds.includes(p.id))?p:h:p,null),l=c?toSceneTree(d,c.id):null;return CoreContext.compositor.loadProject(l,a)},getUser=()=>{const a=state$2.user;if(!a)throw new Error("User not loaded");return a},getProject=a=>state$2.projects.find(s=>s.id===a),getProjectByLayoutId=a=>state$2.projects.find(s=>s.compositor.id===a),getProjectRoom=a=>{var s;return getRoom((s=getProject(a))==null?void 0:s.roomId)},{connectionId}=CoreContext,latestUpdateVersion={},getNextNodeVersion=a=>(latestUpdateVersion[a]||(latestUpdateVersion[a]=0),++latestUpdateVersion[a]),request=(a,s)=>{const d=s.map(c=>{const[l,h]=c;return{[l]:h}});return log$1.debug("Batch request",d),CoreContext.clients.LayoutApi().layer.batch({layoutId:a,layers:d,requestMetadata:{connectionId,layoutId:a,updateVersions:s.filter(([c])=>c==="update").map(([c,l])=>({[l.id]:getNextNodeVersion(l.id)})).reduce((c,l)=>({...l,...c}),{})}})},compositorAdapter=(a,s)=>({async insert(d={},c,l){const h=nodeToLayer({id:null,props:d,childIds:[]});c?h.type="child":h.type="root",log$1.debug("Insert layer",h);const p=await CoreContext.clients.LayoutApi().layer.createLayer({layoutId:a,layer:{...h,requestMetadata:{connectionId,layoutId:a}}});if(p.code)throw new Error(p.message);const y=await s.get(c);if(c&&!y)throw Error("Parent not found with ID");if(y){const _=nodeToLayer(y),E=insertAt$1(l,p.id,_.children),O={layoutId:a,layerId:_.id,layer:{children:E,requestMetadata:{connectionId,layoutId:a,updateVersion:{[h.id]:getNextNodeVersion(h.id)}}}};await CoreContext.clients.LayoutApi().layer.updateLayer(O)}return String(p.id)},async update(d,c={}){const l=s.get(d),h=nodeToLayer({...l,props:{...l.props,...c}}),p={layoutId:a,layerId:h.id,layer:{...h,requestMetadata:{connectionId,layoutId:a,updateVersions:{[h.id]:getNextNodeVersion(h.id)}}}};log$1.debug("Update layer",p),await CoreContext.clients.LayoutApi().layer.updateLayer(p)},async remove(d){const c=await s.getParent(d);if(c){const l=nodeToLayer(c),h=l.children.filter(y=>y!==d),p={layoutId:a,layerId:l.id,layer:{children:h,requestMetadata:{connectionId,layoutId:a,updateVersions:{[l.id]:getNextNodeVersion(l.id)}}}};await CoreContext.clients.LayoutApi().layer.updateLayer(p)}await CoreContext.clients.LayoutApi().layer.deleteLayer({layoutId:a,layerId:d,payload:{requestMetadata:{connectionId,layoutId:a}}})},async reorder(d,c){const l=s.get(d),h=nodeToLayer({...l,childIds:c});log$1.debug("Reorder layer children",h),await CoreContext.clients.LayoutApi().layer.updateLayer({layoutId:a,layerId:h.id,layer:{children:h.children,requestMetadata:{connectionId,layoutId:a,updateVersions:{[h.id]:getNextNodeVersion(h.id)}}}})},async move(d,c,l){const h=s.get(d),p=s.get(s.getParent(d).id),y=nodeToLayer({...p,childIds:pull$2(p.childIds,h.id)}),_=s.get(c),E=nodeToLayer({..._,childIds:insertAt$1(l,h.id,_.childIds)});log$1.debug("Move layers"),await Promise.all([CoreContext.clients.LayoutApi().layer.updateLayer({layoutId:a,layerId:y.id,layer:{children:y.children,requestMetadata:{connectionId,layoutId:a,updateVersions:{[y.id]:getNextNodeVersion(y.id)}}}}),CoreContext.clients.LayoutApi().layer.updateLayer({layoutId:a,layerId:E.id,layer:{children:E.children,requestMetadata:{connectionId,layoutId:a,updateVersions:{[E.id]:getNextNodeVersion(E.id)}}}})])},async batch(d){const c=d.map(([h,p])=>[h,sceneNodeToLayer(p)]),l=await request(a,c);return log$1.debug("Batch response",l),l}});var config$1=a=>({defaults:{previewTokenDuration:1e3*60*60,guestTokenDuration:1e3*60*60*12,transforms:{RoomParticipant:"LS-Room-Participant",Image:"LS-Image",Banner:"LS-Banner",Text:"LS-Text"}}});const RoomParticipant$1={name:"LS-Room-Participant",sourceType:"RoomParticipant",props:{isMuted:{type:Boolean,required:!1,default:!1},volume:{type:Number,required:!1,default:1}},useSource(a,s){return a.find(d=>isMatch(d.props,s.sourceProps))},create({onUpdate:a,onNewSource:s},d){const c=document.createElement("div");Object.assign(c.style,{position:"relative"});let l,h=d;const p=(E,O)=>{const P=E/O.width;return P>=.5?3:P>.25?2:P>.15?1:0},y=({props:E,source:O})=>{const{volume:P=1,isHidden:C=!1}=E,[A,q]=React.useState(0),U=React.useRef(),F=getProject(CoreContext.state.activeProjectId),j=getRoom(CoreContext.state.activeProjectId),D=(O==null?void 0:O.id)===(j==null?void 0:j.participantId)||E.isMuted,J=!E.isHidden&&(O==null?void 0:O.props.videoEnabled);return React.useEffect(()=>{!U.current||(U.current.play().catch(ee=>{document.addEventListener("click",()=>{var z;return(z=U.current)==null?void 0:z.play()},{once:!0})}),(O==null?void 0:O.value)&&(O==null?void 0:O.value)!==U.current.srcObject?U.current.srcObject=O.value:O!=null&&O.value||(U.current.srcObject=null))},[U.current,O==null?void 0:O.value]),React.useLayoutEffect(()=>{if(!U.current)return;const ee=()=>{const ne=U.current;q(p(ne.clientWidth,{width:F.compositor.getRoot().props.size.x,height:F.compositor.getRoot().props.size.y}))},z=new ResizeObserver(ne=>{ee()});return ee(),z.observe(U.current),()=>{z.unobserve(U.current)}},[U.current,F]),React.useEffect(()=>{!U.current||(U.current.volume=P)},[U.current,P]),React__default.default.createElement("div",{style:{position:"relative",display:"flex",height:"100%",width:"100%"}},React__default.default.createElement("div",{style:{background:"#222",position:"absolute",height:"100%",width:"100%",fontSize:"43px",color:"rgba(255,255,255,0.6)",display:"flex",alignItems:"center",justifyContent:"center",opacity:J?"0":"1"}},(O==null?void 0:O.props.displayName)&&React__default.default.createElement("div",{style:{borderRadius:"50%",background:"#555",width:"70px",height:"70px",textTransform:"uppercase",display:"flex",alignItems:"center",justifyContent:"center",lineHeight:"1em"}},(O==null?void 0:O.props.displayName.slice(0,1))||"")),React__default.default.createElement("video",{ref:U,autoPlay:!0,muted:D,disablePictureInPicture:!0,playsInline:!0,style:{left:"50%",top:"50%",position:"relative",transform:"translate3d(-50%, -50%, 0)",height:"100%",opacity:J?"1":"0",objectFit:(O==null?void 0:O.props.type)==="screen"?"contain":"cover",background:"rgba(0,0,0,0.6)"}}),(O==null?void 0:O.props.displayName)&&React__default.default.createElement("div",{className:"NameBannerContainer",style:{width:"100%",height:"100%",position:"absolute"}},React__default.default.createElement("div",{className:"NameBanner","data-size":A,style:{padding:"12px 30px",width:"fit-content",height:"fit-content",top:"100%",transform:"translateY(-100%)",left:0}},React__default.default.createElement("div",{className:"NameBanner-body"},O.props.displayName))))},_=()=>ReactDOM__default.default.render(React__default.default.createElement(y,{source:l,props:h}),c);return a(E=>{h=E,_()}),s(E=>{l=E,_()}),{root:c}}},Square={name:"LS-Square",props:{color:{default:"green"}},create({onUpdate:a}){const s=document.createElement("div");return a(({color:d})=>{Object.assign(s.style,{width:"100%",height:"100%",background:d||"red"})}),{root:s}}},Image$2={name:"LS-Image",props:{src:{},fit:{}},create({onUpdate:a}){const s=document.createElement("img");return a(({src:d,fit:c})=>{s.setAttribute("src",d),Object.assign(s.style,{width:"100%",height:"100%",objectFit:c})}),{root:s}}};function _extends(){return _extends=Object.assign?Object.assign.bind():function(a){for(var s=1;s<arguments.length;s++){var d=arguments[s];for(var c in d)Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}return a},_extends.apply(this,arguments)}function _objectWithoutPropertiesLoose(a,s){if(a==null)return{};var d={},c=Object.keys(a),l,h;for(h=0;h<c.length;h++)l=c[h],!(s.indexOf(l)>=0)&&(d[l]=a[l]);return d}function _setPrototypeOf(a,s){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(c,l){return c.__proto__=l,c},_setPrototypeOf(a,s)}function _inheritsLoose(a,s){a.prototype=Object.create(s.prototype),a.prototype.constructor=a,_setPrototypeOf(a,s)}function hasClass(a,s){return a.classList?!!s&&a.classList.contains(s):(" "+(a.className.baseVal||a.className)+" ").indexOf(" "+s+" ")!==-1}function addClass(a,s){a.classList?a.classList.add(s):hasClass(a,s)||(typeof a.className=="string"?a.className=a.className+" "+s:a.setAttribute("class",(a.className&&a.className.baseVal||"")+" "+s))}function replaceClassName(a,s){return a.replace(new RegExp("(^|\\s)"+s+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function removeClass$1(a,s){a.classList?a.classList.remove(s):typeof a.className=="string"?a.className=replaceClassName(a.className,s):a.setAttribute("class",replaceClassName(a.className&&a.className.baseVal||"",s))}var config={disabled:!1},TransitionGroupContext=React__default.default.createContext(null),UNMOUNTED="unmounted",EXITED="exited",ENTERING="entering",ENTERED="entered",EXITING="exiting",Transition=function(a){_inheritsLoose(s,a);function s(c,l){var h;h=a.call(this,c,l)||this;var p=l,y=p&&!p.isMounting?c.enter:c.appear,_;return h.appearStatus=null,c.in?y?(_=EXITED,h.appearStatus=ENTERING):_=ENTERED:c.unmountOnExit||c.mountOnEnter?_=UNMOUNTED:_=EXITED,h.state={status:_},h.nextCallback=null,h}s.getDerivedStateFromProps=function(l,h){var p=l.in;return p&&h.status===UNMOUNTED?{status:EXITED}:null};var d=s.prototype;return d.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},d.componentDidUpdate=function(l){var h=null;if(l!==this.props){var p=this.state.status;this.props.in?p!==ENTERING&&p!==ENTERED&&(h=ENTERING):(p===ENTERING||p===ENTERED)&&(h=EXITING)}this.updateStatus(!1,h)},d.componentWillUnmount=function(){this.cancelNextCallback()},d.getTimeouts=function(){var l=this.props.timeout,h,p,y;return h=p=y=l,l!=null&&typeof l!="number"&&(h=l.exit,p=l.enter,y=l.appear!==void 0?l.appear:p),{exit:h,enter:p,appear:y}},d.updateStatus=function(l,h){l===void 0&&(l=!1),h!==null?(this.cancelNextCallback(),h===ENTERING?this.performEnter(l):this.performExit()):this.props.unmountOnExit&&this.state.status===EXITED&&this.setState({status:UNMOUNTED})},d.performEnter=function(l){var h=this,p=this.props.enter,y=this.context?this.context.isMounting:l,_=this.props.nodeRef?[y]:[ReactDOM__default.default.findDOMNode(this),y],E=_[0],O=_[1],P=this.getTimeouts(),C=y?P.appear:P.enter;if(!l&&!p||config.disabled){this.safeSetState({status:ENTERED},function(){h.props.onEntered(E)});return}this.props.onEnter(E,O),this.safeSetState({status:ENTERING},function(){h.props.onEntering(E,O),h.onTransitionEnd(C,function(){h.safeSetState({status:ENTERED},function(){h.props.onEntered(E,O)})})})},d.performExit=function(){var l=this,h=this.props.exit,p=this.getTimeouts(),y=this.props.nodeRef?void 0:ReactDOM__default.default.findDOMNode(this);if(!h||config.disabled){this.safeSetState({status:EXITED},function(){l.props.onExited(y)});return}this.props.onExit(y),this.safeSetState({status:EXITING},function(){l.props.onExiting(y),l.onTransitionEnd(p.exit,function(){l.safeSetState({status:EXITED},function(){l.props.onExited(y)})})})},d.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},d.safeSetState=function(l,h){h=this.setNextCallback(h),this.setState(l,h)},d.setNextCallback=function(l){var h=this,p=!0;return this.nextCallback=function(y){p&&(p=!1,h.nextCallback=null,l(y))},this.nextCallback.cancel=function(){p=!1},this.nextCallback},d.onTransitionEnd=function(l,h){this.setNextCallback(h);var p=this.props.nodeRef?this.props.nodeRef.current:ReactDOM__default.default.findDOMNode(this),y=l==null&&!this.props.addEndListener;if(!p||y){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var _=this.props.nodeRef?[this.nextCallback]:[p,this.nextCallback],E=_[0],O=_[1];this.props.addEndListener(E,O)}l!=null&&setTimeout(this.nextCallback,l)},d.render=function(){var l=this.state.status;if(l===UNMOUNTED)return null;var h=this.props,p=h.children;h.in,h.mountOnEnter,h.unmountOnExit,h.appear,h.enter,h.exit,h.timeout,h.addEndListener,h.onEnter,h.onEntering,h.onEntered,h.onExit,h.onExiting,h.onExited,h.nodeRef;var y=_objectWithoutPropertiesLoose(h,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return React__default.default.createElement(TransitionGroupContext.Provider,{value:null},typeof p=="function"?p(l,y):React__default.default.cloneElement(React__default.default.Children.only(p),y))},s}(React__default.default.Component);Transition.contextType=TransitionGroupContext,Transition.propTypes={};function noop(){}Transition.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:noop,onEntering:noop,onEntered:noop,onExit:noop,onExiting:noop,onExited:noop},Transition.UNMOUNTED=UNMOUNTED,Transition.EXITED=EXITED,Transition.ENTERING=ENTERING,Transition.ENTERED=ENTERED,Transition.EXITING=EXITING;var Transition$1=Transition,_addClass=function a(s,d){return s&&d&&d.split(" ").forEach(function(c){return addClass(s,c)})},removeClass=function a(s,d){return s&&d&&d.split(" ").forEach(function(c){return removeClass$1(s,c)})},CSSTransition=function(a){_inheritsLoose(s,a);function s(){for(var c,l=arguments.length,h=new Array(l),p=0;p<l;p++)h[p]=arguments[p];return c=a.call.apply(a,[this].concat(h))||this,c.appliedClasses={appear:{},enter:{},exit:{}},c.onEnter=function(y,_){var E=c.resolveArguments(y,_),O=E[0],P=E[1];c.removeClasses(O,"exit"),c.addClass(O,P?"appear":"enter","base"),c.props.onEnter&&c.props.onEnter(y,_)},c.onEntering=function(y,_){var E=c.resolveArguments(y,_),O=E[0],P=E[1],C=P?"appear":"enter";c.addClass(O,C,"active"),c.props.onEntering&&c.props.onEntering(y,_)},c.onEntered=function(y,_){var E=c.resolveArguments(y,_),O=E[0],P=E[1],C=P?"appear":"enter";c.removeClasses(O,C),c.addClass(O,C,"done"),c.props.onEntered&&c.props.onEntered(y,_)},c.onExit=function(y){var _=c.resolveArguments(y),E=_[0];c.removeClasses(E,"appear"),c.removeClasses(E,"enter"),c.addClass(E,"exit","base"),c.props.onExit&&c.props.onExit(y)},c.onExiting=function(y){var _=c.resolveArguments(y),E=_[0];c.addClass(E,"exit","active"),c.props.onExiting&&c.props.onExiting(y)},c.onExited=function(y){var _=c.resolveArguments(y),E=_[0];c.removeClasses(E,"exit"),c.addClass(E,"exit","done"),c.props.onExited&&c.props.onExited(y)},c.resolveArguments=function(y,_){return c.props.nodeRef?[c.props.nodeRef.current,y]:[y,_]},c.getClassNames=function(y){var _=c.props.classNames,E=typeof _=="string",O=E&&_?_+"-":"",P=E?""+O+y:_[y],C=E?P+"-active":_[y+"Active"],A=E?P+"-done":_[y+"Done"];return{baseClassName:P,activeClassName:C,doneClassName:A}},c}var d=s.prototype;return d.addClass=function(l,h,p){var y=this.getClassNames(h)[p+"ClassName"],_=this.getClassNames("enter"),E=_.doneClassName;h==="appear"&&p==="done"&&E&&(y+=" "+E),p==="active"&&l&&l.scrollTop,y&&(this.appliedClasses[h][p]=y,_addClass(l,y))},d.removeClasses=function(l,h){var p=this.appliedClasses[h],y=p.base,_=p.active,E=p.done;this.appliedClasses[h]={},y&&removeClass(l,y),_&&removeClass(l,_),E&&removeClass(l,E)},d.render=function(){var l=this.props;l.classNames;var h=_objectWithoutPropertiesLoose(l,["classNames"]);return React__default.default.createElement(Transition$1,_extends({},h,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},s}(React__default.default.Component);CSSTransition.defaultProps={classNames:""},CSSTransition.propTypes={};var CSSTransition$1=CSSTransition,_leaveRenders,_enterRenders;function areChildrenDifferent(a,s){return!(a===s||React__default.default.isValidElement(a)&&React__default.default.isValidElement(s)&&a.key!=null&&a.key===s.key)}var modes={out:"out-in",in:"in-out"},callHook=function a(s,d,c){return function(){var l;s.props[d]&&(l=s.props)[d].apply(l,arguments),c()}},leaveRenders=(_leaveRenders={},_leaveRenders[modes.out]=function(a){var s=a.current,d=a.changeState;return React__default.default.cloneElement(s,{in:!1,onExited:callHook(s,"onExited",function(){d(ENTERING,null)})})},_leaveRenders[modes.in]=function(a){var s=a.current,d=a.changeState,c=a.children;return[s,React__default.default.cloneElement(c,{in:!0,onEntered:callHook(c,"onEntered",function(){d(ENTERING)})})]},_leaveRenders),enterRenders=(_enterRenders={},_enterRenders[modes.out]=function(a){var s=a.children,d=a.changeState;return React__default.default.cloneElement(s,{in:!0,onEntered:callHook(s,"onEntered",function(){d(ENTERED,React__default.default.cloneElement(s,{in:!0}))})})},_enterRenders[modes.in]=function(a){var s=a.current,d=a.children,c=a.changeState;return[React__default.default.cloneElement(s,{in:!1,onExited:callHook(s,"onExited",function(){c(ENTERED,React__default.default.cloneElement(d,{in:!0}))})}),React__default.default.cloneElement(d,{in:!0})]},_enterRenders),SwitchTransition=function(a){_inheritsLoose(s,a);function s(){for(var c,l=arguments.length,h=new Array(l),p=0;p<l;p++)h[p]=arguments[p];return c=a.call.apply(a,[this].concat(h))||this,c.state={status:ENTERED,current:null},c.appeared=!1,c.changeState=function(y,_){_===void 0&&(_=c.state.current),c.setState({status:y,current:_})},c}var d=s.prototype;return d.componentDidMount=function(){this.appeared=!0},s.getDerivedStateFromProps=function(l,h){return l.children==null?{current:null}:h.status===ENTERING&&l.mode===modes.in?{status:ENTERING}:h.current&&areChildrenDifferent(h.current,l.children)?{status:EXITING}:{current:React__default.default.cloneElement(l.children,{in:!0})}},d.render=function(){var l=this.props,h=l.children,p=l.mode,y=this.state,_=y.status,E=y.current,O={children:h,current:E,changeState:this.changeState,status:_},P;switch(_){case ENTERING:P=enterRenders[p](O);break;case EXITING:P=leaveRenders[p](O);break;case ENTERED:P=E}return React__default.default.createElement(TransitionGroupContext.Provider,{value:{isMounting:!this.appeared}},P)},s}(React__default.default.Component);SwitchTransition.propTypes={},SwitchTransition.defaultProps={mode:modes.out};var SwitchTransition$1=SwitchTransition;const Animations={"fade-in":".fade-in{-webkit-animation:fade-in;animation:fade-in}@-webkit-keyframes fade-in{0%{opacity:0}100%{opacity:1}}@keyframes fade-in{0%{opacity:0}100%{opacity:1}}","fade-out":".fade-out{-webkit-animation:fade-out;animation:fade-out}@-webkit-keyframes fade-out{0%{opacity:1}100%{opacity:0}}@keyframes fade-out{0%{opacity:1}100%{opacity:0}}","slide-in-blurred-top":".slide-in-blurred-top{-webkit-animation:slide-in-blurred-top .6s cubic-bezier(.23,1.000,.32,1.000) both;animation:slide-in-blurred-top .6s cubic-bezier(.23,1.000,.32,1.000) both}@-webkit-keyframes slide-in-blurred-top{0%{-webkit-transform:translateY(-1000px) scaleY(2.5) scaleX(.2);transform:translateY(-1000px) scaleY(2.5) scaleX(.2);-webkit-transform-origin:50% 0;transform-origin:50% 0;-webkit-filter:blur(40px);filter:blur(40px);opacity:0}100%{-webkit-transform:translateY(0) scaleY(1) scaleX(1);transform:translateY(0) scaleY(1) scaleX(1);-webkit-transform-origin:50% 50%;transform-origin:50% 50%;-webkit-filter:blur(0);filter:blur(0);opacity:1}}@keyframes slide-in-blurred-top{0%{-webkit-transform:translateY(-1000px) scaleY(2.5) scaleX(.2);transform:translateY(-1000px) scaleY(2.5) scaleX(.2);-webkit-transform-origin:50% 0;transform-origin:50% 0;-webkit-filter:blur(40px);filter:blur(40px);opacity:0}100%{-webkit-transform:translateY(0) scaleY(1) scaleX(1);transform:translateY(0) scaleY(1) scaleX(1);-webkit-transform-origin:50% 50%;transform-origin:50% 50%;-webkit-filter:blur(0);filter:blur(0);opacity:1}}"},APIKitAnimation=a=>{const{enter:s,exit:d,children:c,tag:l="div",direction:h="normal",duration:p=500,id:y,type:_}=a,E=y?`${_}-${y}`:`${_}-api-kit-animation`;return React__default.default.createElement("div",{style:{height:"100%",width:"100%"}},React__default.default.createElement("style",{dangerouslySetInnerHTML:{__html:renderStyle(_,s,d,p,h)}}),React__default.default.createElement(SwitchTransition$1,{mode:"out-in"},React__default.default.createElement(CSSTransition$1,{key:E,addEndListener:(O,P)=>{O.addEventListener("transitionend",P,!1)},classNames:{enter:`${_}-default-enter`,enterActive:s,exit:`${_}-default-leave`,exitActive:d},timeout:p},React__default.default.createElement("div",{style:{height:"100%",width:"100%"}},c))))},renderStyle=(a,s,d,c,l)=>`
        body {
          margin: 0;
          padding: 0;
        }
        
        ${Animations[s]}
        
        ${Animations[d]}

        .${a}-transition {
          transition: opacity ${c}ms ease-out};
        }

        .${a}-default-enter {
          opacity: 0;
        }

        .${a}-default-enter.${s} {
          animation-direction: ${l};
          animation-duration: ${c/1e3}s;
          animation-fill-mode: both;
          animation-timing-function: ease-out;
        }

        .${a}-default-leave {
          opacity: 1;
        }

        .${a}-default-leave.${d} {
          animation-direction: ${l};
          animation-duration: ${c/1e3}s;
          animation-timing-function: ease-out;
          animation-fill-mode: both;
        }
        `;var APIKitAnimationTypes=(a=>(a.FADE_IN="fade-in",a.FADE_OUT="fade-out",a.SLIDE_IN_BLURRED_TOP="slide-in-blurred-top",a))(APIKitAnimationTypes||{});const SourceTriggerMap=[{sourceType:"Overlay",trigger:"OverlayMetadataUpdate"},{sourceType:"Background",trigger:"BackgroundMetadataUpdate"}],Video2={name:"LS-Video-2",sourceType:"Video2",props:{id:{type:String,required:!0}},useSource(a,s){return a.find(d=>d.props.type===s.id)},create({onUpdate:a,onNewSource:s,onRemove:d},c){d(()=>{clearInterval(_)});const l=document.createElement("div"),h=getProjectRoom(CoreContext.state.activeProjectId),p=getProject(CoreContext.state.activeProjectId).role;let y,_;const E=({source:P})=>{const C=SourceTriggerMap.find(X=>X.sourceType===c.proxySource),{src:A,type:q,meta:U,loop:F}=(P==null?void 0:P.value)||{},{id:j}=P||{},[T,D]=React__default.default.useState(null),J=React__default.default.useRef(null),ee=React__default.default.useCallback(()=>{J!=null&&J.current&&J.current.play().catch(()=>{var X;J.current.muted=!0,(X=J.current)==null||X.play()})},[A,J]),z=React__default.default.useCallback(()=>{_&&clearInterval(_),trigger$1("VideoEnded",{id:j,category:q})},[A]);React__default.default.useEffect(()=>{U&&(h==null?void 0:h.participantId)!==(U==null?void 0:U.owner)&&(J==null?void 0:J.current)&&(J.current.currentTime=(U==null?void 0:U.time)||0)},[U,J]),React__default.default.useEffect(()=>h==null?void 0:h.onData((X,M)=>{var K,te;(K=J==null?void 0:J.current)!=null&&K.currentTime&&X.type==="UserJoined"&&M!==(h==null?void 0:h.participantId)&&triggerInternal$1(C.trigger,{projectId:CoreContext.state.activeProjectId,role:p,sourceId:j,doTrigger:!0,metadata:{time:Math.floor((te=J==null?void 0:J.current)==null?void 0:te.currentTime)||0,owner:h==null?void 0:h.participantId}})}),[J]);const ne=React__default.default.useCallback(X=>{J.current=X,D(X?X.id:null)},[]);return React__default.default.useEffect(()=>()=>{_&&clearInterval(_)},[j]),React__default.default.useEffect(()=>{var X;T?J.current&&(J.current.src=A,F&&(J.current.loop=Boolean(F)),J.current.play().catch(()=>{J.current.muted=!0,J.current.play()}),_=setInterval(()=>{if(J.current.duration){const M=J.current.duration-J.current.currentTime;trigger$1("VideoTimeUpdate",{category:q,id:j,time:Math.floor(M)})}},1e3),triggerInternal$1(C.trigger,{projectId:CoreContext.state.activeProjectId,role:p,sourceId:j,doTrigger:!0,metadata:{time:Math.floor((X=J==null?void 0:J.current)==null?void 0:X.currentTime)||0,owner:h==null?void 0:h.participantId}})):_&&clearInterval(_)},[T]),React__default.default.createElement(APIKitAnimation,{id:j,type:"video",enter:APIKitAnimationTypes.FADE_IN,exit:APIKitAnimationTypes.FADE_OUT,duration:400},A&&React__default.default.createElement("video",{id:j,ref:ne,style:c.style,...c.props,onLoadedData:ee,onEnded:z}))},O=()=>ReactDOM__default.default.render(React__default.default.createElement(E,{source:y}),l);return a(()=>{O()}),s(P=>{y=P,O()}),{root:l}}},Image2={name:"LS-Image-2",sourceType:"Image2",props:{id:{type:String,required:!0}},useSource(a,s){return a.find(d=>d.props.type===s.id)},create({onUpdate:a,onNewSource:s},d){const c=document.createElement("div");let l;const h=({source:y})=>{const{src:_,meta:E}=(y==null?void 0:y.value)||{},{id:O}=y||{};return React__default.default.createElement(APIKitAnimation,{id:O,type:"image",enter:APIKitAnimationTypes.FADE_IN,exit:APIKitAnimationTypes.FADE_OUT,duration:400},_&&React__default.default.createElement("img",{style:{...d==null?void 0:d.style,...E==null?void 0:E.style},className:"image-transition",src:_}))},p=()=>ReactDOM__default.default.render(React__default.default.createElement(h,{source:l}),c);return a(()=>{p()}),s(y=>{l=y,p()}),{root:c}}},Element={name:"Element",sourceType:"Element",create({onUpdate:a},{tagName:s}){const d=document.createElement(s);return a(({tagName:c,attributes:l={},fields:h={}})=>{c==="img"?(d==null?void 0:d.src)!==l.src&&Object.keys(l).forEach(p=>{d.setAttribute(p,l[p])}):Object.keys(l).forEach(p=>{d.setAttribute(p,l[p])}),Object.keys(h).forEach(p=>{Object.assign(d[p],h[p])})}),{root:d}}},Video={name:"LS-Video",sourceType:"LS-Video",create({onUpdate:a,onEvent:s,onRemove:d}){d(()=>{clearInterval(l)});const c=document.createElement("video");let l;return a(({attributes:h={},fields:p={},sourceProps:y={},id:_})=>{(c.src!==h.src||c.id!==h.id&&h.id)&&(l&&clearInterval(l),Object.keys(h).forEach(E=>{c.setAttribute(E,h[E])}),c.onloadedmetadata=()=>{h.muted?(c.muted=!0,c.play()):c.muted=!1},l=setInterval(()=>{if(c.duration){const E=c.duration-c.currentTime;trigger$1("VideoTimeUpdate",{category:_,id:y==null?void 0:y.id,time:Math.floor(E)})}},1e3),c.loop=Boolean(h.loop),c.onended=()=>{l&&clearInterval(l),trigger$1("VideoEnded",{id:y==null?void 0:y.id,category:_})},Object.keys(p).forEach(E=>{Object.assign(c[E],p[E])}))}),{root:c}}},Banner$1={name:"LS-Banner",sourceType:"Banner",props:{bannerId:{type:String,required:!0}},useSource(a,s){return a.find(d=>d.id===s.bannerId)},create({onUpdate:a,onNewSource:s},d){const c=document.createElement("div");let l,h,p;const y=({currentSource:E,latestSource:O})=>{const[P,C]=React.useState(!1),{headerText:A,bodyText:q}=(O==null?void 0:O.value)||{};return React.useEffect(()=>{window.setTimeout(()=>{C(Boolean(E))}),E||C(!1)},[E]),React__default.default.createElement("div",{className:"BannerContainer",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"flex-end",transition:"200ms ease all",...P?{zIndex:2,opacity:1,transform:"translateX(0)"}:{zIndex:1,opacity:0,transform:"translateX(-200px)"}}},React__default.default.createElement("div",{className:"Banner",style:{padding:10,background:"orange",width:"fit-content",height:"fit-content",maxWidth:"84%",position:"relative"}},A&&React__default.default.createElement("div",{className:"Banner-header",style:{marginBottom:6,fontSize:"60px"}},A),q&&React__default.default.createElement("div",{className:"Banner-body",style:{fontSize:"24px"}},q)))},_=()=>ReactDOM__default.default.render(React__default.default.createElement(React__default.default.Fragment,null,p&&p.id!==h.id&&React__default.default.createElement(y,{key:p==null?void 0:p.id,currentSource:null,latestSource:p}),React__default.default.createElement(y,{key:h==null?void 0:h.id,currentSource:l,latestSource:h})),c);return a(()=>{_()}),s(E=>{p=l,l=E,l&&(h=l),_()}),{root:c}}},Logo$1={name:"LS-Logo",sourceType:"Logo",props:{id:{type:String,required:!0}},useSource(a,s){return a.find(d=>d.props.type===s.id)},create({onUpdate:a,onNewSource:s},d){const c=document.createElement("div");let l;const h=({source:y})=>{const{src:_,meta:E,logoPosition:O}=(y==null?void 0:y.value)||{},{id:P}=y||{};return React__default.default.createElement(APIKitAnimation,{type:"logo",id:P,enter:APIKitAnimationTypes.FADE_IN,exit:APIKitAnimationTypes.FADE_OUT,duration:400},_&&React__default.default.createElement("div",{className:"logo wrapper"},React__default.default.createElement("img",{style:{...d==null?void 0:d.style,...E==null?void 0:E.style},src:_})))},p=()=>ReactDOM__default.default.render(React__default.default.createElement(h,{source:l}),c);return a(()=>{p()}),s(y=>{l=y,p()}),{root:c}}},Iframe=({url:a,allowFullScreen:s,position:d,display:c,height:l,width:h,overflow:p,styles:y,onLoad:_,id:E,frameBorder:O,className:P,name:C,target:A,iframeRef:q,children:U,src:F})=>{const j=Object.assign({src:F||a,target:A||null,style:{position:d||null,display:c||"block",overflow:p||null,...y},name:C||null,className:P||null,id:E||null,onLoad:_||null,height:l||"100%",width:h||"100%"});let T=Object.create(null);for(let D of Object.keys(j))j[D]!=null&&(T[D]=j[D]);for(let D of Object.keys(T.style))T.style[D]==null&&delete T.style[D];if(s)if("allow"in T){const D=T.allow.replace("fullscreen","");T.allow=`fullscreen ${D.trim()}`.trim()}else T.allow="fullscreen";return O>=0&&(T.style.hasOwnProperty("border")||(T.style.border=O)),React__default.default.createElement(APIKitAnimation,{id:E,type:"image",enter:APIKitAnimationTypes.FADE_IN,exit:APIKitAnimationTypes.FADE_OUT,duration:400},U?React__default.default.createElement("iframe",{ref:q,...T},U):React__default.default.createElement("iframe",{ref:q,...T}))},Image$1=({source:a,initialProps:s})=>{const{src:d,meta:c}=(a==null?void 0:a.value)||{},{id:l}=a||{};return React__default.default.createElement(APIKitAnimation,{id:l,type:"image",enter:APIKitAnimationTypes.FADE_IN,exit:APIKitAnimationTypes.FADE_OUT,duration:400},d&&React__default.default.createElement("img",{style:{...s==null?void 0:s.style,...c==null?void 0:c.style},className:"image-transition",src:d}))},Overlay={name:"LS-Overlay",sourceType:"Overlay",props:{id:{type:String,required:!0}},useSource(a,s){return a.find(d=>d.props.type===s.id)},create({onUpdate:a,onNewSource:s},d){const c=document.createElement("div");let l;const h=({source:y})=>{const{src:_,meta:E}=(y==null?void 0:y.value)||{},O=React__default.default.useRef(null);return React__default.default.createElement(React__default.default.Fragment,null,(E==null?void 0:E.type)==="html-overlay"&&React__default.default.createElement(Iframe,{url:_,frameBorder:0,iframeRef:O,styles:{...d.style,...E==null?void 0:E.style}}),(E==null?void 0:E.type)==="image-overlay"&&React__default.default.createElement(Image$1,{source:y,initialProps:d}))},p=()=>ReactDOM__default.default.render(React__default.default.createElement(h,{source:l}),c);return a(()=>{p()}),s(y=>{l=y,p()}),{root:c}}};var Transforms=Object.freeze(Object.defineProperty({__proto__:null,RoomParticipant:RoomParticipant$1,Square,Image:Image$2,Video2,Image2,Element,Video,Banner:Banner$1,Logo:Logo$1,Overlay},Symbol.toStringTag,{value:"Module"}));/*! (c) Andrea Giammarchi - ISC */var self$1={};try{self$1.WeakMap=WeakMap}catch(a){self$1.WeakMap=function(s,d){var c=d.defineProperty,l=d.hasOwnProperty,h=p.prototype;return h.delete=function(_){return this.has(_)&&delete _[this._]},h.get=function(_){return this.has(_)?_[this._]:void 0},h.has=function(_){return l.call(_,this._)},h.set=function(_,E){return c(_,this._,{configurable:!0,value:E}),this},p;function p(_){c(this,"_",{value:"_@ungap/weakmap"+s++}),_&&_.forEach(y,this)}function y(_){this.set(_[0],_[1])}}(Math.random(),Object)}var WeakMap$1=self$1.WeakMap;/*! (c) Andrea Giammarchi - ISC */var UID="-"+Math.random().toFixed(6)+"%",UID_IE=!1;try{(function(a,s,d){return s in a&&(a.innerHTML="<p "+d+'="'+UID+'"></p>',a[s].childNodes[0].getAttribute(d)==UID)})(document.createElement("template"),"content","tabindex")||(UID="_dt: "+UID.slice(1,-1)+";",UID_IE=!0)}catch(a){}var UIDC="<!--"+UID+"-->",COMMENT_NODE=8,ELEMENT_NODE$1=1,TEXT_NODE=3,SHOULD_USE_TEXT_CONTENT=/^(?:plaintext|script|style|textarea|title|xmp)$/i,VOID_ELEMENTS=/^(?:area|base|br|col|embed|hr|img|input|keygen|link|menuitem|meta|param|source|track|wbr)$/i;/*! (c) Andrea Giammarchi - ISC */function domsanitizer(a){return a.join(UIDC).replace(selfClosing,fullClosing).replace(attrSeeker,attrReplacer)}var spaces=" \\f\\n\\r\\t",almostEverything="[^"+spaces+`\\/>"'=]+`,attrName="["+spaces+"]+"+almostEverything,tagName="<([A-Za-z]+[A-Za-z0-9:._-]*)((?:",attrPartials=`(?:\\s*=\\s*(?:'[^']*?'|"[^"]*?"|<[^>]*?>|`+almostEverything.replace("\\/","")+"))?)",attrSeeker=new RegExp(tagName+attrName+attrPartials+"+)(["+spaces+"]*/?>)","g"),selfClosing=new RegExp(tagName+attrName+attrPartials+"*)(["+spaces+"]*/>)","g"),findAttributes=new RegExp("("+attrName+`\\s*=\\s*)(['"]?)`+UIDC+"\\2","gi");function attrReplacer(a,s,d,c){return"<"+s+d.replace(findAttributes,replaceAttributes)+c}function replaceAttributes(a,s,d){return s+(d||'"')+UID+(d||'"')}function fullClosing(a,s,d){return VOID_ELEMENTS.test(s)?a:"<"+s+d+"></"+s+">"}const{isArray}=Array,{indexOf,slice}=[];var umap=a=>({get:s=>a.get(s),set:(s,d)=>(a.set(s,d),d)});const ELEMENT_NODE=1,nodeType=111,remove=({firstChild:a,lastChild:s})=>{const d=document.createRange();return d.setStartAfter(a),d.setEndAfter(s),d.deleteContents(),a},diffable=(a,s)=>a.nodeType===nodeType?1/s<0?s?remove(a):a.lastChild:s?a.valueOf():a.firstChild:a,persistent=a=>{const{childNodes:s}=a,{length:d}=s;if(d<2)return d?s[0]:a;const c=slice.call(s,0),l=c[0],h=c[d-1];return{ELEMENT_NODE,nodeType,firstChild:l,lastChild:h,valueOf(){if(s.length!==d){let p=0;for(;p<d;)a.appendChild(c[p++])}return a}}};/*! (c) Andrea Giammarchi - ISC */var createContent=function(a){var s="fragment",d="template",c="content"in p(d),l=c?function(_){var E=p(d);return E.innerHTML=_,E.content}:function(_){var E=p(s),O=p(d),P=null;if(/^[^\S]*?<(col(?:group)?|t(?:head|body|foot|r|d|h))/i.test(_)){var C=RegExp.$1;O.innerHTML="<table>"+_+"</table>",P=O.querySelectorAll(C)}else O.innerHTML=_,P=O.childNodes;return h(E,P),E};return function(E,O){return(O==="svg"?y:l)(E)};function h(_,E){for(var O=E.length;O--;)_.appendChild(E[0])}function p(_){return _===s?a.createDocumentFragment():a.createElementNS("http://www.w3.org/1999/xhtml",_)}function y(_){var E=p(s),O=p("div");return O.innerHTML='<svg xmlns="http://www.w3.org/2000/svg">'+_+"</svg>",h(E,O.firstChild.childNodes),E}}(document),udomdiff=(a,s,d,c,l)=>{const h=d.length;let p=s.length,y=h,_=0,E=0,O=null;for(;_<p||E<y;)if(p===_){const P=y<h?E?c(d[E-1],-0).nextSibling:c(d[y-E],0):l;for(;E<y;)a.insertBefore(c(d[E++],1),P)}else if(y===E)for(;_<p;)(!O||!O.has(s[_]))&&a.removeChild(c(s[_],-1)),_++;else if(s[_]===d[E])_++,E++;else if(s[p-1]===d[y-1])p--,y--;else if(s[_]===d[y-1]&&d[E]===s[p-1]){const P=c(s[--p],-1).nextSibling;a.insertBefore(c(d[E++],1),c(s[_++],-1).nextSibling),a.insertBefore(c(d[--y],1),P),s[p]=d[y]}else{if(!O){O=new Map;let P=E;for(;P<y;)O.set(d[P],P++)}if(O.has(s[_])){const P=O.get(s[_]);if(E<P&&P<y){let C=_,A=1;for(;++C<p&&C<y&&O.get(s[C])===P+A;)A++;if(A>P-E){const q=c(s[_],0);for(;E<P;)a.insertBefore(c(d[E++],1),q)}else a.replaceChild(c(d[E++],1),c(s[_++],-1))}else _++}else a.removeChild(c(s[_++],-1))}return d};/*! (c) Andrea Giammarchi - ISC */var importNode=function(a,s,d,c,l){var h=l in a,p=a.createDocumentFragment();p[s](a[c]("g")),p[s](a[c](""));var y=h?a[l](p,!0):p[d](!0);return y.childNodes.length<2?function _(E,O){for(var P=E[d](),C=E.childNodes||[],A=C.length,q=0;O&&q<A;q++)P[s](_(C[q],O));return P}:h?a[l]:function(_,E){return _[d](!!E)}}(document,"appendChild","cloneNode","createTextNode","importNode"),trim="".trim||function(){return String(this).replace(/^\s+|\s+/g,"")},normalizeAttributes=UID_IE?function(a,s){var d=s.join(" ");return s.slice.call(a,0).sort(function(c,l){return d.indexOf(c.name)<=d.indexOf(l.name)?-1:1})}:function(a,s){return s.slice.call(a,0)};function find(a,s){for(var d=s.length,c=0;c<d;)a=a.childNodes[s[c++]];return a}function parse(a,s,d,c){for(var l=a.childNodes,h=l.length,p=0;p<h;){var y=l[p];switch(y.nodeType){case ELEMENT_NODE$1:var _=c.concat(p);parseAttributes(y,s,d,_),parse(y,s,d,_);break;case COMMENT_NODE:var E=y.textContent;if(E===UID)d.shift(),s.push(SHOULD_USE_TEXT_CONTENT.test(a.nodeName)?Text(a,c):Any(y,c.concat(p)));else switch(E.slice(0,2)){case"/*":if(E.slice(-2)!=="*/")break;case"\u{1F47B}":a.removeChild(y),p--,h--}break;case TEXT_NODE:SHOULD_USE_TEXT_CONTENT.test(a.nodeName)&&trim.call(y.textContent)===UIDC&&(d.shift(),s.push(Text(a,c)));break}p++}}function parseAttributes(a,s,d,c){for(var l=a.attributes,h=[],p=[],y=normalizeAttributes(l,d),_=y.length,E=0;E<_;){var O=y[E++],P=O.value===UID,C;if(P||1<(C=O.value.split(UIDC)).length){var A=O.name;if(h.indexOf(A)<0){h.push(A);var q=d.shift().replace(P?/^(?:|[\S\s]*?\s)(\S+?)\s*=\s*('|")?$/:new RegExp("^(?:|[\\S\\s]*?\\s)("+A+`)\\s*=\\s*('|")[\\S\\s]*`,"i"),"$1"),U=l[q]||l[q.toLowerCase()];if(P)s.push(Attr(U,c,q,null));else{for(var F=C.length-2;F--;)d.shift();s.push(Attr(U,c,q,C))}}p.push(O)}}_=p.length,E=0;for(var j=0<_&&UID_IE&&!("ownerSVGElement"in a);E<_;){var T=p[E++];j&&(T.value=""),a.removeAttribute(T.name)}var D=a.nodeName;if(/^script$/i.test(D)){var J=document.createElement(D);for(_=l.length,E=0;E<_;)J.setAttributeNode(l[E++].cloneNode(!0));J.textContent=a.textContent,a.parentNode.replaceChild(J,a)}}function Any(a,s){return{type:"any",node:a,path:s}}function Attr(a,s,d,c){return{type:"attr",node:a,path:s,name:d,sparse:c}}function Text(a,s){return{type:"text",node:a,path:s}}var parsed=umap(new WeakMap$1);function createInfo(a,s){var d=(a.convert||domsanitizer)(s),c=a.transform;c&&(d=c(d));var l=createContent(d,a.type);cleanContent(l);var h=[];return parse(l,h,s.slice(0),[]),{content:l,updates:function(p){for(var y=[],_=h.length,E=0,O=0;E<_;){var P=h[E++],C=find(p,P.path);switch(P.type){case"any":y.push({fn:a.any(C,[]),sparse:!1});break;case"attr":var A=P.sparse,q=a.attribute(C,P.name,P.node);A===null?y.push({fn:q,sparse:!1}):(O+=A.length-2,y.push({fn:q,sparse:!0,values:A}));break;case"text":y.push({fn:a.text(C),sparse:!1}),C.textContent="";break}}return _+=O,function(){var U=arguments.length;if(_!==U-1)throw new Error(U-1+" values instead of "+_+`
`+s.join("${value}"));for(var F=1,j=1;F<U;){var T=y[F-j];if(T.sparse){var D=T.values,J=D[0],ee=1,z=D.length;for(j+=z-2;ee<z;)J+=arguments[F++]+D[ee++];T.fn(J)}else T.fn(arguments[F++])}return p}}}}function createDetails(a,s){var d=parsed.get(s)||parsed.set(s,createInfo(a,s));return d.updates(importNode.call(document,d.content,!0))}var empty=[];function domtagger(a){var s=empty,d=cleanContent;return function(c){return s!==c&&(d=createDetails(a,s=c)),d.apply(null,arguments)}}function cleanContent(a){for(var s=a.childNodes,d=s.length;d--;){var c=s[d];c.nodeType!==1&&trim.call(c.textContent).length===0&&a.removeChild(c)}}/*! (c) Andrea Giammarchi - ISC */var hyperStyle=function(){var a=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,s=/([^A-Z])([A-Z]+)/g;return function(y,_){return"ownerSVGElement"in y?c(y,_):h(y.style,!1)};function d(p,y,_){return y+"-"+_.toLowerCase()}function c(p,y){var _;return y?_=y.cloneNode(!0):(p.setAttribute("style","--hyper:style;"),_=p.getAttributeNode("style")),_.value="",p.setAttributeNode(_),h(_,!0)}function l(p){var y,_=[];for(y in p)_.push(y.replace(s,d),":",p[y],";");return _.join("")}function h(p,y){var _,E;return function(O){var P,C,A,q;switch(typeof O){case"object":if(O){if(_==="object"){if(!y&&E!==O)for(C in E)C in O||(p[C]="")}else y?p.value="":p.cssText="";P=y?{}:p;for(C in O)q=O[C],A=typeof q=="number"&&!a.test(C)?q+"px":q,!y&&/^--/.test(C)?P.setProperty(C,A):P[C]=A;_="object",y?p.value=l(E=P):E=O;break}default:E!=O&&(_="string",E=O,y?p.value=O||"":p.cssText=O||"");break}}}}();const aria=a=>s=>{for(const d in s){const c=d==="role"?d:`aria-${d}`,l=s[d];l==null?a.removeAttribute(c):a.setAttribute(c,l)}},attribute=(a,s)=>{let d,c=!0;const l=document.createAttributeNS(null,s);return h=>{d!==h&&(d=h,d==null?c||(a.removeAttributeNode(l),c=!0):(l.value=h,c&&(a.setAttributeNodeNS(l),c=!1)))}},boolean=(a,s,d)=>c=>{d!==!!c&&((d=!!c)?a.setAttribute(s,""):a.removeAttribute(s))},data=({dataset:a})=>s=>{for(const d in s){const c=s[d];c==null?delete a[d]:a[d]=c}},event=(a,s)=>{let d,c=s.slice(2);return!(s in a)&&s.toLowerCase()in a&&(c=c.toLowerCase()),l=>{const h=isArray(l)?l:[l,!1];d!==h[0]&&(d&&a.removeEventListener(c,d,h[1]),(d=h[0])&&a.addEventListener(c,d,h[1]))}},ref=a=>s=>{typeof s=="function"?s(a):s.current=a},setter=(a,s)=>s==="dataset"?data(a):d=>{a[s]=d},hyperProperty=(a,s)=>{let d;return c=>{d!==c&&(d=c,a[s]!==c&&(c==null?(a[s]="",a.removeAttribute(s)):a[s]=c))}},readOnly=/^(?:form|list)$/i,text=(a,s)=>a.ownerDocument.createTextNode(s);function Tagger(a){return this.type=a,domtagger(this)}Tagger.prototype={attribute(a,s,d){const c=this.type==="svg";switch(s){case"class":if(c)return attribute(a,s);s="className";case"props":return setter(a,s);case"aria":return aria(a);case"style":return hyperStyle(a,d,c);case"ref":return ref(a);case".dataset":return data(a);default:return s.slice(0,1)==="."?setter(a,s.slice(1)):s.slice(0,1)==="?"?boolean(a,s.slice(1)):s.slice(0,2)==="on"?event(a,s):s in a&&!(c||readOnly.test(s))?hyperProperty(a,s):attribute(a,s)}},any(a,s){const{type:d}=this;let c=!1,l;const h=p=>{switch(typeof p){case"string":case"number":case"boolean":c?l!==p&&(l=p,s[0].textContent=p):(c=!0,l=p,s=udomdiff(a.parentNode,s,[text(a,p)],diffable,a));break;case"function":h(p(a));break;case"object":case"undefined":if(p==null){c=!1,s=udomdiff(a.parentNode,s,[],diffable,a);break}default:if(c=!1,l=p,isArray(p))if(p.length===0)s.length&&(s=udomdiff(a.parentNode,s,[],diffable,a));else switch(typeof p[0]){case"string":case"number":case"boolean":h(String(p));break;case"function":h(p.map(invoke,a));break;case"object":isArray(p[0])&&(p=p.concat.apply([],p));default:s=udomdiff(a.parentNode,s,p,diffable,a);break}else"ELEMENT_NODE"in p?s=udomdiff(a.parentNode,s,p.nodeType===11?slice.call(p.childNodes):[p],diffable,a):"text"in p?h(String(p.text)):"any"in p?h(p.any):"html"in p?s=udomdiff(a.parentNode,s,slice.call(createContent([].concat(p.html).join(""),d).childNodes),diffable,a):"length"in p&&h(slice.call(p));break}};return h},text(a){let s;const d=c=>{if(s!==c){s=c;const l=typeof c;l==="object"&&c?"text"in c?d(String(c.text)):"any"in c?d(c.any):"html"in c?d([].concat(c.html).join("")):"length"in c&&d(slice.call(c).join("")):l==="function"?d(c(a)):a.textContent=c==null?"":c}};return d}};function invoke(a){return a(this)}const{create:create$1,freeze,keys}=Object;Tagger.prototype;const cache=umap(new WeakMap$1),createRender=a=>({html:outer("html",a),svg:outer("svg",a),render(s,d){const c=typeof d=="function"?d():d,l=cache.get(s)||cache.set(s,createCache()),h=c instanceof LighterHole?unroll(a,l,c):c;return h!==l.wire&&(l.wire=h,s.textContent="",s.appendChild(h.valueOf())),s}}),createCache=()=>({stack:[],entry:null,wire:null}),outer=(a,s)=>{const d=umap(new WeakMap$1),c=h=>function(){return unroll(s,h,l.apply(null,arguments))};return l.for=(h,p)=>{const y=d.get(h)||d.set(h,create$1(null));return y[p]||(y[p]=c(createCache()))},l.node=function(){return unroll(s,createCache(),l.apply(null,arguments)).valueOf()},l;function l(){return new LighterHole(a,tta.apply(null,arguments))}},unroll=(a,s,{type:d,template:c,values:l})=>{const{length:h}=l;unrollValues(a,s,l,h);let{entry:p}=s;if(!p||p.template!==c||p.type!==d){const y=new a(d);s.entry=p={type:d,template:c,tag:y,wire:persistent(y(c,...l))}}else p.tag(c,...l);return p.wire},unrollValues=(a,{stack:s},d,c)=>{for(let l=0;l<c;l++){const h=d[l];h instanceof Hole?d[l]=unroll(a,s[l]||(s[l]=createCache()),h):isArray(h)?unrollValues(a,s[l]||(s[l]=createCache()),h,h.length):s[l]=null}c<s.length&&s.splice(c)};freeze(LighterHole);function LighterHole(a,s){this.type=a,this.template=s.shift(),this.values=s}const Hole=LighterHole,{render:render$1,html,svg}=createRender(Tagger);function tta(){let a=[],s=0,{length:d}=arguments;for(;s<d;)a.push(arguments[s++]);return a}const Free={name:"Free",layout:({props:a,children:s,size:d})=>s.reduce((c,l)=>{const{size:h={x:"100%",y:"100%"},position:p={x:0,y:0},opacity:y=1}=l.props;return{...c,[l.id]:{position:{x:p.x,y:p.y},size:{x:h.x,y:h.y},opacity:y}}},{})},Column={name:"Column",layout:({props:a={},children:s,size:d})=>{let{justify:c="center",align:l="center",cover:h=!1,margin:p={},dimensions:y=16/9,reverse:_=!1}=a;const E=h?0:Math.min(d.y/6,12);p={left:E,right:E,top:E,bottom:E,between:E,...p};const O=d.y-p.top-p.bottom,P=d.x-p.left-p.right,C=p.between*((s.length||1)-1),A=Math.min(P,(O-C)/(s.length||1)*y),q=A/y;return html.node`
      <div style=${{height:"100%",width:h?d.x+"px":"auto",display:"flex",flexDirection:_?"column-reverse":"column",justifyContent:c,alignItems:l,paddingLeft:p.left+"px",paddingTop:p.top+"px",paddingBottom:p.bottom+"px",paddingRight:p.right+"px"}}>
      ${s.map((U,F)=>html.node`<div data-node-id=${U.id} .data=${{entryTransition:{delay:400+F*100,offset:{x:0,y:"100%"},scale:{x:.8,y:.8},opacity:0},exitTransition:{offset:{x:0,y:1e3},scale:{x:.8,y:.8},opacity:0},borderRadius:h?0:5}} style=${{display:"flex",width:h?"100%":A+"px",height:h?q+"px":"auto",aspectRatio:y,marginBottom:F===s.length-1?0:p.between+"px",flexGrow:0,flexShrink:1,flexBasis:q+"px"}}></div>`)}
      </div>
    `}},Row={name:"Row",layout:({props:a={},children:s,size:d})=>{let{justify:c="center",align:l="center",cover:h=!1,margin:p={},dimensions:y=16/9,maxWidth:_=1,reverse:E=!1}=a;const O=h?0:Math.min(d.y/6,12);p={left:O,right:O,top:O,bottom:O,between:O,...p};const P=d.y-p.top-p.bottom,C=d.x-p.left-p.right,A=p.between*((s.length||1)-1),q=Math.min((C-A)/(s.length||1),P*y,_*d.x),U=q/y;return html.node`
      <div style=${{height:h?d.y+"px":"auto",width:"100%",display:"flex",flexDirection:E?"row-reverse":"row",justifyContent:c,alignItems:l,paddingLeft:p.left+"px",paddingTop:p.top+"px",paddingBottom:p.bottom+"px",paddingRight:p.right+"px"}}>
          ${s.map((F,j)=>html.node`<div data-node-id=${F.id} .data=${{entryTransition:{delay:400+j*100,offset:{x:0,y:"100%"},scale:{x:.8,y:.8},opacity:0},exitTransition:{offset:{x:0,y:1e3},scale:{x:.8,y:.8},opacity:0},borderRadius:h?0:5}} style=${{display:"flex",height:h?"100%":U+"px",width:q+"px",aspectRatio:y,marginRight:j===s.length-1?0:p.between+"px",flexGrow:0,flexShrink:1,flexBasis:q+"px"}}></div>`)}
      </div>
    `}},toMatrix=(a,s)=>a.reduce((d,c,l)=>(l%s==0?d.push([l]):d[d.length-1].push(l))&&d,[]),Grid={name:"Grid",layout:({props:a={},children:s,size:d})=>{let{dimensions:c=16/9,numPerRow:l,margin:h,cover:p=!1,maxWidth:y}=a;const _=s.length===0||p?0:Math.min(d.y/s.length/10,30);h=h!=null?h:_;const E=d.x<d.y;let O=[];l?O=toMatrix(s,l):O=E?getTallGrid(s.length):getWideGrid(s.length);const P=(d.y-h)/O.length,C=d.x-h;return html.node`
    <div style=${{display:"flex",width:"100%",height:"100%",flexDirection:"column",justifyContent:"center",paddingLeft:h+"px",paddingBottom:h+"px",flexGrow:0}}>${O.map((A,q)=>Row.layout({props:{justify:"center",dimensions:c,cover:p,maxWidth:y||1/(O[0].length||1),margin:{top:h,right:h,left:0,bottom:0,between:h}},children:A.map(U=>s[U]),size:{y:P,x:C}}))}</div>`}},Presentation={name:"Presentation",layout:({props:a={},children:s,size:d})=>{let{margin:c,cover:l=!1,barWidth:h=.2,barPosition:p="side",presentationDimensions:y=16/9,viewerDimensions:_=16/9,justifyViewers:E="center",useGrid:O=!1,reverse:P=!1}=a;const C=p==="side"?d.x*h:d.y*h,A=s[0],q=s.filter(ee=>ee!==A),U=s.length<=1?0:Math.min(d.x/80,30);if(c=c!=null?c:U,!A)return Grid.layout({props:a,children:s,size:d});const F=s[1],j={...d};F&&(p==="side"?(j.x=d.x-C,j.y=j.x/y):(j.y=d.y-C,j.x=j.y*y));let T,D={};O?(T=Grid.layout,D={cover:l,...l?{maxWidth:1}:{margin:c}}):(T=p==="side"?Column.layout:Row.layout,D={margin:{top:c,left:c,bottom:c,right:c,between:c},dimensions:_,justify:E,align:"flex-end"});const J=p==="side"?P?"left":"right":P?"top":"bottom";return html.node`
      <div style=${{display:"flex",flexDirection:(p==="side"?"row":"column")+(P?"-reverse":""),justifyContent:"space-around",alignItems:"center",position:"relative",padding:l?0:c,[`padding-${J}`]:0}}>
        ${s[0]&&html.node`<div style=${{width:j.x,height:j.y,display:"flex",flexGrow:1}}>
            <div data-node-id=${A.id} .data=${{dimensions:y,borderRadius:l?0:5,entryTransition:{delay:0,offset:{x:0,y:1e3},scale:{x:.5,y:.5},opacity:0},exitTransition:{offset:{x:0,y:1e3},scale:{x:2,y:2},opacity:0}}} style=${{width:"100%",height:"100%",...l?{position:"absolute",top:0,left:0,width:O&&F?100-h*100+"%":"100%",height:"100%"}:{}}} />
          </div>`}
        ${html.node`<div style=${{...p==="side"?{maxWidth:h*100+"%",height:"100%"}:{maxHeight:h*100+"%",width:"100%"}}}>${F&&T({props:D,children:q,size:p==="side"?{x:C,y:d.y}:{x:d.x,y:C}})}</div>`}
      </div>
    `}},Layered={name:"Layered",layout:({props:a={},children:s,size:d})=>html.node`<div style=${{width:"100%",height:"100%",position:"relative"}}>
      ${s.map((c,l)=>html.node`<div data-node-id=${c.id} .data=${{zIndex:l+1}} style=${{width:"100%",height:"100%",position:"absolute",top:0,left:0}}></div>`)}
    </div>`},getWideGrid=(a=0)=>{switch(a){case 0:return[[]];case 1:return[[0]];case 2:return[[0,1]];case 3:return[[0,1],[2]];case 4:return[[0,1],[2,3]];case 5:return[[0,1,2],[3,4]];case 6:return[[0,1,2],[3,4,5]];case 7:return[[0,1,2],[3,4],[5,6]];case 8:return[[0,1,2],[3,4,5],[6,7]]}const s=Array(a).fill(null).map((d,c)=>c);return toMatrix(s,Math.round(Math.sqrt(a)))},getTallGrid=(a=0)=>{switch(a){case 0:return[[]];case 1:return[[0]];case 2:return[[0],[1]];case 3:return[[0,1],[2]];case 4:return[[0,1],[2,3]];case 5:return[[0,1],[2,3],[4]];case 6:return[[0,1],[2,3],[4,5]];case 7:return[[0,1],[2,3],[4,5],[6]];case 8:return[[0,1],[2,3],[4,5],[6,7]]}const s=Array(a).fill(null).map((d,c)=>c);return toMatrix(s,Math.ceil(Math.sqrt(s.length))-1)};var Layouts=Object.freeze(Object.defineProperty({__proto__:null,Free,Column,Row,Grid,Presentation,Layered},Symbol.toStringTag,{value:"Module"}));const deviceWatchers=new Set,updateMediaStreamTracks=(a,s)=>{const d={audio:a.getAudioTracks()[0],video:a.getVideoTracks()[0]};d.audio!==s.audio&&(d.audio&&a.removeTrack(d.audio),s.audio&&a.addTrack(s.audio)),d.video!==s.video&&(d.video&&a.removeTrack(d.video),s.video&&a.addTrack(s.video))},getDevicePermissions=async()=>{const a={audio:!0,video:!0};return Promise.all([navigator.mediaDevices.getUserMedia({video:!0}).then(s=>{s.getTracks().forEach(d=>d.stop())}).catch(s=>{s.name==="NotAllowedError"&&(a.video=!1)}),navigator.mediaDevices.getUserMedia({audio:!0}).then(s=>{s.getTracks().forEach(d=>d.stop())}).catch(s=>{s.name==="NotAllowedError"&&(a.audio=!1)})]).then(()=>a)},ensureDevicePermissions=async()=>getDevicePermissions(),watchDevices=a=>(deviceWatchers.size===0&&navigator.mediaDevices.addEventListener("devicechange",reportDevices),deviceWatchers.add(a),reportDevices().catch(()=>{}),()=>{deviceWatchers.delete(a),deviceWatchers.size===0&&navigator.mediaDevices.removeEventListener("devicechange",reportDevices)}),getUserMedia=async(...a)=>{const s=await navigator.mediaDevices.getUserMedia(...a);return reportDevices(),s},deviceWithDefaultLabel=(a,s)=>({deviceId:a.deviceId,groupId:a.groupId,kind:a.kind,label:a.label||s}),reportDevices=async()=>{const a=await navigator.mediaDevices.enumerateDevices(),s=a.filter(l=>l.kind==="videoinput").map((l,h)=>deviceWithDefaultLabel(l,"Camera "+(h+1))),d=a.filter(l=>l.kind==="audioinput").map((l,h)=>deviceWithDefaultLabel(l,"Microphone "+(h+1))),c=a.filter(l=>l.kind==="audiooutput").map((l,h)=>deviceWithDefaultLabel(l,"Speaker "+(h+1)));deviceWatchers.forEach(l=>l({webcams:s,microphones:d,speakers:c}))};var webrtc=Object.freeze(Object.defineProperty({__proto__:null,updateMediaStreamTracks,getDevicePermissions,ensureDevicePermissions,watchDevices,getUserMedia},Symbol.toStringTag,{value:"Module"}));const RoomParticipant={type:"RoomParticipant",valueType:MediaStream,props:{id:{},type:{},videoEnabled:{},audioEnabled:{}},init({addSource:a,removeSource:s,updateSource:d}){CoreContext.on("RoomJoined",({room:c})=>{let l={},h=[],p=[],y={};const _=()=>{p.forEach(E=>{const O=y[E.id],P=y[E.id+"-screen"],C=E.trackIds.find(T=>{const D=c.getTrack(T);return(D==null?void 0:D.type)==="camera"}),A=E.trackIds.find(T=>{const D=c.getTrack(T);return(D==null?void 0:D.type)==="microphone"}),q=E.trackIds.find(T=>{const D=c.getTrack(T);return(D==null?void 0:D.type)==="screen_share"}),U=c.getTrack(C),F=c.getTrack(A),j=c.getTrack(q);updateMediaStreamTracks(O,{video:U==null?void 0:U.mediaStreamTrack,audio:F==null?void 0:F.mediaStreamTrack}),updateMediaStreamTracks(P,{video:j==null?void 0:j.mediaStreamTrack}),d(E.id,{videoEnabled:Boolean(U&&!U.isMuted),audioEnabled:Boolean(F&&!F.isMuted),displayName:E.displayName}),d(E.id+"-screen",{videoEnabled:Boolean(j&&!j.isMuted),displayName:E.meta.screenDisplayName||`${E.displayName}'s Screen`})})};c.useTracks(E=>{const O=E.filter(C=>!h.some(A=>A.id===C.id)),P=h.filter(C=>!E.some(A=>A.id===C.id));h=E,_(),O.forEach(C=>{const{mediaStreamTrack:A,id:q,participantId:U,type:F}=c.getTrack(C.id),j={id:q,isActive:!0,value:A,props:{trackId:q,participantId:U,isMuted:C.isMuted,type:F}};A&&(A.kind,a(j))}),P.forEach(C=>{var A;s(C.id),(A=l[C.id])==null||A.call(l)})}),c.useParticipants(E=>{const O=E.filter(C=>!p.some(A=>A.id===C.id)),P=p.filter(C=>!E.some(A=>A.id===C.id));p=E,O.forEach(C=>{const{id:A}=C,q=new MediaStream([]),U=new MediaStream([]);y[A]=q,y[A+"-screen"]=U,a({id:A,isActive:!0,value:q,props:{id:A,type:"camera",displayName:C.displayName||C.id,audioEnabled:!1,videoEnabled:!1}}),a({id:A+"-screen",isActive:!0,value:U,props:{id:A,type:"screen",displayName:C.displayName||C.id,audioEnabled:!1,videoEnabled:!1}})}),_(),P.forEach(C=>{var A;s(C.id),(A=l[C.id])==null||A.call(l)})})})}},Overlays={type:"Overlay",valueType:Object,props:{},init({addSource:a,removeSource:s,updateSource:d,getSource:c,modifySourceValue:l}){let h=[];const p=(y=[])=>{const _=y.filter(P=>!h.some(C=>C.id===P.id)),E=h.filter(P=>!y.some(C=>C.id===P.id)),O=y.filter(P=>{const C=h.find(A=>A.id===P.id);return!fastDeepEqual(P,C)});_.forEach(P=>a({id:P.id,value:{...P.props},props:P.props})),E.forEach(P=>s(P.id)),O.forEach(P=>{d(P.id,P.props),l(P.id,C=>{Object.keys(P.props).forEach(A=>{C[A]=P.props[A]})})}),h=JSON.parse(JSON.stringify(y))};CoreContext.on("ActiveProjectChanged",({projectId:y})=>{if(h=[],!y)return;const _=getProject(y);p(_.props.overlays)}),CoreContext.on("ProjectChanged",({project:y})=>{p(y.props.overlays)})}},Banner={type:"Banner",valueType:Object,props:{},init({addSource:a,removeSource:s,updateSource:d,getSource:c,modifySourceValue:l}){let h=[];const p=(y=[])=>{const _=y.filter(P=>!h.some(C=>C.id===P.id)),E=h.filter(P=>!y.some(C=>C.id===P.id)),O=y.filter(P=>{const C=h.find(A=>A.id===P.id);return!fastDeepEqual(P,C)});_.forEach(P=>a({id:P.id,value:{headerText:P.props.headerText,bodyText:P.props.bodyText},props:P.props})),E.forEach(P=>s(P.id)),O.forEach(P=>{d(P.id,P.props),l(P.id,C=>{C.headerText=P.props.headerText,C.bodyText=P.props.bodyText})}),h=y};CoreContext.on("ActiveProjectChanged",({projectId:y})=>{var E,O;if(h=[],!y)return;const _=getProject(y);p((O=(E=_.props)==null?void 0:E.banners)!=null?O:[])}),CoreContext.on("ProjectChanged",({project:y})=>{var _,E;p((E=(_=y.props)==null?void 0:_.banners)!=null?E:[])})}},Background={type:"Background",valueType:Object,props:{},init({addSource:a,removeSource:s,updateSource:d,getSource:c,modifySourceValue:l}){let h;const p=y=>{if(!y)return;const _=(h==null?void 0:h.id)!==(y==null?void 0:y.id)?y:null,E=fastDeepEqual(y,h)?null:y;_&&(a({id:_==null?void 0:_.id,value:{..._==null?void 0:_.props},props:_==null?void 0:_.props}),s(h==null?void 0:h.id)),E&&(d(E==null?void 0:E.id,E==null?void 0:E.props),l(E==null?void 0:E.id,O=>{Object.keys(E==null?void 0:E.props).forEach(P=>{O[P]=E==null?void 0:E.props[P]})})),h=JSON.parse(JSON.stringify(y))};CoreContext.on("ActiveProjectChanged",({projectId:y})=>{if(h=null,!y)return;const _=getProject(y);p(_.props.background)}),CoreContext.on("ProjectChanged",({project:y})=>{p(y.props.background)})}},Logo={type:"Logo",valueType:Object,props:{},init({addSource:a,removeSource:s,updateSource:d,getSource:c,modifySourceValue:l}){let h;const p=y=>{if(!y){h&&(s(h==null?void 0:h.id),h=null);return}const _=(h==null?void 0:h.id)!==(y==null?void 0:y.id)?y:null,E=fastDeepEqual(y,h)?null:y;_&&(a({id:_==null?void 0:_.id,value:{..._==null?void 0:_.props},props:_==null?void 0:_.props}),s(h==null?void 0:h.id)),E&&(d(E==null?void 0:E.id,E==null?void 0:E.props),l(E==null?void 0:E.id,O=>{Object.keys(E==null?void 0:E.props).forEach(P=>{O[P]=E==null?void 0:E.props[P]})})),h=JSON.parse(JSON.stringify(y))};CoreContext.on("ActiveProjectChanged",({projectId:y})=>{if(h=null,!y)return;const _=getProject(y);p(_.props.logo)}),CoreContext.on("ProjectChanged",({project:y})=>{p(y.props.logo)})}};var Sources=Object.freeze(Object.defineProperty({__proto__:null,RoomParticipant,Overlays,Banner,Background,Logo},Symbol.toStringTag,{value:"Module"}));const{state:state$1}=CoreContext;subscribeInternal(async(a,s)=>{var d,c,l,h;switch(a){case"UserChanged":{const{metadata:p}=s;state$1.user.metadata=p||{},state$1.user.props=(p==null?void 0:p.props)||{},trigger$1("UserChanged",{user:getBaseUser()});return}case"ActiveProjectChanged":{const{projectId:p}=s;state$1.activeProjectId=p,trigger$1("ActiveProjectChanged",{projectId:p});return}case"ProjectAdded":{const y=await hydrateProject(s,"ROLE_HOST"),_=toBaseProject(y);state$1.projects=[...state$1.projects,y],trigger$1("ProjectAdded",{project:_});return}case"ProjectRemoved":{const{projectId:p}=s;state$1.projects=state$1.projects.filter(y=>y.id!==p),trigger$1("ProjectRemoved",{projectId:p});return}case"ProjectChanged":{const{project:p,phase:y,broadcastId:_}=s,E=getProject(p.projectId);if(!E)return;y&&(E.videoApi.phase=y),typeof _!="undefined"&&(E.videoApi.broadcastId=_),E.videoApi.project=p,E.props=(c=(d=p.metadata)==null?void 0:d.props)!=null?c:{},trigger$1("ProjectChanged",{project:toBaseProject(E)});return}case"DestinationAdded":{const{projectId:p}=s,y=getProject(p);if(!y)return;y.videoApi.project.destinations.push(s),trigger$1("DestinationAdded",{projectId:p,destination:toBaseDestination(s)});return}case"DestinationRemoved":{const{projectId:p,destinationId:y}=s,_=getProject(p);if(!_)return;_.videoApi.project.destinations=_.videoApi.project.destinations.filter(E=>E.destinationId!==y),trigger$1("DestinationRemoved",{projectId:p,destinationId:y});return}case"DestinationChanged":{const p=s,{projectId:y,destinationId:_}=p,E=getProject(y);if(!E)return;const O=E.videoApi.project.destinations.find(P=>P.destinationId===_);if(!O)return;Object.assign(O,p),trigger$1("DestinationChanged",{projectId:y,destination:toBaseDestination(O)});return}case"SourceAdded":return;case"SourceRemoved":return;case"SourceUpdated":return;case"NodeAdded":return;case"NodeRemoved":return;case"NodeUpdated":return;case"BackgroundMetadataUpdate":{const{Command:p}=CoreContext,{projectId:y,metadata:_,sourceId:E,doTrigger:O,role:P}=s;if(P==="ROLE_HOST"||P==="ROLE_COHOST"){const C=getProject(y);if(!C||C.props.background.id!==E)return;let A=(l=C==null?void 0:C.props)==null?void 0:l.background;A&&(A={...A,props:{...A.props,meta:{...A.props.meta,..._}}},O?p.updateProjectProps({projectId:y,props:{background:A}}):p.updateProjectPropsWithoutTrigger({projectId:y,props:{background:A}}))}return}case"OverlayMetadataUpdate":{const{Command:p}=CoreContext,{projectId:y,metadata:_,sourceId:E,doTrigger:O,role:P}=s;if(P==="ROLE_HOST"||P==="ROLE_COHOST"){const C=getProject(y);if(!C)return;let A=C.props.overlays.find(q=>q.id===E);if(A){A={...A,props:{...A.props,meta:{...A.props.meta,..._}}};const q=C.props.overlays.findIndex(U=>U.id===E);if(q>-1){const U=JSON.parse(JSON.stringify((h=C==null?void 0:C.props)==null?void 0:h.overlays));U.splice(q,1,A),O?p.updateProjectProps({projectId:y,props:{overlays:U}}):p.updateProjectPropsWithoutTrigger({projectId:y,props:{overlays:U}})}}}return}}}),subscribeInternal(()=>log$1.debug({nextState:{...state$1}}));var functionExpression=/[\s]*([a-z-]+)[\s]*\([\s]*([^\)]+)[\s]*\)[\s]*/i,floatExpression=/^(\-?\d+\.?\d{0,5})/,toFloat=parseFloat;function ensurePercent(a){return typeof a=="number"?a:toFloat(a)*.01}function formatPercent(a){return formatFloat(a*100)+"%"}function formatFloat(a){return floatExpression.exec(a.toString())[1]}function parseCSSFunction(a){var s=functionExpression.exec(a);if(!(!s||!s.length))return[s[1]].concat(s[2].split(","))}function cssFunction(a,s){var d=Array.prototype.join.call(s,", ");return a+"("+d+")"}var math=Math,round=math.round;function roundFloat(a,s){return round(a*s)/s}var _a,RGB="rgb",HSL="hsl",converters=(_a={},_a[RGB+HSL]=RGBtoHSL,_a[HSL+RGB]=HSLtoRGB,_a),maxChannelValues={r:255,g:255,b:255,h:360,s:1,l:1,a:1};function color(a){return parseHexCode(a)||parseColorFunction(a)||rgb(255,0,0)}function rgb(a,s,d,c){return new ColorHelper(RGB,a,s,d,c===void 0?1:ensurePercent(c),c!==void 0)}function convertHelper(a,s,d){var c=s.f,l=s.r,h=s.g,p=s.b,y=s.a,_=d===void 0?s.o:d;return c!==a?converters[c+a](l,h,p,y,_):d===void 0?s:new ColorHelper(c,l,h,p,y,_)}var ColorHelper=function(){function a(s,d,c,l,h,p){var y=this;y.f=s,y.o=p;var _=s===HSL;y.r=clampColor(_?"h":"r",d),y.g=clampColor(_?"s":"g",c),y.b=clampColor(_?"l":"b",l),y.a=clampColor("a",h)}return a.prototype.toString=function(){var s=this,d=s.o,c=s.f,l=s.r,h=s.g,p=s.b,y=s.a,_,E;if(c===RGB)_=d?"rgba":RGB,E=[round(l),round(h),round(p)];else if(c===HSL)_=d?"hsla":HSL,E=[round(l),formatPercent(roundFloat(h,100)),formatPercent(roundFloat(p,100))];else throw new Error("Invalid color format");return d&&E.push(formatFloat(roundFloat(y,1e5))),cssFunction(_,E)},a.prototype.toHexString=function(){var s=convertHelper(RGB,this);return"#"+(toHex(s.r)+toHex(s.g)+toHex(s.b)).toUpperCase()},a.prototype.toHSL=function(){return convertHelper(HSL,this,!1)},a.prototype.toHSLA=function(){return convertHelper(HSL,this,!0)},a.prototype.toRGB=function(){return convertHelper(RGB,this,!1)},a.prototype.toRGBA=function(){return convertHelper(RGB,this,!0)},a.prototype.red=function(){var s=this;return(s.f===RGB?s:s.toRGB()).r},a.prototype.green=function(){var s=this;return(s.f===RGB?s:s.toRGB()).g},a.prototype.blue=function(){var s=this;return(s.f===RGB?s:s.toRGB()).b},a.prototype.hue=function(){var s=this;return(s.f===HSL?s:s.toHSL()).r},a.prototype.saturation=function(){var s=this;return(s.f===HSL?s:s.toHSL()).g},a.prototype.lightness=function(){var s=this;return(s.f===HSL?s:s.toHSL()).b},a.prototype.alpha=function(){return this.a},a.prototype.opacity=function(){return this.a},a.prototype.invert=function(){var s=this,d=convertHelper(RGB,s);return convertHelper(s.f,new a(RGB,255-d.r,255-d.g,255-d.b,s.a,s.o))},a.prototype.lighten=function(s,d){var c=this,l=convertHelper(HSL,c),h=maxChannelValues.l,p=l.b+(d?h-l.b:h)*ensurePercent(s);return convertHelper(c.f,new a(HSL,l.r,l.g,p,c.a,c.o))},a.prototype.darken=function(s,d){var c=this,l=convertHelper(HSL,c),h=l.b-(d?l.b:maxChannelValues.l)*ensurePercent(s);return convertHelper(c.f,new a(HSL,l.r,l.g,h,c.a,c.o))},a.prototype.saturate=function(s,d){var c=this,l=convertHelper(HSL,c),h=maxChannelValues.s,p=l.g+(d?h-l.g:h)*ensurePercent(s);return convertHelper(c.f,new a(HSL,l.r,p,l.b,c.a,c.o))},a.prototype.desaturate=function(s,d){var c=this,l=convertHelper(HSL,c),h=maxChannelValues.s,p=l.g-(d?l.g:h)*ensurePercent(s);return convertHelper(c.f,new a(HSL,l.r,p,l.b,c.a,c.o))},a.prototype.grayscale=function(){return this.desaturate(1)},a.prototype.fade=function(s){var d=this,c=clampColor("a",ensurePercent(s));return convertHelper(d.f,new a(d.f,d.r,d.g,d.b,c,!0))},a.prototype.fadeOut=function(s,d){var c=this,l=1,h=clampColor("a",c.a-(d?c.a:l)*ensurePercent(s));return convertHelper(c.f,new a(c.f,c.r,c.g,c.b,h,!0))},a.prototype.fadeIn=function(s,d){var c=this,l=1,h=clampColor("a",c.a+(d?c.a:l)*ensurePercent(s));return convertHelper(c.f,new a(c.f,c.r,c.g,c.b,h,!0))},a.prototype.mix=function(s,d){var c=this,l=ensureColor(s),h=convertHelper(RGB,c),p=convertHelper(RGB,l),y=d===void 0?.5:d,_=2*y-1,E=Math.abs(h.a-p.a),O=((_*E===-1?_:(_+E)/(1+_*E))+1)/2,P=1-O,C=new a(RGB,round(h.r*O+p.r*P),round(h.g*O+p.g*P),round(h.b*O+p.b*P),h.a*y+p.a*(1-y),c.o||l.o);return convertHelper(this.f,C)},a.prototype.tint=function(s){return rgb(255,255,255).mix(this,s)},a.prototype.shade=function(s){return rgb(0,0,0).mix(this,s)},a.prototype.spin=function(s){var d=this,c=convertHelper(HSL,d);return convertHelper(d.f,new a(HSL,modDegrees(c.r+s),c.g,c.b,d.a,d.o))},a}();function toHex(a){var s=round(a);return(s<16?"0":"")+s.toString(16)}function modDegrees(a){return((a<0?360:0)+a%360)%360}function RGBtoHSL(a,s,d,c,l){var h=a/255,p=s/255,y=d/255,_=Math.min(h,p,y),E=Math.max(h,p,y),O=(_+E)/2,P=E-_,C;E===_?C=0:h===E?C=(p-y)/P:p===E?C=2+(y-h)/P:y===E?C=4+(h-p)/P:C=0,C=Math.min(C*60,360),C<0&&(C+=360);var A;return E===_?A=0:O<=.5?A=P/(E+_):A=P/(2-E-_),new ColorHelper(HSL,C,A,O,c,l)}function HSLtoRGB(a,s,d,c,l){var h=a/360,p=s,y=d;if(p===0){var _=y*255;return new ColorHelper(RGB,_,_,_,c,l)}for(var E=y<.5?y*(1+p):y+p-y*p,O=2*y-E,P=0,C=0,A=0,q=0;q<3;q++){var U=h+.3333333333333333*-(q-1);U<0&&U++,U>1&&U--;var _=void 0;6*U<1?_=O+(E-O)*6*U:2*U<1?_=E:3*U<2?_=O+(E-O)*(2/3-U)*6:_=O,_*=255,q===0?P=_:q===1?C=_:A=_}return new ColorHelper(RGB,P,C,A,c,l)}function clampColor(a,s){var d=0,c=maxChannelValues[a];return s<d?d:s>c?c:s}function ensureColor(a){return a instanceof ColorHelper?a:color(a)}function parseHexCode(a){var s=a.match(/#(([a-f0-9]{6})|([a-f0-9]{3}))$/i);if(!!s){var d=s[1],c=parseInt(d.length===3?d[0]+d[0]+d[1]+d[1]+d[2]+d[2]:d,16),l=c>>16&255,h=c>>8&255,p=c&255;return new ColorHelper(RGB,l,h,p,1,!1)}}function parseColorFunction(a){var s=parseCSSFunction(a);if(!(!s||!(s.length===4||s.length===5))){var d=s[0],c=d==="rgba",l=d==="hsla",h=d===RGB,p=d===HSL,y=l||c,_;if(h||c)_=RGB;else if(p||l)_=HSL;else throw new Error("unsupported color string");var E=toFloat(s[1]),O=h||c?toFloat(s[2]):ensurePercent(s[2]),P=h||c?toFloat(s[3]):ensurePercent(s[3]),C=y?toFloat(s[4]):1;return new ColorHelper(_,E,O,P,C,y)}}const dragImageSvg=`
  <svg height="75" width="120" viewBox="0 0 120 75" xmlns="http://www.w3.org/2000/svg" style="">
    <rect width="120" height="75" rx="3" style="
      opacity: 0.4;
      stroke: white;
      stroke-width: 3px;
      stroke-opacity: 0.7;
    "/>
  </svg>`;let dragImage;const loadDragImage=()=>dragImage||(dragImage=new Image,dragImage.src=URL.createObjectURL(new Blob([dragImageSvg],{type:"image/svg+xml"})),dragImage);class ErrorBoundary extends React__default.default.Component{constructor(s){super(s),this.state={error:null}}componentDidCatch(s,d){log$1.warn(s,d)}static getDerivedStateFromError(){return{error:!0}}render(){return this.state.error?null:this.props.children}}const onDrop=async(a,s)=>{s.preventDefault(),s.stopPropagation();const{dropNodeId:d,dropType:c,project:l}=a,h=s.dataTransfer.getData("text/plain");if(log$1.debug("Compositor: Dropping",{dropType:c,dragNodeId:h,dropNodeId:d}),d===h)return;const[p,y,_,E]=await Promise.all([l.compositor.get(h),l.compositor.get(d),l.compositor.getParent(h),l.compositor.getParent(d)]);if(c==="layout")return _.id===d?void 0:CoreContext.Command.moveNode({projectId:l.id,nodeId:p.id,parentId:y.id});if(_.id!==(E==null?void 0:E.id))return CoreContext.Command.swapNodes({projectId:l.id,nodeAId:p.id,nodeBId:y.id});const O=_.children.map(P=>P.id);return CoreContext.Command.reorderNodes({projectId:l.id,parentId:_.id,childIds:swapItems(p.id,y.id,O)})};let foundDropTarget=!1;const ElementTree=a=>{var D,J,ee;const s=React.useRef(!1),d=React.useRef(),c=React.useRef(),l=React.useRef(),{project:h,interactive:p=!0,onElementDoubleClick:y,checkIsDragTarget:_,checkIsDropTarget:E}=React.useContext(CompositorContext),{nodeId:O}=a,P=h.compositor.get(O);if(!P)return null;const C=CoreContext.compositor.getElement(P),A=P.props.layout||"Row",q=p&&_(P),U=p&&E(P);let F=U?{onDrop:z=>(foundDropTarget=!0,onDrop({dropType:"layout",dropNodeId:P.id,project:h},z)),onDragOver:z=>{var ne;z.preventDefault(),z.stopPropagation(),(ne=l.current)==null||ne.toggleAttribute("data-layout-drop-target-active",!0)},onDragLeave:z=>{var ne;z.preventDefault(),z.stopPropagation(),(ne=l.current)==null||ne.toggleAttribute("data-layout-drop-target-active",!1)}}:{},j=q?{draggable:!0,ondrop:z=>(foundDropTarget=!0,onDrop({dropType:"transform",dropNodeId:P.id,project:h},z)),ondragstart:z=>{var ne;s.current=!0,wrapperEl.toggleAttribute("data-dragging",!0),log$1.debug("Compositor: Dragging",P.id),foundDropTarget=!1,z.dataTransfer.setData("text/plain",P.id),z.dataTransfer.dropEffect="move",z.dataTransfer.setDragImage(dragImage,10,10),(ne=l.current)==null||ne.toggleAttribute("data-drag-target-active",!0),window.__dragging=!0},ondragend:z=>{var ne;s.current=!1,foundDropTarget||(log$1.info("Compositor: No drop target - deleting node",P),CoreContext.Command.deleteNode({nodeId:P.id})),wrapperEl.toggleAttribute("data-dragging",!0),log$1.debug("Compositor: DragEnd",z),(ne=l.current)==null||ne.toggleAttribute("data-drag-target-active",!1),wrapperEl.querySelectorAll("[data-item]").forEach(X=>{X.toggleAttribute("data-drag-target-active",!1),X.toggleAttribute("data-layout-drop-target-active",!1),X.toggleAttribute("data-transform-drop-target-active",!1)}),window.__dragging=!1},ondragover:z=>{var ne;z.preventDefault(),z.stopPropagation(),!s.current&&((ne=l.current)==null||ne.toggleAttribute("data-transform-drop-target-active",!0))},ondragleave:z=>{var ne;z.preventDefault(),z.stopPropagation(),(ne=l.current)==null||ne.toggleAttribute("data-transform-drop-target-active",!1)}}:{};React.useEffect(()=>{c.current&&C&&(c.current.appendChild(C.root),Object.assign(c.current.style,{width:"100%",height:"100%",position:"relative",overflow:"hidden"}),Object.assign(C.root.style,{pointerEvents:q?"all":"none",width:"100%",height:"100%",position:"relative",...P.props.style||{}}))},[c.current,C]),React.useEffect(()=>{const z=q?()=>y(P):()=>{};return d.current&&(Object.assign(d.current,j),Object.assign(d.current.style,{pointerEvents:q?"all":"none"}),d.current.addEventListener("dblclick",z)),()=>{var ne;(ne=d.current)==null||ne.removeEventListener("dblclick",z)}},[d.current]);const T={layout:A,...(D=P.props.layoutProps)!=null?D:{}};return React__default.default.createElement("div",{ref:l,"data-id":P.id+"-x","data-item":!0,...q&&{"data-drag-target":!0},...U&&{"data-drop-target":!0},...F,style:{position:"relative",width:((J=P.props.size)==null?void 0:J.x)||"100%",height:((ee=P.props.size)==null?void 0:ee.y)||"100%",pointerEvents:"none"}},React__default.default.createElement("div",{className:"interactive-overlay",ref:d,style:{height:"100%",width:"100%",position:"absolute",zIndex:2}}),React__default.default.createElement("div",{className:"item-element",style:{display:"flex",flex:"0 0 auto",justifyContent:"center",width:"100%",height:"100%"}},React__default.default.createElement("div",{ref:c}),React__default.default.createElement(ErrorBoundary,null,React__default.default.createElement("ls-layout",{"data-id":P.id+"-x",props:JSON.stringify(T),layout:A},P.children.map(z=>React__default.default.createElement(ElementTree,{key:z.id,nodeId:z.id}))))))},Root=a=>{const{project:s}=React.useContext(CompositorContext),[d,c]=React.useState(null);return React.useEffect(()=>(c(s.compositor.renderTree()),CoreContext.onInternal("NodeChanged",()=>{c(s.compositor.renderTree())})),[]),React.useEffect(()=>{const l=()=>{var P,C,A,q,U,F;const{bannerStyle:h=BannerStyle.DEFAULT,primaryColor:p="#ABABAB",showNameBanners:y}=(P=s.props)!=null?P:{},_=(F=(U=(C=s.props)==null?void 0:C.logoPosition)!=null?U:(q=(A=s.props)==null?void 0:A.logo)==null?void 0:q.logoPosition)!=null?F:LogoPosition.TopRight;if(!h||!p||!_)return;const E=themes[h](p,y),O=themes[_]();a.setStyle(`${E} ${O}`||"")};return l(),CoreContext.onInternal("ProjectChanged",l)},[s]),d?React__default.default.createElement("div",{onDrop:l=>{foundDropTarget=!0,l.preventDefault()},onDragOver:l=>{l.preventDefault()},onDragLeave:l=>{l.preventDefault()},style:{userSelect:"none",width:`${d.props.size.x+PADDING*2}px`,height:`${d.props.size.y+PADDING*2}px`,margin:PADDING+"px"}},React__default.default.createElement("div",{style:{width:"100%",height:"100%",overflow:"hidden"}},React__default.default.createElement(ElementTree,{nodeId:d.id}))):null};let wrapperEl,customStyleEl;const PADDING=0,render=a=>{const{containerEl:s,projectId:d,dragAndDrop:c=!1,dblClickShowcase:l=c,checkDragTarget:h=scenelessProjectDragCheck,checkDropTarget:p=scenelessProjectDropCheck}=a,y=getProject(d);CoreContext.clients.LayoutApi().subscribeToLayout(y.layoutApi.layoutId),loadDragImage();const _=a.onElementDoubleClick||l&&scenelessProjectDoubleClick(y);if(!s||!y)return;if(!s.shadowRoot){s.attachShadow({mode:"open"}),customStyleEl=document.createElement("style");const q=document.createElement("style");q.textContent=getStyle(),wrapperEl=document.createElement("div"),wrapperEl.id="compositor-root",Object.assign(wrapperEl.style,{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",transformOrigin:"center"}),s.shadowRoot.appendChild(q),s.shadowRoot.appendChild(customStyleEl),s.shadowRoot.appendChild(wrapperEl),new ResizeObserver(F=>{C()}).observe(s)}const E=y.compositor.getRoot(),{x:O,y:P}=E.props.size,C=()=>{let{width:q,height:U}=s.getBoundingClientRect();const F=q/U,j=O/P;let T;q&&U?j>F?T=q/(O+PADDING*2):T=U/(P+PADDING*2):T=1,wrapperEl.style.willChange="transform",wrapperEl.style.transform=`scale(${T}) translateZ(0)`,window.__scale=T,A()},A=()=>{ReactDOM__default.default.render(React__default.default.createElement(CompositorProvider,{project:y,interactive:c,onElementDoubleClick:_,checkIsDropTarget:p,checkIsDragTarget:h},React__default.default.createElement(Root,{setStyle:q=>{customStyleEl.textContent=q}})),wrapperEl)};C()},scenelessProjectDragCheck=a=>a.props.name==="Participant"||a.props.sourceType==="RoomParticipant",scenelessProjectDropCheck=a=>a.props.name==="Content",scenelessProjectDoubleClick=a=>s=>{var c;const d=a.compositor.nodes.find(l=>l.props.name==="Content");if(d){const l=(c=d.props.layoutProps)==null?void 0:c.showcase;CoreContext.Command.updateNode({nodeId:d.id,props:{layoutProps:{...d.props.layoutProps,showcase:l===s.id?null:s.id}}})}},CompositorContext=React__default.default.createContext({interactive:!1,project:null,checkIsDragTarget:()=>!1,checkIsDropTarget:()=>!1,onElementDoubleClick:()=>{}}),CompositorProvider=({children:a,...s})=>React__default.default.createElement(CompositorContext.Provider,{value:{...s}},a),getStyle=()=>`
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: 'Arial';
}

video {
  width: 100%;
  height: 100%;
  object-fit: contain;
}

.NameBanner {
  top: 100%;
  transform: translateY(-100%);
  left: 0;
  height: 30px;
  background: linear-gradient(90deg, rgba(0, 0, 0, 0.5) 50%, rgba(0, 0, 0, 0) 100%);
  padding: 0px 0px 0px 10px;
  color: rgba(255, 255, 255, 0.9);
  font-weight: bold;
  line-height: 30px;
  width: 100%;
  font-size: 28px;
  position: absolute;
}

ls-layout[layout="Presentation"][props*="\\"cover\\"\\:true"] > :first-child .NameBanner {
  top: 0% !important;
  transform: translateY(0%) !important;
}

.logo {
  position: absolute !important;
}

#compositor-root[data-dragging] {}

[data-drag-target] {}
[data-drag-target]:hover > .interactive-overlay {
  box-shadow: 0 0 0 3px inset rgba(255, 255, 255, 0.5);
  cursor: grab;
}
[data-drop-target] {}
[data-drop-target]:hover {}
[data-drag-target][data-drag-target-active] > .interactive-overlay {
  box-shadow: 0 0 0 3px inset rgba(255, 255, 255, 0.2);
}
[data-drag-target][data-drag-target-active] > .item-element {
  opacity: 0.8;
}
[data-layout-drop-target-active] > .interactive-overlay {
  box-shadow: 0 0 0 3px inset yellow;
}
[data-transform-drop-target-active] > .interactive-overlay {
  box-shadow: 0 0 0 3px inset white;
}
`;var LogoPosition=(a=>(a.TopLeft="top-left",a.TopRight="top-right",a.BottomLeft="bottom-left",a.BottomRight="bottom-right",a))(LogoPosition||{}),BannerStyle=(a=>(a.DEFAULT="default",a.MINIMAL="minimal",a.BUBBLE="bubble",a))(BannerStyle||{});const themes={["top-left"]:(a=1280/1920)=>{const s=d=>d*a+"px";return`
      .wrapper {
       margin-top:${s(40)} !important;
       margin-left:${s(40)} !important;
       top:0;
       left:0;
    }`},["top-right"]:(a=1280/1920)=>{const s=d=>d*a+"px";return`
      .wrapper {
       margin-top:${s(40)} !important;
       margin-right:${s(40)} !important;
       top:0;
       right:0;
    }`},["bottom-left"]:(a=1280/1920)=>{const s=d=>d*a+"px";return`
      .wrapper {
       margin-bottom:${s(40)} !important;
       margin-left:${s(40)} !important;
       bottom:0;
       left:0;
    }`},["bottom-right"]:(a=1280/1920)=>{const s=d=>d*a+"px";return`
      .wrapper {
       margin-bottom:${s(40)} !important;
       margin-right:${s(40)} !important;
       bottom:0;
       right:0;
    }`},default:(a="#ABABAB",s=!0,d=1280/1920)=>{const c=color(a).lightness()<.6?"#FFF":"#000",l=h=>h*d+"px";return`
      .Banner, .NameBanner {
        background: ${a} !important;
        margin-bottom: ${l(40)} !important;
        transition: 300ms ease all;
        left: 0;

        /* Default Size 4 */
        font-size: ${l(44)} !important;
        padding: ${l(40)} ${l(100)} !important;
        border-top-right-radius: ${l(20)} !important;
        border-bottom-right-radius: ${l(20)} !important;
      }
      .Banner-body, .NameBanner-body {
        color: ${c} !important;
        font-family: 'Roboto' !important;
        font-style: normal !important;
        font-weight: 700 !important;
        line-height: 120% !important;
      }
      .NameBanner {
        transform-origin: 0 100%;
        margin: 0 !important;
        transform: translateX(-100%);
        opacity: 0 !important;
        white-space: nowrap;
        ${s&&`
          opacity: 1 !important;
          transform: translateX(0);
        `}
      }

      .NameBanner[data-size="4"] {
        padding: ${l(40)} ${l(100)} !important;
        font-size: ${l(44)} !important;
        border-top-right-radius: ${l(20)} !important;
        border-bottom-right-radius: ${l(20)} !important;
      }
      .NameBanner[data-size="3"] {
        padding: ${l(12)} ${l(30)} !important;
        font-size: ${l(44)} !important;
        border-top-right-radius: ${l(20)} !important;
        border-bottom-right-radius: ${l(20)} !important;
      }
      .NameBanner[data-size="2"] {
        padding: ${l(12)} ${l(20)} !important;
        font-size: ${l(28)} !important;
        border-top-right-radius: ${l(16)} !important;
        border-bottom-right-radius: ${l(16)} !important;
      }
      .NameBanner[data-size="1"], .NameBanner[data-size="0"] {
        padding: ${l(8)} ${l(8)} !important;
        font-size: ${l(20)} !important;
        border-top-right-radius: ${l(8)} !important;
        border-bottom-right-radius: ${l(8)} !important;
      }
      .NameBanner[data-size="0"] {
        opacity: 0;
        transform: translateX(-100%);
      }
    `},minimal:(a="#ABABAB",s=!0,d=1280/1920)=>{const c="white",l=h=>h*d+"px";return`
    .Banner, .NameBanner {
        background: ${color(a).fade(color(a).alpha()*.7).toString()} !important;
        padding: ${l(40)} ${l(40)} ${l(40)} ${l(60)} !important;
        position: relative !important;
        margin-bottom: ${l(40)} !important;
        transition: 300ms ease all;
        font-size: ${l(34)} !important;
        left: 0;
      }
      .Banner:before, .NameBanner:before {
        z-index: 1;
        content: "";
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.6);
        transition: 300ms ease all;
        opacity: ${color(a).alpha()};
      }
      .Banner:after, .NameBanner:after {
        z-index: 1;
        content: "";
        position: absolute;
        left: 0;
        top: 0;
        height: 100%;
        transition: 300ms ease all;
        width: ${l(20)};
        background: ${color(a)};
        opacity: ${color(a).alpha()};
      }
      .Banner-body, .NameBanner-body {
        color: ${c} !important;
        font-family: 'Roboto' !important;
        font-style: normal !important;
        font-weight: 700 !important;
        line-height: 120% !important;
        position: relative;
        z-index: 2;
      }
      .Banner-header {
        position: relative;
        z-index: 2;
      }
      .NameBanner {
        transform-origin: 0 100%;
        margin: 0 !important;
        transform: translateX(-100%);
        opacity: 0 !important;
        white-space: nowrap;
        ${s&&`
          opacity: 1 !important;
          transform: translateX(0);
        `}
      }

      .NameBanner[data-size="4"] {
        padding: ${l(40)} ${l(40)} ${l(40)} ${l(40+20)} !important;
        font-size: ${l(34)} !important;
      }
      .NameBanner[data-size="3"] {
        padding: ${l(16)} ${l(40)} ${l(16)} ${l(40+20)} !important;
        font-size: ${l(34)} !important;
      }
      .NameBanner[data-size="2"] {
        padding: ${l(12)} ${l(24)} ${l(12)} ${l(24+20)} !important;
        font-size: ${l(24)} !important;
      }
      .NameBanner[data-size="1"], .NameBanner[data-size="0"] {
        padding: ${l(12)} ${l(16)} ${l(12)} ${l(16+20)} !important;
        font-size: ${l(18)} !important;
      }
      .NameBanner[data-size="0"] {
        opacity: 0 !important;
        transform: translateX(-100%);
      }
    `},bubble:(a="#ABABAB",s=!0,d=1280/1920)=>{const c=color(a).lightness()<.6?"#FFF":"#000",l=h=>h*d+"px";return`
      .Banner {
        transform: translateX(-50%);
        left: 50%;
        margin-bottom: ${l(40)} !important;
      }

      .Banner, .NameBanner {
        background: ${color(a)} !important;
        color: ${c} !important;
        border-radius: 500px !important;
        transition: 300ms ease all;

        /* Default Style */
        border: 4px solid ${c} !important;
        padding: ${l(40)} ${l(80)} !important;
        font-size: ${l(40)} !important;
      }
      .Banner-body, .NameBanner-body {
        color: ${c} !important;
        text-align: center !important;
        font-family: 'Roboto' !important;
        font-style: normal !important;
        font-weight: 700 !important;
        line-height: 120% !important;
      }
      .NameBanner {
        transform-origin: 0% 100%;
        transform: translateX(-100%);
        opacity: 0 !important;
        white-space: nowrap;
        ${s&&`
          opacity: 1 !important;
          transform: translateX(0);
        `}
      }

      .NameBanner[data-size="4"] {
        padding: ${l(40)} ${l(80)} ${l(40)} ${l(80)} !important;
        font-size: ${l(40)} !important;
      }
      .NameBanner[data-size="3"] {
        padding: ${l(12)} ${l(30)} ${l(12)} ${l(30)} !important;
        font-size: ${l(40)} !important;
        margin: -${l(20)} ${l(20)};
      }
      .NameBanner[data-size="2"] {
        padding: ${l(12)} ${l(30)} ${l(12)} ${l(30)} !important;
        font-size: ${l(26)} !important;
        margin: -${l(8)} ${l(8)};
      }
      .NameBanner[data-size="1"], .NameBanner[data-size="0"] {
        padding: ${l(8)} ${l(16)} ${l(8)} ${l(16)} !important;
        font-size: ${l(18)} !important;
        border-width: ${l(2)} !important;
        margin: -${l(16)} ${l(8)};
      }
      .NameBanner[data-size="0"] {
        opacity: 0 !important;
        transform: translateX(-100%);
      }
    `}};var compositor$1=Object.freeze(Object.defineProperty({__proto__:null,render,CompositorContext,LogoPosition,BannerStyle},Symbol.toStringTag,{value:"Module"}));const{state}=CoreContext,updateUserProps=async a=>{const s=getUser();if(!s)return;const d={...s.props,...a.props},c=await CoreContext.clients.LiveApi().collection.updateCollection({collectionId:s.id,updateMask:["metadata"],metadata:{...s.metadata,props:d}});await triggerInternal$1("UserChanged",c.collection)},createProject$1=async(a={})=>{const{props:s={},size:d,settings:c={}}=a,l=await CoreContext.Request.createProject({settings:c,props:s,size:d});await triggerInternal$1("ProjectAdded",l.project);const h=await hydrateProject(l.project,"ROLE_HOST");return toBaseProject(h)},deleteProject$1=async a=>{const{projectId:s}=a;await CoreContext.Request.deleteProject({projectId:s}),await triggerInternal$1("ProjectRemoved",{projectId:s})},updateProjectProps=async a=>{const{projectId:s}=a,d=getUser().id,c=getProject(s),l={...c.props,...a.props},h=await CoreContext.clients.LiveApi().project.updateProject({collectionId:d,projectId:s,updateMask:["metadata"],metadata:{...c.videoApi.project.metadata,props:l}});await triggerInternal$1("ProjectChanged",{project:h.project})},updateProjectMeta=a=>updateProjectProps({projectId:a.projectId,props:a.meta}),updateProjectPropsWithoutTrigger=async a=>{const{projectId:s}=a,d=getUser().id,c=getProject(s),l={...c.props,...a.props};await CoreContext.clients.LiveApi().project.updateProject({collectionId:d,projectId:s,updateMask:["metadata"],metadata:{...c.videoApi.project.metadata,props:l}})},setActiveProject=async a=>{const s=state.projects.find(c=>c.id===a.projectId);if(!s){state.activeProjectId=null,triggerInternal$1("ActiveProjectChanged",{projectId:null});return}const d=state.projects.find(c=>c.id===state.activeProjectId);if(s!==d)return d&&(Array.from(webrtcManager.rooms.keys()).map(webrtcManager.removeRoom),await CoreContext.clients.LayoutApi().unsubscribeFromLayout(d.layoutApi.layoutId),await CoreContext.clients.LiveApi().unsubscribeFromProject(d.videoApi.project.collectionId,d.videoApi.project.projectId)),await CoreContext.clients.LayoutApi().subscribeToLayout(s.layoutApi.layoutId),await CoreContext.clients.LiveApi().subscribeToProject(s.videoApi.project.collectionId,s.videoApi.project.projectId),CoreContext.clients.LiveApi().project.getProject({collectionId:s.videoApi.project.collectionId,projectId:s.videoApi.project.projectId,status:!0}).then(c=>{var l,h;triggerInternal$1("ProjectChanged",{project:c.project,phase:(l=c.status)==null?void 0:l.phase,broadcastId:(h=c.status)==null?void 0:h.broadcastId})}),triggerInternal$1("ActiveProjectChanged",{projectId:s.id}),toBaseProject(s)},joinRoom=async a=>{const{projectId:s,displayName:d="Guest"}=a,c=state.projects.find(P=>P.id===s);let l=c.sfuToken;if(!l){let{webrtcAccess:P}=await CoreContext.clients.LiveApi().authentication.createWebRtcAccessToken({collectionId:c.videoApi.project.collectionId,projectId:c.videoApi.project.projectId,displayName:d});l=P.accessToken}const p=o(l).video.room,y=new URL(CoreContext.clients.getLiveKitServer()),_=y.host+y.pathname,E=webrtcManager.ensureRoom(_,p,l);E.bindApiClient(CoreContext.clients),await E.connect(),c.sfuToken=l,c.roomId=p;const O=getRoom(p);return trigger$1("RoomJoined",{projectId:c.id,room:O}),O},createNode=async a=>{let{props:s={},parentId:d,index:c,projectId:l=state.activeProjectId}=a;const h=getProject(l);s={...s,layoutId:h.layoutApi.layoutId,type:"child"};const p=await h.compositor.insert(s,d,c);return triggerInternal$1("NodeAdded",{projectId:l,nodeId:p}),triggerInternal$1("NodeChanged",{projectId:l,nodeId:d}),h.compositor.get(p)},deleteNode=async a=>{var h;let{nodeId:s,projectId:d=state.activeProjectId}=a;const c=getProject(d),l=(h=c.compositor.getParent(s))==null?void 0:h.id;c.compositor.remove(s),triggerInternal$1("NodeRemoved",{projectId:d,nodeId:s}),triggerInternal$1("NodeChanged",{projectId:d,nodeId:l})},updateNode=async a=>{let{nodeId:s,props:d={},projectId:c=state.activeProjectId}=a;const l=getProject(c);return delete d.type,delete d.sourceType,l.compositor.update(s,d),triggerInternal$1("NodeChanged",{projectId:c,nodeId:s}),l.compositor.get(s)},setNodeLayout=async a=>{let{nodeId:s,layout:d,projectId:c=state.activeProjectId,layoutProps:l={}}=a;getProject(c).compositor.update(s,{layout:d,layoutProps:l}),triggerInternal$1("NodeChanged",{projectId:c,nodeId:s})},moveNode=async a=>{const{nodeId:s,parentId:d,projectId:c=state.activeProjectId,index:l}=a;getProject(c).compositor.move(s,d,l),triggerInternal$1("NodeChanged",{projectId:c,nodeId:s})},swapNodes=async a=>{var y,_;const{nodeAId:s,nodeBId:d,projectId:c=state.activeProjectId}=a,l=getProject(c),h=(y=l.compositor.getParent(s))==null?void 0:y.id,p=(_=l.compositor.getParent(d))==null?void 0:_.id;l.compositor.swap(s,d),triggerInternal$1("NodeChanged",{projectId:c,nodeId:h}),triggerInternal$1("NodeChanged",{projectId:c,nodeId:p})},reorderNodes=async a=>{const{parentId:s,childIds:d,projectId:c=state.activeProjectId}=a;getProject(c).compositor.reorder(s,d),triggerInternal$1("NodeChanged",{projectId:c,nodeId:s})},startBroadcast=async a=>{const{projectId:s=state.activeProjectId}=a,d=getProject(s);await CoreContext.clients.LiveApi().project.startProjectBroadcast({collectionId:d.videoApi.project.collectionId,projectId:d.videoApi.project.projectId})},stopBroadcast=async a=>{const{projectId:s=state.activeProjectId}=a,d=getProject(s);await CoreContext.clients.LiveApi().project.stopProjectBroadcast({collectionId:d.videoApi.project.collectionId,projectId:d.videoApi.project.projectId})},addDestination=async a=>{var O;const{rtmpUrl:s,rtmpKey:d,enabled:c,projectId:l=state.activeProjectId,metadata:h={},props:p={}}=a,y=getProject(l),_={rtmpPush:{key:d,url:s}},E=await((O=CoreContext.clients.LiveApi().destination)==null?void 0:O.createDestination({collectionId:y.videoApi.project.collectionId,projectId:y.videoApi.project.projectId,address:_,enabled:c,metadata:{props:{...h,...p}}}));return await triggerInternal$1("DestinationAdded",E.destination),toBaseDestination(E.destination)},removeDestination=async a=>{var l;const{destinationId:s,projectId:d=state.activeProjectId}=a,c=getProject(d);await((l=CoreContext.clients.LiveApi().destination)==null?void 0:l.deleteDestination({collectionId:c.videoApi.project.collectionId,projectId:c.videoApi.project.projectId,destinationId:s})),await triggerInternal$1("DestinationRemoved",{projectId:d,destinationId:s})},updateDestination=async a=>{var _;const{rtmpUrl:s,rtmpKey:d,destinationId:c,projectId:l=state.activeProjectId}=a,h=getProject(l),p={key:d,url:s},y=await((_=CoreContext.clients.LiveApi().destination)==null?void 0:_.updateDestination({collectionId:h.videoApi.project.collectionId,projectId:h.videoApi.project.projectId,destinationId:c,updateMask:["address.rtmpPush"],address:{rtmpPush:p}}));await triggerInternal$1("DestinationChanged",y.destination)},updateDestinationProps=async a=>{var y,_;const{projectId:s=state.activeProjectId,destinationId:d,props:c={}}=a,l=getProject(s),h=l.videoApi.project.destinations.find(E=>E.destinationId===d);if(!h)return;const p=await((_=CoreContext.clients.LiveApi().destination)==null?void 0:_.updateDestination({collectionId:l.videoApi.project.collectionId,projectId:l.videoApi.project.projectId,destinationId:d,updateMask:["metadata"],metadata:{...h.metadata||{},props:{...((y=h.metadata)==null?void 0:y.props)||{},...c}}}));await triggerInternal$1("DestinationChanged",p.destination)},updateDestinationMeta=a=>updateDestinationProps({projectId:a.projectId,destinationId:a.destinationId,props:a.metadata}),setDestinationEnabled=async a=>{var _;const{enabled:s,destinationId:d,projectId:c=state.activeProjectId}=a,l=getProject(c);if(l.videoApi.project.destinations.find(E=>d===E.destinationId).enabled===s)return;const p=await((_=CoreContext.clients.LiveApi().destination)==null?void 0:_.updateDestination({collectionId:l.videoApi.project.collectionId,projectId:l.videoApi.project.projectId,destinationId:d,updateMask:["enabled"],enabled:s}));await triggerInternal$1("DestinationChanged",p.destination),trigger$1(s?"DestinationEnabled":"DestinationDisabled",{projectId:c,destinationId:d})},setDestination=async a=>{var y,_;const{rtmpUrl:s,rtmpKey:d,projectId:c=state.activeProjectId}=a,l=getProject(c),h={key:d,url:s},p=!0;if(l.videoApi.project.destinations.length>0){const E=await((y=CoreContext.clients.LiveApi().destination)==null?void 0:y.updateDestination({collectionId:l.videoApi.project.collectionId,projectId:l.videoApi.project.projectId,destinationId:l.videoApi.project.destinations[0].destinationId,updateMask:["address.rtmpPush"],address:{rtmpPush:h}}));await triggerInternal$1("DestinationChanged",E.destination)}else{const E=await((_=CoreContext.clients.LiveApi().destination)==null?void 0:_.createDestination({collectionId:l.videoApi.project.collectionId,projectId:l.videoApi.project.projectId,address:{rtmpPush:h},enabled:p}));await triggerInternal$1("DestinationAdded",E.destination)}trigger$1("DestinationSet",{projectId:c,rtmpUrl:s,rtmpKey:d})};var commands$1=Object.freeze(Object.defineProperty({__proto__:null,updateUserProps,createProject:createProject$1,deleteProject:deleteProject$1,updateProjectProps,updateProjectMeta,updateProjectPropsWithoutTrigger,setActiveProject,joinRoom,createNode,deleteNode,updateNode,setNodeLayout,moveNode,swapNodes,reorderNodes,startBroadcast,stopBroadcast,addDestination,removeDestination,updateDestination,updateDestinationProps,updateDestinationMeta,setDestinationEnabled,setDestination},Symbol.toStringTag,{value:"Module"}));const useActiveProjectRoom$1=()=>{const[a,s]=React.useState(null);return React.useEffect(()=>useActiveProjectRoom(s),[]),a},useDevices=()=>{const[a,s]=React.useState({webcams:[],microphones:[],speakers:[]});return React.useEffect(()=>watchDevices(s),[]),a},StudioContext=React__default.default.createContext({studio:null,project:null,room:null,webcamId:null,microphoneId:null,setStudio:()=>{},setProject:()=>{},setRoom:()=>{},setWebcamId:()=>{},setMicrophoneId:()=>{},projectCommands:{}}),useStudio=()=>React.useContext(StudioContext);let stored={webcamId:null,microphoneId:null};try{stored.webcamId=localStorage==null?void 0:localStorage.getItem("__LS_webcam"),stored.microphoneId=localStorage==null?void 0:localStorage.getItem("__LS_microphone")}catch{}const StudioProvider=({children:a})=>{const[s,d]=React.useState(),[c,l]=React.useState(),[h,p]=React.useState(),[y,_]=React.useState(stored.webcamId),[E,O]=React.useState(stored.microphoneId),P=React.useMemo(()=>c?commands(c):null,[c]);return React.useEffect(()=>{},[c]),React.useEffect(()=>{!s||(y&&s.setCamera({deviceId:y}).catch(C=>{console.warn(C)}),E&&s.setMicrophone({deviceId:E}).catch(C=>{console.warn(C)}))},[s,y,E]),React__default.default.createElement(StudioContext.Provider,{value:{studio:h,project:c,room:s,webcamId:y,microphoneId:E,setStudio:p,setProject:l,setRoom:d,setWebcamId:C=>{try{localStorage==null||localStorage.setItem("__LS_webcam",C)}catch{}_(C)},setMicrophoneId:C=>{try{localStorage==null||localStorage.setItem("__LS_microphone",C)}catch{}O(C)},projectCommands:P}},a)};var react=Object.freeze(Object.defineProperty({__proto__:null,useActiveProjectRoom:useActiveProjectRoom$1,useDevices,StudioContext,useStudio,StudioProvider},Symbol.toStringTag,{value:"Module"}));const addingCache={camera:new Set,screen:new Set},commands=a=>{var J,ee,z,ne,X,M,K,te,L,G;const s=a.id,d=a.scene.getRoot(),{Command:c}=CoreContext,l=d.children.find(W=>W.props.id==="bg"),h=d.children.find(W=>W.props.id==="content"),p=d.children.find(W=>W.props.id==="foreground");let y=(J=l==null?void 0:l.children)==null?void 0:J.find(W=>W.props.id==="video-background"),_=(ee=l==null?void 0:l.children)==null?void 0:ee.find(W=>W.props.id==="bg-image"),E=(z=l==null?void 0:l.children)==null?void 0:z.find(W=>W.props.id==="image-background"),O=(ne=p==null?void 0:p.children)==null?void 0:ne.find(W=>W.props.id==="fg-image");(X=p==null?void 0:p.children)==null||X.find(W=>W.props.id==="image-overlay");let P=(M=p==null?void 0:p.children)==null?void 0:M.find(W=>W.props.id==="iframe-overlay"),C=(K=p==null?void 0:p.children)==null?void 0:K.find(W=>W.props.id==="video-overlay"),A=(te=p==null?void 0:p.children)==null?void 0:te.find(W=>W.props.id==="logo"),q=(L=p==null?void 0:p.children)==null?void 0:L.find(W=>W.props.id==="fg-video");const U=getProject(a.id);let F=(G=p==null?void 0:p.children)==null?void 0:G.find(W=>W.props.id==="fg-banners");const j=async()=>{const W=async()=>{var g;if(F)return F.id;{const w=await U.compositor.insert({name:"BannerContainer",id:"fg-banners",layout:"Column",layoutProps:{cover:!0}},p.id);return F=(g=p==null?void 0:p.children)==null?void 0:g.find(ae=>ae.props.id===w),w}},ie=async()=>{var g;if(O)return O.id;{const w=await U.compositor.insert({name:"ImageOverlay",id:"fg-image",layout:"Free"},p.id);return O=(g=p==null?void 0:p.children)==null?void 0:g.find(ae=>ae.props.id===w),w}},x=async()=>{var g;if(P)return P.id;{const w=await U.compositor.insert({name:"Overlay",sourceType:"Overlay",id:"overlay",layout:"Free",style:{width:"100%",height:"100%",objectFit:"cover"}},p.id);return P=(g=p==null?void 0:p.children)==null?void 0:g.find(ae=>ae.props.id===w),w}},Y=async()=>{var g;if(C)return C.id;{const w=await U.compositor.insert({name:"VideoOverlay2",sourceType:"Video2",proxySource:"Overlay",id:"video-overlay",layout:"Free",style:{width:"100%",height:"100%",objectFit:"cover"}},p.id);return C=(g=p==null?void 0:p.children)==null?void 0:g.find(ae=>ae.props.id===w),w}},oe=async()=>{var g;if(q)return q.id;{const w=await U.compositor.insert({name:"VideoOverlay",id:"fg-video",layout:"Free"},p.id);return q=(g=p==null?void 0:p.children)==null?void 0:g.find(ae=>ae.props.id===w),w}},fe=async()=>{var g;if(A)return A.id;{const w=await U.compositor.insert({name:"Logo",layout:"Free",sourceType:"Logo",id:"logo",style:{width:"160px",height:"90px",objectFit:"contain",position:"unset"}},p.id);return A=(g=p==null?void 0:p.children)==null?void 0:g.find(ae=>ae.props.id===w),w}},pe=async()=>{var g;if(_)return _.id;{const w=await U.compositor.insert({name:"ImageBackground",id:"bg-image",tagName:"img",sourceType:"Element",attributes:{src:""},fields:{style:{width:"100%",height:"100%",objectFit:"cover"}}},l.id);return _=(g=l==null?void 0:l.children)==null?void 0:g.find(ae=>ae.props.id===w),w}},me=async()=>{var g;if(E)return E.id;{const w=await U.compositor.insert({name:"ImageBackground2",sourceType:"Image2",proxySource:"Background",id:"image-background",layout:"Free",src:"",style:{width:"100%",height:"100%",objectFit:"cover"}},l.id);return E=(g=l==null?void 0:l.children)==null?void 0:g.find(ae=>ae.props.id===w),w}},v=async()=>{var g;if(y)return y.id;{const w=await U.compositor.insert({name:"VideoBackground",sourceType:"Video2",proxySource:"Background",id:"video-background",layout:"Free",style:{width:"100%",height:"100%",position:"absolute",objectFit:"cover"}},l.id);return y=(g=l==null?void 0:l.children)==null?void 0:g.find(ae=>ae.props.id===w),w}};try{const g=await Promise.all([W(),ie(),x(),oe(),Y(),fe()]);await U.compositor.reorder(p.id,g);const w=await Promise.all([pe(),me(),v()]);await U.compositor.reorder(l.id,w)}catch{}},T={getBackground(){return l},getContent(){return h},getForeground(){return p},getLayout(){return h.props.layout},getBanners(){var W;return((W=getProject(a.id).props)==null?void 0:W.banners)||[]},getOverlays(){return getProject(a.id).props.overlays||[]},getParticipants(){return h.children.filter(W=>W.props.sourceType==="RoomParticipant")},getLogo(){var W;return(W=T.getProp("logo"))==null?void 0:W.id},removeLogo(){return T.setProp("logo",null)},getImageOverlay(){var ie,x;const W=(x=(ie=O==null?void 0:O.children)==null?void 0:ie.map(Y=>{var oe,fe;return(fe=(oe=Y==null?void 0:Y.props)==null?void 0:oe.sourceProps)==null?void 0:fe.id}))!=null?x:[];return W.length>1?W:W[0]},getVideoOverlay(){var ie,x;const W=(x=(ie=q==null?void 0:q.children)==null?void 0:ie.map(Y=>{var oe,fe;return(fe=(oe=Y==null?void 0:Y.props)==null?void 0:oe.sourceProps)==null?void 0:fe.id}))!=null?x:[];return W.length>1?W:W[0]},autoPlayBackgroundVideo(W={muted:!0,autoplay:!0}){const ie=l.children.find(x=>x.props.id==="bg-video");!ie||CoreContext.Command.updateNode({nodeId:ie.id,props:{...ie.props,attributes:{...ie.props.attributes,...W}}})},autoPlayVideoOverlay(W,ie={muted:!0,autoplay:!0}){var Y;const x=(Y=q==null?void 0:q.children)==null?void 0:Y.find(oe=>{var fe,pe;return((pe=(fe=oe.props)==null?void 0:fe.sourceProps)==null?void 0:pe.id)===W});!x||x.props.sourceProps.type==="video"&&CoreContext.Command.updateNode({nodeId:x.id,props:{...x.props,attributes:{...x.props.attributes,...ie}}})},async removeImageOverlay(W){const ie=O.children.find(x=>{var Y,oe;return((oe=(Y=x.props)==null?void 0:Y.sourceProps)==null?void 0:oe.id)===W});ie&&CoreContext.Command.deleteNode({nodeId:ie.id})},async removeVideoOverlay(W){var Y;const ie=(Y=q==null?void 0:q.children)==null?void 0:Y.find(oe=>{var fe,pe;return((pe=(fe=oe.props)==null?void 0:fe.sourceProps)==null?void 0:pe.id)===W});ie&&CoreContext.Command.deleteNode({nodeId:ie.id}),p.children.filter(oe=>oe.props.id!=="fg-video").forEach(oe=>{oe.children.forEach(fe=>{var pe,me,v;((v=(me=(pe=fe.props)==null?void 0:pe.fields)==null?void 0:me.style)==null?void 0:v.opacity)===0&&(fe.props.fields.style.opacity=1,CoreContext.Command.updateNode({nodeId:fe.id,props:{...fe.props}}))})})},async addImageOverlay(W,ie){var fe,pe,me;const x=O.children.find(v=>v.props.id==="img-overlay");if(x&&((pe=(fe=x==null?void 0:x.props)==null?void 0:fe.sourceProps)==null?void 0:pe.id)===W)return;let Y={id:"img-overlay",sourceType:"Element",sourceProps:{type:"image",id:W},tagName:"img",attributes:{src:ie},fields:{style:{transition:"opacity 300ms ease 0ms, transform, width, height","-webkit-transition":"opacity 300ms ease 0ms, transform, width, height",opacity:1,objectFit:"cover"}}};((me=q==null?void 0:q.children)==null?void 0:me.find(v=>v.props.id==="vid-overlay"))&&(Y.fields.style.opacity=0),x?CoreContext.Command.updateNode({nodeId:x.id,props:{...x.props,...Y}}):await CoreContext.Command.createNode({props:Y,parentId:O.id,index:O.children.length})},async addVideoOverlay(W,ie,x={playsinline:!0,disablepictureinpicture:!0,autoplay:!0}){var pe,me,v;const Y=(pe=q==null?void 0:q.children)==null?void 0:pe.find(g=>g.props.id==="vid-overlay");if(Y&&((v=(me=Y==null?void 0:Y.props)==null?void 0:me.sourceProps)==null?void 0:v.id)===W)return;let oe={id:"vid-overlay",sourceType:"LS-Video",sourceProps:{type:"video",id:W},tagName:"video",attributes:{...x,src:ie,id:W}};p.children.filter(g=>g.props.id!=="fg-video").forEach(g=>{g.children.forEach(w=>{var ae,I,$;(($=(I=(ae=w.props)==null?void 0:ae.fields)==null?void 0:I.style)==null?void 0:$.opacity)===1&&(w.props.fields.style.opacity=0,CoreContext.Command.updateNode({nodeId:w.id,props:{...w.props}}))})}),Y?CoreContext.Command.updateNode({nodeId:Y.id,props:{...Y.props,...oe}}):await CoreContext.Command.createNode({props:oe,parentId:q.id,index:q.children.length})},getBackgroundMedia(){var ie,x,Y;return(Y=(x=(ie=l.children.filter(oe=>oe)[0])==null?void 0:ie.props)==null?void 0:x.attributes)==null?void 0:Y.src},getBackgroundImage(){var ie,x,Y;return(Y=(x=(ie=l.children.filter(oe=>oe.props.id==="bg-image")[0])==null?void 0:ie.props)==null?void 0:x.attributes)==null?void 0:Y.src},getBackgroundVideo(){var ie,x,Y;return(Y=(x=(ie=l.children.filter(oe=>oe.props.id==="bg-video")[0])==null?void 0:ie.props)==null?void 0:x.attributes)==null?void 0:Y.src},async setBackgroundImage(W){var Y,oe;const ie=l.children.find(fe=>fe.props.id==="bg-image");if(ie&&((oe=(Y=ie==null?void 0:ie.props)==null?void 0:Y.attributes)==null?void 0:oe.src)===W)return;const x=l.children.find(fe=>fe.props.id==="bg-video");x&&CoreContext.Command.deleteNode({nodeId:x.id}),ie?CoreContext.Command.updateNode({nodeId:ie.id,props:{attributes:{...ie.props.attributes,src:W}}}):await CoreContext.Command.createNode({props:{name:"ImageBackground",id:"bg-image",tagName:"img",sourceType:"Element",attributes:{src:W},fields:{style:{width:"100%",height:"100%",objectFit:"cover"}}},parentId:l.id,index:l.children.length})},async setBackgroundVideo(W,ie={loop:!0,autoplay:!0}){var oe,fe;const x=l.children.find(pe=>pe.props.id==="bg-video");if(x&&((fe=(oe=x==null?void 0:x.props)==null?void 0:oe.attributes)==null?void 0:fe.src)===W)return;const Y=l.children.find(pe=>pe.props.id==="bg-image");Y&&CoreContext.Command.deleteNode({nodeId:Y.id}),x?CoreContext.Command.updateNode({nodeId:x.id,props:{attributes:{...x.props.attributes,...ie,src:W}}}):await CoreContext.Command.createNode({props:{name:"VideoBackground",id:"bg-video",sourceType:"LS-Video",attributes:{...ie,src:W},fields:{style:{width:"100%",height:"100%",objectFit:"cover"}}},parentId:l.id,index:l.children.length})},addLogo(W,ie){const x=getProject(a.id).props.logo||null;if(x&&x.id===W)return c.updateProjectProps({projectId:s,props:{logo:x}});const Y=ie.meta||{},oe={id:W,props:{...ie,type:"logo",meta:Y}};c.updateProjectProps({projectId:s,props:{logo:oe}})},addBanner(W={}){var oe;const ie=W.meta||{},x={id:generateId(),props:{...W,meta:ie}},Y=((oe=getProject(s).props)==null?void 0:oe.banners)||[];return c.updateProjectProps({projectId:s,props:{banners:[...Y,x]}})},editBanner(W,ie={}){const Y=T.getBanners().map(oe=>oe.id!==W?oe:{...oe,props:ie});return c.updateProjectProps({projectId:s,props:{banners:Y}})},removeBanner(W){var x;const ie=T.getBanners();return(x=F==null?void 0:F.children)==null||x.forEach(Y=>{Y.props.bannerId===W&&CoreContext.Command.deleteNode({nodeId:Y.id})}),c.updateProjectProps({projectId:s,props:{banners:ie.filter(Y=>Y.id!==W)}})},setActiveBanner(W){T.getBanners();const[ie,...x]=(F==null?void 0:F.children)||[];if(x.forEach(Y=>{CoreContext.Command.deleteNode({nodeId:Y.id})}),ie)CoreContext.Command.updateNode({nodeId:ie.id,props:{bannerId:W}});else return CoreContext.Command.createNode({parentId:F==null?void 0:F.id,props:{sourceType:"Banner",bannerId:W}})},getActiveBanner(){var W,ie,x,Y;return(Y=(x=(ie=(W=F.children)==null?void 0:W[0])==null?void 0:ie.props)==null?void 0:x.bannerId)!=null?Y:null},getImageOverlay2(){const ie=CoreContext.compositor.getSources("Overlay").filter(x=>{var Y,oe;return((oe=(Y=x.props)==null?void 0:Y.meta)==null?void 0:oe.type)==="image-overlay"}).map(x=>x==null?void 0:x.id);return ie.length>1?ie:ie[0]},getVideoOverlay2(){const ie=CoreContext.compositor.getSources("Overlay").filter(x=>x.props.type==="video-overlay").map(x=>x==null?void 0:x.id);return ie.length>1?ie:ie[0]},getCustomOverlay(){const ie=CoreContext.compositor.getSources("Overlay").filter(x=>{var Y,oe;return((oe=(Y=x.props)==null?void 0:Y.meta)==null?void 0:oe.type)==="html-overlay"}).map(x=>x==null?void 0:x.id);return ie.length>1?ie:ie[0]},async removeCustomOverlay(W){const ie=T.getOverlays();return c.updateProjectProps({projectId:s,props:{overlays:ie.filter(x=>x.id!==W)}})},async removeImageOverlay2(W){const ie=T.getOverlays();return c.updateProjectProps({projectId:s,props:{overlays:ie.filter(x=>x.id!==W)}})},async removeVideoOverlay2(W){const oe=T.getOverlays().filter(fe=>fe.id!==W).filter(fe=>fe.props.type!=="video-overlay").map(fe=>({...fe,props:{...fe.props,meta:{...fe.props.meta,style:{opacity:1}}}}));c.updateProjectProps({projectId:s,props:{overlays:oe}})},async addCustomOverlay(W,ie={}){const x=T.getOverlays(),Y=x.find(v=>v.id===W);if(Y){const v=x.findIndex(g=>g.id===W);if(v>-1){const g=JSON.parse(JSON.stringify(x));return g.splice(v,1,Y),c.updateProjectProps({projectId:s,props:{overlays:g}})}}const oe=x.find(v=>v.props.type==="video-overlay"),fe=ie.meta||{type:"html-overlay"},pe={id:W,props:{...ie,type:"overlay",meta:{...fe,...oe&&{style:{opacity:0}}}}},me=x.filter(v=>v.props.type!=="overlay");c.updateProjectProps({projectId:s,props:{overlays:[...me,pe]}})},async addImageOverlay2(W,ie={}){const x=T.getOverlays(),Y=x.find(v=>v.id===W);if(Y){const v=x.findIndex(g=>g.id===W);if(v>-1){const g=JSON.parse(JSON.stringify(x));return g.splice(v,1,Y),c.updateProjectProps({projectId:s,props:{overlays:g}})}}const oe=x.find(v=>v.props.type==="video-overlay"),fe=ie.meta||{type:"image-overlay"},pe={id:W,props:{...ie,type:"overlay",meta:{...fe,...oe&&{style:{opacity:0}}}}},me=x.filter(v=>v.props.type!=="overlay");c.updateProjectProps({projectId:s,props:{overlays:[...me,pe]}})},async addVideoOverlay2(W,ie={}){const x=T.getOverlays(),Y=x.find(v=>v.id===W);if(Y){const v=x.findIndex(g=>g.id===W);if(v>-1){const g=JSON.parse(JSON.stringify(x));return g.splice(v,1,Y),c.updateProjectProps({projectId:s,props:{overlays:g}})}}const oe=x==null?void 0:x.filter(v=>v.props.type!=="video-overlay"),fe=oe==null?void 0:oe.map(v=>({...v,props:{...v.props,meta:{...v.props.meta,style:{opacity:0}}}})),pe=ie.meta||{},me={id:W,props:{...ie,type:"video-overlay",meta:pe}};c.updateProjectProps({projectId:s,props:{overlays:[...fe,me]}})},setLayout(W,ie={}){const x=h.props.layoutProps.showcase;c.setNodeLayout({nodeId:h.id,layout:W,layoutProps:{showcase:x,...ie}})},getBackgroundMedia2(W){const ie=CoreContext.compositor.getSources("Background");return(W?ie.filter(Y=>Y.props.type===W).map(Y=>Y.id):ie.map(Y=>Y.id))[0]},getBackgroundImage2(){return T.getBackgroundMedia2("image-background")},getBackgroundVideo2(){return T.getBackgroundMedia2("video-background")},async setBackgroundImage2(W,ie={}){const x=getProject(a.id).props.background||null;if(x&&x.id===W)return c.updateProjectProps({projectId:s,props:{background:x}});const Y=ie.meta||{},oe={id:W,props:{...ie,type:"image-background",meta:Y}};c.updateProjectProps({projectId:s,props:{background:oe}})},async setBackgroundVideo2(W,ie={}){const x=getProject(a.id).props.background||null;if(x&&x.id===W)return c.updateProjectProps({projectId:s,props:{background:x}});const Y=ie.meta||{},oe={id:W,props:{...ie,type:"video-background",meta:Y}};c.updateProjectProps({projectId:s,props:{background:oe}})},setShowcase(W,ie="camera"){var Y;const x=T.getParticipantNode(W,ie);return CoreContext.Command.updateNode({nodeId:h.id,props:{layoutProps:{...h.props.layoutProps,showcase:(Y=x==null?void 0:x.id)!=null?Y:null}}})},useShowcase(W){const ie=()=>{const x=h.props.layoutProps.showcase,Y=h.children.find(fe=>fe.id===x);if(!Y)return W({participantId:null,type:null});const{sourceProps:oe}=Y.props;return W({participantId:oe.id,type:oe.type})};return ie(),CoreContext.onInternal("NodeChanged",x=>{x.nodeId===h.id&&ie()})},async addParticipant(W,ie={},x="camera"){if(addingCache[x].has(W))return;const{isMuted:Y=!1,isHidden:oe=!1,volume:fe=1}=ie;if(h.children.find(g=>{var w,ae;return((w=g.props.sourceProps)==null?void 0:w.id)===W&&((ae=g.props.sourceProps)==null?void 0:ae.type)===x}))return;addingCache[x].add(W);const me=h.children[0];let v=h.children.length;x==="screen"&&(me==null?void 0:me.props.sourceProps.type)!=="screen"&&(v=0),await CoreContext.Command.createNode({props:{name:"Participant",sourceType:"RoomParticipant",sourceProps:{type:x,id:W},volume:fe,isMuted:Y,isHidden:oe},parentId:h.id,index:v}).finally(()=>{addingCache[x].delete(W)})},addParticipantScreenshare(W,ie={}){return T.addParticipant(W,ie,"screen")},removeParticipant(W,ie="camera"){h.children.filter(x=>{var Y,oe;return((Y=x.props.sourceProps)==null?void 0:Y.id)===W&&((oe=x.props.sourceProps)==null?void 0:oe.type)===ie&&x.props.sourceType==="RoomParticipant"}).forEach(x=>{CoreContext.Command.deleteNode({nodeId:x.id})})},removeParticipantScreenshare(W){return T.removeParticipant(W,"screen")},getParticipantNode(W,ie="camera"){return h.children.find(x=>{var Y,oe;return((Y=x.props.sourceProps)==null?void 0:Y.id)===W&&((oe=x.props.sourceProps)==null?void 0:oe.type)===ie})},getParticipantState(W,ie="camera"){var x;return(x=T.getParticipantNode(W,ie))==null?void 0:x.props},useParticipantState(W,ie,x="camera"){let Y=T.getParticipantNode(W,x);const oe=()=>{ie(Y==null?void 0:Y.props)},fe=CoreContext.onInternal("NodeChanged",me=>{if(me.nodeId!==h.id)return;const v=Y;Y=T.getParticipantNode(W,x),v!==Y&&oe()}),pe=CoreContext.onInternal("NodeChanged",me=>{!Y||me.nodeId!==Y.id||oe()});return oe(),()=>{fe(),pe()}},setParticipantVolume(W,ie){const x=T.getParticipantNode(W);!x||CoreContext.Command.updateNode({nodeId:x.id,props:{volume:ie}})},setParticipantMuted(W,ie){const x=T.getParticipantNode(W);!x||CoreContext.Command.updateNode({nodeId:x.id,props:{isMuted:ie}})},setParticipantHidden(W,ie){const x=T.getParticipantNode(W);!x||CoreContext.Command.updateNode({nodeId:x.id,props:{isHidden:ie}})},pruneParticipants(){const W=getProjectRoom(s);!W||h.children.filter(ie=>{var pe,me;if(ie.props.sourceType!=="RoomParticipant")return!1;const x=(pe=ie.props.sourceProps)==null?void 0:pe.type,Y=W.getParticipant((me=ie.props.sourceProps)==null?void 0:me.id);return Y?x==="camera"?!1:!Y.trackIds.map(v=>W.getTrack(v)).filter(Boolean).some(v=>(v.type===dist$1.Track.Source.Camera||v.type===dist$1.Track.Source.Microphone?"camera":"screen")===x):!0}).forEach(ie=>{CoreContext.Command.deleteNode({nodeId:ie.id})})},getProp(W){return getProject(a.id).props[W]},setProp(W,ie){return c.updateProjectProps({projectId:s,props:{[W]:ie}})},useProp(W,ie){return CoreContext.on("ProjectChanged",x=>{s===x.project.id&&ie(x.project.props[W])})}};return(async()=>{await j(),beforeInit(T)})(),T},create=async(a={},s={},d)=>CoreContext.Command.createProject({settings:a,props:s,size:d}),beforeInit=a=>{const s=a.getVideoOverlay();s&&a.autoPlayVideoOverlay(s,{muted:!0,autoplay:!0}),a.getBackgroundVideo()&&a.autoPlayBackgroundVideo({muted:!0,autoplay:!0})},createCompositor=async(a,s,d)=>{const{backgroundImage:c,layout:l,layoutProps:h={}}=d,p=await CoreContext.compositor.createProject({props:{name:"Root",type:"sceneless-project",sourceType:"Element",layout:"Layered",size:s,isRoot:!0,tagName:"div",fields:{style:{background:"black"}}}},a),y=p.getRoot(),_=await Promise.all([p.insert({name:"Background",id:"bg",layout:"Free"},y.id),p.insert({id:"content",name:"Content",layout:l,layoutProps:h},y.id),p.insert({id:"foreground",name:"Overlays",layout:"Free"},y.id)]);await p.reorder(y.id,_);const E=y.children.find(A=>A.props.id==="foreground"),O=await Promise.all([p.insert({name:"ImageOverlay",id:"fg-image",layout:"Free"},E.id),p.insert({name:"Overlay",sourceType:"Overlay",id:"overlay",layout:"Free",style:{width:"100%",height:"100%",objectFit:"cover"}},E.id),p.insert({name:"BannerContainer",id:"fg-banners",layout:"Column",layoutProps:{cover:!0}},E.id),p.insert({name:"VideoOverlay",id:"fg-video",layout:"Free"},E.id),p.insert({name:"VideoOverlay2",layout:"Free",sourceType:"Video2",proxySource:"Overlay",id:"video-overlay",style:{width:"100%",height:"100%",objectFit:"cover"}},E.id),p.insert({name:"Logo",layout:"Free",sourceType:"Logo",id:"logo",style:{width:"160px",height:"90px",objectFit:"contain",position:"unset"}},E.id)]);await p.reorder(E.id,O);const P=y.children.find(A=>A.props.id==="bg"),C=await Promise.all([p.insert({name:"ImageBackground",id:"bg-image",tagName:"img",sourceType:"Element",attributes:{src:c},fields:{style:{width:"100%",height:"100%",objectFit:"cover"}}},P.id),p.insert({name:"ImageBackground2",sourceType:"Image2",proxySource:"Background",id:"image-background",layout:"Free",src:c,style:{width:"100%",height:"100%",objectFit:"cover"}},P.id),p.insert({name:"VideoBackground",sourceType:"Video2",proxySource:"Background",id:"video-background",layout:"Free",style:{width:"100%",height:"100%",objectFit:"cover"}},P.id)]);return await p.reorder(P.id,C),p};var scenelessProject=Object.freeze(Object.defineProperty({__proto__:null,commands,create,beforeInit,createCompositor},Symbol.toStringTag,{value:"Module"}));const useActiveProjectRoom=a=>{const s=getProject(CoreContext.state.activeProjectId);return a(s?getRoom(s.roomId):null),CoreContext.on("RoomJoined",()=>{const d=getProject(CoreContext.state.activeProjectId);a(d?getRoom(d.roomId):null)})};var callbacks=Object.freeze(Object.defineProperty({__proto__:null,useActiveProjectRoom},Symbol.toStringTag,{value:"Module"})),index$1=Object.freeze(Object.defineProperty({__proto__:null,React:react,ScenelessProject:scenelessProject,Callback:callbacks,Room:webrtc,Compositor:compositor$1},Symbol.toStringTag,{value:"Module"}));const runFilters=(a,s=[])=>s.reduce((d,c)=>c(d),a);var transforms=Object.freeze(Object.defineProperty({__proto__:null,runFilters},Symbol.toStringTag,{value:"Module"}));const createDefault=()=>({root:document.createElement("div")}),init$2=(a={},s,d)=>{const c={},l=a.defaultTransforms||{},h=F=>{asArray(F).forEach(j=>{c[j.name]=j})},p={},y={},_={},E=F=>_[F]||[],O=F=>y[F]||[],P=F=>p[F],C=F=>c[F];s.on("SourceChanged",F=>{O(F.id).forEach(T=>{const D=s.getNode(T.nodeId);T._onUpdateHandlers.forEach(J=>J(D.props||{}))})}),s.on("AvailableSourcesChanged",({type:F,sources:j})=>{E(F).forEach(D=>{A(D.nodeId)})});const A=F=>{var M,K,te;const j=P(F);if(!j)return;const T=C(j.transformName);if(!T.useSource)return;const D=s.getNode(F),J=j.proxySource?j.proxySource:j.sourceType,ee=d.getSources(J),z=T.useSource(ee,D.props),ne=j.sourceValue,X=z==null?void 0:z.value;j.source!==z&&(y[(M=j.source)==null?void 0:M.id]&&(y[(K=j.source)==null?void 0:K.id]=y[(te=j.source)==null?void 0:te.id].filter(L=>L.nodeId!==F)),y[z==null?void 0:z.id]=[...y[z==null?void 0:z.id]||[],j]),j.source=z,j.sourceValue=X,Object.is(ne,X)||j._onNewSourceHandlers.forEach(L=>L(z))},q=F=>{const j=U(F),D=runFilters(F,[]);return A(F.id),j==null||j._onUpdateHandlers.forEach(J=>J(F.props||{})),{...D,children:D.children.map(q)}},U=F=>{if(p[F.id])return p[F.id];const{props:j={}}=F,{sourceType:T,proxySource:D}=j;if(!T)return null;let J=l[T],ee;if(J?ee=c[J]:ee=Object.values(c).find(W=>W.sourceType===T),!ee)throw new Error("Could not find matching transform for sourceType: "+T);const z=[],ne=[],X=[],M=[],te={...(ee.create||createDefault)({onEvent:(W,ie,...x)=>{const Y=s.on(W,ie,...x);return M.push(Y),Y},onNewSource:W=>z.push(W),onUpdate:W=>ne.push(W),onRemove:W=>X.push(W)},F.props),proxySource:D,sourceType:T,nodeId:F.id,transformName:ee.name,_onNewSourceHandlers:z,_onUpdateHandlers:ne,_disposables:M};p[F.id]=te;const L=D||T;_[L]=[..._[L]||[],te],ee.useSource&&A(F.id);const G=[s.on("NodeRemoved",({nodeId:W})=>{if(W===F.id){const ie=s.getNode(W),{sourceType:x="Element"}=ie.props;G.forEach(oe=>oe==null?void 0:oe()),M.forEach(oe=>oe==null?void 0:oe()),X.forEach(oe=>oe==null?void 0:oe()),delete p[ie.id];const Y=D||x;_[Y]=_[Y].filter(oe=>oe!==p[ie.id])}})];return te};return{transforms:c,nodeElementIndex:p,elementSourceTypeIndex:_,registerTransform:h,getElementsBySourceType:E,getElementByNodeId:P,getTransformByName:C,updateSourceForNode:A,renderTree:q,getElement:U}},TRANSITION_DURATION=300,findLayoutUp=(a,s,d=0)=>{const l=a.parentElement;return l instanceof Layout&&(d=0,!s||s(l))?l:l?d>4?null:findLayoutUp(l,s,d+1):null},TRANSITION_FIELDS="opacity, transform, width, height, left, right, top, bottom, inset",layoutIndex={},parentIdIndex={},childIndex={};let rootLayout,_cid=1;const ignoredAttributes=["style","id","className"];let tickOps={};const tick=()=>{if(nextTick=null,window.__dragging){nextTick=nextTick||requestAnimationFrame(tick);return}const a=new Set,s=new Set,d=new Set;Object.entries(tickOps).forEach(([c,l])=>{l.forEach(([h,p,y])=>{switch(h){case"childInserted":{s.has(y)?s.delete(y):a.add(y);break}case"childRemoved":{a.has(y)?a.delete(y):s.add(y);break}case"childRemoveFinished":{d.add(y);break}}})});try{s.forEach(l=>{var y,_,E;const h=childIndex[l],p=Array.from(((y=h.parentEl)==null?void 0:y.children)||[]);h.nextSiblingEl&&p.includes(h.nextSiblingEl)?(_=h.parentEl)==null||_.insertBefore(h,h.nextSiblingEl):(h.nextSiblingEl=null,(E=h.parentEl)==null||E.append(h)),h.runRemove()}),d.forEach(l=>{const h=childIndex[l];if(h.removed){h.previousSiblingEl&&(h.previousSiblingEl.nextSiblingEl=h.nextSiblingEl),h.nextSiblingEl&&(h.nextSiblingEl.previousSiblingEl=h.previousSiblingEl);return}});const c=window.__scale;Object.entries(tickOps).forEach(([l,h])=>{const p=layoutIndex[l],y=p.getBoundingClientRect(),_={x:y.width/c,y:y.height/c};p.updatePositions({size:_,inserted:a,removed:s})})}catch(c){log$1.warn("Failed to run Layout ops",c)}tickOps={}};let nextTick;const queueOp=a=>{const[s,d]=a,c=tickOps[d]||[];tickOps[d]=[...c,a],nextTick=nextTick||requestAnimationFrame(tick)};class Layout extends HTMLElement{constructor(){super(),this.isFirst=!0,this.isUpdating=!1,this.cid=++_cid}log(...s){var d;log$1.debug(...s,{id:this.dataset.id,parent:(d=this.parentLayout)==null?void 0:d.dataset.id},this)}connectedCallback(){var s;this.parentEl=this.parentElement,this.parentLayout=findLayoutUp(this),this.slotEl=this.closest("[data-layout-child]"),Array.from(this.children).forEach(d=>this.initializeChild(d)),rootLayout||(rootLayout=this),layoutIndex[this.dataset.id]=this,parentIdIndex[this.dataset.id]=(s=this.parentLayout)==null?void 0:s.id,Object.assign(this.style,{width:"100%",height:"100%",position:"absolute",top:"0px",left:"0px",pointerEvents:"none",boxSizing:"border-box"}),this.mutationObserver&&this.mutationObserver.disconnect(),this.mutationObserver=new MutationObserver(d=>{!this.isConnected||d.forEach(c=>{c.type==="attributes"&&!ignoredAttributes.includes(c.attributeName)?queueOp(["attributesChanged",this.dataset.id]):c.type==="childList"&&(c.addedNodes.forEach(l=>{const h=childIndex[l.dataset.id];l.removed||(h?h!==l&&(this.initializeChild(l),l.setAttribute("style",h.getAttribute("style")),l.data=h.data):this.initializeChild(l),queueOp(["childInserted",this.dataset.id,l.dataset.id]))}),c.removedNodes.forEach(l=>{l.removed||queueOp(["childRemoved",this.dataset.id,l.dataset.id])}))})}),this.mutationObserver.observe(this,{childList:!0,attributes:!0}),this.latestSize||queueOp(["attributesChanged",this.dataset.id])}disconnectedCallback(){}adoptedCallback(){}updatePositions(s){if(this.isUpdating)return;this.isUpdating=!0;const{size:d,inserted:c=new Set,removed:l=new Set}=s;this.nodes=Array.from(this.children||[]).filter(_=>!_.removed).map((_,E)=>{const O=getElementAttributes(_);return{id:_.dataset.id,props:O,children:[]}});const h=JSON.parse(this.getAttribute("props")||"{}");this.latestSize=d;const p={id:this.dataset.id,props:h,children:this.nodes,size:d};let y=layoutChildren(p);Promise.all(Object.entries(y).map(async([_,E])=>{var D,J,ee,z,ne,X,M,K,te,L,G;let O=childIndex[_]||this.querySelector(`[data-layout-child][data-id="${_}"]`);const P={...O.data,...E};O.data=P;const{size:C,position:A,zIndex:q=1,opacity:U=1,borderRadius:F=0,entryTransition:j={},exitTransition:T={}}=P;if(O){if(O.removed)return;T&&(O.data.exitTransition=T),j&&(O.data.entryTransition=j),O.data.size=C,O.data.position=A;const W=window.__scale,ie=this.getBoundingClientRect(),x=ie.width/W,Y=x-sizeToNum(A.x,x)-sizeToNum(C.x,x),oe=ie.height/W,fe=oe-sizeToNum(A.y,oe)-sizeToNum(C.y,oe);Object.assign(O.style,{position:"absolute",transformOrigin:"50% 50%",transitionDuration:"0ms",transitionDelay:"0ms",transform:"translate3d(0, 0, 0) scaleX(1) scaleY(1)",visibility:"visible",boxSizing:"border-box",overflow:"hidden",borderRadius:F+"px",width:"auto",height:"auto"});let pe="0ms",me=this.isFirst?asDuration(0):asDuration(TRANSITION_DURATION);if(c.has(_))Object.assign(O.style,{transitionProperty:TRANSITION_FIELDS,transitionDuration:"0ms",transitionTimingFunction:(D=j.timingFn)!=null?D:"ease",transform:`translate3d(calc(${asSize((ee=(J=j.offset)==null?void 0:J.x)!=null?ee:0)}), calc(${asSize((ne=(z=j.offset)==null?void 0:z.y)!=null?ne:0)}), 0) scaleX(${(M=(X=j.scale)==null?void 0:X.x)!=null?M:1}) scaleY(${(te=(K=j.scale)==null?void 0:K.y)!=null?te:1})`,opacity:(L=j.opacity)!=null?L:U,left:asSize(A.x)||0,right:asSize(Y)||0,top:asSize(A.y)||0,bottom:asSize(fe)||0}),pe=asDuration((G=j.delay)!=null?G:0);else if(O.data.rootOffset){const w=rootLayout.getBoundingClientRect(),ae=this.getBoundingClientRect(),I={x:ae.x/W-w.x/W,y:ae.y/W-w.y/W},$=I.x+ae.width/W,Z=O.data.rootOffset.x+Number(O.data.size.x),le=I.y+ae.height/W,de=O.data.rootOffset.y+Number(O.data.size.y);O.data.rootOffset.x-I.x,O.data.rootOffset.y-I.y,$-Z,le-de}O.addEventListener("transitionstart",()=>{O.style.zIndex=String(q+1)}),await new Promise(w=>window.setTimeout(w)),Object.assign(O.style,{transitionProperty:TRANSITION_FIELDS,transitionDuration:me,transitionDelay:pe,transform:"translate3d(0, 0, 0) scaleX(1) scaleY(1)",opacity:U,left:asSize(A.x)||0,top:asSize(A.y)||0,width:x?"auto":C.x,right:x?asSize(Y)||0:"auto",height:oe?"auto":C.y,bottom:oe?asSize(fe)||0:"auto",zIndex:q});const g=()=>{const w=rootLayout.getBoundingClientRect(),ae=O.getBoundingClientRect();O.data.rootOffset={x:ae.x/W-w.x/W,y:ae.y/W-w.y/W}};g(),O.addEventListener("transitionend",()=>{O.style.zIndex=String(q),g()})}})).then(()=>{this.isUpdating=!1}),this.isFirst=!1,Array.from(this.querySelectorAll("ls-layout")).forEach(_=>{if(!y[_.dataset.id])return;const E=y[_.dataset.id].size;_.updatePositions({size:{x:sizeToNum(E.x,d.x),y:sizeToNum(E.y,d.y)}})})}initializeChild(s){var c;if(!((c=s.dataset)!=null&&c.id))return log$1.warn("Layout: Child requires `data-id` at the time it is added to a Layout");s._remove=s.remove,s.remove=()=>{this.removeChild(s)},s.mutationObserver||(s.mutationObserver=new MutationObserver(l=>{l.forEach(h=>{if(h.type==="attributes"){if(h.attributeName==="style")return;queueOp(["childAttributesChanged",this.dataset.id,s.dataset.id])}})}),s.mutationObserver.observe(s,{childList:!0,attributes:!0}));const d={entryTransition:{delay:0,opacity:0,scale:{x:1,y:1},offset:{x:0,y:0}},exitTransition:{delay:0,opacity:0,scale:{x:1,y:1},offset:{x:0,y:0}},position:{x:0,y:0},size:{x:0,y:0},opacity:0,fit:"cover",borderRadius:0,zIndex:1};s.data=d,s.parentEl=s.parentElement,s.nextSiblingEl=s.nextSibling,s.previousSiblingEl=s.previousSibling,s.previousSiblingEl&&(s.previousSiblingEl.nextSiblingEl=s),s.toggleAttribute("data-layout-child",!0),childIndex[s.dataset.id]=s,s.runRemove=async()=>{var h,p,y,_,E,O,P,C,A,q;s.removed=!0;const l=TRANSITION_DURATION;return await new Promise(U=>window.setTimeout(U)),Object.assign(s.style,{zIndex:0,transitionDelay:asDuration(0),transitionDuration:asDuration(l),transitionProperty:TRANSITION_FIELDS,transitionTimingFunction:(h=d.exitTransition.timingFn)!=null?h:"ease",transform:`translate3d(calc(${asSize((y=(p=d.exitTransition.offset)==null?void 0:p.x)!=null?y:0)}), calc( ${asSize((E=(_=d.exitTransition.offset)==null?void 0:_.y)!=null?E:0)}), 0) scaleX(${(P=(O=d.exitTransition.scale)==null?void 0:O.x)!=null?P:1}) scaleY(${(A=(C=d.exitTransition.scale)==null?void 0:C.y)!=null?A:1})`,opacity:(q=d.exitTransition.opacity)!=null?q:0}),s.removed=!0,s.transition=new Promise(U=>{const F=()=>{s.transition=null,s._remove(),queueOp(["childRemoveFinished",this.dataset.id,s.dataset.id]),clearTimeout(j),U()},j=window.setTimeout(F,parseInt(String(l))+600);s.addEventListener("transitionend",F,{once:!0})}),s.transition}}}const ensureLayoutContainer=a=>{const s=document.getElementById("__ls-layout-container");if(s)return Object.assign(s.style,{width:a.x+"px",height:a.y+"px"}),s;const d=document.createElement("div");return d.id="__ls-layout-container",Object.assign(d.style,{position:"fixed",visibility:"hidden",top:0+"px",left:0+"px",zIndex:-1,width:a.x+"px",height:a.y+"px"}),document.body.append(d),d},layoutChildren=({id:a,props:s={},children:d,size:c})=>{const l={props:s,children:d,size:c},h=htmlLayouts[s.layout]?htmlLayouts[s.layout].layout(l):htmlLayouts.Free.layout(l);if(!(h instanceof HTMLElement))return h;const p=Array.from(h.querySelectorAll("[data-node-id]")),y=document.createElement("div");y.style.height=h.style.height=c.y+"px",y.style.width=h.style.width=c.x+"px",y.style.position="absolute",y.style.top="0px",y.style.left="0px",y.style.boxSizing="border-box",y.setAttribute("data-wrapper-id",a),y.append(h);const _=ensureLayoutContainer(c),E=_.querySelector(`[data-wrapper-id="${a}"]`);E?E.replaceWith(y):_.append(y);const O=h.getBoundingClientRect(),P={};return p.forEach(C=>{var j,T,D,J,ee,z,ne,X;const A=C.dataset.nodeId;if(!A)return;const q=Number((j=C.dataset.opacity)!=null?j:C.style.opacity||1),U=C.getBoundingClientRect();let F={position:{x:U.x-O.x+"px",y:U.y-O.y+"px"},size:{x:U.width+"px",y:U.height+"px"},opacity:q,zIndex:(T=C.data)==null?void 0:T.zIndex,entryTransition:(J=(D=C.data)==null?void 0:D.entryTransition)!=null?J:{},exitTransition:(z=(ee=C.data)==null?void 0:ee.exitTransition)!=null?z:{},borderRadius:(X=(ne=C.data)==null?void 0:ne.borderRadius)!=null?X:0};`${s.showcase}-x`===A&&(F.position={x:O.x+"px",y:O.y+"px"},F.size={x:O.width+"px",y:O.height+"px"},F.zIndex=10),P[A]=F,positionIndex[C.dataset.nodeId]=F}),P},positionIndex={},htmlLayouts={},registerLayout=a=>{asArray(a).forEach(s=>{htmlLayouts[s.name]=s})},sourceTypes={},init$1=(a={},s)=>{const d={},c={},l=_=>{s.triggerEvent("SourceChanged",_)},h=_=>{s.triggerEvent("AvailableSourcesChanged",{type:_,sources:c[_]})},y={sourceIndex:d,sourceTypeIndex:c,registerSource:_=>{asArray(_).forEach(E=>{var P;const O=C=>{const A=d[C];if(!!A&&A.type!==E.type)throw new Error(`Attempted to modify source of type ${A.type} from ${E.type}`)};(P=E.init)==null||P.call(E,{getSource:C=>y.getSource(C),removeSource:C=>(O(C),y.removeSource(C)),setSourceActive:(C,A)=>(O(C),y.setSourceActive(C,A)),updateSource:(C,A)=>(O(C),y.updateSource(C,A)),modifySourceValue(C,A){return O(C),y.modifySourceValue(C,A)},addSource:C=>y.addSource(E.type,C)}),sourceTypes[E.type]=E})},getSource:_=>d[_],getSources:_=>c[_]||[],useSource:(_,E)=>(E(d[_]),s.on("SourceChanged",O=>{O.id===_&&E(O)})),useSources:(_,E)=>(E(c[_]||[]),s.on("AvailableSourcesChanged",O=>{O.type===_&&E(O.sources)})),addSource:(_,E)=>{if(!E.id)throw new Error('Cannot add source without field "id"');if(d[E.id])return;if(!E.value)throw new Error('Cannot add source with an empty field "value"');if(!sourceTypes[_])throw new Error("Could not find definition for source type: "+_);const{id:P,value:C=null,props:A={},isActive:q=!0}=E;d[P]={id:P,type:_,props:A,value:C,isActive:q},c[_]=[...c[_]||[],d[P]],l(d[P]),h(_)},removeSource:_=>{const E=d[_];!E||(delete d[_],c[E.type]=c[E.type].filter(O=>O.id!==_),h(E.type))},updateSource:(_,E)=>{const O=d[_];O.props={...O.props,...E},l(O),h(O.type)},modifySourceValue:async(_,E)=>{const O=d[_];await E(O.value),l(O)},setSourceActive:(_,E=!0)=>{const O=d[_];O.isActive=E,h(O.type)}};return y};var sources=Object.freeze(Object.defineProperty({__proto__:null,sourceTypes,init:init$1},Symbol.toStringTag,{value:"Module"})),layouts=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));const{forEachDown,insertAt,toDataNode,pull,replaceItem}=Logic;let compositor;const start=a=>{if(compositor)return;const{dbAdapter:s,transformSettings:d={},sourceSettings:c={}}=a,l={},h={};try{customElements.define("ls-layout",Layout)}catch(j){log$1.warn(j)}const p={},y={},_={};let E=0;const O=new Map,P=(j,T)=>{if(typeof j!="function")return;const D=++E;return O.set(D,j),j.nodeId=T,()=>{O.delete(D)}},C=(j,T,D)=>P((J,ee)=>{J===j&&T(ee)},D),A=(j,T)=>{O.forEach(D=>{D.nodeId?(T==null?void 0:T.nodeId)&&(T==null?void 0:T.nodeId)===D.nodeId&&D(j,T):D(j,T)})},q={projects:h,subscribe:P,on:C,triggerEvent:A,getProject:j=>h[j],getNodeProject:j=>h[p[j]],getNodeParent:j=>_[y[j]],getNode:j=>_[j],createProject:async(j={},T)=>{const{id:D,props:J={},children:ee=[]}=j,z=await s(T,{get:()=>null,getParent:()=>null}).insert(J),ne={id:z,props:J,children:ee};return forEachDown(j,X=>{}),_[z]=ne,compositor.loadProject(ne,T)},loadProject:(j,T)=>{if(!j)return;if(T=T||j.id,h[T])return h[T];forEachDown(j,(z,ne)=>{_[z.id]=z,y[z.id]=ne==null?void 0:ne.id,p[z.id]=T});const D={insert:async(z,ne,X=0)=>{if(z.id&&_[z.id])return _[z.id];if(z.children||(z.children=[]),z.props||(z.props={}),ne){const M=_[ne];if(!M)throw"Parent node not found with ID";M.children=insertAt(X,z,M.children||[]),y[z.id]=ne}return _[z.id]=z,p[z.id]=T,z.id},update:async(z,ne={},X)=>{const M=_[z];if(X){const K=X.map(te=>{const L=_[te];return y[L.id]=z,L});M.children=K}M.props={...M.props,...ne}},remove:async z=>{const ne=_[y[z]];ne&&(ne.children=ne.children.filter(M=>M.id!==z));const X=_[z];forEachDown(X,M=>{_[M.id]&&(_[M.id]._deleted=!0),A("NodeRemoved",{projectId:J.id,nodeId:M.id})})}},J={id:T,getRoot:()=>j,get(z){return _[z]},getParent(z){return _[y[z]]},renderTree(){return F.renderTree(j)},local:D,insert:async(z={},ne,X=0)=>{const K={id:await ee.insert(z,ne,X),props:z,children:[]};return D.insert(K,ne,X)},update:async(z,ne)=>(await D.update(z,ne),ee.update(z,ne)),remove:async z=>{await D.remove(z);const ne=_[y[z]],X=ne.children.filter(M=>M.id!==z);return ee.batch([["delete",{id:z}],["update",{...ne,children:X}]])},reorder:async(z,ne)=>{const X=_[z];return X.children=ne.map(M=>X.children.find(K=>K.id===M)),ee.batch([["update",X]])},move:async(z,ne,X=0)=>{const M=_[z],K=_[y[z]],te=_[ne];K.children=pull(K.children,M),te.children=insertAt(X,M,te.children),ee.batch([["update",te],["update",K]]),y[z]=ne},swap:async(z,ne)=>{const X=_[z],M=_[ne],K=_[y[z]],te=_[y[ne]];K.children=replaceItem(L=>L.id===z,M,K.children),te.children=replaceItem(L=>L.id===ne,X,te.children),y[z]=te.id,y[ne]=K.id,ee.batch([["update",K],["update",te]])}};Object.defineProperty(J,"nodes",{get(){return Object.values(_).filter(z=>p[z.id]===J.id)}});const ee=l[T]||s(T,{get:z=>toDataNode(J.get(z)),getParent:z=>toDataNode(J.getParent(z))});return l[T]=ee,h[T]=J,J}},U=init$1(c,q),F=init$2(d,q,U);return compositor={registerLayout,registerTransform:F.registerTransform,registerSource:U.registerSource,getElement:F.getElement,getSource:U.getSource,getSources:U.getSources,useSource:U.useSource,useSources:U.useSources,...q},compositor};var index=Object.freeze(Object.defineProperty({__proto__:null,Transform:transforms,Layout:layouts,Source:sources,start},Symbol.toStringTag,{value:"Module"}));const createProject=async a=>{const s=getUser().id,d=a.type||"sceneless",c=a.size||{x:1280,y:720},l=a.settings||{};let h=await CoreContext.clients.LiveApi().project.createProject({collectionId:s,rendering:{video:{width:c.x,height:c.y,framerate:30}},composition:{studioSdk:{}},metadata:{},webrtc:{hosted:{}}});const p=await CoreContext.clients.LayoutApi().layout.createLayout({layout:{projectId:h.project.projectId,collectionId:h.project.collectionId}}),{displayName:y}=getAccessTokenData(),_={type:d,layoutId:p.id,hostDisplayName:y,props:a.props||{}};let E=await CoreContext.clients.LiveApi().project.updateProject({collectionId:s,projectId:h.project.projectId,updateMask:["metadata"],metadata:_});return h.project=E.project,h.project.metadata=_,d==="sceneless"?await createCompositor(p.id,c,l):await CoreContext.compositor.createProject({props:{name:"Root",layout:"Free",...l,isRoot:!0,size:c}},p.id),h},deleteProject=async a=>{const{projectId:s}=a,d=getProject(s),c=getUser().id;await Promise.all([CoreContext.clients.LiveApi().project.deleteProject({collectionId:c,projectId:s}),CoreContext.clients.LayoutApi().layout.deleteLayout({layoutId:d.layoutApi.layoutId})])},loadUser=async()=>{var h;const a=await loadCollections();let s;const{displayName:d,serviceUserId:c}=getAccessTokenData();a.length===0?s=(await CoreContext.clients.LiveApi().collection.createCollection({metadata:{serviceUserId:c,displayName:d,props:{}}})).collection:s=a[0],await CoreContext.clients.LiveApi().subscribeToCollection(s.collectionId);const l=await Promise.all(s.projects.map(p=>hydrateProject(p,"ROLE_HOST")));return{user:{id:s.collectionId,metadata:s.metadata,props:((h=s.metadata)==null?void 0:h.props)||{},name:d},projects:l,sources:s.sources}},loadCollections=async()=>(await CoreContext.clients.LiveApi().collection.getCollections({})).collections;var requests=Object.freeze(Object.defineProperty({__proto__:null,createProject,deleteProject,loadUser,loadCollections},Symbol.toStringTag,{value:"Module"}));const BroadcastPhase=lib$2.LiveApiModel.ProjectBroadcastPhase,{trigger,triggerInternal}=CoreContext,EventType=lib$2.LiveApiModel.EventType,EventSubType=lib$2.LiveApiModel.EventSubType,init=async(a={})=>{const s=a.env||"prod",d=a.logLevel||"Warn";log$1.getLogger("livekit").setLevel(d),log$1.setLevel(d),log$1.info("Initializing Studio SDK...");const{layouts:l=[],transforms:h=[],sources:p=[],defaultTransforms:y={},guestToken:_}=a,E=new lib$2.ApiStream({sdkVersion:CoreContext.version,env:s,logLevel:d}),O=config$1(),P=start({dbAdapter:compositorAdapter,transformSettings:{defaultTransforms:{...y,...O.defaults.transforms}}});CoreContext.config=O,CoreContext.clients=E,CoreContext.compositor=P,CoreContext.logLevel=d,CoreContext.Request=await Promise.resolve().then(function(){return requests}),CoreContext.Command=await Promise.resolve().then(function(){return commands$1}),window.__StudioKit={...CoreContext},P.registerSource([...Object.values(Sources),...p]),P.registerTransform([...Object.values(Transforms),...h]),P.registerLayout([...Object.values(Layouts),...l]);const C=await E.load(_);let A;C&&await E.LiveApi().project.getProject({...C}).then(U=>hydrateProject(U.project,C.role)).then(async U=>{setAppState({user:{id:C.collectionId,props:{},name:null,metadata:{}},sources:[],projects:[U],activeProjectId:null}),U.isInitial=!0,A=await CoreContext.Command.setActiveProject({projectId:U.id})}),E.LiveApi().on(EventType.EVENT_TYPE_COLLECTION,(U,F)=>{switch(log$1.info("Received: Collection event",F,U),F){case EventSubType.EVENT_SUB_TYPE_UPDATE:{triggerInternal("UserChanged",U.update.collection);return}}}),E.LiveApi().on(EventType.EVENT_TYPE_DESTINATION,(U,F)=>{switch(log$1.info("Received: Destination event",F,U),F){case EventSubType.EVENT_SUB_TYPE_CREATE:{const{destination:j}=U.create;triggerInternal("DestinationAdded",j);return}case EventSubType.EVENT_SUB_TYPE_UPDATE:{const{destination:j}=U.update;triggerInternal("DestinationChanged",j);return}case EventSubType.EVENT_SUB_TYPE_DELETE:{triggerInternal("DestinationRemoved",U.delete);return}}}),E.LiveApi().on(EventType.EVENT_TYPE_SOURCE,(U,F)=>{switch(log$1.info("Received: Source event",F,U),F){case EventSubType.EVENT_SUB_TYPE_CREATE:{triggerInternal("SourceAdded",U.create.source);return}case EventSubType.EVENT_SUB_TYPE_UPDATE:{triggerInternal("SourceChanged",U.update.source);return}case EventSubType.EVENT_SUB_TYPE_DELETE:{triggerInternal("SourceRemoved",U.delete.sourceId);return}case EventSubType.EVENT_SUB_TYPE_ADD:{triggerInternal("ProjectSourceAdded",{projectId:U.add.projectId,source:U.add.source});return}case EventSubType.EVENT_SUB_TYPE_REMOVE:{triggerInternal("ProjectSourceRemoved",{projectId:U.add.projectId,sourceId:U.add.sourceId});return}}}),E.LiveApi().on(EventType.EVENT_TYPE_PROJECT,(U,F)=>{var j;switch(log$1.info("Received: Project event",F,U),F){case EventSubType.EVENT_SUB_TYPE_CREATE:{const T=U.create.project;if(getProject(T.projectId))return;triggerInternal("ProjectAdded",T);return}case EventSubType.EVENT_SUB_TYPE_UPDATE:{const{projectId:T,updateMask:D,project:J}=U.update,ee=getProject(J.projectId);if(!ee)return;D.includes("metadata")&&trigger("ProjectMetaUpdated",{projectId:T,meta:J.metadata}),triggerInternal("ProjectChanged",{project:J,phase:ee.videoApi.phase});return}case EventSubType.EVENT_SUB_TYPE_DELETE:{triggerInternal("ProjectRemoved",{projectId:U.delete.projectId});return}case EventSubType.EVENT_SUB_TYPE_STATE:{const T=getProject((j=U.state)==null?void 0:j.projectId);if(!T)return;let D=U.state.broadcastId;if(U.state.error&&trigger("BroadcastError",{projectId:T.id,broadcastId:U.state.broadcastId,error:U.state.error}),U.state.phase){const J=U.state.phase;J===BroadcastPhase.PROJECT_BROADCAST_PHASE_RUNNING?trigger("BroadcastStarted",{projectId:T.id,broadcastId:U.state.broadcastId}):J===BroadcastPhase.PROJECT_BROADCAST_PHASE_STOPPED&&(D=null,trigger("BroadcastStopped",{projectId:T.id,broadcastId:U.state.broadcastId}))}triggerInternal("ProjectChanged",{project:T.videoApi.project,phase:U.state.phase,broadcastId:D});return}}}),E.LayoutApi().on(lib$2.LayoutApiModel.EventType.EVENT_TYPE_LAYER,(U,F)=>{if(F===lib$2.LayoutApiModel.EventSubType.EVENT_SUB_TYPE_CREATE){log$1.debug("Received: Node Insert",U.create);const{connectionId:j,layoutId:T}=U.create.requestMetadata;if(CoreContext.connectionId===j)return;const D=layerToNode(U.create),J=getProjectByLayoutId(T),ee=[D,...J.compositor.nodes.map(toDataNode$1)],z=toSceneTree(ee,D.id);J.compositor.local.insert(z),triggerInternal("NodeAdded",{projectId:J.id,nodeId:D.id})}else if(F===lib$2.LayoutApiModel.EventSubType.EVENT_SUB_TYPE_UPDATE){log$1.debug("Received: Node Update",U.update);const{connectionId:j,layoutId:T,updateVersions:D={}}=U.update.requestMetadata;if(CoreContext.connectionId===j)return;const J=layerToNode(U.update);if((latestUpdateVersion[J.id]||0)>D[J.id])return log$1.info("Ignoring node update - updateID is less than latest.");latestUpdateVersion[J.id]=D[J.id];const z=getProjectByLayoutId(T);z.compositor.local.update(U.update.id,J.props,J.childIds),triggerInternal("NodeChanged",{projectId:z.id,nodeId:J.id})}else if(F===lib$2.LayoutApiModel.EventSubType.EVENT_SUB_TYPE_DELETE){log$1.debug("Received: Node Delete",U.delete);const{connectionId:j,layoutId:T}=U.delete.requestMetadata;if(CoreContext.connectionId===j)return;const D=getProjectByLayoutId(T);D.compositor.local.remove(U.delete.id),triggerInternal("NodeRemoved",{projectId:D.id,nodeId:U.delete.id})}else if(F===lib$2.LayoutApiModel.EventSubType.EVENT_SUB_TYPE_BATCH){log$1.debug("Received: Node Batch Update",U.batch);const{connectionId:j,layoutId:T,updateVersions:D={}}=U.batch.requestMetadata;if(CoreContext.connectionId===j)return;const J=getProjectByLayoutId(T);U.batch.layers.forEach(ee=>{try{const[z,ne]=Object.entries(ee)[0];if(z==="create"){const X=layerToNode(ne);J.compositor.local.insert(X),triggerInternal("NodeAdded",{projectId:J.id,nodeId:X.id})}else if(z==="update"){const X=layerToNode(ne);if((latestUpdateVersion[X.id]||0)>D[X.id])return log$1.info("Ignoring node update - updateID is less than latest.");latestUpdateVersion[X.id]=D[X.id],J.compositor.local.update(X.id,X.props,X.childIds),triggerInternal("NodeChanged",{projectId:J.id,nodeId:X.id})}else z==="delete"&&(J.compositor.local.remove(ne.id),triggerInternal("NodeRemoved",{projectId:J.id,nodeId:ne.id}))}catch(z){log$1.warn("Error handling batch item",z,{item:ee})}}),J&&triggerInternal("NodeChanged",{projectId:J.id,nodeId:J.compositor.getRoot().id})}});const q=(U={},F)=>{const{displayName:j,role:T,maxDuration:D=CoreContext.config.defaults.guestTokenDuration,projectId:J=CoreContext.state.activeProjectId}=U,ee=getProject(J),z=j?{direct:{displayName:j}}:{exchange:{maxDuration:D}};return E.LiveApi().authentication.createGuestAccessToken({projectId:J,token:z,url:F,collectionId:ee.videoApi.project.collectionId,maxDuration:D,role:T||lib$2.LiveApiModel.Role.ROLE_GUEST})};return{...omit$1(CoreContext,["clients","config","connectionId","Request","state","trigger"]),createDemoToken:async()=>(console.warn("createDemoToken() is currently unavailable."),""),createPreviewLink:async(U={})=>{const{maxDuration:F,projectId:j=CoreContext.state.activeProjectId}=U,T=getProject(j),D=T.videoApi.project.composition.studioSdk.rendererUrl;return(await E.LiveApi().authentication.createGuestAccessToken({projectId:j,token:{direct:{displayName:"Preview"}},url:D,collectionId:T.videoApi.project.collectionId,maxDuration:F||CoreContext.config.defaults.previewTokenDuration,role:lib$2.LiveApiModel.Role.ROLE_VIEWER})).url},createGuestLink:async(U,F={})=>(await q(F,U)).url,createGuestToken:async(U={})=>(await q(U)).accessToken,initialProject:A,load,render}},load=async a=>{let s=getBaseUser();if(s)return log$1.info("Attempted to load user again - returning existing user"),s;if(!a){log$1.warn("Access token required for load()");return}log$1.info("Loading user..."),await CoreContext.clients.load(a);const c=await CoreContext.Request.loadUser();return setAppState({user:c.user,sources:c.sources,projects:c.projects,activeProjectId:null}),s=getBaseUser(),trigger("UserLoaded",s),s};exports.Command=commands$1,exports.Compositor=index,exports.Context=context,exports.Events=events$2,exports.Helpers=index$1,exports.Request=requests,exports.Room=index$2,exports.SDK=types,exports.init=init,Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
//# sourceMappingURL=index.umd.js.map
