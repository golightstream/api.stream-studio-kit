{"version":3,"file":"guest.4b25e8ae.js","sources":["../../../../examples/studio-kit-demo/src/guest/guest.tsx","../../../../examples/studio-kit-demo/src/guest-main.tsx"],"sourcesContent":["/* ---------------------------------------------------------------------------------------------\n * Copyright (c) Infiniscene, Inc. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * -------------------------------------------------------------------------------------------- */\nimport { useContext, useEffect, useRef, useState } from 'react'\nimport { init, Helpers, SDK } from '@api.stream/studio-kit'\nimport { ControlPanel, DeviceSelection } from '../shared/control-panel'\nimport { Participant } from '../shared/participant'\nimport Style from '../shared/shared.module.css'\nimport { Chat } from '../shared/chat'\nimport config from '../../config'\n\nconst { Room } = Helpers\nconst { useStudio } = Helpers.React\n\nconst DEFAULT_GUEST_NAME = 'Guest-' + Math.floor(Math.random() * 1e4)\n\nconst Project = () => {\n  const { studio, project, room } = useStudio()\n  const renderContainer = useRef()\n  const [isLive, setIsLive] = useState(false)\n\n  useEffect(() => {\n    Room.ensureDevicePermissions()\n  })\n\n  // Listen for project events\n  useEffect(() => {\n    return project.subscribe((event, payload) => {\n      if (event === 'BroadcastStarted') {\n        setIsLive(true)\n      } else if (event === 'BroadcastStopped') {\n        setIsLive(false)\n      }\n    })\n  }, [])\n\n  useEffect(() => {\n    studio.render({\n      containerEl: renderContainer.current,\n      projectId: project.id,\n      dragAndDrop: false, // Disable controls for guests\n    })\n  }, [renderContainer.current])\n\n  if (!room) return null\n\n  return (\n    <div className={Style.column} style={{ marginLeft: 10 }}>\n      <div ref={renderContainer}></div>\n      {isLive && <div style={{ fontWeight: 'bold' }}>You're live!</div>}\n      <div className={Style.row}>\n        <DeviceSelection />\n        <div\n          style={{\n            marginLeft: 20,\n            marginTop: 12,\n          }}\n        >\n          <ControlPanel />\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport const GuestView = () => {\n  const { studio, project, room, setStudio, setProject, setRoom } = useStudio()\n  const [joining, setJoining] = useState(false)\n  const [displayName, setDisplayName] = useState(DEFAULT_GUEST_NAME)\n  const [participant, setParticipant] = useState<SDK.Participant>()\n  const [error, setError] = useState<string>()\n  const [inRoom, setInRoom] = useState<boolean>(false)\n\n  // Store as a global for debugging in console\n  window.SDK = useStudio()\n\n  // Listen for room participants\n  useEffect(() => {\n    if (!room) return\n    return room.useParticipant(room.participantId, setParticipant)\n  }, [room])\n\n  // Initialize studio\n  useEffect(() => {\n    if (!joining) return\n    if (!studio) {\n      init({\n        env: config.env,\n        logLevel: config.logLevel,\n      })\n        .then(setStudio)\n        .catch((e) => {\n          console.warn(e)\n          setError(e.message)\n        })\n    }\n  }, [joining])\n\n  // Initialize project\n  useEffect(() => {\n    if (!studio) return\n\n    if (studio.initialProject) {\n      // If the SDK detects a token in the URL, it will return the project\n      //  associated with it (e.g. guest view)\n      setProject(studio.initialProject)\n    } else {\n      setError('Invalid token')\n    }\n  }, [studio])\n\n  // Initialize room\n  useEffect(() => {\n    if (!project || inRoom) return\n    setInRoom(true)\n    project\n      .joinRoom({\n        displayName,\n      })\n      .then((room) => {\n        setJoining(false)\n        setRoom(room)\n      })\n      .catch((e) => {\n        setError(e.message)\n        setInRoom(false)\n      })\n  }, [project, room])\n\n  if (error) {\n    return <div>{error}</div>\n  }\n\n  if (joining) {\n    return <div>Joining as {displayName}...</div>\n  }\n\n  if (!room) {\n    return (\n      <form\n        className={Style.column}\n        style={{ width: 316, alignItems: 'flex-end' }}\n        onSubmit={(e) => {\n          e.preventDefault()\n          setJoining(true)\n        }}\n      >\n        <div className={Style.column}>\n          <label>Display Name</label>\n          <input\n            type=\"text\"\n            autoFocus={true}\n            defaultValue={displayName}\n            onChange={(e) => {\n              setDisplayName(e.target.value)\n            }}\n          />\n        </div>\n        <DeviceSelection />\n        <button\n          style={{ marginTop: 8, width: 70 }}\n          onClick={() => {\n            setJoining(true)\n          }}\n        >\n          Join\n        </button>\n      </form>\n    )\n  }\n\n  return (\n    <div\n      className={Style.row}\n      style={{ marginTop: 14, background: '#242533', padding: 10 }}\n    >\n      <div className={Style.column}>\n        {participant && <Participant participant={participant} />}\n      </div>\n      <Project />\n      <div style={{ marginLeft: 10 }}>\n        <Chat />\n      </div>\n    </div>\n  )\n}\n","/* ---------------------------------------------------------------------------------------------\n * Copyright (c) Infiniscene, Inc. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * -------------------------------------------------------------------------------------------- */\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport { GuestView } from './guest/guest'\nimport { AppProvider } from './shared/context'\nimport { Helpers } from '@api.stream/studio-kit'\nimport url from '../logo.png'\nimport './index.css'\n\nconst StudioProvider = Helpers.React.StudioProvider\n\nconst Content = () => {\n  return (\n    <div>\n      <div id=\"header\">\n        <a href=\"https://api.stream/\" target=\"_blank\">\n          <img src={url} height={20} />\n        </a>\n        <h1>\n          Studio Kit\n          <span>Demo</span>\n        </h1>\n        <h3>Guest View</h3>\n      </div>\n      <AppProvider isHost={false}>\n        <StudioProvider>\n          <GuestView />\n        </StudioProvider>\n      </AppProvider>\n    </div>\n  )\n}\n\nReactDOM.render(<Content />, document.getElementById('root'))\n"],"names":["Room","Helpers","useStudio","React","DEFAULT_GUEST_NAME","Math","floor","random","Project","studio","project","room","renderContainer","useRef","isLive","setIsLive","useState","useEffect","ensureDevicePermissions","subscribe","event","payload","render","containerEl","current","projectId","id","dragAndDrop","className","Style","column","style","marginLeft","children","_jsx","ref","fontWeight","_jsxs","row","DeviceSelection","marginTop","ControlPanel","GuestView","setStudio","setProject","setRoom","joining","setJoining","displayName","setDisplayName","participant","setParticipant","error","setError","inRoom","setInRoom","window","SDK","useParticipant","participantId","init","env","config","logLevel","then","catch","e","console","warn","message","initialProject","joinRoom","room2","width","alignItems","onSubmit","preventDefault","type","autoFocus","defaultValue","onChange","target","value","onClick","background","padding","Participant","Chat","StudioProvider","Content","href","src","url","height","AppProvider","isHost","ReactDOM","document","getElementById"],"mappings":"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"}