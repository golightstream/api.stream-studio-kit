{"version":3,"file":"guest.2a8c0937.js","sources":["../../../../examples/studio-kit-demo/src/guest/guest.tsx","../../../../examples/studio-kit-demo/src/guest-main.tsx"],"sourcesContent":["/* ---------------------------------------------------------------------------------------------\n * Copyright (c) Infiniscene, Inc. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * -------------------------------------------------------------------------------------------- */\nimport { useContext, useEffect, useRef, useState } from 'react'\nimport { init, Helpers, SDK } from '@api.stream/studio-kit'\nimport { ControlPanel, DeviceSelection } from '../shared/control-panel'\nimport { Participant } from '../shared/participant'\nimport Style from '../shared/shared.module.css'\nimport { Chat } from '../shared/chat'\nimport config from '../../config'\n\nconst { Room } = Helpers\nconst { useStudio } = Helpers.React\n\nconst DEFAULT_GUEST_NAME = 'Guest-' + Math.floor(Math.random() * 1e4)\n\nconst Project = () => {\n  const { studio, project, room } = useStudio()\n  const renderContainer = useRef()\n  const [isLive, setIsLive] = useState(false)\n\n  useEffect(() => {\n    Room.ensureDevicePermissions()\n  })\n\n  // Listen for project events\n  useEffect(() => {\n    return project.subscribe((event, payload) => {\n      if (event === 'BroadcastStarted') {\n        setIsLive(true)\n      } else if (event === 'BroadcastStopped') {\n        setIsLive(false)\n      }\n    })\n  }, [])\n\n  useEffect(()=>{\n    if(room){\n      room.sendData({type : \"UserJoined\"});\n    }\n  },[room])\n  useEffect(() => {\n    studio.render({\n      containerEl: renderContainer.current,\n      projectId: project.id,\n      dragAndDrop: false, // Disable controls for guests\n    })\n  }, [renderContainer.current])\n\n  if (!room) return null\n\n  return (\n    <div className={Style.column} style={{ marginLeft: 10 }}>\n      <div ref={renderContainer}></div>\n      {isLive && <div style={{ fontWeight: 'bold' }}>You're live!</div>}\n      <div className={Style.row}>\n        <DeviceSelection />\n        <div\n          style={{\n            marginLeft: 20,\n            marginTop: 12,\n          }}\n        >\n          <ControlPanel />\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport const GuestView = () => {\n  const { studio, project, room, setStudio, setProject, setRoom } = useStudio()\n  const [joining, setJoining] = useState(false)\n  const [displayName, setDisplayName] = useState(DEFAULT_GUEST_NAME)\n  const [participant, setParticipant] = useState<SDK.Participant>()\n  const [error, setError] = useState<string>()\n  const [inRoom, setInRoom] = useState<boolean>(false)\n\n  // Store as a global for debugging in console\n  window.SDK = useStudio()\n\n  // Listen for room participants\n  useEffect(() => {\n    if (!room) return\n    return room.useParticipant(room.participantId, setParticipant)\n  }, [room])\n\n  // Initialize studio\n  useEffect(() => {\n    if (!joining) return\n    if (!studio) {\n      init({\n        env: config.env,\n        logLevel: config.logLevel,\n      })\n        .then(setStudio)\n        .catch((e) => {\n          console.warn(e)\n          setError(e.message)\n        })\n    }\n  }, [joining])\n\n  // Initialize project\n  useEffect(() => {\n    if (!studio) return\n\n    if (studio.initialProject) {\n      // If the SDK detects a token in the URL, it will return the project\n      //  associated with it (e.g. guest view)\n      setProject(studio.initialProject)\n    } else {\n      setError('Invalid token')\n    }\n  }, [studio])\n\n  // Initialize room\n  useEffect(() => {\n    if (!project || inRoom) return\n    setInRoom(true)\n    project\n      .joinRoom({\n        displayName,\n      })\n      .then((room) => {\n        setJoining(false)\n        setRoom(room)\n      })\n      .catch((e) => {\n        setError(e.message)\n        setInRoom(false)\n      })\n  }, [project, room])\n\n  if (error) {\n    return <div>{error}</div>\n  }\n\n  if (joining) {\n    return <div>Joining as {displayName}...</div>\n  }\n\n  if (!room) {\n    return (\n      <form\n        className={Style.column}\n        style={{ width: 316, alignItems: 'flex-end' }}\n        onSubmit={(e) => {\n          e.preventDefault()\n          setJoining(true)\n        }}\n      >\n        <div className={Style.column}>\n          <label>Display Name</label>\n          <input\n            type=\"text\"\n            autoFocus={true}\n            defaultValue={displayName}\n            onChange={(e) => {\n              setDisplayName(e.target.value)\n            }}\n          />\n        </div>\n        <DeviceSelection />\n        <button\n          style={{ marginTop: 8, width: 70 }}\n          onClick={() => {\n            setJoining(true)\n          }}\n        >\n          Join\n        </button>\n      </form>\n    )\n  }\n\n  return (\n    <div\n      className={Style.row}\n      style={{ marginTop: 14, background: '#242533', padding: 10 }}\n    >\n      <div className={Style.column}>\n        {participant && <Participant participant={participant} />}\n      </div>\n      <Project />\n      <div style={{ marginLeft: 10 }}>\n        <Chat />\n      </div>\n    </div>\n  )\n}\n","/* ---------------------------------------------------------------------------------------------\n * Copyright (c) Infiniscene, Inc. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * -------------------------------------------------------------------------------------------- */\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport { GuestView } from './guest/guest'\nimport { AppProvider } from './shared/context'\nimport { Helpers } from '@api.stream/studio-kit'\nimport url from '../logo.png'\nimport './index.css'\n\nconst StudioProvider = Helpers.React.StudioProvider\n\nconst Content = () => {\n  return (\n    <div>\n      <div id=\"header\">\n        <a href=\"https://api.stream/\" target=\"_blank\">\n          <img src={url} height={20} />\n        </a>\n        <h1>\n          Studio Kit\n          <span>Demo</span>\n        </h1>\n        <h3>Guest View</h3>\n      </div>\n      <AppProvider isHost={false}>\n        <StudioProvider>\n          <GuestView />\n        </StudioProvider>\n      </AppProvider>\n    </div>\n  )\n}\n\nReactDOM.render(<Content />, document.getElementById('root'))\n"],"names":["Room","Helpers","useStudio","React","DEFAULT_GUEST_NAME","Math","floor","random","Project","studio","project","room","renderContainer","useRef","isLive","setIsLive","useState","useEffect","ensureDevicePermissions","subscribe","event","payload","sendData","type","render","containerEl","current","projectId","id","dragAndDrop","className","Style","column","style","marginLeft","children","_jsx","ref","fontWeight","_jsxs","row","DeviceSelection","marginTop","ControlPanel","GuestView","setStudio","setProject","setRoom","joining","setJoining","displayName","setDisplayName","participant","setParticipant","error","setError","inRoom","setInRoom","window","SDK","useParticipant","participantId","init","env","config","logLevel","then","catch","e","console","warn","message","initialProject","joinRoom","room2","width","alignItems","onSubmit","preventDefault","autoFocus","defaultValue","onChange","target","value","onClick","background","padding","Participant","Chat","StudioProvider","Content","href","src","url","height","AppProvider","isHost","ReactDOM","document","getElementById"],"mappings":"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"}